{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -86555.1796875, "policy_loss": -86708.8515625, "entropy": 29.81869125366211, "entropy_coeff": 0.01, "var_gnorm": 16.000768661499023, "vf_loss": 24312.16796875, "vf_explained_var": 0.0005815625190734863}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 2700, "num_env_steps_trained": 2400, "num_agent_steps_sampled": 2700, "num_agent_steps_trained": 2400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 18, "num_samples_added_to_queue": 2700, "learner_queue": {"size_count": 8, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.067, "learner_load_time_ms": 0.215, "learner_load_wait_time_ms": 1107.455, "learner_dequeue_time_ms": 5215.976}}, "env_runners": {"episode_reward_max": -59.183333333333195, "episode_reward_min": -154.6916666666667, "episode_reward_mean": -112.25617283950616, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 2700, "policy_reward_min": {"default_policy": -154.6916666666667}, "policy_reward_max": {"default_policy": -59.183333333333195}, "policy_reward_mean": {"default_policy": -112.25617283950616}, "custom_metrics": {"num_consolidated_mean": 0.6848148148148149, "num_consolidated_min": 0.54, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0662962962962963, "num_overloaded_min": 0.93, "num_overloaded_max": 1.19, "num_moves_mean": 9.986296296296295, "num_moves_min": 9.73, "num_moves_max": 10.25, "mean_accuracy_mean": 41.079358024691366, "mean_accuracy_min": 40.84033333333333, "mean_accuracy_max": 41.309000000000005, "num_model_switches_mean": 6.033703703703703, "num_model_switches_min": 5.65, "num_model_switches_max": 6.37, "num_slav_mean": 0.16103148148148147, "num_slav_min": 0.14303333333333332, "num_slav_max": 0.18421666666666664, "cpu_conserved_cost_mean": 2.741481481481482, "cpu_conserved_cost_min": 2.18, "cpu_conserved_cost_max": 3.68, "mean_cluster_cpu_util_mean": 0.5719813718073533, "mean_cluster_cpu_util_min": 0.5537982262292958, "mean_cluster_cpu_util_max": 0.5960963267503122, "mean_cluster_mem_util_mean": 0.36686584882390216, "mean_cluster_mem_util_min": 0.35701813269611643, "mean_cluster_mem_util_max": 0.3768369435115818, "reward_consolidation_mean_mean": 0.224537037037037, "reward_consolidation_mean_min": 0.08333333333333331, "reward_consolidation_mean_max": 0.37499999999999994, "reward_illegal_mean_mean": -1.7771604938271603, "reward_illegal_mean_min": -1.9833333333333334, "reward_illegal_mean_max": -1.5499999999999998, "reward_accuracy_mean_mean": 0.8876543209876546, "reward_accuracy_mean_min": 0.5249999999999997, "reward_accuracy_mean_max": 1.4916666666666694, "reward_sla_mean_mean": -0.45759259259259255, "reward_sla_mean_min": -0.711, "reward_sla_mean_max": -0.28075000000000006, "reward_consolidation_sum_mean": 22.453703703703702, "reward_consolidation_sum_min": 8.333333333333332, "reward_consolidation_sum_max": 37.49999999999999, "reward_illegal_sum_mean": -177.71604938271605, "reward_illegal_sum_min": -198.33333333333334, "reward_illegal_sum_max": -154.99999999999997, "reward_accuracy_sum_mean": 88.76543209876546, "reward_accuracy_sum_min": 52.49999999999997, "reward_accuracy_sum_max": 149.16666666666694, "reward_sla_sum_mean": -45.75925925925926, "reward_sla_sum_min": -71.1, "reward_sla_sum_max": -28.075000000000003, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 500.0, "global_timestep_min": 100, "global_timestep_max": 900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-61.816666666666485, -85.41666666666667, -138.65833333333336, -116.34166666666684, -143.27500000000003, -94.27499999999995, -114.04999999999998, -76.14999999999993, -119.34166666666673, -85.50833333333333, -128.41666666666674, -154.6916666666667, -60.68333333333305, -140.62499999999994, -154.41666666666674, -88.30833333333325, -114.31666666666669, -121.25833333333341, -145.1416666666667, -150.15833333333327, -96.91666666666657, -121.7916666666667, -130.6916666666667, -104.85000000000001, -94.60000000000012, -59.183333333333195, -130.03333333333342], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-61.816666666666485, -85.41666666666667, -138.65833333333336, -116.34166666666684, -143.27500000000003, -94.27499999999995, -114.04999999999998, -76.14999999999993, -119.34166666666673, -85.50833333333333, -128.41666666666674, -154.6916666666667, -60.68333333333305, -140.62499999999994, -154.41666666666674, -88.30833333333325, -114.31666666666669, -121.25833333333341, -145.1416666666667, -150.15833333333327, -96.91666666666657, -121.7916666666667, -130.6916666666667, -104.85000000000001, -94.60000000000012, -59.183333333333195, -130.03333333333342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22560095637099545, "mean_inference_ms": 1.9712739197183793, "mean_action_processing_ms": 0.08753207803345854, "mean_env_wait_ms": 1.444187157250227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008159213595920138, "StateBufferConnector_ms": 0.003306953995316117, "ViewRequirementAgentConnector_ms": 0.08018811543782552}, "num_episodes": 27, "episode_return_max": -59.183333333333195, "episode_return_min": -154.6916666666667, "episode_return_mean": -112.25617283950616, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2700, "num_agent_steps_trained": 2400, "num_env_steps_sampled": 2700, "num_env_steps_trained": 2400, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 258.7245242050894, "num_env_steps_trained_throughput_per_sec": 229.97735484896836, "timesteps_total": 2700, "num_env_steps_sampled_lifetime": 2700, "num_agent_steps_sampled_lifetime": 2700, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 2700, "timers": {"training_iteration_time_ms": 10435.818, "restore_workers_time_ms": 0.013, "training_step_time_ms": 573.643, "sample_time_ms": 559.887, "synch_weights_time_ms": 12.589}, "counters": {"num_env_steps_sampled": 2700, "num_env_steps_trained": 2400, "num_agent_steps_sampled": 2700, "num_agent_steps_trained": 2400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 18, "num_samples_added_to_queue": 2700}, "done": false, "training_iteration": 1, "trial_id": "27800_00000", "date": "2024-10-12_15-27-59", "timestamp": 1728743279, "time_this_iter_s": 10.449720621109009, "time_total_s": 10.449720621109009, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d47f70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10.449720621109009, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 15.773333333333335, "ram_util_percent": 29.126666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -80961.1640625, "policy_loss": -81076.8046875, "entropy": 29.818405151367188, "entropy_coeff": 0.01, "var_gnorm": 16.001850128173828, "vf_loss": 20509.03515625, "vf_explained_var": 0.001566469669342041}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 5400, "num_env_steps_trained": 5100, "num_agent_steps_sampled": 5400, "num_agent_steps_trained": 5100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 36, "num_samples_added_to_queue": 5400, "learner_queue": {"size_count": 17, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.127, "learner_load_time_ms": 0.178, "learner_load_wait_time_ms": 1118.131, "learner_dequeue_time_ms": 6625.973}}, "env_runners": {"episode_reward_max": -45.4666666666666, "episode_reward_min": -161.1666666666667, "episode_reward_mean": -103.9384259259259, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 5400, "policy_reward_min": {"default_policy": -161.1666666666667}, "policy_reward_max": {"default_policy": -45.4666666666666}, "policy_reward_mean": {"default_policy": -103.9384259259259}, "custom_metrics": {"num_consolidated_mean": 0.691111111111111, "num_consolidated_min": 0.54, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.049074074074074, "num_overloaded_min": 0.93, "num_overloaded_max": 1.2, "num_moves_mean": 9.982962962962961, "num_moves_min": 9.69, "num_moves_max": 10.25, "mean_accuracy_mean": 41.08088271604938, "mean_accuracy_min": 40.78966666666666, "mean_accuracy_max": 41.378666666666675, "num_model_switches_mean": 6.025185185185183, "num_model_switches_min": 5.65, "num_model_switches_max": 6.37, "num_slav_mean": 0.15969135802469137, "num_slav_min": 0.13848333333333335, "num_slav_max": 0.18421666666666664, "cpu_conserved_cost_mean": 2.735185185185185, "cpu_conserved_cost_min": 2.06, "cpu_conserved_cost_max": 3.68, "mean_cluster_cpu_util_mean": 0.5709264502392205, "mean_cluster_cpu_util_min": 0.5537982262292958, "mean_cluster_cpu_util_max": 0.5960963267503122, "mean_cluster_mem_util_mean": 0.3660784669366652, "mean_cluster_mem_util_min": 0.35701813269611643, "mean_cluster_mem_util_max": 0.3768369435115818, "reward_consolidation_mean_mean": 0.24961419753086414, "reward_consolidation_mean_min": 0.08333333333333331, "reward_consolidation_mean_max": 0.45833333333333326, "reward_illegal_mean_mean": -1.7484567901234565, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.5499999999999998, "reward_accuracy_mean_mean": 0.917592592592593, "reward_accuracy_mean_min": 0.5249999999999997, "reward_accuracy_mean_max": 1.4916666666666694, "reward_sla_mean_mean": -0.45813425925925916, "reward_sla_mean_min": -0.711, "reward_sla_mean_max": -0.28075000000000006, "reward_consolidation_sum_mean": 24.961419753086417, "reward_consolidation_sum_min": 8.333333333333332, "reward_consolidation_sum_max": 45.83333333333333, "reward_illegal_sum_mean": -174.84567901234564, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -154.99999999999997, "reward_accuracy_sum_mean": 91.7592592592593, "reward_accuracy_sum_min": 52.49999999999997, "reward_accuracy_sum_max": 149.16666666666694, "reward_sla_sum_mean": -45.81342592592592, "reward_sla_sum_min": -71.1, "reward_sla_sum_max": -28.075000000000003, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 950.0, "global_timestep_min": 100, "global_timestep_max": 1800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-61.816666666666485, -85.41666666666667, -138.65833333333336, -116.34166666666684, -143.27500000000003, -94.27499999999995, -114.04999999999998, -76.14999999999993, -119.34166666666673, -85.50833333333333, -128.41666666666674, -154.6916666666667, -60.68333333333305, -140.62499999999994, -154.41666666666674, -88.30833333333325, -114.31666666666669, -121.25833333333341, -145.1416666666667, -150.15833333333327, -96.91666666666657, -121.7916666666667, -130.6916666666667, -104.85000000000001, -94.60000000000012, -59.183333333333195, -130.03333333333342, -105.99166666666677, -65.31666666666659, -45.4666666666666, -100.05833333333332, -141.1166666666666, -70.95833333333317, -161.1666666666667, -73.58333333333323, -113.16666666666673, -78.95000000000005, -126.70000000000002, -65.63333333333337, -62.466666666666534, -71.98333333333338, -87.62499999999994, -80.6666666666665, -96.47500000000011, -136.51666666666674, -95.98333333333335, -147.2833333333332, -96.30000000000004, -86.58333333333334, -115.90000000000006, -93.43333333333342, -94.97500000000008, -95.64166666666667, -71.81666666666665], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-61.816666666666485, -85.41666666666667, -138.65833333333336, -116.34166666666684, -143.27500000000003, -94.27499999999995, -114.04999999999998, -76.14999999999993, -119.34166666666673, -85.50833333333333, -128.41666666666674, -154.6916666666667, -60.68333333333305, -140.62499999999994, -154.41666666666674, -88.30833333333325, -114.31666666666669, -121.25833333333341, -145.1416666666667, -150.15833333333327, -96.91666666666657, -121.7916666666667, -130.6916666666667, -104.85000000000001, -94.60000000000012, -59.183333333333195, -130.03333333333342, -105.99166666666677, -65.31666666666659, -45.4666666666666, -100.05833333333332, -141.1166666666666, -70.95833333333317, -161.1666666666667, -73.58333333333323, -113.16666666666673, -78.95000000000005, -126.70000000000002, -65.63333333333337, -62.466666666666534, -71.98333333333338, -87.62499999999994, -80.6666666666665, -96.47500000000011, -136.51666666666674, -95.98333333333335, -147.2833333333332, -96.30000000000004, -86.58333333333334, -115.90000000000006, -93.43333333333342, -94.97500000000008, -95.64166666666667, -71.81666666666665]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22714747167791646, "mean_inference_ms": 1.9729937584325665, "mean_action_processing_ms": 0.08737062608237987, "mean_env_wait_ms": 1.4465160535810435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007220109303792317, "StateBufferConnector_ms": 0.003211586563675492, "ViewRequirementAgentConnector_ms": 0.07943312327067058}, "num_episodes": 27, "episode_return_max": -45.4666666666666, "episode_return_min": -161.1666666666667, "episode_return_mean": -103.9384259259259, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5400, "num_agent_steps_trained": 5100, "num_env_steps_sampled": 5400, "num_env_steps_trained": 5100, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 256.3065645941669, "num_env_steps_trained_throughput_per_sec": 256.3065645941669, "timesteps_total": 5400, "num_env_steps_sampled_lifetime": 5400, "num_agent_steps_sampled_lifetime": 5400, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 5400, "timers": {"training_iteration_time_ms": 10485.045, "restore_workers_time_ms": 0.014, "training_step_time_ms": 587.53, "sample_time_ms": 572.506, "synch_weights_time_ms": 13.455}, "counters": {"num_env_steps_sampled": 5400, "num_env_steps_trained": 5100, "num_agent_steps_sampled": 5400, "num_agent_steps_trained": 5100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 36, "num_samples_added_to_queue": 5400}, "done": false, "training_iteration": 2, "trial_id": "27800_00000", "date": "2024-10-12_15-28-10", "timestamp": 1728743290, "time_this_iter_s": 10.540841579437256, "time_total_s": 20.990562200546265, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c0910>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20.990562200546265, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 16.612499999999997, "ram_util_percent": 28.931250000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -96204.328125, "policy_loss": -96421.890625, "entropy": 29.81793212890625, "entropy_coeff": 0.01, "var_gnorm": 16.004262924194336, "vf_loss": 30701.37890625, "vf_explained_var": 0.001904308795928955}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 7950, "num_env_steps_trained": 7800, "num_agent_steps_sampled": 7950, "num_agent_steps_trained": 7800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 53, "num_samples_added_to_queue": 7800, "learner_queue": {"size_count": 26, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.819, "learner_load_time_ms": 0.22, "learner_load_wait_time_ms": 1120.269, "learner_dequeue_time_ms": 7327.223}}, "env_runners": {"episode_reward_max": -45.4666666666666, "episode_reward_min": -161.1666666666667, "episode_reward_mean": -102.73162393162394, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 7800, "policy_reward_min": {"default_policy": -161.1666666666667}, "policy_reward_max": {"default_policy": -45.4666666666666}, "policy_reward_mean": {"default_policy": -102.73162393162394}, "custom_metrics": {"num_consolidated_mean": 0.6734615384615384, "num_consolidated_min": 0.52, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0441025641025645, "num_overloaded_min": 0.92, "num_overloaded_max": 1.2, "num_moves_mean": 9.992564102564103, "num_moves_min": 9.69, "num_moves_max": 10.33, "mean_accuracy_mean": 41.09504700854701, "mean_accuracy_min": 40.78966666666666, "mean_accuracy_max": 41.378666666666675, "num_model_switches_mean": 6.015641025641025, "num_model_switches_min": 5.63, "num_model_switches_max": 6.37, "num_slav_mean": 0.16039679487179484, "num_slav_min": 0.13848333333333335, "num_slav_max": 0.18421666666666664, "cpu_conserved_cost_mean": 2.670769230769231, "cpu_conserved_cost_min": 2.06, "cpu_conserved_cost_max": 3.68, "mean_cluster_cpu_util_mean": 0.5702730294020218, "mean_cluster_cpu_util_min": 0.5537635277255419, "mean_cluster_cpu_util_max": 0.5960963267503122, "mean_cluster_mem_util_mean": 0.3657622596659837, "mean_cluster_mem_util_min": 0.35701813269611643, "mean_cluster_mem_util_max": 0.3768369435115818, "reward_consolidation_mean_mean": 0.25026709401709385, "reward_consolidation_mean_min": 0.08333333333333331, "reward_consolidation_mean_max": 0.45833333333333326, "reward_illegal_mean_mean": -1.74017094017094, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.5333333333333332, "reward_accuracy_mean_mean": 0.9292735042735044, "reward_accuracy_mean_min": 0.5249999999999997, "reward_accuracy_mean_max": 1.4916666666666694, "reward_sla_mean_mean": -0.46668589743589745, "reward_sla_mean_min": -0.711, "reward_sla_mean_max": -0.28075000000000006, "reward_consolidation_sum_mean": 25.026709401709393, "reward_consolidation_sum_min": 8.333333333333332, "reward_consolidation_sum_max": 45.83333333333333, "reward_illegal_sum_mean": -174.017094017094, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -153.33333333333331, "reward_accuracy_sum_mean": 92.92735042735042, "reward_accuracy_sum_min": 52.49999999999997, "reward_accuracy_sum_max": 149.16666666666694, "reward_sla_sum_mean": -46.66858974358975, "reward_sla_sum_min": -71.1, "reward_sla_sum_max": -28.075000000000003, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1350.0, "global_timestep_min": 100, "global_timestep_max": 2600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-61.816666666666485, -85.41666666666667, -138.65833333333336, -116.34166666666684, -143.27500000000003, -94.27499999999995, -114.04999999999998, -76.14999999999993, -119.34166666666673, -85.50833333333333, -128.41666666666674, -154.6916666666667, -60.68333333333305, -140.62499999999994, -154.41666666666674, -88.30833333333325, -114.31666666666669, -121.25833333333341, -145.1416666666667, -150.15833333333327, -96.91666666666657, -121.7916666666667, -130.6916666666667, -104.85000000000001, -94.60000000000012, -59.183333333333195, -130.03333333333342, -105.99166666666677, -65.31666666666659, -45.4666666666666, -100.05833333333332, -141.1166666666666, -70.95833333333317, -161.1666666666667, -73.58333333333323, -113.16666666666673, -78.95000000000005, -126.70000000000002, -65.63333333333337, -62.466666666666534, -71.98333333333338, -87.62499999999994, -80.6666666666665, -96.47500000000011, -136.51666666666674, -95.98333333333335, -147.2833333333332, -96.30000000000004, -86.58333333333334, -115.90000000000006, -93.43333333333342, -94.97500000000008, -95.64166666666667, -71.81666666666665, -126.28333333333335, -129.50833333333333, -100.75833333333334, -112.43333333333338, -77.58333333333327, -87.24166666666659, -93.65000000000008, -91.6750000000001, -89.0833333333332, -107.27500000000005, -70.58333333333341, -75.37499999999994, -79.2833333333333, -126.35000000000016, -123.84166666666671, -124.45000000000017, -64.07500000000006, -115.81666666666663, -130.66666666666666, -98.97500000000012, -95.24999999999991, -113.71666666666664, -110.02500000000002, -56.49166666666667], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-61.816666666666485, -85.41666666666667, -138.65833333333336, -116.34166666666684, -143.27500000000003, -94.27499999999995, -114.04999999999998, -76.14999999999993, -119.34166666666673, -85.50833333333333, -128.41666666666674, -154.6916666666667, -60.68333333333305, -140.62499999999994, -154.41666666666674, -88.30833333333325, -114.31666666666669, -121.25833333333341, -145.1416666666667, -150.15833333333327, -96.91666666666657, -121.7916666666667, -130.6916666666667, -104.85000000000001, -94.60000000000012, -59.183333333333195, -130.03333333333342, -105.99166666666677, -65.31666666666659, -45.4666666666666, -100.05833333333332, -141.1166666666666, -70.95833333333317, -161.1666666666667, -73.58333333333323, -113.16666666666673, -78.95000000000005, -126.70000000000002, -65.63333333333337, -62.466666666666534, -71.98333333333338, -87.62499999999994, -80.6666666666665, -96.47500000000011, -136.51666666666674, -95.98333333333335, -147.2833333333332, -96.30000000000004, -86.58333333333334, -115.90000000000006, -93.43333333333342, -94.97500000000008, -95.64166666666667, -71.81666666666665, -126.28333333333335, -129.50833333333333, -100.75833333333334, -112.43333333333338, -77.58333333333327, -87.24166666666659, -93.65000000000008, -91.6750000000001, -89.0833333333332, -107.27500000000005, -70.58333333333341, -75.37499999999994, -79.2833333333333, -126.35000000000016, -123.84166666666671, -124.45000000000017, -64.07500000000006, -115.81666666666663, -130.66666666666666, -98.97500000000012, -95.24999999999991, -113.71666666666664, -110.02500000000002, -56.49166666666667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22798966960719005, "mean_inference_ms": 1.9751330098990258, "mean_action_processing_ms": 0.08742521304785383, "mean_env_wait_ms": 1.450391385366151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006935535333095453, "StateBufferConnector_ms": 0.0031963372841859474, "ViewRequirementAgentConnector_ms": 0.07978035853459285}, "num_episodes": 24, "episode_return_max": -45.4666666666666, "episode_return_min": -161.1666666666667, "episode_return_mean": -102.73162393162394, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7950, "num_agent_steps_trained": 7800, "num_env_steps_sampled": 7950, "num_env_steps_trained": 7800, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 253.84449813825972, "num_env_steps_trained_throughput_per_sec": 268.7765274405103, "timesteps_total": 7950, "num_env_steps_sampled_lifetime": 7950, "num_agent_steps_sampled_lifetime": 7950, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 7950, "timers": {"training_iteration_time_ms": 10338.539, "restore_workers_time_ms": 0.013, "training_step_time_ms": 590.507, "sample_time_ms": 575.682, "synch_weights_time_ms": 13.388}, "counters": {"num_env_steps_sampled": 7950, "num_env_steps_trained": 7800, "num_agent_steps_sampled": 7950, "num_agent_steps_trained": 7800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 53, "num_samples_added_to_queue": 7800}, "done": false, "training_iteration": 3, "trial_id": "27800_00000", "date": "2024-10-12_15-28-20", "timestamp": 1728743300, "time_this_iter_s": 10.060865640640259, "time_total_s": 31.051427841186523, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c28f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 31.051427841186523, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 16.72142857142857, "ram_util_percent": 29.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -99905.796875, "policy_loss": -100127.546875, "entropy": 29.817102432250977, "entropy_coeff": 0.01, "var_gnorm": 16.007492065429688, "vf_loss": 31120.181640625, "vf_explained_var": 0.0031390786170959473}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 10650, "num_env_steps_trained": 10500, "num_agent_steps_sampled": 10650, "num_agent_steps_trained": 10500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 71, "num_samples_added_to_queue": 10500, "learner_queue": {"size_count": 35, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.077, "learner_load_time_ms": 0.239, "learner_load_wait_time_ms": 1130.574, "learner_dequeue_time_ms": 7741.912}}, "env_runners": {"episode_reward_max": -45.4666666666666, "episode_reward_min": -161.1666666666667, "episode_reward_mean": -102.38575, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -161.1666666666667}, "policy_reward_max": {"default_policy": -45.4666666666666}, "policy_reward_mean": {"default_policy": -102.38575}, "custom_metrics": {"num_consolidated_mean": 0.6791000000000001, "num_consolidated_min": 0.52, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.043, "num_overloaded_min": 0.89, "num_overloaded_max": 1.2, "num_moves_mean": 9.9917, "num_moves_min": 9.69, "num_moves_max": 10.33, "mean_accuracy_mean": 41.09689666666666, "mean_accuracy_min": 40.78966666666666, "mean_accuracy_max": 41.378666666666675, "num_model_switches_mean": 5.999599999999999, "num_model_switches_min": 5.6, "num_model_switches_max": 6.43, "num_slav_mean": 0.16110316666666666, "num_slav_min": 0.13848333333333335, "num_slav_max": 0.18098333333333333, "cpu_conserved_cost_mean": 2.6918, "cpu_conserved_cost_min": 2.06, "cpu_conserved_cost_max": 3.68, "mean_cluster_cpu_util_mean": 0.5703998895949852, "mean_cluster_cpu_util_min": 0.5507243250447497, "mean_cluster_cpu_util_max": 0.6000842514946744, "mean_cluster_mem_util_mean": 0.3657341248421309, "mean_cluster_mem_util_min": 0.3556971531545107, "mean_cluster_mem_util_max": 0.38158464795200786, "reward_consolidation_mean_mean": 0.25125, "reward_consolidation_mean_min": 0.08333333333333331, "reward_consolidation_mean_max": 0.45833333333333326, "reward_illegal_mean_mean": -1.738333333333333, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.483333333333333, "reward_accuracy_mean_mean": 0.9318333333333336, "reward_accuracy_mean_min": 0.5249999999999997, "reward_accuracy_mean_max": 1.4916666666666694, "reward_sla_mean_mean": -0.4686075000000001, "reward_sla_mean_min": -0.77775, "reward_sla_mean_max": -0.2805, "reward_consolidation_sum_mean": 25.124999999999996, "reward_consolidation_sum_min": 8.333333333333332, "reward_consolidation_sum_max": 45.83333333333333, "reward_illegal_sum_mean": -173.8333333333333, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -148.3333333333333, "reward_accuracy_sum_mean": 93.18333333333335, "reward_accuracy_sum_min": 52.49999999999997, "reward_accuracy_sum_max": 149.16666666666694, "reward_sla_sum_mean": -46.860749999999996, "reward_sla_sum_min": -77.775, "reward_sla_sum_max": -28.05, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1875.0, "global_timestep_min": 100, "global_timestep_max": 3500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-94.27499999999995, -114.04999999999998, -76.14999999999993, -119.34166666666673, -85.50833333333333, -128.41666666666674, -154.6916666666667, -60.68333333333305, -140.62499999999994, -154.41666666666674, -88.30833333333325, -114.31666666666669, -121.25833333333341, -145.1416666666667, -150.15833333333327, -96.91666666666657, -121.7916666666667, -130.6916666666667, -104.85000000000001, -94.60000000000012, -59.183333333333195, -130.03333333333342, -105.99166666666677, -65.31666666666659, -45.4666666666666, -100.05833333333332, -141.1166666666666, -70.95833333333317, -161.1666666666667, -73.58333333333323, -113.16666666666673, -78.95000000000005, -126.70000000000002, -65.63333333333337, -62.466666666666534, -71.98333333333338, -87.62499999999994, -80.6666666666665, -96.47500000000011, -136.51666666666674, -95.98333333333335, -147.2833333333332, -96.30000000000004, -86.58333333333334, -115.90000000000006, -93.43333333333342, -94.97500000000008, -95.64166666666667, -71.81666666666665, -126.28333333333335, -129.50833333333333, -100.75833333333334, -112.43333333333338, -77.58333333333327, -87.24166666666659, -93.65000000000008, -91.6750000000001, -89.0833333333332, -107.27500000000005, -70.58333333333341, -75.37499999999994, -79.2833333333333, -126.35000000000016, -123.84166666666671, -124.45000000000017, -64.07500000000006, -115.81666666666663, -130.66666666666666, -98.97500000000012, -95.24999999999991, -113.71666666666664, -110.02500000000002, -56.49166666666667, -90.13333333333327, -88.5749999999999, -123.4333333333333, -102.41666666666671, -96.95833333333343, -101.20000000000014, -94.63333333333341, -83.08333333333333, -80.66666666666644, -99.40833333333332, -113.90833333333319, -125.96666666666677, -137.69999999999996, -102.62500000000003, -118.74999999999999, -87.7166666666668, -129.0000000000001, -132.14166666666677, -85.27499999999989, -112.94166666666676, -89.92499999999994, -101.66666666666666, -76.33333333333327, -118.33333333333344, -121.72500000000015, -96.66666666666659, -59.83333333333338], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-94.27499999999995, -114.04999999999998, -76.14999999999993, -119.34166666666673, -85.50833333333333, -128.41666666666674, -154.6916666666667, -60.68333333333305, -140.62499999999994, -154.41666666666674, -88.30833333333325, -114.31666666666669, -121.25833333333341, -145.1416666666667, -150.15833333333327, -96.91666666666657, -121.7916666666667, -130.6916666666667, -104.85000000000001, -94.60000000000012, -59.183333333333195, -130.03333333333342, -105.99166666666677, -65.31666666666659, -45.4666666666666, -100.05833333333332, -141.1166666666666, -70.95833333333317, -161.1666666666667, -73.58333333333323, -113.16666666666673, -78.95000000000005, -126.70000000000002, -65.63333333333337, -62.466666666666534, -71.98333333333338, -87.62499999999994, -80.6666666666665, -96.47500000000011, -136.51666666666674, -95.98333333333335, -147.2833333333332, -96.30000000000004, -86.58333333333334, -115.90000000000006, -93.43333333333342, -94.97500000000008, -95.64166666666667, -71.81666666666665, -126.28333333333335, -129.50833333333333, -100.75833333333334, -112.43333333333338, -77.58333333333327, -87.24166666666659, -93.65000000000008, -91.6750000000001, -89.0833333333332, -107.27500000000005, -70.58333333333341, -75.37499999999994, -79.2833333333333, -126.35000000000016, -123.84166666666671, -124.45000000000017, -64.07500000000006, -115.81666666666663, -130.66666666666666, -98.97500000000012, -95.24999999999991, -113.71666666666664, -110.02500000000002, -56.49166666666667, -90.13333333333327, -88.5749999999999, -123.4333333333333, -102.41666666666671, -96.95833333333343, -101.20000000000014, -94.63333333333341, -83.08333333333333, -80.66666666666644, -99.40833333333332, -113.90833333333319, -125.96666666666677, -137.69999999999996, -102.62500000000003, -118.74999999999999, -87.7166666666668, -129.0000000000001, -132.14166666666677, -85.27499999999989, -112.94166666666676, -89.92499999999994, -101.66666666666666, -76.33333333333327, -118.33333333333344, -121.72500000000015, -96.66666666666659, -59.83333333333338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22871354395989943, "mean_inference_ms": 1.9693184004309707, "mean_action_processing_ms": 0.08733603103500481, "mean_env_wait_ms": 1.4522763302606814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006682872772216797, "StateBufferConnector_ms": 0.003204345703125, "ViewRequirementAgentConnector_ms": 0.08010315895080566}, "num_episodes": 27, "episode_return_max": -45.4666666666666, "episode_return_min": -161.1666666666667, "episode_return_mean": -102.38575, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10650, "num_agent_steps_trained": 10500, "num_env_steps_sampled": 10650, "num_env_steps_trained": 10500, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 255.08707511488086, "num_env_steps_trained_throughput_per_sec": 255.08707511488086, "timesteps_total": 10650, "num_env_steps_sampled_lifetime": 10650, "num_agent_steps_sampled_lifetime": 10650, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 10650, "timers": {"training_iteration_time_ms": 10400.061, "restore_workers_time_ms": 0.014, "training_step_time_ms": 594.653, "sample_time_ms": 579.763, "synch_weights_time_ms": 13.4}, "counters": {"num_env_steps_sampled": 10650, "num_env_steps_trained": 10500, "num_agent_steps_sampled": 10650, "num_agent_steps_trained": 10500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 71, "num_samples_added_to_queue": 10500}, "done": false, "training_iteration": 4, "trial_id": "27800_00000", "date": "2024-10-12_15-28-31", "timestamp": 1728743311, "time_this_iter_s": 10.603476285934448, "time_total_s": 41.65490412712097, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c1d80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 41.65490412712097, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 16.566666666666666, "ram_util_percent": 29.459999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -91549.9140625, "policy_loss": -91757.671875, "entropy": 29.81573486328125, "entropy_coeff": 0.01, "var_gnorm": 16.011173248291016, "vf_loss": 29720.1015625, "vf_explained_var": 0.0037813782691955566}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 13350, "num_env_steps_trained": 13200, "num_agent_steps_sampled": 13350, "num_agent_steps_trained": 13200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 89, "num_samples_added_to_queue": 13200, "learner_queue": {"size_count": 44, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.462, "learner_load_time_ms": 0.234, "learner_load_wait_time_ms": 1124.455, "learner_dequeue_time_ms": 8053.977}}, "env_runners": {"episode_reward_max": -56.49166666666667, "episode_reward_min": -161.1666666666667, "episode_reward_mean": -98.60466666666667, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -161.1666666666667}, "policy_reward_max": {"default_policy": -56.49166666666667}, "policy_reward_mean": {"default_policy": -98.60466666666667}, "custom_metrics": {"num_consolidated_mean": 0.6740999999999999, "num_consolidated_min": 0.52, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0334, "num_overloaded_min": 0.89, "num_overloaded_max": 1.2, "num_moves_mean": 9.982399999999998, "num_moves_min": 9.61, "num_moves_max": 10.33, "mean_accuracy_mean": 41.10386333333334, "mean_accuracy_min": 40.78966666666666, "mean_accuracy_max": 41.378666666666675, "num_model_switches_mean": 5.9925, "num_model_switches_min": 5.6, "num_model_switches_max": 6.43, "num_slav_mean": 0.16255566666666663, "num_slav_min": 0.14343333333333336, "num_slav_max": 0.18098333333333333, "cpu_conserved_cost_mean": 2.6576, "cpu_conserved_cost_min": 2.06, "cpu_conserved_cost_max": 3.64, "mean_cluster_cpu_util_mean": 0.568640951028964, "mean_cluster_cpu_util_min": 0.5507243250447497, "mean_cluster_cpu_util_max": 0.6000842514946744, "mean_cluster_mem_util_mean": 0.3649782849303223, "mean_cluster_mem_util_min": 0.3556971531545107, "mean_cluster_mem_util_max": 0.38158464795200786, "reward_consolidation_mean_mean": 0.260625, "reward_consolidation_mean_min": 0.08333333333333331, "reward_consolidation_mean_max": 0.5208333333333333, "reward_illegal_mean_mean": -1.7223333333333333, "reward_illegal_mean_min": -1.9999999999999998, "reward_illegal_mean_max": -1.483333333333333, "reward_accuracy_mean_mean": 0.9571666666666668, "reward_accuracy_mean_min": 0.5833333333333327, "reward_accuracy_mean_max": 1.2833333333333343, "reward_sla_mean_mean": -0.481505, "reward_sla_mean_min": -0.77775, "reward_sla_mean_max": -0.2805, "reward_consolidation_sum_mean": 26.062499999999996, "reward_consolidation_sum_min": 8.333333333333332, "reward_consolidation_sum_max": 52.08333333333333, "reward_illegal_sum_mean": -172.2333333333333, "reward_illegal_sum_min": -199.99999999999997, "reward_illegal_sum_max": -148.3333333333333, "reward_accuracy_sum_mean": 95.7166666666667, "reward_accuracy_sum_min": 58.33333333333327, "reward_accuracy_sum_max": 128.33333333333343, "reward_sla_sum_mean": -48.1505, "reward_sla_sum_min": -77.775, "reward_sla_sum_max": -28.05, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2775.0, "global_timestep_min": 1000, "global_timestep_max": 4400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-70.95833333333317, -161.1666666666667, -73.58333333333323, -113.16666666666673, -78.95000000000005, -126.70000000000002, -65.63333333333337, -62.466666666666534, -71.98333333333338, -87.62499999999994, -80.6666666666665, -96.47500000000011, -136.51666666666674, -95.98333333333335, -147.2833333333332, -96.30000000000004, -86.58333333333334, -115.90000000000006, -93.43333333333342, -94.97500000000008, -95.64166666666667, -71.81666666666665, -126.28333333333335, -129.50833333333333, -100.75833333333334, -112.43333333333338, -77.58333333333327, -87.24166666666659, -93.65000000000008, -91.6750000000001, -89.0833333333332, -107.27500000000005, -70.58333333333341, -75.37499999999994, -79.2833333333333, -126.35000000000016, -123.84166666666671, -124.45000000000017, -64.07500000000006, -115.81666666666663, -130.66666666666666, -98.97500000000012, -95.24999999999991, -113.71666666666664, -110.02500000000002, -56.49166666666667, -90.13333333333327, -88.5749999999999, -123.4333333333333, -102.41666666666671, -96.95833333333343, -101.20000000000014, -94.63333333333341, -83.08333333333333, -80.66666666666644, -99.40833333333332, -113.90833333333319, -125.96666666666677, -137.69999999999996, -102.62500000000003, -118.74999999999999, -87.7166666666668, -129.0000000000001, -132.14166666666677, -85.27499999999989, -112.94166666666676, -89.92499999999994, -101.66666666666666, -76.33333333333327, -118.33333333333344, -121.72500000000015, -96.66666666666659, -59.83333333333338, -117.15000000000006, -84.10833333333329, -99.81666666666658, -119.60833333333326, -72.00833333333338, -96.50833333333344, -78.96666666666651, -88.85000000000001, -61.12499999999996, -95.26666666666665, -116.59166666666664, -60.41666666666656, -85.09166666666657, -124.03333333333335, -73.19166666666656, -101.78333333333342, -115.52500000000003, -115.80833333333322, -109.53333333333337, -95.07500000000003, -66.13333333333327, -88.30000000000003, -88.04166666666661, -109.99999999999996, -126.0083333333334, -81.99166666666672, -94.31666666666673], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-70.95833333333317, -161.1666666666667, -73.58333333333323, -113.16666666666673, -78.95000000000005, -126.70000000000002, -65.63333333333337, -62.466666666666534, -71.98333333333338, -87.62499999999994, -80.6666666666665, -96.47500000000011, -136.51666666666674, -95.98333333333335, -147.2833333333332, -96.30000000000004, -86.58333333333334, -115.90000000000006, -93.43333333333342, -94.97500000000008, -95.64166666666667, -71.81666666666665, -126.28333333333335, -129.50833333333333, -100.75833333333334, -112.43333333333338, -77.58333333333327, -87.24166666666659, -93.65000000000008, -91.6750000000001, -89.0833333333332, -107.27500000000005, -70.58333333333341, -75.37499999999994, -79.2833333333333, -126.35000000000016, -123.84166666666671, -124.45000000000017, -64.07500000000006, -115.81666666666663, -130.66666666666666, -98.97500000000012, -95.24999999999991, -113.71666666666664, -110.02500000000002, -56.49166666666667, -90.13333333333327, -88.5749999999999, -123.4333333333333, -102.41666666666671, -96.95833333333343, -101.20000000000014, -94.63333333333341, -83.08333333333333, -80.66666666666644, -99.40833333333332, -113.90833333333319, -125.96666666666677, -137.69999999999996, -102.62500000000003, -118.74999999999999, -87.7166666666668, -129.0000000000001, -132.14166666666677, -85.27499999999989, -112.94166666666676, -89.92499999999994, -101.66666666666666, -76.33333333333327, -118.33333333333344, -121.72500000000015, -96.66666666666659, -59.83333333333338, -117.15000000000006, -84.10833333333329, -99.81666666666658, -119.60833333333326, -72.00833333333338, -96.50833333333344, -78.96666666666651, -88.85000000000001, -61.12499999999996, -95.26666666666665, -116.59166666666664, -60.41666666666656, -85.09166666666657, -124.03333333333335, -73.19166666666656, -101.78333333333342, -115.52500000000003, -115.80833333333322, -109.53333333333337, -95.07500000000003, -66.13333333333327, -88.30000000000003, -88.04166666666661, -109.99999999999996, -126.0083333333334, -81.99166666666672, -94.31666666666673]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2296608556893679, "mean_inference_ms": 1.9697166799540742, "mean_action_processing_ms": 0.08736531899819155, "mean_env_wait_ms": 1.4570376538636622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006325721740722656, "StateBufferConnector_ms": 0.003188610076904297, "ViewRequirementAgentConnector_ms": 0.08139348030090332}, "num_episodes": 27, "episode_return_max": -56.49166666666667, "episode_return_min": -161.1666666666667, "episode_return_mean": -98.60466666666667, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13350, "num_agent_steps_trained": 13200, "num_env_steps_sampled": 13350, "num_env_steps_trained": 13200, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 256.2602527333419, "num_env_steps_trained_throughput_per_sec": 256.2602527333419, "timesteps_total": 13350, "num_env_steps_sampled_lifetime": 13350, "num_agent_steps_sampled_lifetime": 13350, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 13350, "timers": {"training_iteration_time_ms": 10427.283, "restore_workers_time_ms": 0.013, "training_step_time_ms": 580.243, "sample_time_ms": 566.029, "synch_weights_time_ms": 12.808}, "counters": {"num_env_steps_sampled": 13350, "num_env_steps_trained": 13200, "num_agent_steps_sampled": 13350, "num_agent_steps_trained": 13200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 89, "num_samples_added_to_queue": 13200}, "done": false, "training_iteration": 5, "trial_id": "27800_00000", "date": "2024-10-12_15-28-41", "timestamp": 1728743321, "time_this_iter_s": 10.545201778411865, "time_total_s": 52.20010590553284, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f3910>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 52.20010590553284, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 16.693333333333335, "ram_util_percent": 29.693333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -78148.6796875, "policy_loss": -78252.71875, "entropy": 29.813480377197266, "entropy_coeff": 0.01, "var_gnorm": 16.015697479248047, "vf_loss": 19347.478515625, "vf_explained_var": 0.007703423500061035}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 15900, "num_env_steps_trained": 15600, "num_agent_steps_sampled": 15900, "num_agent_steps_trained": 15600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 106, "num_samples_added_to_queue": 15900, "learner_queue": {"size_count": 52, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.773, "learner_load_time_ms": 0.271, "learner_load_wait_time_ms": 1145.535, "learner_dequeue_time_ms": 8240.183}}, "env_runners": {"episode_reward_max": -45.52499999999995, "episode_reward_min": -137.69999999999996, "episode_reward_mean": -94.48316666666669, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -137.69999999999996}, "policy_reward_max": {"default_policy": -45.52499999999995}, "policy_reward_mean": {"default_policy": -94.48316666666669}, "custom_metrics": {"num_consolidated_mean": 0.6698999999999999, "num_consolidated_min": 0.52, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0218, "num_overloaded_min": 0.87, "num_overloaded_max": 1.15, "num_moves_mean": 9.986199999999998, "num_moves_min": 9.61, "num_moves_max": 10.32, "mean_accuracy_mean": 41.11779666666666, "mean_accuracy_min": 40.852999999999994, "mean_accuracy_max": 41.35966666666666, "num_model_switches_mean": 5.994399999999998, "num_model_switches_min": 5.6, "num_model_switches_max": 6.43, "num_slav_mean": 0.1640273333333333, "num_slav_min": 0.1451833333333333, "num_slav_max": 0.19270000000000004, "cpu_conserved_cost_mean": 2.631, "cpu_conserved_cost_min": 1.9, "cpu_conserved_cost_max": 3.64, "mean_cluster_cpu_util_mean": 0.5672420484055914, "mean_cluster_cpu_util_min": 0.5451621608135973, "mean_cluster_cpu_util_max": 0.6000842514946744, "mean_cluster_mem_util_mean": 0.3644090972598955, "mean_cluster_mem_util_min": 0.3556971531545107, "mean_cluster_mem_util_max": 0.38158464795200786, "reward_consolidation_mean_mean": 0.26562499999999994, "reward_consolidation_mean_min": 0.08333333333333331, "reward_consolidation_mean_max": 0.5208333333333333, "reward_illegal_mean_mean": -1.7029999999999996, "reward_illegal_mean_min": -1.916666666666666, "reward_illegal_mean_max": -1.4499999999999997, "reward_accuracy_mean_mean": 0.9938333333333333, "reward_accuracy_mean_min": 0.5916666666666671, "reward_accuracy_mean_max": 1.4750000000000016, "reward_sla_mean_mean": -0.50129, "reward_sla_mean_min": -0.8152499999999999, "reward_sla_mean_max": -0.2805, "reward_consolidation_sum_mean": 26.562499999999996, "reward_consolidation_sum_min": 8.333333333333332, "reward_consolidation_sum_max": 52.08333333333333, "reward_illegal_sum_mean": -170.29999999999995, "reward_illegal_sum_min": -191.6666666666666, "reward_illegal_sum_max": -144.99999999999997, "reward_accuracy_sum_mean": 99.38333333333334, "reward_accuracy_sum_min": 59.16666666666671, "reward_accuracy_sum_max": 147.50000000000017, "reward_sla_sum_mean": -50.129000000000005, "reward_sla_sum_min": -81.52499999999999, "reward_sla_sum_max": -28.05, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3675.0, "global_timestep_min": 1900, "global_timestep_max": 5300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-87.24166666666659, -93.65000000000008, -91.6750000000001, -89.0833333333332, -107.27500000000005, -70.58333333333341, -75.37499999999994, -79.2833333333333, -126.35000000000016, -123.84166666666671, -124.45000000000017, -64.07500000000006, -115.81666666666663, -130.66666666666666, -98.97500000000012, -95.24999999999991, -113.71666666666664, -110.02500000000002, -56.49166666666667, -90.13333333333327, -88.5749999999999, -123.4333333333333, -102.41666666666671, -96.95833333333343, -101.20000000000014, -94.63333333333341, -83.08333333333333, -80.66666666666644, -99.40833333333332, -113.90833333333319, -125.96666666666677, -137.69999999999996, -102.62500000000003, -118.74999999999999, -87.7166666666668, -129.0000000000001, -132.14166666666677, -85.27499999999989, -112.94166666666676, -89.92499999999994, -101.66666666666666, -76.33333333333327, -118.33333333333344, -121.72500000000015, -96.66666666666659, -59.83333333333338, -117.15000000000006, -84.10833333333329, -99.81666666666658, -119.60833333333326, -72.00833333333338, -96.50833333333344, -78.96666666666651, -88.85000000000001, -61.12499999999996, -95.26666666666665, -116.59166666666664, -60.41666666666656, -85.09166666666657, -124.03333333333335, -73.19166666666656, -101.78333333333342, -115.52500000000003, -115.80833333333322, -109.53333333333337, -95.07500000000003, -66.13333333333327, -88.30000000000003, -88.04166666666661, -109.99999999999996, -126.0083333333334, -81.99166666666672, -94.31666666666673, -83.64166666666658, -88.53333333333333, -56.54166666666648, -72.81666666666659, -81.30833333333337, -114.75833333333338, -96.99166666666662, -75.46666666666653, -72.475, -79.44999999999987, -67.6666666666667, -112.77500000000005, -45.52499999999995, -137.63333333333338, -86.7333333333334, -78.91666666666657, -100.05000000000004, -97.83333333333323, -71.47499999999988, -85.33333333333324, -61.07500000000014, -54.858333333333164, -69.10833333333336, -79.25833333333318, -76.74166666666673, -101.3083333333334, -109.95], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-87.24166666666659, -93.65000000000008, -91.6750000000001, -89.0833333333332, -107.27500000000005, -70.58333333333341, -75.37499999999994, -79.2833333333333, -126.35000000000016, -123.84166666666671, -124.45000000000017, -64.07500000000006, -115.81666666666663, -130.66666666666666, -98.97500000000012, -95.24999999999991, -113.71666666666664, -110.02500000000002, -56.49166666666667, -90.13333333333327, -88.5749999999999, -123.4333333333333, -102.41666666666671, -96.95833333333343, -101.20000000000014, -94.63333333333341, -83.08333333333333, -80.66666666666644, -99.40833333333332, -113.90833333333319, -125.96666666666677, -137.69999999999996, -102.62500000000003, -118.74999999999999, -87.7166666666668, -129.0000000000001, -132.14166666666677, -85.27499999999989, -112.94166666666676, -89.92499999999994, -101.66666666666666, -76.33333333333327, -118.33333333333344, -121.72500000000015, -96.66666666666659, -59.83333333333338, -117.15000000000006, -84.10833333333329, -99.81666666666658, -119.60833333333326, -72.00833333333338, -96.50833333333344, -78.96666666666651, -88.85000000000001, -61.12499999999996, -95.26666666666665, -116.59166666666664, -60.41666666666656, -85.09166666666657, -124.03333333333335, -73.19166666666656, -101.78333333333342, -115.52500000000003, -115.80833333333322, -109.53333333333337, -95.07500000000003, -66.13333333333327, -88.30000000000003, -88.04166666666661, -109.99999999999996, -126.0083333333334, -81.99166666666672, -94.31666666666673, -83.64166666666658, -88.53333333333333, -56.54166666666648, -72.81666666666659, -81.30833333333337, -114.75833333333338, -96.99166666666662, -75.46666666666653, -72.475, -79.44999999999987, -67.6666666666667, -112.77500000000005, -45.52499999999995, -137.63333333333338, -86.7333333333334, -78.91666666666657, -100.05000000000004, -97.83333333333323, -71.47499999999988, -85.33333333333324, -61.07500000000014, -54.858333333333164, -69.10833333333336, -79.25833333333318, -76.74166666666673, -101.3083333333334, -109.95]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22978624651666402, "mean_inference_ms": 1.9730540723829808, "mean_action_processing_ms": 0.08748905994208712, "mean_env_wait_ms": 1.4616772524973358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006336212158203125, "StateBufferConnector_ms": 0.0031790733337402344, "ViewRequirementAgentConnector_ms": 0.08214473724365234}, "num_episodes": 27, "episode_return_max": -45.52499999999995, "episode_return_min": -137.69999999999996, "episode_return_mean": -94.48316666666669, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15900, "num_agent_steps_trained": 15600, "num_env_steps_sampled": 15900, "num_env_steps_trained": 15600, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 248.98523991682515, "num_env_steps_trained_throughput_per_sec": 234.3390493334825, "timesteps_total": 15900, "num_env_steps_sampled_lifetime": 15900, "num_agent_steps_sampled_lifetime": 15900, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 15900, "timers": {"training_iteration_time_ms": 10396.335, "restore_workers_time_ms": 0.014, "training_step_time_ms": 612.774, "sample_time_ms": 598.001, "synch_weights_time_ms": 13.396}, "counters": {"num_env_steps_sampled": 15900, "num_env_steps_trained": 15600, "num_agent_steps_sampled": 15900, "num_agent_steps_trained": 15600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 106, "num_samples_added_to_queue": 15900}, "done": false, "training_iteration": 6, "trial_id": "27800_00000", "date": "2024-10-12_15-28-51", "timestamp": 1728743331, "time_this_iter_s": 10.253613233566284, "time_total_s": 62.45371913909912, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f69a50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 62.45371913909912, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 16.37333333333333, "ram_util_percent": 29.953333333333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -79744.3671875, "policy_loss": -79897.171875, "entropy": 29.809127807617188, "entropy_coeff": 0.01, "var_gnorm": 16.022010803222656, "vf_loss": 24223.37890625, "vf_explained_var": 0.006924808025360107}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 18450, "num_env_steps_trained": 18300, "num_agent_steps_sampled": 18450, "num_agent_steps_trained": 18300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 123, "num_samples_added_to_queue": 18300, "learner_queue": {"size_count": 61, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.163, "learner_load_time_ms": 0.275, "learner_load_wait_time_ms": 1156.402, "learner_dequeue_time_ms": 8422.096}}, "env_runners": {"episode_reward_max": -33.62500000000013, "episode_reward_min": -153.39166666666668, "episode_reward_mean": -93.46741666666665, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -153.39166666666668}, "policy_reward_max": {"default_policy": -33.62500000000013}, "policy_reward_mean": {"default_policy": -93.46741666666665}, "custom_metrics": {"num_consolidated_mean": 0.6788000000000001, "num_consolidated_min": 0.52, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0215, "num_overloaded_min": 0.87, "num_overloaded_max": 1.16, "num_moves_mean": 9.990600000000002, "num_moves_min": 9.61, "num_moves_max": 10.39, "mean_accuracy_mean": 41.125460000000004, "mean_accuracy_min": 40.928999999999995, "mean_accuracy_max": 41.35966666666666, "num_model_switches_mean": 5.9956999999999985, "num_model_switches_min": 5.54, "num_model_switches_max": 6.43, "num_slav_mean": 0.16439833333333337, "num_slav_min": 0.14813333333333334, "num_slav_max": 0.19270000000000004, "cpu_conserved_cost_mean": 2.6526, "cpu_conserved_cost_min": 1.9, "cpu_conserved_cost_max": 3.64, "mean_cluster_cpu_util_mean": 0.5667505898070702, "mean_cluster_cpu_util_min": 0.5451621608135973, "mean_cluster_cpu_util_max": 0.6000842514946744, "mean_cluster_mem_util_mean": 0.36411416661822954, "mean_cluster_mem_util_min": 0.3556971531545107, "mean_cluster_mem_util_max": 0.38158464795200786, "reward_consolidation_mean_mean": 0.26979166666666665, "reward_consolidation_mean_min": 0.10416666666666664, "reward_consolidation_mean_max": 0.5208333333333333, "reward_illegal_mean_mean": -1.7025, "reward_illegal_mean_min": -1.9333333333333331, "reward_illegal_mean_max": -1.4499999999999997, "reward_accuracy_mean_mean": 1.000666666666667, "reward_accuracy_mean_min": 0.5666666666666664, "reward_accuracy_mean_max": 1.4750000000000016, "reward_sla_mean_mean": -0.5026325, "reward_sla_mean_min": -0.8152499999999999, "reward_sla_mean_max": -0.2805, "reward_consolidation_sum_mean": 26.979166666666657, "reward_consolidation_sum_min": 10.416666666666664, "reward_consolidation_sum_max": 52.08333333333333, "reward_illegal_sum_mean": -170.24999999999997, "reward_illegal_sum_min": -193.33333333333331, "reward_illegal_sum_max": -144.99999999999997, "reward_accuracy_sum_mean": 100.06666666666669, "reward_accuracy_sum_min": 56.66666666666664, "reward_accuracy_sum_max": 147.50000000000017, "reward_sla_sum_mean": -50.26325, "reward_sla_sum_min": -81.52499999999999, "reward_sla_sum_max": -28.05, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4475.0, "global_timestep_min": 2700, "global_timestep_max": 6100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-101.20000000000014, -94.63333333333341, -83.08333333333333, -80.66666666666644, -99.40833333333332, -113.90833333333319, -125.96666666666677, -137.69999999999996, -102.62500000000003, -118.74999999999999, -87.7166666666668, -129.0000000000001, -132.14166666666677, -85.27499999999989, -112.94166666666676, -89.92499999999994, -101.66666666666666, -76.33333333333327, -118.33333333333344, -121.72500000000015, -96.66666666666659, -59.83333333333338, -117.15000000000006, -84.10833333333329, -99.81666666666658, -119.60833333333326, -72.00833333333338, -96.50833333333344, -78.96666666666651, -88.85000000000001, -61.12499999999996, -95.26666666666665, -116.59166666666664, -60.41666666666656, -85.09166666666657, -124.03333333333335, -73.19166666666656, -101.78333333333342, -115.52500000000003, -115.80833333333322, -109.53333333333337, -95.07500000000003, -66.13333333333327, -88.30000000000003, -88.04166666666661, -109.99999999999996, -126.0083333333334, -81.99166666666672, -94.31666666666673, -83.64166666666658, -88.53333333333333, -56.54166666666648, -72.81666666666659, -81.30833333333337, -114.75833333333338, -96.99166666666662, -75.46666666666653, -72.475, -79.44999999999987, -67.6666666666667, -112.77500000000005, -45.52499999999995, -137.63333333333338, -86.7333333333334, -78.91666666666657, -100.05000000000004, -97.83333333333323, -71.47499999999988, -85.33333333333324, -61.07500000000014, -54.858333333333164, -69.10833333333336, -79.25833333333318, -76.74166666666673, -101.3083333333334, -109.95, -153.39166666666668, -97.28333333333333, -134.34166666666664, -89.35833333333345, -99.92500000000003, -92.00833333333325, -87.41666666666653, -86.69999999999992, -118.57500000000005, -62.42499999999991, -85.17500000000003, -111.49166666666672, -57.04166666666657, -102.26666666666668, -124.09999999999997, -105.6416666666666, -104.07499999999995, -52.558333333333266, -115.10833333333348, -99.93333333333337, -33.62500000000013, -56.44166666666653, -124.85000000000007, -60.03333333333337], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-101.20000000000014, -94.63333333333341, -83.08333333333333, -80.66666666666644, -99.40833333333332, -113.90833333333319, -125.96666666666677, -137.69999999999996, -102.62500000000003, -118.74999999999999, -87.7166666666668, -129.0000000000001, -132.14166666666677, -85.27499999999989, -112.94166666666676, -89.92499999999994, -101.66666666666666, -76.33333333333327, -118.33333333333344, -121.72500000000015, -96.66666666666659, -59.83333333333338, -117.15000000000006, -84.10833333333329, -99.81666666666658, -119.60833333333326, -72.00833333333338, -96.50833333333344, -78.96666666666651, -88.85000000000001, -61.12499999999996, -95.26666666666665, -116.59166666666664, -60.41666666666656, -85.09166666666657, -124.03333333333335, -73.19166666666656, -101.78333333333342, -115.52500000000003, -115.80833333333322, -109.53333333333337, -95.07500000000003, -66.13333333333327, -88.30000000000003, -88.04166666666661, -109.99999999999996, -126.0083333333334, -81.99166666666672, -94.31666666666673, -83.64166666666658, -88.53333333333333, -56.54166666666648, -72.81666666666659, -81.30833333333337, -114.75833333333338, -96.99166666666662, -75.46666666666653, -72.475, -79.44999999999987, -67.6666666666667, -112.77500000000005, -45.52499999999995, -137.63333333333338, -86.7333333333334, -78.91666666666657, -100.05000000000004, -97.83333333333323, -71.47499999999988, -85.33333333333324, -61.07500000000014, -54.858333333333164, -69.10833333333336, -79.25833333333318, -76.74166666666673, -101.3083333333334, -109.95, -153.39166666666668, -97.28333333333333, -134.34166666666664, -89.35833333333345, -99.92500000000003, -92.00833333333325, -87.41666666666653, -86.69999999999992, -118.57500000000005, -62.42499999999991, -85.17500000000003, -111.49166666666672, -57.04166666666657, -102.26666666666668, -124.09999999999997, -105.6416666666666, -104.07499999999995, -52.558333333333266, -115.10833333333348, -99.93333333333337, -33.62500000000013, -56.44166666666653, -124.85000000000007, -60.03333333333337]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23002384250519, "mean_inference_ms": 1.977821799888466, "mean_action_processing_ms": 0.08756617283851145, "mean_env_wait_ms": 1.4650883878359648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006329536437988281, "StateBufferConnector_ms": 0.0031707286834716797, "ViewRequirementAgentConnector_ms": 0.08273005485534668}, "num_episodes": 24, "episode_return_max": -33.62500000000013, "episode_return_min": -153.39166666666668, "episode_return_mean": -93.46741666666665, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18450, "num_agent_steps_trained": 18300, "num_env_steps_sampled": 18450, "num_env_steps_trained": 18300, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 249.49929617264556, "num_env_steps_trained_throughput_per_sec": 264.1757253592718, "timesteps_total": 18450, "num_env_steps_sampled_lifetime": 18450, "num_agent_steps_sampled_lifetime": 18450, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 18450, "timers": {"training_iteration_time_ms": 10371.212, "restore_workers_time_ms": 0.014, "training_step_time_ms": 611.65, "sample_time_ms": 597.223, "synch_weights_time_ms": 13.095}, "counters": {"num_env_steps_sampled": 18450, "num_env_steps_trained": 18300, "num_agent_steps_sampled": 18450, "num_agent_steps_trained": 18300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 123, "num_samples_added_to_queue": 18300}, "done": false, "training_iteration": 7, "trial_id": "27800_00000", "date": "2024-10-12_15-29-02", "timestamp": 1728743342, "time_this_iter_s": 10.229901552200317, "time_total_s": 72.68362069129944, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c2740>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 72.68362069129944, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 16.335714285714285, "ram_util_percent": 30.042857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -82026.140625, "policy_loss": -82171.125, "entropy": 29.80251693725586, "entropy_coeff": 0.01, "var_gnorm": 16.028650283813477, "vf_loss": 23439.271484375, "vf_explained_var": 0.010958254337310791}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 21000, "num_env_steps_trained": 20700, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 20700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 140, "num_samples_added_to_queue": 21000, "learner_queue": {"size_count": 69, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.449, "learner_load_time_ms": 0.257, "learner_load_wait_time_ms": 1156.02, "learner_dequeue_time_ms": 8574.11}}, "env_runners": {"episode_reward_max": -20.93333333333337, "episode_reward_min": -153.39166666666668, "episode_reward_mean": -85.0485833333333, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -153.39166666666668}, "policy_reward_max": {"default_policy": -20.93333333333337}, "policy_reward_mean": {"default_policy": -85.0485833333333}, "custom_metrics": {"num_consolidated_mean": 0.6744, "num_consolidated_min": 0.52, "num_consolidated_max": 0.82, "num_overloaded_mean": 1.0002, "num_overloaded_min": 0.87, "num_overloaded_max": 1.16, "num_moves_mean": 10.0047, "num_moves_min": 9.67, "num_moves_max": 10.39, "mean_accuracy_mean": 41.12305333333333, "mean_accuracy_min": 40.859333333333325, "mean_accuracy_max": 41.33433333333333, "num_model_switches_mean": 6.0253000000000005, "num_model_switches_min": 5.54, "num_model_switches_max": 6.41, "num_slav_mean": 0.16385366666666668, "num_slav_min": 0.14220000000000002, "num_slav_max": 0.19270000000000004, "cpu_conserved_cost_mean": 2.6088, "cpu_conserved_cost_min": 1.9, "cpu_conserved_cost_max": 3.22, "mean_cluster_cpu_util_mean": 0.5640062857599821, "mean_cluster_cpu_util_min": 0.5396123160206178, "mean_cluster_cpu_util_max": 0.5843895994535959, "mean_cluster_mem_util_mean": 0.3629380862987599, "mean_cluster_mem_util_min": 0.3522333796176699, "mean_cluster_mem_util_max": 0.3737541065687878, "reward_consolidation_mean_mean": 0.28895833333333326, "reward_consolidation_mean_min": 0.10416666666666664, "reward_consolidation_mean_max": 0.5208333333333333, "reward_illegal_mean_mean": -1.6669999999999996, "reward_illegal_mean_min": -1.9333333333333331, "reward_illegal_mean_max": -1.4499999999999997, "reward_accuracy_mean_mean": 1.0560833333333335, "reward_accuracy_mean_min": 0.5666666666666664, "reward_accuracy_mean_max": 1.4750000000000016, "reward_sla_mean_mean": -0.5285275, "reward_sla_mean_min": -0.8152499999999999, "reward_sla_mean_max": -0.29225, "reward_consolidation_sum_mean": 28.89583333333333, "reward_consolidation_sum_min": 10.416666666666664, "reward_consolidation_sum_max": 52.08333333333333, "reward_illegal_sum_mean": -166.7, "reward_illegal_sum_min": -193.33333333333331, "reward_illegal_sum_max": -144.99999999999997, "reward_accuracy_sum_mean": 105.60833333333338, "reward_accuracy_sum_min": 56.66666666666664, "reward_accuracy_sum_max": 147.50000000000017, "reward_sla_sum_mean": -52.85274999999999, "reward_sla_sum_min": -81.52499999999999, "reward_sla_sum_max": -29.225, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5375.0, "global_timestep_min": 3600, "global_timestep_max": 7000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-96.50833333333344, -78.96666666666651, -88.85000000000001, -61.12499999999996, -95.26666666666665, -116.59166666666664, -60.41666666666656, -85.09166666666657, -124.03333333333335, -73.19166666666656, -101.78333333333342, -115.52500000000003, -115.80833333333322, -109.53333333333337, -95.07500000000003, -66.13333333333327, -88.30000000000003, -88.04166666666661, -109.99999999999996, -126.0083333333334, -81.99166666666672, -94.31666666666673, -83.64166666666658, -88.53333333333333, -56.54166666666648, -72.81666666666659, -81.30833333333337, -114.75833333333338, -96.99166666666662, -75.46666666666653, -72.475, -79.44999999999987, -67.6666666666667, -112.77500000000005, -45.52499999999995, -137.63333333333338, -86.7333333333334, -78.91666666666657, -100.05000000000004, -97.83333333333323, -71.47499999999988, -85.33333333333324, -61.07500000000014, -54.858333333333164, -69.10833333333336, -79.25833333333318, -76.74166666666673, -101.3083333333334, -109.95, -153.39166666666668, -97.28333333333333, -134.34166666666664, -89.35833333333345, -99.92500000000003, -92.00833333333325, -87.41666666666653, -86.69999999999992, -118.57500000000005, -62.42499999999991, -85.17500000000003, -111.49166666666672, -57.04166666666657, -102.26666666666668, -124.09999999999997, -105.6416666666666, -104.07499999999995, -52.558333333333266, -115.10833333333348, -99.93333333333337, -33.62500000000013, -56.44166666666653, -124.85000000000007, -60.03333333333337, -73.05833333333334, -79.01666666666664, -46.69999999999984, -91.91666666666671, -126.68333333333337, -55.65833333333327, -86.56666666666658, -109.56666666666669, -94.97500000000005, -80.74999999999997, -52.58333333333324, -65.94999999999993, -90.64166666666664, -70.51666666666667, -41.67499999999995, -46.63333333333321, -88.7833333333334, -46.34166666666648, -60.674999999999976, -42.95833333333331, -72.4999999999998, -47.53333333333322, -119.58333333333341, -61.491666666666674, -90.95833333333336, -20.93333333333337, -55.65833333333317], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-96.50833333333344, -78.96666666666651, -88.85000000000001, -61.12499999999996, -95.26666666666665, -116.59166666666664, -60.41666666666656, -85.09166666666657, -124.03333333333335, -73.19166666666656, -101.78333333333342, -115.52500000000003, -115.80833333333322, -109.53333333333337, -95.07500000000003, -66.13333333333327, -88.30000000000003, -88.04166666666661, -109.99999999999996, -126.0083333333334, -81.99166666666672, -94.31666666666673, -83.64166666666658, -88.53333333333333, -56.54166666666648, -72.81666666666659, -81.30833333333337, -114.75833333333338, -96.99166666666662, -75.46666666666653, -72.475, -79.44999999999987, -67.6666666666667, -112.77500000000005, -45.52499999999995, -137.63333333333338, -86.7333333333334, -78.91666666666657, -100.05000000000004, -97.83333333333323, -71.47499999999988, -85.33333333333324, -61.07500000000014, -54.858333333333164, -69.10833333333336, -79.25833333333318, -76.74166666666673, -101.3083333333334, -109.95, -153.39166666666668, -97.28333333333333, -134.34166666666664, -89.35833333333345, -99.92500000000003, -92.00833333333325, -87.41666666666653, -86.69999999999992, -118.57500000000005, -62.42499999999991, -85.17500000000003, -111.49166666666672, -57.04166666666657, -102.26666666666668, -124.09999999999997, -105.6416666666666, -104.07499999999995, -52.558333333333266, -115.10833333333348, -99.93333333333337, -33.62500000000013, -56.44166666666653, -124.85000000000007, -60.03333333333337, -73.05833333333334, -79.01666666666664, -46.69999999999984, -91.91666666666671, -126.68333333333337, -55.65833333333327, -86.56666666666658, -109.56666666666669, -94.97500000000005, -80.74999999999997, -52.58333333333324, -65.94999999999993, -90.64166666666664, -70.51666666666667, -41.67499999999995, -46.63333333333321, -88.7833333333334, -46.34166666666648, -60.674999999999976, -42.95833333333331, -72.4999999999998, -47.53333333333322, -119.58333333333341, -61.491666666666674, -90.95833333333336, -20.93333333333337, -55.65833333333317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23054065964841597, "mean_inference_ms": 1.983391619597889, "mean_action_processing_ms": 0.08771013320358467, "mean_env_wait_ms": 1.4693272805180817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006299257278442383, "StateBufferConnector_ms": 0.003141164779663086, "ViewRequirementAgentConnector_ms": 0.08305788040161133}, "num_episodes": 27, "episode_return_max": -20.93333333333337, "episode_return_min": -153.39166666666668, "episode_return_mean": -85.0485833333333, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 20700, "num_env_steps_sampled": 21000, "num_env_steps_trained": 20700, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 247.1935064977687, "num_env_steps_trained_throughput_per_sec": 232.65271199789996, "timesteps_total": 21000, "num_env_steps_sampled_lifetime": 21000, "num_agent_steps_sampled_lifetime": 21000, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 21000, "timers": {"training_iteration_time_ms": 10364.287, "restore_workers_time_ms": 0.014, "training_step_time_ms": 609.001, "sample_time_ms": 593.521, "synch_weights_time_ms": 14.095}, "counters": {"num_env_steps_sampled": 21000, "num_env_steps_trained": 20700, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 20700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 140, "num_samples_added_to_queue": 21000}, "done": false, "training_iteration": 8, "trial_id": "27800_00000", "date": "2024-10-12_15-29-12", "timestamp": 1728743352, "time_this_iter_s": 10.332325220108032, "time_total_s": 83.01594591140747, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c3310>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 83.01594591140747, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 16.286666666666665, "ram_util_percent": 30.246666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -48639.23046875, "policy_loss": -48671.66796875, "entropy": 29.791425704956055, "entropy_coeff": 0.01, "var_gnorm": 16.036630630493164, "vf_loss": 12181.056640625, "vf_explained_var": 0.012395918369293213}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 78.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 23550, "num_env_steps_trained": 23400, "num_agent_steps_sampled": 23550, "num_agent_steps_trained": 23400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 157, "num_samples_added_to_queue": 23400, "learner_queue": {"size_count": 78, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.858, "learner_load_time_ms": 0.256, "learner_load_wait_time_ms": 1148.295, "learner_dequeue_time_ms": 8688.465}}, "env_runners": {"episode_reward_max": 17.075000000000074, "episode_reward_min": -153.39166666666668, "episode_reward_mean": -78.92516666666664, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -153.39166666666668}, "policy_reward_max": {"default_policy": 17.075000000000074}, "policy_reward_mean": {"default_policy": -78.92516666666664}, "custom_metrics": {"num_consolidated_mean": 0.6755999999999999, "num_consolidated_min": 0.52, "num_consolidated_max": 0.84, "num_overloaded_mean": 0.9832, "num_overloaded_min": 0.79, "num_overloaded_max": 1.16, "num_moves_mean": 9.9966, "num_moves_min": 9.55, "num_moves_max": 10.39, "mean_accuracy_mean": 41.12812000000001, "mean_accuracy_min": 40.859333333333325, "mean_accuracy_max": 41.35333333333334, "num_model_switches_mean": 6.0155, "num_model_switches_min": 5.54, "num_model_switches_max": 6.41, "num_slav_mean": 0.16377433333333333, "num_slav_min": 0.14220000000000002, "num_slav_max": 0.19270000000000004, "cpu_conserved_cost_mean": 2.6112000000000006, "cpu_conserved_cost_min": 1.9, "cpu_conserved_cost_max": 3.28, "mean_cluster_cpu_util_mean": 0.562449518118044, "mean_cluster_cpu_util_min": 0.5396123160206178, "mean_cluster_cpu_util_max": 0.5843895994535959, "mean_cluster_mem_util_mean": 0.3623900950048795, "mean_cluster_mem_util_min": 0.3522333796176699, "mean_cluster_mem_util_max": 0.3737541065687878, "reward_consolidation_mean_mean": 0.2991666666666666, "reward_consolidation_mean_min": 0.12499999999999999, "reward_consolidation_mean_max": 0.5208333333333333, "reward_illegal_mean_mean": -1.6386666666666663, "reward_illegal_mean_min": -1.9333333333333331, "reward_illegal_mean_max": -1.3166666666666662, "reward_accuracy_mean_mean": 1.1078333333333337, "reward_accuracy_mean_min": 0.5666666666666664, "reward_accuracy_mean_max": 1.758333333333334, "reward_sla_mean_mean": -0.557585, "reward_sla_mean_min": -0.8152499999999999, "reward_sla_mean_max": -0.29225, "reward_consolidation_sum_mean": 29.916666666666657, "reward_consolidation_sum_min": 12.499999999999998, "reward_consolidation_sum_max": 52.08333333333333, "reward_illegal_sum_mean": -163.86666666666662, "reward_illegal_sum_min": -193.33333333333331, "reward_illegal_sum_max": -131.66666666666663, "reward_accuracy_sum_mean": 110.78333333333336, "reward_accuracy_sum_min": 56.66666666666664, "reward_accuracy_sum_max": 175.8333333333334, "reward_sla_sum_mean": -55.75850000000001, "reward_sla_sum_min": -81.52499999999999, "reward_sla_sum_max": -29.225, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6182.0, "global_timestep_min": 4500, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-56.54166666666648, -72.81666666666659, -81.30833333333337, -114.75833333333338, -96.99166666666662, -75.46666666666653, -72.475, -79.44999999999987, -67.6666666666667, -112.77500000000005, -45.52499999999995, -137.63333333333338, -86.7333333333334, -78.91666666666657, -100.05000000000004, -97.83333333333323, -71.47499999999988, -85.33333333333324, -61.07500000000014, -54.858333333333164, -69.10833333333336, -79.25833333333318, -76.74166666666673, -101.3083333333334, -109.95, -153.39166666666668, -97.28333333333333, -134.34166666666664, -89.35833333333345, -99.92500000000003, -92.00833333333325, -87.41666666666653, -86.69999999999992, -118.57500000000005, -62.42499999999991, -85.17500000000003, -111.49166666666672, -57.04166666666657, -102.26666666666668, -124.09999999999997, -105.6416666666666, -104.07499999999995, -52.558333333333266, -115.10833333333348, -99.93333333333337, -33.62500000000013, -56.44166666666653, -124.85000000000007, -60.03333333333337, -73.05833333333334, -79.01666666666664, -46.69999999999984, -91.91666666666671, -126.68333333333337, -55.65833333333327, -86.56666666666658, -109.56666666666669, -94.97500000000005, -80.74999999999997, -52.58333333333324, -65.94999999999993, -90.64166666666664, -70.51666666666667, -41.67499999999995, -46.63333333333321, -88.7833333333334, -46.34166666666648, -60.674999999999976, -42.95833333333331, -72.4999999999998, -47.53333333333322, -119.58333333333341, -61.491666666666674, -90.95833333333336, -20.93333333333337, -55.65833333333317, -80.50833333333323, -76.7666666666666, -124.36666666666667, -77.86666666666666, -69.87499999999997, -91.62499999999993, -89.06666666666653, -63.18333333333322, -62.39166666666661, -68.11666666666659, -30.375000000000075, -76.725, -75.60833333333336, -71.33333333333331, -100.27499999999995, -41.108333333333235, -76.27500000000006, -63.92499999999989, 17.075000000000074, -63.24999999999988, -44.71666666666648, -21.891666666666566, -91.80833333333328, -88.40833333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-56.54166666666648, -72.81666666666659, -81.30833333333337, -114.75833333333338, -96.99166666666662, -75.46666666666653, -72.475, -79.44999999999987, -67.6666666666667, -112.77500000000005, -45.52499999999995, -137.63333333333338, -86.7333333333334, -78.91666666666657, -100.05000000000004, -97.83333333333323, -71.47499999999988, -85.33333333333324, -61.07500000000014, -54.858333333333164, -69.10833333333336, -79.25833333333318, -76.74166666666673, -101.3083333333334, -109.95, -153.39166666666668, -97.28333333333333, -134.34166666666664, -89.35833333333345, -99.92500000000003, -92.00833333333325, -87.41666666666653, -86.69999999999992, -118.57500000000005, -62.42499999999991, -85.17500000000003, -111.49166666666672, -57.04166666666657, -102.26666666666668, -124.09999999999997, -105.6416666666666, -104.07499999999995, -52.558333333333266, -115.10833333333348, -99.93333333333337, -33.62500000000013, -56.44166666666653, -124.85000000000007, -60.03333333333337, -73.05833333333334, -79.01666666666664, -46.69999999999984, -91.91666666666671, -126.68333333333337, -55.65833333333327, -86.56666666666658, -109.56666666666669, -94.97500000000005, -80.74999999999997, -52.58333333333324, -65.94999999999993, -90.64166666666664, -70.51666666666667, -41.67499999999995, -46.63333333333321, -88.7833333333334, -46.34166666666648, -60.674999999999976, -42.95833333333331, -72.4999999999998, -47.53333333333322, -119.58333333333341, -61.491666666666674, -90.95833333333336, -20.93333333333337, -55.65833333333317, -80.50833333333323, -76.7666666666666, -124.36666666666667, -77.86666666666666, -69.87499999999997, -91.62499999999993, -89.06666666666653, -63.18333333333322, -62.39166666666661, -68.11666666666659, -30.375000000000075, -76.725, -75.60833333333336, -71.33333333333331, -100.27499999999995, -41.108333333333235, -76.27500000000006, -63.92499999999989, 17.075000000000074, -63.24999999999988, -44.71666666666648, -21.891666666666566, -91.80833333333328, -88.40833333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23138231639757673, "mean_inference_ms": 1.9939705925446771, "mean_action_processing_ms": 0.087965323133152, "mean_env_wait_ms": 1.474887016568759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006241559982299805, "StateBufferConnector_ms": 0.0031468868255615234, "ViewRequirementAgentConnector_ms": 0.08279561996459961}, "num_episodes": 24, "episode_return_max": 17.075000000000074, "episode_return_min": -153.39166666666668, "episode_return_mean": -78.92516666666664, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23550, "num_agent_steps_trained": 23400, "num_env_steps_sampled": 23550, "num_env_steps_trained": 23400, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 250.85583187744126, "num_env_steps_trained_throughput_per_sec": 265.6120572819966, "timesteps_total": 23550, "num_env_steps_sampled_lifetime": 23550, "num_agent_steps_sampled_lifetime": 23550, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 23550, "timers": {"training_iteration_time_ms": 10342.168, "restore_workers_time_ms": 0.014, "training_step_time_ms": 598.946, "sample_time_ms": 584.231, "synch_weights_time_ms": 13.356}, "counters": {"num_env_steps_sampled": 23550, "num_env_steps_trained": 23400, "num_agent_steps_sampled": 23550, "num_agent_steps_trained": 23400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 157, "num_samples_added_to_queue": 23400}, "done": false, "training_iteration": 9, "trial_id": "27800_00000", "date": "2024-10-12_15-29-22", "timestamp": 1728743362, "time_this_iter_s": 10.178165435791016, "time_total_s": 93.19411134719849, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c3bb0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 93.19411134719849, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 16.533333333333335, "ram_util_percent": 30.41333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -55624.734375, "policy_loss": -55689.16796875, "entropy": 29.770559310913086, "entropy_coeff": 0.01, "var_gnorm": 16.045944213867188, "vf_loss": 15374.568359375, "vf_explained_var": 0.015968620777130127}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 26100, "num_env_steps_trained": 25800, "num_agent_steps_sampled": 26100, "num_agent_steps_trained": 25800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 174, "num_samples_added_to_queue": 26100, "learner_queue": {"size_count": 86, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.913, "learner_load_time_ms": 0.281, "learner_load_wait_time_ms": 1131.911, "learner_dequeue_time_ms": 9519.711}}, "env_runners": {"episode_reward_max": 17.075000000000074, "episode_reward_min": -134.34166666666664, "episode_reward_mean": -68.44483333333329, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -134.34166666666664}, "policy_reward_max": {"default_policy": 17.075000000000074}, "policy_reward_mean": {"default_policy": -68.44483333333329}, "custom_metrics": {"num_consolidated_mean": 0.6759000000000001, "num_consolidated_min": 0.52, "num_consolidated_max": 0.84, "num_overloaded_mean": 0.9569999999999999, "num_overloaded_min": 0.79, "num_overloaded_max": 1.13, "num_moves_mean": 9.973300000000002, "num_moves_min": 9.55, "num_moves_max": 10.39, "mean_accuracy_mean": 41.12710666666667, "mean_accuracy_min": 40.852999999999994, "mean_accuracy_max": 41.35333333333334, "num_model_switches_mean": 6.0169000000000015, "num_model_switches_min": 5.44, "num_model_switches_max": 6.41, "num_slav_mean": 0.163828, "num_slav_min": 0.13888333333333333, "num_slav_max": 0.19096666666666665, "cpu_conserved_cost_mean": 2.5833999999999997, "cpu_conserved_cost_min": 1.9, "cpu_conserved_cost_max": 3.28, "mean_cluster_cpu_util_mean": 0.5596618309133292, "mean_cluster_cpu_util_min": 0.53907298630382, "mean_cluster_cpu_util_max": 0.5843895994535959, "mean_cluster_mem_util_mean": 0.3612136038563105, "mean_cluster_mem_util_min": 0.3513547430681134, "mean_cluster_mem_util_max": 0.3737541065687878, "reward_consolidation_mean_mean": 0.32145833333333323, "reward_consolidation_mean_min": 0.14583333333333331, "reward_consolidation_mean_max": 0.5624999999999999, "reward_illegal_mean_mean": -1.5949999999999998, "reward_illegal_mean_min": -1.883333333333333, "reward_illegal_mean_max": -1.3166666666666662, "reward_accuracy_mean_mean": 1.1870833333333337, "reward_accuracy_mean_min": 0.7000000000000002, "reward_accuracy_mean_max": 1.8250000000000002, "reward_sla_mean_mean": -0.59799, "reward_sla_mean_min": -0.9494999999999999, "reward_sla_mean_max": -0.34275, "reward_consolidation_sum_mean": 32.14583333333333, "reward_consolidation_sum_min": 14.583333333333332, "reward_consolidation_sum_max": 56.24999999999999, "reward_illegal_sum_mean": -159.49999999999997, "reward_illegal_sum_min": -188.33333333333331, "reward_illegal_sum_max": -131.66666666666663, "reward_accuracy_sum_mean": 118.70833333333336, "reward_accuracy_sum_min": 70.00000000000001, "reward_accuracy_sum_max": 182.50000000000003, "reward_sla_sum_mean": -59.799, "reward_sla_sum_min": -94.94999999999999, "reward_sla_sum_max": -34.275, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4976.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-134.34166666666664, -89.35833333333345, -99.92500000000003, -92.00833333333325, -87.41666666666653, -86.69999999999992, -118.57500000000005, -62.42499999999991, -85.17500000000003, -111.49166666666672, -57.04166666666657, -102.26666666666668, -124.09999999999997, -105.6416666666666, -104.07499999999995, -52.558333333333266, -115.10833333333348, -99.93333333333337, -33.62500000000013, -56.44166666666653, -124.85000000000007, -60.03333333333337, -73.05833333333334, -79.01666666666664, -46.69999999999984, -91.91666666666671, -126.68333333333337, -55.65833333333327, -86.56666666666658, -109.56666666666669, -94.97500000000005, -80.74999999999997, -52.58333333333324, -65.94999999999993, -90.64166666666664, -70.51666666666667, -41.67499999999995, -46.63333333333321, -88.7833333333334, -46.34166666666648, -60.674999999999976, -42.95833333333331, -72.4999999999998, -47.53333333333322, -119.58333333333341, -61.491666666666674, -90.95833333333336, -20.93333333333337, -55.65833333333317, -80.50833333333323, -76.7666666666666, -124.36666666666667, -77.86666666666666, -69.87499999999997, -91.62499999999993, -89.06666666666653, -63.18333333333322, -62.39166666666661, -68.11666666666659, -30.375000000000075, -76.725, -75.60833333333336, -71.33333333333331, -100.27499999999995, -41.108333333333235, -76.27500000000006, -63.92499999999989, 17.075000000000074, -63.24999999999988, -44.71666666666648, -21.891666666666566, -91.80833333333328, -88.40833333333336, -40.733333333333235, -115.56666666666678, -60.60833333333332, -71.27499999999995, -58.916666666666586, -93.16666666666671, -19.14999999999971, -74.03333333333322, -62.48333333333329, -79.90000000000002, -45.89166666666658, -12.533333333333191, 6.449999999999973, -90.30000000000001, -11.649999999999865, 3.8000000000000536, -15.933333333333241, -23.883333333333283, -65.94999999999995, -51.45833333333314, -32.37499999999987, -33.03333333333317, -24.73333333333325, -66.62500000000009, -33.08333333333311, -54.491666666666575, -61.16666666666658], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-134.34166666666664, -89.35833333333345, -99.92500000000003, -92.00833333333325, -87.41666666666653, -86.69999999999992, -118.57500000000005, -62.42499999999991, -85.17500000000003, -111.49166666666672, -57.04166666666657, -102.26666666666668, -124.09999999999997, -105.6416666666666, -104.07499999999995, -52.558333333333266, -115.10833333333348, -99.93333333333337, -33.62500000000013, -56.44166666666653, -124.85000000000007, -60.03333333333337, -73.05833333333334, -79.01666666666664, -46.69999999999984, -91.91666666666671, -126.68333333333337, -55.65833333333327, -86.56666666666658, -109.56666666666669, -94.97500000000005, -80.74999999999997, -52.58333333333324, -65.94999999999993, -90.64166666666664, -70.51666666666667, -41.67499999999995, -46.63333333333321, -88.7833333333334, -46.34166666666648, -60.674999999999976, -42.95833333333331, -72.4999999999998, -47.53333333333322, -119.58333333333341, -61.491666666666674, -90.95833333333336, -20.93333333333337, -55.65833333333317, -80.50833333333323, -76.7666666666666, -124.36666666666667, -77.86666666666666, -69.87499999999997, -91.62499999999993, -89.06666666666653, -63.18333333333322, -62.39166666666661, -68.11666666666659, -30.375000000000075, -76.725, -75.60833333333336, -71.33333333333331, -100.27499999999995, -41.108333333333235, -76.27500000000006, -63.92499999999989, 17.075000000000074, -63.24999999999988, -44.71666666666648, -21.891666666666566, -91.80833333333328, -88.40833333333336, -40.733333333333235, -115.56666666666678, -60.60833333333332, -71.27499999999995, -58.916666666666586, -93.16666666666671, -19.14999999999971, -74.03333333333322, -62.48333333333329, -79.90000000000002, -45.89166666666658, -12.533333333333191, 6.449999999999973, -90.30000000000001, -11.649999999999865, 3.8000000000000536, -15.933333333333241, -23.883333333333283, -65.94999999999995, -51.45833333333314, -32.37499999999987, -33.03333333333317, -24.73333333333325, -66.62500000000009, -33.08333333333311, -54.491666666666575, -61.16666666666658]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23215081309081376, "mean_inference_ms": 1.9965306354691916, "mean_action_processing_ms": 0.08809524439579838, "mean_env_wait_ms": 1.478032816986464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006356000900268555, "StateBufferConnector_ms": 0.0032052993774414062, "ViewRequirementAgentConnector_ms": 0.08372902870178223}, "num_episodes": 27, "episode_return_max": 17.075000000000074, "episode_return_min": -134.34166666666664, "episode_return_mean": -68.44483333333329, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26100, "num_agent_steps_trained": 25800, "num_env_steps_sampled": 26100, "num_env_steps_trained": 25800, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 254.11479462592115, "num_env_steps_trained_throughput_per_sec": 239.16686553027873, "timesteps_total": 26100, "num_env_steps_sampled_lifetime": 26100, "num_agent_steps_sampled_lifetime": 26100, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 26100, "timers": {"training_iteration_time_ms": 10311.435, "restore_workers_time_ms": 0.016, "training_step_time_ms": 604.461, "sample_time_ms": 589.778, "synch_weights_time_ms": 13.215}, "counters": {"num_env_steps_sampled": 26100, "num_env_steps_trained": 25800, "num_agent_steps_sampled": 26100, "num_agent_steps_trained": 25800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 174, "num_samples_added_to_queue": 26100}, "done": false, "training_iteration": 10, "trial_id": "27800_00000", "date": "2024-10-12_15-29-32", "timestamp": 1728743372, "time_this_iter_s": 10.045324802398682, "time_total_s": 103.23943614959717, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c39d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 103.23943614959717, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 16.4, "ram_util_percent": 30.55714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -4761.87841796875, "policy_loss": -4739.21435546875, "entropy": 29.730501174926758, "entropy_coeff": 0.01, "var_gnorm": 16.05930519104004, "vf_loss": 6652.72607421875, "vf_explained_var": 0.0033443570137023926}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 28650, "num_env_steps_trained": 28500, "num_agent_steps_sampled": 28650, "num_agent_steps_trained": 28500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 191, "num_samples_added_to_queue": 28500, "learner_queue": {"size_count": 95, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.536, "learner_load_time_ms": 0.289, "learner_load_wait_time_ms": 1159.786, "learner_dequeue_time_ms": 9561.878}}, "env_runners": {"episode_reward_max": 17.075000000000074, "episode_reward_min": -126.68333333333337, "episode_reward_mean": -57.714166666666614, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -126.68333333333337}, "policy_reward_max": {"default_policy": 17.075000000000074}, "policy_reward_mean": {"default_policy": -57.714166666666614}, "custom_metrics": {"num_consolidated_mean": 0.6759000000000001, "num_consolidated_min": 0.52, "num_consolidated_max": 0.85, "num_overloaded_mean": 0.9301000000000001, "num_overloaded_min": 0.75, "num_overloaded_max": 1.11, "num_moves_mean": 9.9832, "num_moves_min": 9.55, "num_moves_max": 10.32, "mean_accuracy_mean": 41.114883333333324, "mean_accuracy_min": 40.852999999999994, "mean_accuracy_max": 41.35333333333334, "num_model_switches_mean": 6.0269, "num_model_switches_min": 5.44, "num_model_switches_max": 6.39, "num_slav_mean": 0.16341266666666665, "num_slav_min": 0.13888333333333333, "num_slav_max": 0.19096666666666665, "cpu_conserved_cost_mean": 2.5426, "cpu_conserved_cost_min": 1.9, "cpu_conserved_cost_max": 3.28, "mean_cluster_cpu_util_mean": 0.5558543500194575, "mean_cluster_cpu_util_min": 0.5363097790604128, "mean_cluster_cpu_util_max": 0.5778418943419337, "mean_cluster_mem_util_mean": 0.35955915734342253, "mean_cluster_mem_util_min": 0.350326321615144, "mean_cluster_mem_util_max": 0.37123829921208995, "reward_consolidation_mean_mean": 0.3477083333333333, "reward_consolidation_mean_min": 0.16666666666666663, "reward_consolidation_mean_max": 0.6458333333333333, "reward_illegal_mean_mean": -1.5501666666666662, "reward_illegal_mean_min": -1.85, "reward_illegal_mean_max": -1.25, "reward_accuracy_mean_mean": 1.2594166666666673, "reward_accuracy_mean_min": 0.7666666666666668, "reward_accuracy_mean_max": 1.8250000000000002, "reward_sla_mean_mean": -0.6341, "reward_sla_mean_min": -0.9494999999999999, "reward_sla_mean_max": -0.40125, "reward_consolidation_sum_mean": 34.77083333333332, "reward_consolidation_sum_min": 16.666666666666664, "reward_consolidation_sum_max": 64.58333333333333, "reward_illegal_sum_mean": -155.01666666666665, "reward_illegal_sum_min": -185.0, "reward_illegal_sum_max": -125.0, "reward_accuracy_sum_mean": 125.94166666666669, "reward_accuracy_sum_min": 76.66666666666669, "reward_accuracy_sum_max": 182.50000000000003, "reward_sla_sum_mean": -63.41000000000001, "reward_sla_sum_min": -94.94999999999999, "reward_sla_sum_max": -40.125, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3904.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-46.69999999999984, -91.91666666666671, -126.68333333333337, -55.65833333333327, -86.56666666666658, -109.56666666666669, -94.97500000000005, -80.74999999999997, -52.58333333333324, -65.94999999999993, -90.64166666666664, -70.51666666666667, -41.67499999999995, -46.63333333333321, -88.7833333333334, -46.34166666666648, -60.674999999999976, -42.95833333333331, -72.4999999999998, -47.53333333333322, -119.58333333333341, -61.491666666666674, -90.95833333333336, -20.93333333333337, -55.65833333333317, -80.50833333333323, -76.7666666666666, -124.36666666666667, -77.86666666666666, -69.87499999999997, -91.62499999999993, -89.06666666666653, -63.18333333333322, -62.39166666666661, -68.11666666666659, -30.375000000000075, -76.725, -75.60833333333336, -71.33333333333331, -100.27499999999995, -41.108333333333235, -76.27500000000006, -63.92499999999989, 17.075000000000074, -63.24999999999988, -44.71666666666648, -21.891666666666566, -91.80833333333328, -88.40833333333336, -40.733333333333235, -115.56666666666678, -60.60833333333332, -71.27499999999995, -58.916666666666586, -93.16666666666671, -19.14999999999971, -74.03333333333322, -62.48333333333329, -79.90000000000002, -45.89166666666658, -12.533333333333191, 6.449999999999973, -90.30000000000001, -11.649999999999865, 3.8000000000000536, -15.933333333333241, -23.883333333333283, -65.94999999999995, -51.45833333333314, -32.37499999999987, -33.03333333333317, -24.73333333333325, -66.62500000000009, -33.08333333333311, -54.491666666666575, -61.16666666666658, -48.524999999999935, -17.183333333333255, -14.46666666666657, -96.84166666666667, -9.199999999999996, -65.13333333333335, -24.583333333333304, 0.6250000000000542, -52.79999999999986, -72.44999999999989, -25.408333333333317, -94.12499999999997, -69.30833333333342, -57.66666666666676, -52.81666666666661, -10.21666666666658, -68.69166666666665, -45.14999999999986, -24.46666666666648, -35.15833333333319, -71.80833333333327, -52.76666666666658, -36.93333333333322, -37.0250000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-46.69999999999984, -91.91666666666671, -126.68333333333337, -55.65833333333327, -86.56666666666658, -109.56666666666669, -94.97500000000005, -80.74999999999997, -52.58333333333324, -65.94999999999993, -90.64166666666664, -70.51666666666667, -41.67499999999995, -46.63333333333321, -88.7833333333334, -46.34166666666648, -60.674999999999976, -42.95833333333331, -72.4999999999998, -47.53333333333322, -119.58333333333341, -61.491666666666674, -90.95833333333336, -20.93333333333337, -55.65833333333317, -80.50833333333323, -76.7666666666666, -124.36666666666667, -77.86666666666666, -69.87499999999997, -91.62499999999993, -89.06666666666653, -63.18333333333322, -62.39166666666661, -68.11666666666659, -30.375000000000075, -76.725, -75.60833333333336, -71.33333333333331, -100.27499999999995, -41.108333333333235, -76.27500000000006, -63.92499999999989, 17.075000000000074, -63.24999999999988, -44.71666666666648, -21.891666666666566, -91.80833333333328, -88.40833333333336, -40.733333333333235, -115.56666666666678, -60.60833333333332, -71.27499999999995, -58.916666666666586, -93.16666666666671, -19.14999999999971, -74.03333333333322, -62.48333333333329, -79.90000000000002, -45.89166666666658, -12.533333333333191, 6.449999999999973, -90.30000000000001, -11.649999999999865, 3.8000000000000536, -15.933333333333241, -23.883333333333283, -65.94999999999995, -51.45833333333314, -32.37499999999987, -33.03333333333317, -24.73333333333325, -66.62500000000009, -33.08333333333311, -54.491666666666575, -61.16666666666658, -48.524999999999935, -17.183333333333255, -14.46666666666657, -96.84166666666667, -9.199999999999996, -65.13333333333335, -24.583333333333304, 0.6250000000000542, -52.79999999999986, -72.44999999999989, -25.408333333333317, -94.12499999999997, -69.30833333333342, -57.66666666666676, -52.81666666666661, -10.21666666666658, -68.69166666666665, -45.14999999999986, -24.46666666666648, -35.15833333333319, -71.80833333333327, -52.76666666666658, -36.93333333333322, -37.0250000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23278832560887205, "mean_inference_ms": 1.9986881337563183, "mean_action_processing_ms": 0.08822211122161598, "mean_env_wait_ms": 1.4808332636401018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006367683410644531, "StateBufferConnector_ms": 0.003244161605834961, "ViewRequirementAgentConnector_ms": 0.08484077453613281}, "num_episodes": 24, "episode_return_max": 17.075000000000074, "episode_return_min": -126.68333333333337, "episode_return_mean": -57.714166666666614, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28650, "num_agent_steps_trained": 28500, "num_env_steps_sampled": 28650, "num_env_steps_trained": 28500, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 245.4184273996777, "num_env_steps_trained_throughput_per_sec": 259.85480548201167, "timesteps_total": 28650, "num_env_steps_sampled_lifetime": 28650, "num_agent_steps_sampled_lifetime": 28650, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 28650, "timers": {"training_iteration_time_ms": 10306.896, "restore_workers_time_ms": 0.014, "training_step_time_ms": 610.456, "sample_time_ms": 595.035, "synch_weights_time_ms": 13.905}, "counters": {"num_env_steps_sampled": 28650, "num_env_steps_trained": 28500, "num_agent_steps_sampled": 28650, "num_agent_steps_trained": 28500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 191, "num_samples_added_to_queue": 28500}, "done": false, "training_iteration": 11, "trial_id": "27800_00000", "date": "2024-10-12_15-29-43", "timestamp": 1728743383, "time_this_iter_s": 10.401757001876831, "time_total_s": 113.641193151474, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c0dc0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 113.641193151474, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 16.473333333333333, "ram_util_percent": 30.726666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -36835.3984375, "policy_loss": -36851.94140625, "entropy": 29.684730529785156, "entropy_coeff": 0.01, "var_gnorm": 16.073997497558594, "vf_loss": 10559.7470703125, "vf_explained_var": 0.020460784435272217}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 103.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 31200, "num_env_steps_trained": 30900, "num_agent_steps_sampled": 31200, "num_agent_steps_trained": 30900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 208, "num_samples_added_to_queue": 31200, "learner_queue": {"size_count": 103, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.04, "learner_load_time_ms": 0.31, "learner_load_wait_time_ms": 1148.738, "learner_dequeue_time_ms": 9599.452}}, "env_runners": {"episode_reward_max": 40.75000000000023, "episode_reward_min": -124.36666666666667, "episode_reward_mean": -43.01549999999992, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -124.36666666666667}, "policy_reward_max": {"default_policy": 40.75000000000023}, "policy_reward_mean": {"default_policy": -43.01549999999992}, "custom_metrics": {"num_consolidated_mean": 0.6796, "num_consolidated_min": 0.52, "num_consolidated_max": 0.85, "num_overloaded_mean": 0.8928000000000001, "num_overloaded_min": 0.74, "num_overloaded_max": 1.08, "num_moves_mean": 9.9723, "num_moves_min": 9.55, "num_moves_max": 10.32, "mean_accuracy_mean": 41.120013333333326, "mean_accuracy_min": 40.852999999999994, "mean_accuracy_max": 41.35333333333334, "num_model_switches_mean": 6.0116, "num_model_switches_min": 5.44, "num_model_switches_max": 6.39, "num_slav_mean": 0.16293483333333333, "num_slav_min": 0.13888333333333333, "num_slav_max": 0.19096666666666665, "cpu_conserved_cost_mean": 2.511, "cpu_conserved_cost_min": 1.9, "cpu_conserved_cost_max": 3.28, "mean_cluster_cpu_util_mean": 0.5514189870521097, "mean_cluster_cpu_util_min": 0.5313455581695289, "mean_cluster_cpu_util_max": 0.5778418943419337, "mean_cluster_mem_util_mean": 0.357490739437125, "mean_cluster_mem_util_min": 0.3476234164657424, "mean_cluster_mem_util_max": 0.37123829921208995, "reward_consolidation_mean_mean": 0.3804166666666666, "reward_consolidation_mean_min": 0.16666666666666663, "reward_consolidation_mean_max": 0.7291666666666665, "reward_illegal_mean_mean": -1.4879999999999998, "reward_illegal_mean_min": -1.7999999999999998, "reward_illegal_mean_max": -1.2333333333333332, "reward_accuracy_mean_mean": 1.359583333333334, "reward_accuracy_mean_min": 0.7666666666666668, "reward_accuracy_mean_max": 2.091666666666669, "reward_sla_mean_mean": -0.6821550000000001, "reward_sla_mean_min": -0.9887500000000001, "reward_sla_mean_max": -0.40375, "reward_consolidation_sum_mean": 38.041666666666664, "reward_consolidation_sum_min": 16.666666666666664, "reward_consolidation_sum_max": 72.91666666666666, "reward_illegal_sum_mean": -148.79999999999998, "reward_illegal_sum_min": -179.99999999999997, "reward_illegal_sum_max": -123.33333333333331, "reward_accuracy_sum_mean": 135.95833333333337, "reward_accuracy_sum_min": 76.66666666666669, "reward_accuracy_sum_max": 209.16666666666688, "reward_sla_sum_mean": -68.2155, "reward_sla_sum_min": -98.87500000000001, "reward_sla_sum_max": -40.375, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2698.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-124.36666666666667, -77.86666666666666, -69.87499999999997, -91.62499999999993, -89.06666666666653, -63.18333333333322, -62.39166666666661, -68.11666666666659, -30.375000000000075, -76.725, -75.60833333333336, -71.33333333333331, -100.27499999999995, -41.108333333333235, -76.27500000000006, -63.92499999999989, 17.075000000000074, -63.24999999999988, -44.71666666666648, -21.891666666666566, -91.80833333333328, -88.40833333333336, -40.733333333333235, -115.56666666666678, -60.60833333333332, -71.27499999999995, -58.916666666666586, -93.16666666666671, -19.14999999999971, -74.03333333333322, -62.48333333333329, -79.90000000000002, -45.89166666666658, -12.533333333333191, 6.449999999999973, -90.30000000000001, -11.649999999999865, 3.8000000000000536, -15.933333333333241, -23.883333333333283, -65.94999999999995, -51.45833333333314, -32.37499999999987, -33.03333333333317, -24.73333333333325, -66.62500000000009, -33.08333333333311, -54.491666666666575, -61.16666666666658, -48.524999999999935, -17.183333333333255, -14.46666666666657, -96.84166666666667, -9.199999999999996, -65.13333333333335, -24.583333333333304, 0.6250000000000542, -52.79999999999986, -72.44999999999989, -25.408333333333317, -94.12499999999997, -69.30833333333342, -57.66666666666676, -52.81666666666661, -10.21666666666658, -68.69166666666665, -45.14999999999986, -24.46666666666648, -35.15833333333319, -71.80833333333327, -52.76666666666658, -36.93333333333322, -37.0250000000001, -8.274999999999755, -45.97500000000002, -24.266666666666595, -14.191666666666595, -6.191666666666555, -2.783333333333338, -66.42499999999988, -33.66666666666676, -16.024999999999903, 40.75000000000023, -26.225000000000023, -30.374999999999876, -41.91666666666654, -25.641666666666655, -34.70833333333326, -8.63333333333307, -44.96666666666654, -23.14999999999989, -18.599999999999874, -11.691666666666661, 19.966666666666747, -15.77499999999984, -30.491666666666617, 9.650000000000098, -33.0083333333332, 0.43333333333345125, 36.5416666666668], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-124.36666666666667, -77.86666666666666, -69.87499999999997, -91.62499999999993, -89.06666666666653, -63.18333333333322, -62.39166666666661, -68.11666666666659, -30.375000000000075, -76.725, -75.60833333333336, -71.33333333333331, -100.27499999999995, -41.108333333333235, -76.27500000000006, -63.92499999999989, 17.075000000000074, -63.24999999999988, -44.71666666666648, -21.891666666666566, -91.80833333333328, -88.40833333333336, -40.733333333333235, -115.56666666666678, -60.60833333333332, -71.27499999999995, -58.916666666666586, -93.16666666666671, -19.14999999999971, -74.03333333333322, -62.48333333333329, -79.90000000000002, -45.89166666666658, -12.533333333333191, 6.449999999999973, -90.30000000000001, -11.649999999999865, 3.8000000000000536, -15.933333333333241, -23.883333333333283, -65.94999999999995, -51.45833333333314, -32.37499999999987, -33.03333333333317, -24.73333333333325, -66.62500000000009, -33.08333333333311, -54.491666666666575, -61.16666666666658, -48.524999999999935, -17.183333333333255, -14.46666666666657, -96.84166666666667, -9.199999999999996, -65.13333333333335, -24.583333333333304, 0.6250000000000542, -52.79999999999986, -72.44999999999989, -25.408333333333317, -94.12499999999997, -69.30833333333342, -57.66666666666676, -52.81666666666661, -10.21666666666658, -68.69166666666665, -45.14999999999986, -24.46666666666648, -35.15833333333319, -71.80833333333327, -52.76666666666658, -36.93333333333322, -37.0250000000001, -8.274999999999755, -45.97500000000002, -24.266666666666595, -14.191666666666595, -6.191666666666555, -2.783333333333338, -66.42499999999988, -33.66666666666676, -16.024999999999903, 40.75000000000023, -26.225000000000023, -30.374999999999876, -41.91666666666654, -25.641666666666655, -34.70833333333326, -8.63333333333307, -44.96666666666654, -23.14999999999989, -18.599999999999874, -11.691666666666661, 19.966666666666747, -15.77499999999984, -30.491666666666617, 9.650000000000098, -33.0083333333332, 0.43333333333345125, 36.5416666666668]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23333880384791336, "mean_inference_ms": 2.0001308049813282, "mean_action_processing_ms": 0.08830514043792143, "mean_env_wait_ms": 1.4830693186776143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006665229797363281, "StateBufferConnector_ms": 0.0032842159271240234, "ViewRequirementAgentConnector_ms": 0.08536338806152344}, "num_episodes": 27, "episode_return_max": 40.75000000000023, "episode_return_min": -124.36666666666667, "episode_return_mean": -43.01549999999992, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31200, "num_agent_steps_trained": 30900, "num_env_steps_sampled": 31200, "num_env_steps_trained": 30900, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 250.63971098342293, "num_env_steps_trained_throughput_per_sec": 235.89619857263335, "timesteps_total": 31200, "num_env_steps_sampled_lifetime": 31200, "num_agent_steps_sampled_lifetime": 31200, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 31200, "timers": {"training_iteration_time_ms": 10270.866, "restore_workers_time_ms": 0.014, "training_step_time_ms": 601.877, "sample_time_ms": 587.174, "synch_weights_time_ms": 13.285}, "counters": {"num_env_steps_sampled": 31200, "num_env_steps_trained": 30900, "num_agent_steps_sampled": 31200, "num_agent_steps_trained": 30900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 208, "num_samples_added_to_queue": 31200}, "done": false, "training_iteration": 12, "trial_id": "27800_00000", "date": "2024-10-12_15-29-53", "timestamp": 1728743393, "time_this_iter_s": 10.188241243362427, "time_total_s": 123.82943439483643, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c24a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 123.82943439483643, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 16.473333333333333, "ram_util_percent": 30.94}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 27862.455078125, "policy_loss": 27807.01953125, "entropy": 29.570146560668945, "entropy_coeff": 0.01, "var_gnorm": 16.093873977661133, "vf_loss": 14414.6337890625, "vf_explained_var": -0.010770320892333984}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 112.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 33750, "num_env_steps_trained": 33600, "num_agent_steps_sampled": 33750, "num_agent_steps_trained": 33600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 225, "num_samples_added_to_queue": 33600, "learner_queue": {"size_count": 112, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.734, "learner_load_time_ms": 0.299, "learner_load_wait_time_ms": 1134.379, "learner_dequeue_time_ms": 9618.745}}, "env_runners": {"episode_reward_max": 148.17500000000015, "episode_reward_min": -96.84166666666667, "episode_reward_mean": -21.932333333333254, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -96.84166666666667}, "policy_reward_max": {"default_policy": 148.17500000000015}, "policy_reward_mean": {"default_policy": -21.932333333333254}, "custom_metrics": {"num_consolidated_mean": 0.6877999999999999, "num_consolidated_min": 0.54, "num_consolidated_max": 0.85, "num_overloaded_mean": 0.8454999999999999, "num_overloaded_min": 0.57, "num_overloaded_max": 1.0, "num_moves_mean": 9.9712, "num_moves_min": 9.68, "num_moves_max": 10.32, "mean_accuracy_mean": 41.106713333333325, "mean_accuracy_min": 40.852999999999994, "mean_accuracy_max": 41.37233333333334, "num_model_switches_mean": 6.0171, "num_model_switches_min": 5.44, "num_model_switches_max": 6.32, "num_slav_mean": 0.16128366666666666, "num_slav_min": 0.13888333333333333, "num_slav_max": 0.17901666666666663, "cpu_conserved_cost_mean": 2.4644, "cpu_conserved_cost_min": 1.9, "cpu_conserved_cost_max": 3.26, "mean_cluster_cpu_util_mean": 0.5456646514930785, "mean_cluster_cpu_util_min": 0.5163074699064614, "mean_cluster_cpu_util_max": 0.5704161644795503, "mean_cluster_mem_util_mean": 0.35476168709456357, "mean_cluster_mem_util_min": 0.3413244862079853, "mean_cluster_mem_util_max": 0.36503578622377225, "reward_consolidation_mean_mean": 0.43541666666666656, "reward_consolidation_mean_min": 0.2083333333333333, "reward_consolidation_mean_max": 0.9999999999999999, "reward_illegal_mean_mean": -1.409166666666666, "reward_illegal_mean_min": -1.6666666666666665, "reward_illegal_mean_max": -0.9499999999999998, "reward_accuracy_mean_mean": 1.495416666666667, "reward_accuracy_mean_min": 0.8166666666666669, "reward_accuracy_mean_max": 2.6750000000000025, "reward_sla_mean_mean": -0.7409899999999999, "reward_sla_mean_min": -1.2432500000000002, "reward_sla_mean_max": -0.40375, "reward_consolidation_sum_mean": 43.54166666666666, "reward_consolidation_sum_min": 20.83333333333333, "reward_consolidation_sum_max": 99.99999999999999, "reward_illegal_sum_mean": -140.91666666666666, "reward_illegal_sum_min": -166.66666666666666, "reward_illegal_sum_max": -94.99999999999999, "reward_accuracy_sum_mean": 149.54166666666674, "reward_accuracy_sum_min": 81.66666666666669, "reward_accuracy_sum_max": 267.5000000000002, "reward_sla_sum_mean": -74.09899999999999, "reward_sla_sum_min": -124.32500000000002, "reward_sla_sum_max": -40.375, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1782.0, "global_timestep_min": 100, "global_timestep_max": 3400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-60.60833333333332, -71.27499999999995, -58.916666666666586, -93.16666666666671, -19.14999999999971, -74.03333333333322, -62.48333333333329, -79.90000000000002, -45.89166666666658, -12.533333333333191, 6.449999999999973, -90.30000000000001, -11.649999999999865, 3.8000000000000536, -15.933333333333241, -23.883333333333283, -65.94999999999995, -51.45833333333314, -32.37499999999987, -33.03333333333317, -24.73333333333325, -66.62500000000009, -33.08333333333311, -54.491666666666575, -61.16666666666658, -48.524999999999935, -17.183333333333255, -14.46666666666657, -96.84166666666667, -9.199999999999996, -65.13333333333335, -24.583333333333304, 0.6250000000000542, -52.79999999999986, -72.44999999999989, -25.408333333333317, -94.12499999999997, -69.30833333333342, -57.66666666666676, -52.81666666666661, -10.21666666666658, -68.69166666666665, -45.14999999999986, -24.46666666666648, -35.15833333333319, -71.80833333333327, -52.76666666666658, -36.93333333333322, -37.0250000000001, -8.274999999999755, -45.97500000000002, -24.266666666666595, -14.191666666666595, -6.191666666666555, -2.783333333333338, -66.42499999999988, -33.66666666666676, -16.024999999999903, 40.75000000000023, -26.225000000000023, -30.374999999999876, -41.91666666666654, -25.641666666666655, -34.70833333333326, -8.63333333333307, -44.96666666666654, -23.14999999999989, -18.599999999999874, -11.691666666666661, 19.966666666666747, -15.77499999999984, -30.491666666666617, 9.650000000000098, -33.0083333333332, 0.43333333333345125, 36.5416666666668, 2.9083333333335015, 29.03333333333347, 39.93333333333351, -32.133333333333205, 20.841666666666598, 4.633333333333482, 1.0000000000001794, -21.808333333333337, -25.54166666666656, -22.79166666666677, 19.750000000000153, 70.19166666666675, -33.04999999999995, -11.191666666666613, 24.625000000000025, 37.19166666666702, -21.15000000000005, 64.98333333333352, -9.183333333333293, 18.241666666666625, -1.8999999999999009, 104.47500000000002, 148.17500000000015, 69.6666666666669], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-60.60833333333332, -71.27499999999995, -58.916666666666586, -93.16666666666671, -19.14999999999971, -74.03333333333322, -62.48333333333329, -79.90000000000002, -45.89166666666658, -12.533333333333191, 6.449999999999973, -90.30000000000001, -11.649999999999865, 3.8000000000000536, -15.933333333333241, -23.883333333333283, -65.94999999999995, -51.45833333333314, -32.37499999999987, -33.03333333333317, -24.73333333333325, -66.62500000000009, -33.08333333333311, -54.491666666666575, -61.16666666666658, -48.524999999999935, -17.183333333333255, -14.46666666666657, -96.84166666666667, -9.199999999999996, -65.13333333333335, -24.583333333333304, 0.6250000000000542, -52.79999999999986, -72.44999999999989, -25.408333333333317, -94.12499999999997, -69.30833333333342, -57.66666666666676, -52.81666666666661, -10.21666666666658, -68.69166666666665, -45.14999999999986, -24.46666666666648, -35.15833333333319, -71.80833333333327, -52.76666666666658, -36.93333333333322, -37.0250000000001, -8.274999999999755, -45.97500000000002, -24.266666666666595, -14.191666666666595, -6.191666666666555, -2.783333333333338, -66.42499999999988, -33.66666666666676, -16.024999999999903, 40.75000000000023, -26.225000000000023, -30.374999999999876, -41.91666666666654, -25.641666666666655, -34.70833333333326, -8.63333333333307, -44.96666666666654, -23.14999999999989, -18.599999999999874, -11.691666666666661, 19.966666666666747, -15.77499999999984, -30.491666666666617, 9.650000000000098, -33.0083333333332, 0.43333333333345125, 36.5416666666668, 2.9083333333335015, 29.03333333333347, 39.93333333333351, -32.133333333333205, 20.841666666666598, 4.633333333333482, 1.0000000000001794, -21.808333333333337, -25.54166666666656, -22.79166666666677, 19.750000000000153, 70.19166666666675, -33.04999999999995, -11.191666666666613, 24.625000000000025, 37.19166666666702, -21.15000000000005, 64.98333333333352, -9.183333333333293, 18.241666666666625, -1.8999999999999009, 104.47500000000002, 148.17500000000015, 69.6666666666669]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23358124696455537, "mean_inference_ms": 2.00161033242658, "mean_action_processing_ms": 0.08833112140424289, "mean_env_wait_ms": 1.4843745101384236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006860256195068359, "StateBufferConnector_ms": 0.003244161605834961, "ViewRequirementAgentConnector_ms": 0.08435893058776855}, "num_episodes": 24, "episode_return_max": 148.17500000000015, "episode_return_min": -96.84166666666667, "episode_return_mean": -21.932333333333254, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33750, "num_agent_steps_trained": 33600, "num_env_steps_sampled": 33750, "num_env_steps_trained": 33600, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 250.9938857602159, "num_env_steps_trained_throughput_per_sec": 265.75823198140506, "timesteps_total": 33750, "num_env_steps_sampled_lifetime": 33750, "num_agent_steps_sampled_lifetime": 33750, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 33750, "timers": {"training_iteration_time_ms": 10282.275, "restore_workers_time_ms": 0.014, "training_step_time_ms": 600.4, "sample_time_ms": 584.962, "synch_weights_time_ms": 13.978}, "counters": {"num_env_steps_sampled": 33750, "num_env_steps_trained": 33600, "num_agent_steps_sampled": 33750, "num_agent_steps_trained": 33600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 225, "num_samples_added_to_queue": 33600}, "done": false, "training_iteration": 13, "trial_id": "27800_00000", "date": "2024-10-12_15-30-03", "timestamp": 1728743403, "time_this_iter_s": 10.170174598693848, "time_total_s": 133.99960899353027, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a945e40dc0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 133.99960899353027, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 16.414285714285715, "ram_util_percent": 31.114285714285717}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 102763.3671875, "policy_loss": 102419.3125, "entropy": 29.41245460510254, "entropy_coeff": 0.01, "var_gnorm": 16.113243103027344, "vf_loss": 43228.58984375, "vf_explained_var": -0.02650320529937744}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 120.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 36300, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36300, "num_agent_steps_trained": 36000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 242, "num_samples_added_to_queue": 36300, "learner_queue": {"size_count": 120, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.157, "learner_load_time_ms": 0.305, "learner_load_wait_time_ms": 1187.865, "learner_dequeue_time_ms": 9671.886}}, "env_runners": {"episode_reward_max": 148.17500000000015, "episode_reward_min": -96.84166666666667, "episode_reward_mean": 11.26841666666675, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -96.84166666666667}, "policy_reward_max": {"default_policy": 148.17500000000015}, "policy_reward_mean": {"default_policy": 11.26841666666675}, "custom_metrics": {"num_consolidated_mean": 0.7072000000000003, "num_consolidated_min": 0.54, "num_consolidated_max": 0.93, "num_overloaded_mean": 0.7772, "num_overloaded_min": 0.52, "num_overloaded_max": 1.0, "num_moves_mean": 9.959299999999999, "num_moves_min": 9.67, "num_moves_max": 10.32, "mean_accuracy_mean": 41.10386333333333, "mean_accuracy_min": 40.89099999999999, "mean_accuracy_max": 41.37233333333334, "num_model_switches_mean": 6.021700000000001, "num_model_switches_min": 5.57, "num_model_switches_max": 6.37, "num_slav_mean": 0.15939483333333335, "num_slav_min": 0.13376666666666667, "num_slav_max": 0.17603333333333332, "cpu_conserved_cost_mean": 2.4215999999999998, "cpu_conserved_cost_min": 1.9, "cpu_conserved_cost_max": 3.2, "mean_cluster_cpu_util_mean": 0.5376182597245225, "mean_cluster_cpu_util_min": 0.5092077909333808, "mean_cluster_cpu_util_max": 0.559052896321496, "mean_cluster_mem_util_mean": 0.3510451108133127, "mean_cluster_mem_util_min": 0.3379766457848962, "mean_cluster_mem_util_max": 0.36170940809868257, "reward_consolidation_mean_mean": 0.5295833333333332, "reward_consolidation_mean_min": 0.2083333333333333, "reward_consolidation_mean_max": 0.9999999999999999, "reward_illegal_mean_mean": -1.2953333333333332, "reward_illegal_mean_min": -1.6666666666666665, "reward_illegal_mean_max": -0.8666666666666666, "reward_accuracy_mean_mean": 1.7176666666666676, "reward_accuracy_mean_min": 0.8166666666666669, "reward_accuracy_mean_max": 2.6833333333333367, "reward_sla_mean_mean": -0.8392324999999999, "reward_sla_mean_min": -1.3439999999999999, "reward_sla_mean_max": -0.40375, "reward_consolidation_sum_mean": 52.95833333333333, "reward_consolidation_sum_min": 20.83333333333333, "reward_consolidation_sum_max": 99.99999999999999, "reward_illegal_sum_mean": -129.5333333333333, "reward_illegal_sum_min": -166.66666666666666, "reward_illegal_sum_max": -86.66666666666666, "reward_accuracy_sum_mean": 171.7666666666667, "reward_accuracy_sum_min": 81.66666666666669, "reward_accuracy_sum_max": 268.33333333333366, "reward_sla_sum_mean": -83.92325000000001, "reward_sla_sum_min": -134.39999999999998, "reward_sla_sum_max": -40.375, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2682.0, "global_timestep_min": 1000, "global_timestep_max": 4300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-14.46666666666657, -96.84166666666667, -9.199999999999996, -65.13333333333335, -24.583333333333304, 0.6250000000000542, -52.79999999999986, -72.44999999999989, -25.408333333333317, -94.12499999999997, -69.30833333333342, -57.66666666666676, -52.81666666666661, -10.21666666666658, -68.69166666666665, -45.14999999999986, -24.46666666666648, -35.15833333333319, -71.80833333333327, -52.76666666666658, -36.93333333333322, -37.0250000000001, -8.274999999999755, -45.97500000000002, -24.266666666666595, -14.191666666666595, -6.191666666666555, -2.783333333333338, -66.42499999999988, -33.66666666666676, -16.024999999999903, 40.75000000000023, -26.225000000000023, -30.374999999999876, -41.91666666666654, -25.641666666666655, -34.70833333333326, -8.63333333333307, -44.96666666666654, -23.14999999999989, -18.599999999999874, -11.691666666666661, 19.966666666666747, -15.77499999999984, -30.491666666666617, 9.650000000000098, -33.0083333333332, 0.43333333333345125, 36.5416666666668, 2.9083333333335015, 29.03333333333347, 39.93333333333351, -32.133333333333205, 20.841666666666598, 4.633333333333482, 1.0000000000001794, -21.808333333333337, -25.54166666666656, -22.79166666666677, 19.750000000000153, 70.19166666666675, -33.04999999999995, -11.191666666666613, 24.625000000000025, 37.19166666666702, -21.15000000000005, 64.98333333333352, -9.183333333333293, 18.241666666666625, -1.8999999999999009, 104.47500000000002, 148.17500000000015, 69.6666666666669, 32.42500000000019, 114.56666666666678, 68.01666666666677, 61.024999999999956, 142.89166666666677, 93.8333333333334, 60.841666666666804, 96.50833333333337, 127.6833333333335, 37.250000000000185, 82.19999999999995, 38.2833333333335, 12.808333333333449, 119.23333333333348, 109.35833333333332, 63.00833333333346, 132.70000000000024, 122.28333333333323, 48.725000000000165, 15.26666666666673, 72.76666666666684, 79.34166666666685, 64.36666666666677, 63.88333333333345, 53.13333333333347, 123.85833333333332, 85.71666666666677], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-14.46666666666657, -96.84166666666667, -9.199999999999996, -65.13333333333335, -24.583333333333304, 0.6250000000000542, -52.79999999999986, -72.44999999999989, -25.408333333333317, -94.12499999999997, -69.30833333333342, -57.66666666666676, -52.81666666666661, -10.21666666666658, -68.69166666666665, -45.14999999999986, -24.46666666666648, -35.15833333333319, -71.80833333333327, -52.76666666666658, -36.93333333333322, -37.0250000000001, -8.274999999999755, -45.97500000000002, -24.266666666666595, -14.191666666666595, -6.191666666666555, -2.783333333333338, -66.42499999999988, -33.66666666666676, -16.024999999999903, 40.75000000000023, -26.225000000000023, -30.374999999999876, -41.91666666666654, -25.641666666666655, -34.70833333333326, -8.63333333333307, -44.96666666666654, -23.14999999999989, -18.599999999999874, -11.691666666666661, 19.966666666666747, -15.77499999999984, -30.491666666666617, 9.650000000000098, -33.0083333333332, 0.43333333333345125, 36.5416666666668, 2.9083333333335015, 29.03333333333347, 39.93333333333351, -32.133333333333205, 20.841666666666598, 4.633333333333482, 1.0000000000001794, -21.808333333333337, -25.54166666666656, -22.79166666666677, 19.750000000000153, 70.19166666666675, -33.04999999999995, -11.191666666666613, 24.625000000000025, 37.19166666666702, -21.15000000000005, 64.98333333333352, -9.183333333333293, 18.241666666666625, -1.8999999999999009, 104.47500000000002, 148.17500000000015, 69.6666666666669, 32.42500000000019, 114.56666666666678, 68.01666666666677, 61.024999999999956, 142.89166666666677, 93.8333333333334, 60.841666666666804, 96.50833333333337, 127.6833333333335, 37.250000000000185, 82.19999999999995, 38.2833333333335, 12.808333333333449, 119.23333333333348, 109.35833333333332, 63.00833333333346, 132.70000000000024, 122.28333333333323, 48.725000000000165, 15.26666666666673, 72.76666666666684, 79.34166666666685, 64.36666666666677, 63.88333333333345, 53.13333333333347, 123.85833333333332, 85.71666666666677]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23403293839354553, "mean_inference_ms": 2.0055601775437166, "mean_action_processing_ms": 0.08839949881931648, "mean_env_wait_ms": 1.4869289911388779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006847381591796875, "StateBufferConnector_ms": 0.0032973289489746094, "ViewRequirementAgentConnector_ms": 0.08570027351379395}, "num_episodes": 27, "episode_return_max": 148.17500000000015, "episode_return_min": -96.84166666666667, "episode_return_mean": 11.26841666666675, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36300, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36300, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 241.175814137407, "num_env_steps_trained_throughput_per_sec": 226.98900154108895, "timesteps_total": 36300, "num_env_steps_sampled_lifetime": 36300, "num_agent_steps_sampled_lifetime": 36300, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 36300, "timers": {"training_iteration_time_ms": 10281.133, "restore_workers_time_ms": 0.014, "training_step_time_ms": 612.458, "sample_time_ms": 596.494, "synch_weights_time_ms": 14.198}, "counters": {"num_env_steps_sampled": 36300, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36300, "num_agent_steps_trained": 36000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 242, "num_samples_added_to_queue": 36300}, "done": false, "training_iteration": 14, "trial_id": "27800_00000", "date": "2024-10-12_15-30-14", "timestamp": 1728743414, "time_this_iter_s": 10.591975212097168, "time_total_s": 144.59158420562744, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f3a60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 144.59158420562744, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 16.38, "ram_util_percent": 31.18666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 132100.5625, "policy_loss": 131665.328125, "entropy": 29.20391273498535, "entropy_coeff": 0.01, "var_gnorm": 16.132816314697266, "vf_loss": 52283.85546875, "vf_explained_var": -0.04602968692779541}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 129.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 38850, "num_env_steps_trained": 38700, "num_agent_steps_sampled": 38850, "num_agent_steps_trained": 38700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 259, "num_samples_added_to_queue": 38700, "learner_queue": {"size_count": 129, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.878, "learner_load_time_ms": 0.274, "learner_load_wait_time_ms": 1167.174, "learner_dequeue_time_ms": 9719.445}}, "env_runners": {"episode_reward_max": 180.8000000000003, "episode_reward_min": -66.42499999999988, "episode_reward_mean": 51.11400000000012, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -66.42499999999988}, "policy_reward_max": {"default_policy": 180.8000000000003}, "policy_reward_mean": {"default_policy": 51.11400000000012}, "custom_metrics": {"num_consolidated_mean": 0.7358999999999998, "num_consolidated_min": 0.58, "num_consolidated_max": 0.93, "num_overloaded_mean": 0.7, "num_overloaded_min": 0.45, "num_overloaded_max": 0.91, "num_moves_mean": 9.904300000000001, "num_moves_min": 9.62, "num_moves_max": 10.24, "mean_accuracy_mean": 41.12919666666667, "mean_accuracy_min": 40.89733333333333, "mean_accuracy_max": 41.461000000000006, "num_model_switches_mean": 6.0177, "num_model_switches_min": 5.57, "num_model_switches_max": 6.38, "num_slav_mean": 0.1588746666666667, "num_slav_min": 0.13376666666666667, "num_slav_max": 0.1790166666666667, "cpu_conserved_cost_mean": 2.413, "cpu_conserved_cost_min": 1.96, "cpu_conserved_cost_max": 3.2, "mean_cluster_cpu_util_mean": 0.5298725519204041, "mean_cluster_cpu_util_min": 0.5056078685577298, "mean_cluster_cpu_util_max": 0.5542705636947748, "mean_cluster_mem_util_mean": 0.3471316620884642, "mean_cluster_mem_util_min": 0.3346635683070697, "mean_cluster_mem_util_max": 0.35939287257096936, "reward_consolidation_mean_mean": 0.6412499999999998, "reward_consolidation_mean_min": 0.31249999999999994, "reward_consolidation_mean_max": 1.0624999999999998, "reward_illegal_mean_mean": -1.1666666666666665, "reward_illegal_mean_min": -1.5166666666666664, "reward_illegal_mean_max": -0.7499999999999999, "reward_accuracy_mean_mean": 1.9984166666666678, "reward_accuracy_mean_min": 1.0083333333333337, "reward_accuracy_mean_max": 3.0250000000000035, "reward_sla_mean_mean": -0.9618599999999999, "reward_sla_mean_min": -1.467, "reward_sla_mean_max": -0.48924999999999996, "reward_consolidation_sum_mean": 64.125, "reward_consolidation_sum_min": 31.249999999999993, "reward_consolidation_sum_max": 106.24999999999997, "reward_illegal_sum_mean": -116.66666666666664, "reward_illegal_sum_min": -151.66666666666663, "reward_illegal_sum_max": -74.99999999999999, "reward_accuracy_sum_mean": 199.8416666666668, "reward_accuracy_sum_min": 100.83333333333339, "reward_accuracy_sum_max": 302.50000000000034, "reward_sla_sum_mean": -96.186, "reward_sla_sum_min": -146.70000000000002, "reward_sla_sum_max": -48.925, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3482.0, "global_timestep_min": 1800, "global_timestep_max": 5100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-24.266666666666595, -14.191666666666595, -6.191666666666555, -2.783333333333338, -66.42499999999988, -33.66666666666676, -16.024999999999903, 40.75000000000023, -26.225000000000023, -30.374999999999876, -41.91666666666654, -25.641666666666655, -34.70833333333326, -8.63333333333307, -44.96666666666654, -23.14999999999989, -18.599999999999874, -11.691666666666661, 19.966666666666747, -15.77499999999984, -30.491666666666617, 9.650000000000098, -33.0083333333332, 0.43333333333345125, 36.5416666666668, 2.9083333333335015, 29.03333333333347, 39.93333333333351, -32.133333333333205, 20.841666666666598, 4.633333333333482, 1.0000000000001794, -21.808333333333337, -25.54166666666656, -22.79166666666677, 19.750000000000153, 70.19166666666675, -33.04999999999995, -11.191666666666613, 24.625000000000025, 37.19166666666702, -21.15000000000005, 64.98333333333352, -9.183333333333293, 18.241666666666625, -1.8999999999999009, 104.47500000000002, 148.17500000000015, 69.6666666666669, 32.42500000000019, 114.56666666666678, 68.01666666666677, 61.024999999999956, 142.89166666666677, 93.8333333333334, 60.841666666666804, 96.50833333333337, 127.6833333333335, 37.250000000000185, 82.19999999999995, 38.2833333333335, 12.808333333333449, 119.23333333333348, 109.35833333333332, 63.00833333333346, 132.70000000000024, 122.28333333333323, 48.725000000000165, 15.26666666666673, 72.76666666666684, 79.34166666666685, 64.36666666666677, 63.88333333333345, 53.13333333333347, 123.85833333333332, 85.71666666666677, 63.37500000000005, 121.51666666666684, 101.75000000000024, 81.2333333333335, 164.216666666667, 154.92500000000013, 104.1416666666668, 92.85000000000014, 76.8916666666667, 110.20000000000019, 104.16666666666677, 142.55833333333362, 154.2666666666668, 134.3916666666668, 140.3750000000002, 180.8000000000003, 98.20833333333343, 106.0416666666668, 86.22500000000022, 152.30833333333365, 113.3666666666667, 133.35000000000025, 153.90000000000032, 142.85833333333363], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-24.266666666666595, -14.191666666666595, -6.191666666666555, -2.783333333333338, -66.42499999999988, -33.66666666666676, -16.024999999999903, 40.75000000000023, -26.225000000000023, -30.374999999999876, -41.91666666666654, -25.641666666666655, -34.70833333333326, -8.63333333333307, -44.96666666666654, -23.14999999999989, -18.599999999999874, -11.691666666666661, 19.966666666666747, -15.77499999999984, -30.491666666666617, 9.650000000000098, -33.0083333333332, 0.43333333333345125, 36.5416666666668, 2.9083333333335015, 29.03333333333347, 39.93333333333351, -32.133333333333205, 20.841666666666598, 4.633333333333482, 1.0000000000001794, -21.808333333333337, -25.54166666666656, -22.79166666666677, 19.750000000000153, 70.19166666666675, -33.04999999999995, -11.191666666666613, 24.625000000000025, 37.19166666666702, -21.15000000000005, 64.98333333333352, -9.183333333333293, 18.241666666666625, -1.8999999999999009, 104.47500000000002, 148.17500000000015, 69.6666666666669, 32.42500000000019, 114.56666666666678, 68.01666666666677, 61.024999999999956, 142.89166666666677, 93.8333333333334, 60.841666666666804, 96.50833333333337, 127.6833333333335, 37.250000000000185, 82.19999999999995, 38.2833333333335, 12.808333333333449, 119.23333333333348, 109.35833333333332, 63.00833333333346, 132.70000000000024, 122.28333333333323, 48.725000000000165, 15.26666666666673, 72.76666666666684, 79.34166666666685, 64.36666666666677, 63.88333333333345, 53.13333333333347, 123.85833333333332, 85.71666666666677, 63.37500000000005, 121.51666666666684, 101.75000000000024, 81.2333333333335, 164.216666666667, 154.92500000000013, 104.1416666666668, 92.85000000000014, 76.8916666666667, 110.20000000000019, 104.16666666666677, 142.55833333333362, 154.2666666666668, 134.3916666666668, 140.3750000000002, 180.8000000000003, 98.20833333333343, 106.0416666666668, 86.22500000000022, 152.30833333333365, 113.3666666666667, 133.35000000000025, 153.90000000000032, 142.85833333333363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23442312516239966, "mean_inference_ms": 2.007931772153027, "mean_action_processing_ms": 0.08846275773158624, "mean_env_wait_ms": 1.4889138295237387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006895542144775391, "StateBufferConnector_ms": 0.0033097267150878906, "ViewRequirementAgentConnector_ms": 0.08552169799804688}, "num_episodes": 24, "episode_return_max": 180.8000000000003, "episode_return_min": -66.42499999999988, "episode_return_mean": 51.11400000000012, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38850, "num_agent_steps_trained": 38700, "num_env_steps_sampled": 38850, "num_env_steps_trained": 38700, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 246.15432202928753, "num_env_steps_trained_throughput_per_sec": 260.63398803101035, "timesteps_total": 38850, "num_env_steps_sampled_lifetime": 38850, "num_agent_steps_sampled_lifetime": 38850, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 38850, "timers": {"training_iteration_time_ms": 10263.453, "restore_workers_time_ms": 0.013, "training_step_time_ms": 603.076, "sample_time_ms": 588.101, "synch_weights_time_ms": 13.558}, "counters": {"num_env_steps_sampled": 38850, "num_env_steps_trained": 38700, "num_agent_steps_sampled": 38850, "num_agent_steps_trained": 38700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 259, "num_samples_added_to_queue": 38700}, "done": false, "training_iteration": 15, "trial_id": "27800_00000", "date": "2024-10-12_15-30-24", "timestamp": 1728743424, "time_this_iter_s": 10.369746685028076, "time_total_s": 154.96133089065552, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f2cb0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 154.96133089065552, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 16.299999999999997, "ram_util_percent": 31.359999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 164275.78125, "policy_loss": 163562.5625, "entropy": 29.02862548828125, "entropy_coeff": 0.01, "var_gnorm": 16.146520614624023, "vf_loss": 80029.65625, "vf_explained_var": -0.03824150562286377}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 137.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 41400, "num_env_steps_trained": 41100, "num_agent_steps_sampled": 41400, "num_agent_steps_trained": 41100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 276, "num_samples_added_to_queue": 41400, "learner_queue": {"size_count": 137, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.439, "learner_load_time_ms": 0.289, "learner_load_wait_time_ms": 1159.004, "learner_dequeue_time_ms": 9712.553}}, "env_runners": {"episode_reward_max": 255.21666666666698, "episode_reward_min": -33.04999999999995, "episode_reward_mean": 100.97425000000014, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -33.04999999999995}, "policy_reward_max": {"default_policy": 255.21666666666698}, "policy_reward_mean": {"default_policy": 100.97425000000014}, "custom_metrics": {"num_consolidated_mean": 0.7799, "num_consolidated_min": 0.58, "num_consolidated_max": 1.0, "num_overloaded_mean": 0.6109000000000001, "num_overloaded_min": 0.34, "num_overloaded_max": 0.9, "num_moves_mean": 9.8663, "num_moves_min": 9.52, "num_moves_max": 10.2, "mean_accuracy_mean": 41.15427666666667, "mean_accuracy_min": 40.89733333333333, "mean_accuracy_max": 41.461000000000006, "num_model_switches_mean": 6.0032, "num_model_switches_min": 5.57, "num_model_switches_max": 6.38, "num_slav_mean": 0.15815716666666668, "num_slav_min": 0.13376666666666667, "num_slav_max": 0.1790166666666667, "cpu_conserved_cost_mean": 2.4078, "cpu_conserved_cost_min": 1.96, "cpu_conserved_cost_max": 3.02, "mean_cluster_cpu_util_mean": 0.5206819475511847, "mean_cluster_cpu_util_min": 0.4950325535621405, "mean_cluster_cpu_util_max": 0.5447690696515618, "mean_cluster_mem_util_mean": 0.34252834648310804, "mean_cluster_mem_util_min": 0.32867820779155543, "mean_cluster_mem_util_max": 0.3569505814245529, "reward_consolidation_mean_mean": 0.799375, "reward_consolidation_mean_min": 0.3125, "reward_consolidation_mean_max": 1.2916666666666663, "reward_illegal_mean_mean": -1.0181666666666667, "reward_illegal_mean_min": -1.5, "reward_illegal_mean_max": -0.5666666666666665, "reward_accuracy_mean_mean": 2.3316666666666683, "reward_accuracy_mean_min": 1.2333333333333323, "reward_accuracy_mean_max": 3.3750000000000027, "reward_sla_mean_mean": -1.1031325, "reward_sla_mean_min": -1.5847500000000003, "reward_sla_mean_max": -0.538, "reward_consolidation_sum_mean": 79.93749999999999, "reward_consolidation_sum_min": 31.25, "reward_consolidation_sum_max": 129.16666666666663, "reward_illegal_sum_mean": -101.81666666666666, "reward_illegal_sum_min": -150.0, "reward_illegal_sum_max": -56.66666666666666, "reward_accuracy_sum_mean": 233.16666666666683, "reward_accuracy_sum_min": 123.33333333333323, "reward_accuracy_sum_max": 337.5000000000003, "reward_sla_sum_mean": -110.31325000000001, "reward_sla_sum_min": -158.47500000000002, "reward_sla_sum_max": -53.800000000000004, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4382.0, "global_timestep_min": 2700, "global_timestep_max": 6000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [39.93333333333351, -32.133333333333205, 20.841666666666598, 4.633333333333482, 1.0000000000001794, -21.808333333333337, -25.54166666666656, -22.79166666666677, 19.750000000000153, 70.19166666666675, -33.04999999999995, -11.191666666666613, 24.625000000000025, 37.19166666666702, -21.15000000000005, 64.98333333333352, -9.183333333333293, 18.241666666666625, -1.8999999999999009, 104.47500000000002, 148.17500000000015, 69.6666666666669, 32.42500000000019, 114.56666666666678, 68.01666666666677, 61.024999999999956, 142.89166666666677, 93.8333333333334, 60.841666666666804, 96.50833333333337, 127.6833333333335, 37.250000000000185, 82.19999999999995, 38.2833333333335, 12.808333333333449, 119.23333333333348, 109.35833333333332, 63.00833333333346, 132.70000000000024, 122.28333333333323, 48.725000000000165, 15.26666666666673, 72.76666666666684, 79.34166666666685, 64.36666666666677, 63.88333333333345, 53.13333333333347, 123.85833333333332, 85.71666666666677, 63.37500000000005, 121.51666666666684, 101.75000000000024, 81.2333333333335, 164.216666666667, 154.92500000000013, 104.1416666666668, 92.85000000000014, 76.8916666666667, 110.20000000000019, 104.16666666666677, 142.55833333333362, 154.2666666666668, 134.3916666666668, 140.3750000000002, 180.8000000000003, 98.20833333333343, 106.0416666666668, 86.22500000000022, 152.30833333333365, 113.3666666666667, 133.35000000000025, 153.90000000000032, 142.85833333333363, 171.1750000000003, 153.8083333333336, 150.04166666666688, 179.23333333333392, 175.80833333333356, 196.78333333333356, 159.89166666666688, 161.30000000000038, 199.85000000000036, 186.25833333333364, 152.25833333333367, 137.71666666666684, 135.90000000000026, 187.35833333333375, 222.45000000000033, 171.09166666666698, 162.60833333333358, 155.65833333333356, 130.65000000000018, 119.87500000000011, 138.4333333333335, 163.83333333333331, 161.43333333333365, 162.14166666666705, 183.52500000000012, 242.27500000000023, 255.21666666666698], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [39.93333333333351, -32.133333333333205, 20.841666666666598, 4.633333333333482, 1.0000000000001794, -21.808333333333337, -25.54166666666656, -22.79166666666677, 19.750000000000153, 70.19166666666675, -33.04999999999995, -11.191666666666613, 24.625000000000025, 37.19166666666702, -21.15000000000005, 64.98333333333352, -9.183333333333293, 18.241666666666625, -1.8999999999999009, 104.47500000000002, 148.17500000000015, 69.6666666666669, 32.42500000000019, 114.56666666666678, 68.01666666666677, 61.024999999999956, 142.89166666666677, 93.8333333333334, 60.841666666666804, 96.50833333333337, 127.6833333333335, 37.250000000000185, 82.19999999999995, 38.2833333333335, 12.808333333333449, 119.23333333333348, 109.35833333333332, 63.00833333333346, 132.70000000000024, 122.28333333333323, 48.725000000000165, 15.26666666666673, 72.76666666666684, 79.34166666666685, 64.36666666666677, 63.88333333333345, 53.13333333333347, 123.85833333333332, 85.71666666666677, 63.37500000000005, 121.51666666666684, 101.75000000000024, 81.2333333333335, 164.216666666667, 154.92500000000013, 104.1416666666668, 92.85000000000014, 76.8916666666667, 110.20000000000019, 104.16666666666677, 142.55833333333362, 154.2666666666668, 134.3916666666668, 140.3750000000002, 180.8000000000003, 98.20833333333343, 106.0416666666668, 86.22500000000022, 152.30833333333365, 113.3666666666667, 133.35000000000025, 153.90000000000032, 142.85833333333363, 171.1750000000003, 153.8083333333336, 150.04166666666688, 179.23333333333392, 175.80833333333356, 196.78333333333356, 159.89166666666688, 161.30000000000038, 199.85000000000036, 186.25833333333364, 152.25833333333367, 137.71666666666684, 135.90000000000026, 187.35833333333375, 222.45000000000033, 171.09166666666698, 162.60833333333358, 155.65833333333356, 130.65000000000018, 119.87500000000011, 138.4333333333335, 163.83333333333331, 161.43333333333365, 162.14166666666705, 183.52500000000012, 242.27500000000023, 255.21666666666698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23486251367159, "mean_inference_ms": 2.0107365636760504, "mean_action_processing_ms": 0.08857450906992767, "mean_env_wait_ms": 1.4913623024671845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00666046142578125, "StateBufferConnector_ms": 0.0033206939697265625, "ViewRequirementAgentConnector_ms": 0.08555936813354492}, "num_episodes": 27, "episode_return_max": 255.21666666666698, "episode_return_min": -33.04999999999995, "episode_return_mean": 100.97425000000014, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41400, "num_agent_steps_trained": 41100, "num_env_steps_sampled": 41400, "num_env_steps_trained": 41100, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 247.5006770387405, "num_env_steps_trained_throughput_per_sec": 232.94181368352048, "timesteps_total": 41400, "num_env_steps_sampled_lifetime": 41400, "num_agent_steps_sampled_lifetime": 41400, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 41400, "timers": {"training_iteration_time_ms": 10269.595, "restore_workers_time_ms": 0.017, "training_step_time_ms": 621.4, "sample_time_ms": 605.733, "synch_weights_time_ms": 14.24}, "counters": {"num_env_steps_sampled": 41400, "num_env_steps_trained": 41100, "num_agent_steps_sampled": 41400, "num_agent_steps_trained": 41100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 276, "num_samples_added_to_queue": 41400}, "done": false, "training_iteration": 16, "trial_id": "27800_00000", "date": "2024-10-12_15-30-35", "timestamp": 1728743435, "time_this_iter_s": 10.320935726165771, "time_total_s": 165.2822666168213, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f69930>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 165.2822666168213, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 16.500000000000004, "ram_util_percent": 31.600000000000012}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 237433.90625, "policy_loss": 235787.328125, "entropy": 28.837194442749023, "entropy_coeff": 0.01, "var_gnorm": 16.15938377380371, "vf_loss": 173309.375, "vf_explained_var": -0.023228764533996582}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 145.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 43800, "num_env_steps_trained": 43500, "num_agent_steps_sampled": 43800, "num_agent_steps_trained": 43500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 292, "num_samples_added_to_queue": 43800, "learner_queue": {"size_count": 145, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 72.601, "learner_load_time_ms": 0.326, "learner_load_wait_time_ms": 1215.527, "learner_dequeue_time_ms": 9770.586}}, "env_runners": {"episode_reward_max": 292.5166666666671, "episode_reward_min": 12.808333333333449, "episode_reward_mean": 149.49275000000023, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 12.808333333333449}, "policy_reward_max": {"default_policy": 292.5166666666671}, "policy_reward_mean": {"default_policy": 149.49275000000023}, "custom_metrics": {"num_consolidated_mean": 0.8323000000000002, "num_consolidated_min": 0.68, "num_consolidated_max": 1.03, "num_overloaded_mean": 0.5316000000000001, "num_overloaded_min": 0.33, "num_overloaded_max": 0.77, "num_moves_mean": 9.812000000000001, "num_moves_min": 9.25, "num_moves_max": 10.2, "mean_accuracy_mean": 41.20158666666667, "mean_accuracy_min": 40.97333333333333, "mean_accuracy_max": 41.461000000000006, "num_model_switches_mean": 5.9846, "num_model_switches_min": 5.57, "num_model_switches_max": 6.38, "num_slav_mean": 0.15809716666666668, "num_slav_min": 0.13376666666666667, "num_slav_max": 0.1790166666666667, "cpu_conserved_cost_mean": 2.4583999999999997, "cpu_conserved_cost_min": 1.96, "cpu_conserved_cost_max": 3.02, "mean_cluster_cpu_util_mean": 0.5136855482246516, "mean_cluster_cpu_util_min": 0.49059312743337075, "mean_cluster_cpu_util_max": 0.5383806875948461, "mean_cluster_mem_util_mean": 0.33857328000050235, "mean_cluster_mem_util_min": 0.3236846868810816, "mean_cluster_mem_util_max": 0.3510887130801688, "reward_consolidation_mean_mean": 0.9570833333333332, "reward_consolidation_mean_min": 0.5208333333333333, "reward_consolidation_mean_max": 1.4166666666666665, "reward_illegal_mean_mean": -0.8860000000000001, "reward_illegal_mean_min": -1.2833333333333332, "reward_illegal_mean_max": -0.5499999999999999, "reward_accuracy_mean_mean": 2.663416666666669, "reward_accuracy_mean_min": 1.616666666666667, "reward_accuracy_mean_max": 3.6500000000000052, "reward_sla_mean_mean": -1.2395725, "reward_sla_mean_min": -1.61225, "reward_sla_mean_max": -0.814, "reward_consolidation_sum_mean": 95.70833333333331, "reward_consolidation_sum_min": 52.08333333333333, "reward_consolidation_sum_max": 141.66666666666666, "reward_illegal_sum_mean": -88.6, "reward_illegal_sum_min": -128.33333333333331, "reward_illegal_sum_max": -54.99999999999999, "reward_accuracy_sum_mean": 266.3416666666668, "reward_accuracy_sum_min": 161.66666666666669, "reward_accuracy_sum_max": 365.0000000000005, "reward_sla_sum_mean": -123.95724999999999, "reward_sla_sum_min": -161.225, "reward_sla_sum_max": -81.39999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5182.0, "global_timestep_min": 3500, "global_timestep_max": 6800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [68.01666666666677, 61.024999999999956, 142.89166666666677, 93.8333333333334, 60.841666666666804, 96.50833333333337, 127.6833333333335, 37.250000000000185, 82.19999999999995, 38.2833333333335, 12.808333333333449, 119.23333333333348, 109.35833333333332, 63.00833333333346, 132.70000000000024, 122.28333333333323, 48.725000000000165, 15.26666666666673, 72.76666666666684, 79.34166666666685, 64.36666666666677, 63.88333333333345, 53.13333333333347, 123.85833333333332, 85.71666666666677, 63.37500000000005, 121.51666666666684, 101.75000000000024, 81.2333333333335, 164.216666666667, 154.92500000000013, 104.1416666666668, 92.85000000000014, 76.8916666666667, 110.20000000000019, 104.16666666666677, 142.55833333333362, 154.2666666666668, 134.3916666666668, 140.3750000000002, 180.8000000000003, 98.20833333333343, 106.0416666666668, 86.22500000000022, 152.30833333333365, 113.3666666666667, 133.35000000000025, 153.90000000000032, 142.85833333333363, 171.1750000000003, 153.8083333333336, 150.04166666666688, 179.23333333333392, 175.80833333333356, 196.78333333333356, 159.89166666666688, 161.30000000000038, 199.85000000000036, 186.25833333333364, 152.25833333333367, 137.71666666666684, 135.90000000000026, 187.35833333333375, 222.45000000000033, 171.09166666666698, 162.60833333333358, 155.65833333333356, 130.65000000000018, 119.87500000000011, 138.4333333333335, 163.83333333333331, 161.43333333333365, 162.14166666666705, 183.52500000000012, 242.27500000000023, 255.21666666666698, 233.15000000000066, 195.8250000000004, 200.98333333333366, 168.71666666666707, 268.9416666666669, 224.32500000000033, 227.17500000000024, 222.85000000000025, 186.75000000000026, 220.54166666666703, 236.55000000000032, 235.44166666666715, 223.10833333333366, 199.891666666667, 292.5166666666671, 229.1000000000006, 234.63333333333355, 243.591666666667, 229.05000000000035, 196.58333333333357, 220.4250000000002, 242.70000000000041, 264.116666666667, 246.8333333333339], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [68.01666666666677, 61.024999999999956, 142.89166666666677, 93.8333333333334, 60.841666666666804, 96.50833333333337, 127.6833333333335, 37.250000000000185, 82.19999999999995, 38.2833333333335, 12.808333333333449, 119.23333333333348, 109.35833333333332, 63.00833333333346, 132.70000000000024, 122.28333333333323, 48.725000000000165, 15.26666666666673, 72.76666666666684, 79.34166666666685, 64.36666666666677, 63.88333333333345, 53.13333333333347, 123.85833333333332, 85.71666666666677, 63.37500000000005, 121.51666666666684, 101.75000000000024, 81.2333333333335, 164.216666666667, 154.92500000000013, 104.1416666666668, 92.85000000000014, 76.8916666666667, 110.20000000000019, 104.16666666666677, 142.55833333333362, 154.2666666666668, 134.3916666666668, 140.3750000000002, 180.8000000000003, 98.20833333333343, 106.0416666666668, 86.22500000000022, 152.30833333333365, 113.3666666666667, 133.35000000000025, 153.90000000000032, 142.85833333333363, 171.1750000000003, 153.8083333333336, 150.04166666666688, 179.23333333333392, 175.80833333333356, 196.78333333333356, 159.89166666666688, 161.30000000000038, 199.85000000000036, 186.25833333333364, 152.25833333333367, 137.71666666666684, 135.90000000000026, 187.35833333333375, 222.45000000000033, 171.09166666666698, 162.60833333333358, 155.65833333333356, 130.65000000000018, 119.87500000000011, 138.4333333333335, 163.83333333333331, 161.43333333333365, 162.14166666666705, 183.52500000000012, 242.27500000000023, 255.21666666666698, 233.15000000000066, 195.8250000000004, 200.98333333333366, 168.71666666666707, 268.9416666666669, 224.32500000000033, 227.17500000000024, 222.85000000000025, 186.75000000000026, 220.54166666666703, 236.55000000000032, 235.44166666666715, 223.10833333333366, 199.891666666667, 292.5166666666671, 229.1000000000006, 234.63333333333355, 243.591666666667, 229.05000000000035, 196.58333333333357, 220.4250000000002, 242.70000000000041, 264.116666666667, 246.8333333333339]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23554180766201088, "mean_inference_ms": 2.0143575822808275, "mean_action_processing_ms": 0.08876102443041088, "mean_env_wait_ms": 1.4950142658301127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006493091583251953, "StateBufferConnector_ms": 0.0033588409423828125, "ViewRequirementAgentConnector_ms": 0.08688592910766602}, "num_episodes": 24, "episode_return_max": 292.5166666666671, "episode_return_min": 12.808333333333449, "episode_return_mean": 149.49275000000023, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43800, "num_agent_steps_trained": 43500, "num_env_steps_sampled": 43800, "num_env_steps_trained": 43500, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 234.63925640298748, "num_env_steps_trained_throughput_per_sec": 234.63925640298748, "timesteps_total": 43800, "num_env_steps_sampled_lifetime": 43800, "num_agent_steps_sampled_lifetime": 43800, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 43800, "timers": {"training_iteration_time_ms": 10270.394, "restore_workers_time_ms": 0.014, "training_step_time_ms": 634.817, "sample_time_ms": 617.743, "synch_weights_time_ms": 15.55}, "counters": {"num_env_steps_sampled": 43800, "num_env_steps_trained": 43500, "num_agent_steps_sampled": 43800, "num_agent_steps_trained": 43500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 292, "num_samples_added_to_queue": 43800}, "done": false, "training_iteration": 17, "trial_id": "27800_00000", "date": "2024-10-12_15-30-45", "timestamp": 1728743445, "time_this_iter_s": 10.240182638168335, "time_total_s": 175.52244925498962, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f2260>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 175.52244925498962, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 16.486666666666665, "ram_util_percent": 31.71333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 242235.34375, "policy_loss": 240645.59375, "entropy": 28.654531478881836, "entropy_coeff": 0.01, "var_gnorm": 16.169992446899414, "vf_loss": 167571.125, "vf_explained_var": -0.025951027870178223}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 153.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 46200, "num_env_steps_trained": 45900, "num_agent_steps_sampled": 46200, "num_agent_steps_trained": 45900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 308, "num_samples_added_to_queue": 46200, "learner_queue": {"size_count": 153, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.036, "learner_load_time_ms": 0.341, "learner_load_wait_time_ms": 1202.012, "learner_dequeue_time_ms": 9817.727}}, "env_runners": {"episode_reward_max": 348.266666666667, "episode_reward_min": 63.37500000000005, "episode_reward_mean": 192.2295000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 63.37500000000005}, "policy_reward_max": {"default_policy": 348.266666666667}, "policy_reward_mean": {"default_policy": 192.2295000000003}, "custom_metrics": {"num_consolidated_mean": 0.8911, "num_consolidated_min": 0.69, "num_consolidated_max": 1.16, "num_overloaded_mean": 0.4705, "num_overloaded_min": 0.27, "num_overloaded_max": 0.66, "num_moves_mean": 9.766, "num_moves_min": 9.25, "num_moves_max": 10.14, "mean_accuracy_mean": 41.24256333333334, "mean_accuracy_min": 40.97333333333333, "mean_accuracy_max": 41.48633333333334, "num_model_switches_mean": 5.9651, "num_model_switches_min": 5.57, "num_model_switches_max": 6.56, "num_slav_mean": 0.15790916666666666, "num_slav_min": 0.13376666666666667, "num_slav_max": 0.1790166666666667, "cpu_conserved_cost_mean": 2.5192, "cpu_conserved_cost_min": 1.96, "cpu_conserved_cost_max": 3.02, "mean_cluster_cpu_util_mean": 0.507473366096584, "mean_cluster_cpu_util_min": 0.4896242844895626, "mean_cluster_cpu_util_max": 0.5267444928092018, "mean_cluster_mem_util_mean": 0.334885969879302, "mean_cluster_mem_util_min": 0.3232783843178621, "mean_cluster_mem_util_max": 0.3448745951017538, "reward_consolidation_mean_mean": 1.1222916666666665, "reward_consolidation_mean_min": 0.6874999999999999, "reward_consolidation_mean_max": 1.6874999999999993, "reward_illegal_mean_mean": -0.7841666666666666, "reward_illegal_mean_min": -1.1, "reward_illegal_mean_max": -0.44999999999999996, "reward_accuracy_mean_mean": 2.924000000000003, "reward_accuracy_mean_min": 1.9583333333333335, "reward_accuracy_mean_max": 3.8666666666666702, "reward_sla_mean_mean": -1.3398299999999999, "reward_sla_mean_min": -1.6597499999999996, "reward_sla_mean_max": -0.872, "reward_consolidation_sum_mean": 112.22916666666664, "reward_consolidation_sum_min": 68.74999999999999, "reward_consolidation_sum_max": 168.74999999999994, "reward_illegal_sum_mean": -78.41666666666666, "reward_illegal_sum_min": -110.0, "reward_illegal_sum_max": -44.99999999999999, "reward_accuracy_sum_mean": 292.4000000000003, "reward_accuracy_sum_min": 195.83333333333334, "reward_accuracy_sum_max": 386.666666666667, "reward_sla_sum_mean": -133.983, "reward_sla_sum_min": -165.97499999999997, "reward_sla_sum_max": -87.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5983.0, "global_timestep_min": 4300, "global_timestep_max": 7600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [85.71666666666677, 63.37500000000005, 121.51666666666684, 101.75000000000024, 81.2333333333335, 164.216666666667, 154.92500000000013, 104.1416666666668, 92.85000000000014, 76.8916666666667, 110.20000000000019, 104.16666666666677, 142.55833333333362, 154.2666666666668, 134.3916666666668, 140.3750000000002, 180.8000000000003, 98.20833333333343, 106.0416666666668, 86.22500000000022, 152.30833333333365, 113.3666666666667, 133.35000000000025, 153.90000000000032, 142.85833333333363, 171.1750000000003, 153.8083333333336, 150.04166666666688, 179.23333333333392, 175.80833333333356, 196.78333333333356, 159.89166666666688, 161.30000000000038, 199.85000000000036, 186.25833333333364, 152.25833333333367, 137.71666666666684, 135.90000000000026, 187.35833333333375, 222.45000000000033, 171.09166666666698, 162.60833333333358, 155.65833333333356, 130.65000000000018, 119.87500000000011, 138.4333333333335, 163.83333333333331, 161.43333333333365, 162.14166666666705, 183.52500000000012, 242.27500000000023, 255.21666666666698, 233.15000000000066, 195.8250000000004, 200.98333333333366, 168.71666666666707, 268.9416666666669, 224.32500000000033, 227.17500000000024, 222.85000000000025, 186.75000000000026, 220.54166666666703, 236.55000000000032, 235.44166666666715, 223.10833333333366, 199.891666666667, 292.5166666666671, 229.1000000000006, 234.63333333333355, 243.591666666667, 229.05000000000035, 196.58333333333357, 220.4250000000002, 242.70000000000041, 264.116666666667, 246.8333333333339, 224.50000000000028, 211.28333333333362, 275.6916666666674, 324.0250000000003, 220.90833333333362, 272.05000000000064, 256.5000000000005, 348.266666666667, 190.67500000000024, 267.77500000000055, 215.92500000000032, 183.14166666666702, 245.01666666666702, 304.21666666666675, 241.4500000000003, 313.6000000000004, 219.80000000000035, 290.06666666666695, 295.34166666666675, 236.45000000000041, 241.78333333333367, 268.3333333333336, 303.3833333333337, 212.75833333333367], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [85.71666666666677, 63.37500000000005, 121.51666666666684, 101.75000000000024, 81.2333333333335, 164.216666666667, 154.92500000000013, 104.1416666666668, 92.85000000000014, 76.8916666666667, 110.20000000000019, 104.16666666666677, 142.55833333333362, 154.2666666666668, 134.3916666666668, 140.3750000000002, 180.8000000000003, 98.20833333333343, 106.0416666666668, 86.22500000000022, 152.30833333333365, 113.3666666666667, 133.35000000000025, 153.90000000000032, 142.85833333333363, 171.1750000000003, 153.8083333333336, 150.04166666666688, 179.23333333333392, 175.80833333333356, 196.78333333333356, 159.89166666666688, 161.30000000000038, 199.85000000000036, 186.25833333333364, 152.25833333333367, 137.71666666666684, 135.90000000000026, 187.35833333333375, 222.45000000000033, 171.09166666666698, 162.60833333333358, 155.65833333333356, 130.65000000000018, 119.87500000000011, 138.4333333333335, 163.83333333333331, 161.43333333333365, 162.14166666666705, 183.52500000000012, 242.27500000000023, 255.21666666666698, 233.15000000000066, 195.8250000000004, 200.98333333333366, 168.71666666666707, 268.9416666666669, 224.32500000000033, 227.17500000000024, 222.85000000000025, 186.75000000000026, 220.54166666666703, 236.55000000000032, 235.44166666666715, 223.10833333333366, 199.891666666667, 292.5166666666671, 229.1000000000006, 234.63333333333355, 243.591666666667, 229.05000000000035, 196.58333333333357, 220.4250000000002, 242.70000000000041, 264.116666666667, 246.8333333333339, 224.50000000000028, 211.28333333333362, 275.6916666666674, 324.0250000000003, 220.90833333333362, 272.05000000000064, 256.5000000000005, 348.266666666667, 190.67500000000024, 267.77500000000055, 215.92500000000032, 183.14166666666702, 245.01666666666702, 304.21666666666675, 241.4500000000003, 313.6000000000004, 219.80000000000035, 290.06666666666695, 295.34166666666675, 236.45000000000041, 241.78333333333367, 268.3333333333336, 303.3833333333337, 212.75833333333367]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2362253605338161, "mean_inference_ms": 2.0195018869306525, "mean_action_processing_ms": 0.08899120578357991, "mean_env_wait_ms": 1.4990493309757267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006477832794189453, "StateBufferConnector_ms": 0.0033159255981445312, "ViewRequirementAgentConnector_ms": 0.0854487419128418}, "num_episodes": 24, "episode_return_max": 348.266666666667, "episode_return_min": 63.37500000000005, "episode_return_mean": 192.2295000000003, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46200, "num_agent_steps_trained": 45900, "num_env_steps_sampled": 46200, "num_env_steps_trained": 45900, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 236.59149057206966, "num_env_steps_trained_throughput_per_sec": 236.59149057206966, "timesteps_total": 46200, "num_env_steps_sampled_lifetime": 46200, "num_agent_steps_sampled_lifetime": 46200, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 46200, "timers": {"training_iteration_time_ms": 10253.22, "restore_workers_time_ms": 0.015, "training_step_time_ms": 629.899, "sample_time_ms": 613.713, "synch_weights_time_ms": 14.756}, "counters": {"num_env_steps_sampled": 46200, "num_env_steps_trained": 45900, "num_agent_steps_sampled": 46200, "num_agent_steps_trained": 45900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 308, "num_samples_added_to_queue": 46200}, "done": false, "training_iteration": 18, "trial_id": "27800_00000", "date": "2024-10-12_15-30-55", "timestamp": 1728743455, "time_this_iter_s": 10.155288696289062, "time_total_s": 185.6777379512787, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c0fd0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 185.6777379512787, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 16.77142857142857, "ram_util_percent": 31.914285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 277815.65625, "policy_loss": 275532.46875, "entropy": 28.40583610534668, "entropy_coeff": 0.01, "var_gnorm": 16.179933547973633, "vf_loss": 236839.640625, "vf_explained_var": -0.01690506935119629}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 161.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 48600, "num_env_steps_trained": 48300, "num_agent_steps_sampled": 48600, "num_agent_steps_trained": 48300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 324, "num_samples_added_to_queue": 48600, "learner_queue": {"size_count": 161, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.113, "learner_load_time_ms": 0.35, "learner_load_wait_time_ms": 1193.092, "learner_dequeue_time_ms": 9888.278}}, "env_runners": {"episode_reward_max": 361.86666666666724, "episode_reward_min": 119.87500000000011, "episode_reward_mean": 237.82791666666697, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 119.87500000000011}, "policy_reward_max": {"default_policy": 361.86666666666724}, "policy_reward_mean": {"default_policy": 237.82791666666697}, "custom_metrics": {"num_consolidated_mean": 0.9466000000000001, "num_consolidated_min": 0.71, "num_consolidated_max": 1.2, "num_overloaded_mean": 0.41119999999999995, "num_overloaded_min": 0.26, "num_overloaded_max": 0.58, "num_moves_mean": 9.7121, "num_moves_min": 9.25, "num_moves_max": 10.14, "mean_accuracy_mean": 41.28094333333333, "mean_accuracy_min": 41.023999999999994, "mean_accuracy_max": 41.562333333333335, "num_model_switches_mean": 5.936899999999998, "num_model_switches_min": 5.55, "num_model_switches_max": 6.56, "num_slav_mean": 0.1575536666666667, "num_slav_min": 0.13540000000000002, "num_slav_max": 0.17749999999999996, "cpu_conserved_cost_mean": 2.5816000000000003, "cpu_conserved_cost_min": 1.96, "cpu_conserved_cost_max": 3.34, "mean_cluster_cpu_util_mean": 0.5022620724137979, "mean_cluster_cpu_util_min": 0.48756329367659396, "mean_cluster_cpu_util_max": 0.5243605136055612, "mean_cluster_mem_util_mean": 0.3319517836350785, "mean_cluster_mem_util_min": 0.32258778165274554, "mean_cluster_mem_util_max": 0.3419263361462728, "reward_consolidation_mean_mean": 1.3035416666666664, "reward_consolidation_mean_min": 0.8333333333333331, "reward_consolidation_mean_max": 1.7916666666666665, "reward_illegal_mean_mean": -0.6853333333333333, "reward_illegal_mean_min": -0.9666666666666666, "reward_illegal_mean_max": -0.4333333333333333, "reward_accuracy_mean_mean": 3.2133333333333365, "reward_accuracy_mean_min": 2.3666666666666685, "reward_accuracy_mean_max": 4.116666666666673, "reward_sla_mean_mean": -1.4532625000000001, "reward_sla_mean_min": -1.8787499999999997, "reward_sla_mean_max": -1.0685, "reward_consolidation_sum_mean": 130.35416666666663, "reward_consolidation_sum_min": 83.33333333333331, "reward_consolidation_sum_max": 179.16666666666666, "reward_illegal_sum_mean": -68.53333333333332, "reward_illegal_sum_min": -96.66666666666666, "reward_illegal_sum_max": -43.33333333333333, "reward_accuracy_sum_mean": 321.3333333333337, "reward_accuracy_sum_min": 236.66666666666686, "reward_accuracy_sum_max": 411.66666666666737, "reward_sla_sum_mean": -145.32625, "reward_sla_sum_min": -187.87499999999997, "reward_sla_sum_max": -106.85000000000001, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5379.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [142.85833333333363, 171.1750000000003, 153.8083333333336, 150.04166666666688, 179.23333333333392, 175.80833333333356, 196.78333333333356, 159.89166666666688, 161.30000000000038, 199.85000000000036, 186.25833333333364, 152.25833333333367, 137.71666666666684, 135.90000000000026, 187.35833333333375, 222.45000000000033, 171.09166666666698, 162.60833333333358, 155.65833333333356, 130.65000000000018, 119.87500000000011, 138.4333333333335, 163.83333333333331, 161.43333333333365, 162.14166666666705, 183.52500000000012, 242.27500000000023, 255.21666666666698, 233.15000000000066, 195.8250000000004, 200.98333333333366, 168.71666666666707, 268.9416666666669, 224.32500000000033, 227.17500000000024, 222.85000000000025, 186.75000000000026, 220.54166666666703, 236.55000000000032, 235.44166666666715, 223.10833333333366, 199.891666666667, 292.5166666666671, 229.1000000000006, 234.63333333333355, 243.591666666667, 229.05000000000035, 196.58333333333357, 220.4250000000002, 242.70000000000041, 264.116666666667, 246.8333333333339, 224.50000000000028, 211.28333333333362, 275.6916666666674, 324.0250000000003, 220.90833333333362, 272.05000000000064, 256.5000000000005, 348.266666666667, 190.67500000000024, 267.77500000000055, 215.92500000000032, 183.14166666666702, 245.01666666666702, 304.21666666666675, 241.4500000000003, 313.6000000000004, 219.80000000000035, 290.06666666666695, 295.34166666666675, 236.45000000000041, 241.78333333333367, 268.3333333333336, 303.3833333333337, 212.75833333333367, 272.69166666666695, 303.3750000000005, 270.5333333333335, 302.2666666666672, 321.46666666666715, 325.0166666666668, 361.86666666666724, 300.066666666667, 316.8166666666671, 324.3333333333339, 291.483333333334, 331.04166666666714, 344.36666666666736, 342.8833333333336, 328.92500000000047, 269.75833333333406, 221.05000000000035, 345.9750000000003, 285.50000000000034, 307.266666666667, 298.7250000000003, 280.5500000000003, 337.26666666666694, 333.39166666666677], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [142.85833333333363, 171.1750000000003, 153.8083333333336, 150.04166666666688, 179.23333333333392, 175.80833333333356, 196.78333333333356, 159.89166666666688, 161.30000000000038, 199.85000000000036, 186.25833333333364, 152.25833333333367, 137.71666666666684, 135.90000000000026, 187.35833333333375, 222.45000000000033, 171.09166666666698, 162.60833333333358, 155.65833333333356, 130.65000000000018, 119.87500000000011, 138.4333333333335, 163.83333333333331, 161.43333333333365, 162.14166666666705, 183.52500000000012, 242.27500000000023, 255.21666666666698, 233.15000000000066, 195.8250000000004, 200.98333333333366, 168.71666666666707, 268.9416666666669, 224.32500000000033, 227.17500000000024, 222.85000000000025, 186.75000000000026, 220.54166666666703, 236.55000000000032, 235.44166666666715, 223.10833333333366, 199.891666666667, 292.5166666666671, 229.1000000000006, 234.63333333333355, 243.591666666667, 229.05000000000035, 196.58333333333357, 220.4250000000002, 242.70000000000041, 264.116666666667, 246.8333333333339, 224.50000000000028, 211.28333333333362, 275.6916666666674, 324.0250000000003, 220.90833333333362, 272.05000000000064, 256.5000000000005, 348.266666666667, 190.67500000000024, 267.77500000000055, 215.92500000000032, 183.14166666666702, 245.01666666666702, 304.21666666666675, 241.4500000000003, 313.6000000000004, 219.80000000000035, 290.06666666666695, 295.34166666666675, 236.45000000000041, 241.78333333333367, 268.3333333333336, 303.3833333333337, 212.75833333333367, 272.69166666666695, 303.3750000000005, 270.5333333333335, 302.2666666666672, 321.46666666666715, 325.0166666666668, 361.86666666666724, 300.066666666667, 316.8166666666671, 324.3333333333339, 291.483333333334, 331.04166666666714, 344.36666666666736, 342.8833333333336, 328.92500000000047, 269.75833333333406, 221.05000000000035, 345.9750000000003, 285.50000000000034, 307.266666666667, 298.7250000000003, 280.5500000000003, 337.26666666666694, 333.39166666666677]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23690808990982423, "mean_inference_ms": 2.0237382394269914, "mean_action_processing_ms": 0.08921195640337835, "mean_env_wait_ms": 1.5031590248213218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006558895111083984, "StateBufferConnector_ms": 0.003338336944580078, "ViewRequirementAgentConnector_ms": 0.08634424209594727}, "num_episodes": 24, "episode_return_max": 361.86666666666724, "episode_return_min": 119.87500000000011, "episode_return_mean": 237.82791666666697, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48600, "num_agent_steps_trained": 48300, "num_env_steps_sampled": 48600, "num_env_steps_trained": 48300, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 235.19099004548062, "num_env_steps_trained_throughput_per_sec": 235.19099004548062, "timesteps_total": 48600, "num_env_steps_sampled_lifetime": 48600, "num_agent_steps_sampled_lifetime": 48600, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 48600, "timers": {"training_iteration_time_ms": 10257.148, "restore_workers_time_ms": 0.016, "training_step_time_ms": 642.393, "sample_time_ms": 624.976, "synch_weights_time_ms": 15.807}, "counters": {"num_env_steps_sampled": 48600, "num_env_steps_trained": 48300, "num_agent_steps_sampled": 48600, "num_agent_steps_trained": 48300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 324, "num_samples_added_to_queue": 48600}, "done": false, "training_iteration": 19, "trial_id": "27800_00000", "date": "2024-10-12_15-31-05", "timestamp": 1728743465, "time_this_iter_s": 10.22146987915039, "time_total_s": 195.89920783042908, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f0670>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 195.89920783042908, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 16.786666666666665, "ram_util_percent": 32.06666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 276818.03125, "policy_loss": 274549.84375, "entropy": 28.170682907104492, "entropy_coeff": 0.01, "var_gnorm": 16.189632415771484, "vf_loss": 235268.59375, "vf_explained_var": -0.013878345489501953}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 169.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 51000, "num_env_steps_trained": 50700, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 50700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 340, "num_samples_added_to_queue": 51000, "learner_queue": {"size_count": 169, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 72.291, "learner_load_time_ms": 0.348, "learner_load_wait_time_ms": 1223.366, "learner_dequeue_time_ms": 9964.054}}, "env_runners": {"episode_reward_max": 419.20833333333366, "episode_reward_min": 162.14166666666705, "episode_reward_mean": 281.11766666666705, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 162.14166666666705}, "policy_reward_max": {"default_policy": 419.20833333333366}, "policy_reward_mean": {"default_policy": 281.11766666666705}, "custom_metrics": {"num_consolidated_mean": 1.0059, "num_consolidated_min": 0.71, "num_consolidated_max": 1.26, "num_overloaded_mean": 0.35760000000000003, "num_overloaded_min": 0.17, "num_overloaded_max": 0.56, "num_moves_mean": 9.636599999999998, "num_moves_min": 9.25, "num_moves_max": 9.95, "mean_accuracy_mean": 41.326100000000004, "mean_accuracy_min": 41.05566666666667, "mean_accuracy_max": 41.64466666666667, "num_model_switches_mean": 5.9193999999999996, "num_model_switches_min": 5.5, "num_model_switches_max": 6.56, "num_slav_mean": 0.15784800000000002, "num_slav_min": 0.13540000000000002, "num_slav_max": 0.17775, "cpu_conserved_cost_mean": 2.6740000000000004, "cpu_conserved_cost_min": 1.96, "cpu_conserved_cost_max": 3.34, "mean_cluster_cpu_util_mean": 0.4978950248446442, "mean_cluster_cpu_util_min": 0.4793132353697676, "mean_cluster_cpu_util_max": 0.5162634667513553, "mean_cluster_mem_util_mean": 0.32923112968404666, "mean_cluster_mem_util_min": 0.3185201607752805, "mean_cluster_mem_util_max": 0.33889459442004644, "reward_consolidation_mean_mean": 1.4789583333333332, "reward_consolidation_mean_min": 0.9583333333333331, "reward_consolidation_mean_max": 2.0624999999999996, "reward_illegal_mean_mean": -0.5959999999999999, "reward_illegal_mean_min": -0.9333333333333331, "reward_illegal_mean_max": -0.2833333333333334, "reward_accuracy_mean_mean": 3.4963333333333373, "reward_accuracy_mean_min": 2.6833333333333353, "reward_accuracy_mean_max": 4.383333333333339, "reward_sla_mean_mean": -1.568115, "reward_sla_mean_min": -1.96125, "reward_sla_mean_max": -1.155, "reward_consolidation_sum_mean": 147.89583333333331, "reward_consolidation_sum_min": 95.83333333333331, "reward_consolidation_sum_max": 206.24999999999994, "reward_illegal_sum_mean": -59.6, "reward_illegal_sum_min": -93.33333333333331, "reward_illegal_sum_max": -28.333333333333336, "reward_accuracy_sum_mean": 349.6333333333338, "reward_accuracy_sum_min": 268.33333333333354, "reward_accuracy_sum_max": 438.33333333333394, "reward_sla_sum_mean": -156.81150000000002, "reward_sla_sum_min": -196.125, "reward_sla_sum_max": -115.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4302.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [162.14166666666705, 183.52500000000012, 242.27500000000023, 255.21666666666698, 233.15000000000066, 195.8250000000004, 200.98333333333366, 168.71666666666707, 268.9416666666669, 224.32500000000033, 227.17500000000024, 222.85000000000025, 186.75000000000026, 220.54166666666703, 236.55000000000032, 235.44166666666715, 223.10833333333366, 199.891666666667, 292.5166666666671, 229.1000000000006, 234.63333333333355, 243.591666666667, 229.05000000000035, 196.58333333333357, 220.4250000000002, 242.70000000000041, 264.116666666667, 246.8333333333339, 224.50000000000028, 211.28333333333362, 275.6916666666674, 324.0250000000003, 220.90833333333362, 272.05000000000064, 256.5000000000005, 348.266666666667, 190.67500000000024, 267.77500000000055, 215.92500000000032, 183.14166666666702, 245.01666666666702, 304.21666666666675, 241.4500000000003, 313.6000000000004, 219.80000000000035, 290.06666666666695, 295.34166666666675, 236.45000000000041, 241.78333333333367, 268.3333333333336, 303.3833333333337, 212.75833333333367, 272.69166666666695, 303.3750000000005, 270.5333333333335, 302.2666666666672, 321.46666666666715, 325.0166666666668, 361.86666666666724, 300.066666666667, 316.8166666666671, 324.3333333333339, 291.483333333334, 331.04166666666714, 344.36666666666736, 342.8833333333336, 328.92500000000047, 269.75833333333406, 221.05000000000035, 345.9750000000003, 285.50000000000034, 307.266666666667, 298.7250000000003, 280.5500000000003, 337.26666666666694, 333.39166666666677, 298.76666666666705, 380.8750000000004, 349.75833333333384, 323.6166666666672, 342.4333333333336, 347.7583333333337, 307.07500000000016, 353.52500000000043, 367.0166666666669, 419.20833333333366, 349.73333333333375, 320.1250000000003, 323.4416666666672, 339.80000000000047, 373.9250000000004, 262.46666666666715, 371.0333333333341, 341.45000000000033, 269.9000000000006, 332.4500000000004, 370.40000000000003, 373.733333333334, 354.96666666666727, 371.791666666667], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [162.14166666666705, 183.52500000000012, 242.27500000000023, 255.21666666666698, 233.15000000000066, 195.8250000000004, 200.98333333333366, 168.71666666666707, 268.9416666666669, 224.32500000000033, 227.17500000000024, 222.85000000000025, 186.75000000000026, 220.54166666666703, 236.55000000000032, 235.44166666666715, 223.10833333333366, 199.891666666667, 292.5166666666671, 229.1000000000006, 234.63333333333355, 243.591666666667, 229.05000000000035, 196.58333333333357, 220.4250000000002, 242.70000000000041, 264.116666666667, 246.8333333333339, 224.50000000000028, 211.28333333333362, 275.6916666666674, 324.0250000000003, 220.90833333333362, 272.05000000000064, 256.5000000000005, 348.266666666667, 190.67500000000024, 267.77500000000055, 215.92500000000032, 183.14166666666702, 245.01666666666702, 304.21666666666675, 241.4500000000003, 313.6000000000004, 219.80000000000035, 290.06666666666695, 295.34166666666675, 236.45000000000041, 241.78333333333367, 268.3333333333336, 303.3833333333337, 212.75833333333367, 272.69166666666695, 303.3750000000005, 270.5333333333335, 302.2666666666672, 321.46666666666715, 325.0166666666668, 361.86666666666724, 300.066666666667, 316.8166666666671, 324.3333333333339, 291.483333333334, 331.04166666666714, 344.36666666666736, 342.8833333333336, 328.92500000000047, 269.75833333333406, 221.05000000000035, 345.9750000000003, 285.50000000000034, 307.266666666667, 298.7250000000003, 280.5500000000003, 337.26666666666694, 333.39166666666677, 298.76666666666705, 380.8750000000004, 349.75833333333384, 323.6166666666672, 342.4333333333336, 347.7583333333337, 307.07500000000016, 353.52500000000043, 367.0166666666669, 419.20833333333366, 349.73333333333375, 320.1250000000003, 323.4416666666672, 339.80000000000047, 373.9250000000004, 262.46666666666715, 371.0333333333341, 341.45000000000033, 269.9000000000006, 332.4500000000004, 370.40000000000003, 373.733333333334, 354.96666666666727, 371.791666666667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23761498599502673, "mean_inference_ms": 2.0272604480584215, "mean_action_processing_ms": 0.08943665480617509, "mean_env_wait_ms": 1.5074975204578374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006598949432373047, "StateBufferConnector_ms": 0.0033631324768066406, "ViewRequirementAgentConnector_ms": 0.08727288246154785}, "num_episodes": 24, "episode_return_max": 419.20833333333366, "episode_return_min": 162.14166666666705, "episode_return_mean": 281.11766666666705, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 50700, "num_env_steps_sampled": 51000, "num_env_steps_trained": 50700, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 230.898486141372, "num_env_steps_trained_throughput_per_sec": 230.898486141372, "timesteps_total": 51000, "num_env_steps_sampled_lifetime": 51000, "num_agent_steps_sampled_lifetime": 51000, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 51000, "timers": {"training_iteration_time_ms": 10293.082, "restore_workers_time_ms": 0.016, "training_step_time_ms": 647.261, "sample_time_ms": 630.271, "synch_weights_time_ms": 15.48}, "counters": {"num_env_steps_sampled": 51000, "num_env_steps_trained": 50700, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 50700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 340, "num_samples_added_to_queue": 51000}, "done": false, "training_iteration": 20, "trial_id": "27800_00000", "date": "2024-10-12_15-31-16", "timestamp": 1728743476, "time_this_iter_s": 10.409158945083618, "time_total_s": 206.3083667755127, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f68fd0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 206.3083667755127, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 16.673333333333332, "ram_util_percent": 32.20666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 335202.21875, "policy_loss": 331694.375, "entropy": 27.88011360168457, "entropy_coeff": 0.01, "var_gnorm": 16.20180320739746, "vf_loss": 359146.59375, "vf_explained_var": -0.008403539657592773}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 177.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 53400, "num_env_steps_trained": 53100, "num_agent_steps_sampled": 53400, "num_agent_steps_trained": 53100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 356, "num_samples_added_to_queue": 53400, "learner_queue": {"size_count": 177, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 64.795, "learner_load_time_ms": 0.332, "learner_load_wait_time_ms": 1230.252, "learner_dequeue_time_ms": 10017.93}}, "env_runners": {"episode_reward_max": 469.6666666666676, "episode_reward_min": 183.14166666666702, "episode_reward_mean": 317.5404166666671, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 183.14166666666702}, "policy_reward_max": {"default_policy": 469.6666666666676}, "policy_reward_mean": {"default_policy": 317.5404166666671}, "custom_metrics": {"num_consolidated_mean": 1.0632, "num_consolidated_min": 0.71, "num_consolidated_max": 1.27, "num_overloaded_mean": 0.3193, "num_overloaded_min": 0.17, "num_overloaded_max": 0.49, "num_moves_mean": 9.5779, "num_moves_min": 9.14, "num_moves_max": 9.94, "mean_accuracy_mean": 41.37676666666667, "mean_accuracy_min": 41.10633333333333, "mean_accuracy_max": 41.70166666666667, "num_model_switches_mean": 5.898299999999999, "num_model_switches_min": 5.45, "num_model_switches_max": 6.56, "num_slav_mean": 0.15861583333333334, "num_slav_min": 0.14325000000000002, "num_slav_max": 0.17775, "cpu_conserved_cost_mean": 2.7558, "cpu_conserved_cost_min": 1.96, "cpu_conserved_cost_max": 3.34, "mean_cluster_cpu_util_mean": 0.49404250010434253, "mean_cluster_cpu_util_min": 0.47892861557695476, "mean_cluster_cpu_util_max": 0.5102727530467445, "mean_cluster_mem_util_mean": 0.32696896791849656, "mean_cluster_mem_util_min": 0.31718920677975826, "mean_cluster_mem_util_max": 0.33622580728493934, "reward_consolidation_mean_mean": 1.6370833333333328, "reward_consolidation_mean_min": 1.020833333333333, "reward_consolidation_mean_max": 2.208333333333333, "reward_illegal_mean_mean": -0.5321666666666666, "reward_illegal_mean_min": -0.8166666666666665, "reward_illegal_mean_max": -0.2833333333333334, "reward_accuracy_mean_mean": 3.724500000000005, "reward_accuracy_mean_min": 2.6833333333333353, "reward_accuracy_mean_max": 4.908333333333343, "reward_sla_mean_mean": -1.6540125, "reward_sla_mean_min": -2.12, "reward_sla_mean_max": -1.202, "reward_consolidation_sum_mean": 163.70833333333331, "reward_consolidation_sum_min": 102.0833333333333, "reward_consolidation_sum_max": 220.8333333333333, "reward_illegal_sum_mean": -53.21666666666666, "reward_illegal_sum_min": -81.66666666666666, "reward_illegal_sum_max": -28.333333333333336, "reward_accuracy_sum_mean": 372.4500000000004, "reward_accuracy_sum_min": 268.33333333333354, "reward_accuracy_sum_max": 490.8333333333343, "reward_sla_sum_mean": -165.40125, "reward_sla_sum_min": -212.0, "reward_sla_sum_max": -120.19999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3230.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [220.4250000000002, 242.70000000000041, 264.116666666667, 246.8333333333339, 224.50000000000028, 211.28333333333362, 275.6916666666674, 324.0250000000003, 220.90833333333362, 272.05000000000064, 256.5000000000005, 348.266666666667, 190.67500000000024, 267.77500000000055, 215.92500000000032, 183.14166666666702, 245.01666666666702, 304.21666666666675, 241.4500000000003, 313.6000000000004, 219.80000000000035, 290.06666666666695, 295.34166666666675, 236.45000000000041, 241.78333333333367, 268.3333333333336, 303.3833333333337, 212.75833333333367, 272.69166666666695, 303.3750000000005, 270.5333333333335, 302.2666666666672, 321.46666666666715, 325.0166666666668, 361.86666666666724, 300.066666666667, 316.8166666666671, 324.3333333333339, 291.483333333334, 331.04166666666714, 344.36666666666736, 342.8833333333336, 328.92500000000047, 269.75833333333406, 221.05000000000035, 345.9750000000003, 285.50000000000034, 307.266666666667, 298.7250000000003, 280.5500000000003, 337.26666666666694, 333.39166666666677, 298.76666666666705, 380.8750000000004, 349.75833333333384, 323.6166666666672, 342.4333333333336, 347.7583333333337, 307.07500000000016, 353.52500000000043, 367.0166666666669, 419.20833333333366, 349.73333333333375, 320.1250000000003, 323.4416666666672, 339.80000000000047, 373.9250000000004, 262.46666666666715, 371.0333333333341, 341.45000000000033, 269.9000000000006, 332.4500000000004, 370.40000000000003, 373.733333333334, 354.96666666666727, 371.791666666667, 330.03333333333364, 364.70833333333405, 403.58333333333377, 342.3000000000006, 329.166666666667, 358.95833333333377, 469.6666666666676, 375.28333333333416, 332.27500000000043, 385.84166666666704, 396.1333333333337, 373.8333333333337, 359.3416666666674, 400.0750000000006, 350.1166666666671, 383.4583333333338, 340.0166666666668, 301.5416666666672, 396.0083333333336, 419.2333333333336, 382.6333333333338, 387.616666666667, 374.95000000000067, 398.38333333333384], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [220.4250000000002, 242.70000000000041, 264.116666666667, 246.8333333333339, 224.50000000000028, 211.28333333333362, 275.6916666666674, 324.0250000000003, 220.90833333333362, 272.05000000000064, 256.5000000000005, 348.266666666667, 190.67500000000024, 267.77500000000055, 215.92500000000032, 183.14166666666702, 245.01666666666702, 304.21666666666675, 241.4500000000003, 313.6000000000004, 219.80000000000035, 290.06666666666695, 295.34166666666675, 236.45000000000041, 241.78333333333367, 268.3333333333336, 303.3833333333337, 212.75833333333367, 272.69166666666695, 303.3750000000005, 270.5333333333335, 302.2666666666672, 321.46666666666715, 325.0166666666668, 361.86666666666724, 300.066666666667, 316.8166666666671, 324.3333333333339, 291.483333333334, 331.04166666666714, 344.36666666666736, 342.8833333333336, 328.92500000000047, 269.75833333333406, 221.05000000000035, 345.9750000000003, 285.50000000000034, 307.266666666667, 298.7250000000003, 280.5500000000003, 337.26666666666694, 333.39166666666677, 298.76666666666705, 380.8750000000004, 349.75833333333384, 323.6166666666672, 342.4333333333336, 347.7583333333337, 307.07500000000016, 353.52500000000043, 367.0166666666669, 419.20833333333366, 349.73333333333375, 320.1250000000003, 323.4416666666672, 339.80000000000047, 373.9250000000004, 262.46666666666715, 371.0333333333341, 341.45000000000033, 269.9000000000006, 332.4500000000004, 370.40000000000003, 373.733333333334, 354.96666666666727, 371.791666666667, 330.03333333333364, 364.70833333333405, 403.58333333333377, 342.3000000000006, 329.166666666667, 358.95833333333377, 469.6666666666676, 375.28333333333416, 332.27500000000043, 385.84166666666704, 396.1333333333337, 373.8333333333337, 359.3416666666674, 400.0750000000006, 350.1166666666671, 383.4583333333338, 340.0166666666668, 301.5416666666672, 396.0083333333336, 419.2333333333336, 382.6333333333338, 387.616666666667, 374.95000000000067, 398.38333333333384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2382494824323777, "mean_inference_ms": 2.03296208556044, "mean_action_processing_ms": 0.08968374885082799, "mean_env_wait_ms": 1.5122784972303294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066301822662353516, "StateBufferConnector_ms": 0.0033833980560302734, "ViewRequirementAgentConnector_ms": 0.08763551712036133}, "num_episodes": 24, "episode_return_max": 469.6666666666676, "episode_return_min": 183.14166666666702, "episode_return_mean": 317.5404166666671, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53400, "num_agent_steps_trained": 53100, "num_env_steps_sampled": 53400, "num_env_steps_trained": 53100, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 233.21962800718012, "num_env_steps_trained_throughput_per_sec": 233.21962800718012, "timesteps_total": 53400, "num_env_steps_sampled_lifetime": 53400, "num_agent_steps_sampled_lifetime": 53400, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 53400, "timers": {"training_iteration_time_ms": 10283.113, "restore_workers_time_ms": 0.017, "training_step_time_ms": 638.602, "sample_time_ms": 622.207, "synch_weights_time_ms": 14.787}, "counters": {"num_env_steps_sampled": 53400, "num_env_steps_trained": 53100, "num_agent_steps_sampled": 53400, "num_agent_steps_trained": 53100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 356, "num_samples_added_to_queue": 53400}, "done": false, "training_iteration": 21, "trial_id": "27800_00000", "date": "2024-10-12_15-31-26", "timestamp": 1728743486, "time_this_iter_s": 10.300642490386963, "time_total_s": 216.60900926589966, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f694b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 216.60900926589966, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 16.414285714285718, "ram_util_percent": 32.32857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 379008.875, "policy_loss": 374633.125, "entropy": 27.677204132080078, "entropy_coeff": 0.01, "var_gnorm": 16.21214485168457, "vf_loss": 445879.21875, "vf_explained_var": -0.004760861396789551}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 185.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 55800, "num_env_steps_trained": 55500, "num_agent_steps_sampled": 55800, "num_agent_steps_trained": 55500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 372, "num_samples_added_to_queue": 55800, "learner_queue": {"size_count": 185, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.608, "learner_load_time_ms": 0.388, "learner_load_wait_time_ms": 1214.698, "learner_dequeue_time_ms": 10082.472}}, "env_runners": {"episode_reward_max": 470.03333333333376, "episode_reward_min": 212.75833333333367, "episode_reward_mean": 352.37700000000046, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 212.75833333333367}, "policy_reward_max": {"default_policy": 470.03333333333376}, "policy_reward_mean": {"default_policy": 352.37700000000046}, "custom_metrics": {"num_consolidated_mean": 1.1118999999999999, "num_consolidated_min": 0.71, "num_consolidated_max": 1.33, "num_overloaded_mean": 0.28290000000000004, "num_overloaded_min": 0.16, "num_overloaded_max": 0.48, "num_moves_mean": 9.521, "num_moves_min": 9.14, "num_moves_max": 9.86, "mean_accuracy_mean": 41.43028333333333, "mean_accuracy_min": 41.10633333333333, "mean_accuracy_max": 41.73966666666667, "num_model_switches_mean": 5.8782000000000005, "num_model_switches_min": 5.45, "num_model_switches_max": 6.56, "num_slav_mean": 0.1585515, "num_slav_min": 0.13995000000000002, "num_slav_max": 0.17775, "cpu_conserved_cost_mean": 2.8379999999999996, "cpu_conserved_cost_min": 1.96, "cpu_conserved_cost_max": 3.4, "mean_cluster_cpu_util_mean": 0.49143374725309535, "mean_cluster_cpu_util_min": 0.477240110631145, "mean_cluster_cpu_util_max": 0.5047757436635906, "mean_cluster_mem_util_mean": 0.3252888980632338, "mean_cluster_mem_util_min": 0.31510016181578115, "mean_cluster_mem_util_max": 0.334428249411579, "reward_consolidation_mean_mean": 1.7727083333333329, "reward_consolidation_mean_min": 1.020833333333333, "reward_consolidation_mean_max": 2.291666666666666, "reward_illegal_mean_mean": -0.4714999999999999, "reward_illegal_mean_min": -0.7999999999999998, "reward_illegal_mean_max": -0.26666666666666666, "reward_accuracy_mean_mean": 3.953916666666673, "reward_accuracy_mean_min": 2.8916666666666697, "reward_accuracy_mean_max": 4.908333333333343, "reward_sla_mean_mean": -1.731355, "reward_sla_mean_min": -2.12, "reward_sla_mean_max": -1.31125, "reward_consolidation_sum_mean": 177.27083333333331, "reward_consolidation_sum_min": 102.0833333333333, "reward_consolidation_sum_max": 229.1666666666666, "reward_illegal_sum_mean": -47.14999999999999, "reward_illegal_sum_min": -79.99999999999999, "reward_illegal_sum_max": -26.666666666666664, "reward_accuracy_sum_mean": 395.39166666666716, "reward_accuracy_sum_min": 289.16666666666697, "reward_accuracy_sum_max": 490.8333333333343, "reward_sla_sum_mean": -173.13549999999998, "reward_sla_sum_min": -212.0, "reward_sla_sum_max": -131.125, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2158.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [241.78333333333367, 268.3333333333336, 303.3833333333337, 212.75833333333367, 272.69166666666695, 303.3750000000005, 270.5333333333335, 302.2666666666672, 321.46666666666715, 325.0166666666668, 361.86666666666724, 300.066666666667, 316.8166666666671, 324.3333333333339, 291.483333333334, 331.04166666666714, 344.36666666666736, 342.8833333333336, 328.92500000000047, 269.75833333333406, 221.05000000000035, 345.9750000000003, 285.50000000000034, 307.266666666667, 298.7250000000003, 280.5500000000003, 337.26666666666694, 333.39166666666677, 298.76666666666705, 380.8750000000004, 349.75833333333384, 323.6166666666672, 342.4333333333336, 347.7583333333337, 307.07500000000016, 353.52500000000043, 367.0166666666669, 419.20833333333366, 349.73333333333375, 320.1250000000003, 323.4416666666672, 339.80000000000047, 373.9250000000004, 262.46666666666715, 371.0333333333341, 341.45000000000033, 269.9000000000006, 332.4500000000004, 370.40000000000003, 373.733333333334, 354.96666666666727, 371.791666666667, 330.03333333333364, 364.70833333333405, 403.58333333333377, 342.3000000000006, 329.166666666667, 358.95833333333377, 469.6666666666676, 375.28333333333416, 332.27500000000043, 385.84166666666704, 396.1333333333337, 373.8333333333337, 359.3416666666674, 400.0750000000006, 350.1166666666671, 383.4583333333338, 340.0166666666668, 301.5416666666672, 396.0083333333336, 419.2333333333336, 382.6333333333338, 387.616666666667, 374.95000000000067, 398.38333333333384, 323.04166666666697, 360.9750000000004, 391.7750000000005, 411.3333333333339, 421.16666666666725, 430.56666666666734, 470.03333333333376, 369.45000000000067, 397.65000000000043, 419.6000000000005, 384.1500000000008, 424.933333333334, 415.42500000000064, 328.4333333333339, 435.55833333333385, 387.10000000000053, 414.16666666666674, 388.4833333333339, 395.36666666666713, 390.60000000000065, 370.21666666666727, 379.0250000000003, 435.8583333333338, 449.5083333333338], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [241.78333333333367, 268.3333333333336, 303.3833333333337, 212.75833333333367, 272.69166666666695, 303.3750000000005, 270.5333333333335, 302.2666666666672, 321.46666666666715, 325.0166666666668, 361.86666666666724, 300.066666666667, 316.8166666666671, 324.3333333333339, 291.483333333334, 331.04166666666714, 344.36666666666736, 342.8833333333336, 328.92500000000047, 269.75833333333406, 221.05000000000035, 345.9750000000003, 285.50000000000034, 307.266666666667, 298.7250000000003, 280.5500000000003, 337.26666666666694, 333.39166666666677, 298.76666666666705, 380.8750000000004, 349.75833333333384, 323.6166666666672, 342.4333333333336, 347.7583333333337, 307.07500000000016, 353.52500000000043, 367.0166666666669, 419.20833333333366, 349.73333333333375, 320.1250000000003, 323.4416666666672, 339.80000000000047, 373.9250000000004, 262.46666666666715, 371.0333333333341, 341.45000000000033, 269.9000000000006, 332.4500000000004, 370.40000000000003, 373.733333333334, 354.96666666666727, 371.791666666667, 330.03333333333364, 364.70833333333405, 403.58333333333377, 342.3000000000006, 329.166666666667, 358.95833333333377, 469.6666666666676, 375.28333333333416, 332.27500000000043, 385.84166666666704, 396.1333333333337, 373.8333333333337, 359.3416666666674, 400.0750000000006, 350.1166666666671, 383.4583333333338, 340.0166666666668, 301.5416666666672, 396.0083333333336, 419.2333333333336, 382.6333333333338, 387.616666666667, 374.95000000000067, 398.38333333333384, 323.04166666666697, 360.9750000000004, 391.7750000000005, 411.3333333333339, 421.16666666666725, 430.56666666666734, 470.03333333333376, 369.45000000000067, 397.65000000000043, 419.6000000000005, 384.1500000000008, 424.933333333334, 415.42500000000064, 328.4333333333339, 435.55833333333385, 387.10000000000053, 414.16666666666674, 388.4833333333339, 395.36666666666713, 390.60000000000065, 370.21666666666727, 379.0250000000003, 435.8583333333338, 449.5083333333338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23873291565149424, "mean_inference_ms": 2.038493325235338, "mean_action_processing_ms": 0.08991623009193635, "mean_env_wait_ms": 1.5167099897237577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006750345230102539, "StateBufferConnector_ms": 0.0034210681915283203, "ViewRequirementAgentConnector_ms": 0.08827877044677734}, "num_episodes": 24, "episode_return_max": 470.03333333333376, "episode_return_min": 212.75833333333367, "episode_return_mean": 352.37700000000046, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55800, "num_agent_steps_trained": 55500, "num_env_steps_sampled": 55800, "num_env_steps_trained": 55500, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 234.82964327405165, "num_env_steps_trained_throughput_per_sec": 234.82964327405165, "timesteps_total": 55800, "num_env_steps_sampled_lifetime": 55800, "num_agent_steps_sampled_lifetime": 55800, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 55800, "timers": {"training_iteration_time_ms": 10287.734, "restore_workers_time_ms": 0.014, "training_step_time_ms": 640.428, "sample_time_ms": 624.494, "synch_weights_time_ms": 14.331}, "counters": {"num_env_steps_sampled": 55800, "num_env_steps_trained": 55500, "num_agent_steps_sampled": 55800, "num_agent_steps_trained": 55500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 372, "num_samples_added_to_queue": 55800}, "done": false, "training_iteration": 22, "trial_id": "27800_00000", "date": "2024-10-12_15-31-36", "timestamp": 1728743496, "time_this_iter_s": 10.231055974960327, "time_total_s": 226.84006524085999, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f693c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 226.84006524085999, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 16.42666666666667, "ram_util_percent": 32.506666666666675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 362206.90625, "policy_loss": 358027.0, "entropy": 27.451351165771484, "entropy_coeff": 0.01, "var_gnorm": 16.218656539916992, "vf_loss": 426225.875, "vf_explained_var": -0.0010952949523925781}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 193.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 58200, "num_env_steps_trained": 57900, "num_agent_steps_sampled": 58200, "num_agent_steps_trained": 57900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 388, "num_samples_added_to_queue": 58200, "learner_queue": {"size_count": 193, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.907, "learner_load_time_ms": 0.415, "learner_load_wait_time_ms": 1196.681, "learner_dequeue_time_ms": 10144.326}}, "env_runners": {"episode_reward_max": 498.10833333333414, "episode_reward_min": 262.46666666666715, "episode_reward_mean": 383.08566666666707, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 262.46666666666715}, "policy_reward_max": {"default_policy": 498.10833333333414}, "policy_reward_mean": {"default_policy": 383.08566666666707}, "custom_metrics": {"num_consolidated_mean": 1.1649, "num_consolidated_min": 0.95, "num_consolidated_max": 1.39, "num_overloaded_mean": 0.2549, "num_overloaded_min": 0.15, "num_overloaded_max": 0.4, "num_moves_mean": 9.4653, "num_moves_min": 9.08, "num_moves_max": 9.86, "mean_accuracy_mean": 41.47784666666667, "mean_accuracy_min": 41.144333333333336, "mean_accuracy_max": 41.73966666666667, "num_model_switches_mean": 5.8515999999999995, "num_model_switches_min": 5.45, "num_model_switches_max": 6.31, "num_slav_mean": 0.158489, "num_slav_min": 0.13814999999999997, "num_slav_max": 0.17775, "cpu_conserved_cost_mean": 2.9182, "cpu_conserved_cost_min": 2.32, "cpu_conserved_cost_max": 3.62, "mean_cluster_cpu_util_mean": 0.4888584048802986, "mean_cluster_cpu_util_min": 0.475595416653568, "mean_cluster_cpu_util_max": 0.5019978816307716, "mean_cluster_mem_util_mean": 0.32341944137676165, "mean_cluster_mem_util_min": 0.31510016181578115, "mean_cluster_mem_util_max": 0.3318710599113063, "reward_consolidation_mean_mean": 1.9022916666666663, "reward_consolidation_mean_min": 1.3749999999999998, "reward_consolidation_mean_max": 2.3749999999999996, "reward_illegal_mean_mean": -0.42483333333333334, "reward_illegal_mean_min": -0.6666666666666667, "reward_illegal_mean_max": -0.25, "reward_accuracy_mean_mean": 4.14708333333334, "reward_accuracy_mean_min": 3.2750000000000035, "reward_accuracy_mean_max": 4.908333333333343, "reward_sla_mean_mean": -1.7936849999999998, "reward_sla_mean_min": -2.12, "reward_sla_mean_max": -1.31125, "reward_consolidation_sum_mean": 190.22916666666663, "reward_consolidation_sum_min": 137.49999999999997, "reward_consolidation_sum_max": 237.49999999999997, "reward_illegal_sum_mean": -42.48333333333334, "reward_illegal_sum_min": -66.66666666666667, "reward_illegal_sum_max": -25.0, "reward_accuracy_sum_mean": 414.70833333333394, "reward_accuracy_sum_min": 327.50000000000034, "reward_accuracy_sum_max": 490.8333333333343, "reward_sla_sum_mean": -179.3685, "reward_sla_sum_min": -212.0, "reward_sla_sum_max": -131.125, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2178.0, "global_timestep_min": 300, "global_timestep_max": 3800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [298.7250000000003, 280.5500000000003, 337.26666666666694, 333.39166666666677, 298.76666666666705, 380.8750000000004, 349.75833333333384, 323.6166666666672, 342.4333333333336, 347.7583333333337, 307.07500000000016, 353.52500000000043, 367.0166666666669, 419.20833333333366, 349.73333333333375, 320.1250000000003, 323.4416666666672, 339.80000000000047, 373.9250000000004, 262.46666666666715, 371.0333333333341, 341.45000000000033, 269.9000000000006, 332.4500000000004, 370.40000000000003, 373.733333333334, 354.96666666666727, 371.791666666667, 330.03333333333364, 364.70833333333405, 403.58333333333377, 342.3000000000006, 329.166666666667, 358.95833333333377, 469.6666666666676, 375.28333333333416, 332.27500000000043, 385.84166666666704, 396.1333333333337, 373.8333333333337, 359.3416666666674, 400.0750000000006, 350.1166666666671, 383.4583333333338, 340.0166666666668, 301.5416666666672, 396.0083333333336, 419.2333333333336, 382.6333333333338, 387.616666666667, 374.95000000000067, 398.38333333333384, 323.04166666666697, 360.9750000000004, 391.7750000000005, 411.3333333333339, 421.16666666666725, 430.56666666666734, 470.03333333333376, 369.45000000000067, 397.65000000000043, 419.6000000000005, 384.1500000000008, 424.933333333334, 415.42500000000064, 328.4333333333339, 435.55833333333385, 387.10000000000053, 414.16666666666674, 388.4833333333339, 395.36666666666713, 390.60000000000065, 370.21666666666727, 379.0250000000003, 435.8583333333338, 449.5083333333338, 409.47500000000053, 379.5250000000004, 410.02500000000055, 409.8416666666673, 476.7500000000005, 386.6666666666671, 418.16666666666714, 441.03333333333404, 409.99166666666724, 360.0166666666671, 498.10833333333414, 432.9583333333338, 399.96666666666715, 480.34166666666727, 460.4083333333339, 437.4666666666672, 423.8916666666673, 414.9666666666671, 402.7750000000004, 439.5416666666671, 472.1750000000005, 477.37500000000074, 407.8416666666673, 414.5000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [298.7250000000003, 280.5500000000003, 337.26666666666694, 333.39166666666677, 298.76666666666705, 380.8750000000004, 349.75833333333384, 323.6166666666672, 342.4333333333336, 347.7583333333337, 307.07500000000016, 353.52500000000043, 367.0166666666669, 419.20833333333366, 349.73333333333375, 320.1250000000003, 323.4416666666672, 339.80000000000047, 373.9250000000004, 262.46666666666715, 371.0333333333341, 341.45000000000033, 269.9000000000006, 332.4500000000004, 370.40000000000003, 373.733333333334, 354.96666666666727, 371.791666666667, 330.03333333333364, 364.70833333333405, 403.58333333333377, 342.3000000000006, 329.166666666667, 358.95833333333377, 469.6666666666676, 375.28333333333416, 332.27500000000043, 385.84166666666704, 396.1333333333337, 373.8333333333337, 359.3416666666674, 400.0750000000006, 350.1166666666671, 383.4583333333338, 340.0166666666668, 301.5416666666672, 396.0083333333336, 419.2333333333336, 382.6333333333338, 387.616666666667, 374.95000000000067, 398.38333333333384, 323.04166666666697, 360.9750000000004, 391.7750000000005, 411.3333333333339, 421.16666666666725, 430.56666666666734, 470.03333333333376, 369.45000000000067, 397.65000000000043, 419.6000000000005, 384.1500000000008, 424.933333333334, 415.42500000000064, 328.4333333333339, 435.55833333333385, 387.10000000000053, 414.16666666666674, 388.4833333333339, 395.36666666666713, 390.60000000000065, 370.21666666666727, 379.0250000000003, 435.8583333333338, 449.5083333333338, 409.47500000000053, 379.5250000000004, 410.02500000000055, 409.8416666666673, 476.7500000000005, 386.6666666666671, 418.16666666666714, 441.03333333333404, 409.99166666666724, 360.0166666666671, 498.10833333333414, 432.9583333333338, 399.96666666666715, 480.34166666666727, 460.4083333333339, 437.4666666666672, 423.8916666666673, 414.9666666666671, 402.7750000000004, 439.5416666666671, 472.1750000000005, 477.37500000000074, 407.8416666666673, 414.5000000000006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2392793501608733, "mean_inference_ms": 2.043409589947313, "mean_action_processing_ms": 0.09012986581780126, "mean_env_wait_ms": 1.5208389172744277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067751407623291016, "StateBufferConnector_ms": 0.003435850143432617, "ViewRequirementAgentConnector_ms": 0.08792257308959961}, "num_episodes": 24, "episode_return_max": 498.10833333333414, "episode_return_min": 262.46666666666715, "episode_return_mean": 383.08566666666707, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58200, "num_agent_steps_trained": 57900, "num_env_steps_sampled": 58200, "num_env_steps_trained": 57900, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 237.09526218577574, "num_env_steps_trained_throughput_per_sec": 237.09526218577574, "timesteps_total": 58200, "num_env_steps_sampled_lifetime": 58200, "num_agent_steps_sampled_lifetime": 58200, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 58200, "timers": {"training_iteration_time_ms": 10284.025, "restore_workers_time_ms": 0.016, "training_step_time_ms": 630.838, "sample_time_ms": 614.878, "synch_weights_time_ms": 14.568}, "counters": {"num_env_steps_sampled": 58200, "num_env_steps_trained": 57900, "num_agent_steps_sampled": 58200, "num_agent_steps_trained": 57900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 388, "num_samples_added_to_queue": 58200}, "done": false, "training_iteration": 23, "trial_id": "27800_00000", "date": "2024-10-12_15-31-47", "timestamp": 1728743507, "time_this_iter_s": 10.132511377334595, "time_total_s": 236.97257661819458, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f05e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 236.97257661819458, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 16.664285714285715, "ram_util_percent": 32.57142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 317966.28125, "policy_loss": 314909.65625, "entropy": 27.327531814575195, "entropy_coeff": 0.01, "var_gnorm": 16.22328758239746, "vf_loss": 313860.34375, "vf_explained_var": 0.0031415820121765137}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 201.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 60600, "num_env_steps_trained": 60300, "num_agent_steps_sampled": 60600, "num_agent_steps_trained": 60300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 404, "num_samples_added_to_queue": 60600, "learner_queue": {"size_count": 201, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.272, "learner_load_time_ms": 0.447, "learner_load_wait_time_ms": 1213.279, "learner_dequeue_time_ms": 10178.964}}, "env_runners": {"episode_reward_max": 508.0250000000006, "episode_reward_min": 301.5416666666672, "episode_reward_mean": 405.5976666666671, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 301.5416666666672}, "policy_reward_max": {"default_policy": 508.0250000000006}, "policy_reward_mean": {"default_policy": 405.5976666666671}, "custom_metrics": {"num_consolidated_mean": 1.1959000000000002, "num_consolidated_min": 0.97, "num_consolidated_max": 1.42, "num_overloaded_mean": 0.23620000000000002, "num_overloaded_min": 0.12, "num_overloaded_max": 0.35, "num_moves_mean": 9.401, "num_moves_min": 9.04, "num_moves_max": 9.76, "mean_accuracy_mean": 41.53199666666667, "mean_accuracy_min": 41.239333333333335, "mean_accuracy_max": 41.80933333333334, "num_model_switches_mean": 5.8092, "num_model_switches_min": 5.35, "num_model_switches_max": 6.26, "num_slav_mean": 0.158117, "num_slav_min": 0.13814999999999997, "num_slav_max": 0.17421666666666666, "cpu_conserved_cost_mean": 2.959200000000001, "cpu_conserved_cost_min": 2.32, "cpu_conserved_cost_max": 3.62, "mean_cluster_cpu_util_mean": 0.48717086997780124, "mean_cluster_cpu_util_min": 0.47375799687085307, "mean_cluster_cpu_util_max": 0.49952122663797355, "mean_cluster_mem_util_mean": 0.32216944967385686, "mean_cluster_mem_util_min": 0.3149589850813744, "mean_cluster_mem_util_max": 0.3301430769037573, "reward_consolidation_mean_mean": 1.987083333333333, "reward_consolidation_mean_min": 1.520833333333333, "reward_consolidation_mean_max": 2.479166666666666, "reward_illegal_mean_mean": -0.3936666666666666, "reward_illegal_mean_min": -0.5833333333333333, "reward_illegal_mean_max": -0.2, "reward_accuracy_mean_mean": 4.294000000000008, "reward_accuracy_mean_min": 3.458333333333337, "reward_accuracy_mean_max": 4.933333333333341, "reward_sla_mean_mean": -1.8314400000000004, "reward_sla_mean_min": -2.12, "reward_sla_mean_max": -1.31125, "reward_consolidation_sum_mean": 198.70833333333326, "reward_consolidation_sum_min": 152.08333333333331, "reward_consolidation_sum_max": 247.9166666666666, "reward_illegal_sum_mean": -39.36666666666665, "reward_illegal_sum_min": -58.33333333333333, "reward_illegal_sum_max": -20.0, "reward_accuracy_sum_mean": 429.4000000000007, "reward_accuracy_sum_min": 345.8333333333337, "reward_accuracy_sum_max": 493.33333333333405, "reward_sla_sum_mean": -183.14399999999998, "reward_sla_sum_min": -212.0, "reward_sla_sum_max": -131.125, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2978.0, "global_timestep_min": 1100, "global_timestep_max": 4600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [370.40000000000003, 373.733333333334, 354.96666666666727, 371.791666666667, 330.03333333333364, 364.70833333333405, 403.58333333333377, 342.3000000000006, 329.166666666667, 358.95833333333377, 469.6666666666676, 375.28333333333416, 332.27500000000043, 385.84166666666704, 396.1333333333337, 373.8333333333337, 359.3416666666674, 400.0750000000006, 350.1166666666671, 383.4583333333338, 340.0166666666668, 301.5416666666672, 396.0083333333336, 419.2333333333336, 382.6333333333338, 387.616666666667, 374.95000000000067, 398.38333333333384, 323.04166666666697, 360.9750000000004, 391.7750000000005, 411.3333333333339, 421.16666666666725, 430.56666666666734, 470.03333333333376, 369.45000000000067, 397.65000000000043, 419.6000000000005, 384.1500000000008, 424.933333333334, 415.42500000000064, 328.4333333333339, 435.55833333333385, 387.10000000000053, 414.16666666666674, 388.4833333333339, 395.36666666666713, 390.60000000000065, 370.21666666666727, 379.0250000000003, 435.8583333333338, 449.5083333333338, 409.47500000000053, 379.5250000000004, 410.02500000000055, 409.8416666666673, 476.7500000000005, 386.6666666666671, 418.16666666666714, 441.03333333333404, 409.99166666666724, 360.0166666666671, 498.10833333333414, 432.9583333333338, 399.96666666666715, 480.34166666666727, 460.4083333333339, 437.4666666666672, 423.8916666666673, 414.9666666666671, 402.7750000000004, 439.5416666666671, 472.1750000000005, 477.37500000000074, 407.8416666666673, 414.5000000000006, 396.52500000000026, 403.458333333334, 423.46666666666744, 421.2750000000006, 478.99166666666736, 433.60833333333414, 437.2750000000006, 444.9833333333341, 402.2333333333336, 438.4166666666677, 417.35833333333386, 415.7250000000007, 471.9333333333338, 391.35000000000076, 357.2500000000005, 508.0250000000006, 436.80833333333385, 412.9750000000006, 381.15000000000083, 455.4000000000006, 412.2416666666672, 500.54166666666714, 396.4666666666672, 438.033333333334], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [370.40000000000003, 373.733333333334, 354.96666666666727, 371.791666666667, 330.03333333333364, 364.70833333333405, 403.58333333333377, 342.3000000000006, 329.166666666667, 358.95833333333377, 469.6666666666676, 375.28333333333416, 332.27500000000043, 385.84166666666704, 396.1333333333337, 373.8333333333337, 359.3416666666674, 400.0750000000006, 350.1166666666671, 383.4583333333338, 340.0166666666668, 301.5416666666672, 396.0083333333336, 419.2333333333336, 382.6333333333338, 387.616666666667, 374.95000000000067, 398.38333333333384, 323.04166666666697, 360.9750000000004, 391.7750000000005, 411.3333333333339, 421.16666666666725, 430.56666666666734, 470.03333333333376, 369.45000000000067, 397.65000000000043, 419.6000000000005, 384.1500000000008, 424.933333333334, 415.42500000000064, 328.4333333333339, 435.55833333333385, 387.10000000000053, 414.16666666666674, 388.4833333333339, 395.36666666666713, 390.60000000000065, 370.21666666666727, 379.0250000000003, 435.8583333333338, 449.5083333333338, 409.47500000000053, 379.5250000000004, 410.02500000000055, 409.8416666666673, 476.7500000000005, 386.6666666666671, 418.16666666666714, 441.03333333333404, 409.99166666666724, 360.0166666666671, 498.10833333333414, 432.9583333333338, 399.96666666666715, 480.34166666666727, 460.4083333333339, 437.4666666666672, 423.8916666666673, 414.9666666666671, 402.7750000000004, 439.5416666666671, 472.1750000000005, 477.37500000000074, 407.8416666666673, 414.5000000000006, 396.52500000000026, 403.458333333334, 423.46666666666744, 421.2750000000006, 478.99166666666736, 433.60833333333414, 437.2750000000006, 444.9833333333341, 402.2333333333336, 438.4166666666677, 417.35833333333386, 415.7250000000007, 471.9333333333338, 391.35000000000076, 357.2500000000005, 508.0250000000006, 436.80833333333385, 412.9750000000006, 381.15000000000083, 455.4000000000006, 412.2416666666672, 500.54166666666714, 396.4666666666672, 438.033333333334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23972346020731933, "mean_inference_ms": 2.0476885831215776, "mean_action_processing_ms": 0.0903285223845807, "mean_env_wait_ms": 1.524520426654346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006864309310913086, "StateBufferConnector_ms": 0.0034415721893310547, "ViewRequirementAgentConnector_ms": 0.08820366859436035}, "num_episodes": 24, "episode_return_max": 508.0250000000006, "episode_return_min": 301.5416666666672, "episode_return_mean": 405.5976666666671, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60600, "num_agent_steps_trained": 60300, "num_env_steps_sampled": 60600, "num_env_steps_trained": 60300, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 233.53670808424204, "num_env_steps_trained_throughput_per_sec": 233.53670808424204, "timesteps_total": 60600, "num_env_steps_sampled_lifetime": 60600, "num_agent_steps_sampled_lifetime": 60600, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 60600, "timers": {"training_iteration_time_ms": 10254.381, "restore_workers_time_ms": 0.014, "training_step_time_ms": 644.864, "sample_time_ms": 628.141, "synch_weights_time_ms": 15.199}, "counters": {"num_env_steps_sampled": 60600, "num_env_steps_trained": 60300, "num_agent_steps_sampled": 60600, "num_agent_steps_trained": 60300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 404, "num_samples_added_to_queue": 60600}, "done": false, "training_iteration": 24, "trial_id": "27800_00000", "date": "2024-10-12_15-31-57", "timestamp": 1728743517, "time_this_iter_s": 10.290052890777588, "time_total_s": 247.26262950897217, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f686a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 247.26262950897217, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 16.533333333333335, "ram_util_percent": 32.72}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 367787.4375, "policy_loss": 363510.09375, "entropy": 27.111555099487305, "entropy_coeff": 0.01, "var_gnorm": 16.22983169555664, "vf_loss": 435870.03125, "vf_explained_var": 0.0068062543869018555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 209.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 63000, "num_env_steps_trained": 62700, "num_agent_steps_sampled": 63000, "num_agent_steps_trained": 62700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 420, "num_samples_added_to_queue": 63000, "learner_queue": {"size_count": 209, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.988, "learner_load_time_ms": 0.495, "learner_load_wait_time_ms": 1215.471, "learner_dequeue_time_ms": 10210.927}}, "env_runners": {"episode_reward_max": 530.5083333333341, "episode_reward_min": 323.04166666666697, "episode_reward_mean": 425.5187500000006, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 323.04166666666697}, "policy_reward_max": {"default_policy": 530.5083333333341}, "policy_reward_mean": {"default_policy": 425.5187500000006}, "custom_metrics": {"num_consolidated_mean": 1.2346, "num_consolidated_min": 1.01, "num_consolidated_max": 1.49, "num_overloaded_mean": 0.22300000000000003, "num_overloaded_min": 0.12, "num_overloaded_max": 0.35, "num_moves_mean": 9.3591, "num_moves_min": 9.04, "num_moves_max": 9.76, "mean_accuracy_mean": 41.560306666666676, "mean_accuracy_min": 41.26466666666667, "mean_accuracy_max": 41.80933333333334, "num_model_switches_mean": 5.774300000000003, "num_model_switches_min": 5.22, "num_model_switches_max": 6.46, "num_slav_mean": 0.15705183333333333, "num_slav_min": 0.13814999999999997, "num_slav_max": 0.17421666666666666, "cpu_conserved_cost_mean": 3.0223999999999993, "cpu_conserved_cost_min": 2.44, "cpu_conserved_cost_max": 3.86, "mean_cluster_cpu_util_mean": 0.4858956195940706, "mean_cluster_cpu_util_min": 0.47375799687085307, "mean_cluster_cpu_util_max": 0.49952122663797355, "mean_cluster_mem_util_mean": 0.3208551156821378, "mean_cluster_mem_util_min": 0.3135972860874307, "mean_cluster_mem_util_max": 0.3301430769037573, "reward_consolidation_mean_mean": 2.0804166666666664, "reward_consolidation_mean_min": 1.6666666666666663, "reward_consolidation_mean_max": 2.4791666666666665, "reward_illegal_mean_mean": -0.37166666666666665, "reward_illegal_mean_min": -0.5833333333333333, "reward_illegal_mean_max": -0.2, "reward_accuracy_mean_mean": 4.391000000000008, "reward_accuracy_mean_min": 3.458333333333337, "reward_accuracy_mean_max": 4.991666666666675, "reward_sla_mean_mean": -1.8445625, "reward_sla_mean_min": -2.1062499999999997, "reward_sla_mean_max": -1.31125, "reward_consolidation_sum_mean": 208.04166666666663, "reward_consolidation_sum_min": 166.66666666666663, "reward_consolidation_sum_max": 247.91666666666666, "reward_illegal_sum_mean": -37.16666666666666, "reward_illegal_sum_min": -58.33333333333333, "reward_illegal_sum_max": -20.0, "reward_accuracy_sum_mean": 439.1000000000007, "reward_accuracy_sum_min": 345.8333333333337, "reward_accuracy_sum_max": 499.16666666666754, "reward_sla_sum_mean": -184.45625000000004, "reward_sla_sum_min": -210.62499999999997, "reward_sla_sum_max": -131.125, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3778.0, "global_timestep_min": 1900, "global_timestep_max": 5400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [382.6333333333338, 387.616666666667, 374.95000000000067, 398.38333333333384, 323.04166666666697, 360.9750000000004, 391.7750000000005, 411.3333333333339, 421.16666666666725, 430.56666666666734, 470.03333333333376, 369.45000000000067, 397.65000000000043, 419.6000000000005, 384.1500000000008, 424.933333333334, 415.42500000000064, 328.4333333333339, 435.55833333333385, 387.10000000000053, 414.16666666666674, 388.4833333333339, 395.36666666666713, 390.60000000000065, 370.21666666666727, 379.0250000000003, 435.8583333333338, 449.5083333333338, 409.47500000000053, 379.5250000000004, 410.02500000000055, 409.8416666666673, 476.7500000000005, 386.6666666666671, 418.16666666666714, 441.03333333333404, 409.99166666666724, 360.0166666666671, 498.10833333333414, 432.9583333333338, 399.96666666666715, 480.34166666666727, 460.4083333333339, 437.4666666666672, 423.8916666666673, 414.9666666666671, 402.7750000000004, 439.5416666666671, 472.1750000000005, 477.37500000000074, 407.8416666666673, 414.5000000000006, 396.52500000000026, 403.458333333334, 423.46666666666744, 421.2750000000006, 478.99166666666736, 433.60833333333414, 437.2750000000006, 444.9833333333341, 402.2333333333336, 438.4166666666677, 417.35833333333386, 415.7250000000007, 471.9333333333338, 391.35000000000076, 357.2500000000005, 508.0250000000006, 436.80833333333385, 412.9750000000006, 381.15000000000083, 455.4000000000006, 412.2416666666672, 500.54166666666714, 396.4666666666672, 438.033333333334, 484.7916666666675, 476.7500000000006, 438.6750000000005, 446.5916666666675, 402.69166666666683, 465.79166666666765, 461.15833333333427, 396.21666666666744, 467.033333333334, 418.50000000000085, 449.7750000000004, 457.4083333333337, 450.29166666666737, 455.5583333333339, 428.93333333333413, 463.34166666666744, 461.1000000000005, 422.3416666666668, 462.24166666666736, 504.7000000000006, 530.5083333333341, 394.5666666666671, 483.14166666666745, 452.46666666666727], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [382.6333333333338, 387.616666666667, 374.95000000000067, 398.38333333333384, 323.04166666666697, 360.9750000000004, 391.7750000000005, 411.3333333333339, 421.16666666666725, 430.56666666666734, 470.03333333333376, 369.45000000000067, 397.65000000000043, 419.6000000000005, 384.1500000000008, 424.933333333334, 415.42500000000064, 328.4333333333339, 435.55833333333385, 387.10000000000053, 414.16666666666674, 388.4833333333339, 395.36666666666713, 390.60000000000065, 370.21666666666727, 379.0250000000003, 435.8583333333338, 449.5083333333338, 409.47500000000053, 379.5250000000004, 410.02500000000055, 409.8416666666673, 476.7500000000005, 386.6666666666671, 418.16666666666714, 441.03333333333404, 409.99166666666724, 360.0166666666671, 498.10833333333414, 432.9583333333338, 399.96666666666715, 480.34166666666727, 460.4083333333339, 437.4666666666672, 423.8916666666673, 414.9666666666671, 402.7750000000004, 439.5416666666671, 472.1750000000005, 477.37500000000074, 407.8416666666673, 414.5000000000006, 396.52500000000026, 403.458333333334, 423.46666666666744, 421.2750000000006, 478.99166666666736, 433.60833333333414, 437.2750000000006, 444.9833333333341, 402.2333333333336, 438.4166666666677, 417.35833333333386, 415.7250000000007, 471.9333333333338, 391.35000000000076, 357.2500000000005, 508.0250000000006, 436.80833333333385, 412.9750000000006, 381.15000000000083, 455.4000000000006, 412.2416666666672, 500.54166666666714, 396.4666666666672, 438.033333333334, 484.7916666666675, 476.7500000000006, 438.6750000000005, 446.5916666666675, 402.69166666666683, 465.79166666666765, 461.15833333333427, 396.21666666666744, 467.033333333334, 418.50000000000085, 449.7750000000004, 457.4083333333337, 450.29166666666737, 455.5583333333339, 428.93333333333413, 463.34166666666744, 461.1000000000005, 422.3416666666668, 462.24166666666736, 504.7000000000006, 530.5083333333341, 394.5666666666671, 483.14166666666745, 452.46666666666727]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24009532494025343, "mean_inference_ms": 2.0512012584208303, "mean_action_processing_ms": 0.09050774858013423, "mean_env_wait_ms": 1.5276701805465922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007128000259399414, "StateBufferConnector_ms": 0.0034246444702148438, "ViewRequirementAgentConnector_ms": 0.0867776870727539}, "num_episodes": 24, "episode_return_max": 530.5083333333341, "episode_return_min": 323.04166666666697, "episode_return_mean": 425.5187500000006, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63000, "num_agent_steps_trained": 62700, "num_env_steps_sampled": 63000, "num_env_steps_trained": 62700, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 237.0082727917808, "num_env_steps_trained_throughput_per_sec": 237.0082727917808, "timesteps_total": 63000, "num_env_steps_sampled_lifetime": 63000, "num_agent_steps_sampled_lifetime": 63000, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 63000, "timers": {"training_iteration_time_ms": 10231.069, "restore_workers_time_ms": 0.015, "training_step_time_ms": 635.159, "sample_time_ms": 618.433, "synch_weights_time_ms": 15.184}, "counters": {"num_env_steps_sampled": 63000, "num_env_steps_trained": 62700, "num_agent_steps_sampled": 63000, "num_agent_steps_trained": 62700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 420, "num_samples_added_to_queue": 63000}, "done": false, "training_iteration": 25, "trial_id": "27800_00000", "date": "2024-10-12_15-32-07", "timestamp": 1728743527, "time_this_iter_s": 10.136835813522339, "time_total_s": 257.3994653224945, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f683d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 257.3994653224945, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 16.66, "ram_util_percent": 32.88666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 401441.6875, "policy_loss": 396505.9375, "entropy": 26.671175003051758, "entropy_coeff": 0.01, "var_gnorm": 16.242259979248047, "vf_loss": 501574.9375, "vf_explained_var": 0.012769758701324463}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 218.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 65550, "num_env_steps_trained": 65400, "num_agent_steps_sampled": 65550, "num_agent_steps_trained": 65400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 437, "num_samples_added_to_queue": 65400, "learner_queue": {"size_count": 218, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.324, "learner_load_time_ms": 0.509, "learner_load_wait_time_ms": 1173.506, "learner_dequeue_time_ms": 10234.465}}, "env_runners": {"episode_reward_max": 563.7750000000009, "episode_reward_min": 357.2500000000005, "episode_reward_mean": 447.6865833333339, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 357.2500000000005}, "policy_reward_max": {"default_policy": 563.7750000000009}, "policy_reward_mean": {"default_policy": 447.6865833333339}, "custom_metrics": {"num_consolidated_mean": 1.2635, "num_consolidated_min": 1.03, "num_consolidated_max": 1.49, "num_overloaded_mean": 0.20470000000000002, "num_overloaded_min": 0.11, "num_overloaded_max": 0.31, "num_moves_mean": 9.3067, "num_moves_min": 8.98, "num_moves_max": 9.7, "mean_accuracy_mean": 41.595266666666674, "mean_accuracy_min": 41.26466666666667, "mean_accuracy_max": 41.82200000000002, "num_model_switches_mean": 5.738200000000001, "num_model_switches_min": 5.22, "num_model_switches_max": 6.46, "num_slav_mean": 0.1561535, "num_slav_min": 0.13278333333333334, "num_slav_max": 0.17421666666666666, "cpu_conserved_cost_mean": 3.054199999999999, "cpu_conserved_cost_min": 2.44, "cpu_conserved_cost_max": 3.86, "mean_cluster_cpu_util_mean": 0.48397870613445804, "mean_cluster_cpu_util_min": 0.4735606850757388, "mean_cluster_cpu_util_max": 0.49823068473993715, "mean_cluster_mem_util_mean": 0.31936983693920606, "mean_cluster_mem_util_min": 0.3135972860874307, "mean_cluster_mem_util_max": 0.3254051065257326, "reward_consolidation_mean_mean": 2.1672916666666664, "reward_consolidation_mean_min": 1.7708333333333328, "reward_consolidation_mean_max": 2.75, "reward_illegal_mean_mean": -0.3411666666666666, "reward_illegal_mean_min": -0.5166666666666665, "reward_illegal_mean_max": -0.18333333333333332, "reward_accuracy_mean_mean": 4.529333333333342, "reward_accuracy_mean_min": 3.7250000000000045, "reward_accuracy_mean_max": 5.200000000000012, "reward_sla_mean_mean": -1.8785925, "reward_sla_mean_min": -2.24, "reward_sla_mean_max": -1.47725, "reward_consolidation_sum_mean": 216.72916666666663, "reward_consolidation_sum_min": 177.0833333333333, "reward_consolidation_sum_max": 275.0, "reward_illegal_sum_mean": -34.11666666666667, "reward_illegal_sum_min": -51.66666666666665, "reward_illegal_sum_max": -18.333333333333332, "reward_accuracy_sum_mean": 452.9333333333341, "reward_accuracy_sum_min": 372.50000000000045, "reward_accuracy_sum_max": 520.0000000000011, "reward_sla_sum_mean": -187.85925000000003, "reward_sla_sum_min": -224.0, "reward_sla_sum_max": -147.725, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4578.0, "global_timestep_min": 2700, "global_timestep_max": 6200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [370.21666666666727, 379.0250000000003, 435.8583333333338, 449.5083333333338, 409.47500000000053, 379.5250000000004, 410.02500000000055, 409.8416666666673, 476.7500000000005, 386.6666666666671, 418.16666666666714, 441.03333333333404, 409.99166666666724, 360.0166666666671, 498.10833333333414, 432.9583333333338, 399.96666666666715, 480.34166666666727, 460.4083333333339, 437.4666666666672, 423.8916666666673, 414.9666666666671, 402.7750000000004, 439.5416666666671, 472.1750000000005, 477.37500000000074, 407.8416666666673, 414.5000000000006, 396.52500000000026, 403.458333333334, 423.46666666666744, 421.2750000000006, 478.99166666666736, 433.60833333333414, 437.2750000000006, 444.9833333333341, 402.2333333333336, 438.4166666666677, 417.35833333333386, 415.7250000000007, 471.9333333333338, 391.35000000000076, 357.2500000000005, 508.0250000000006, 436.80833333333385, 412.9750000000006, 381.15000000000083, 455.4000000000006, 412.2416666666672, 500.54166666666714, 396.4666666666672, 438.033333333334, 484.7916666666675, 476.7500000000006, 438.6750000000005, 446.5916666666675, 402.69166666666683, 465.79166666666765, 461.15833333333427, 396.21666666666744, 467.033333333334, 418.50000000000085, 449.7750000000004, 457.4083333333337, 450.29166666666737, 455.5583333333339, 428.93333333333413, 463.34166666666744, 461.1000000000005, 422.3416666666668, 462.24166666666736, 504.7000000000006, 530.5083333333341, 394.5666666666671, 483.14166666666745, 452.46666666666727, 456.6666666666674, 485.29166666666754, 481.6000000000009, 421.60000000000093, 488.0166666666674, 400.533333333334, 480.97500000000053, 453.4166666666674, 501.49166666666747, 485.358333333334, 468.08333333333405, 514.3916666666673, 514.9750000000007, 550.2666666666672, 472.80833333333396, 534.9166666666677, 482.89166666666745, 515.5833333333342, 426.7166666666671, 563.7750000000009, 457.458333333334, 496.1000000000007, 504.78333333333404, 562.4750000000009], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [370.21666666666727, 379.0250000000003, 435.8583333333338, 449.5083333333338, 409.47500000000053, 379.5250000000004, 410.02500000000055, 409.8416666666673, 476.7500000000005, 386.6666666666671, 418.16666666666714, 441.03333333333404, 409.99166666666724, 360.0166666666671, 498.10833333333414, 432.9583333333338, 399.96666666666715, 480.34166666666727, 460.4083333333339, 437.4666666666672, 423.8916666666673, 414.9666666666671, 402.7750000000004, 439.5416666666671, 472.1750000000005, 477.37500000000074, 407.8416666666673, 414.5000000000006, 396.52500000000026, 403.458333333334, 423.46666666666744, 421.2750000000006, 478.99166666666736, 433.60833333333414, 437.2750000000006, 444.9833333333341, 402.2333333333336, 438.4166666666677, 417.35833333333386, 415.7250000000007, 471.9333333333338, 391.35000000000076, 357.2500000000005, 508.0250000000006, 436.80833333333385, 412.9750000000006, 381.15000000000083, 455.4000000000006, 412.2416666666672, 500.54166666666714, 396.4666666666672, 438.033333333334, 484.7916666666675, 476.7500000000006, 438.6750000000005, 446.5916666666675, 402.69166666666683, 465.79166666666765, 461.15833333333427, 396.21666666666744, 467.033333333334, 418.50000000000085, 449.7750000000004, 457.4083333333337, 450.29166666666737, 455.5583333333339, 428.93333333333413, 463.34166666666744, 461.1000000000005, 422.3416666666668, 462.24166666666736, 504.7000000000006, 530.5083333333341, 394.5666666666671, 483.14166666666745, 452.46666666666727, 456.6666666666674, 485.29166666666754, 481.6000000000009, 421.60000000000093, 488.0166666666674, 400.533333333334, 480.97500000000053, 453.4166666666674, 501.49166666666747, 485.358333333334, 468.08333333333405, 514.3916666666673, 514.9750000000007, 550.2666666666672, 472.80833333333396, 534.9166666666677, 482.89166666666745, 515.5833333333342, 426.7166666666671, 563.7750000000009, 457.458333333334, 496.1000000000007, 504.78333333333404, 562.4750000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.240384542305097, "mean_inference_ms": 2.053458080317776, "mean_action_processing_ms": 0.09062110543807757, "mean_env_wait_ms": 1.5297483514652543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007051944732666016, "StateBufferConnector_ms": 0.0034127235412597656, "ViewRequirementAgentConnector_ms": 0.08691763877868652}, "num_episodes": 24, "episode_return_max": 563.7750000000009, "episode_return_min": 357.2500000000005, "episode_return_mean": 447.6865833333339, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65550, "num_agent_steps_trained": 65400, "num_env_steps_sampled": 65550, "num_env_steps_trained": 65400, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 247.36150660725383, "num_env_steps_trained_throughput_per_sec": 261.912183466504, "timesteps_total": 65550, "num_env_steps_sampled_lifetime": 65550, "num_agent_steps_sampled_lifetime": 65550, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 65550, "timers": {"training_iteration_time_ms": 10231.649, "restore_workers_time_ms": 0.013, "training_step_time_ms": 592.134, "sample_time_ms": 577.265, "synch_weights_time_ms": 13.521}, "counters": {"num_env_steps_sampled": 65550, "num_env_steps_trained": 65400, "num_agent_steps_sampled": 65550, "num_agent_steps_trained": 65400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 437, "num_samples_added_to_queue": 65400}, "done": false, "training_iteration": 26, "trial_id": "27800_00000", "date": "2024-10-12_15-32-17", "timestamp": 1728743537, "time_this_iter_s": 10.319764852523804, "time_total_s": 267.7192301750183, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d26e60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 267.7192301750183, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 16.235714285714288, "ram_util_percent": 33.050000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 417885.09375, "policy_loss": 412454.875, "entropy": 26.42121696472168, "entropy_coeff": 0.01, "var_gnorm": 16.248762130737305, "vf_loss": 550945.875, "vf_explained_var": 0.016144990921020508}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 226.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 68100, "num_env_steps_trained": 67800, "num_agent_steps_sampled": 68100, "num_agent_steps_trained": 67800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 454, "num_samples_added_to_queue": 68100, "learner_queue": {"size_count": 226, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.28, "learner_load_time_ms": 0.472, "learner_load_wait_time_ms": 1143.695, "learner_dequeue_time_ms": 10170.328}}, "env_runners": {"episode_reward_max": 563.7750000000009, "episode_reward_min": 357.2500000000005, "episode_reward_mean": 472.9585000000007, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 357.2500000000005}, "policy_reward_max": {"default_policy": 563.7750000000009}, "policy_reward_mean": {"default_policy": 472.9585000000007}, "custom_metrics": {"num_consolidated_mean": 1.2989000000000002, "num_consolidated_min": 1.09, "num_consolidated_max": 1.49, "num_overloaded_mean": 0.1873, "num_overloaded_min": 0.1, "num_overloaded_max": 0.3, "num_moves_mean": 9.228, "num_moves_min": 8.82, "num_moves_max": 9.65, "mean_accuracy_mean": 41.63903000000001, "mean_accuracy_min": 41.391333333333336, "mean_accuracy_max": 41.82833333333334, "num_model_switches_mean": 5.6686000000000005, "num_model_switches_min": 5.14, "num_model_switches_max": 6.46, "num_slav_mean": 0.15470883333333332, "num_slav_min": 0.13075, "num_slav_max": 0.17421666666666666, "cpu_conserved_cost_mean": 3.1064000000000003, "cpu_conserved_cost_min": 2.48, "cpu_conserved_cost_max": 3.86, "mean_cluster_cpu_util_mean": 0.4823079841794283, "mean_cluster_cpu_util_min": 0.4713713970721674, "mean_cluster_cpu_util_max": 0.49823068473993715, "mean_cluster_mem_util_mean": 0.3179695284307816, "mean_cluster_mem_util_min": 0.30948977726111543, "mean_cluster_mem_util_max": 0.3247810171431441, "reward_consolidation_mean_mean": 2.268958333333333, "reward_consolidation_mean_min": 1.8124999999999998, "reward_consolidation_mean_max": 2.8333333333333326, "reward_illegal_mean_mean": -0.3121666666666666, "reward_illegal_mean_min": -0.49999999999999994, "reward_illegal_mean_max": -0.16666666666666663, "reward_accuracy_mean_mean": 4.668333333333341, "reward_accuracy_mean_min": 3.8583333333333396, "reward_accuracy_mean_max": 5.291666666666678, "reward_sla_mean_mean": -1.8955399999999998, "reward_sla_mean_min": -2.24, "reward_sla_mean_max": -1.47725, "reward_consolidation_sum_mean": 226.8958333333333, "reward_consolidation_sum_min": 181.24999999999997, "reward_consolidation_sum_max": 283.33333333333326, "reward_illegal_sum_mean": -31.21666666666666, "reward_illegal_sum_min": -49.99999999999999, "reward_illegal_sum_max": -16.666666666666664, "reward_accuracy_sum_mean": 466.83333333333417, "reward_accuracy_sum_min": 385.83333333333394, "reward_accuracy_sum_max": 529.1666666666678, "reward_sla_sum_mean": -189.554, "reward_sla_sum_min": -224.0, "reward_sla_sum_max": -147.725, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5483.0, "global_timestep_min": 3800, "global_timestep_max": 7100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [414.5000000000006, 396.52500000000026, 403.458333333334, 423.46666666666744, 421.2750000000006, 478.99166666666736, 433.60833333333414, 437.2750000000006, 444.9833333333341, 402.2333333333336, 438.4166666666677, 417.35833333333386, 415.7250000000007, 471.9333333333338, 391.35000000000076, 357.2500000000005, 508.0250000000006, 436.80833333333385, 412.9750000000006, 381.15000000000083, 455.4000000000006, 412.2416666666672, 500.54166666666714, 396.4666666666672, 438.033333333334, 484.7916666666675, 476.7500000000006, 438.6750000000005, 446.5916666666675, 402.69166666666683, 465.79166666666765, 461.15833333333427, 396.21666666666744, 467.033333333334, 418.50000000000085, 449.7750000000004, 457.4083333333337, 450.29166666666737, 455.5583333333339, 428.93333333333413, 463.34166666666744, 461.1000000000005, 422.3416666666668, 462.24166666666736, 504.7000000000006, 530.5083333333341, 394.5666666666671, 483.14166666666745, 452.46666666666727, 456.6666666666674, 485.29166666666754, 481.6000000000009, 421.60000000000093, 488.0166666666674, 400.533333333334, 480.97500000000053, 453.4166666666674, 501.49166666666747, 485.358333333334, 468.08333333333405, 514.3916666666673, 514.9750000000007, 550.2666666666672, 472.80833333333396, 534.9166666666677, 482.89166666666745, 515.5833333333342, 426.7166666666671, 563.7750000000009, 457.458333333334, 496.1000000000007, 504.78333333333404, 562.4750000000009, 487.55000000000075, 475.8083333333338, 555.5166666666674, 523.8916666666674, 498.9666666666673, 545.8666666666675, 489.86666666666724, 474.4583333333338, 512.1000000000007, 470.04166666666725, 544.2500000000006, 530.2500000000008, 513.6666666666674, 531.1833333333344, 538.4583333333339, 552.4416666666677, 541.1250000000006, 505.7416666666673, 511.12500000000074, 557.5333333333346, 516.9083333333343, 501.3583333333339, 547.5833333333343, 523.6083333333343, 491.7500000000007, 533.8416666666675, 536.2166666666674], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [414.5000000000006, 396.52500000000026, 403.458333333334, 423.46666666666744, 421.2750000000006, 478.99166666666736, 433.60833333333414, 437.2750000000006, 444.9833333333341, 402.2333333333336, 438.4166666666677, 417.35833333333386, 415.7250000000007, 471.9333333333338, 391.35000000000076, 357.2500000000005, 508.0250000000006, 436.80833333333385, 412.9750000000006, 381.15000000000083, 455.4000000000006, 412.2416666666672, 500.54166666666714, 396.4666666666672, 438.033333333334, 484.7916666666675, 476.7500000000006, 438.6750000000005, 446.5916666666675, 402.69166666666683, 465.79166666666765, 461.15833333333427, 396.21666666666744, 467.033333333334, 418.50000000000085, 449.7750000000004, 457.4083333333337, 450.29166666666737, 455.5583333333339, 428.93333333333413, 463.34166666666744, 461.1000000000005, 422.3416666666668, 462.24166666666736, 504.7000000000006, 530.5083333333341, 394.5666666666671, 483.14166666666745, 452.46666666666727, 456.6666666666674, 485.29166666666754, 481.6000000000009, 421.60000000000093, 488.0166666666674, 400.533333333334, 480.97500000000053, 453.4166666666674, 501.49166666666747, 485.358333333334, 468.08333333333405, 514.3916666666673, 514.9750000000007, 550.2666666666672, 472.80833333333396, 534.9166666666677, 482.89166666666745, 515.5833333333342, 426.7166666666671, 563.7750000000009, 457.458333333334, 496.1000000000007, 504.78333333333404, 562.4750000000009, 487.55000000000075, 475.8083333333338, 555.5166666666674, 523.8916666666674, 498.9666666666673, 545.8666666666675, 489.86666666666724, 474.4583333333338, 512.1000000000007, 470.04166666666725, 544.2500000000006, 530.2500000000008, 513.6666666666674, 531.1833333333344, 538.4583333333339, 552.4416666666677, 541.1250000000006, 505.7416666666673, 511.12500000000074, 557.5333333333346, 516.9083333333343, 501.3583333333339, 547.5833333333343, 523.6083333333343, 491.7500000000007, 533.8416666666675, 536.2166666666674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24061030503960124, "mean_inference_ms": 2.0565622198993307, "mean_action_processing_ms": 0.09071519718902916, "mean_env_wait_ms": 1.531551282757056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006951808929443359, "StateBufferConnector_ms": 0.003369569778442383, "ViewRequirementAgentConnector_ms": 0.08602523803710938}, "num_episodes": 27, "episode_return_max": 563.7750000000009, "episode_return_min": 357.2500000000005, "episode_return_mean": 472.9585000000007, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68100, "num_agent_steps_trained": 67800, "num_env_steps_sampled": 68100, "num_env_steps_trained": 67800, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 248.84161638191523, "num_env_steps_trained_throughput_per_sec": 234.20387424180257, "timesteps_total": 68100, "num_env_steps_sampled_lifetime": 68100, "num_agent_steps_sampled_lifetime": 68100, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 68100, "timers": {"training_iteration_time_ms": 10233.55, "restore_workers_time_ms": 0.014, "training_step_time_ms": 605.919, "sample_time_ms": 590.504, "synch_weights_time_ms": 14.0}, "counters": {"num_env_steps_sampled": 68100, "num_env_steps_trained": 67800, "num_agent_steps_sampled": 68100, "num_agent_steps_trained": 67800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 454, "num_samples_added_to_queue": 68100}, "done": false, "training_iteration": 27, "trial_id": "27800_00000", "date": "2024-10-12_15-32-28", "timestamp": 1728743548, "time_this_iter_s": 10.25905990600586, "time_total_s": 277.97829008102417, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a945ee2830>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 277.97829008102417, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 16.380000000000003, "ram_util_percent": 33.15333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 428793.15625, "policy_loss": 422250.28125, "entropy": 26.162769317626953, "entropy_coeff": 0.01, "var_gnorm": 16.251855850219727, "vf_loss": 662136.375, "vf_explained_var": 0.016260862350463867}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 235.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 70650, "num_env_steps_trained": 70500, "num_agent_steps_sampled": 70650, "num_agent_steps_trained": 70500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 471, "num_samples_added_to_queue": 70500, "learner_queue": {"size_count": 235, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.913, "learner_load_time_ms": 0.442, "learner_load_wait_time_ms": 1134.586, "learner_dequeue_time_ms": 10117.982}}, "env_runners": {"episode_reward_max": 579.9833333333343, "episode_reward_min": 394.5666666666671, "episode_reward_mean": 495.74166666666747, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 394.5666666666671}, "policy_reward_max": {"default_policy": 579.9833333333343}, "policy_reward_mean": {"default_policy": 495.74166666666747}, "custom_metrics": {"num_consolidated_mean": 1.3373999999999997, "num_consolidated_min": 1.1, "num_consolidated_max": 1.52, "num_overloaded_mean": 0.17220000000000005, "num_overloaded_min": 0.08, "num_overloaded_max": 0.3, "num_moves_mean": 9.163, "num_moves_min": 8.68, "num_moves_max": 9.65, "mean_accuracy_mean": 41.664743333333334, "mean_accuracy_min": 41.391333333333336, "mean_accuracy_max": 41.94866666666667, "num_model_switches_mean": 5.6415, "num_model_switches_min": 5.14, "num_model_switches_max": 6.46, "num_slav_mean": 0.15297833333333333, "num_slav_min": 0.13075, "num_slav_max": 0.1726333333333333, "cpu_conserved_cost_mean": 3.1744, "cpu_conserved_cost_min": 2.48, "cpu_conserved_cost_max": 3.86, "mean_cluster_cpu_util_mean": 0.4808460723353846, "mean_cluster_cpu_util_min": 0.469812013796206, "mean_cluster_cpu_util_max": 0.49823068473993715, "mean_cluster_mem_util_mean": 0.3168088209603461, "mean_cluster_mem_util_min": 0.30948977726111543, "mean_cluster_mem_util_max": 0.3247810171431441, "reward_consolidation_mean_mean": 2.371458333333333, "reward_consolidation_mean_min": 1.8749999999999993, "reward_consolidation_mean_max": 2.8333333333333326, "reward_illegal_mean_mean": -0.28700000000000003, "reward_illegal_mean_min": -0.49999999999999994, "reward_illegal_mean_max": -0.13333333333333333, "reward_accuracy_mean_mean": 4.785333333333342, "reward_accuracy_mean_min": 3.8583333333333396, "reward_accuracy_mean_max": 5.575000000000012, "reward_sla_mean_mean": -1.912375, "reward_sla_mean_min": -2.29075, "reward_sla_mean_max": -1.47725, "reward_consolidation_sum_mean": 237.1458333333333, "reward_consolidation_sum_min": 187.49999999999994, "reward_consolidation_sum_max": 283.33333333333326, "reward_illegal_sum_mean": -28.700000000000003, "reward_illegal_sum_min": -49.99999999999999, "reward_illegal_sum_max": -13.333333333333332, "reward_accuracy_sum_mean": 478.53333333333416, "reward_accuracy_sum_min": 385.83333333333394, "reward_accuracy_sum_max": 557.5000000000011, "reward_sla_sum_mean": -191.2375, "reward_sla_sum_min": -229.07500000000002, "reward_sla_sum_max": -147.725, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6049.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [438.033333333334, 484.7916666666675, 476.7500000000006, 438.6750000000005, 446.5916666666675, 402.69166666666683, 465.79166666666765, 461.15833333333427, 396.21666666666744, 467.033333333334, 418.50000000000085, 449.7750000000004, 457.4083333333337, 450.29166666666737, 455.5583333333339, 428.93333333333413, 463.34166666666744, 461.1000000000005, 422.3416666666668, 462.24166666666736, 504.7000000000006, 530.5083333333341, 394.5666666666671, 483.14166666666745, 452.46666666666727, 456.6666666666674, 485.29166666666754, 481.6000000000009, 421.60000000000093, 488.0166666666674, 400.533333333334, 480.97500000000053, 453.4166666666674, 501.49166666666747, 485.358333333334, 468.08333333333405, 514.3916666666673, 514.9750000000007, 550.2666666666672, 472.80833333333396, 534.9166666666677, 482.89166666666745, 515.5833333333342, 426.7166666666671, 563.7750000000009, 457.458333333334, 496.1000000000007, 504.78333333333404, 562.4750000000009, 487.55000000000075, 475.8083333333338, 555.5166666666674, 523.8916666666674, 498.9666666666673, 545.8666666666675, 489.86666666666724, 474.4583333333338, 512.1000000000007, 470.04166666666725, 544.2500000000006, 530.2500000000008, 513.6666666666674, 531.1833333333344, 538.4583333333339, 552.4416666666677, 541.1250000000006, 505.7416666666673, 511.12500000000074, 557.5333333333346, 516.9083333333343, 501.3583333333339, 547.5833333333343, 523.6083333333343, 491.7500000000007, 533.8416666666675, 536.2166666666674, 510.7666666666674, 543.8666666666674, 561.900000000001, 579.9833333333343, 542.7250000000008, 397.4666666666671, 478.2833333333343, 573.4000000000013, 557.2000000000013, 503.983333333334, 537.700000000001, 446.60000000000065, 494.85000000000065, 577.591666666668, 561.7500000000007, 542.1166666666677, 511.9083333333344, 541.4583333333342, 440.8166666666675, 487.7166666666677, 545.7500000000011, 534.8750000000007, 512.8750000000008, 544.6916666666676], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [438.033333333334, 484.7916666666675, 476.7500000000006, 438.6750000000005, 446.5916666666675, 402.69166666666683, 465.79166666666765, 461.15833333333427, 396.21666666666744, 467.033333333334, 418.50000000000085, 449.7750000000004, 457.4083333333337, 450.29166666666737, 455.5583333333339, 428.93333333333413, 463.34166666666744, 461.1000000000005, 422.3416666666668, 462.24166666666736, 504.7000000000006, 530.5083333333341, 394.5666666666671, 483.14166666666745, 452.46666666666727, 456.6666666666674, 485.29166666666754, 481.6000000000009, 421.60000000000093, 488.0166666666674, 400.533333333334, 480.97500000000053, 453.4166666666674, 501.49166666666747, 485.358333333334, 468.08333333333405, 514.3916666666673, 514.9750000000007, 550.2666666666672, 472.80833333333396, 534.9166666666677, 482.89166666666745, 515.5833333333342, 426.7166666666671, 563.7750000000009, 457.458333333334, 496.1000000000007, 504.78333333333404, 562.4750000000009, 487.55000000000075, 475.8083333333338, 555.5166666666674, 523.8916666666674, 498.9666666666673, 545.8666666666675, 489.86666666666724, 474.4583333333338, 512.1000000000007, 470.04166666666725, 544.2500000000006, 530.2500000000008, 513.6666666666674, 531.1833333333344, 538.4583333333339, 552.4416666666677, 541.1250000000006, 505.7416666666673, 511.12500000000074, 557.5333333333346, 516.9083333333343, 501.3583333333339, 547.5833333333343, 523.6083333333343, 491.7500000000007, 533.8416666666675, 536.2166666666674, 510.7666666666674, 543.8666666666674, 561.900000000001, 579.9833333333343, 542.7250000000008, 397.4666666666671, 478.2833333333343, 573.4000000000013, 557.2000000000013, 503.983333333334, 537.700000000001, 446.60000000000065, 494.85000000000065, 577.591666666668, 561.7500000000007, 542.1166666666677, 511.9083333333344, 541.4583333333342, 440.8166666666675, 487.7166666666677, 545.7500000000011, 534.8750000000007, 512.8750000000008, 544.6916666666676]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24067122844784028, "mean_inference_ms": 2.056150940887539, "mean_action_processing_ms": 0.09072344156104262, "mean_env_wait_ms": 1.531665628471856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006796836853027344, "StateBufferConnector_ms": 0.0033299922943115234, "ViewRequirementAgentConnector_ms": 0.08469700813293457}, "num_episodes": 24, "episode_return_max": 579.9833333333343, "episode_return_min": 394.5666666666671, "episode_return_mean": 495.74166666666747, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70650, "num_agent_steps_trained": 70500, "num_env_steps_sampled": 70650, "num_env_steps_trained": 70500, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 249.33874433038912, "num_env_steps_trained_throughput_per_sec": 264.00572929100025, "timesteps_total": 70650, "num_env_steps_sampled_lifetime": 70650, "num_agent_steps_sampled_lifetime": 70650, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 70650, "timers": {"training_iteration_time_ms": 10241.848, "restore_workers_time_ms": 0.015, "training_step_time_ms": 594.875, "sample_time_ms": 579.316, "synch_weights_time_ms": 14.088}, "counters": {"num_env_steps_sampled": 70650, "num_env_steps_trained": 70500, "num_agent_steps_sampled": 70650, "num_agent_steps_trained": 70500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 471, "num_samples_added_to_queue": 70500}, "done": false, "training_iteration": 28, "trial_id": "27800_00000", "date": "2024-10-12_15-32-38", "timestamp": 1728743558, "time_this_iter_s": 10.238420963287354, "time_total_s": 288.2167110443115, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a945ee3580>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 288.2167110443115, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 16.35333333333333, "ram_util_percent": 33.41333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 439470.625, "policy_loss": 432914.0, "entropy": 26.01032066345215, "entropy_coeff": 0.01, "var_gnorm": 16.254270553588867, "vf_loss": 663466.1875, "vf_explained_var": 0.02297961711883545}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 243.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 73200, "num_env_steps_trained": 72900, "num_agent_steps_sampled": 73200, "num_agent_steps_trained": 72900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 488, "num_samples_added_to_queue": 73200, "learner_queue": {"size_count": 243, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.96, "learner_load_time_ms": 0.435, "learner_load_wait_time_ms": 1143.086, "learner_dequeue_time_ms": 10069.551}}, "env_runners": {"episode_reward_max": 610.5000000000011, "episode_reward_min": 397.4666666666671, "episode_reward_mean": 522.8102500000009, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 397.4666666666671}, "policy_reward_max": {"default_policy": 610.5000000000011}, "policy_reward_mean": {"default_policy": 522.8102500000009}, "custom_metrics": {"num_consolidated_mean": 1.3832000000000002, "num_consolidated_min": 1.1, "num_consolidated_max": 1.57, "num_overloaded_mean": 0.15380000000000002, "num_overloaded_min": 0.08, "num_overloaded_max": 0.25, "num_moves_mean": 9.064200000000001, "num_moves_min": 8.61, "num_moves_max": 9.49, "mean_accuracy_mean": 41.69983, "mean_accuracy_min": 41.467333333333336, "mean_accuracy_max": 41.94866666666667, "num_model_switches_mean": 5.574400000000001, "num_model_switches_min": 5.05, "num_model_switches_max": 5.99, "num_slav_mean": 0.15100216666666666, "num_slav_min": 0.13075, "num_slav_max": 0.16523333333333326, "cpu_conserved_cost_mean": 3.2673999999999994, "cpu_conserved_cost_min": 2.48, "cpu_conserved_cost_max": 3.9, "mean_cluster_cpu_util_mean": 0.4795791415554056, "mean_cluster_cpu_util_min": 0.46729744756553365, "mean_cluster_cpu_util_max": 0.4923409081837468, "mean_cluster_mem_util_mean": 0.3156798684861075, "mean_cluster_mem_util_min": 0.30948977726111543, "mean_cluster_mem_util_max": 0.3247810171431441, "reward_consolidation_mean_mean": 2.490833333333333, "reward_consolidation_mean_min": 1.8749999999999993, "reward_consolidation_mean_max": 2.958333333333333, "reward_illegal_mean_mean": -0.2563333333333333, "reward_illegal_mean_min": -0.4166666666666666, "reward_illegal_mean_max": -0.13333333333333333, "reward_accuracy_mean_mean": 4.922250000000011, "reward_accuracy_mean_min": 4.183333333333341, "reward_accuracy_mean_max": 5.575000000000012, "reward_sla_mean_mean": -1.9286474999999996, "reward_sla_mean_min": -2.29075, "reward_sla_mean_max": -1.51275, "reward_consolidation_sum_mean": 249.08333333333326, "reward_consolidation_sum_min": 187.49999999999994, "reward_consolidation_sum_max": 295.8333333333333, "reward_illegal_sum_mean": -25.633333333333326, "reward_illegal_sum_min": -41.66666666666666, "reward_illegal_sum_max": -13.333333333333332, "reward_accuracy_sum_mean": 492.22500000000093, "reward_accuracy_sum_min": 418.3333333333341, "reward_accuracy_sum_max": 557.5000000000011, "reward_sla_sum_mean": -192.86474999999996, "reward_sla_sum_min": -229.07500000000002, "reward_sla_sum_max": -151.275, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4842.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [481.6000000000009, 421.60000000000093, 488.0166666666674, 400.533333333334, 480.97500000000053, 453.4166666666674, 501.49166666666747, 485.358333333334, 468.08333333333405, 514.3916666666673, 514.9750000000007, 550.2666666666672, 472.80833333333396, 534.9166666666677, 482.89166666666745, 515.5833333333342, 426.7166666666671, 563.7750000000009, 457.458333333334, 496.1000000000007, 504.78333333333404, 562.4750000000009, 487.55000000000075, 475.8083333333338, 555.5166666666674, 523.8916666666674, 498.9666666666673, 545.8666666666675, 489.86666666666724, 474.4583333333338, 512.1000000000007, 470.04166666666725, 544.2500000000006, 530.2500000000008, 513.6666666666674, 531.1833333333344, 538.4583333333339, 552.4416666666677, 541.1250000000006, 505.7416666666673, 511.12500000000074, 557.5333333333346, 516.9083333333343, 501.3583333333339, 547.5833333333343, 523.6083333333343, 491.7500000000007, 533.8416666666675, 536.2166666666674, 510.7666666666674, 543.8666666666674, 561.900000000001, 579.9833333333343, 542.7250000000008, 397.4666666666671, 478.2833333333343, 573.4000000000013, 557.2000000000013, 503.983333333334, 537.700000000001, 446.60000000000065, 494.85000000000065, 577.591666666668, 561.7500000000007, 542.1166666666677, 511.9083333333344, 541.4583333333342, 440.8166666666675, 487.7166666666677, 545.7500000000011, 534.8750000000007, 512.8750000000008, 544.6916666666676, 540.250000000001, 500.52500000000094, 541.7750000000008, 517.7416666666675, 515.6916666666674, 566.1916666666679, 595.8083333333344, 577.3666666666678, 523.2583333333343, 588.2916666666677, 563.0833333333342, 560.5583333333344, 535.4666666666675, 534.1083333333341, 610.5000000000011, 540.3583333333339, 563.9250000000011, 573.7750000000004, 515.1583333333338, 601.7583333333343, 594.6750000000011, 563.6833333333338, 508.72500000000036, 556.6083333333344, 556.2333333333343, 582.9916666666678, 532.9166666666675], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [481.6000000000009, 421.60000000000093, 488.0166666666674, 400.533333333334, 480.97500000000053, 453.4166666666674, 501.49166666666747, 485.358333333334, 468.08333333333405, 514.3916666666673, 514.9750000000007, 550.2666666666672, 472.80833333333396, 534.9166666666677, 482.89166666666745, 515.5833333333342, 426.7166666666671, 563.7750000000009, 457.458333333334, 496.1000000000007, 504.78333333333404, 562.4750000000009, 487.55000000000075, 475.8083333333338, 555.5166666666674, 523.8916666666674, 498.9666666666673, 545.8666666666675, 489.86666666666724, 474.4583333333338, 512.1000000000007, 470.04166666666725, 544.2500000000006, 530.2500000000008, 513.6666666666674, 531.1833333333344, 538.4583333333339, 552.4416666666677, 541.1250000000006, 505.7416666666673, 511.12500000000074, 557.5333333333346, 516.9083333333343, 501.3583333333339, 547.5833333333343, 523.6083333333343, 491.7500000000007, 533.8416666666675, 536.2166666666674, 510.7666666666674, 543.8666666666674, 561.900000000001, 579.9833333333343, 542.7250000000008, 397.4666666666671, 478.2833333333343, 573.4000000000013, 557.2000000000013, 503.983333333334, 537.700000000001, 446.60000000000065, 494.85000000000065, 577.591666666668, 561.7500000000007, 542.1166666666677, 511.9083333333344, 541.4583333333342, 440.8166666666675, 487.7166666666677, 545.7500000000011, 534.8750000000007, 512.8750000000008, 544.6916666666676, 540.250000000001, 500.52500000000094, 541.7750000000008, 517.7416666666675, 515.6916666666674, 566.1916666666679, 595.8083333333344, 577.3666666666678, 523.2583333333343, 588.2916666666677, 563.0833333333342, 560.5583333333344, 535.4666666666675, 534.1083333333341, 610.5000000000011, 540.3583333333339, 563.9250000000011, 573.7750000000004, 515.1583333333338, 601.7583333333343, 594.6750000000011, 563.6833333333338, 508.72500000000036, 556.6083333333344, 556.2333333333343, 582.9916666666678, 532.9166666666675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2406228538630824, "mean_inference_ms": 2.053080626925469, "mean_action_processing_ms": 0.09065539304074686, "mean_env_wait_ms": 1.5306586894638474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006340503692626953, "StateBufferConnector_ms": 0.0032672882080078125, "ViewRequirementAgentConnector_ms": 0.08410167694091797}, "num_episodes": 27, "episode_return_max": 610.5000000000011, "episode_return_min": 397.4666666666671, "episode_return_mean": 522.8102500000009, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73200, "num_agent_steps_trained": 72900, "num_env_steps_sampled": 73200, "num_env_steps_trained": 72900, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 249.2746929815709, "num_env_steps_trained_throughput_per_sec": 234.61147574736086, "timesteps_total": 73200, "num_env_steps_sampled_lifetime": 73200, "num_agent_steps_sampled_lifetime": 73200, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 73200, "timers": {"training_iteration_time_ms": 10244.369, "restore_workers_time_ms": 0.013, "training_step_time_ms": 591.028, "sample_time_ms": 575.725, "synch_weights_time_ms": 13.722}, "counters": {"num_env_steps_sampled": 73200, "num_env_steps_trained": 72900, "num_agent_steps_sampled": 73200, "num_agent_steps_trained": 72900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 488, "num_samples_added_to_queue": 73200}, "done": false, "training_iteration": 29, "trial_id": "27800_00000", "date": "2024-10-12_15-32-48", "timestamp": 1728743568, "time_this_iter_s": 10.242562055587769, "time_total_s": 298.4592730998993, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a945ee0ca0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 298.4592730998993, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 16.428571428571434, "ram_util_percent": 33.61428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 476758.40625, "policy_loss": 468784.96875, "entropy": 25.95296859741211, "entropy_coeff": 0.01, "var_gnorm": 16.25926399230957, "vf_loss": 805126.75, "vf_explained_var": 0.023895621299743652}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 252.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 75750, "num_env_steps_trained": 75600, "num_agent_steps_sampled": 75750, "num_agent_steps_trained": 75600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 505, "num_samples_added_to_queue": 75600, "learner_queue": {"size_count": 252, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.648, "learner_load_time_ms": 0.423, "learner_load_wait_time_ms": 1159.714, "learner_dequeue_time_ms": 9985.03}}, "env_runners": {"episode_reward_max": 644.7416666666679, "episode_reward_min": 397.4666666666671, "episode_reward_mean": 543.0479166666676, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 397.4666666666671}, "policy_reward_max": {"default_policy": 644.7416666666679}, "policy_reward_mean": {"default_policy": 543.0479166666676}, "custom_metrics": {"num_consolidated_mean": 1.4267, "num_consolidated_min": 1.24, "num_consolidated_max": 1.71, "num_overloaded_mean": 0.1421, "num_overloaded_min": 0.05, "num_overloaded_max": 0.25, "num_moves_mean": 8.9857, "num_moves_min": 8.6, "num_moves_max": 9.37, "mean_accuracy_mean": 41.72966000000001, "mean_accuracy_min": 41.47366666666667, "mean_accuracy_max": 41.94866666666667, "num_model_switches_mean": 5.529299999999999, "num_model_switches_min": 5.05, "num_model_switches_max": 5.89, "num_slav_mean": 0.15044133333333332, "num_slav_min": 0.12823333333333337, "num_slav_max": 0.1673666666666667, "cpu_conserved_cost_mean": 3.3594, "cpu_conserved_cost_min": 2.84, "cpu_conserved_cost_max": 3.94, "mean_cluster_cpu_util_mean": 0.4785636872759238, "mean_cluster_cpu_util_min": 0.46567289447637333, "mean_cluster_cpu_util_max": 0.4923409081837468, "mean_cluster_mem_util_mean": 0.31489624437232705, "mean_cluster_mem_util_min": 0.30780635064152245, "mean_cluster_mem_util_max": 0.3247810171431441, "reward_consolidation_mean_mean": 2.596666666666666, "reward_consolidation_mean_min": 1.8749999999999993, "reward_consolidation_mean_max": 3.229166666666666, "reward_illegal_mean_mean": -0.2368333333333333, "reward_illegal_mean_min": -0.4166666666666666, "reward_illegal_mean_max": -0.08333333333333331, "reward_accuracy_mean_mean": 5.011833333333343, "reward_accuracy_mean_min": 4.183333333333341, "reward_accuracy_mean_max": 5.625000000000013, "reward_sla_mean_mean": -1.9411875, "reward_sla_mean_min": -2.29075, "reward_sla_mean_max": -1.5964999999999998, "reward_consolidation_sum_mean": 259.66666666666663, "reward_consolidation_sum_min": 187.49999999999994, "reward_consolidation_sum_max": 322.91666666666663, "reward_illegal_sum_mean": -23.68333333333333, "reward_illegal_sum_min": -41.66666666666666, "reward_illegal_sum_max": -8.333333333333332, "reward_accuracy_sum_mean": 501.1833333333343, "reward_accuracy_sum_min": 418.3333333333341, "reward_accuracy_sum_max": 562.5000000000014, "reward_sla_sum_mean": -194.11875, "reward_sla_sum_min": -229.07500000000002, "reward_sla_sum_max": -159.64999999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3770.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [555.5166666666674, 523.8916666666674, 498.9666666666673, 545.8666666666675, 489.86666666666724, 474.4583333333338, 512.1000000000007, 470.04166666666725, 544.2500000000006, 530.2500000000008, 513.6666666666674, 531.1833333333344, 538.4583333333339, 552.4416666666677, 541.1250000000006, 505.7416666666673, 511.12500000000074, 557.5333333333346, 516.9083333333343, 501.3583333333339, 547.5833333333343, 523.6083333333343, 491.7500000000007, 533.8416666666675, 536.2166666666674, 510.7666666666674, 543.8666666666674, 561.900000000001, 579.9833333333343, 542.7250000000008, 397.4666666666671, 478.2833333333343, 573.4000000000013, 557.2000000000013, 503.983333333334, 537.700000000001, 446.60000000000065, 494.85000000000065, 577.591666666668, 561.7500000000007, 542.1166666666677, 511.9083333333344, 541.4583333333342, 440.8166666666675, 487.7166666666677, 545.7500000000011, 534.8750000000007, 512.8750000000008, 544.6916666666676, 540.250000000001, 500.52500000000094, 541.7750000000008, 517.7416666666675, 515.6916666666674, 566.1916666666679, 595.8083333333344, 577.3666666666678, 523.2583333333343, 588.2916666666677, 563.0833333333342, 560.5583333333344, 535.4666666666675, 534.1083333333341, 610.5000000000011, 540.3583333333339, 563.9250000000011, 573.7750000000004, 515.1583333333338, 601.7583333333343, 594.6750000000011, 563.6833333333338, 508.72500000000036, 556.6083333333344, 556.2333333333343, 582.9916666666678, 532.9166666666675, 567.5666666666676, 611.4000000000012, 519.9166666666674, 569.8416666666676, 539.4916666666678, 567.6166666666676, 588.9416666666677, 644.7416666666679, 539.7333333333341, 531.2166666666674, 562.5583333333341, 582.0000000000007, 595.1166666666674, 515.3083333333342, 590.9083333333344, 617.3000000000011, 516.9000000000009, 635.525000000001, 583.9250000000006, 545.6000000000007, 546.9083333333341, 594.7083333333344, 586.7500000000013, 611.3666666666679], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [555.5166666666674, 523.8916666666674, 498.9666666666673, 545.8666666666675, 489.86666666666724, 474.4583333333338, 512.1000000000007, 470.04166666666725, 544.2500000000006, 530.2500000000008, 513.6666666666674, 531.1833333333344, 538.4583333333339, 552.4416666666677, 541.1250000000006, 505.7416666666673, 511.12500000000074, 557.5333333333346, 516.9083333333343, 501.3583333333339, 547.5833333333343, 523.6083333333343, 491.7500000000007, 533.8416666666675, 536.2166666666674, 510.7666666666674, 543.8666666666674, 561.900000000001, 579.9833333333343, 542.7250000000008, 397.4666666666671, 478.2833333333343, 573.4000000000013, 557.2000000000013, 503.983333333334, 537.700000000001, 446.60000000000065, 494.85000000000065, 577.591666666668, 561.7500000000007, 542.1166666666677, 511.9083333333344, 541.4583333333342, 440.8166666666675, 487.7166666666677, 545.7500000000011, 534.8750000000007, 512.8750000000008, 544.6916666666676, 540.250000000001, 500.52500000000094, 541.7750000000008, 517.7416666666675, 515.6916666666674, 566.1916666666679, 595.8083333333344, 577.3666666666678, 523.2583333333343, 588.2916666666677, 563.0833333333342, 560.5583333333344, 535.4666666666675, 534.1083333333341, 610.5000000000011, 540.3583333333339, 563.9250000000011, 573.7750000000004, 515.1583333333338, 601.7583333333343, 594.6750000000011, 563.6833333333338, 508.72500000000036, 556.6083333333344, 556.2333333333343, 582.9916666666678, 532.9166666666675, 567.5666666666676, 611.4000000000012, 519.9166666666674, 569.8416666666676, 539.4916666666678, 567.6166666666676, 588.9416666666677, 644.7416666666679, 539.7333333333341, 531.2166666666674, 562.5583333333341, 582.0000000000007, 595.1166666666674, 515.3083333333342, 590.9083333333344, 617.3000000000011, 516.9000000000009, 635.525000000001, 583.9250000000006, 545.6000000000007, 546.9083333333341, 594.7083333333344, 586.7500000000013, 611.3666666666679]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2406066567612642, "mean_inference_ms": 2.0517958615285807, "mean_action_processing_ms": 0.09062514334175202, "mean_env_wait_ms": 1.5302749939813374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006304740905761719, "StateBufferConnector_ms": 0.00322723388671875, "ViewRequirementAgentConnector_ms": 0.08280467987060547}, "num_episodes": 24, "episode_return_max": 644.7416666666679, "episode_return_min": 397.4666666666671, "episode_return_mean": 543.0479166666676, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75750, "num_agent_steps_trained": 75600, "num_env_steps_sampled": 75750, "num_env_steps_trained": 75600, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 245.5128962343553, "num_env_steps_trained_throughput_per_sec": 259.9548313069644, "timesteps_total": 75750, "num_env_steps_sampled_lifetime": 75750, "num_agent_steps_sampled_lifetime": 75750, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 75750, "timers": {"training_iteration_time_ms": 10243.593, "restore_workers_time_ms": 0.016, "training_step_time_ms": 609.514, "sample_time_ms": 594.632, "synch_weights_time_ms": 13.334}, "counters": {"num_env_steps_sampled": 75750, "num_env_steps_trained": 75600, "num_agent_steps_sampled": 75750, "num_agent_steps_trained": 75600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 505, "num_samples_added_to_queue": 75600}, "done": false, "training_iteration": 30, "trial_id": "27800_00000", "date": "2024-10-12_15-32-59", "timestamp": 1728743579, "time_this_iter_s": 10.394872426986694, "time_total_s": 308.854145526886, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486c19c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 308.854145526886, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 16.413333333333334, "ram_util_percent": 33.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 420127.8125, "policy_loss": 414015.9375, "entropy": 25.844919204711914, "entropy_coeff": 0.01, "var_gnorm": 16.266958236694336, "vf_loss": 618940.125, "vf_explained_var": 0.03035801649093628}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 260.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 78300, "num_env_steps_trained": 78000, "num_agent_steps_sampled": 78300, "num_agent_steps_trained": 78000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 522, "num_samples_added_to_queue": 78300, "learner_queue": {"size_count": 260, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.233, "learner_load_time_ms": 0.448, "learner_load_wait_time_ms": 1154.304, "learner_dequeue_time_ms": 9941.555}}, "env_runners": {"episode_reward_max": 645.833333333334, "episode_reward_min": 397.4666666666671, "episode_reward_mean": 556.9119166666677, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 397.4666666666671}, "policy_reward_max": {"default_policy": 645.833333333334}, "policy_reward_mean": {"default_policy": 556.9119166666677}, "custom_metrics": {"num_consolidated_mean": 1.4595999999999998, "num_consolidated_min": 1.24, "num_consolidated_max": 1.71, "num_overloaded_mean": 0.1353, "num_overloaded_min": 0.05, "num_overloaded_max": 0.25, "num_moves_mean": 8.938799999999999, "num_moves_min": 8.6, "num_moves_max": 9.36, "mean_accuracy_mean": 41.753916666666676, "mean_accuracy_min": 41.47366666666667, "mean_accuracy_max": 41.94866666666667, "num_model_switches_mean": 5.4742, "num_model_switches_min": 5.05, "num_model_switches_max": 5.89, "num_slav_mean": 0.1498681666666667, "num_slav_min": 0.12823333333333337, "num_slav_max": 0.1673666666666667, "cpu_conserved_cost_mean": 3.4294, "cpu_conserved_cost_min": 2.94, "cpu_conserved_cost_max": 3.94, "mean_cluster_cpu_util_mean": 0.4776701038291086, "mean_cluster_cpu_util_min": 0.46567289447637333, "mean_cluster_cpu_util_max": 0.49185427106583424, "mean_cluster_mem_util_mean": 0.3142668271262091, "mean_cluster_mem_util_min": 0.30698986211573237, "mean_cluster_mem_util_max": 0.3222279821105657, "reward_consolidation_mean_mean": 2.6689583333333333, "reward_consolidation_mean_min": 1.8749999999999993, "reward_consolidation_mean_max": 3.229166666666666, "reward_illegal_mean_mean": -0.2255, "reward_illegal_mean_min": -0.4166666666666666, "reward_illegal_mean_max": -0.08333333333333331, "reward_accuracy_mean_mean": 5.075333333333344, "reward_accuracy_mean_min": 4.183333333333341, "reward_accuracy_mean_max": 5.625000000000013, "reward_sla_mean_mean": -1.9496724999999997, "reward_sla_mean_min": -2.29075, "reward_sla_mean_max": -1.5964999999999998, "reward_consolidation_sum_mean": 266.8958333333333, "reward_consolidation_sum_min": 187.49999999999994, "reward_consolidation_sum_max": 322.91666666666663, "reward_illegal_sum_mean": -22.55, "reward_illegal_sum_min": -41.66666666666666, "reward_illegal_sum_max": -8.333333333333332, "reward_accuracy_sum_mean": 507.5333333333343, "reward_accuracy_sum_min": 418.3333333333341, "reward_accuracy_sum_max": 562.5000000000014, "reward_sla_sum_mean": -194.96724999999998, "reward_sla_sum_min": -229.07500000000002, "reward_sla_sum_max": -159.64999999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2564.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [561.900000000001, 579.9833333333343, 542.7250000000008, 397.4666666666671, 478.2833333333343, 573.4000000000013, 557.2000000000013, 503.983333333334, 537.700000000001, 446.60000000000065, 494.85000000000065, 577.591666666668, 561.7500000000007, 542.1166666666677, 511.9083333333344, 541.4583333333342, 440.8166666666675, 487.7166666666677, 545.7500000000011, 534.8750000000007, 512.8750000000008, 544.6916666666676, 540.250000000001, 500.52500000000094, 541.7750000000008, 517.7416666666675, 515.6916666666674, 566.1916666666679, 595.8083333333344, 577.3666666666678, 523.2583333333343, 588.2916666666677, 563.0833333333342, 560.5583333333344, 535.4666666666675, 534.1083333333341, 610.5000000000011, 540.3583333333339, 563.9250000000011, 573.7750000000004, 515.1583333333338, 601.7583333333343, 594.6750000000011, 563.6833333333338, 508.72500000000036, 556.6083333333344, 556.2333333333343, 582.9916666666678, 532.9166666666675, 567.5666666666676, 611.4000000000012, 519.9166666666674, 569.8416666666676, 539.4916666666678, 567.6166666666676, 588.9416666666677, 644.7416666666679, 539.7333333333341, 531.2166666666674, 562.5583333333341, 582.0000000000007, 595.1166666666674, 515.3083333333342, 590.9083333333344, 617.3000000000011, 516.9000000000009, 635.525000000001, 583.9250000000006, 545.6000000000007, 546.9083333333341, 594.7083333333344, 586.7500000000013, 611.3666666666679, 539.258333333334, 645.833333333334, 618.8583333333343, 586.3416666666675, 606.8916666666674, 556.6916666666677, 594.6833333333345, 549.2333333333344, 572.4666666666678, 578.4000000000009, 597.816666666668, 525.3166666666676, 499.6833333333343, 552.7916666666677, 591.1666666666677, 602.0916666666676, 575.066666666668, 566.4083333333344, 536.8333333333342, 583.8500000000007, 597.8250000000012, 571.3750000000011, 560.3666666666677, 581.2083333333344, 557.4833333333344, 543.7583333333342, 597.0833333333343], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [561.900000000001, 579.9833333333343, 542.7250000000008, 397.4666666666671, 478.2833333333343, 573.4000000000013, 557.2000000000013, 503.983333333334, 537.700000000001, 446.60000000000065, 494.85000000000065, 577.591666666668, 561.7500000000007, 542.1166666666677, 511.9083333333344, 541.4583333333342, 440.8166666666675, 487.7166666666677, 545.7500000000011, 534.8750000000007, 512.8750000000008, 544.6916666666676, 540.250000000001, 500.52500000000094, 541.7750000000008, 517.7416666666675, 515.6916666666674, 566.1916666666679, 595.8083333333344, 577.3666666666678, 523.2583333333343, 588.2916666666677, 563.0833333333342, 560.5583333333344, 535.4666666666675, 534.1083333333341, 610.5000000000011, 540.3583333333339, 563.9250000000011, 573.7750000000004, 515.1583333333338, 601.7583333333343, 594.6750000000011, 563.6833333333338, 508.72500000000036, 556.6083333333344, 556.2333333333343, 582.9916666666678, 532.9166666666675, 567.5666666666676, 611.4000000000012, 519.9166666666674, 569.8416666666676, 539.4916666666678, 567.6166666666676, 588.9416666666677, 644.7416666666679, 539.7333333333341, 531.2166666666674, 562.5583333333341, 582.0000000000007, 595.1166666666674, 515.3083333333342, 590.9083333333344, 617.3000000000011, 516.9000000000009, 635.525000000001, 583.9250000000006, 545.6000000000007, 546.9083333333341, 594.7083333333344, 586.7500000000013, 611.3666666666679, 539.258333333334, 645.833333333334, 618.8583333333343, 586.3416666666675, 606.8916666666674, 556.6916666666677, 594.6833333333345, 549.2333333333344, 572.4666666666678, 578.4000000000009, 597.816666666668, 525.3166666666676, 499.6833333333343, 552.7916666666677, 591.1666666666677, 602.0916666666676, 575.066666666668, 566.4083333333344, 536.8333333333342, 583.8500000000007, 597.8250000000012, 571.3750000000011, 560.3666666666677, 581.2083333333344, 557.4833333333344, 543.7583333333342, 597.0833333333343]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24053487511027533, "mean_inference_ms": 2.0504899379191754, "mean_action_processing_ms": 0.09059979093250582, "mean_env_wait_ms": 1.530015815685168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006290912628173828, "StateBufferConnector_ms": 0.0032002925872802734, "ViewRequirementAgentConnector_ms": 0.08301019668579102}, "num_episodes": 27, "episode_return_max": 645.833333333334, "episode_return_min": 397.4666666666671, "episode_return_mean": 556.9119166666677, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78300, "num_agent_steps_trained": 78000, "num_env_steps_sampled": 78300, "num_env_steps_trained": 78000, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 248.13884875742596, "num_env_steps_trained_throughput_per_sec": 233.54244588934208, "timesteps_total": 78300, "num_env_steps_sampled_lifetime": 78300, "num_agent_steps_sampled_lifetime": 78300, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 78300, "timers": {"training_iteration_time_ms": 10242.171, "restore_workers_time_ms": 0.014, "training_step_time_ms": 603.062, "sample_time_ms": 586.807, "synch_weights_time_ms": 14.829}, "counters": {"num_env_steps_sampled": 78300, "num_env_steps_trained": 78000, "num_agent_steps_sampled": 78300, "num_agent_steps_trained": 78000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 522, "num_samples_added_to_queue": 78300}, "done": false, "training_iteration": 31, "trial_id": "27800_00000", "date": "2024-10-12_15-33-09", "timestamp": 1728743589, "time_this_iter_s": 10.291621208190918, "time_total_s": 319.1457667350769, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f68ee0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 319.1457667350769, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 16.36, "ram_util_percent": 33.86}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 441145.25, "policy_loss": 434008.25, "entropy": 25.31546974182129, "entropy_coeff": 0.01, "var_gnorm": 16.28048324584961, "vf_loss": 721295.1875, "vf_explained_var": 0.03387486934661865}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 269.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 80850, "num_env_steps_trained": 80700, "num_agent_steps_sampled": 80850, "num_agent_steps_trained": 80700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 539, "num_samples_added_to_queue": 80700, "learner_queue": {"size_count": 269, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.97, "learner_load_time_ms": 0.402, "learner_load_wait_time_ms": 1153.641, "learner_dequeue_time_ms": 9878.218}}, "env_runners": {"episode_reward_max": 667.625000000001, "episode_reward_min": 499.6833333333343, "episode_reward_mean": 575.6652500000009, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 499.6833333333343}, "policy_reward_max": {"default_policy": 667.625000000001}, "policy_reward_mean": {"default_policy": 575.6652500000009}, "custom_metrics": {"num_consolidated_mean": 1.4931999999999999, "num_consolidated_min": 1.3, "num_consolidated_max": 1.71, "num_overloaded_mean": 0.12150000000000002, "num_overloaded_min": 0.05, "num_overloaded_max": 0.21, "num_moves_mean": 8.8769, "num_moves_min": 8.4, "num_moves_max": 9.35, "mean_accuracy_mean": 41.77342333333335, "mean_accuracy_min": 41.47366666666667, "mean_accuracy_max": 42.07533333333335, "num_model_switches_mean": 5.404500000000001, "num_model_switches_min": 4.77, "num_model_switches_max": 5.88, "num_slav_mean": 0.14929716666666668, "num_slav_min": 0.12823333333333337, "num_slav_max": 0.1673666666666667, "cpu_conserved_cost_mean": 3.4989999999999997, "cpu_conserved_cost_min": 2.94, "cpu_conserved_cost_max": 3.94, "mean_cluster_cpu_util_mean": 0.47680407443497813, "mean_cluster_cpu_util_min": 0.46567289447637333, "mean_cluster_cpu_util_max": 0.48846165339000036, "mean_cluster_mem_util_mean": 0.31357847116378196, "mean_cluster_mem_util_min": 0.30698986211573237, "mean_cluster_mem_util_max": 0.3222279821105657, "reward_consolidation_mean_mean": 2.758125, "reward_consolidation_mean_min": 2.3124999999999996, "reward_consolidation_mean_max": 3.25, "reward_illegal_mean_mean": -0.2025, "reward_illegal_mean_min": -0.3499999999999999, "reward_illegal_mean_max": -0.08333333333333331, "reward_accuracy_mean_mean": 5.167250000000011, "reward_accuracy_mean_min": 4.58333333333334, "reward_accuracy_mean_max": 5.908333333333347, "reward_sla_mean_mean": -1.9662225, "reward_sla_mean_min": -2.2904999999999998, "reward_sla_mean_max": -1.69075, "reward_consolidation_sum_mean": 275.81249999999994, "reward_consolidation_sum_min": 231.24999999999994, "reward_consolidation_sum_max": 325.0, "reward_illegal_sum_mean": -20.249999999999996, "reward_illegal_sum_min": -34.99999999999999, "reward_illegal_sum_max": -8.333333333333332, "reward_accuracy_sum_mean": 516.725000000001, "reward_accuracy_sum_min": 458.33333333333405, "reward_accuracy_sum_max": 590.8333333333347, "reward_sla_sum_mean": -196.62224999999998, "reward_sla_sum_min": -229.04999999999998, "reward_sla_sum_max": -169.075, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1882.0, "global_timestep_min": 200, "global_timestep_max": 3500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [541.7750000000008, 517.7416666666675, 515.6916666666674, 566.1916666666679, 595.8083333333344, 577.3666666666678, 523.2583333333343, 588.2916666666677, 563.0833333333342, 560.5583333333344, 535.4666666666675, 534.1083333333341, 610.5000000000011, 540.3583333333339, 563.9250000000011, 573.7750000000004, 515.1583333333338, 601.7583333333343, 594.6750000000011, 563.6833333333338, 508.72500000000036, 556.6083333333344, 556.2333333333343, 582.9916666666678, 532.9166666666675, 567.5666666666676, 611.4000000000012, 519.9166666666674, 569.8416666666676, 539.4916666666678, 567.6166666666676, 588.9416666666677, 644.7416666666679, 539.7333333333341, 531.2166666666674, 562.5583333333341, 582.0000000000007, 595.1166666666674, 515.3083333333342, 590.9083333333344, 617.3000000000011, 516.9000000000009, 635.525000000001, 583.9250000000006, 545.6000000000007, 546.9083333333341, 594.7083333333344, 586.7500000000013, 611.3666666666679, 539.258333333334, 645.833333333334, 618.8583333333343, 586.3416666666675, 606.8916666666674, 556.6916666666677, 594.6833333333345, 549.2333333333344, 572.4666666666678, 578.4000000000009, 597.816666666668, 525.3166666666676, 499.6833333333343, 552.7916666666677, 591.1666666666677, 602.0916666666676, 575.066666666668, 566.4083333333344, 536.8333333333342, 583.8500000000007, 597.8250000000012, 571.3750000000011, 560.3666666666677, 581.2083333333344, 557.4833333333344, 543.7583333333342, 597.0833333333343, 588.9083333333344, 593.0083333333346, 586.4666666666677, 619.4416666666673, 571.8750000000009, 538.2416666666677, 554.3833333333345, 595.3916666666674, 622.5666666666674, 622.3583333333339, 632.8000000000008, 608.1250000000015, 552.9666666666676, 566.5833333333345, 667.625000000001, 591.5083333333345, 591.4333333333341, 610.5666666666677, 593.5833333333345, 607.0833333333339, 588.9666666666677, 625.2416666666675, 638.1000000000014, 624.5250000000011], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [541.7750000000008, 517.7416666666675, 515.6916666666674, 566.1916666666679, 595.8083333333344, 577.3666666666678, 523.2583333333343, 588.2916666666677, 563.0833333333342, 560.5583333333344, 535.4666666666675, 534.1083333333341, 610.5000000000011, 540.3583333333339, 563.9250000000011, 573.7750000000004, 515.1583333333338, 601.7583333333343, 594.6750000000011, 563.6833333333338, 508.72500000000036, 556.6083333333344, 556.2333333333343, 582.9916666666678, 532.9166666666675, 567.5666666666676, 611.4000000000012, 519.9166666666674, 569.8416666666676, 539.4916666666678, 567.6166666666676, 588.9416666666677, 644.7416666666679, 539.7333333333341, 531.2166666666674, 562.5583333333341, 582.0000000000007, 595.1166666666674, 515.3083333333342, 590.9083333333344, 617.3000000000011, 516.9000000000009, 635.525000000001, 583.9250000000006, 545.6000000000007, 546.9083333333341, 594.7083333333344, 586.7500000000013, 611.3666666666679, 539.258333333334, 645.833333333334, 618.8583333333343, 586.3416666666675, 606.8916666666674, 556.6916666666677, 594.6833333333345, 549.2333333333344, 572.4666666666678, 578.4000000000009, 597.816666666668, 525.3166666666676, 499.6833333333343, 552.7916666666677, 591.1666666666677, 602.0916666666676, 575.066666666668, 566.4083333333344, 536.8333333333342, 583.8500000000007, 597.8250000000012, 571.3750000000011, 560.3666666666677, 581.2083333333344, 557.4833333333344, 543.7583333333342, 597.0833333333343, 588.9083333333344, 593.0083333333346, 586.4666666666677, 619.4416666666673, 571.8750000000009, 538.2416666666677, 554.3833333333345, 595.3916666666674, 622.5666666666674, 622.3583333333339, 632.8000000000008, 608.1250000000015, 552.9666666666676, 566.5833333333345, 667.625000000001, 591.5083333333345, 591.4333333333341, 610.5666666666677, 593.5833333333345, 607.0833333333339, 588.9666666666677, 625.2416666666675, 638.1000000000014, 624.5250000000011]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24053474550685133, "mean_inference_ms": 2.049630809340414, "mean_action_processing_ms": 0.09058127311216073, "mean_env_wait_ms": 1.5299823995807322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006340742111206055, "StateBufferConnector_ms": 0.0032377243041992188, "ViewRequirementAgentConnector_ms": 0.08404731750488281}, "num_episodes": 24, "episode_return_max": 667.625000000001, "episode_return_min": 499.6833333333343, "episode_return_mean": 575.6652500000009, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80850, "num_agent_steps_trained": 80700, "num_env_steps_sampled": 80850, "num_env_steps_trained": 80700, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 245.64434057484561, "num_env_steps_trained_throughput_per_sec": 260.0940076674836, "timesteps_total": 80850, "num_env_steps_sampled_lifetime": 80850, "num_agent_steps_sampled_lifetime": 80850, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 80850, "timers": {"training_iteration_time_ms": 10258.24, "restore_workers_time_ms": 0.014, "training_step_time_ms": 613.096, "sample_time_ms": 598.314, "synch_weights_time_ms": 13.368}, "counters": {"num_env_steps_sampled": 80850, "num_env_steps_trained": 80700, "num_agent_steps_sampled": 80850, "num_agent_steps_trained": 80700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 539, "num_samples_added_to_queue": 80700}, "done": false, "training_iteration": 32, "trial_id": "27800_00000", "date": "2024-10-12_15-33-19", "timestamp": 1728743599, "time_this_iter_s": 10.391664266586304, "time_total_s": 329.5374310016632, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f6b1f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 329.5374310016632, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 16.393333333333334, "ram_util_percent": 34.06666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 502145.25, "policy_loss": 492824.0, "entropy": 24.906204223632812, "entropy_coeff": 0.01, "var_gnorm": 16.291545867919922, "vf_loss": 939595.6875, "vf_explained_var": 0.03671842813491821}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 277.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 83400, "num_env_steps_trained": 83100, "num_agent_steps_sampled": 83400, "num_agent_steps_trained": 83100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 556, "num_samples_added_to_queue": 83400, "learner_queue": {"size_count": 277, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.949, "learner_load_time_ms": 0.386, "learner_load_wait_time_ms": 1181.711, "learner_dequeue_time_ms": 9860.306}}, "env_runners": {"episode_reward_max": 697.0166666666679, "episode_reward_min": 499.6833333333343, "episode_reward_mean": 594.3936666666677, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 499.6833333333343}, "policy_reward_max": {"default_policy": 697.0166666666679}, "policy_reward_mean": {"default_policy": 594.3936666666677}, "custom_metrics": {"num_consolidated_mean": 1.5248, "num_consolidated_min": 1.3, "num_consolidated_max": 1.76, "num_overloaded_mean": 0.11150000000000002, "num_overloaded_min": 0.05, "num_overloaded_max": 0.21, "num_moves_mean": 8.7866, "num_moves_min": 8.31, "num_moves_max": 9.35, "mean_accuracy_mean": 41.81915000000001, "mean_accuracy_min": 41.53066666666667, "mean_accuracy_max": 42.07533333333335, "num_model_switches_mean": 5.3293, "num_model_switches_min": 4.77, "num_model_switches_max": 5.75, "num_slav_mean": 0.14929833333333334, "num_slav_min": 0.12823333333333337, "num_slav_max": 0.1673666666666667, "cpu_conserved_cost_mean": 3.5658000000000003, "cpu_conserved_cost_min": 3.08, "cpu_conserved_cost_max": 4.18, "mean_cluster_cpu_util_mean": 0.47613633779496956, "mean_cluster_cpu_util_min": 0.46567289447637333, "mean_cluster_cpu_util_max": 0.48846165339000036, "mean_cluster_mem_util_mean": 0.3131625644069864, "mean_cluster_mem_util_min": 0.3067302844872126, "mean_cluster_mem_util_max": 0.3222279821105657, "reward_consolidation_mean_mean": 2.8410416666666665, "reward_consolidation_mean_min": 2.3124999999999996, "reward_consolidation_mean_max": 3.416666666666666, "reward_illegal_mean_mean": -0.1858333333333333, "reward_illegal_mean_min": -0.3499999999999999, "reward_illegal_mean_max": -0.08333333333333331, "reward_accuracy_mean_mean": 5.273583333333345, "reward_accuracy_mean_min": 4.816666666666676, "reward_accuracy_mean_max": 5.908333333333347, "reward_sla_mean_mean": -1.9848549999999998, "reward_sla_mean_min": -2.2904999999999998, "reward_sla_mean_max": -1.703, "reward_consolidation_sum_mean": 284.10416666666663, "reward_consolidation_sum_min": 231.24999999999994, "reward_consolidation_sum_max": 341.66666666666663, "reward_illegal_sum_mean": -18.58333333333333, "reward_illegal_sum_min": -34.99999999999999, "reward_illegal_sum_max": -8.333333333333332, "reward_accuracy_sum_mean": 527.3583333333345, "reward_accuracy_sum_min": 481.66666666666765, "reward_accuracy_sum_max": 590.8333333333347, "reward_sla_sum_mean": -198.4855, "reward_sla_sum_min": -229.04999999999998, "reward_sla_sum_max": -170.3, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2782.0, "global_timestep_min": 1100, "global_timestep_max": 4400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [519.9166666666674, 569.8416666666676, 539.4916666666678, 567.6166666666676, 588.9416666666677, 644.7416666666679, 539.7333333333341, 531.2166666666674, 562.5583333333341, 582.0000000000007, 595.1166666666674, 515.3083333333342, 590.9083333333344, 617.3000000000011, 516.9000000000009, 635.525000000001, 583.9250000000006, 545.6000000000007, 546.9083333333341, 594.7083333333344, 586.7500000000013, 611.3666666666679, 539.258333333334, 645.833333333334, 618.8583333333343, 586.3416666666675, 606.8916666666674, 556.6916666666677, 594.6833333333345, 549.2333333333344, 572.4666666666678, 578.4000000000009, 597.816666666668, 525.3166666666676, 499.6833333333343, 552.7916666666677, 591.1666666666677, 602.0916666666676, 575.066666666668, 566.4083333333344, 536.8333333333342, 583.8500000000007, 597.8250000000012, 571.3750000000011, 560.3666666666677, 581.2083333333344, 557.4833333333344, 543.7583333333342, 597.0833333333343, 588.9083333333344, 593.0083333333346, 586.4666666666677, 619.4416666666673, 571.8750000000009, 538.2416666666677, 554.3833333333345, 595.3916666666674, 622.5666666666674, 622.3583333333339, 632.8000000000008, 608.1250000000015, 552.9666666666676, 566.5833333333345, 667.625000000001, 591.5083333333345, 591.4333333333341, 610.5666666666677, 593.5833333333345, 607.0833333333339, 588.9666666666677, 625.2416666666675, 638.1000000000014, 624.5250000000011, 613.5250000000009, 633.2416666666678, 663.0166666666678, 615.9166666666678, 620.2166666666677, 612.6666666666675, 582.975000000001, 670.3833333333343, 630.9333333333348, 609.1083333333343, 676.416666666668, 561.4000000000011, 646.9000000000012, 629.1333333333341, 697.0166666666679, 595.2250000000012, 669.316666666668, 596.900000000001, 635.0750000000007, 636.1166666666678, 605.9916666666679, 614.575000000001, 662.6666666666679, 603.0833333333345, 619.9416666666677, 667.7416666666684, 602.975000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [519.9166666666674, 569.8416666666676, 539.4916666666678, 567.6166666666676, 588.9416666666677, 644.7416666666679, 539.7333333333341, 531.2166666666674, 562.5583333333341, 582.0000000000007, 595.1166666666674, 515.3083333333342, 590.9083333333344, 617.3000000000011, 516.9000000000009, 635.525000000001, 583.9250000000006, 545.6000000000007, 546.9083333333341, 594.7083333333344, 586.7500000000013, 611.3666666666679, 539.258333333334, 645.833333333334, 618.8583333333343, 586.3416666666675, 606.8916666666674, 556.6916666666677, 594.6833333333345, 549.2333333333344, 572.4666666666678, 578.4000000000009, 597.816666666668, 525.3166666666676, 499.6833333333343, 552.7916666666677, 591.1666666666677, 602.0916666666676, 575.066666666668, 566.4083333333344, 536.8333333333342, 583.8500000000007, 597.8250000000012, 571.3750000000011, 560.3666666666677, 581.2083333333344, 557.4833333333344, 543.7583333333342, 597.0833333333343, 588.9083333333344, 593.0083333333346, 586.4666666666677, 619.4416666666673, 571.8750000000009, 538.2416666666677, 554.3833333333345, 595.3916666666674, 622.5666666666674, 622.3583333333339, 632.8000000000008, 608.1250000000015, 552.9666666666676, 566.5833333333345, 667.625000000001, 591.5083333333345, 591.4333333333341, 610.5666666666677, 593.5833333333345, 607.0833333333339, 588.9666666666677, 625.2416666666675, 638.1000000000014, 624.5250000000011, 613.5250000000009, 633.2416666666678, 663.0166666666678, 615.9166666666678, 620.2166666666677, 612.6666666666675, 582.975000000001, 670.3833333333343, 630.9333333333348, 609.1083333333343, 676.416666666668, 561.4000000000011, 646.9000000000012, 629.1333333333341, 697.0166666666679, 595.2250000000012, 669.316666666668, 596.900000000001, 635.0750000000007, 636.1166666666678, 605.9916666666679, 614.575000000001, 662.6666666666679, 603.0833333333345, 619.9416666666677, 667.7416666666684, 602.975000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2405535471335528, "mean_inference_ms": 2.0490965806614954, "mean_action_processing_ms": 0.0905798289674868, "mean_env_wait_ms": 1.5301479899355734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006392717361450195, "StateBufferConnector_ms": 0.003237485885620117, "ViewRequirementAgentConnector_ms": 0.0841834545135498}, "num_episodes": 27, "episode_return_max": 697.0166666666679, "episode_return_min": 499.6833333333343, "episode_return_mean": 594.3936666666677, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83400, "num_agent_steps_trained": 83100, "num_env_steps_sampled": 83400, "num_env_steps_trained": 83100, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 243.82081218062345, "num_env_steps_trained_throughput_per_sec": 229.4784114641162, "timesteps_total": 83400, "num_env_steps_sampled_lifetime": 83400, "num_agent_steps_sampled_lifetime": 83400, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 83400, "timers": {"training_iteration_time_ms": 10291.838, "restore_workers_time_ms": 0.013, "training_step_time_ms": 602.179, "sample_time_ms": 586.688, "synch_weights_time_ms": 13.941}, "counters": {"num_env_steps_sampled": 83400, "num_env_steps_trained": 83100, "num_agent_steps_sampled": 83400, "num_agent_steps_trained": 83100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 556, "num_samples_added_to_queue": 83400}, "done": false, "training_iteration": 33, "trial_id": "27800_00000", "date": "2024-10-12_15-33-30", "timestamp": 1728743610, "time_this_iter_s": 10.47235107421875, "time_total_s": 340.00978207588196, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f6a2c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 340.00978207588196, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 16.546666666666663, "ram_util_percent": 34.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 465421.09375, "policy_loss": 457114.625, "entropy": 24.430438995361328, "entropy_coeff": 0.01, "var_gnorm": 16.30333137512207, "vf_loss": 837975.125, "vf_explained_var": 0.04606437683105469}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 286.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 85950, "num_env_steps_trained": 85800, "num_agent_steps_sampled": 85950, "num_agent_steps_trained": 85800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 573, "num_samples_added_to_queue": 85800, "learner_queue": {"size_count": 286, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.349, "learner_load_time_ms": 0.352, "learner_load_wait_time_ms": 1141.326, "learner_dequeue_time_ms": 9799.474}}, "env_runners": {"episode_reward_max": 709.1250000000014, "episode_reward_min": 499.6833333333343, "episode_reward_mean": 611.5917500000011, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 499.6833333333343}, "policy_reward_max": {"default_policy": 709.1250000000014}, "policy_reward_mean": {"default_policy": 611.5917500000011}, "custom_metrics": {"num_consolidated_mean": 1.5655000000000001, "num_consolidated_min": 1.34, "num_consolidated_max": 1.78, "num_overloaded_mean": 0.1058, "num_overloaded_min": 0.04, "num_overloaded_max": 0.2, "num_moves_mean": 8.667, "num_moves_min": 8.13, "num_moves_max": 9.35, "mean_accuracy_mean": 41.85639000000001, "mean_accuracy_min": 41.53066666666667, "mean_accuracy_max": 42.164000000000016, "num_model_switches_mean": 5.2528, "num_model_switches_min": 4.76, "num_model_switches_max": 5.7, "num_slav_mean": 0.14862466666666665, "num_slav_min": 0.12806666666666666, "num_slav_max": 0.16611666666666663, "cpu_conserved_cost_mean": 3.6422, "cpu_conserved_cost_min": 3.12, "cpu_conserved_cost_max": 4.24, "mean_cluster_cpu_util_mean": 0.47532670643149966, "mean_cluster_cpu_util_min": 0.46748001806957906, "mean_cluster_cpu_util_max": 0.4873594979188637, "mean_cluster_mem_util_mean": 0.3122728312236287, "mean_cluster_mem_util_min": 0.3050052170340711, "mean_cluster_mem_util_max": 0.31960372050719016, "reward_consolidation_mean_mean": 2.93125, "reward_consolidation_mean_min": 2.3124999999999996, "reward_consolidation_mean_max": 3.4999999999999996, "reward_illegal_mean_mean": -0.1763333333333333, "reward_illegal_mean_min": -0.33333333333333326, "reward_illegal_mean_max": -0.06666666666666667, "reward_accuracy_mean_mean": 5.351333333333344, "reward_accuracy_mean_min": 4.916666666666679, "reward_accuracy_mean_max": 5.908333333333347, "reward_sla_mean_mean": -1.9903325, "reward_sla_mean_min": -2.2645, "reward_sla_mean_max": -1.7327499999999998, "reward_consolidation_sum_mean": 293.125, "reward_consolidation_sum_min": 231.24999999999994, "reward_consolidation_sum_max": 349.99999999999994, "reward_illegal_sum_mean": -17.63333333333333, "reward_illegal_sum_min": -33.33333333333333, "reward_illegal_sum_max": -6.666666666666666, "reward_accuracy_sum_mean": 535.1333333333346, "reward_accuracy_sum_min": 491.66666666666794, "reward_accuracy_sum_max": 590.8333333333347, "reward_sla_sum_mean": -199.03324999999998, "reward_sla_sum_min": -226.45000000000002, "reward_sla_sum_max": -173.27499999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3582.0, "global_timestep_min": 1900, "global_timestep_max": 5200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [618.8583333333343, 586.3416666666675, 606.8916666666674, 556.6916666666677, 594.6833333333345, 549.2333333333344, 572.4666666666678, 578.4000000000009, 597.816666666668, 525.3166666666676, 499.6833333333343, 552.7916666666677, 591.1666666666677, 602.0916666666676, 575.066666666668, 566.4083333333344, 536.8333333333342, 583.8500000000007, 597.8250000000012, 571.3750000000011, 560.3666666666677, 581.2083333333344, 557.4833333333344, 543.7583333333342, 597.0833333333343, 588.9083333333344, 593.0083333333346, 586.4666666666677, 619.4416666666673, 571.8750000000009, 538.2416666666677, 554.3833333333345, 595.3916666666674, 622.5666666666674, 622.3583333333339, 632.8000000000008, 608.1250000000015, 552.9666666666676, 566.5833333333345, 667.625000000001, 591.5083333333345, 591.4333333333341, 610.5666666666677, 593.5833333333345, 607.0833333333339, 588.9666666666677, 625.2416666666675, 638.1000000000014, 624.5250000000011, 613.5250000000009, 633.2416666666678, 663.0166666666678, 615.9166666666678, 620.2166666666677, 612.6666666666675, 582.975000000001, 670.3833333333343, 630.9333333333348, 609.1083333333343, 676.416666666668, 561.4000000000011, 646.9000000000012, 629.1333333333341, 697.0166666666679, 595.2250000000012, 669.316666666668, 596.900000000001, 635.0750000000007, 636.1166666666678, 605.9916666666679, 614.575000000001, 662.6666666666679, 603.0833333333345, 619.9416666666677, 667.7416666666684, 602.975000000001, 628.6666666666679, 610.8250000000016, 636.7083333333346, 694.2666666666677, 619.0750000000015, 687.5000000000009, 709.1250000000014, 667.5333333333347, 650.9166666666682, 691.3583333333348, 680.5583333333345, 593.1500000000016, 628.5583333333346, 578.0000000000009, 620.8166666666677, 619.1750000000012, 597.8666666666677, 681.2333333333347, 681.9500000000013, 642.9000000000013, 651.833333333335, 633.0250000000013, 635.2750000000015, 650.9583333333344], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [618.8583333333343, 586.3416666666675, 606.8916666666674, 556.6916666666677, 594.6833333333345, 549.2333333333344, 572.4666666666678, 578.4000000000009, 597.816666666668, 525.3166666666676, 499.6833333333343, 552.7916666666677, 591.1666666666677, 602.0916666666676, 575.066666666668, 566.4083333333344, 536.8333333333342, 583.8500000000007, 597.8250000000012, 571.3750000000011, 560.3666666666677, 581.2083333333344, 557.4833333333344, 543.7583333333342, 597.0833333333343, 588.9083333333344, 593.0083333333346, 586.4666666666677, 619.4416666666673, 571.8750000000009, 538.2416666666677, 554.3833333333345, 595.3916666666674, 622.5666666666674, 622.3583333333339, 632.8000000000008, 608.1250000000015, 552.9666666666676, 566.5833333333345, 667.625000000001, 591.5083333333345, 591.4333333333341, 610.5666666666677, 593.5833333333345, 607.0833333333339, 588.9666666666677, 625.2416666666675, 638.1000000000014, 624.5250000000011, 613.5250000000009, 633.2416666666678, 663.0166666666678, 615.9166666666678, 620.2166666666677, 612.6666666666675, 582.975000000001, 670.3833333333343, 630.9333333333348, 609.1083333333343, 676.416666666668, 561.4000000000011, 646.9000000000012, 629.1333333333341, 697.0166666666679, 595.2250000000012, 669.316666666668, 596.900000000001, 635.0750000000007, 636.1166666666678, 605.9916666666679, 614.575000000001, 662.6666666666679, 603.0833333333345, 619.9416666666677, 667.7416666666684, 602.975000000001, 628.6666666666679, 610.8250000000016, 636.7083333333346, 694.2666666666677, 619.0750000000015, 687.5000000000009, 709.1250000000014, 667.5333333333347, 650.9166666666682, 691.3583333333348, 680.5583333333345, 593.1500000000016, 628.5583333333346, 578.0000000000009, 620.8166666666677, 619.1750000000012, 597.8666666666677, 681.2333333333347, 681.9500000000013, 642.9000000000013, 651.833333333335, 633.0250000000013, 635.2750000000015, 650.9583333333344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24055938219462772, "mean_inference_ms": 2.0482980700744817, "mean_action_processing_ms": 0.09057376941542557, "mean_env_wait_ms": 1.5301489376757456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006373882293701172, "StateBufferConnector_ms": 0.0032448768615722656, "ViewRequirementAgentConnector_ms": 0.08433079719543457}, "num_episodes": 24, "episode_return_max": 709.1250000000014, "episode_return_min": 499.6833333333343, "episode_return_mean": 611.5917500000011, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 85950, "num_agent_steps_trained": 85800, "num_env_steps_sampled": 85950, "num_env_steps_trained": 85800, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 250.3009960998776, "num_env_steps_trained_throughput_per_sec": 265.02458410575275, "timesteps_total": 85950, "num_env_steps_sampled_lifetime": 85950, "num_agent_steps_sampled_lifetime": 85950, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 85950, "timers": {"training_iteration_time_ms": 10282.935, "restore_workers_time_ms": 0.014, "training_step_time_ms": 596.365, "sample_time_ms": 580.95, "synch_weights_time_ms": 14.012}, "counters": {"num_env_steps_sampled": 85950, "num_env_steps_trained": 85800, "num_agent_steps_sampled": 85950, "num_agent_steps_trained": 85800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 573, "num_samples_added_to_queue": 85800}, "done": false, "training_iteration": 34, "trial_id": "27800_00000", "date": "2024-10-12_15-33-40", "timestamp": 1728743620, "time_this_iter_s": 10.199855089187622, "time_total_s": 350.2096371650696, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a945ee0ee0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 350.2096371650696, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 16.27857142857143, "ram_util_percent": 34.18571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 492617.28125, "policy_loss": 483059.6875, "entropy": 24.115266799926758, "entropy_coeff": 0.01, "var_gnorm": 16.313350677490234, "vf_loss": 962995.0, "vf_explained_var": 0.046852290630340576}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 294.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 88500, "num_env_steps_trained": 88200, "num_agent_steps_sampled": 88500, "num_agent_steps_trained": 88200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 590, "num_samples_added_to_queue": 88500, "learner_queue": {"size_count": 294, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.79, "learner_load_time_ms": 0.317, "learner_load_wait_time_ms": 1157.1, "learner_dequeue_time_ms": 9742.221}}, "env_runners": {"episode_reward_max": 744.8166666666689, "episode_reward_min": 538.2416666666677, "episode_reward_mean": 641.1313333333345, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 538.2416666666677}, "policy_reward_max": {"default_policy": 744.8166666666689}, "policy_reward_mean": {"default_policy": 641.1313333333345}, "custom_metrics": {"num_consolidated_mean": 1.6314000000000002, "num_consolidated_min": 1.39, "num_consolidated_max": 1.89, "num_overloaded_mean": 0.0947, "num_overloaded_min": 0.04, "num_overloaded_max": 0.17, "num_moves_mean": 8.5201, "num_moves_min": 7.94, "num_moves_max": 9.06, "mean_accuracy_mean": 41.909906666666664, "mean_accuracy_min": 41.53066666666667, "mean_accuracy_max": 42.360333333333344, "num_model_switches_mean": 5.165799999999999, "num_model_switches_min": 4.74, "num_model_switches_max": 5.66, "num_slav_mean": 0.14683850000000004, "num_slav_min": 0.12806666666666666, "num_slav_max": 0.16426666666666667, "cpu_conserved_cost_mean": 3.7976, "cpu_conserved_cost_min": 3.18, "cpu_conserved_cost_max": 4.52, "mean_cluster_cpu_util_mean": 0.4752943020730926, "mean_cluster_cpu_util_min": 0.46667954859037164, "mean_cluster_cpu_util_max": 0.4873594979188637, "mean_cluster_mem_util_mean": 0.3118003503760154, "mean_cluster_mem_util_min": 0.3050052170340711, "mean_cluster_mem_util_max": 0.3187502689155831, "reward_consolidation_mean_mean": 3.0814583333333325, "reward_consolidation_mean_min": 2.437499999999999, "reward_consolidation_mean_max": 3.5625, "reward_illegal_mean_mean": -0.15783333333333333, "reward_illegal_mean_min": -0.2833333333333333, "reward_illegal_mean_max": -0.06666666666666667, "reward_accuracy_mean_mean": 5.476583333333346, "reward_accuracy_mean_min": 4.991666666666677, "reward_accuracy_mean_max": 6.08333333333335, "reward_sla_mean_mean": -1.988895, "reward_sla_mean_min": -2.2645, "reward_sla_mean_max": -1.7327499999999998, "reward_consolidation_sum_mean": 308.14583333333326, "reward_consolidation_sum_min": 243.74999999999991, "reward_consolidation_sum_max": 356.25, "reward_illegal_sum_mean": -15.783333333333333, "reward_illegal_sum_min": -28.333333333333332, "reward_illegal_sum_max": -6.666666666666666, "reward_accuracy_sum_mean": 547.6583333333346, "reward_accuracy_sum_min": 499.1666666666677, "reward_accuracy_sum_max": 608.333333333335, "reward_sla_sum_mean": -198.88950000000006, "reward_sla_sum_min": -226.45000000000002, "reward_sla_sum_max": -173.27499999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4482.0, "global_timestep_min": 2800, "global_timestep_max": 6100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [586.4666666666677, 619.4416666666673, 571.8750000000009, 538.2416666666677, 554.3833333333345, 595.3916666666674, 622.5666666666674, 622.3583333333339, 632.8000000000008, 608.1250000000015, 552.9666666666676, 566.5833333333345, 667.625000000001, 591.5083333333345, 591.4333333333341, 610.5666666666677, 593.5833333333345, 607.0833333333339, 588.9666666666677, 625.2416666666675, 638.1000000000014, 624.5250000000011, 613.5250000000009, 633.2416666666678, 663.0166666666678, 615.9166666666678, 620.2166666666677, 612.6666666666675, 582.975000000001, 670.3833333333343, 630.9333333333348, 609.1083333333343, 676.416666666668, 561.4000000000011, 646.9000000000012, 629.1333333333341, 697.0166666666679, 595.2250000000012, 669.316666666668, 596.900000000001, 635.0750000000007, 636.1166666666678, 605.9916666666679, 614.575000000001, 662.6666666666679, 603.0833333333345, 619.9416666666677, 667.7416666666684, 602.975000000001, 628.6666666666679, 610.8250000000016, 636.7083333333346, 694.2666666666677, 619.0750000000015, 687.5000000000009, 709.1250000000014, 667.5333333333347, 650.9166666666682, 691.3583333333348, 680.5583333333345, 593.1500000000016, 628.5583333333346, 578.0000000000009, 620.8166666666677, 619.1750000000012, 597.8666666666677, 681.2333333333347, 681.9500000000013, 642.9000000000013, 651.833333333335, 633.0250000000013, 635.2750000000015, 650.9583333333344, 703.7666666666674, 729.7333333333347, 675.7583333333347, 702.5000000000014, 730.2583333333349, 678.0000000000015, 658.7000000000015, 681.0583333333346, 744.8166666666689, 658.1166666666676, 641.1333333333346, 646.6583333333343, 670.9750000000014, 670.2083333333347, 667.0666666666681, 708.2833333333347, 691.8250000000015, 660.9750000000012, 672.5416666666678, 644.616666666668, 710.1916666666683, 608.9416666666676, 729.3416666666683, 723.291666666668, 663.3083333333348, 694.9583333333346, 672.5416666666682], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [586.4666666666677, 619.4416666666673, 571.8750000000009, 538.2416666666677, 554.3833333333345, 595.3916666666674, 622.5666666666674, 622.3583333333339, 632.8000000000008, 608.1250000000015, 552.9666666666676, 566.5833333333345, 667.625000000001, 591.5083333333345, 591.4333333333341, 610.5666666666677, 593.5833333333345, 607.0833333333339, 588.9666666666677, 625.2416666666675, 638.1000000000014, 624.5250000000011, 613.5250000000009, 633.2416666666678, 663.0166666666678, 615.9166666666678, 620.2166666666677, 612.6666666666675, 582.975000000001, 670.3833333333343, 630.9333333333348, 609.1083333333343, 676.416666666668, 561.4000000000011, 646.9000000000012, 629.1333333333341, 697.0166666666679, 595.2250000000012, 669.316666666668, 596.900000000001, 635.0750000000007, 636.1166666666678, 605.9916666666679, 614.575000000001, 662.6666666666679, 603.0833333333345, 619.9416666666677, 667.7416666666684, 602.975000000001, 628.6666666666679, 610.8250000000016, 636.7083333333346, 694.2666666666677, 619.0750000000015, 687.5000000000009, 709.1250000000014, 667.5333333333347, 650.9166666666682, 691.3583333333348, 680.5583333333345, 593.1500000000016, 628.5583333333346, 578.0000000000009, 620.8166666666677, 619.1750000000012, 597.8666666666677, 681.2333333333347, 681.9500000000013, 642.9000000000013, 651.833333333335, 633.0250000000013, 635.2750000000015, 650.9583333333344, 703.7666666666674, 729.7333333333347, 675.7583333333347, 702.5000000000014, 730.2583333333349, 678.0000000000015, 658.7000000000015, 681.0583333333346, 744.8166666666689, 658.1166666666676, 641.1333333333346, 646.6583333333343, 670.9750000000014, 670.2083333333347, 667.0666666666681, 708.2833333333347, 691.8250000000015, 660.9750000000012, 672.5416666666678, 644.616666666668, 710.1916666666683, 608.9416666666676, 729.3416666666683, 723.291666666668, 663.3083333333348, 694.9583333333346, 672.5416666666682]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24062938989284233, "mean_inference_ms": 2.0476062524910064, "mean_action_processing_ms": 0.09057462370774136, "mean_env_wait_ms": 1.5302364450808539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006467580795288086, "StateBufferConnector_ms": 0.0032536983489990234, "ViewRequirementAgentConnector_ms": 0.08428764343261719}, "num_episodes": 27, "episode_return_max": 744.8166666666689, "episode_return_min": 538.2416666666677, "episode_return_mean": 641.1313333333345, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88500, "num_agent_steps_trained": 88200, "num_env_steps_sampled": 88500, "num_env_steps_trained": 88200, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 245.32520166693533, "num_env_steps_trained_throughput_per_sec": 230.89430745123326, "timesteps_total": 88500, "num_env_steps_sampled_lifetime": 88500, "num_agent_steps_sampled_lifetime": 88500, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 88500, "timers": {"training_iteration_time_ms": 10309.749, "restore_workers_time_ms": 0.012, "training_step_time_ms": 618.834, "sample_time_ms": 603.82, "synch_weights_time_ms": 13.425}, "counters": {"num_env_steps_sampled": 88500, "num_env_steps_trained": 88200, "num_agent_steps_sampled": 88500, "num_agent_steps_trained": 88200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 590, "num_samples_added_to_queue": 88500}, "done": false, "training_iteration": 35, "trial_id": "27800_00000", "date": "2024-10-12_15-33-51", "timestamp": 1728743631, "time_this_iter_s": 10.406668424606323, "time_total_s": 360.6163055896759, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f683a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 360.6163055896759, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 16.453333333333333, "ram_util_percent": 34.393333333333324}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 475885.53125, "policy_loss": 466473.125, "entropy": 23.7639102935791, "entropy_coeff": 0.01, "var_gnorm": 16.322677612304688, "vf_loss": 948367.8125, "vf_explained_var": 0.04937654733657837}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 303.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 91050, "num_env_steps_trained": 90900, "num_agent_steps_sampled": 91050, "num_agent_steps_trained": 90900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 607, "num_samples_added_to_queue": 90900, "learner_queue": {"size_count": 303, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.594, "learner_load_time_ms": 0.295, "learner_load_wait_time_ms": 1172.37, "learner_dequeue_time_ms": 9742.439}}, "env_runners": {"episode_reward_max": 775.233333333335, "episode_reward_min": 561.4000000000011, "episode_reward_mean": 666.3685000000014, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 561.4000000000011}, "policy_reward_max": {"default_policy": 775.233333333335}, "policy_reward_mean": {"default_policy": 666.3685000000014}, "custom_metrics": {"num_consolidated_mean": 1.6884000000000001, "num_consolidated_min": 1.42, "num_consolidated_max": 1.9, "num_overloaded_mean": 0.08760000000000001, "num_overloaded_min": 0.04, "num_overloaded_max": 0.17, "num_moves_mean": 8.4096, "num_moves_min": 7.94, "num_moves_max": 8.99, "mean_accuracy_mean": 41.97381, "mean_accuracy_min": 41.66366666666667, "mean_accuracy_max": 42.360333333333344, "num_model_switches_mean": 5.077500000000001, "num_model_switches_min": 4.44, "num_model_switches_max": 5.64, "num_slav_mean": 0.14649966666666667, "num_slav_min": 0.12806666666666666, "num_slav_max": 0.1638, "cpu_conserved_cost_mean": 3.9149999999999996, "cpu_conserved_cost_min": 3.3, "cpu_conserved_cost_max": 4.52, "mean_cluster_cpu_util_mean": 0.4747471904378769, "mean_cluster_cpu_util_min": 0.4626603342732205, "mean_cluster_cpu_util_max": 0.483178034381201, "mean_cluster_mem_util_mean": 0.31097009691545396, "mean_cluster_mem_util_min": 0.30348363794885047, "mean_cluster_mem_util_max": 0.3183463351057722, "reward_consolidation_mean_mean": 3.2114583333333333, "reward_consolidation_mean_min": 2.6666666666666656, "reward_consolidation_mean_max": 3.729166666666666, "reward_illegal_mean_mean": -0.146, "reward_illegal_mean_min": -0.2833333333333333, "reward_illegal_mean_max": -0.06666666666666667, "reward_accuracy_mean_mean": 5.59716666666668, "reward_accuracy_mean_min": 5.008333333333344, "reward_accuracy_mean_max": 6.216666666666684, "reward_sla_mean_mean": -1.9989400000000004, "reward_sla_mean_min": -2.23, "reward_sla_mean_max": -1.7327499999999998, "reward_consolidation_sum_mean": 321.14583333333326, "reward_consolidation_sum_min": 266.6666666666666, "reward_consolidation_sum_max": 372.91666666666663, "reward_illegal_sum_mean": -14.599999999999996, "reward_illegal_sum_min": -28.333333333333332, "reward_illegal_sum_max": -6.666666666666666, "reward_accuracy_sum_mean": 559.716666666668, "reward_accuracy_sum_min": 500.83333333333445, "reward_accuracy_sum_max": 621.6666666666683, "reward_sla_sum_mean": -199.89399999999998, "reward_sla_sum_min": -223.0, "reward_sla_sum_max": -173.27499999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5282.0, "global_timestep_min": 3600, "global_timestep_max": 6900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [663.0166666666678, 615.9166666666678, 620.2166666666677, 612.6666666666675, 582.975000000001, 670.3833333333343, 630.9333333333348, 609.1083333333343, 676.416666666668, 561.4000000000011, 646.9000000000012, 629.1333333333341, 697.0166666666679, 595.2250000000012, 669.316666666668, 596.900000000001, 635.0750000000007, 636.1166666666678, 605.9916666666679, 614.575000000001, 662.6666666666679, 603.0833333333345, 619.9416666666677, 667.7416666666684, 602.975000000001, 628.6666666666679, 610.8250000000016, 636.7083333333346, 694.2666666666677, 619.0750000000015, 687.5000000000009, 709.1250000000014, 667.5333333333347, 650.9166666666682, 691.3583333333348, 680.5583333333345, 593.1500000000016, 628.5583333333346, 578.0000000000009, 620.8166666666677, 619.1750000000012, 597.8666666666677, 681.2333333333347, 681.9500000000013, 642.9000000000013, 651.833333333335, 633.0250000000013, 635.2750000000015, 650.9583333333344, 703.7666666666674, 729.7333333333347, 675.7583333333347, 702.5000000000014, 730.2583333333349, 678.0000000000015, 658.7000000000015, 681.0583333333346, 744.8166666666689, 658.1166666666676, 641.1333333333346, 646.6583333333343, 670.9750000000014, 670.2083333333347, 667.0666666666681, 708.2833333333347, 691.8250000000015, 660.9750000000012, 672.5416666666678, 644.616666666668, 710.1916666666683, 608.9416666666676, 729.3416666666683, 723.291666666668, 663.3083333333348, 694.9583333333346, 672.5416666666682, 672.2916666666679, 704.3500000000015, 685.3166666666681, 680.366666666668, 722.883333333335, 676.7583333333341, 739.9666666666676, 678.550000000001, 685.6000000000012, 705.5500000000012, 719.1166666666679, 764.7000000000021, 775.233333333335, 728.833333333335, 666.9833333333346, 701.991666666668, 705.3833333333347, 681.7166666666683, 714.0083333333346, 695.2916666666679, 698.8750000000017, 723.5750000000015, 697.5916666666683, 755.3833333333349], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [663.0166666666678, 615.9166666666678, 620.2166666666677, 612.6666666666675, 582.975000000001, 670.3833333333343, 630.9333333333348, 609.1083333333343, 676.416666666668, 561.4000000000011, 646.9000000000012, 629.1333333333341, 697.0166666666679, 595.2250000000012, 669.316666666668, 596.900000000001, 635.0750000000007, 636.1166666666678, 605.9916666666679, 614.575000000001, 662.6666666666679, 603.0833333333345, 619.9416666666677, 667.7416666666684, 602.975000000001, 628.6666666666679, 610.8250000000016, 636.7083333333346, 694.2666666666677, 619.0750000000015, 687.5000000000009, 709.1250000000014, 667.5333333333347, 650.9166666666682, 691.3583333333348, 680.5583333333345, 593.1500000000016, 628.5583333333346, 578.0000000000009, 620.8166666666677, 619.1750000000012, 597.8666666666677, 681.2333333333347, 681.9500000000013, 642.9000000000013, 651.833333333335, 633.0250000000013, 635.2750000000015, 650.9583333333344, 703.7666666666674, 729.7333333333347, 675.7583333333347, 702.5000000000014, 730.2583333333349, 678.0000000000015, 658.7000000000015, 681.0583333333346, 744.8166666666689, 658.1166666666676, 641.1333333333346, 646.6583333333343, 670.9750000000014, 670.2083333333347, 667.0666666666681, 708.2833333333347, 691.8250000000015, 660.9750000000012, 672.5416666666678, 644.616666666668, 710.1916666666683, 608.9416666666676, 729.3416666666683, 723.291666666668, 663.3083333333348, 694.9583333333346, 672.5416666666682, 672.2916666666679, 704.3500000000015, 685.3166666666681, 680.366666666668, 722.883333333335, 676.7583333333341, 739.9666666666676, 678.550000000001, 685.6000000000012, 705.5500000000012, 719.1166666666679, 764.7000000000021, 775.233333333335, 728.833333333335, 666.9833333333346, 701.991666666668, 705.3833333333347, 681.7166666666683, 714.0083333333346, 695.2916666666679, 698.8750000000017, 723.5750000000015, 697.5916666666683, 755.3833333333349]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24066591414963873, "mean_inference_ms": 2.0472174754607795, "mean_action_processing_ms": 0.09058019131949785, "mean_env_wait_ms": 1.5303838373995817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066187381744384766, "StateBufferConnector_ms": 0.003231048583984375, "ViewRequirementAgentConnector_ms": 0.08400106430053711}, "num_episodes": 24, "episode_return_max": 775.233333333335, "episode_return_min": 561.4000000000011, "episode_return_mean": 666.3685000000014, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91050, "num_agent_steps_trained": 90900, "num_env_steps_sampled": 91050, "num_env_steps_trained": 90900, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 244.2815800367025, "num_env_steps_trained_throughput_per_sec": 258.65108474474386, "timesteps_total": 91050, "num_env_steps_sampled_lifetime": 91050, "num_agent_steps_sampled_lifetime": 91050, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 91050, "timers": {"training_iteration_time_ms": 10322.746, "restore_workers_time_ms": 0.015, "training_step_time_ms": 624.247, "sample_time_ms": 609.685, "synch_weights_time_ms": 13.066}, "counters": {"num_env_steps_sampled": 91050, "num_env_steps_trained": 90900, "num_agent_steps_sampled": 91050, "num_agent_steps_trained": 90900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 607, "num_samples_added_to_queue": 90900}, "done": false, "training_iteration": 36, "trial_id": "27800_00000", "date": "2024-10-12_15-34-01", "timestamp": 1728743641, "time_this_iter_s": 10.453205823898315, "time_total_s": 371.0695114135742, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a945ee1ea0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 371.0695114135742, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 16.466666666666665, "ram_util_percent": 34.573333333333345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 480788.25, "policy_loss": 470670.75, "entropy": 23.569976806640625, "entropy_coeff": 0.01, "var_gnorm": 16.330026626586914, "vf_loss": 1018821.9375, "vf_explained_var": 0.04939687252044678}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 311.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 93600, "num_env_steps_trained": 93300, "num_agent_steps_sampled": 93600, "num_agent_steps_trained": 93300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 624, "num_samples_added_to_queue": 93600, "learner_queue": {"size_count": 311, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.726, "learner_load_time_ms": 0.319, "learner_load_wait_time_ms": 1180.481, "learner_dequeue_time_ms": 9759.166}}, "env_runners": {"episode_reward_max": 775.233333333335, "episode_reward_min": 578.0000000000009, "episode_reward_mean": 689.1575833333346, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 578.0000000000009}, "policy_reward_max": {"default_policy": 775.233333333335}, "policy_reward_mean": {"default_policy": 689.1575833333346}, "custom_metrics": {"num_consolidated_mean": 1.7483000000000002, "num_consolidated_min": 1.57, "num_consolidated_max": 1.95, "num_overloaded_mean": 0.0833, "num_overloaded_min": 0.01, "num_overloaded_max": 0.19, "num_moves_mean": 8.316400000000002, "num_moves_min": 7.88, "num_moves_max": 8.85, "mean_accuracy_mean": 42.02409666666667, "mean_accuracy_min": 41.66366666666667, "mean_accuracy_max": 42.360333333333344, "num_model_switches_mean": 5.005799999999999, "num_model_switches_min": 4.44, "num_model_switches_max": 5.43, "num_slav_mean": 0.145158, "num_slav_min": 0.12716666666666668, "num_slav_max": 0.16449999999999998, "cpu_conserved_cost_mean": 4.0486, "cpu_conserved_cost_min": 3.52, "cpu_conserved_cost_max": 4.66, "mean_cluster_cpu_util_mean": 0.4747453310296093, "mean_cluster_cpu_util_min": 0.4626603342732205, "mean_cluster_cpu_util_max": 0.4835609294339147, "mean_cluster_mem_util_mean": 0.31040135484837394, "mean_cluster_mem_util_min": 0.30348363794885047, "mean_cluster_mem_util_max": 0.3176717757039525, "reward_consolidation_mean_mean": 3.338333333333333, "reward_consolidation_mean_min": 2.895833333333333, "reward_consolidation_mean_max": 3.7499999999999996, "reward_illegal_mean_mean": -0.1388333333333333, "reward_illegal_mean_min": -0.31666666666666665, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 5.6823333333333474, "reward_accuracy_mean_min": 5.058333333333344, "reward_accuracy_mean_max": 6.216666666666684, "reward_sla_mean_mean": -1.9902574999999998, "reward_sla_mean_min": -2.27925, "reward_sla_mean_max": -1.715, "reward_consolidation_sum_mean": 333.83333333333326, "reward_consolidation_sum_min": 289.5833333333333, "reward_consolidation_sum_max": 374.99999999999994, "reward_illegal_sum_mean": -13.883333333333331, "reward_illegal_sum_min": -31.666666666666664, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 568.2333333333346, "reward_accuracy_sum_min": 505.83333333333445, "reward_accuracy_sum_max": 621.6666666666683, "reward_sla_sum_mean": -199.02574999999996, "reward_sla_sum_min": -227.925, "reward_sla_sum_max": -171.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6182.0, "global_timestep_min": 4500, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [636.7083333333346, 694.2666666666677, 619.0750000000015, 687.5000000000009, 709.1250000000014, 667.5333333333347, 650.9166666666682, 691.3583333333348, 680.5583333333345, 593.1500000000016, 628.5583333333346, 578.0000000000009, 620.8166666666677, 619.1750000000012, 597.8666666666677, 681.2333333333347, 681.9500000000013, 642.9000000000013, 651.833333333335, 633.0250000000013, 635.2750000000015, 650.9583333333344, 703.7666666666674, 729.7333333333347, 675.7583333333347, 702.5000000000014, 730.2583333333349, 678.0000000000015, 658.7000000000015, 681.0583333333346, 744.8166666666689, 658.1166666666676, 641.1333333333346, 646.6583333333343, 670.9750000000014, 670.2083333333347, 667.0666666666681, 708.2833333333347, 691.8250000000015, 660.9750000000012, 672.5416666666678, 644.616666666668, 710.1916666666683, 608.9416666666676, 729.3416666666683, 723.291666666668, 663.3083333333348, 694.9583333333346, 672.5416666666682, 672.2916666666679, 704.3500000000015, 685.3166666666681, 680.366666666668, 722.883333333335, 676.7583333333341, 739.9666666666676, 678.550000000001, 685.6000000000012, 705.5500000000012, 719.1166666666679, 764.7000000000021, 775.233333333335, 728.833333333335, 666.9833333333346, 701.991666666668, 705.3833333333347, 681.7166666666683, 714.0083333333346, 695.2916666666679, 698.8750000000017, 723.5750000000015, 697.5916666666683, 755.3833333333349, 706.408333333335, 746.9916666666684, 762.3416666666684, 732.5833333333347, 686.8916666666679, 642.5833333333345, 744.7500000000015, 724.6666666666682, 708.9416666666677, 652.6833333333345, 745.4166666666682, 683.5333333333346, 716.6333333333349, 701.4666666666676, 630.8750000000015, 735.7333333333347, 715.6083333333347, 758.3916666666685, 745.2000000000016, 727.308333333335, 767.7083333333352, 702.2083333333347, 682.7500000000015, 701.1250000000013, 738.3250000000018, 733.1750000000015, 649.7916666666679], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [636.7083333333346, 694.2666666666677, 619.0750000000015, 687.5000000000009, 709.1250000000014, 667.5333333333347, 650.9166666666682, 691.3583333333348, 680.5583333333345, 593.1500000000016, 628.5583333333346, 578.0000000000009, 620.8166666666677, 619.1750000000012, 597.8666666666677, 681.2333333333347, 681.9500000000013, 642.9000000000013, 651.833333333335, 633.0250000000013, 635.2750000000015, 650.9583333333344, 703.7666666666674, 729.7333333333347, 675.7583333333347, 702.5000000000014, 730.2583333333349, 678.0000000000015, 658.7000000000015, 681.0583333333346, 744.8166666666689, 658.1166666666676, 641.1333333333346, 646.6583333333343, 670.9750000000014, 670.2083333333347, 667.0666666666681, 708.2833333333347, 691.8250000000015, 660.9750000000012, 672.5416666666678, 644.616666666668, 710.1916666666683, 608.9416666666676, 729.3416666666683, 723.291666666668, 663.3083333333348, 694.9583333333346, 672.5416666666682, 672.2916666666679, 704.3500000000015, 685.3166666666681, 680.366666666668, 722.883333333335, 676.7583333333341, 739.9666666666676, 678.550000000001, 685.6000000000012, 705.5500000000012, 719.1166666666679, 764.7000000000021, 775.233333333335, 728.833333333335, 666.9833333333346, 701.991666666668, 705.3833333333347, 681.7166666666683, 714.0083333333346, 695.2916666666679, 698.8750000000017, 723.5750000000015, 697.5916666666683, 755.3833333333349, 706.408333333335, 746.9916666666684, 762.3416666666684, 732.5833333333347, 686.8916666666679, 642.5833333333345, 744.7500000000015, 724.6666666666682, 708.9416666666677, 652.6833333333345, 745.4166666666682, 683.5333333333346, 716.6333333333349, 701.4666666666676, 630.8750000000015, 735.7333333333347, 715.6083333333347, 758.3916666666685, 745.2000000000016, 727.308333333335, 767.7083333333352, 702.2083333333347, 682.7500000000015, 701.1250000000013, 738.3250000000018, 733.1750000000015, 649.7916666666679]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24068925045008402, "mean_inference_ms": 2.0469158428054213, "mean_action_processing_ms": 0.09057913778098388, "mean_env_wait_ms": 1.530521763784408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006951808929443359, "StateBufferConnector_ms": 0.0032351016998291016, "ViewRequirementAgentConnector_ms": 0.08408284187316895}, "num_episodes": 27, "episode_return_max": 775.233333333335, "episode_return_min": 578.0000000000009, "episode_return_mean": 689.1575833333346, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93600, "num_agent_steps_trained": 93300, "num_env_steps_sampled": 93600, "num_env_steps_trained": 93300, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 243.77952105503908, "num_env_steps_trained_throughput_per_sec": 229.43954922827209, "timesteps_total": 93600, "num_env_steps_sampled_lifetime": 93600, "num_agent_steps_sampled_lifetime": 93600, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 93600, "timers": {"training_iteration_time_ms": 10344.025, "restore_workers_time_ms": 0.014, "training_step_time_ms": 624.257, "sample_time_ms": 608.072, "synch_weights_time_ms": 14.706}, "counters": {"num_env_steps_sampled": 93600, "num_env_steps_trained": 93300, "num_agent_steps_sampled": 93600, "num_agent_steps_trained": 93300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 624, "num_samples_added_to_queue": 93600}, "done": false, "training_iteration": 37, "trial_id": "27800_00000", "date": "2024-10-12_15-34-12", "timestamp": 1728743652, "time_this_iter_s": 10.474066972732544, "time_total_s": 381.54357838630676, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a945ee19c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 381.54357838630676, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 16.586666666666666, "ram_util_percent": 34.74666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 490313.0, "policy_loss": 479188.6875, "entropy": 22.883520126342773, "entropy_coeff": 0.01, "var_gnorm": 16.337764739990234, "vf_loss": 1119295.625, "vf_explained_var": 0.055940091609954834}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 320.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 96150, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96150, "num_agent_steps_trained": 96000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 641, "num_samples_added_to_queue": 96000, "learner_queue": {"size_count": 320, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.446, "learner_load_time_ms": 0.347, "learner_load_wait_time_ms": 1155.743, "learner_dequeue_time_ms": 9777.029}}, "env_runners": {"episode_reward_max": 831.1916666666682, "episode_reward_min": 608.9416666666676, "episode_reward_mean": 714.5847500000013, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 608.9416666666676}, "policy_reward_max": {"default_policy": 831.1916666666682}, "policy_reward_mean": {"default_policy": 714.5847500000013}, "custom_metrics": {"num_consolidated_mean": 1.7994000000000003, "num_consolidated_min": 1.57, "num_consolidated_max": 2.05, "num_overloaded_mean": 0.07549999999999998, "num_overloaded_min": 0.01, "num_overloaded_max": 0.19, "num_moves_mean": 8.232000000000001, "num_moves_min": 7.75, "num_moves_max": 8.81, "mean_accuracy_mean": 42.073813333333334, "mean_accuracy_min": 41.82200000000001, "mean_accuracy_max": 42.360333333333344, "num_model_switches_mean": 4.9011, "num_model_switches_min": 4.44, "num_model_switches_max": 5.32, "num_slav_mean": 0.14313166666666663, "num_slav_min": 0.12018333333333332, "num_slav_max": 0.16449999999999998, "cpu_conserved_cost_mean": 4.1686000000000005, "cpu_conserved_cost_min": 3.64, "cpu_conserved_cost_max": 4.9, "mean_cluster_cpu_util_mean": 0.474891581974498, "mean_cluster_cpu_util_min": 0.4626603342732205, "mean_cluster_cpu_util_max": 0.48480027686365124, "mean_cluster_mem_util_mean": 0.31015556731680016, "mean_cluster_mem_util_min": 0.30348363794885047, "mean_cluster_mem_util_max": 0.3176717757039525, "reward_consolidation_mean_mean": 3.4577083333333327, "reward_consolidation_mean_min": 2.916666666666666, "reward_consolidation_mean_max": 4.083333333333333, "reward_illegal_mean_mean": -0.12583333333333332, "reward_illegal_mean_min": -0.31666666666666665, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 5.7952500000000144, "reward_accuracy_mean_min": 5.158333333333345, "reward_accuracy_mean_max": 6.38333333333335, "reward_sla_mean_mean": -1.9812775, "reward_sla_mean_min": -2.27925, "reward_sla_mean_max": -1.715, "reward_consolidation_sum_mean": 345.77083333333326, "reward_consolidation_sum_min": 291.66666666666663, "reward_consolidation_sum_max": 408.3333333333333, "reward_illegal_sum_mean": -12.583333333333336, "reward_illegal_sum_min": -31.666666666666664, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 579.5250000000015, "reward_accuracy_sum_min": 515.8333333333345, "reward_accuracy_sum_max": 638.333333333335, "reward_sla_sum_mean": -198.12775, "reward_sla_sum_min": -227.925, "reward_sla_sum_max": -171.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5110.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [675.7583333333347, 702.5000000000014, 730.2583333333349, 678.0000000000015, 658.7000000000015, 681.0583333333346, 744.8166666666689, 658.1166666666676, 641.1333333333346, 646.6583333333343, 670.9750000000014, 670.2083333333347, 667.0666666666681, 708.2833333333347, 691.8250000000015, 660.9750000000012, 672.5416666666678, 644.616666666668, 710.1916666666683, 608.9416666666676, 729.3416666666683, 723.291666666668, 663.3083333333348, 694.9583333333346, 672.5416666666682, 672.2916666666679, 704.3500000000015, 685.3166666666681, 680.366666666668, 722.883333333335, 676.7583333333341, 739.9666666666676, 678.550000000001, 685.6000000000012, 705.5500000000012, 719.1166666666679, 764.7000000000021, 775.233333333335, 728.833333333335, 666.9833333333346, 701.991666666668, 705.3833333333347, 681.7166666666683, 714.0083333333346, 695.2916666666679, 698.8750000000017, 723.5750000000015, 697.5916666666683, 755.3833333333349, 706.408333333335, 746.9916666666684, 762.3416666666684, 732.5833333333347, 686.8916666666679, 642.5833333333345, 744.7500000000015, 724.6666666666682, 708.9416666666677, 652.6833333333345, 745.4166666666682, 683.5333333333346, 716.6333333333349, 701.4666666666676, 630.8750000000015, 735.7333333333347, 715.6083333333347, 758.3916666666685, 745.2000000000016, 727.308333333335, 767.7083333333352, 702.2083333333347, 682.7500000000015, 701.1250000000013, 738.3250000000018, 733.1750000000015, 649.7916666666679, 728.5083333333346, 792.1750000000012, 747.4750000000013, 761.0416666666682, 797.1500000000013, 782.5750000000012, 831.1916666666682, 761.0166666666679, 712.3416666666683, 779.5750000000016, 728.5166666666684, 737.016666666668, 734.7166666666683, 783.9916666666676, 717.5333333333346, 756.400000000002, 802.7500000000018, 769.4250000000011, 695.1333333333347, 724.4500000000016, 766.9083333333349, 794.0000000000019, 747.7833333333351, 776.3250000000015], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [675.7583333333347, 702.5000000000014, 730.2583333333349, 678.0000000000015, 658.7000000000015, 681.0583333333346, 744.8166666666689, 658.1166666666676, 641.1333333333346, 646.6583333333343, 670.9750000000014, 670.2083333333347, 667.0666666666681, 708.2833333333347, 691.8250000000015, 660.9750000000012, 672.5416666666678, 644.616666666668, 710.1916666666683, 608.9416666666676, 729.3416666666683, 723.291666666668, 663.3083333333348, 694.9583333333346, 672.5416666666682, 672.2916666666679, 704.3500000000015, 685.3166666666681, 680.366666666668, 722.883333333335, 676.7583333333341, 739.9666666666676, 678.550000000001, 685.6000000000012, 705.5500000000012, 719.1166666666679, 764.7000000000021, 775.233333333335, 728.833333333335, 666.9833333333346, 701.991666666668, 705.3833333333347, 681.7166666666683, 714.0083333333346, 695.2916666666679, 698.8750000000017, 723.5750000000015, 697.5916666666683, 755.3833333333349, 706.408333333335, 746.9916666666684, 762.3416666666684, 732.5833333333347, 686.8916666666679, 642.5833333333345, 744.7500000000015, 724.6666666666682, 708.9416666666677, 652.6833333333345, 745.4166666666682, 683.5333333333346, 716.6333333333349, 701.4666666666676, 630.8750000000015, 735.7333333333347, 715.6083333333347, 758.3916666666685, 745.2000000000016, 727.308333333335, 767.7083333333352, 702.2083333333347, 682.7500000000015, 701.1250000000013, 738.3250000000018, 733.1750000000015, 649.7916666666679, 728.5083333333346, 792.1750000000012, 747.4750000000013, 761.0416666666682, 797.1500000000013, 782.5750000000012, 831.1916666666682, 761.0166666666679, 712.3416666666683, 779.5750000000016, 728.5166666666684, 737.016666666668, 734.7166666666683, 783.9916666666676, 717.5333333333346, 756.400000000002, 802.7500000000018, 769.4250000000011, 695.1333333333347, 724.4500000000016, 766.9083333333349, 794.0000000000019, 747.7833333333351, 776.3250000000015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2407158415095436, "mean_inference_ms": 2.0466748845070954, "mean_action_processing_ms": 0.09057498297538785, "mean_env_wait_ms": 1.5305703959399242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070056915283203125, "StateBufferConnector_ms": 0.0032672882080078125, "ViewRequirementAgentConnector_ms": 0.0852203369140625}, "num_episodes": 24, "episode_return_max": 831.1916666666682, "episode_return_min": 608.9416666666676, "episode_return_mean": 714.5847500000013, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96150, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96150, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 251.01989934913044, "num_env_steps_trained_throughput_per_sec": 265.7857757814322, "timesteps_total": 96150, "num_env_steps_sampled_lifetime": 96150, "num_agent_steps_sampled_lifetime": 96150, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 96150, "timers": {"training_iteration_time_ms": 10337.176, "restore_workers_time_ms": 0.014, "training_step_time_ms": 602.938, "sample_time_ms": 586.498, "synch_weights_time_ms": 15.015}, "counters": {"num_env_steps_sampled": 96150, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96150, "num_agent_steps_trained": 96000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 641, "num_samples_added_to_queue": 96000}, "done": false, "training_iteration": 38, "trial_id": "27800_00000", "date": "2024-10-12_15-34-22", "timestamp": 1728743662, "time_this_iter_s": 10.177761793136597, "time_total_s": 391.72134017944336, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c3a30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 391.72134017944336, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 16.486666666666668, "ram_util_percent": 34.940000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 488023.0, "policy_loss": 477417.25, "entropy": 22.805355072021484, "entropy_coeff": 0.01, "var_gnorm": 16.345111846923828, "vf_loss": 1067416.25, "vf_explained_var": 0.06643444299697876}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 328.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 98700, "num_env_steps_trained": 98400, "num_agent_steps_sampled": 98700, "num_agent_steps_trained": 98400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 658, "num_samples_added_to_queue": 98700, "learner_queue": {"size_count": 328, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.762, "learner_load_time_ms": 0.311, "learner_load_wait_time_ms": 1159.797, "learner_dequeue_time_ms": 9793.743}}, "env_runners": {"episode_reward_max": 831.1916666666682, "episode_reward_min": 630.8750000000015, "episode_reward_mean": 739.8444166666679, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 630.8750000000015}, "policy_reward_max": {"default_policy": 831.1916666666682}, "policy_reward_mean": {"default_policy": 739.8444166666679}, "custom_metrics": {"num_consolidated_mean": 1.8493000000000002, "num_consolidated_min": 1.66, "num_consolidated_max": 2.05, "num_overloaded_mean": 0.06709999999999999, "num_overloaded_min": 0.0, "num_overloaded_max": 0.19, "num_moves_mean": 8.1362, "num_moves_min": 7.56, "num_moves_max": 8.69, "mean_accuracy_mean": 42.11396666666668, "mean_accuracy_min": 41.82200000000001, "mean_accuracy_max": 42.37933333333335, "num_model_switches_mean": 4.7731, "num_model_switches_min": 4.18, "num_model_switches_max": 5.32, "num_slav_mean": 0.14132733333333333, "num_slav_min": 0.12018333333333332, "num_slav_max": 0.16449999999999998, "cpu_conserved_cost_mean": 4.281199999999999, "cpu_conserved_cost_min": 3.72, "cpu_conserved_cost_max": 4.9, "mean_cluster_cpu_util_mean": 0.4745660587190765, "mean_cluster_cpu_util_min": 0.4626603342732205, "mean_cluster_cpu_util_max": 0.48480027686365124, "mean_cluster_mem_util_mean": 0.30972806114376134, "mean_cluster_mem_util_min": 0.300153675658027, "mean_cluster_mem_util_max": 0.3176717757039525, "reward_consolidation_mean_mean": 3.5864583333333333, "reward_consolidation_mean_min": 3.1249999999999987, "reward_consolidation_mean_max": 4.083333333333333, "reward_illegal_mean_mean": -0.11183333333333331, "reward_illegal_mean_min": -0.31666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.899666666666682, "reward_accuracy_mean_min": 5.250000000000013, "reward_accuracy_mean_max": 6.391666666666683, "reward_sla_mean_mean": -1.9758474999999998, "reward_sla_mean_min": -2.27925, "reward_sla_mean_max": -1.715, "reward_consolidation_sum_mean": 358.64583333333326, "reward_consolidation_sum_min": 312.4999999999999, "reward_consolidation_sum_max": 408.3333333333333, "reward_illegal_sum_mean": -11.183333333333332, "reward_illegal_sum_min": -31.666666666666664, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 589.9666666666683, "reward_accuracy_sum_min": 525.0000000000014, "reward_accuracy_sum_max": 639.1666666666682, "reward_sla_sum_mean": -197.58475, "reward_sla_sum_min": -227.925, "reward_sla_sum_max": -171.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3904.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [685.3166666666681, 680.366666666668, 722.883333333335, 676.7583333333341, 739.9666666666676, 678.550000000001, 685.6000000000012, 705.5500000000012, 719.1166666666679, 764.7000000000021, 775.233333333335, 728.833333333335, 666.9833333333346, 701.991666666668, 705.3833333333347, 681.7166666666683, 714.0083333333346, 695.2916666666679, 698.8750000000017, 723.5750000000015, 697.5916666666683, 755.3833333333349, 706.408333333335, 746.9916666666684, 762.3416666666684, 732.5833333333347, 686.8916666666679, 642.5833333333345, 744.7500000000015, 724.6666666666682, 708.9416666666677, 652.6833333333345, 745.4166666666682, 683.5333333333346, 716.6333333333349, 701.4666666666676, 630.8750000000015, 735.7333333333347, 715.6083333333347, 758.3916666666685, 745.2000000000016, 727.308333333335, 767.7083333333352, 702.2083333333347, 682.7500000000015, 701.1250000000013, 738.3250000000018, 733.1750000000015, 649.7916666666679, 728.5083333333346, 792.1750000000012, 747.4750000000013, 761.0416666666682, 797.1500000000013, 782.5750000000012, 831.1916666666682, 761.0166666666679, 712.3416666666683, 779.5750000000016, 728.5166666666684, 737.016666666668, 734.7166666666683, 783.9916666666676, 717.5333333333346, 756.400000000002, 802.7500000000018, 769.4250000000011, 695.1333333333347, 724.4500000000016, 766.9083333333349, 794.0000000000019, 747.7833333333351, 776.3250000000015, 729.1833333333351, 814.2250000000015, 773.3000000000017, 752.0166666666682, 767.9750000000015, 777.8250000000018, 729.3000000000011, 763.7916666666683, 762.516666666668, 698.4083333333347, 820.3250000000014, 763.641666666668, 751.6333333333349, 801.4000000000015, 809.1250000000017, 774.666666666668, 763.9083333333347, 780.0333333333352, 782.4000000000016, 764.2750000000013, 794.1416666666684, 768.9833333333348, 795.2750000000017, 760.8083333333349, 812.508333333335, 810.6083333333355, 786.4000000000015], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [685.3166666666681, 680.366666666668, 722.883333333335, 676.7583333333341, 739.9666666666676, 678.550000000001, 685.6000000000012, 705.5500000000012, 719.1166666666679, 764.7000000000021, 775.233333333335, 728.833333333335, 666.9833333333346, 701.991666666668, 705.3833333333347, 681.7166666666683, 714.0083333333346, 695.2916666666679, 698.8750000000017, 723.5750000000015, 697.5916666666683, 755.3833333333349, 706.408333333335, 746.9916666666684, 762.3416666666684, 732.5833333333347, 686.8916666666679, 642.5833333333345, 744.7500000000015, 724.6666666666682, 708.9416666666677, 652.6833333333345, 745.4166666666682, 683.5333333333346, 716.6333333333349, 701.4666666666676, 630.8750000000015, 735.7333333333347, 715.6083333333347, 758.3916666666685, 745.2000000000016, 727.308333333335, 767.7083333333352, 702.2083333333347, 682.7500000000015, 701.1250000000013, 738.3250000000018, 733.1750000000015, 649.7916666666679, 728.5083333333346, 792.1750000000012, 747.4750000000013, 761.0416666666682, 797.1500000000013, 782.5750000000012, 831.1916666666682, 761.0166666666679, 712.3416666666683, 779.5750000000016, 728.5166666666684, 737.016666666668, 734.7166666666683, 783.9916666666676, 717.5333333333346, 756.400000000002, 802.7500000000018, 769.4250000000011, 695.1333333333347, 724.4500000000016, 766.9083333333349, 794.0000000000019, 747.7833333333351, 776.3250000000015, 729.1833333333351, 814.2250000000015, 773.3000000000017, 752.0166666666682, 767.9750000000015, 777.8250000000018, 729.3000000000011, 763.7916666666683, 762.516666666668, 698.4083333333347, 820.3250000000014, 763.641666666668, 751.6333333333349, 801.4000000000015, 809.1250000000017, 774.666666666668, 763.9083333333347, 780.0333333333352, 782.4000000000016, 764.2750000000013, 794.1416666666684, 768.9833333333348, 795.2750000000017, 760.8083333333349, 812.508333333335, 810.6083333333355, 786.4000000000015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24069958675566844, "mean_inference_ms": 2.0464146952779636, "mean_action_processing_ms": 0.09056444225639496, "mean_env_wait_ms": 1.530528128605028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006931304931640625, "StateBufferConnector_ms": 0.0032596588134765625, "ViewRequirementAgentConnector_ms": 0.08455252647399902}, "num_episodes": 27, "episode_return_max": 831.1916666666682, "episode_return_min": 630.8750000000015, "episode_return_mean": 739.8444166666679, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98700, "num_agent_steps_trained": 98400, "num_env_steps_sampled": 98700, "num_env_steps_trained": 98400, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 245.46595412255812, "num_env_steps_trained_throughput_per_sec": 231.02678035064292, "timesteps_total": 98700, "num_env_steps_sampled_lifetime": 98700, "num_agent_steps_sampled_lifetime": 98700, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 98700, "timers": {"training_iteration_time_ms": 10353.049, "restore_workers_time_ms": 0.014, "training_step_time_ms": 620.146, "sample_time_ms": 604.549, "synch_weights_time_ms": 14.041}, "counters": {"num_env_steps_sampled": 98700, "num_env_steps_trained": 98400, "num_agent_steps_sampled": 98700, "num_agent_steps_trained": 98400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 658, "num_samples_added_to_queue": 98700}, "done": false, "training_iteration": 39, "trial_id": "27800_00000", "date": "2024-10-12_15-34-32", "timestamp": 1728743672, "time_this_iter_s": 10.399065971374512, "time_total_s": 402.12040615081787, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a945ee1ba0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 402.12040615081787, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 16.4, "ram_util_percent": 35.120000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 502718.71875, "policy_loss": 490737.0625, "entropy": 22.658584594726562, "entropy_coeff": 0.01, "var_gnorm": 16.35393524169922, "vf_loss": 1204963.5, "vf_explained_var": 0.06546300649642944}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 337.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 101250, "num_env_steps_trained": 101100, "num_agent_steps_sampled": 101250, "num_agent_steps_trained": 101100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 675, "num_samples_added_to_queue": 101100, "learner_queue": {"size_count": 337, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.851, "learner_load_time_ms": 0.303, "learner_load_wait_time_ms": 1136.978, "learner_dequeue_time_ms": 9757.824}}, "env_runners": {"episode_reward_max": 844.1333333333353, "episode_reward_min": 630.8750000000015, "episode_reward_mean": 757.2712500000015, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 630.8750000000015}, "policy_reward_max": {"default_policy": 844.1333333333353}, "policy_reward_mean": {"default_policy": 757.2712500000015}, "custom_metrics": {"num_consolidated_mean": 1.8937999999999997, "num_consolidated_min": 1.68, "num_consolidated_max": 2.08, "num_overloaded_mean": 0.06380000000000001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.19, "num_moves_mean": 8.0524, "num_moves_min": 7.56, "num_moves_max": 8.61, "mean_accuracy_mean": 42.13784333333335, "mean_accuracy_min": 41.82200000000001, "mean_accuracy_max": 42.37933333333335, "num_model_switches_mean": 4.6869, "num_model_switches_min": 4.18, "num_model_switches_max": 5.32, "num_slav_mean": 0.13929816666666667, "num_slav_min": 0.11973333333333333, "num_slav_max": 0.16449999999999998, "cpu_conserved_cost_mean": 4.3958, "cpu_conserved_cost_min": 3.86, "cpu_conserved_cost_max": 4.9, "mean_cluster_cpu_util_mean": 0.4746612522426069, "mean_cluster_cpu_util_min": 0.4630755747803953, "mean_cluster_cpu_util_max": 0.48480027686365124, "mean_cluster_mem_util_mean": 0.3098320348711215, "mean_cluster_mem_util_min": 0.300153675658027, "mean_cluster_mem_util_max": 0.31519943830907887, "reward_consolidation_mean_mean": 3.683125, "reward_consolidation_mean_min": 3.1666666666666656, "reward_consolidation_mean_max": 4.125, "reward_illegal_mean_mean": -0.10633333333333331, "reward_illegal_mean_min": -0.31666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.950083333333348, "reward_accuracy_mean_min": 5.250000000000013, "reward_accuracy_mean_max": 6.408333333333351, "reward_sla_mean_mean": -1.9541624999999998, "reward_sla_mean_min": -2.27925, "reward_sla_mean_max": -1.6537500000000003, "reward_consolidation_sum_mean": 368.31249999999983, "reward_consolidation_sum_min": 316.6666666666666, "reward_consolidation_sum_max": 412.5, "reward_illegal_sum_mean": -10.633333333333335, "reward_illegal_sum_min": -31.666666666666664, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 595.0083333333347, "reward_accuracy_sum_min": 525.0000000000014, "reward_accuracy_sum_max": 640.8333333333351, "reward_sla_sum_mean": -195.41624999999996, "reward_sla_sum_min": -227.925, "reward_sla_sum_max": -165.37500000000003, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2832.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [762.3416666666684, 732.5833333333347, 686.8916666666679, 642.5833333333345, 744.7500000000015, 724.6666666666682, 708.9416666666677, 652.6833333333345, 745.4166666666682, 683.5333333333346, 716.6333333333349, 701.4666666666676, 630.8750000000015, 735.7333333333347, 715.6083333333347, 758.3916666666685, 745.2000000000016, 727.308333333335, 767.7083333333352, 702.2083333333347, 682.7500000000015, 701.1250000000013, 738.3250000000018, 733.1750000000015, 649.7916666666679, 728.5083333333346, 792.1750000000012, 747.4750000000013, 761.0416666666682, 797.1500000000013, 782.5750000000012, 831.1916666666682, 761.0166666666679, 712.3416666666683, 779.5750000000016, 728.5166666666684, 737.016666666668, 734.7166666666683, 783.9916666666676, 717.5333333333346, 756.400000000002, 802.7500000000018, 769.4250000000011, 695.1333333333347, 724.4500000000016, 766.9083333333349, 794.0000000000019, 747.7833333333351, 776.3250000000015, 729.1833333333351, 814.2250000000015, 773.3000000000017, 752.0166666666682, 767.9750000000015, 777.8250000000018, 729.3000000000011, 763.7916666666683, 762.516666666668, 698.4083333333347, 820.3250000000014, 763.641666666668, 751.6333333333349, 801.4000000000015, 809.1250000000017, 774.666666666668, 763.9083333333347, 780.0333333333352, 782.4000000000016, 764.2750000000013, 794.1416666666684, 768.9833333333348, 795.2750000000017, 760.8083333333349, 812.508333333335, 810.6083333333355, 786.4000000000015, 789.908333333335, 805.8333333333347, 756.6000000000016, 760.9333333333349, 799.0333333333349, 799.8666666666686, 747.1750000000013, 815.8916666666682, 844.1333333333353, 765.8833333333347, 728.8333333333346, 760.0416666666684, 828.2666666666685, 778.1333333333353, 743.5833333333346, 823.2166666666684, 750.7333333333348, 762.5000000000018, 812.7250000000016, 787.1833333333348, 820.7083333333352, 797.3333333333347, 748.0250000000012, 773.2166666666681], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [762.3416666666684, 732.5833333333347, 686.8916666666679, 642.5833333333345, 744.7500000000015, 724.6666666666682, 708.9416666666677, 652.6833333333345, 745.4166666666682, 683.5333333333346, 716.6333333333349, 701.4666666666676, 630.8750000000015, 735.7333333333347, 715.6083333333347, 758.3916666666685, 745.2000000000016, 727.308333333335, 767.7083333333352, 702.2083333333347, 682.7500000000015, 701.1250000000013, 738.3250000000018, 733.1750000000015, 649.7916666666679, 728.5083333333346, 792.1750000000012, 747.4750000000013, 761.0416666666682, 797.1500000000013, 782.5750000000012, 831.1916666666682, 761.0166666666679, 712.3416666666683, 779.5750000000016, 728.5166666666684, 737.016666666668, 734.7166666666683, 783.9916666666676, 717.5333333333346, 756.400000000002, 802.7500000000018, 769.4250000000011, 695.1333333333347, 724.4500000000016, 766.9083333333349, 794.0000000000019, 747.7833333333351, 776.3250000000015, 729.1833333333351, 814.2250000000015, 773.3000000000017, 752.0166666666682, 767.9750000000015, 777.8250000000018, 729.3000000000011, 763.7916666666683, 762.516666666668, 698.4083333333347, 820.3250000000014, 763.641666666668, 751.6333333333349, 801.4000000000015, 809.1250000000017, 774.666666666668, 763.9083333333347, 780.0333333333352, 782.4000000000016, 764.2750000000013, 794.1416666666684, 768.9833333333348, 795.2750000000017, 760.8083333333349, 812.508333333335, 810.6083333333355, 786.4000000000015, 789.908333333335, 805.8333333333347, 756.6000000000016, 760.9333333333349, 799.0333333333349, 799.8666666666686, 747.1750000000013, 815.8916666666682, 844.1333333333353, 765.8833333333347, 728.8333333333346, 760.0416666666684, 828.2666666666685, 778.1333333333353, 743.5833333333346, 823.2166666666684, 750.7333333333348, 762.5000000000018, 812.7250000000016, 787.1833333333348, 820.7083333333352, 797.3333333333347, 748.0250000000012, 773.2166666666681]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2407001284933493, "mean_inference_ms": 2.0456241799493124, "mean_action_processing_ms": 0.09054522550409225, "mean_env_wait_ms": 1.5302667408505084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006709575653076172, "StateBufferConnector_ms": 0.0032415390014648438, "ViewRequirementAgentConnector_ms": 0.08467507362365723}, "num_episodes": 24, "episode_return_max": 844.1333333333353, "episode_return_min": 630.8750000000015, "episode_return_mean": 757.2712500000015, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 101250, "num_agent_steps_trained": 101100, "num_env_steps_sampled": 101250, "num_env_steps_trained": 101100, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 251.83365250859322, "num_env_steps_trained_throughput_per_sec": 266.6473967738046, "timesteps_total": 101250, "num_env_steps_sampled_lifetime": 101250, "num_agent_steps_sampled_lifetime": 101250, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 101250, "timers": {"training_iteration_time_ms": 10326.98, "restore_workers_time_ms": 0.013, "training_step_time_ms": 596.528, "sample_time_ms": 582.294, "synch_weights_time_ms": 12.816}, "counters": {"num_env_steps_sampled": 101250, "num_env_steps_trained": 101100, "num_agent_steps_sampled": 101250, "num_agent_steps_trained": 101100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 675, "num_samples_added_to_queue": 101100}, "done": false, "training_iteration": 40, "trial_id": "27800_00000", "date": "2024-10-12_15-34-42", "timestamp": 1728743682, "time_this_iter_s": 10.135613679885864, "time_total_s": 412.25601983070374, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f69270>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 412.25601983070374, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 16.485714285714288, "ram_util_percent": 35.19285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 497647.9375, "policy_loss": 484763.5625, "entropy": 22.14408302307129, "entropy_coeff": 0.01, "var_gnorm": 16.36532211303711, "vf_loss": 1295079.875, "vf_explained_var": 0.06473439931869507}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 345.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 103800, "num_env_steps_trained": 103500, "num_agent_steps_sampled": 103800, "num_agent_steps_trained": 103500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 692, "num_samples_added_to_queue": 103800, "learner_queue": {"size_count": 345, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.818, "learner_load_time_ms": 0.293, "learner_load_wait_time_ms": 1184.66, "learner_dequeue_time_ms": 9799.371}}, "env_runners": {"episode_reward_max": 891.391666666669, "episode_reward_min": 695.1333333333347, "episode_reward_mean": 780.550583333335, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 695.1333333333347}, "policy_reward_max": {"default_policy": 891.391666666669}, "policy_reward_mean": {"default_policy": 780.550583333335}, "custom_metrics": {"num_consolidated_mean": 1.9439999999999997, "num_consolidated_min": 1.71, "num_consolidated_max": 2.23, "num_overloaded_mean": 0.055600000000000004, "num_overloaded_min": 0.0, "num_overloaded_max": 0.14, "num_moves_mean": 7.9315, "num_moves_min": 7.42, "num_moves_max": 8.56, "mean_accuracy_mean": 42.18198666666668, "mean_accuracy_min": 41.948666666666675, "mean_accuracy_max": 42.423666666666676, "num_model_switches_mean": 4.562500000000001, "num_model_switches_min": 3.99, "num_model_switches_max": 4.96, "num_slav_mean": 0.1382735, "num_slav_min": 0.11973333333333333, "num_slav_max": 0.15681666666666666, "cpu_conserved_cost_mean": 4.5136, "cpu_conserved_cost_min": 3.92, "cpu_conserved_cost_max": 5.36, "mean_cluster_cpu_util_mean": 0.474585780475513, "mean_cluster_cpu_util_min": 0.4630755747803953, "mean_cluster_cpu_util_max": 0.48480027686365124, "mean_cluster_mem_util_mean": 0.3096449019938144, "mean_cluster_mem_util_min": 0.300153675658027, "mean_cluster_mem_util_max": 0.31599078708487616, "reward_consolidation_mean_mean": 3.7999999999999994, "reward_consolidation_mean_min": 3.3124999999999996, "reward_consolidation_mean_max": 4.458333333333333, "reward_illegal_mean_mean": -0.09266666666666667, "reward_illegal_mean_min": -0.2333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.056750000000015, "reward_accuracy_mean_min": 5.5333333333333465, "reward_accuracy_mean_max": 6.466666666666685, "reward_sla_mean_mean": -1.9585775000000003, "reward_sla_mean_min": -2.24675, "reward_sla_mean_max": -1.6537500000000003, "reward_consolidation_sum_mean": 379.99999999999994, "reward_consolidation_sum_min": 331.24999999999994, "reward_consolidation_sum_max": 445.8333333333333, "reward_illegal_sum_mean": -9.266666666666666, "reward_illegal_sum_min": -23.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 605.6750000000015, "reward_accuracy_sum_min": 553.3333333333346, "reward_accuracy_sum_max": 646.6666666666686, "reward_sla_sum_mean": -195.85775, "reward_sla_sum_min": -224.675, "reward_sla_sum_max": -165.37500000000003, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1782.0, "global_timestep_min": 100, "global_timestep_max": 3400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [747.4750000000013, 761.0416666666682, 797.1500000000013, 782.5750000000012, 831.1916666666682, 761.0166666666679, 712.3416666666683, 779.5750000000016, 728.5166666666684, 737.016666666668, 734.7166666666683, 783.9916666666676, 717.5333333333346, 756.400000000002, 802.7500000000018, 769.4250000000011, 695.1333333333347, 724.4500000000016, 766.9083333333349, 794.0000000000019, 747.7833333333351, 776.3250000000015, 729.1833333333351, 814.2250000000015, 773.3000000000017, 752.0166666666682, 767.9750000000015, 777.8250000000018, 729.3000000000011, 763.7916666666683, 762.516666666668, 698.4083333333347, 820.3250000000014, 763.641666666668, 751.6333333333349, 801.4000000000015, 809.1250000000017, 774.666666666668, 763.9083333333347, 780.0333333333352, 782.4000000000016, 764.2750000000013, 794.1416666666684, 768.9833333333348, 795.2750000000017, 760.8083333333349, 812.508333333335, 810.6083333333355, 786.4000000000015, 789.908333333335, 805.8333333333347, 756.6000000000016, 760.9333333333349, 799.0333333333349, 799.8666666666686, 747.1750000000013, 815.8916666666682, 844.1333333333353, 765.8833333333347, 728.8333333333346, 760.0416666666684, 828.2666666666685, 778.1333333333353, 743.5833333333346, 823.2166666666684, 750.7333333333348, 762.5000000000018, 812.7250000000016, 787.1833333333348, 820.7083333333352, 797.3333333333347, 748.0250000000012, 773.2166666666681, 833.4416666666683, 808.5583333333349, 772.2166666666682, 847.5583333333349, 813.6750000000013, 784.3250000000015, 795.7250000000018, 859.0166666666686, 815.025000000002, 822.3666666666682, 754.2666666666684, 777.5666666666685, 780.8666666666682, 777.1250000000016, 706.3000000000021, 830.1000000000017, 792.8916666666685, 771.2083333333346, 811.4250000000012, 809.725000000002, 780.6750000000015, 808.8083333333352, 805.7000000000021, 840.8416666666685, 743.5000000000018, 891.391666666669, 805.0083333333351], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [747.4750000000013, 761.0416666666682, 797.1500000000013, 782.5750000000012, 831.1916666666682, 761.0166666666679, 712.3416666666683, 779.5750000000016, 728.5166666666684, 737.016666666668, 734.7166666666683, 783.9916666666676, 717.5333333333346, 756.400000000002, 802.7500000000018, 769.4250000000011, 695.1333333333347, 724.4500000000016, 766.9083333333349, 794.0000000000019, 747.7833333333351, 776.3250000000015, 729.1833333333351, 814.2250000000015, 773.3000000000017, 752.0166666666682, 767.9750000000015, 777.8250000000018, 729.3000000000011, 763.7916666666683, 762.516666666668, 698.4083333333347, 820.3250000000014, 763.641666666668, 751.6333333333349, 801.4000000000015, 809.1250000000017, 774.666666666668, 763.9083333333347, 780.0333333333352, 782.4000000000016, 764.2750000000013, 794.1416666666684, 768.9833333333348, 795.2750000000017, 760.8083333333349, 812.508333333335, 810.6083333333355, 786.4000000000015, 789.908333333335, 805.8333333333347, 756.6000000000016, 760.9333333333349, 799.0333333333349, 799.8666666666686, 747.1750000000013, 815.8916666666682, 844.1333333333353, 765.8833333333347, 728.8333333333346, 760.0416666666684, 828.2666666666685, 778.1333333333353, 743.5833333333346, 823.2166666666684, 750.7333333333348, 762.5000000000018, 812.7250000000016, 787.1833333333348, 820.7083333333352, 797.3333333333347, 748.0250000000012, 773.2166666666681, 833.4416666666683, 808.5583333333349, 772.2166666666682, 847.5583333333349, 813.6750000000013, 784.3250000000015, 795.7250000000018, 859.0166666666686, 815.025000000002, 822.3666666666682, 754.2666666666684, 777.5666666666685, 780.8666666666682, 777.1250000000016, 706.3000000000021, 830.1000000000017, 792.8916666666685, 771.2083333333346, 811.4250000000012, 809.725000000002, 780.6750000000015, 808.8083333333352, 805.7000000000021, 840.8416666666685, 743.5000000000018, 891.391666666669, 805.0083333333351]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2407041986391198, "mean_inference_ms": 2.0451308015051626, "mean_action_processing_ms": 0.09053772643883345, "mean_env_wait_ms": 1.530231821017597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006355762481689453, "StateBufferConnector_ms": 0.0032300949096679688, "ViewRequirementAgentConnector_ms": 0.08417391777038574}, "num_episodes": 27, "episode_return_max": 891.391666666669, "episode_return_min": 695.1333333333347, "episode_return_mean": 780.550583333335, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 103800, "num_agent_steps_trained": 103500, "num_env_steps_sampled": 103800, "num_env_steps_trained": 103500, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 239.5697800148278, "num_env_steps_trained_throughput_per_sec": 225.47744001395557, "timesteps_total": 103800, "num_env_steps_sampled_lifetime": 103800, "num_agent_steps_sampled_lifetime": 103800, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 103800, "timers": {"training_iteration_time_ms": 10363.737, "restore_workers_time_ms": 0.013, "training_step_time_ms": 625.719, "sample_time_ms": 611.663, "synch_weights_time_ms": 12.564}, "counters": {"num_env_steps_sampled": 103800, "num_env_steps_trained": 103500, "num_agent_steps_sampled": 103800, "num_agent_steps_trained": 103500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 692, "num_samples_added_to_queue": 103800}, "done": false, "training_iteration": 41, "trial_id": "27800_00000", "date": "2024-10-12_15-34-53", "timestamp": 1728743693, "time_this_iter_s": 10.654927730560303, "time_total_s": 422.91094756126404, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c3490>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 422.91094756126404, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 16.339999999999996, "ram_util_percent": 35.41333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 469703.90625, "policy_loss": 457794.09375, "entropy": 21.645536422729492, "entropy_coeff": 0.01, "var_gnorm": 16.378257751464844, "vf_loss": 1197474.125, "vf_explained_var": 0.0728226900100708}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 353.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 106200, "num_env_steps_trained": 105900, "num_agent_steps_sampled": 106200, "num_agent_steps_trained": 105900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 708, "num_samples_added_to_queue": 106200, "learner_queue": {"size_count": 353, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.133, "learner_load_time_ms": 0.284, "learner_load_wait_time_ms": 1190.408, "learner_dequeue_time_ms": 9802.978}}, "env_runners": {"episode_reward_max": 891.391666666669, "episode_reward_min": 698.4083333333347, "episode_reward_mean": 794.8845833333351, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 698.4083333333347}, "policy_reward_max": {"default_policy": 891.391666666669}, "policy_reward_mean": {"default_policy": 794.8845833333351}, "custom_metrics": {"num_consolidated_mean": 1.9867, "num_consolidated_min": 1.71, "num_consolidated_max": 2.23, "num_overloaded_mean": 0.0538, "num_overloaded_min": 0.0, "num_overloaded_max": 0.14, "num_moves_mean": 7.838100000000001, "num_moves_min": 7.25, "num_moves_max": 8.47, "mean_accuracy_mean": 42.21770666666667, "mean_accuracy_min": 41.948666666666675, "mean_accuracy_max": 42.423666666666676, "num_model_switches_mean": 4.4713, "num_model_switches_min": 3.85, "num_model_switches_max": 4.96, "num_slav_mean": 0.13820533333333335, "num_slav_min": 0.11973333333333333, "num_slav_max": 0.15681666666666666, "cpu_conserved_cost_mean": 4.635, "cpu_conserved_cost_min": 3.92, "cpu_conserved_cost_max": 5.36, "mean_cluster_cpu_util_mean": 0.47539894126734866, "mean_cluster_cpu_util_min": 0.4630755747803953, "mean_cluster_cpu_util_max": 0.48863835225730107, "mean_cluster_mem_util_mean": 0.3101804218045868, "mean_cluster_mem_util_min": 0.300153675658027, "mean_cluster_mem_util_max": 0.3185262392720801, "reward_consolidation_mean_mean": 3.889375, "reward_consolidation_mean_min": 3.333333333333333, "reward_consolidation_mean_max": 4.458333333333333, "reward_illegal_mean_mean": -0.08966666666666667, "reward_illegal_mean_min": -0.2333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.106500000000015, "reward_accuracy_mean_min": 5.616666666666679, "reward_accuracy_mean_max": 6.5583333333333504, "reward_sla_mean_mean": -1.9573625000000003, "reward_sla_mean_min": -2.24675, "reward_sla_mean_max": -1.6537500000000003, "reward_consolidation_sum_mean": 388.93749999999994, "reward_consolidation_sum_min": 333.3333333333333, "reward_consolidation_sum_max": 445.8333333333333, "reward_illegal_sum_mean": -8.966666666666665, "reward_illegal_sum_min": -23.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 610.6500000000017, "reward_accuracy_sum_min": 561.6666666666679, "reward_accuracy_sum_max": 655.8333333333351, "reward_sla_sum_mean": -195.73625, "reward_sla_sum_min": -224.675, "reward_sla_sum_max": -165.37500000000003, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2582.0, "global_timestep_min": 900, "global_timestep_max": 4200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [773.3000000000017, 752.0166666666682, 767.9750000000015, 777.8250000000018, 729.3000000000011, 763.7916666666683, 762.516666666668, 698.4083333333347, 820.3250000000014, 763.641666666668, 751.6333333333349, 801.4000000000015, 809.1250000000017, 774.666666666668, 763.9083333333347, 780.0333333333352, 782.4000000000016, 764.2750000000013, 794.1416666666684, 768.9833333333348, 795.2750000000017, 760.8083333333349, 812.508333333335, 810.6083333333355, 786.4000000000015, 789.908333333335, 805.8333333333347, 756.6000000000016, 760.9333333333349, 799.0333333333349, 799.8666666666686, 747.1750000000013, 815.8916666666682, 844.1333333333353, 765.8833333333347, 728.8333333333346, 760.0416666666684, 828.2666666666685, 778.1333333333353, 743.5833333333346, 823.2166666666684, 750.7333333333348, 762.5000000000018, 812.7250000000016, 787.1833333333348, 820.7083333333352, 797.3333333333347, 748.0250000000012, 773.2166666666681, 833.4416666666683, 808.5583333333349, 772.2166666666682, 847.5583333333349, 813.6750000000013, 784.3250000000015, 795.7250000000018, 859.0166666666686, 815.025000000002, 822.3666666666682, 754.2666666666684, 777.5666666666685, 780.8666666666682, 777.1250000000016, 706.3000000000021, 830.1000000000017, 792.8916666666685, 771.2083333333346, 811.4250000000012, 809.725000000002, 780.6750000000015, 808.8083333333352, 805.7000000000021, 840.8416666666685, 743.5000000000018, 891.391666666669, 805.0083333333351, 816.9333333333353, 813.891666666668, 797.0083333333353, 856.7333333333355, 796.308333333335, 838.0000000000015, 784.5833333333348, 847.7583333333351, 805.2333333333345, 809.9583333333348, 830.7166666666681, 796.6916666666683, 816.4083333333352, 861.2000000000015, 837.0333333333349, 811.1750000000023, 835.4333333333348, 802.4583333333348, 820.316666666668, 832.5250000000017, 813.2750000000016, 769.5750000000016, 845.8666666666686, 845.0416666666686], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [773.3000000000017, 752.0166666666682, 767.9750000000015, 777.8250000000018, 729.3000000000011, 763.7916666666683, 762.516666666668, 698.4083333333347, 820.3250000000014, 763.641666666668, 751.6333333333349, 801.4000000000015, 809.1250000000017, 774.666666666668, 763.9083333333347, 780.0333333333352, 782.4000000000016, 764.2750000000013, 794.1416666666684, 768.9833333333348, 795.2750000000017, 760.8083333333349, 812.508333333335, 810.6083333333355, 786.4000000000015, 789.908333333335, 805.8333333333347, 756.6000000000016, 760.9333333333349, 799.0333333333349, 799.8666666666686, 747.1750000000013, 815.8916666666682, 844.1333333333353, 765.8833333333347, 728.8333333333346, 760.0416666666684, 828.2666666666685, 778.1333333333353, 743.5833333333346, 823.2166666666684, 750.7333333333348, 762.5000000000018, 812.7250000000016, 787.1833333333348, 820.7083333333352, 797.3333333333347, 748.0250000000012, 773.2166666666681, 833.4416666666683, 808.5583333333349, 772.2166666666682, 847.5583333333349, 813.6750000000013, 784.3250000000015, 795.7250000000018, 859.0166666666686, 815.025000000002, 822.3666666666682, 754.2666666666684, 777.5666666666685, 780.8666666666682, 777.1250000000016, 706.3000000000021, 830.1000000000017, 792.8916666666685, 771.2083333333346, 811.4250000000012, 809.725000000002, 780.6750000000015, 808.8083333333352, 805.7000000000021, 840.8416666666685, 743.5000000000018, 891.391666666669, 805.0083333333351, 816.9333333333353, 813.891666666668, 797.0083333333353, 856.7333333333355, 796.308333333335, 838.0000000000015, 784.5833333333348, 847.7583333333351, 805.2333333333345, 809.9583333333348, 830.7166666666681, 796.6916666666683, 816.4083333333352, 861.2000000000015, 837.0333333333349, 811.1750000000023, 835.4333333333348, 802.4583333333348, 820.316666666668, 832.5250000000017, 813.2750000000016, 769.5750000000016, 845.8666666666686, 845.0416666666686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2407511987751593, "mean_inference_ms": 2.0454894153420513, "mean_action_processing_ms": 0.09055198084060821, "mean_env_wait_ms": 1.5305698852293148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006346464157104492, "StateBufferConnector_ms": 0.0032143592834472656, "ViewRequirementAgentConnector_ms": 0.08340144157409668}, "num_episodes": 24, "episode_return_max": 891.391666666669, "episode_return_min": 698.4083333333347, "episode_return_mean": 794.8845833333351, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 106200, "num_agent_steps_trained": 105900, "num_env_steps_sampled": 106200, "num_env_steps_trained": 105900, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 238.41435251934448, "num_env_steps_trained_throughput_per_sec": 238.41435251934448, "timesteps_total": 106200, "num_env_steps_sampled_lifetime": 106200, "num_agent_steps_sampled_lifetime": 106200, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 106200, "timers": {"training_iteration_time_ms": 10332.302, "restore_workers_time_ms": 0.015, "training_step_time_ms": 633.08, "sample_time_ms": 616.846, "synch_weights_time_ms": 14.817}, "counters": {"num_env_steps_sampled": 106200, "num_env_steps_trained": 105900, "num_agent_steps_sampled": 106200, "num_agent_steps_trained": 105900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 708, "num_samples_added_to_queue": 106200}, "done": false, "training_iteration": 42, "trial_id": "27800_00000", "date": "2024-10-12_15-35-03", "timestamp": 1728743703, "time_this_iter_s": 10.076944828033447, "time_total_s": 432.9878923892975, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f697e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 432.9878923892975, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 16.46, "ram_util_percent": 35.57333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 486958.6875, "policy_loss": 474348.0, "entropy": 21.1473331451416, "entropy_coeff": 0.01, "var_gnorm": 16.39067840576172, "vf_loss": 1267413.375, "vf_explained_var": 0.08406412601470947}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 362.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 108750, "num_env_steps_trained": 108600, "num_agent_steps_sampled": 108750, "num_agent_steps_trained": 108600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 725, "num_samples_added_to_queue": 108600, "learner_queue": {"size_count": 362, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.95, "learner_load_time_ms": 0.305, "learner_load_wait_time_ms": 1178.512, "learner_dequeue_time_ms": 9814.019}}, "env_runners": {"episode_reward_max": 897.250000000002, "episode_reward_min": 706.3000000000021, "episode_reward_mean": 812.0122500000017, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 706.3000000000021}, "policy_reward_max": {"default_policy": 897.250000000002}, "policy_reward_mean": {"default_policy": 812.0122500000017}, "custom_metrics": {"num_consolidated_mean": 2.0284999999999997, "num_consolidated_min": 1.75, "num_consolidated_max": 2.24, "num_overloaded_mean": 0.051199999999999996, "num_overloaded_min": 0.0, "num_overloaded_max": 0.14, "num_moves_mean": 7.728699999999999, "num_moves_min": 7.08, "num_moves_max": 8.2, "mean_accuracy_mean": 42.26147000000002, "mean_accuracy_min": 41.980333333333334, "mean_accuracy_max": 42.480666666666686, "num_model_switches_mean": 4.3687000000000005, "num_model_switches_min": 3.85, "num_model_switches_max": 4.89, "num_slav_mean": 0.13725649999999998, "num_slav_min": 0.11585000000000002, "num_slav_max": 0.15681666666666666, "cpu_conserved_cost_mean": 4.7436, "cpu_conserved_cost_min": 4.02, "cpu_conserved_cost_max": 5.36, "mean_cluster_cpu_util_mean": 0.47598291297764206, "mean_cluster_cpu_util_min": 0.46547344116910866, "mean_cluster_cpu_util_max": 0.48863835225730107, "mean_cluster_mem_util_mean": 0.31033120028021755, "mean_cluster_mem_util_min": 0.30295431915382187, "mean_cluster_mem_util_max": 0.3185262392720801, "reward_consolidation_mean_mean": 3.9787499999999993, "reward_consolidation_mean_min": 3.458333333333333, "reward_consolidation_mean_max": 4.520833333333332, "reward_illegal_mean_mean": -0.08533333333333333, "reward_illegal_mean_min": -0.2333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.17658333333335, "reward_accuracy_mean_min": 5.616666666666679, "reward_accuracy_mean_max": 6.816666666666686, "reward_sla_mean_mean": -1.9498775000000002, "reward_sla_mean_min": -2.24675, "reward_sla_mean_max": -1.6400000000000003, "reward_consolidation_sum_mean": 397.87499999999994, "reward_consolidation_sum_min": 345.8333333333333, "reward_consolidation_sum_max": 452.0833333333332, "reward_illegal_sum_mean": -8.533333333333333, "reward_illegal_sum_min": -23.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 617.6583333333349, "reward_accuracy_sum_min": 561.6666666666679, "reward_accuracy_sum_max": 681.6666666666686, "reward_sla_sum_mean": -194.98775, "reward_sla_sum_min": -224.675, "reward_sla_sum_max": -164.00000000000003, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3383.0, "global_timestep_min": 1700, "global_timestep_max": 5000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [786.4000000000015, 789.908333333335, 805.8333333333347, 756.6000000000016, 760.9333333333349, 799.0333333333349, 799.8666666666686, 747.1750000000013, 815.8916666666682, 844.1333333333353, 765.8833333333347, 728.8333333333346, 760.0416666666684, 828.2666666666685, 778.1333333333353, 743.5833333333346, 823.2166666666684, 750.7333333333348, 762.5000000000018, 812.7250000000016, 787.1833333333348, 820.7083333333352, 797.3333333333347, 748.0250000000012, 773.2166666666681, 833.4416666666683, 808.5583333333349, 772.2166666666682, 847.5583333333349, 813.6750000000013, 784.3250000000015, 795.7250000000018, 859.0166666666686, 815.025000000002, 822.3666666666682, 754.2666666666684, 777.5666666666685, 780.8666666666682, 777.1250000000016, 706.3000000000021, 830.1000000000017, 792.8916666666685, 771.2083333333346, 811.4250000000012, 809.725000000002, 780.6750000000015, 808.8083333333352, 805.7000000000021, 840.8416666666685, 743.5000000000018, 891.391666666669, 805.0083333333351, 816.9333333333353, 813.891666666668, 797.0083333333353, 856.7333333333355, 796.308333333335, 838.0000000000015, 784.5833333333348, 847.7583333333351, 805.2333333333345, 809.9583333333348, 830.7166666666681, 796.6916666666683, 816.4083333333352, 861.2000000000015, 837.0333333333349, 811.1750000000023, 835.4333333333348, 802.4583333333348, 820.316666666668, 832.5250000000017, 813.2750000000016, 769.5750000000016, 845.8666666666686, 845.0416666666686, 880.0166666666692, 753.1916666666685, 853.9666666666687, 815.2250000000017, 874.7166666666687, 897.250000000002, 828.4083333333347, 889.1416666666685, 889.5750000000021, 807.9583333333348, 879.3000000000019, 781.9833333333354, 874.1416666666679, 799.4000000000018, 869.4666666666686, 866.2500000000016, 861.8166666666684, 853.2916666666686, 810.5333333333353, 877.2666666666686, 857.3416666666684, 792.6750000000018, 845.0166666666685, 833.7000000000021], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [786.4000000000015, 789.908333333335, 805.8333333333347, 756.6000000000016, 760.9333333333349, 799.0333333333349, 799.8666666666686, 747.1750000000013, 815.8916666666682, 844.1333333333353, 765.8833333333347, 728.8333333333346, 760.0416666666684, 828.2666666666685, 778.1333333333353, 743.5833333333346, 823.2166666666684, 750.7333333333348, 762.5000000000018, 812.7250000000016, 787.1833333333348, 820.7083333333352, 797.3333333333347, 748.0250000000012, 773.2166666666681, 833.4416666666683, 808.5583333333349, 772.2166666666682, 847.5583333333349, 813.6750000000013, 784.3250000000015, 795.7250000000018, 859.0166666666686, 815.025000000002, 822.3666666666682, 754.2666666666684, 777.5666666666685, 780.8666666666682, 777.1250000000016, 706.3000000000021, 830.1000000000017, 792.8916666666685, 771.2083333333346, 811.4250000000012, 809.725000000002, 780.6750000000015, 808.8083333333352, 805.7000000000021, 840.8416666666685, 743.5000000000018, 891.391666666669, 805.0083333333351, 816.9333333333353, 813.891666666668, 797.0083333333353, 856.7333333333355, 796.308333333335, 838.0000000000015, 784.5833333333348, 847.7583333333351, 805.2333333333345, 809.9583333333348, 830.7166666666681, 796.6916666666683, 816.4083333333352, 861.2000000000015, 837.0333333333349, 811.1750000000023, 835.4333333333348, 802.4583333333348, 820.316666666668, 832.5250000000017, 813.2750000000016, 769.5750000000016, 845.8666666666686, 845.0416666666686, 880.0166666666692, 753.1916666666685, 853.9666666666687, 815.2250000000017, 874.7166666666687, 897.250000000002, 828.4083333333347, 889.1416666666685, 889.5750000000021, 807.9583333333348, 879.3000000000019, 781.9833333333354, 874.1416666666679, 799.4000000000018, 869.4666666666686, 866.2500000000016, 861.8166666666684, 853.2916666666686, 810.5333333333353, 877.2666666666686, 857.3416666666684, 792.6750000000018, 845.0166666666685, 833.7000000000021]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24083074554787237, "mean_inference_ms": 2.0474224223621356, "mean_action_processing_ms": 0.09058642221146965, "mean_env_wait_ms": 1.5312179750814885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00635528564453125, "StateBufferConnector_ms": 0.0032188892364501953, "ViewRequirementAgentConnector_ms": 0.0836324691772461}, "num_episodes": 24, "episode_return_max": 897.250000000002, "episode_return_min": 706.3000000000021, "episode_return_mean": 812.0122500000017, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108750, "num_agent_steps_trained": 108600, "num_env_steps_sampled": 108750, "num_env_steps_trained": 108600, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 244.7910840405639, "num_env_steps_trained_throughput_per_sec": 259.1905595723618, "timesteps_total": 108750, "num_env_steps_sampled_lifetime": 108750, "num_agent_steps_sampled_lifetime": 108750, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 108750, "timers": {"training_iteration_time_ms": 10328.156, "restore_workers_time_ms": 0.016, "training_step_time_ms": 607.938, "sample_time_ms": 591.869, "synch_weights_time_ms": 14.566}, "counters": {"num_env_steps_sampled": 108750, "num_env_steps_trained": 108600, "num_agent_steps_sampled": 108750, "num_agent_steps_trained": 108600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 725, "num_samples_added_to_queue": 108600}, "done": false, "training_iteration": 43, "trial_id": "27800_00000", "date": "2024-10-12_15-35-14", "timestamp": 1728743714, "time_this_iter_s": 10.429169654846191, "time_total_s": 443.4170620441437, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f6a440>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 443.4170620441437, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 16.4, "ram_util_percent": 35.63333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 455528.75, "policy_loss": 443576.84375, "entropy": 20.879980087280273, "entropy_coeff": 0.01, "var_gnorm": 16.397510528564453, "vf_loss": 1201452.625, "vf_explained_var": 0.08708548545837402}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 370.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 111300, "num_env_steps_trained": 111000, "num_agent_steps_sampled": 111300, "num_agent_steps_trained": 111000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 742, "num_samples_added_to_queue": 111300, "learner_queue": {"size_count": 370, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.69, "learner_load_time_ms": 0.313, "learner_load_wait_time_ms": 1149.575, "learner_dequeue_time_ms": 9829.134}}, "env_runners": {"episode_reward_max": 919.5583333333349, "episode_reward_min": 706.3000000000021, "episode_reward_mean": 830.6344166666684, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 706.3000000000021}, "policy_reward_max": {"default_policy": 919.5583333333349}, "policy_reward_mean": {"default_policy": 830.6344166666684}, "custom_metrics": {"num_consolidated_mean": 2.0759, "num_consolidated_min": 1.75, "num_consolidated_max": 2.26, "num_overloaded_mean": 0.04970000000000001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.14, "num_moves_mean": 7.5912, "num_moves_min": 6.96, "num_moves_max": 8.15, "mean_accuracy_mean": 42.30162333333334, "mean_accuracy_min": 42.05633333333335, "mean_accuracy_max": 42.480666666666686, "num_model_switches_mean": 4.233999999999999, "num_model_switches_min": 3.63, "num_model_switches_max": 4.89, "num_slav_mean": 0.13529516666666666, "num_slav_min": 0.10861666666666667, "num_slav_max": 0.15681666666666666, "cpu_conserved_cost_mean": 4.8746, "cpu_conserved_cost_min": 4.02, "cpu_conserved_cost_max": 5.5, "mean_cluster_cpu_util_mean": 0.47684432087387363, "mean_cluster_cpu_util_min": 0.4656195415063869, "mean_cluster_cpu_util_max": 0.48863835225730107, "mean_cluster_mem_util_mean": 0.3106207748500244, "mean_cluster_mem_util_min": 0.30295431915382187, "mean_cluster_mem_util_max": 0.3185262392720801, "reward_consolidation_mean_mean": 4.078749999999999, "reward_consolidation_mean_min": 3.458333333333333, "reward_consolidation_mean_max": 4.520833333333332, "reward_illegal_mean_mean": -0.08283333333333333, "reward_illegal_mean_min": -0.2333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.237250000000016, "reward_accuracy_mean_min": 5.666666666666682, "reward_accuracy_mean_max": 6.816666666666686, "reward_sla_mean_mean": -1.9268224999999999, "reward_sla_mean_min": -2.1955, "reward_sla_mean_max": -1.5545000000000002, "reward_consolidation_sum_mean": 407.875, "reward_consolidation_sum_min": 345.8333333333333, "reward_consolidation_sum_max": 452.0833333333332, "reward_illegal_sum_mean": -8.283333333333333, "reward_illegal_sum_min": -23.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 623.7250000000017, "reward_accuracy_sum_min": 566.6666666666682, "reward_accuracy_sum_max": 681.6666666666686, "reward_sla_sum_mean": -192.68225, "reward_sla_sum_min": -219.55, "reward_sla_sum_max": -155.45000000000002, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4282.0, "global_timestep_min": 2600, "global_timestep_max": 5900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [772.2166666666682, 847.5583333333349, 813.6750000000013, 784.3250000000015, 795.7250000000018, 859.0166666666686, 815.025000000002, 822.3666666666682, 754.2666666666684, 777.5666666666685, 780.8666666666682, 777.1250000000016, 706.3000000000021, 830.1000000000017, 792.8916666666685, 771.2083333333346, 811.4250000000012, 809.725000000002, 780.6750000000015, 808.8083333333352, 805.7000000000021, 840.8416666666685, 743.5000000000018, 891.391666666669, 805.0083333333351, 816.9333333333353, 813.891666666668, 797.0083333333353, 856.7333333333355, 796.308333333335, 838.0000000000015, 784.5833333333348, 847.7583333333351, 805.2333333333345, 809.9583333333348, 830.7166666666681, 796.6916666666683, 816.4083333333352, 861.2000000000015, 837.0333333333349, 811.1750000000023, 835.4333333333348, 802.4583333333348, 820.316666666668, 832.5250000000017, 813.2750000000016, 769.5750000000016, 845.8666666666686, 845.0416666666686, 880.0166666666692, 753.1916666666685, 853.9666666666687, 815.2250000000017, 874.7166666666687, 897.250000000002, 828.4083333333347, 889.1416666666685, 889.5750000000021, 807.9583333333348, 879.3000000000019, 781.9833333333354, 874.1416666666679, 799.4000000000018, 869.4666666666686, 866.2500000000016, 861.8166666666684, 853.2916666666686, 810.5333333333353, 877.2666666666686, 857.3416666666684, 792.6750000000018, 845.0166666666685, 833.7000000000021, 919.5583333333349, 902.6833333333352, 808.825000000002, 879.0166666666685, 869.6333333333348, 838.5000000000019, 861.9833333333349, 847.5583333333354, 901.7666666666681, 849.200000000002, 819.3500000000018, 834.0500000000018, 827.633333333335, 875.4916666666684, 841.6083333333353, 834.5250000000013, 810.4250000000015, 876.6583333333351, 810.7333333333349, 849.4333333333349, 850.633333333335, 919.1000000000021, 859.2333333333354, 872.6666666666686, 839.1333333333354, 829.8500000000017, 861.1250000000022], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [772.2166666666682, 847.5583333333349, 813.6750000000013, 784.3250000000015, 795.7250000000018, 859.0166666666686, 815.025000000002, 822.3666666666682, 754.2666666666684, 777.5666666666685, 780.8666666666682, 777.1250000000016, 706.3000000000021, 830.1000000000017, 792.8916666666685, 771.2083333333346, 811.4250000000012, 809.725000000002, 780.6750000000015, 808.8083333333352, 805.7000000000021, 840.8416666666685, 743.5000000000018, 891.391666666669, 805.0083333333351, 816.9333333333353, 813.891666666668, 797.0083333333353, 856.7333333333355, 796.308333333335, 838.0000000000015, 784.5833333333348, 847.7583333333351, 805.2333333333345, 809.9583333333348, 830.7166666666681, 796.6916666666683, 816.4083333333352, 861.2000000000015, 837.0333333333349, 811.1750000000023, 835.4333333333348, 802.4583333333348, 820.316666666668, 832.5250000000017, 813.2750000000016, 769.5750000000016, 845.8666666666686, 845.0416666666686, 880.0166666666692, 753.1916666666685, 853.9666666666687, 815.2250000000017, 874.7166666666687, 897.250000000002, 828.4083333333347, 889.1416666666685, 889.5750000000021, 807.9583333333348, 879.3000000000019, 781.9833333333354, 874.1416666666679, 799.4000000000018, 869.4666666666686, 866.2500000000016, 861.8166666666684, 853.2916666666686, 810.5333333333353, 877.2666666666686, 857.3416666666684, 792.6750000000018, 845.0166666666685, 833.7000000000021, 919.5583333333349, 902.6833333333352, 808.825000000002, 879.0166666666685, 869.6333333333348, 838.5000000000019, 861.9833333333349, 847.5583333333354, 901.7666666666681, 849.200000000002, 819.3500000000018, 834.0500000000018, 827.633333333335, 875.4916666666684, 841.6083333333353, 834.5250000000013, 810.4250000000015, 876.6583333333351, 810.7333333333349, 849.4333333333349, 850.633333333335, 919.1000000000021, 859.2333333333354, 872.6666666666686, 839.1333333333354, 829.8500000000017, 861.1250000000022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24083171418768276, "mean_inference_ms": 2.0463106290144286, "mean_action_processing_ms": 0.09058487272934057, "mean_env_wait_ms": 1.5312256692321484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00632929801940918, "StateBufferConnector_ms": 0.0032188892364501953, "ViewRequirementAgentConnector_ms": 0.08350920677185059}, "num_episodes": 27, "episode_return_max": 919.5583333333349, "episode_return_min": 706.3000000000021, "episode_return_mean": 830.6344166666684, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 111300, "num_agent_steps_trained": 111000, "num_env_steps_sampled": 111300, "num_env_steps_trained": 111000, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 251.41386572251773, "num_env_steps_trained_throughput_per_sec": 236.62481479766373, "timesteps_total": 111300, "num_env_steps_sampled_lifetime": 111300, "num_agent_steps_sampled_lifetime": 111300, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 111300, "timers": {"training_iteration_time_ms": 10323.647, "restore_workers_time_ms": 0.016, "training_step_time_ms": 597.517, "sample_time_ms": 581.95, "synch_weights_time_ms": 14.101}, "counters": {"num_env_steps_sampled": 111300, "num_env_steps_trained": 111000, "num_agent_steps_sampled": 111300, "num_agent_steps_trained": 111000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 742, "num_samples_added_to_queue": 111300}, "done": false, "training_iteration": 44, "trial_id": "27800_00000", "date": "2024-10-12_15-35-24", "timestamp": 1728743724, "time_this_iter_s": 10.152179956436157, "time_total_s": 453.56924200057983, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d27c70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 453.56924200057983, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 16.392857142857142, "ram_util_percent": 35.81428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 463421.4375, "policy_loss": 450694.625, "entropy": 20.64985466003418, "entropy_coeff": 0.01, "var_gnorm": 16.4061279296875, "vf_loss": 1278875.625, "vf_explained_var": 0.09270870685577393}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 379.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 113850, "num_env_steps_trained": 113700, "num_agent_steps_sampled": 113850, "num_agent_steps_trained": 113700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 759, "num_samples_added_to_queue": 113700, "learner_queue": {"size_count": 379, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.573, "learner_load_time_ms": 0.312, "learner_load_wait_time_ms": 1153.94, "learner_dequeue_time_ms": 9813.394}}, "env_runners": {"episode_reward_max": 919.5583333333349, "episode_reward_min": 753.1916666666685, "episode_reward_mean": 845.9092500000017, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 753.1916666666685}, "policy_reward_max": {"default_policy": 919.5583333333349}, "policy_reward_mean": {"default_policy": 845.9092500000017}, "custom_metrics": {"num_consolidated_mean": 2.1122, "num_consolidated_min": 1.92, "num_consolidated_max": 2.33, "num_overloaded_mean": 0.0483, "num_overloaded_min": 0.0, "num_overloaded_max": 0.14, "num_moves_mean": 7.471099999999999, "num_moves_min": 6.96, "num_moves_max": 8.06, "mean_accuracy_mean": 42.30662666666668, "mean_accuracy_min": 42.05633333333335, "mean_accuracy_max": 42.480666666666686, "num_model_switches_mean": 4.1263, "num_model_switches_min": 3.62, "num_model_switches_max": 4.73, "num_slav_mean": 0.131133, "num_slav_min": 0.10861666666666667, "num_slav_max": 0.14971666666666666, "cpu_conserved_cost_mean": 4.9774, "cpu_conserved_cost_min": 4.38, "cpu_conserved_cost_max": 5.6, "mean_cluster_cpu_util_mean": 0.47728083042406505, "mean_cluster_cpu_util_min": 0.46833538373846245, "mean_cluster_cpu_util_max": 0.48863835225730107, "mean_cluster_mem_util_mean": 0.31098095679411, "mean_cluster_mem_util_min": 0.30627779320588994, "mean_cluster_mem_util_max": 0.3185262392720801, "reward_consolidation_mean_mean": 4.156458333333332, "reward_consolidation_mean_min": 3.729166666666666, "reward_consolidation_mean_max": 4.583333333333332, "reward_illegal_mean_mean": -0.08049999999999999, "reward_illegal_mean_min": -0.2333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.252666666666682, "reward_accuracy_mean_min": 5.666666666666682, "reward_accuracy_mean_max": 6.816666666666686, "reward_sla_mean_mean": -1.8695325, "reward_sla_mean_min": -2.1955, "reward_sla_mean_max": -1.5545000000000002, "reward_consolidation_sum_mean": 415.64583333333337, "reward_consolidation_sum_min": 372.91666666666663, "reward_consolidation_sum_max": 458.33333333333326, "reward_illegal_sum_mean": -8.05, "reward_illegal_sum_min": -23.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 625.2666666666684, "reward_accuracy_sum_min": 566.6666666666682, "reward_accuracy_sum_max": 681.6666666666686, "reward_sla_sum_mean": -186.95325, "reward_sla_sum_min": -219.55, "reward_sla_sum_max": -155.45000000000002, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5083.0, "global_timestep_min": 3400, "global_timestep_max": 6700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [805.0083333333351, 816.9333333333353, 813.891666666668, 797.0083333333353, 856.7333333333355, 796.308333333335, 838.0000000000015, 784.5833333333348, 847.7583333333351, 805.2333333333345, 809.9583333333348, 830.7166666666681, 796.6916666666683, 816.4083333333352, 861.2000000000015, 837.0333333333349, 811.1750000000023, 835.4333333333348, 802.4583333333348, 820.316666666668, 832.5250000000017, 813.2750000000016, 769.5750000000016, 845.8666666666686, 845.0416666666686, 880.0166666666692, 753.1916666666685, 853.9666666666687, 815.2250000000017, 874.7166666666687, 897.250000000002, 828.4083333333347, 889.1416666666685, 889.5750000000021, 807.9583333333348, 879.3000000000019, 781.9833333333354, 874.1416666666679, 799.4000000000018, 869.4666666666686, 866.2500000000016, 861.8166666666684, 853.2916666666686, 810.5333333333353, 877.2666666666686, 857.3416666666684, 792.6750000000018, 845.0166666666685, 833.7000000000021, 919.5583333333349, 902.6833333333352, 808.825000000002, 879.0166666666685, 869.6333333333348, 838.5000000000019, 861.9833333333349, 847.5583333333354, 901.7666666666681, 849.200000000002, 819.3500000000018, 834.0500000000018, 827.633333333335, 875.4916666666684, 841.6083333333353, 834.5250000000013, 810.4250000000015, 876.6583333333351, 810.7333333333349, 849.4333333333349, 850.633333333335, 919.1000000000021, 859.2333333333354, 872.6666666666686, 839.1333333333354, 829.8500000000017, 861.1250000000022, 874.716666666668, 853.0333333333351, 797.2166666666684, 856.2250000000014, 914.4000000000013, 837.1250000000018, 891.7000000000018, 880.9416666666682, 840.8916666666682, 880.7916666666681, 876.4083333333356, 855.7333333333357, 843.5666666666687, 889.7416666666685, 861.525000000002, 800.6666666666684, 901.1666666666684, 840.7000000000015, 903.9416666666683, 865.1416666666685, 838.9250000000015, 891.7833333333352, 840.0083333333348, 883.4333333333353], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [805.0083333333351, 816.9333333333353, 813.891666666668, 797.0083333333353, 856.7333333333355, 796.308333333335, 838.0000000000015, 784.5833333333348, 847.7583333333351, 805.2333333333345, 809.9583333333348, 830.7166666666681, 796.6916666666683, 816.4083333333352, 861.2000000000015, 837.0333333333349, 811.1750000000023, 835.4333333333348, 802.4583333333348, 820.316666666668, 832.5250000000017, 813.2750000000016, 769.5750000000016, 845.8666666666686, 845.0416666666686, 880.0166666666692, 753.1916666666685, 853.9666666666687, 815.2250000000017, 874.7166666666687, 897.250000000002, 828.4083333333347, 889.1416666666685, 889.5750000000021, 807.9583333333348, 879.3000000000019, 781.9833333333354, 874.1416666666679, 799.4000000000018, 869.4666666666686, 866.2500000000016, 861.8166666666684, 853.2916666666686, 810.5333333333353, 877.2666666666686, 857.3416666666684, 792.6750000000018, 845.0166666666685, 833.7000000000021, 919.5583333333349, 902.6833333333352, 808.825000000002, 879.0166666666685, 869.6333333333348, 838.5000000000019, 861.9833333333349, 847.5583333333354, 901.7666666666681, 849.200000000002, 819.3500000000018, 834.0500000000018, 827.633333333335, 875.4916666666684, 841.6083333333353, 834.5250000000013, 810.4250000000015, 876.6583333333351, 810.7333333333349, 849.4333333333349, 850.633333333335, 919.1000000000021, 859.2333333333354, 872.6666666666686, 839.1333333333354, 829.8500000000017, 861.1250000000022, 874.716666666668, 853.0333333333351, 797.2166666666684, 856.2250000000014, 914.4000000000013, 837.1250000000018, 891.7000000000018, 880.9416666666682, 840.8916666666682, 880.7916666666681, 876.4083333333356, 855.7333333333357, 843.5666666666687, 889.7416666666685, 861.525000000002, 800.6666666666684, 901.1666666666684, 840.7000000000015, 903.9416666666683, 865.1416666666685, 838.9250000000015, 891.7833333333352, 840.0083333333348, 883.4333333333353]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2408663014701029, "mean_inference_ms": 2.047747368536834, "mean_action_processing_ms": 0.09061420298668475, "mean_env_wait_ms": 1.5316067413034657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006300687789916992, "StateBufferConnector_ms": 0.003221273422241211, "ViewRequirementAgentConnector_ms": 0.08394408226013184}, "num_episodes": 24, "episode_return_max": 919.5583333333349, "episode_return_min": 753.1916666666685, "episode_return_mean": 845.9092500000017, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 113850, "num_agent_steps_trained": 113700, "num_env_steps_sampled": 113850, "num_env_steps_trained": 113700, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 246.94493280313915, "num_env_steps_trained_throughput_per_sec": 261.4711053209709, "timesteps_total": 113850, "num_env_steps_sampled_lifetime": 113850, "num_agent_steps_sampled_lifetime": 113850, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 113850, "timers": {"training_iteration_time_ms": 10316.829, "restore_workers_time_ms": 0.015, "training_step_time_ms": 614.351, "sample_time_ms": 597.659, "synch_weights_time_ms": 15.136}, "counters": {"num_env_steps_sampled": 113850, "num_env_steps_trained": 113700, "num_agent_steps_sampled": 113850, "num_agent_steps_trained": 113700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 759, "num_samples_added_to_queue": 113700}, "done": false, "training_iteration": 45, "trial_id": "27800_00000", "date": "2024-10-12_15-35-34", "timestamp": 1728743734, "time_this_iter_s": 10.337069272994995, "time_total_s": 463.90631127357483, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f69270>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 463.90631127357483, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 16.6, "ram_util_percent": 36.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 456254.3125, "policy_loss": 443563.53125, "entropy": 20.258333206176758, "entropy_coeff": 0.01, "var_gnorm": 16.417409896850586, "vf_loss": 1275155.0, "vf_explained_var": 0.0962938666343689}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 387.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 116400, "num_env_steps_trained": 116100, "num_agent_steps_sampled": 116400, "num_agent_steps_trained": 116100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 776, "num_samples_added_to_queue": 116400, "learner_queue": {"size_count": 387, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.501, "learner_load_time_ms": 0.322, "learner_load_wait_time_ms": 1181.067, "learner_dequeue_time_ms": 9816.836}}, "env_runners": {"episode_reward_max": 924.408333333335, "episode_reward_min": 781.9833333333354, "episode_reward_mean": 863.4315833333353, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 781.9833333333354}, "policy_reward_max": {"default_policy": 924.408333333335}, "policy_reward_mean": {"default_policy": 863.4315833333353}, "custom_metrics": {"num_consolidated_mean": 2.1463, "num_consolidated_min": 1.95, "num_consolidated_max": 2.35, "num_overloaded_mean": 0.045500000000000006, "num_overloaded_min": 0.0, "num_overloaded_max": 0.1, "num_moves_mean": 7.353900000000001, "num_moves_min": 6.84, "num_moves_max": 7.79, "mean_accuracy_mean": 42.301180000000016, "mean_accuracy_min": 42.05633333333335, "mean_accuracy_max": 42.480666666666686, "num_model_switches_mean": 4.025200000000001, "num_model_switches_min": 3.45, "num_model_switches_max": 4.44, "num_slav_mean": 0.12536633333333333, "num_slav_min": 0.10400000000000001, "num_slav_max": 0.14971666666666666, "cpu_conserved_cost_mean": 5.0653999999999995, "cpu_conserved_cost_min": 4.48, "cpu_conserved_cost_max": 5.74, "mean_cluster_cpu_util_mean": 0.4773822239324189, "mean_cluster_cpu_util_min": 0.46833538373846245, "mean_cluster_cpu_util_max": 0.4893369919869642, "mean_cluster_mem_util_mean": 0.3108970054895375, "mean_cluster_mem_util_min": 0.30556859984500134, "mean_cluster_mem_util_max": 0.3168491080398404, "reward_consolidation_mean_mean": 4.236458333333333, "reward_consolidation_mean_min": 3.7499999999999987, "reward_consolidation_mean_max": 4.583333333333332, "reward_illegal_mean_mean": -0.07583333333333331, "reward_illegal_mean_min": -0.16666666666666663, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.267333333333349, "reward_accuracy_mean_min": 5.866666666666682, "reward_accuracy_mean_max": 6.816666666666686, "reward_sla_mean_mean": -1.7936425, "reward_sla_mean_min": -2.1917500000000003, "reward_sla_mean_max": -1.4617499999999999, "reward_consolidation_sum_mean": 423.64583333333326, "reward_consolidation_sum_min": 374.9999999999999, "reward_consolidation_sum_max": 458.33333333333326, "reward_illegal_sum_mean": -7.583333333333331, "reward_illegal_sum_min": -16.666666666666664, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 626.7333333333352, "reward_accuracy_sum_min": 586.6666666666682, "reward_accuracy_sum_max": 681.6666666666686, "reward_sla_sum_mean": -179.36425, "reward_sla_sum_min": -219.175, "reward_sla_sum_max": -146.17499999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5982.0, "global_timestep_min": 4300, "global_timestep_max": 7600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [853.9666666666687, 815.2250000000017, 874.7166666666687, 897.250000000002, 828.4083333333347, 889.1416666666685, 889.5750000000021, 807.9583333333348, 879.3000000000019, 781.9833333333354, 874.1416666666679, 799.4000000000018, 869.4666666666686, 866.2500000000016, 861.8166666666684, 853.2916666666686, 810.5333333333353, 877.2666666666686, 857.3416666666684, 792.6750000000018, 845.0166666666685, 833.7000000000021, 919.5583333333349, 902.6833333333352, 808.825000000002, 879.0166666666685, 869.6333333333348, 838.5000000000019, 861.9833333333349, 847.5583333333354, 901.7666666666681, 849.200000000002, 819.3500000000018, 834.0500000000018, 827.633333333335, 875.4916666666684, 841.6083333333353, 834.5250000000013, 810.4250000000015, 876.6583333333351, 810.7333333333349, 849.4333333333349, 850.633333333335, 919.1000000000021, 859.2333333333354, 872.6666666666686, 839.1333333333354, 829.8500000000017, 861.1250000000022, 874.716666666668, 853.0333333333351, 797.2166666666684, 856.2250000000014, 914.4000000000013, 837.1250000000018, 891.7000000000018, 880.9416666666682, 840.8916666666682, 880.7916666666681, 876.4083333333356, 855.7333333333357, 843.5666666666687, 889.7416666666685, 861.525000000002, 800.6666666666684, 901.1666666666684, 840.7000000000015, 903.9416666666683, 865.1416666666685, 838.9250000000015, 891.7833333333352, 840.0083333333348, 883.4333333333353, 881.7833333333349, 861.5000000000019, 911.9750000000016, 871.4083333333351, 835.3083333333348, 900.6916666666687, 895.4833333333354, 841.9500000000014, 901.2750000000017, 856.7500000000016, 889.9916666666686, 899.9500000000016, 924.408333333335, 883.6500000000017, 897.5750000000022, 888.7416666666687, 879.233333333335, 915.8500000000015, 869.6333333333351, 892.8833333333348, 914.6250000000018, 912.0333333333355, 862.283333333335, 845.8416666666682, 884.9666666666685, 910.2583333333355, 844.5250000000016], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [853.9666666666687, 815.2250000000017, 874.7166666666687, 897.250000000002, 828.4083333333347, 889.1416666666685, 889.5750000000021, 807.9583333333348, 879.3000000000019, 781.9833333333354, 874.1416666666679, 799.4000000000018, 869.4666666666686, 866.2500000000016, 861.8166666666684, 853.2916666666686, 810.5333333333353, 877.2666666666686, 857.3416666666684, 792.6750000000018, 845.0166666666685, 833.7000000000021, 919.5583333333349, 902.6833333333352, 808.825000000002, 879.0166666666685, 869.6333333333348, 838.5000000000019, 861.9833333333349, 847.5583333333354, 901.7666666666681, 849.200000000002, 819.3500000000018, 834.0500000000018, 827.633333333335, 875.4916666666684, 841.6083333333353, 834.5250000000013, 810.4250000000015, 876.6583333333351, 810.7333333333349, 849.4333333333349, 850.633333333335, 919.1000000000021, 859.2333333333354, 872.6666666666686, 839.1333333333354, 829.8500000000017, 861.1250000000022, 874.716666666668, 853.0333333333351, 797.2166666666684, 856.2250000000014, 914.4000000000013, 837.1250000000018, 891.7000000000018, 880.9416666666682, 840.8916666666682, 880.7916666666681, 876.4083333333356, 855.7333333333357, 843.5666666666687, 889.7416666666685, 861.525000000002, 800.6666666666684, 901.1666666666684, 840.7000000000015, 903.9416666666683, 865.1416666666685, 838.9250000000015, 891.7833333333352, 840.0083333333348, 883.4333333333353, 881.7833333333349, 861.5000000000019, 911.9750000000016, 871.4083333333351, 835.3083333333348, 900.6916666666687, 895.4833333333354, 841.9500000000014, 901.2750000000017, 856.7500000000016, 889.9916666666686, 899.9500000000016, 924.408333333335, 883.6500000000017, 897.5750000000022, 888.7416666666687, 879.233333333335, 915.8500000000015, 869.6333333333351, 892.8833333333348, 914.6250000000018, 912.0333333333355, 862.283333333335, 845.8416666666682, 884.9666666666685, 910.2583333333355, 844.5250000000016]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24082742549438949, "mean_inference_ms": 2.0459079478549533, "mean_action_processing_ms": 0.09060004938870722, "mean_env_wait_ms": 1.5312774768014459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006331682205200195, "StateBufferConnector_ms": 0.003261566162109375, "ViewRequirementAgentConnector_ms": 0.0841054916381836}, "num_episodes": 27, "episode_return_max": 924.408333333335, "episode_return_min": 781.9833333333354, "episode_return_mean": 863.4315833333353, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116400, "num_agent_steps_trained": 116100, "num_env_steps_sampled": 116400, "num_env_steps_trained": 116100, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 240.81496539409662, "num_env_steps_trained_throughput_per_sec": 226.64937919444387, "timesteps_total": 116400, "num_env_steps_sampled_lifetime": 116400, "num_agent_steps_sampled_lifetime": 116400, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 116400, "timers": {"training_iteration_time_ms": 10331.856, "restore_workers_time_ms": 0.015, "training_step_time_ms": 629.724, "sample_time_ms": 612.438, "synch_weights_time_ms": 15.733}, "counters": {"num_env_steps_sampled": 116400, "num_env_steps_trained": 116100, "num_agent_steps_sampled": 116400, "num_agent_steps_trained": 116100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 776, "num_samples_added_to_queue": 116400}, "done": false, "training_iteration": 46, "trial_id": "27800_00000", "date": "2024-10-12_15-35-45", "timestamp": 1728743745, "time_this_iter_s": 10.601969480514526, "time_total_s": 474.50828075408936, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a945ee37c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 474.50828075408936, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 16.266666666666666, "ram_util_percent": 36.17333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 429329.90625, "policy_loss": 415988.53125, "entropy": 19.43169403076172, "entropy_coeff": 0.01, "var_gnorm": 16.42934226989746, "vf_loss": 1339965.5, "vf_explained_var": 0.10269999504089355}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 396.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 118950, "num_env_steps_trained": 118800, "num_agent_steps_sampled": 118950, "num_agent_steps_trained": 118800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 793, "num_samples_added_to_queue": 118800, "learner_queue": {"size_count": 396, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.887, "learner_load_time_ms": 0.306, "learner_load_wait_time_ms": 1173.129, "learner_dequeue_time_ms": 9817.343}}, "env_runners": {"episode_reward_max": 967.0333333333356, "episode_reward_min": 797.2166666666684, "episode_reward_mean": 873.116583333335, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 797.2166666666684}, "policy_reward_max": {"default_policy": 967.0333333333356}, "policy_reward_mean": {"default_policy": 873.116583333335}, "custom_metrics": {"num_consolidated_mean": 2.1902, "num_consolidated_min": 1.98, "num_consolidated_max": 2.4, "num_overloaded_mean": 0.049, "num_overloaded_min": 0.01, "num_overloaded_max": 0.1, "num_moves_mean": 7.2139, "num_moves_min": 6.47, "num_moves_max": 7.76, "mean_accuracy_mean": 42.27844333333334, "mean_accuracy_min": 42.05633333333335, "mean_accuracy_max": 42.46166666666669, "num_model_switches_mean": 3.9375000000000004, "num_model_switches_min": 3.43, "num_model_switches_max": 4.44, "num_slav_mean": 0.11962683333333331, "num_slav_min": 0.09596666666666667, "num_slav_max": 0.1449, "cpu_conserved_cost_mean": 5.193600000000001, "cpu_conserved_cost_min": 4.5, "cpu_conserved_cost_max": 5.86, "mean_cluster_cpu_util_mean": 0.4784203576305435, "mean_cluster_cpu_util_min": 0.46833538373846245, "mean_cluster_cpu_util_max": 0.4918432442554112, "mean_cluster_mem_util_mean": 0.31135232087244175, "mean_cluster_mem_util_min": 0.30556859984500134, "mean_cluster_mem_util_max": 0.31692705283590233, "reward_consolidation_mean_mean": 4.302083333333332, "reward_consolidation_mean_min": 3.916666666666667, "reward_consolidation_mean_max": 4.8125, "reward_illegal_mean_mean": -0.08166666666666667, "reward_illegal_mean_min": -0.16666666666666663, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 6.214166666666683, "reward_accuracy_mean_min": 5.850000000000015, "reward_accuracy_mean_max": 6.600000000000019, "reward_sla_mean_mean": -1.7034174999999998, "reward_sla_mean_min": -2.0742499999999997, "reward_sla_mean_max": -1.3477499999999998, "reward_consolidation_sum_mean": 430.20833333333326, "reward_consolidation_sum_min": 391.6666666666667, "reward_consolidation_sum_max": 481.25, "reward_illegal_sum_mean": -8.166666666666668, "reward_illegal_sum_min": -16.666666666666664, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 621.4166666666684, "reward_accuracy_sum_min": 585.0000000000015, "reward_accuracy_sum_max": 660.0000000000019, "reward_sla_sum_mean": -170.34175000000002, "reward_sla_sum_min": -207.42499999999998, "reward_sla_sum_max": -134.77499999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5378.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [808.825000000002, 879.0166666666685, 869.6333333333348, 838.5000000000019, 861.9833333333349, 847.5583333333354, 901.7666666666681, 849.200000000002, 819.3500000000018, 834.0500000000018, 827.633333333335, 875.4916666666684, 841.6083333333353, 834.5250000000013, 810.4250000000015, 876.6583333333351, 810.7333333333349, 849.4333333333349, 850.633333333335, 919.1000000000021, 859.2333333333354, 872.6666666666686, 839.1333333333354, 829.8500000000017, 861.1250000000022, 874.716666666668, 853.0333333333351, 797.2166666666684, 856.2250000000014, 914.4000000000013, 837.1250000000018, 891.7000000000018, 880.9416666666682, 840.8916666666682, 880.7916666666681, 876.4083333333356, 855.7333333333357, 843.5666666666687, 889.7416666666685, 861.525000000002, 800.6666666666684, 901.1666666666684, 840.7000000000015, 903.9416666666683, 865.1416666666685, 838.9250000000015, 891.7833333333352, 840.0083333333348, 883.4333333333353, 881.7833333333349, 861.5000000000019, 911.9750000000016, 871.4083333333351, 835.3083333333348, 900.6916666666687, 895.4833333333354, 841.9500000000014, 901.2750000000017, 856.7500000000016, 889.9916666666686, 899.9500000000016, 924.408333333335, 883.6500000000017, 897.5750000000022, 888.7416666666687, 879.233333333335, 915.8500000000015, 869.6333333333351, 892.8833333333348, 914.6250000000018, 912.0333333333355, 862.283333333335, 845.8416666666682, 884.9666666666685, 910.2583333333355, 844.5250000000016, 821.2916666666684, 902.9666666666684, 894.8416666666685, 880.9083333333352, 942.683333333335, 894.4833333333347, 967.0333333333356, 896.3500000000017, 885.616666666668, 882.116666666668, 862.7666666666678, 885.5250000000015, 952.8333333333351, 903.7250000000021, 915.8166666666683, 913.1416666666684, 831.1916666666688, 864.3833333333351, 865.591666666668, 942.4166666666688, 869.5166666666688, 889.9666666666681, 875.958333333335, 908.0416666666686], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [808.825000000002, 879.0166666666685, 869.6333333333348, 838.5000000000019, 861.9833333333349, 847.5583333333354, 901.7666666666681, 849.200000000002, 819.3500000000018, 834.0500000000018, 827.633333333335, 875.4916666666684, 841.6083333333353, 834.5250000000013, 810.4250000000015, 876.6583333333351, 810.7333333333349, 849.4333333333349, 850.633333333335, 919.1000000000021, 859.2333333333354, 872.6666666666686, 839.1333333333354, 829.8500000000017, 861.1250000000022, 874.716666666668, 853.0333333333351, 797.2166666666684, 856.2250000000014, 914.4000000000013, 837.1250000000018, 891.7000000000018, 880.9416666666682, 840.8916666666682, 880.7916666666681, 876.4083333333356, 855.7333333333357, 843.5666666666687, 889.7416666666685, 861.525000000002, 800.6666666666684, 901.1666666666684, 840.7000000000015, 903.9416666666683, 865.1416666666685, 838.9250000000015, 891.7833333333352, 840.0083333333348, 883.4333333333353, 881.7833333333349, 861.5000000000019, 911.9750000000016, 871.4083333333351, 835.3083333333348, 900.6916666666687, 895.4833333333354, 841.9500000000014, 901.2750000000017, 856.7500000000016, 889.9916666666686, 899.9500000000016, 924.408333333335, 883.6500000000017, 897.5750000000022, 888.7416666666687, 879.233333333335, 915.8500000000015, 869.6333333333351, 892.8833333333348, 914.6250000000018, 912.0333333333355, 862.283333333335, 845.8416666666682, 884.9666666666685, 910.2583333333355, 844.5250000000016, 821.2916666666684, 902.9666666666684, 894.8416666666685, 880.9083333333352, 942.683333333335, 894.4833333333347, 967.0333333333356, 896.3500000000017, 885.616666666668, 882.116666666668, 862.7666666666678, 885.5250000000015, 952.8333333333351, 903.7250000000021, 915.8166666666683, 913.1416666666684, 831.1916666666688, 864.3833333333351, 865.591666666668, 942.4166666666688, 869.5166666666688, 889.9666666666681, 875.958333333335, 908.0416666666686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24080626787922635, "mean_inference_ms": 2.04566156788521, "mean_action_processing_ms": 0.09060240012280538, "mean_env_wait_ms": 1.5312471560834322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006327390670776367, "StateBufferConnector_ms": 0.003269672393798828, "ViewRequirementAgentConnector_ms": 0.08434748649597168}, "num_episodes": 24, "episode_return_max": 967.0333333333356, "episode_return_min": 797.2166666666684, "episode_return_mean": 873.116583333335, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118950, "num_agent_steps_trained": 118800, "num_env_steps_sampled": 118950, "num_env_steps_trained": 118800, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 245.7078435418511, "num_env_steps_trained_throughput_per_sec": 260.1612461031365, "timesteps_total": 118950, "num_env_steps_sampled_lifetime": 118950, "num_agent_steps_sampled_lifetime": 118950, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 118950, "timers": {"training_iteration_time_ms": 10323.647, "restore_workers_time_ms": 0.013, "training_step_time_ms": 626.723, "sample_time_ms": 610.938, "synch_weights_time_ms": 14.253}, "counters": {"num_env_steps_sampled": 118950, "num_env_steps_trained": 118800, "num_agent_steps_sampled": 118950, "num_agent_steps_trained": 118800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 793, "num_samples_added_to_queue": 118800}, "done": false, "training_iteration": 47, "trial_id": "27800_00000", "date": "2024-10-12_15-35-55", "timestamp": 1728743755, "time_this_iter_s": 10.39204740524292, "time_total_s": 484.9003281593323, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f69420>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 484.9003281593323, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 16.733333333333334, "ram_util_percent": 36.353333333333325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 441469.90625, "policy_loss": 426439.4375, "entropy": 18.432748794555664, "entropy_coeff": 0.01, "var_gnorm": 16.445343017578125, "vf_loss": 1508577.25, "vf_explained_var": 0.10665667057037354}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 404.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 121500, "num_env_steps_trained": 121200, "num_agent_steps_sampled": 121500, "num_agent_steps_trained": 121200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 810, "num_samples_added_to_queue": 121500, "learner_queue": {"size_count": 404, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.237, "learner_load_time_ms": 0.329, "learner_load_wait_time_ms": 1154.047, "learner_dequeue_time_ms": 9843.426}}, "env_runners": {"episode_reward_max": 972.2416666666685, "episode_reward_min": 797.2166666666684, "episode_reward_mean": 892.3972500000019, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 797.2166666666684}, "policy_reward_max": {"default_policy": 972.2416666666685}, "policy_reward_mean": {"default_policy": 892.3972500000019}, "custom_metrics": {"num_consolidated_mean": 2.2468000000000004, "num_consolidated_min": 2.06, "num_consolidated_max": 2.45, "num_overloaded_mean": 0.04819999999999999, "num_overloaded_min": 0.01, "num_overloaded_max": 0.1, "num_moves_mean": 7.037100000000001, "num_moves_min": 6.39, "num_moves_max": 7.61, "mean_accuracy_mean": 42.25545333333334, "mean_accuracy_min": 42.05633333333335, "mean_accuracy_max": 42.46166666666669, "num_model_switches_mean": 3.8289, "num_model_switches_min": 3.3, "num_model_switches_max": 4.37, "num_slav_mean": 0.11268449999999999, "num_slav_min": 0.08503333333333334, "num_slav_max": 0.13641666666666669, "cpu_conserved_cost_mean": 5.3666, "cpu_conserved_cost_min": 4.68, "cpu_conserved_cost_max": 6.02, "mean_cluster_cpu_util_mean": 0.48001379381427867, "mean_cluster_cpu_util_min": 0.4688354534083623, "mean_cluster_cpu_util_max": 0.49272476734724835, "mean_cluster_mem_util_mean": 0.3122613305957404, "mean_cluster_mem_util_min": 0.30556859984500134, "mean_cluster_mem_util_max": 0.317732167613881, "reward_consolidation_mean_mean": 4.416874999999999, "reward_consolidation_mean_min": 3.916666666666667, "reward_consolidation_mean_max": 4.895833333333332, "reward_illegal_mean_mean": -0.08033333333333331, "reward_illegal_mean_min": -0.16666666666666663, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 6.1920833333333505, "reward_accuracy_mean_min": 5.816666666666681, "reward_accuracy_mean_max": 6.591666666666685, "reward_sla_mean_mean": -1.6046525, "reward_sla_mean_min": -1.98475, "reward_sla_mean_max": -1.21475, "reward_consolidation_sum_mean": 441.68749999999994, "reward_consolidation_sum_min": 391.6666666666667, "reward_consolidation_sum_max": 489.5833333333332, "reward_illegal_sum_mean": -8.03333333333333, "reward_illegal_sum_min": -16.666666666666664, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 619.2083333333351, "reward_accuracy_sum_min": 581.6666666666681, "reward_accuracy_sum_max": 659.1666666666686, "reward_sla_sum_mean": -160.46525, "reward_sla_sum_min": -198.475, "reward_sla_sum_max": -121.475, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4172.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [797.2166666666684, 856.2250000000014, 914.4000000000013, 837.1250000000018, 891.7000000000018, 880.9416666666682, 840.8916666666682, 880.7916666666681, 876.4083333333356, 855.7333333333357, 843.5666666666687, 889.7416666666685, 861.525000000002, 800.6666666666684, 901.1666666666684, 840.7000000000015, 903.9416666666683, 865.1416666666685, 838.9250000000015, 891.7833333333352, 840.0083333333348, 883.4333333333353, 881.7833333333349, 861.5000000000019, 911.9750000000016, 871.4083333333351, 835.3083333333348, 900.6916666666687, 895.4833333333354, 841.9500000000014, 901.2750000000017, 856.7500000000016, 889.9916666666686, 899.9500000000016, 924.408333333335, 883.6500000000017, 897.5750000000022, 888.7416666666687, 879.233333333335, 915.8500000000015, 869.6333333333351, 892.8833333333348, 914.6250000000018, 912.0333333333355, 862.283333333335, 845.8416666666682, 884.9666666666685, 910.2583333333355, 844.5250000000016, 821.2916666666684, 902.9666666666684, 894.8416666666685, 880.9083333333352, 942.683333333335, 894.4833333333347, 967.0333333333356, 896.3500000000017, 885.616666666668, 882.116666666668, 862.7666666666678, 885.5250000000015, 952.8333333333351, 903.7250000000021, 915.8166666666683, 913.1416666666684, 831.1916666666688, 864.3833333333351, 865.591666666668, 942.4166666666688, 869.5166666666688, 889.9666666666681, 875.958333333335, 908.0416666666686, 928.6666666666682, 903.9333333333345, 926.5250000000024, 923.4666666666689, 920.2166666666687, 942.9250000000017, 908.8666666666686, 954.241666666669, 940.075000000002, 952.933333333335, 947.1166666666685, 913.7500000000016, 885.2750000000017, 876.3250000000021, 920.6666666666682, 844.7250000000018, 965.400000000002, 922.9666666666682, 939.4500000000016, 905.5583333333351, 894.1416666666686, 921.8416666666682, 889.783333333335, 925.4916666666684, 972.2416666666685, 950.0916666666684, 947.2750000000017], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [797.2166666666684, 856.2250000000014, 914.4000000000013, 837.1250000000018, 891.7000000000018, 880.9416666666682, 840.8916666666682, 880.7916666666681, 876.4083333333356, 855.7333333333357, 843.5666666666687, 889.7416666666685, 861.525000000002, 800.6666666666684, 901.1666666666684, 840.7000000000015, 903.9416666666683, 865.1416666666685, 838.9250000000015, 891.7833333333352, 840.0083333333348, 883.4333333333353, 881.7833333333349, 861.5000000000019, 911.9750000000016, 871.4083333333351, 835.3083333333348, 900.6916666666687, 895.4833333333354, 841.9500000000014, 901.2750000000017, 856.7500000000016, 889.9916666666686, 899.9500000000016, 924.408333333335, 883.6500000000017, 897.5750000000022, 888.7416666666687, 879.233333333335, 915.8500000000015, 869.6333333333351, 892.8833333333348, 914.6250000000018, 912.0333333333355, 862.283333333335, 845.8416666666682, 884.9666666666685, 910.2583333333355, 844.5250000000016, 821.2916666666684, 902.9666666666684, 894.8416666666685, 880.9083333333352, 942.683333333335, 894.4833333333347, 967.0333333333356, 896.3500000000017, 885.616666666668, 882.116666666668, 862.7666666666678, 885.5250000000015, 952.8333333333351, 903.7250000000021, 915.8166666666683, 913.1416666666684, 831.1916666666688, 864.3833333333351, 865.591666666668, 942.4166666666688, 869.5166666666688, 889.9666666666681, 875.958333333335, 908.0416666666686, 928.6666666666682, 903.9333333333345, 926.5250000000024, 923.4666666666689, 920.2166666666687, 942.9250000000017, 908.8666666666686, 954.241666666669, 940.075000000002, 952.933333333335, 947.1166666666685, 913.7500000000016, 885.2750000000017, 876.3250000000021, 920.6666666666682, 844.7250000000018, 965.400000000002, 922.9666666666682, 939.4500000000016, 905.5583333333351, 894.1416666666686, 921.8416666666682, 889.783333333335, 925.4916666666684, 972.2416666666685, 950.0916666666684, 947.2750000000017]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2408113651450058, "mean_inference_ms": 2.0455049372552203, "mean_action_processing_ms": 0.09061817169374997, "mean_env_wait_ms": 1.531359324921919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006528139114379883, "StateBufferConnector_ms": 0.003234386444091797, "ViewRequirementAgentConnector_ms": 0.08310294151306152}, "num_episodes": 27, "episode_return_max": 972.2416666666685, "episode_return_min": 797.2166666666684, "episode_return_mean": 892.3972500000019, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 121500, "num_agent_steps_trained": 121200, "num_env_steps_sampled": 121500, "num_env_steps_trained": 121200, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 248.05086256985558, "num_env_steps_trained_throughput_per_sec": 233.45963535986405, "timesteps_total": 121500, "num_env_steps_sampled_lifetime": 121500, "num_agent_steps_sampled_lifetime": 121500, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 121500, "timers": {"training_iteration_time_ms": 10335.806, "restore_workers_time_ms": 0.013, "training_step_time_ms": 588.47, "sample_time_ms": 573.91, "synch_weights_time_ms": 13.219}, "counters": {"num_env_steps_sampled": 121500, "num_env_steps_trained": 121200, "num_agent_steps_sampled": 121500, "num_agent_steps_trained": 121200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 810, "num_samples_added_to_queue": 121500}, "done": false, "training_iteration": 48, "trial_id": "27800_00000", "date": "2024-10-12_15-36-06", "timestamp": 1728743766, "time_this_iter_s": 10.290180444717407, "time_total_s": 495.1905086040497, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c2d70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 495.1905086040497, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 16.486666666666668, "ram_util_percent": 36.446666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 452034.21875, "policy_loss": 436846.84375, "entropy": 18.677963256835938, "entropy_coeff": 0.01, "var_gnorm": 16.456628799438477, "vf_loss": 1524341.5, "vf_explained_var": 0.10747569799423218}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 413.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 124050, "num_env_steps_trained": 123900, "num_agent_steps_sampled": 124050, "num_agent_steps_trained": 123900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 827, "num_samples_added_to_queue": 123900, "learner_queue": {"size_count": 413, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.024, "learner_load_time_ms": 0.356, "learner_load_wait_time_ms": 1149.383, "learner_dequeue_time_ms": 9812.104}}, "env_runners": {"episode_reward_max": 972.2416666666685, "episode_reward_min": 821.2916666666684, "episode_reward_mean": 907.2254166666684, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 821.2916666666684}, "policy_reward_max": {"default_policy": 972.2416666666685}, "policy_reward_mean": {"default_policy": 907.2254166666684}, "custom_metrics": {"num_consolidated_mean": 2.3013, "num_consolidated_min": 2.06, "num_consolidated_max": 2.55, "num_overloaded_mean": 0.04939999999999999, "num_overloaded_min": 0.01, "num_overloaded_max": 0.1, "num_moves_mean": 6.841799999999999, "num_moves_min": 6.07, "num_moves_max": 7.61, "mean_accuracy_mean": 42.22980333333334, "mean_accuracy_min": 42.02466666666668, "mean_accuracy_max": 42.43633333333335, "num_model_switches_mean": 3.7454999999999994, "num_model_switches_min": 3.29, "num_model_switches_max": 4.37, "num_slav_mean": 0.10651350000000001, "num_slav_min": 0.08503333333333334, "num_slav_max": 0.12848333333333334, "cpu_conserved_cost_mean": 5.5376, "cpu_conserved_cost_min": 4.68, "cpu_conserved_cost_max": 6.42, "mean_cluster_cpu_util_mean": 0.4816885107926573, "mean_cluster_cpu_util_min": 0.4690473004975341, "mean_cluster_cpu_util_max": 0.49640682708158884, "mean_cluster_mem_util_mean": 0.3131740168973708, "mean_cluster_mem_util_min": 0.30556859984500134, "mean_cluster_mem_util_max": 0.32186783848560524, "reward_consolidation_mean_mean": 4.517916666666666, "reward_consolidation_mean_min": 4.041666666666666, "reward_consolidation_mean_max": 4.937499999999999, "reward_illegal_mean_mean": -0.08233333333333331, "reward_illegal_mean_min": -0.16666666666666663, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 6.15158333333335, "reward_accuracy_mean_min": 5.741666666666682, "reward_accuracy_mean_max": 6.591666666666685, "reward_sla_mean_mean": -1.5149125, "reward_sla_mean_min": -1.8104999999999998, "reward_sla_mean_max": -1.17975, "reward_consolidation_sum_mean": 451.79166666666663, "reward_consolidation_sum_min": 404.1666666666666, "reward_consolidation_sum_max": 493.74999999999994, "reward_illegal_sum_mean": -8.233333333333334, "reward_illegal_sum_min": -16.666666666666664, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 615.158333333335, "reward_accuracy_sum_min": 574.1666666666682, "reward_accuracy_sum_max": 659.1666666666686, "reward_sla_sum_mean": -151.49124999999998, "reward_sla_sum_min": -181.04999999999998, "reward_sla_sum_max": -117.97500000000001, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3100.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [911.9750000000016, 871.4083333333351, 835.3083333333348, 900.6916666666687, 895.4833333333354, 841.9500000000014, 901.2750000000017, 856.7500000000016, 889.9916666666686, 899.9500000000016, 924.408333333335, 883.6500000000017, 897.5750000000022, 888.7416666666687, 879.233333333335, 915.8500000000015, 869.6333333333351, 892.8833333333348, 914.6250000000018, 912.0333333333355, 862.283333333335, 845.8416666666682, 884.9666666666685, 910.2583333333355, 844.5250000000016, 821.2916666666684, 902.9666666666684, 894.8416666666685, 880.9083333333352, 942.683333333335, 894.4833333333347, 967.0333333333356, 896.3500000000017, 885.616666666668, 882.116666666668, 862.7666666666678, 885.5250000000015, 952.8333333333351, 903.7250000000021, 915.8166666666683, 913.1416666666684, 831.1916666666688, 864.3833333333351, 865.591666666668, 942.4166666666688, 869.5166666666688, 889.9666666666681, 875.958333333335, 908.0416666666686, 928.6666666666682, 903.9333333333345, 926.5250000000024, 923.4666666666689, 920.2166666666687, 942.9250000000017, 908.8666666666686, 954.241666666669, 940.075000000002, 952.933333333335, 947.1166666666685, 913.7500000000016, 885.2750000000017, 876.3250000000021, 920.6666666666682, 844.7250000000018, 965.400000000002, 922.9666666666682, 939.4500000000016, 905.5583333333351, 894.1416666666686, 921.8416666666682, 889.783333333335, 925.4916666666684, 972.2416666666685, 950.0916666666684, 947.2750000000017, 936.9666666666683, 966.875000000002, 923.5916666666683, 934.2666666666689, 920.6666666666682, 934.8333333333347, 930.0750000000015, 954.0666666666684, 914.4000000000017, 957.4333333333349, 903.3166666666682, 927.1333333333351, 945.0000000000018, 903.9833333333355, 930.9583333333354, 929.5166666666686, 922.2666666666685, 943.0500000000018, 862.275000000001, 921.4666666666689, 917.4416666666683, 923.375000000002, 913.933333333335, 901.2416666666686], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [911.9750000000016, 871.4083333333351, 835.3083333333348, 900.6916666666687, 895.4833333333354, 841.9500000000014, 901.2750000000017, 856.7500000000016, 889.9916666666686, 899.9500000000016, 924.408333333335, 883.6500000000017, 897.5750000000022, 888.7416666666687, 879.233333333335, 915.8500000000015, 869.6333333333351, 892.8833333333348, 914.6250000000018, 912.0333333333355, 862.283333333335, 845.8416666666682, 884.9666666666685, 910.2583333333355, 844.5250000000016, 821.2916666666684, 902.9666666666684, 894.8416666666685, 880.9083333333352, 942.683333333335, 894.4833333333347, 967.0333333333356, 896.3500000000017, 885.616666666668, 882.116666666668, 862.7666666666678, 885.5250000000015, 952.8333333333351, 903.7250000000021, 915.8166666666683, 913.1416666666684, 831.1916666666688, 864.3833333333351, 865.591666666668, 942.4166666666688, 869.5166666666688, 889.9666666666681, 875.958333333335, 908.0416666666686, 928.6666666666682, 903.9333333333345, 926.5250000000024, 923.4666666666689, 920.2166666666687, 942.9250000000017, 908.8666666666686, 954.241666666669, 940.075000000002, 952.933333333335, 947.1166666666685, 913.7500000000016, 885.2750000000017, 876.3250000000021, 920.6666666666682, 844.7250000000018, 965.400000000002, 922.9666666666682, 939.4500000000016, 905.5583333333351, 894.1416666666686, 921.8416666666682, 889.783333333335, 925.4916666666684, 972.2416666666685, 950.0916666666684, 947.2750000000017, 936.9666666666683, 966.875000000002, 923.5916666666683, 934.2666666666689, 920.6666666666682, 934.8333333333347, 930.0750000000015, 954.0666666666684, 914.4000000000017, 957.4333333333349, 903.3166666666682, 927.1333333333351, 945.0000000000018, 903.9833333333355, 930.9583333333354, 929.5166666666686, 922.2666666666685, 943.0500000000018, 862.275000000001, 921.4666666666689, 917.4416666666683, 923.375000000002, 913.933333333335, 901.2416666666686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24083681479165084, "mean_inference_ms": 2.045565244959393, "mean_action_processing_ms": 0.09062974779886118, "mean_env_wait_ms": 1.5314288886679759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006800651550292969, "StateBufferConnector_ms": 0.0032384395599365234, "ViewRequirementAgentConnector_ms": 0.0834188461303711}, "num_episodes": 24, "episode_return_max": 972.2416666666685, "episode_return_min": 821.2916666666684, "episode_return_mean": 907.2254166666684, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124050, "num_agent_steps_trained": 123900, "num_env_steps_sampled": 124050, "num_env_steps_trained": 123900, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 245.02950578587587, "num_env_steps_trained_throughput_per_sec": 259.4430061262215, "timesteps_total": 124050, "num_env_steps_sampled_lifetime": 124050, "num_agent_steps_sampled_lifetime": 124050, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 124050, "timers": {"training_iteration_time_ms": 10337.656, "restore_workers_time_ms": 0.016, "training_step_time_ms": 623.26, "sample_time_ms": 608.312, "synch_weights_time_ms": 13.549}, "counters": {"num_env_steps_sampled": 124050, "num_env_steps_trained": 123900, "num_agent_steps_sampled": 124050, "num_agent_steps_trained": 123900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 827, "num_samples_added_to_queue": 123900}, "done": false, "training_iteration": 49, "trial_id": "27800_00000", "date": "2024-10-12_15-36-16", "timestamp": 1728743776, "time_this_iter_s": 10.419734001159668, "time_total_s": 505.61024260520935, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486c3a30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 505.61024260520935, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 16.32, "ram_util_percent": 36.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 453915.90625, "policy_loss": 438881.40625, "entropy": 18.607450485229492, "entropy_coeff": 0.01, "var_gnorm": 16.462121963500977, "vf_loss": 1509031.375, "vf_explained_var": 0.11729520559310913}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 421.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 126600, "num_env_steps_trained": 126300, "num_agent_steps_sampled": 126600, "num_agent_steps_trained": 126300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 844, "num_samples_added_to_queue": 126600, "learner_queue": {"size_count": 421, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.287, "learner_load_time_ms": 0.364, "learner_load_wait_time_ms": 1154.224, "learner_dequeue_time_ms": 9840.359}}, "env_runners": {"episode_reward_max": 983.8083333333351, "episode_reward_min": 831.1916666666688, "episode_reward_mean": 917.2771666666684, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 831.1916666666688}, "policy_reward_max": {"default_policy": 983.8083333333351}, "policy_reward_mean": {"default_policy": 917.2771666666684}, "custom_metrics": {"num_consolidated_mean": 2.3493, "num_consolidated_min": 2.12, "num_consolidated_max": 2.58, "num_overloaded_mean": 0.05260000000000001, "num_overloaded_min": 0.01, "num_overloaded_max": 0.11, "num_moves_mean": 6.6358, "num_moves_min": 6.02, "num_moves_max": 7.33, "mean_accuracy_mean": 42.21872000000001, "mean_accuracy_min": 42.00566666666668, "mean_accuracy_max": 42.43000000000002, "num_model_switches_mean": 3.6535, "num_model_switches_min": 3.22, "num_model_switches_max": 4.12, "num_slav_mean": 0.10254183333333332, "num_slav_min": 0.08503333333333334, "num_slav_max": 0.12848333333333334, "cpu_conserved_cost_mean": 5.691600000000001, "cpu_conserved_cost_min": 5.02, "cpu_conserved_cost_max": 6.5, "mean_cluster_cpu_util_mean": 0.48331964249588827, "mean_cluster_cpu_util_min": 0.47138247310967524, "mean_cluster_cpu_util_max": 0.4999727553955695, "mean_cluster_mem_util_mean": 0.31419730774778265, "mean_cluster_mem_util_min": 0.3072254590760355, "mean_cluster_mem_util_max": 0.3222867912038233, "reward_consolidation_mean_mean": 4.597499999999999, "reward_consolidation_mean_min": 4.166666666666666, "reward_consolidation_mean_max": 5.0625, "reward_illegal_mean_mean": -0.08766666666666666, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 6.115083333333349, "reward_accuracy_mean_min": 5.633333333333347, "reward_accuracy_mean_max": 6.591666666666685, "reward_sla_mean_mean": -1.4521449999999998, "reward_sla_mean_min": -1.8019999999999998, "reward_sla_mean_max": -1.13025, "reward_consolidation_sum_mean": 459.74999999999983, "reward_consolidation_sum_min": 416.6666666666666, "reward_consolidation_sum_max": 506.25, "reward_illegal_sum_mean": -8.766666666666666, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 611.5083333333349, "reward_accuracy_sum_min": 563.3333333333347, "reward_accuracy_sum_max": 659.1666666666686, "reward_sla_sum_mean": -145.2145, "reward_sla_sum_min": -180.2, "reward_sla_sum_max": -113.02499999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1894.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [894.8416666666685, 880.9083333333352, 942.683333333335, 894.4833333333347, 967.0333333333356, 896.3500000000017, 885.616666666668, 882.116666666668, 862.7666666666678, 885.5250000000015, 952.8333333333351, 903.7250000000021, 915.8166666666683, 913.1416666666684, 831.1916666666688, 864.3833333333351, 865.591666666668, 942.4166666666688, 869.5166666666688, 889.9666666666681, 875.958333333335, 908.0416666666686, 928.6666666666682, 903.9333333333345, 926.5250000000024, 923.4666666666689, 920.2166666666687, 942.9250000000017, 908.8666666666686, 954.241666666669, 940.075000000002, 952.933333333335, 947.1166666666685, 913.7500000000016, 885.2750000000017, 876.3250000000021, 920.6666666666682, 844.7250000000018, 965.400000000002, 922.9666666666682, 939.4500000000016, 905.5583333333351, 894.1416666666686, 921.8416666666682, 889.783333333335, 925.4916666666684, 972.2416666666685, 950.0916666666684, 947.2750000000017, 936.9666666666683, 966.875000000002, 923.5916666666683, 934.2666666666689, 920.6666666666682, 934.8333333333347, 930.0750000000015, 954.0666666666684, 914.4000000000017, 957.4333333333349, 903.3166666666682, 927.1333333333351, 945.0000000000018, 903.9833333333355, 930.9583333333354, 929.5166666666686, 922.2666666666685, 943.0500000000018, 862.275000000001, 921.4666666666689, 917.4416666666683, 923.375000000002, 913.933333333335, 901.2416666666686, 935.2666666666685, 954.0666666666688, 962.9916666666687, 913.6916666666684, 886.5750000000014, 912.391666666668, 900.9083333333351, 962.8083333333354, 900.6583333333352, 983.8083333333351, 890.9666666666684, 871.0916666666685, 926.7750000000016, 885.1333333333353, 947.7916666666687, 884.6083333333352, 947.2833333333352, 930.4083333333352, 893.083333333335, 926.9500000000021, 928.4083333333352, 936.3083333333348, 850.6083333333348, 917.5333333333351, 934.1833333333349, 952.8583333333354, 923.5666666666683], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [894.8416666666685, 880.9083333333352, 942.683333333335, 894.4833333333347, 967.0333333333356, 896.3500000000017, 885.616666666668, 882.116666666668, 862.7666666666678, 885.5250000000015, 952.8333333333351, 903.7250000000021, 915.8166666666683, 913.1416666666684, 831.1916666666688, 864.3833333333351, 865.591666666668, 942.4166666666688, 869.5166666666688, 889.9666666666681, 875.958333333335, 908.0416666666686, 928.6666666666682, 903.9333333333345, 926.5250000000024, 923.4666666666689, 920.2166666666687, 942.9250000000017, 908.8666666666686, 954.241666666669, 940.075000000002, 952.933333333335, 947.1166666666685, 913.7500000000016, 885.2750000000017, 876.3250000000021, 920.6666666666682, 844.7250000000018, 965.400000000002, 922.9666666666682, 939.4500000000016, 905.5583333333351, 894.1416666666686, 921.8416666666682, 889.783333333335, 925.4916666666684, 972.2416666666685, 950.0916666666684, 947.2750000000017, 936.9666666666683, 966.875000000002, 923.5916666666683, 934.2666666666689, 920.6666666666682, 934.8333333333347, 930.0750000000015, 954.0666666666684, 914.4000000000017, 957.4333333333349, 903.3166666666682, 927.1333333333351, 945.0000000000018, 903.9833333333355, 930.9583333333354, 929.5166666666686, 922.2666666666685, 943.0500000000018, 862.275000000001, 921.4666666666689, 917.4416666666683, 923.375000000002, 913.933333333335, 901.2416666666686, 935.2666666666685, 954.0666666666688, 962.9916666666687, 913.6916666666684, 886.5750000000014, 912.391666666668, 900.9083333333351, 962.8083333333354, 900.6583333333352, 983.8083333333351, 890.9666666666684, 871.0916666666685, 926.7750000000016, 885.1333333333353, 947.7916666666687, 884.6083333333352, 947.2833333333352, 930.4083333333352, 893.083333333335, 926.9500000000021, 928.4083333333352, 936.3083333333348, 850.6083333333348, 917.5333333333351, 934.1833333333349, 952.8583333333354, 923.5666666666683]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24083150812734289, "mean_inference_ms": 2.044878455748691, "mean_action_processing_ms": 0.0906298398900213, "mean_env_wait_ms": 1.5312071640580354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006724357604980469, "StateBufferConnector_ms": 0.0032067298889160156, "ViewRequirementAgentConnector_ms": 0.08312106132507324}, "num_episodes": 27, "episode_return_max": 983.8083333333351, "episode_return_min": 831.1916666666688, "episode_return_mean": 917.2771666666684, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126600, "num_agent_steps_trained": 126300, "num_env_steps_sampled": 126600, "num_env_steps_trained": 126300, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 254.3063650899168, "num_env_steps_trained_throughput_per_sec": 239.3471671434511, "timesteps_total": 126600, "num_env_steps_sampled_lifetime": 126600, "num_agent_steps_sampled_lifetime": 126600, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 126600, "timers": {"training_iteration_time_ms": 10327.811, "restore_workers_time_ms": 0.014, "training_step_time_ms": 592.455, "sample_time_ms": 577.061, "synch_weights_time_ms": 13.985}, "counters": {"num_env_steps_sampled": 126600, "num_env_steps_trained": 126300, "num_agent_steps_sampled": 126600, "num_agent_steps_trained": 126300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 844, "num_samples_added_to_queue": 126600}, "done": false, "training_iteration": 50, "trial_id": "27800_00000", "date": "2024-10-12_15-36-26", "timestamp": 1728743786, "time_this_iter_s": 10.037340879440308, "time_total_s": 515.6475834846497, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c1510>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 515.6475834846497, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 16.43571428571428, "ram_util_percent": 36.785714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 426718.53125, "policy_loss": 412887.46875, "entropy": 18.321796417236328, "entropy_coeff": 0.01, "var_gnorm": 16.469635009765625, "vf_loss": 1388603.75, "vf_explained_var": 0.13045597076416016}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 430.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 129150, "num_env_steps_trained": 129000, "num_agent_steps_sampled": 129150, "num_agent_steps_trained": 129000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 861, "num_samples_added_to_queue": 129000, "learner_queue": {"size_count": 430, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.715, "learner_load_time_ms": 0.387, "learner_load_wait_time_ms": 1164.394, "learner_dequeue_time_ms": 9803.143}}, "env_runners": {"episode_reward_max": 983.8083333333351, "episode_reward_min": 844.7250000000018, "episode_reward_mean": 923.0295833333352, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 844.7250000000018}, "policy_reward_max": {"default_policy": 983.8083333333351}, "policy_reward_mean": {"default_policy": 923.0295833333352}, "custom_metrics": {"num_consolidated_mean": 2.3764999999999996, "num_consolidated_min": 2.23, "num_consolidated_max": 2.58, "num_overloaded_mean": 0.05380000000000001, "num_overloaded_min": 0.01, "num_overloaded_max": 0.11, "num_moves_mean": 6.5062, "num_moves_min": 6.02, "num_moves_max": 7.12, "mean_accuracy_mean": 42.21536333333334, "mean_accuracy_min": 42.00566666666668, "mean_accuracy_max": 42.411000000000016, "num_model_switches_mean": 3.6141, "num_model_switches_min": 3.22, "num_model_switches_max": 4.03, "num_slav_mean": 0.1010155, "num_slav_min": 0.08503333333333334, "num_slav_max": 0.11994999999999999, "cpu_conserved_cost_mean": 5.776200000000001, "cpu_conserved_cost_min": 5.26, "cpu_conserved_cost_max": 6.5, "mean_cluster_cpu_util_mean": 0.48415088799227673, "mean_cluster_cpu_util_min": 0.47138247310967524, "mean_cluster_cpu_util_max": 0.4999727553955695, "mean_cluster_mem_util_mean": 0.3146594017372772, "mean_cluster_mem_util_min": 0.3072254590760355, "mean_cluster_mem_util_max": 0.3222867912038233, "reward_consolidation_mean_mean": 4.644791666666666, "reward_consolidation_mean_min": 4.166666666666666, "reward_consolidation_mean_max": 5.0625, "reward_illegal_mean_mean": -0.08966666666666667, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 6.105333333333351, "reward_accuracy_mean_min": 5.633333333333347, "reward_accuracy_mean_max": 6.591666666666685, "reward_sla_mean_mean": -1.4301625000000002, "reward_sla_mean_min": -1.71425, "reward_sla_mean_max": -1.13025, "reward_consolidation_sum_mean": 464.4791666666666, "reward_consolidation_sum_min": 416.6666666666666, "reward_consolidation_sum_max": 506.25, "reward_illegal_sum_mean": -8.966666666666665, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 610.533333333335, "reward_accuracy_sum_min": 563.3333333333347, "reward_accuracy_sum_max": 659.1666666666686, "reward_sla_sum_mean": -143.01625, "reward_sla_sum_min": -171.425, "reward_sla_sum_max": -113.02499999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2382.0, "global_timestep_min": 700, "global_timestep_max": 4000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [926.5250000000024, 923.4666666666689, 920.2166666666687, 942.9250000000017, 908.8666666666686, 954.241666666669, 940.075000000002, 952.933333333335, 947.1166666666685, 913.7500000000016, 885.2750000000017, 876.3250000000021, 920.6666666666682, 844.7250000000018, 965.400000000002, 922.9666666666682, 939.4500000000016, 905.5583333333351, 894.1416666666686, 921.8416666666682, 889.783333333335, 925.4916666666684, 972.2416666666685, 950.0916666666684, 947.2750000000017, 936.9666666666683, 966.875000000002, 923.5916666666683, 934.2666666666689, 920.6666666666682, 934.8333333333347, 930.0750000000015, 954.0666666666684, 914.4000000000017, 957.4333333333349, 903.3166666666682, 927.1333333333351, 945.0000000000018, 903.9833333333355, 930.9583333333354, 929.5166666666686, 922.2666666666685, 943.0500000000018, 862.275000000001, 921.4666666666689, 917.4416666666683, 923.375000000002, 913.933333333335, 901.2416666666686, 935.2666666666685, 954.0666666666688, 962.9916666666687, 913.6916666666684, 886.5750000000014, 912.391666666668, 900.9083333333351, 962.8083333333354, 900.6583333333352, 983.8083333333351, 890.9666666666684, 871.0916666666685, 926.7750000000016, 885.1333333333353, 947.7916666666687, 884.6083333333352, 947.2833333333352, 930.4083333333352, 893.083333333335, 926.9500000000021, 928.4083333333352, 936.3083333333348, 850.6083333333348, 917.5333333333351, 934.1833333333349, 952.8583333333354, 923.5666666666683, 972.3666666666682, 877.350000000002, 862.9000000000013, 889.8916666666678, 973.1083333333353, 980.3666666666684, 939.5500000000022, 945.7666666666688, 925.8333333333347, 913.5000000000017, 898.6083333333348, 953.1250000000023, 931.891666666668, 943.1833333333351, 940.8083333333352, 917.2000000000015, 932.6583333333351, 903.233333333335, 869.8666666666685, 896.7250000000018, 963.7166666666685, 916.3583333333352, 875.4500000000018, 909.2916666666687], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [926.5250000000024, 923.4666666666689, 920.2166666666687, 942.9250000000017, 908.8666666666686, 954.241666666669, 940.075000000002, 952.933333333335, 947.1166666666685, 913.7500000000016, 885.2750000000017, 876.3250000000021, 920.6666666666682, 844.7250000000018, 965.400000000002, 922.9666666666682, 939.4500000000016, 905.5583333333351, 894.1416666666686, 921.8416666666682, 889.783333333335, 925.4916666666684, 972.2416666666685, 950.0916666666684, 947.2750000000017, 936.9666666666683, 966.875000000002, 923.5916666666683, 934.2666666666689, 920.6666666666682, 934.8333333333347, 930.0750000000015, 954.0666666666684, 914.4000000000017, 957.4333333333349, 903.3166666666682, 927.1333333333351, 945.0000000000018, 903.9833333333355, 930.9583333333354, 929.5166666666686, 922.2666666666685, 943.0500000000018, 862.275000000001, 921.4666666666689, 917.4416666666683, 923.375000000002, 913.933333333335, 901.2416666666686, 935.2666666666685, 954.0666666666688, 962.9916666666687, 913.6916666666684, 886.5750000000014, 912.391666666668, 900.9083333333351, 962.8083333333354, 900.6583333333352, 983.8083333333351, 890.9666666666684, 871.0916666666685, 926.7750000000016, 885.1333333333353, 947.7916666666687, 884.6083333333352, 947.2833333333352, 930.4083333333352, 893.083333333335, 926.9500000000021, 928.4083333333352, 936.3083333333348, 850.6083333333348, 917.5333333333351, 934.1833333333349, 952.8583333333354, 923.5666666666683, 972.3666666666682, 877.350000000002, 862.9000000000013, 889.8916666666678, 973.1083333333353, 980.3666666666684, 939.5500000000022, 945.7666666666688, 925.8333333333347, 913.5000000000017, 898.6083333333348, 953.1250000000023, 931.891666666668, 943.1833333333351, 940.8083333333352, 917.2000000000015, 932.6583333333351, 903.233333333335, 869.8666666666685, 896.7250000000018, 963.7166666666685, 916.3583333333352, 875.4500000000018, 909.2916666666687]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24082393777162253, "mean_inference_ms": 2.044302675405964, "mean_action_processing_ms": 0.09062860499815567, "mean_env_wait_ms": 1.5309775024828307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006696939468383789, "StateBufferConnector_ms": 0.0031957626342773438, "ViewRequirementAgentConnector_ms": 0.08220839500427246}, "num_episodes": 24, "episode_return_max": 983.8083333333351, "episode_return_min": 844.7250000000018, "episode_return_mean": 923.0295833333352, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129150, "num_agent_steps_trained": 129000, "num_env_steps_sampled": 129150, "num_env_steps_trained": 129000, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 245.42951044116765, "num_env_steps_trained_throughput_per_sec": 259.8665404671187, "timesteps_total": 129150, "num_env_steps_sampled_lifetime": 129150, "num_agent_steps_sampled_lifetime": 129150, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 129150, "timers": {"training_iteration_time_ms": 10302.397, "restore_workers_time_ms": 0.014, "training_step_time_ms": 599.398, "sample_time_ms": 584.272, "synch_weights_time_ms": 13.68}, "counters": {"num_env_steps_sampled": 129150, "num_env_steps_trained": 129000, "num_agent_steps_sampled": 129150, "num_agent_steps_trained": 129000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 861, "num_samples_added_to_queue": 129000}, "done": false, "training_iteration": 51, "trial_id": "27800_00000", "date": "2024-10-12_15-36-37", "timestamp": 1728743797, "time_this_iter_s": 10.399049282073975, "time_total_s": 526.0466327667236, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c20b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 526.0466327667236, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 16.34, "ram_util_percent": 36.93333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 414252.40625, "policy_loss": 399604.625, "entropy": 17.717117309570312, "entropy_coeff": 0.01, "var_gnorm": 16.482877731323242, "vf_loss": 1470095.0, "vf_explained_var": 0.13202697038650513}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 438.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 131700, "num_env_steps_trained": 131400, "num_agent_steps_sampled": 131700, "num_agent_steps_trained": 131400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 878, "num_samples_added_to_queue": 131700, "learner_queue": {"size_count": 438, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 51.882, "learner_load_time_ms": 0.385, "learner_load_wait_time_ms": 1185.791, "learner_dequeue_time_ms": 9775.393}}, "env_runners": {"episode_reward_max": 1010.7666666666685, "episode_reward_min": 850.6083333333348, "episode_reward_mean": 929.8428333333352, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 850.6083333333348}, "policy_reward_max": {"default_policy": 1010.7666666666685}, "policy_reward_mean": {"default_policy": 929.8428333333352}, "custom_metrics": {"num_consolidated_mean": 2.3947, "num_consolidated_min": 2.25, "num_consolidated_max": 2.58, "num_overloaded_mean": 0.053000000000000005, "num_overloaded_min": 0.01, "num_overloaded_max": 0.11, "num_moves_mean": 6.336499999999998, "num_moves_min": 5.68, "num_moves_max": 6.86, "mean_accuracy_mean": 42.23993666666668, "mean_accuracy_min": 42.00566666666668, "mean_accuracy_max": 42.45533333333336, "num_model_switches_mean": 3.5358000000000005, "num_model_switches_min": 3.08, "num_model_switches_max": 4.01, "num_slav_mean": 0.10172633333333332, "num_slav_min": 0.08511666666666669, "num_slav_max": 0.11994999999999999, "cpu_conserved_cost_mean": 5.829, "cpu_conserved_cost_min": 5.26, "cpu_conserved_cost_max": 6.5, "mean_cluster_cpu_util_mean": 0.4848707547443585, "mean_cluster_cpu_util_min": 0.47138247310967524, "mean_cluster_cpu_util_max": 0.4999727553955695, "mean_cluster_mem_util_mean": 0.31485098905859815, "mean_cluster_mem_util_min": 0.3072254590760355, "mean_cluster_mem_util_max": 0.3222867912038233, "reward_consolidation_mean_mean": 4.687083333333333, "reward_consolidation_mean_min": 4.312499999999999, "reward_consolidation_mean_max": 5.145833333333332, "reward_illegal_mean_mean": -0.08833333333333333, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 6.14058333333335, "reward_accuracy_mean_min": 5.633333333333347, "reward_accuracy_mean_max": 6.650000000000018, "reward_sla_mean_mean": -1.4409049999999999, "reward_sla_mean_min": -1.71425, "reward_sla_mean_max": -1.13025, "reward_consolidation_sum_mean": 468.70833333333337, "reward_consolidation_sum_min": 431.24999999999994, "reward_consolidation_sum_max": 514.5833333333333, "reward_illegal_sum_mean": -8.833333333333332, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 614.058333333335, "reward_accuracy_sum_min": 563.3333333333347, "reward_accuracy_sum_max": 665.0000000000018, "reward_sla_sum_mean": -144.0905, "reward_sla_sum_min": -171.425, "reward_sla_sum_max": -113.02499999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3282.0, "global_timestep_min": 1600, "global_timestep_max": 4900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [923.5916666666683, 934.2666666666689, 920.6666666666682, 934.8333333333347, 930.0750000000015, 954.0666666666684, 914.4000000000017, 957.4333333333349, 903.3166666666682, 927.1333333333351, 945.0000000000018, 903.9833333333355, 930.9583333333354, 929.5166666666686, 922.2666666666685, 943.0500000000018, 862.275000000001, 921.4666666666689, 917.4416666666683, 923.375000000002, 913.933333333335, 901.2416666666686, 935.2666666666685, 954.0666666666688, 962.9916666666687, 913.6916666666684, 886.5750000000014, 912.391666666668, 900.9083333333351, 962.8083333333354, 900.6583333333352, 983.8083333333351, 890.9666666666684, 871.0916666666685, 926.7750000000016, 885.1333333333353, 947.7916666666687, 884.6083333333352, 947.2833333333352, 930.4083333333352, 893.083333333335, 926.9500000000021, 928.4083333333352, 936.3083333333348, 850.6083333333348, 917.5333333333351, 934.1833333333349, 952.8583333333354, 923.5666666666683, 972.3666666666682, 877.350000000002, 862.9000000000013, 889.8916666666678, 973.1083333333353, 980.3666666666684, 939.5500000000022, 945.7666666666688, 925.8333333333347, 913.5000000000017, 898.6083333333348, 953.1250000000023, 931.891666666668, 943.1833333333351, 940.8083333333352, 917.2000000000015, 932.6583333333351, 903.233333333335, 869.8666666666685, 896.7250000000018, 963.7166666666685, 916.3583333333352, 875.4500000000018, 909.2916666666687, 992.9916666666685, 941.5916666666684, 934.8166666666689, 951.4083333333355, 951.3083333333357, 946.4416666666682, 973.050000000002, 899.6500000000019, 967.5916666666685, 937.4750000000014, 969.2666666666685, 916.4916666666685, 932.9916666666684, 1010.7666666666685, 979.3416666666686, 966.5583333333352, 968.3583333333352, 945.2666666666688, 977.9166666666689, 937.1416666666684, 921.4166666666683, 951.9000000000017, 898.9583333333351, 937.825000000002, 938.0666666666683, 928.233333333335, 999.6916666666685], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [923.5916666666683, 934.2666666666689, 920.6666666666682, 934.8333333333347, 930.0750000000015, 954.0666666666684, 914.4000000000017, 957.4333333333349, 903.3166666666682, 927.1333333333351, 945.0000000000018, 903.9833333333355, 930.9583333333354, 929.5166666666686, 922.2666666666685, 943.0500000000018, 862.275000000001, 921.4666666666689, 917.4416666666683, 923.375000000002, 913.933333333335, 901.2416666666686, 935.2666666666685, 954.0666666666688, 962.9916666666687, 913.6916666666684, 886.5750000000014, 912.391666666668, 900.9083333333351, 962.8083333333354, 900.6583333333352, 983.8083333333351, 890.9666666666684, 871.0916666666685, 926.7750000000016, 885.1333333333353, 947.7916666666687, 884.6083333333352, 947.2833333333352, 930.4083333333352, 893.083333333335, 926.9500000000021, 928.4083333333352, 936.3083333333348, 850.6083333333348, 917.5333333333351, 934.1833333333349, 952.8583333333354, 923.5666666666683, 972.3666666666682, 877.350000000002, 862.9000000000013, 889.8916666666678, 973.1083333333353, 980.3666666666684, 939.5500000000022, 945.7666666666688, 925.8333333333347, 913.5000000000017, 898.6083333333348, 953.1250000000023, 931.891666666668, 943.1833333333351, 940.8083333333352, 917.2000000000015, 932.6583333333351, 903.233333333335, 869.8666666666685, 896.7250000000018, 963.7166666666685, 916.3583333333352, 875.4500000000018, 909.2916666666687, 992.9916666666685, 941.5916666666684, 934.8166666666689, 951.4083333333355, 951.3083333333357, 946.4416666666682, 973.050000000002, 899.6500000000019, 967.5916666666685, 937.4750000000014, 969.2666666666685, 916.4916666666685, 932.9916666666684, 1010.7666666666685, 979.3416666666686, 966.5583333333352, 968.3583333333352, 945.2666666666688, 977.9166666666689, 937.1416666666684, 921.4166666666683, 951.9000000000017, 898.9583333333351, 937.825000000002, 938.0666666666683, 928.233333333335, 999.6916666666685]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2408032592297097, "mean_inference_ms": 2.0441039077793293, "mean_action_processing_ms": 0.0906280372623523, "mean_env_wait_ms": 1.530841325988091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006536722183227539, "StateBufferConnector_ms": 0.0032651424407958984, "ViewRequirementAgentConnector_ms": 0.08413028717041016}, "num_episodes": 27, "episode_return_max": 1010.7666666666685, "episode_return_min": 850.6083333333348, "episode_return_mean": 929.8428333333352, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131700, "num_agent_steps_trained": 131400, "num_env_steps_sampled": 131700, "num_env_steps_trained": 131400, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 241.95108832772354, "num_env_steps_trained_throughput_per_sec": 227.71867136726922, "timesteps_total": 131700, "num_env_steps_sampled_lifetime": 131700, "num_agent_steps_sampled_lifetime": 131700, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 131700, "timers": {"training_iteration_time_ms": 10349.679, "restore_workers_time_ms": 0.014, "training_step_time_ms": 618.087, "sample_time_ms": 602.165, "synch_weights_time_ms": 14.368}, "counters": {"num_env_steps_sampled": 131700, "num_env_steps_trained": 131400, "num_agent_steps_sampled": 131700, "num_agent_steps_trained": 131400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 878, "num_samples_added_to_queue": 131700}, "done": false, "training_iteration": 52, "trial_id": "27800_00000", "date": "2024-10-12_15-36-47", "timestamp": 1728743807, "time_this_iter_s": 10.55126667022705, "time_total_s": 536.5978994369507, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c2110>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 536.5978994369507, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 16.333333333333332, "ram_util_percent": 37.06666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 386091.375, "policy_loss": 371767.3125, "entropy": 17.1181697845459, "entropy_coeff": 0.01, "var_gnorm": 16.497587203979492, "vf_loss": 1437541.0, "vf_explained_var": 0.1400037407875061}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 447.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 134250, "num_env_steps_trained": 134100, "num_agent_steps_sampled": 134250, "num_agent_steps_trained": 134100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 895, "num_samples_added_to_queue": 134100, "learner_queue": {"size_count": 447, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.763, "learner_load_time_ms": 0.361, "learner_load_wait_time_ms": 1151.416, "learner_dequeue_time_ms": 9795.146}}, "env_runners": {"episode_reward_max": 1046.750000000002, "episode_reward_min": 850.6083333333348, "episode_reward_mean": 939.4685833333352, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 850.6083333333348}, "policy_reward_max": {"default_policy": 1046.750000000002}, "policy_reward_mean": {"default_policy": 939.4685833333352}, "custom_metrics": {"num_consolidated_mean": 2.4143, "num_consolidated_min": 2.27, "num_consolidated_max": 2.58, "num_overloaded_mean": 0.0498, "num_overloaded_min": 0.0, "num_overloaded_max": 0.11, "num_moves_mean": 6.1723, "num_moves_min": 5.31, "num_moves_max": 6.83, "mean_accuracy_mean": 42.266283333333355, "mean_accuracy_min": 42.00566666666668, "mean_accuracy_max": 42.45533333333336, "num_model_switches_mean": 3.4574000000000003, "num_model_switches_min": 2.89, "num_model_switches_max": 3.88, "num_slav_mean": 0.10306350000000002, "num_slav_min": 0.08511666666666669, "num_slav_max": 0.11994999999999999, "cpu_conserved_cost_mean": 5.896599999999999, "cpu_conserved_cost_min": 5.38, "cpu_conserved_cost_max": 6.5, "mean_cluster_cpu_util_mean": 0.4862500134777006, "mean_cluster_cpu_util_min": 0.4766115215729899, "mean_cluster_cpu_util_max": 0.5015753868327194, "mean_cluster_mem_util_mean": 0.3154970529004851, "mean_cluster_mem_util_min": 0.3103478886807888, "mean_cluster_mem_util_max": 0.3222867912038233, "reward_consolidation_mean_mean": 4.746874999999999, "reward_consolidation_mean_min": 4.312499999999999, "reward_consolidation_mean_max": 5.208333333333332, "reward_illegal_mean_mean": -0.08299999999999999, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.193833333333349, "reward_accuracy_mean_min": 5.633333333333347, "reward_accuracy_mean_max": 6.75000000000002, "reward_sla_mean_mean": -1.4630225, "reward_sla_mean_min": -1.71425, "reward_sla_mean_max": -1.13025, "reward_consolidation_sum_mean": 474.6875, "reward_consolidation_sum_min": 431.24999999999994, "reward_consolidation_sum_max": 520.8333333333333, "reward_illegal_sum_mean": -8.299999999999999, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 619.3833333333349, "reward_accuracy_sum_min": 563.3333333333347, "reward_accuracy_sum_max": 675.000000000002, "reward_sla_sum_mean": -146.30225000000002, "reward_sla_sum_min": -171.425, "reward_sla_sum_max": -113.02499999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4082.0, "global_timestep_min": 2400, "global_timestep_max": 5700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [962.9916666666687, 913.6916666666684, 886.5750000000014, 912.391666666668, 900.9083333333351, 962.8083333333354, 900.6583333333352, 983.8083333333351, 890.9666666666684, 871.0916666666685, 926.7750000000016, 885.1333333333353, 947.7916666666687, 884.6083333333352, 947.2833333333352, 930.4083333333352, 893.083333333335, 926.9500000000021, 928.4083333333352, 936.3083333333348, 850.6083333333348, 917.5333333333351, 934.1833333333349, 952.8583333333354, 923.5666666666683, 972.3666666666682, 877.350000000002, 862.9000000000013, 889.8916666666678, 973.1083333333353, 980.3666666666684, 939.5500000000022, 945.7666666666688, 925.8333333333347, 913.5000000000017, 898.6083333333348, 953.1250000000023, 931.891666666668, 943.1833333333351, 940.8083333333352, 917.2000000000015, 932.6583333333351, 903.233333333335, 869.8666666666685, 896.7250000000018, 963.7166666666685, 916.3583333333352, 875.4500000000018, 909.2916666666687, 992.9916666666685, 941.5916666666684, 934.8166666666689, 951.4083333333355, 951.3083333333357, 946.4416666666682, 973.050000000002, 899.6500000000019, 967.5916666666685, 937.4750000000014, 969.2666666666685, 916.4916666666685, 932.9916666666684, 1010.7666666666685, 979.3416666666686, 966.5583333333352, 968.3583333333352, 945.2666666666688, 977.9166666666689, 937.1416666666684, 921.4166666666683, 951.9000000000017, 898.9583333333351, 937.825000000002, 938.0666666666683, 928.233333333335, 999.6916666666685, 923.5083333333355, 948.6166666666687, 1005.1916666666681, 970.7833333333352, 943.4250000000012, 944.9166666666684, 964.8750000000024, 969.0916666666687, 978.6250000000023, 933.5166666666684, 1019.950000000002, 962.8583333333354, 941.3833333333356, 989.7500000000022, 985.883333333335, 965.9666666666687, 977.4750000000013, 908.3500000000022, 957.0083333333354, 1046.750000000002, 893.2500000000019, 982.8583333333353, 971.950000000002, 980.2166666666689], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [962.9916666666687, 913.6916666666684, 886.5750000000014, 912.391666666668, 900.9083333333351, 962.8083333333354, 900.6583333333352, 983.8083333333351, 890.9666666666684, 871.0916666666685, 926.7750000000016, 885.1333333333353, 947.7916666666687, 884.6083333333352, 947.2833333333352, 930.4083333333352, 893.083333333335, 926.9500000000021, 928.4083333333352, 936.3083333333348, 850.6083333333348, 917.5333333333351, 934.1833333333349, 952.8583333333354, 923.5666666666683, 972.3666666666682, 877.350000000002, 862.9000000000013, 889.8916666666678, 973.1083333333353, 980.3666666666684, 939.5500000000022, 945.7666666666688, 925.8333333333347, 913.5000000000017, 898.6083333333348, 953.1250000000023, 931.891666666668, 943.1833333333351, 940.8083333333352, 917.2000000000015, 932.6583333333351, 903.233333333335, 869.8666666666685, 896.7250000000018, 963.7166666666685, 916.3583333333352, 875.4500000000018, 909.2916666666687, 992.9916666666685, 941.5916666666684, 934.8166666666689, 951.4083333333355, 951.3083333333357, 946.4416666666682, 973.050000000002, 899.6500000000019, 967.5916666666685, 937.4750000000014, 969.2666666666685, 916.4916666666685, 932.9916666666684, 1010.7666666666685, 979.3416666666686, 966.5583333333352, 968.3583333333352, 945.2666666666688, 977.9166666666689, 937.1416666666684, 921.4166666666683, 951.9000000000017, 898.9583333333351, 937.825000000002, 938.0666666666683, 928.233333333335, 999.6916666666685, 923.5083333333355, 948.6166666666687, 1005.1916666666681, 970.7833333333352, 943.4250000000012, 944.9166666666684, 964.8750000000024, 969.0916666666687, 978.6250000000023, 933.5166666666684, 1019.950000000002, 962.8583333333354, 941.3833333333356, 989.7500000000022, 985.883333333335, 965.9666666666687, 977.4750000000013, 908.3500000000022, 957.0083333333354, 1046.750000000002, 893.2500000000019, 982.8583333333353, 971.950000000002, 980.2166666666689]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24077798053037583, "mean_inference_ms": 2.0436349051176763, "mean_action_processing_ms": 0.09062129358332345, "mean_env_wait_ms": 1.5306846636882496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006298542022705078, "StateBufferConnector_ms": 0.003258943557739258, "ViewRequirementAgentConnector_ms": 0.08400154113769531}, "num_episodes": 24, "episode_return_max": 1046.750000000002, "episode_return_min": 850.6083333333348, "episode_return_mean": 939.4685833333352, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134250, "num_agent_steps_trained": 134100, "num_env_steps_sampled": 134250, "num_env_steps_trained": 134100, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 249.74645731301143, "num_env_steps_trained_throughput_per_sec": 264.4374253902474, "timesteps_total": 134250, "num_env_steps_sampled_lifetime": 134250, "num_agent_steps_sampled_lifetime": 134250, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 134250, "timers": {"training_iteration_time_ms": 10329.01, "restore_workers_time_ms": 0.016, "training_step_time_ms": 595.16, "sample_time_ms": 579.838, "synch_weights_time_ms": 13.938}, "counters": {"num_env_steps_sampled": 134250, "num_env_steps_trained": 134100, "num_agent_steps_sampled": 134250, "num_agent_steps_trained": 134100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 895, "num_samples_added_to_queue": 134100}, "done": false, "training_iteration": 53, "trial_id": "27800_00000", "date": "2024-10-12_15-36-57", "timestamp": 1728743817, "time_this_iter_s": 10.22153377532959, "time_total_s": 546.8194332122803, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a945ee23b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 546.8194332122803, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 16.453333333333333, "ram_util_percent": 37.17999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 377120.75, "policy_loss": 361041.03125, "entropy": 16.159381866455078, "entropy_coeff": 0.01, "var_gnorm": 16.517107009887695, "vf_loss": 1612819.25, "vf_explained_var": 0.14687001705169678}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 455.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 136800, "num_env_steps_trained": 136500, "num_agent_steps_sampled": 136800, "num_agent_steps_trained": 136500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 912, "num_samples_added_to_queue": 136800, "learner_queue": {"size_count": 455, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.877, "learner_load_time_ms": 0.332, "learner_load_wait_time_ms": 1162.948, "learner_dequeue_time_ms": 9784.113}}, "env_runners": {"episode_reward_max": 1046.750000000002, "episode_reward_min": 862.9000000000013, "episode_reward_mean": 961.4258333333352, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 862.9000000000013}, "policy_reward_max": {"default_policy": 1046.750000000002}, "policy_reward_mean": {"default_policy": 961.4258333333352}, "custom_metrics": {"num_consolidated_mean": 2.4512000000000005, "num_consolidated_min": 2.28, "num_consolidated_max": 2.64, "num_overloaded_mean": 0.04069999999999999, "num_overloaded_min": 0.0, "num_overloaded_max": 0.11, "num_moves_mean": 5.8831, "num_moves_min": 4.78, "num_moves_max": 6.56, "mean_accuracy_mean": 42.29408666666668, "mean_accuracy_min": 42.08166666666668, "mean_accuracy_max": 42.51866666666669, "num_model_switches_mean": 3.3263, "num_model_switches_min": 2.68, "num_model_switches_max": 3.81, "num_slav_mean": 0.10350483333333332, "num_slav_min": 0.088, "num_slav_max": 0.11610000000000001, "cpu_conserved_cost_mean": 6.0046, "cpu_conserved_cost_min": 5.5, "cpu_conserved_cost_max": 6.72, "mean_cluster_cpu_util_mean": 0.4879629976924357, "mean_cluster_cpu_util_min": 0.4766115215729899, "mean_cluster_cpu_util_max": 0.5025747528940858, "mean_cluster_mem_util_mean": 0.3159258980058268, "mean_cluster_mem_util_min": 0.3103478886807888, "mean_cluster_mem_util_max": 0.32522066165073626, "reward_consolidation_mean_mean": 4.872916666666666, "reward_consolidation_mean_min": 4.375, "reward_consolidation_mean_max": 5.312499999999999, "reward_illegal_mean_mean": -0.06783333333333333, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.292000000000018, "reward_accuracy_mean_min": 5.775000000000016, "reward_accuracy_mean_max": 6.75000000000002, "reward_sla_mean_mean": -1.482825, "reward_sla_mean_min": -1.6882499999999998, "reward_sla_mean_max": -1.2175, "reward_consolidation_sum_mean": 487.2916666666666, "reward_consolidation_sum_min": 437.5, "reward_consolidation_sum_max": 531.2499999999999, "reward_illegal_sum_mean": -6.783333333333332, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 629.2000000000016, "reward_accuracy_sum_min": 577.5000000000016, "reward_accuracy_sum_max": 675.000000000002, "reward_sla_sum_mean": -148.2825, "reward_sla_sum_min": -168.825, "reward_sla_sum_max": -121.75, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4982.0, "global_timestep_min": 3300, "global_timestep_max": 6600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [862.9000000000013, 889.8916666666678, 973.1083333333353, 980.3666666666684, 939.5500000000022, 945.7666666666688, 925.8333333333347, 913.5000000000017, 898.6083333333348, 953.1250000000023, 931.891666666668, 943.1833333333351, 940.8083333333352, 917.2000000000015, 932.6583333333351, 903.233333333335, 869.8666666666685, 896.7250000000018, 963.7166666666685, 916.3583333333352, 875.4500000000018, 909.2916666666687, 992.9916666666685, 941.5916666666684, 934.8166666666689, 951.4083333333355, 951.3083333333357, 946.4416666666682, 973.050000000002, 899.6500000000019, 967.5916666666685, 937.4750000000014, 969.2666666666685, 916.4916666666685, 932.9916666666684, 1010.7666666666685, 979.3416666666686, 966.5583333333352, 968.3583333333352, 945.2666666666688, 977.9166666666689, 937.1416666666684, 921.4166666666683, 951.9000000000017, 898.9583333333351, 937.825000000002, 938.0666666666683, 928.233333333335, 999.6916666666685, 923.5083333333355, 948.6166666666687, 1005.1916666666681, 970.7833333333352, 943.4250000000012, 944.9166666666684, 964.8750000000024, 969.0916666666687, 978.6250000000023, 933.5166666666684, 1019.950000000002, 962.8583333333354, 941.3833333333356, 989.7500000000022, 985.883333333335, 965.9666666666687, 977.4750000000013, 908.3500000000022, 957.0083333333354, 1046.750000000002, 893.2500000000019, 982.8583333333353, 971.950000000002, 980.2166666666689, 1013.8083333333352, 987.3833333333357, 974.8666666666684, 1006.5916666666689, 982.4083333333356, 1003.6583333333352, 997.2833333333352, 1022.3666666666694, 965.2666666666686, 1011.7916666666688, 971.1666666666682, 977.8500000000024, 1009.6500000000021, 992.0333333333351, 1024.2583333333353, 998.9000000000025, 1005.7500000000018, 1004.2250000000017, 1015.2416666666686, 1012.8000000000022, 1018.0000000000023, 969.4583333333351, 1017.0666666666685, 992.1750000000023, 989.9416666666685, 1011.0250000000018, 1041.8666666666684], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [862.9000000000013, 889.8916666666678, 973.1083333333353, 980.3666666666684, 939.5500000000022, 945.7666666666688, 925.8333333333347, 913.5000000000017, 898.6083333333348, 953.1250000000023, 931.891666666668, 943.1833333333351, 940.8083333333352, 917.2000000000015, 932.6583333333351, 903.233333333335, 869.8666666666685, 896.7250000000018, 963.7166666666685, 916.3583333333352, 875.4500000000018, 909.2916666666687, 992.9916666666685, 941.5916666666684, 934.8166666666689, 951.4083333333355, 951.3083333333357, 946.4416666666682, 973.050000000002, 899.6500000000019, 967.5916666666685, 937.4750000000014, 969.2666666666685, 916.4916666666685, 932.9916666666684, 1010.7666666666685, 979.3416666666686, 966.5583333333352, 968.3583333333352, 945.2666666666688, 977.9166666666689, 937.1416666666684, 921.4166666666683, 951.9000000000017, 898.9583333333351, 937.825000000002, 938.0666666666683, 928.233333333335, 999.6916666666685, 923.5083333333355, 948.6166666666687, 1005.1916666666681, 970.7833333333352, 943.4250000000012, 944.9166666666684, 964.8750000000024, 969.0916666666687, 978.6250000000023, 933.5166666666684, 1019.950000000002, 962.8583333333354, 941.3833333333356, 989.7500000000022, 985.883333333335, 965.9666666666687, 977.4750000000013, 908.3500000000022, 957.0083333333354, 1046.750000000002, 893.2500000000019, 982.8583333333353, 971.950000000002, 980.2166666666689, 1013.8083333333352, 987.3833333333357, 974.8666666666684, 1006.5916666666689, 982.4083333333356, 1003.6583333333352, 997.2833333333352, 1022.3666666666694, 965.2666666666686, 1011.7916666666688, 971.1666666666682, 977.8500000000024, 1009.6500000000021, 992.0333333333351, 1024.2583333333353, 998.9000000000025, 1005.7500000000018, 1004.2250000000017, 1015.2416666666686, 1012.8000000000022, 1018.0000000000023, 969.4583333333351, 1017.0666666666685, 992.1750000000023, 989.9416666666685, 1011.0250000000018, 1041.8666666666684]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24078902937042831, "mean_inference_ms": 2.043498030055801, "mean_action_processing_ms": 0.09062435882215641, "mean_env_wait_ms": 1.5306950901709766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006414175033569336, "StateBufferConnector_ms": 0.0032978057861328125, "ViewRequirementAgentConnector_ms": 0.08460736274719238}, "num_episodes": 27, "episode_return_max": 1046.750000000002, "episode_return_min": 862.9000000000013, "episode_return_mean": 961.4258333333352, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136800, "num_agent_steps_trained": 136500, "num_env_steps_sampled": 136800, "num_env_steps_trained": 136500, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 246.2613500831196, "num_env_steps_trained_throughput_per_sec": 231.7753883135243, "timesteps_total": 136800, "num_env_steps_sampled_lifetime": 136800, "num_agent_steps_sampled_lifetime": 136800, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 136800, "timers": {"training_iteration_time_ms": 10350.232, "restore_workers_time_ms": 0.016, "training_step_time_ms": 615.033, "sample_time_ms": 599.726, "synch_weights_time_ms": 13.855}, "counters": {"num_env_steps_sampled": 136800, "num_env_steps_trained": 136500, "num_agent_steps_sampled": 136800, "num_agent_steps_trained": 136500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 912, "num_samples_added_to_queue": 136800}, "done": false, "training_iteration": 54, "trial_id": "27800_00000", "date": "2024-10-12_15-37-08", "timestamp": 1728743828, "time_this_iter_s": 10.3656485080719, "time_total_s": 557.1850817203522, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f2a10>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 557.1850817203522, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 16.50714285714286, "ram_util_percent": 37.378571428571426}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 329651.96875, "policy_loss": 313628.625, "entropy": 14.586295127868652, "entropy_coeff": 0.01, "var_gnorm": 16.546144485473633, "vf_loss": 1606710.625, "vf_explained_var": 0.1550258994102478}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 464.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 139350, "num_env_steps_trained": 139200, "num_agent_steps_sampled": 139350, "num_agent_steps_trained": 139200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 929, "num_samples_added_to_queue": 139200, "learner_queue": {"size_count": 464, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.166, "learner_load_time_ms": 0.339, "learner_load_wait_time_ms": 1158.643, "learner_dequeue_time_ms": 9792.816}}, "env_runners": {"episode_reward_max": 1061.966666666669, "episode_reward_min": 893.2500000000019, "episode_reward_mean": 983.7207500000019, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 893.2500000000019}, "policy_reward_max": {"default_policy": 1061.966666666669}, "policy_reward_mean": {"default_policy": 983.7207500000019}, "custom_metrics": {"num_consolidated_mean": 2.4987000000000004, "num_consolidated_min": 2.28, "num_consolidated_max": 2.7, "num_overloaded_mean": 0.0347, "num_overloaded_min": 0.0, "num_overloaded_max": 0.1, "num_moves_mean": 5.5257000000000005, "num_moves_min": 4.33, "num_moves_max": 6.54, "mean_accuracy_mean": 42.31334000000002, "mean_accuracy_min": 42.157666666666685, "mean_accuracy_max": 42.51866666666669, "num_model_switches_mean": 3.1493999999999995, "num_model_switches_min": 2.39, "num_model_switches_max": 3.81, "num_slav_mean": 0.10185500000000001, "num_slav_min": 0.08523333333333333, "num_slav_max": 0.11610000000000001, "cpu_conserved_cost_mean": 6.161999999999999, "cpu_conserved_cost_min": 5.5, "cpu_conserved_cost_max": 6.84, "mean_cluster_cpu_util_mean": 0.49085764988325536, "mean_cluster_cpu_util_min": 0.47938815669157314, "mean_cluster_cpu_util_max": 0.5027514576617302, "mean_cluster_mem_util_mean": 0.31711153350591287, "mean_cluster_mem_util_min": 0.3103478886807888, "mean_cluster_mem_util_max": 0.32522066165073626, "reward_consolidation_mean_mean": 5.007083333333333, "reward_consolidation_mean_min": 4.541666666666666, "reward_consolidation_mean_max": 5.499999999999999, "reward_illegal_mean_mean": -0.05783333333333332, "reward_illegal_mean_min": -0.16666666666666663, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.35625000000002, "reward_accuracy_mean_min": 5.775000000000016, "reward_accuracy_mean_max": 6.866666666666688, "reward_sla_mean_mean": -1.4682925, "reward_sla_mean_min": -1.6882499999999998, "reward_sla_mean_max": -1.2175, "reward_consolidation_sum_mean": 500.70833333333326, "reward_consolidation_sum_min": 454.1666666666666, "reward_consolidation_sum_max": 549.9999999999999, "reward_illegal_sum_mean": -5.783333333333332, "reward_illegal_sum_min": -16.666666666666664, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 635.6250000000018, "reward_accuracy_sum_min": 577.5000000000016, "reward_accuracy_sum_max": 686.6666666666688, "reward_sla_sum_mean": -146.82925, "reward_sla_sum_min": -168.825, "reward_sla_sum_max": -121.75, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5782.0, "global_timestep_min": 4100, "global_timestep_max": 7400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [934.8166666666689, 951.4083333333355, 951.3083333333357, 946.4416666666682, 973.050000000002, 899.6500000000019, 967.5916666666685, 937.4750000000014, 969.2666666666685, 916.4916666666685, 932.9916666666684, 1010.7666666666685, 979.3416666666686, 966.5583333333352, 968.3583333333352, 945.2666666666688, 977.9166666666689, 937.1416666666684, 921.4166666666683, 951.9000000000017, 898.9583333333351, 937.825000000002, 938.0666666666683, 928.233333333335, 999.6916666666685, 923.5083333333355, 948.6166666666687, 1005.1916666666681, 970.7833333333352, 943.4250000000012, 944.9166666666684, 964.8750000000024, 969.0916666666687, 978.6250000000023, 933.5166666666684, 1019.950000000002, 962.8583333333354, 941.3833333333356, 989.7500000000022, 985.883333333335, 965.9666666666687, 977.4750000000013, 908.3500000000022, 957.0083333333354, 1046.750000000002, 893.2500000000019, 982.8583333333353, 971.950000000002, 980.2166666666689, 1013.8083333333352, 987.3833333333357, 974.8666666666684, 1006.5916666666689, 982.4083333333356, 1003.6583333333352, 997.2833333333352, 1022.3666666666694, 965.2666666666686, 1011.7916666666688, 971.1666666666682, 977.8500000000024, 1009.6500000000021, 992.0333333333351, 1024.2583333333353, 998.9000000000025, 1005.7500000000018, 1004.2250000000017, 1015.2416666666686, 1012.8000000000022, 1018.0000000000023, 969.4583333333351, 1017.0666666666685, 992.1750000000023, 989.9416666666685, 1011.0250000000018, 1041.8666666666684, 983.3250000000019, 996.783333333335, 1035.1583333333356, 1033.4833333333352, 1014.3250000000022, 1008.9500000000023, 1029.6333333333357, 1011.5083333333358, 972.8000000000026, 1012.7000000000019, 1061.966666666669, 1025.0500000000025, 1026.5416666666683, 1005.3500000000022, 1013.5916666666687, 1054.6583333333347, 976.5333333333352, 1009.2750000000021, 997.9666666666685, 1025.3083333333352, 1052.9750000000017, 1041.0000000000025, 1019.9583333333355, 1038.2666666666687], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [934.8166666666689, 951.4083333333355, 951.3083333333357, 946.4416666666682, 973.050000000002, 899.6500000000019, 967.5916666666685, 937.4750000000014, 969.2666666666685, 916.4916666666685, 932.9916666666684, 1010.7666666666685, 979.3416666666686, 966.5583333333352, 968.3583333333352, 945.2666666666688, 977.9166666666689, 937.1416666666684, 921.4166666666683, 951.9000000000017, 898.9583333333351, 937.825000000002, 938.0666666666683, 928.233333333335, 999.6916666666685, 923.5083333333355, 948.6166666666687, 1005.1916666666681, 970.7833333333352, 943.4250000000012, 944.9166666666684, 964.8750000000024, 969.0916666666687, 978.6250000000023, 933.5166666666684, 1019.950000000002, 962.8583333333354, 941.3833333333356, 989.7500000000022, 985.883333333335, 965.9666666666687, 977.4750000000013, 908.3500000000022, 957.0083333333354, 1046.750000000002, 893.2500000000019, 982.8583333333353, 971.950000000002, 980.2166666666689, 1013.8083333333352, 987.3833333333357, 974.8666666666684, 1006.5916666666689, 982.4083333333356, 1003.6583333333352, 997.2833333333352, 1022.3666666666694, 965.2666666666686, 1011.7916666666688, 971.1666666666682, 977.8500000000024, 1009.6500000000021, 992.0333333333351, 1024.2583333333353, 998.9000000000025, 1005.7500000000018, 1004.2250000000017, 1015.2416666666686, 1012.8000000000022, 1018.0000000000023, 969.4583333333351, 1017.0666666666685, 992.1750000000023, 989.9416666666685, 1011.0250000000018, 1041.8666666666684, 983.3250000000019, 996.783333333335, 1035.1583333333356, 1033.4833333333352, 1014.3250000000022, 1008.9500000000023, 1029.6333333333357, 1011.5083333333358, 972.8000000000026, 1012.7000000000019, 1061.966666666669, 1025.0500000000025, 1026.5416666666683, 1005.3500000000022, 1013.5916666666687, 1054.6583333333347, 976.5333333333352, 1009.2750000000021, 997.9666666666685, 1025.3083333333352, 1052.9750000000017, 1041.0000000000025, 1019.9583333333355, 1038.2666666666687]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2408004050126037, "mean_inference_ms": 2.0431822119350667, "mean_action_processing_ms": 0.0906248655649619, "mean_env_wait_ms": 1.5306139938585757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006390571594238281, "StateBufferConnector_ms": 0.0032987594604492188, "ViewRequirementAgentConnector_ms": 0.08528423309326172}, "num_episodes": 24, "episode_return_max": 1061.966666666669, "episode_return_min": 893.2500000000019, "episode_return_mean": 983.7207500000019, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139350, "num_agent_steps_trained": 139200, "num_env_steps_sampled": 139350, "num_env_steps_trained": 139200, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 249.55574750700336, "num_env_steps_trained_throughput_per_sec": 264.2354973603565, "timesteps_total": 139350, "num_env_steps_sampled_lifetime": 139350, "num_agent_steps_sampled_lifetime": 139350, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 139350, "timers": {"training_iteration_time_ms": 10339.428, "restore_workers_time_ms": 0.015, "training_step_time_ms": 606.2, "sample_time_ms": 590.762, "synch_weights_time_ms": 14.008}, "counters": {"num_env_steps_sampled": 139350, "num_env_steps_trained": 139200, "num_agent_steps_sampled": 139350, "num_agent_steps_trained": 139200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 929, "num_samples_added_to_queue": 139200}, "done": false, "training_iteration": 55, "trial_id": "27800_00000", "date": "2024-10-12_15-37-18", "timestamp": 1728743838, "time_this_iter_s": 10.228072166442871, "time_total_s": 567.413153886795, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f3a30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 567.413153886795, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 16.44666666666667, "ram_util_percent": 37.473333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 290050.625, "policy_loss": 274731.5, "entropy": 12.988487243652344, "entropy_coeff": 0.01, "var_gnorm": 16.571857452392578, "vf_loss": 1535808.375, "vf_explained_var": 0.16903084516525269}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 472.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 141900, "num_env_steps_trained": 141600, "num_agent_steps_sampled": 141900, "num_agent_steps_trained": 141600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 946, "num_samples_added_to_queue": 141900, "learner_queue": {"size_count": 472, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.661, "learner_load_time_ms": 0.371, "learner_load_wait_time_ms": 1177.64, "learner_dequeue_time_ms": 9770.824}}, "env_runners": {"episode_reward_max": 1096.4250000000022, "episode_reward_min": 893.2500000000019, "episode_reward_mean": 1011.5350833333355, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 893.2500000000019}, "policy_reward_max": {"default_policy": 1096.4250000000022}, "policy_reward_mean": {"default_policy": 1011.5350833333355}, "custom_metrics": {"num_consolidated_mean": 2.5732, "num_consolidated_min": 2.36, "num_consolidated_max": 2.8, "num_overloaded_mean": 0.028800000000000003, "num_overloaded_min": 0.0, "num_overloaded_max": 0.1, "num_moves_mean": 5.0216, "num_moves_min": 3.59, "num_moves_max": 6.15, "mean_accuracy_mean": 42.319483333333345, "mean_accuracy_min": 42.164000000000016, "mean_accuracy_max": 42.51866666666669, "num_model_switches_mean": 2.8949000000000003, "num_model_switches_min": 2.08, "num_model_switches_max": 3.59, "num_slav_mean": 0.0988955, "num_slav_min": 0.08106666666666668, "num_slav_max": 0.11501666666666667, "cpu_conserved_cost_mean": 6.416799999999999, "cpu_conserved_cost_min": 5.7, "cpu_conserved_cost_max": 7.26, "mean_cluster_cpu_util_mean": 0.49530973328485056, "mean_cluster_cpu_util_min": 0.4806354980300831, "mean_cluster_cpu_util_max": 0.5129261991748807, "mean_cluster_mem_util_mean": 0.31925537603153076, "mean_cluster_mem_util_min": 0.3110244375914923, "mean_cluster_mem_util_max": 0.3297738794885043, "reward_consolidation_mean_mean": 5.194583333333332, "reward_consolidation_mean_min": 4.541666666666666, "reward_consolidation_mean_max": 5.729166666666666, "reward_illegal_mean_mean": -0.048, "reward_illegal_mean_min": -0.16666666666666663, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.406750000000019, "reward_accuracy_mean_min": 5.775000000000016, "reward_accuracy_mean_max": 6.866666666666688, "reward_sla_mean_mean": -1.4379825, "reward_sla_mean_min": -1.6882499999999998, "reward_sla_mean_max": -1.18025, "reward_consolidation_sum_mean": 519.4583333333333, "reward_consolidation_sum_min": 454.1666666666666, "reward_consolidation_sum_max": 572.9166666666666, "reward_illegal_sum_mean": -4.8, "reward_illegal_sum_min": -16.666666666666664, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 640.6750000000019, "reward_accuracy_sum_min": 577.5000000000016, "reward_accuracy_sum_max": 686.6666666666688, "reward_sla_sum_mean": -143.79825000000002, "reward_sla_sum_min": -168.825, "reward_sla_sum_max": -118.02499999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5512.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1005.1916666666681, 970.7833333333352, 943.4250000000012, 944.9166666666684, 964.8750000000024, 969.0916666666687, 978.6250000000023, 933.5166666666684, 1019.950000000002, 962.8583333333354, 941.3833333333356, 989.7500000000022, 985.883333333335, 965.9666666666687, 977.4750000000013, 908.3500000000022, 957.0083333333354, 1046.750000000002, 893.2500000000019, 982.8583333333353, 971.950000000002, 980.2166666666689, 1013.8083333333352, 987.3833333333357, 974.8666666666684, 1006.5916666666689, 982.4083333333356, 1003.6583333333352, 997.2833333333352, 1022.3666666666694, 965.2666666666686, 1011.7916666666688, 971.1666666666682, 977.8500000000024, 1009.6500000000021, 992.0333333333351, 1024.2583333333353, 998.9000000000025, 1005.7500000000018, 1004.2250000000017, 1015.2416666666686, 1012.8000000000022, 1018.0000000000023, 969.4583333333351, 1017.0666666666685, 992.1750000000023, 989.9416666666685, 1011.0250000000018, 1041.8666666666684, 983.3250000000019, 996.783333333335, 1035.1583333333356, 1033.4833333333352, 1014.3250000000022, 1008.9500000000023, 1029.6333333333357, 1011.5083333333358, 972.8000000000026, 1012.7000000000019, 1061.966666666669, 1025.0500000000025, 1026.5416666666683, 1005.3500000000022, 1013.5916666666687, 1054.6583333333347, 976.5333333333352, 1009.2750000000021, 997.9666666666685, 1025.3083333333352, 1052.9750000000017, 1041.0000000000025, 1019.9583333333355, 1038.2666666666687, 1043.8666666666686, 1052.9000000000024, 1043.1166666666688, 960.7916666666687, 1033.9000000000017, 1096.4250000000022, 1060.7500000000025, 1060.7250000000015, 1051.2500000000023, 1054.8916666666692, 1007.6416666666686, 1021.5333333333357, 1090.6166666666684, 1065.0500000000022, 1071.7333333333356, 1093.300000000002, 1059.8583333333354, 1082.7500000000016, 1021.5583333333358, 1038.0250000000017, 1049.675000000002, 1074.3000000000018, 1059.916666666669, 1073.6083333333358, 1015.9250000000021, 1067.2916666666688, 1044.091666666669], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1005.1916666666681, 970.7833333333352, 943.4250000000012, 944.9166666666684, 964.8750000000024, 969.0916666666687, 978.6250000000023, 933.5166666666684, 1019.950000000002, 962.8583333333354, 941.3833333333356, 989.7500000000022, 985.883333333335, 965.9666666666687, 977.4750000000013, 908.3500000000022, 957.0083333333354, 1046.750000000002, 893.2500000000019, 982.8583333333353, 971.950000000002, 980.2166666666689, 1013.8083333333352, 987.3833333333357, 974.8666666666684, 1006.5916666666689, 982.4083333333356, 1003.6583333333352, 997.2833333333352, 1022.3666666666694, 965.2666666666686, 1011.7916666666688, 971.1666666666682, 977.8500000000024, 1009.6500000000021, 992.0333333333351, 1024.2583333333353, 998.9000000000025, 1005.7500000000018, 1004.2250000000017, 1015.2416666666686, 1012.8000000000022, 1018.0000000000023, 969.4583333333351, 1017.0666666666685, 992.1750000000023, 989.9416666666685, 1011.0250000000018, 1041.8666666666684, 983.3250000000019, 996.783333333335, 1035.1583333333356, 1033.4833333333352, 1014.3250000000022, 1008.9500000000023, 1029.6333333333357, 1011.5083333333358, 972.8000000000026, 1012.7000000000019, 1061.966666666669, 1025.0500000000025, 1026.5416666666683, 1005.3500000000022, 1013.5916666666687, 1054.6583333333347, 976.5333333333352, 1009.2750000000021, 997.9666666666685, 1025.3083333333352, 1052.9750000000017, 1041.0000000000025, 1019.9583333333355, 1038.2666666666687, 1043.8666666666686, 1052.9000000000024, 1043.1166666666688, 960.7916666666687, 1033.9000000000017, 1096.4250000000022, 1060.7500000000025, 1060.7250000000015, 1051.2500000000023, 1054.8916666666692, 1007.6416666666686, 1021.5333333333357, 1090.6166666666684, 1065.0500000000022, 1071.7333333333356, 1093.300000000002, 1059.8583333333354, 1082.7500000000016, 1021.5583333333358, 1038.0250000000017, 1049.675000000002, 1074.3000000000018, 1059.916666666669, 1073.6083333333358, 1015.9250000000021, 1067.2916666666688, 1044.091666666669]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24082126312701413, "mean_inference_ms": 2.042859739959482, "mean_action_processing_ms": 0.09062793948911359, "mean_env_wait_ms": 1.530536796301863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006314992904663086, "StateBufferConnector_ms": 0.0032529830932617188, "ViewRequirementAgentConnector_ms": 0.08419418334960938}, "num_episodes": 27, "episode_return_max": 1096.4250000000022, "episode_return_min": 893.2500000000019, "episode_return_mean": 1011.5350833333355, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 141900, "num_agent_steps_trained": 141600, "num_env_steps_sampled": 141900, "num_env_steps_trained": 141600, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 242.12853925486493, "num_env_steps_trained_throughput_per_sec": 227.88568400457876, "timesteps_total": 141900, "num_env_steps_sampled_lifetime": 141900, "num_agent_steps_sampled_lifetime": 141900, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 141900, "timers": {"training_iteration_time_ms": 10333.684, "restore_workers_time_ms": 0.013, "training_step_time_ms": 618.445, "sample_time_ms": 603.096, "synch_weights_time_ms": 13.916}, "counters": {"num_env_steps_sampled": 141900, "num_env_steps_trained": 141600, "num_agent_steps_sampled": 141900, "num_agent_steps_trained": 141600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 946, "num_samples_added_to_queue": 141900}, "done": false, "training_iteration": 56, "trial_id": "27800_00000", "date": "2024-10-12_15-37-29", "timestamp": 1728743849, "time_this_iter_s": 10.541536808013916, "time_total_s": 577.954690694809, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c1f90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 577.954690694809, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 16.406666666666663, "ram_util_percent": 37.693333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 259346.515625, "policy_loss": 242723.28125, "entropy": 12.111116409301758, "entropy_coeff": 0.01, "var_gnorm": 16.596914291381836, "vf_loss": 1665956.625, "vf_explained_var": 0.17840194702148438}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 481.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 144450, "num_env_steps_trained": 144300, "num_agent_steps_sampled": 144450, "num_agent_steps_trained": 144300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 963, "num_samples_added_to_queue": 144300, "learner_queue": {"size_count": 481, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.967, "learner_load_time_ms": 0.396, "learner_load_wait_time_ms": 1166.46, "learner_dequeue_time_ms": 9754.949}}, "env_runners": {"episode_reward_max": 1115.0666666666684, "episode_reward_min": 960.7916666666687, "episode_reward_mean": 1037.869750000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 960.7916666666687}, "policy_reward_max": {"default_policy": 1115.0666666666684}, "policy_reward_mean": {"default_policy": 1037.869750000002}, "custom_metrics": {"num_consolidated_mean": 2.6435000000000004, "num_consolidated_min": 2.4, "num_consolidated_max": 2.84, "num_overloaded_mean": 0.022999999999999993, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 4.504, "num_moves_min": 3.19, "num_moves_max": 5.78, "mean_accuracy_mean": 42.32144666666668, "mean_accuracy_min": 42.170333333333346, "mean_accuracy_max": 42.51866666666669, "num_model_switches_mean": 2.6264, "num_model_switches_min": 1.91, "num_model_switches_max": 3.37, "num_slav_mean": 0.09608216666666668, "num_slav_min": 0.08023333333333332, "num_slav_max": 0.11501666666666667, "cpu_conserved_cost_mean": 6.660400000000001, "cpu_conserved_cost_min": 5.78, "cpu_conserved_cost_max": 7.38, "mean_cluster_cpu_util_mean": 0.4990422269198622, "mean_cluster_cpu_util_min": 0.4822142402530611, "mean_cluster_cpu_util_max": 0.5143872535728338, "mean_cluster_mem_util_mean": 0.32131489046040357, "mean_cluster_mem_util_min": 0.3110244375914923, "mean_cluster_mem_util_max": 0.3297738794885043, "reward_consolidation_mean_mean": 5.374166666666665, "reward_consolidation_mean_min": 4.791666666666666, "reward_consolidation_mean_max": 5.854166666666666, "reward_illegal_mean_mean": -0.03833333333333333, "reward_illegal_mean_min": -0.11666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.449666666666686, "reward_accuracy_mean_min": 6.033333333333349, "reward_accuracy_mean_max": 6.866666666666688, "reward_sla_mean_mean": -1.4068024999999995, "reward_sla_mean_min": -1.6882499999999998, "reward_sla_mean_max": -1.18025, "reward_consolidation_sum_mean": 537.4166666666665, "reward_consolidation_sum_min": 479.16666666666663, "reward_consolidation_sum_max": 585.4166666666666, "reward_illegal_sum_mean": -3.833333333333333, "reward_illegal_sum_min": -11.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 644.9666666666686, "reward_accuracy_sum_min": 603.333333333335, "reward_accuracy_sum_max": 686.6666666666688, "reward_sla_sum_mean": -140.68025, "reward_sla_sum_min": -168.825, "reward_sla_sum_max": -118.02499999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4440.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [974.8666666666684, 1006.5916666666689, 982.4083333333356, 1003.6583333333352, 997.2833333333352, 1022.3666666666694, 965.2666666666686, 1011.7916666666688, 971.1666666666682, 977.8500000000024, 1009.6500000000021, 992.0333333333351, 1024.2583333333353, 998.9000000000025, 1005.7500000000018, 1004.2250000000017, 1015.2416666666686, 1012.8000000000022, 1018.0000000000023, 969.4583333333351, 1017.0666666666685, 992.1750000000023, 989.9416666666685, 1011.0250000000018, 1041.8666666666684, 983.3250000000019, 996.783333333335, 1035.1583333333356, 1033.4833333333352, 1014.3250000000022, 1008.9500000000023, 1029.6333333333357, 1011.5083333333358, 972.8000000000026, 1012.7000000000019, 1061.966666666669, 1025.0500000000025, 1026.5416666666683, 1005.3500000000022, 1013.5916666666687, 1054.6583333333347, 976.5333333333352, 1009.2750000000021, 997.9666666666685, 1025.3083333333352, 1052.9750000000017, 1041.0000000000025, 1019.9583333333355, 1038.2666666666687, 1043.8666666666686, 1052.9000000000024, 1043.1166666666688, 960.7916666666687, 1033.9000000000017, 1096.4250000000022, 1060.7500000000025, 1060.7250000000015, 1051.2500000000023, 1054.8916666666692, 1007.6416666666686, 1021.5333333333357, 1090.6166666666684, 1065.0500000000022, 1071.7333333333356, 1093.300000000002, 1059.8583333333354, 1082.7500000000016, 1021.5583333333358, 1038.0250000000017, 1049.675000000002, 1074.3000000000018, 1059.916666666669, 1073.6083333333358, 1015.9250000000021, 1067.2916666666688, 1044.091666666669, 1086.7000000000023, 1076.166666666669, 1108.4833333333358, 1088.5833333333358, 1082.2583333333355, 1094.5833333333353, 1098.2166666666685, 1108.6583333333351, 1069.1833333333352, 1052.7416666666684, 1056.4583333333358, 1074.358333333335, 1045.3333333333348, 1081.8250000000019, 1072.8500000000022, 1077.1750000000025, 1094.191666666669, 1039.9833333333354, 1077.4000000000026, 1076.5250000000024, 1099.3250000000023, 1115.0666666666684, 1042.5750000000023, 1110.0916666666687], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [974.8666666666684, 1006.5916666666689, 982.4083333333356, 1003.6583333333352, 997.2833333333352, 1022.3666666666694, 965.2666666666686, 1011.7916666666688, 971.1666666666682, 977.8500000000024, 1009.6500000000021, 992.0333333333351, 1024.2583333333353, 998.9000000000025, 1005.7500000000018, 1004.2250000000017, 1015.2416666666686, 1012.8000000000022, 1018.0000000000023, 969.4583333333351, 1017.0666666666685, 992.1750000000023, 989.9416666666685, 1011.0250000000018, 1041.8666666666684, 983.3250000000019, 996.783333333335, 1035.1583333333356, 1033.4833333333352, 1014.3250000000022, 1008.9500000000023, 1029.6333333333357, 1011.5083333333358, 972.8000000000026, 1012.7000000000019, 1061.966666666669, 1025.0500000000025, 1026.5416666666683, 1005.3500000000022, 1013.5916666666687, 1054.6583333333347, 976.5333333333352, 1009.2750000000021, 997.9666666666685, 1025.3083333333352, 1052.9750000000017, 1041.0000000000025, 1019.9583333333355, 1038.2666666666687, 1043.8666666666686, 1052.9000000000024, 1043.1166666666688, 960.7916666666687, 1033.9000000000017, 1096.4250000000022, 1060.7500000000025, 1060.7250000000015, 1051.2500000000023, 1054.8916666666692, 1007.6416666666686, 1021.5333333333357, 1090.6166666666684, 1065.0500000000022, 1071.7333333333356, 1093.300000000002, 1059.8583333333354, 1082.7500000000016, 1021.5583333333358, 1038.0250000000017, 1049.675000000002, 1074.3000000000018, 1059.916666666669, 1073.6083333333358, 1015.9250000000021, 1067.2916666666688, 1044.091666666669, 1086.7000000000023, 1076.166666666669, 1108.4833333333358, 1088.5833333333358, 1082.2583333333355, 1094.5833333333353, 1098.2166666666685, 1108.6583333333351, 1069.1833333333352, 1052.7416666666684, 1056.4583333333358, 1074.358333333335, 1045.3333333333348, 1081.8250000000019, 1072.8500000000022, 1077.1750000000025, 1094.191666666669, 1039.9833333333354, 1077.4000000000026, 1076.5250000000024, 1099.3250000000023, 1115.0666666666684, 1042.5750000000023, 1110.0916666666687]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2408450962942971, "mean_inference_ms": 2.0428829383895124, "mean_action_processing_ms": 0.09063394171060718, "mean_env_wait_ms": 1.5304914696450993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006324052810668945, "StateBufferConnector_ms": 0.003228902816772461, "ViewRequirementAgentConnector_ms": 0.08430266380310059}, "num_episodes": 24, "episode_return_max": 1115.0666666666684, "episode_return_min": 960.7916666666687, "episode_return_mean": 1037.869750000002, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144450, "num_agent_steps_trained": 144300, "num_env_steps_sampled": 144450, "num_env_steps_trained": 144300, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 245.08343568749862, "num_env_steps_trained_throughput_per_sec": 259.50010837499855, "timesteps_total": 144450, "num_env_steps_sampled_lifetime": 144450, "num_agent_steps_sampled_lifetime": 144450, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 144450, "timers": {"training_iteration_time_ms": 10336.328, "restore_workers_time_ms": 0.016, "training_step_time_ms": 607.012, "sample_time_ms": 592.248, "synch_weights_time_ms": 13.459}, "counters": {"num_env_steps_sampled": 144450, "num_env_steps_trained": 144300, "num_agent_steps_sampled": 144450, "num_agent_steps_trained": 144300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 963, "num_samples_added_to_queue": 144300}, "done": false, "training_iteration": 57, "trial_id": "27800_00000", "date": "2024-10-12_15-37-39", "timestamp": 1728743859, "time_this_iter_s": 10.413973093032837, "time_total_s": 588.3686637878418, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a945ee3370>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 588.3686637878418, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 16.44, "ram_util_percent": 37.806666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 269759.90625, "policy_loss": 252185.0, "entropy": 11.649571418762207, "entropy_coeff": 0.01, "var_gnorm": 16.618328094482422, "vf_loss": 1760984.75, "vf_explained_var": 0.1877172589302063}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 489.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 147000, "num_env_steps_trained": 146700, "num_agent_steps_sampled": 147000, "num_agent_steps_trained": 146700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 980, "num_samples_added_to_queue": 147000, "learner_queue": {"size_count": 489, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.324, "learner_load_time_ms": 0.414, "learner_load_wait_time_ms": 1168.315, "learner_dequeue_time_ms": 9800.365}}, "env_runners": {"episode_reward_max": 1129.7583333333357, "episode_reward_min": 960.7916666666687, "episode_reward_mean": 1061.5140833333355, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 960.7916666666687}, "policy_reward_max": {"default_policy": 1129.7583333333357}, "policy_reward_mean": {"default_policy": 1061.5140833333355}, "custom_metrics": {"num_consolidated_mean": 2.7188999999999997, "num_consolidated_min": 2.51, "num_consolidated_max": 2.86, "num_overloaded_mean": 0.019799999999999998, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 3.939500000000001, "num_moves_min": 2.77, "num_moves_max": 5.24, "mean_accuracy_mean": 42.309793333333346, "mean_accuracy_min": 42.15133333333335, "mean_accuracy_max": 42.518666666666675, "num_model_switches_mean": 2.3605, "num_model_switches_min": 1.89, "num_model_switches_max": 3.05, "num_slav_mean": 0.092218, "num_slav_min": 0.07723333333333332, "num_slav_max": 0.10731666666666667, "cpu_conserved_cost_mean": 6.933599999999999, "cpu_conserved_cost_min": 6.18, "cpu_conserved_cost_max": 7.48, "mean_cluster_cpu_util_mean": 0.5032327571633506, "mean_cluster_cpu_util_min": 0.492906549181954, "mean_cluster_cpu_util_max": 0.5143872535728338, "mean_cluster_mem_util_mean": 0.32390328577707456, "mean_cluster_mem_util_min": 0.31665425062430036, "mean_cluster_mem_util_max": 0.3300243181133212, "reward_consolidation_mean_mean": 5.547291666666666, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 5.895833333333332, "reward_illegal_mean_mean": -0.033, "reward_illegal_mean_min": -0.11666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.455666666666686, "reward_accuracy_mean_min": 6.033333333333349, "reward_accuracy_mean_max": 6.866666666666688, "reward_sla_mean_mean": -1.3548174999999998, "reward_sla_mean_min": -1.6097499999999996, "reward_sla_mean_max": -1.1345, "reward_consolidation_sum_mean": 554.7291666666666, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 589.5833333333333, "reward_illegal_sum_mean": -3.3, "reward_illegal_sum_min": -11.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 645.5666666666685, "reward_accuracy_sum_min": 603.333333333335, "reward_accuracy_sum_max": 686.6666666666688, "reward_sla_sum_mean": -135.48175, "reward_sla_sum_min": -160.97499999999997, "reward_sla_sum_max": -113.45, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3234.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1035.1583333333356, 1033.4833333333352, 1014.3250000000022, 1008.9500000000023, 1029.6333333333357, 1011.5083333333358, 972.8000000000026, 1012.7000000000019, 1061.966666666669, 1025.0500000000025, 1026.5416666666683, 1005.3500000000022, 1013.5916666666687, 1054.6583333333347, 976.5333333333352, 1009.2750000000021, 997.9666666666685, 1025.3083333333352, 1052.9750000000017, 1041.0000000000025, 1019.9583333333355, 1038.2666666666687, 1043.8666666666686, 1052.9000000000024, 1043.1166666666688, 960.7916666666687, 1033.9000000000017, 1096.4250000000022, 1060.7500000000025, 1060.7250000000015, 1051.2500000000023, 1054.8916666666692, 1007.6416666666686, 1021.5333333333357, 1090.6166666666684, 1065.0500000000022, 1071.7333333333356, 1093.300000000002, 1059.8583333333354, 1082.7500000000016, 1021.5583333333358, 1038.0250000000017, 1049.675000000002, 1074.3000000000018, 1059.916666666669, 1073.6083333333358, 1015.9250000000021, 1067.2916666666688, 1044.091666666669, 1086.7000000000023, 1076.166666666669, 1108.4833333333358, 1088.5833333333358, 1082.2583333333355, 1094.5833333333353, 1098.2166666666685, 1108.6583333333351, 1069.1833333333352, 1052.7416666666684, 1056.4583333333358, 1074.358333333335, 1045.3333333333348, 1081.8250000000019, 1072.8500000000022, 1077.1750000000025, 1094.191666666669, 1039.9833333333354, 1077.4000000000026, 1076.5250000000024, 1099.3250000000023, 1115.0666666666684, 1042.5750000000023, 1110.0916666666687, 1100.9166666666688, 1089.3583333333354, 1089.041666666668, 1089.7916666666686, 1031.4166666666686, 1092.625000000002, 1077.000000000002, 1107.3083333333354, 1096.1416666666685, 1098.283333333335, 1095.4666666666692, 1103.8833333333357, 1104.325000000002, 1057.4166666666683, 1086.5333333333356, 1083.6333333333353, 1092.4500000000028, 1091.4666666666687, 1066.5416666666688, 1062.6500000000021, 1076.0916666666685, 1105.7416666666686, 1083.6583333333356, 1129.7583333333357, 1089.5583333333357, 1084.4750000000015, 1074.650000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1035.1583333333356, 1033.4833333333352, 1014.3250000000022, 1008.9500000000023, 1029.6333333333357, 1011.5083333333358, 972.8000000000026, 1012.7000000000019, 1061.966666666669, 1025.0500000000025, 1026.5416666666683, 1005.3500000000022, 1013.5916666666687, 1054.6583333333347, 976.5333333333352, 1009.2750000000021, 997.9666666666685, 1025.3083333333352, 1052.9750000000017, 1041.0000000000025, 1019.9583333333355, 1038.2666666666687, 1043.8666666666686, 1052.9000000000024, 1043.1166666666688, 960.7916666666687, 1033.9000000000017, 1096.4250000000022, 1060.7500000000025, 1060.7250000000015, 1051.2500000000023, 1054.8916666666692, 1007.6416666666686, 1021.5333333333357, 1090.6166666666684, 1065.0500000000022, 1071.7333333333356, 1093.300000000002, 1059.8583333333354, 1082.7500000000016, 1021.5583333333358, 1038.0250000000017, 1049.675000000002, 1074.3000000000018, 1059.916666666669, 1073.6083333333358, 1015.9250000000021, 1067.2916666666688, 1044.091666666669, 1086.7000000000023, 1076.166666666669, 1108.4833333333358, 1088.5833333333358, 1082.2583333333355, 1094.5833333333353, 1098.2166666666685, 1108.6583333333351, 1069.1833333333352, 1052.7416666666684, 1056.4583333333358, 1074.358333333335, 1045.3333333333348, 1081.8250000000019, 1072.8500000000022, 1077.1750000000025, 1094.191666666669, 1039.9833333333354, 1077.4000000000026, 1076.5250000000024, 1099.3250000000023, 1115.0666666666684, 1042.5750000000023, 1110.0916666666687, 1100.9166666666688, 1089.3583333333354, 1089.041666666668, 1089.7916666666686, 1031.4166666666686, 1092.625000000002, 1077.000000000002, 1107.3083333333354, 1096.1416666666685, 1098.283333333335, 1095.4666666666692, 1103.8833333333357, 1104.325000000002, 1057.4166666666683, 1086.5333333333356, 1083.6333333333353, 1092.4500000000028, 1091.4666666666687, 1066.5416666666688, 1062.6500000000021, 1076.0916666666685, 1105.7416666666686, 1083.6583333333356, 1129.7583333333357, 1089.5583333333357, 1084.4750000000015, 1074.650000000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2408618179877263, "mean_inference_ms": 2.0429002938356104, "mean_action_processing_ms": 0.09064262199668165, "mean_env_wait_ms": 1.5304286843969843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006372690200805664, "StateBufferConnector_ms": 0.0032417774200439453, "ViewRequirementAgentConnector_ms": 0.08451557159423828}, "num_episodes": 27, "episode_return_max": 1129.7583333333357, "episode_return_min": 960.7916666666687, "episode_return_mean": 1061.5140833333355, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 147000, "num_agent_steps_trained": 146700, "num_env_steps_sampled": 147000, "num_env_steps_trained": 146700, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 246.39618566623986, "num_env_steps_trained_throughput_per_sec": 231.90229239175517, "timesteps_total": 147000, "num_env_steps_sampled_lifetime": 147000, "num_agent_steps_sampled_lifetime": 147000, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 147000, "timers": {"training_iteration_time_ms": 10343.231, "restore_workers_time_ms": 0.016, "training_step_time_ms": 606.23, "sample_time_ms": 590.792, "synch_weights_time_ms": 13.832}, "counters": {"num_env_steps_sampled": 147000, "num_env_steps_trained": 146700, "num_agent_steps_sampled": 147000, "num_agent_steps_trained": 146700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 980, "num_samples_added_to_queue": 147000}, "done": false, "training_iteration": 58, "trial_id": "27800_00000", "date": "2024-10-12_15-37-50", "timestamp": 1728743870, "time_this_iter_s": 10.359175205230713, "time_total_s": 598.7278389930725, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f34f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 598.7278389930725, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 16.453333333333333, "ram_util_percent": 37.95333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 251275.171875, "policy_loss": 235398.484375, "entropy": 11.617918968200684, "entropy_coeff": 0.01, "var_gnorm": 16.64081382751465, "vf_loss": 1591154.0, "vf_explained_var": 0.20380115509033203}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 498.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 149550, "num_env_steps_trained": 149400, "num_agent_steps_sampled": 149550, "num_agent_steps_trained": 149400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 997, "num_samples_added_to_queue": 149400, "learner_queue": {"size_count": 498, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.095, "learner_load_time_ms": 0.384, "learner_load_wait_time_ms": 1158.778, "learner_dequeue_time_ms": 9791.713}}, "env_runners": {"episode_reward_max": 1129.7583333333357, "episode_reward_min": 960.7916666666687, "episode_reward_mean": 1078.0600833333356, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 960.7916666666687}, "policy_reward_max": {"default_policy": 1129.7583333333357}, "policy_reward_mean": {"default_policy": 1078.0600833333356}, "custom_metrics": {"num_consolidated_mean": 2.7619, "num_consolidated_min": 2.59, "num_consolidated_max": 2.89, "num_overloaded_mean": 0.015300000000000001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 3.5534, "num_moves_min": 2.77, "num_moves_max": 4.76, "mean_accuracy_mean": 42.28338333333335, "mean_accuracy_min": 42.05633333333334, "mean_accuracy_max": 42.46166666666668, "num_model_switches_mean": 2.2180999999999997, "num_model_switches_min": 1.89, "num_model_switches_max": 2.8, "num_slav_mean": 0.08863166666666666, "num_slav_min": 0.06588333333333334, "num_slav_max": 0.10731666666666667, "cpu_conserved_cost_mean": 7.087600000000001, "cpu_conserved_cost_min": 6.4, "cpu_conserved_cost_max": 7.58, "mean_cluster_cpu_util_mean": 0.5049594318989307, "mean_cluster_cpu_util_min": 0.4940765567351083, "mean_cluster_cpu_util_max": 0.5143872535728338, "mean_cluster_mem_util_mean": 0.325279653897213, "mean_cluster_mem_util_min": 0.31665425062430036, "mean_cluster_mem_util_max": 0.3308848434943598, "reward_consolidation_mean_mean": 5.661874999999998, "reward_consolidation_mean_min": 4.999999999999999, "reward_consolidation_mean_max": 5.937499999999999, "reward_illegal_mean_mean": -0.0255, "reward_illegal_mean_min": -0.11666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.451833333333352, "reward_accuracy_mean_min": 6.125000000000018, "reward_accuracy_mean_max": 6.716666666666689, "reward_sla_mean_mean": -1.3076074999999998, "reward_sla_mean_min": -1.6097499999999996, "reward_sla_mean_max": -0.9762499999999998, "reward_consolidation_sum_mean": 566.1874999999999, "reward_consolidation_sum_min": 499.99999999999994, "reward_consolidation_sum_max": 593.7499999999999, "reward_illegal_sum_mean": -2.55, "reward_illegal_sum_min": -11.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 645.1833333333352, "reward_accuracy_sum_min": 612.5000000000018, "reward_accuracy_sum_max": 671.6666666666689, "reward_sla_sum_mean": -130.76075, "reward_sla_sum_min": -160.97499999999997, "reward_sla_sum_max": -97.62499999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2162.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1043.1166666666688, 960.7916666666687, 1033.9000000000017, 1096.4250000000022, 1060.7500000000025, 1060.7250000000015, 1051.2500000000023, 1054.8916666666692, 1007.6416666666686, 1021.5333333333357, 1090.6166666666684, 1065.0500000000022, 1071.7333333333356, 1093.300000000002, 1059.8583333333354, 1082.7500000000016, 1021.5583333333358, 1038.0250000000017, 1049.675000000002, 1074.3000000000018, 1059.916666666669, 1073.6083333333358, 1015.9250000000021, 1067.2916666666688, 1044.091666666669, 1086.7000000000023, 1076.166666666669, 1108.4833333333358, 1088.5833333333358, 1082.2583333333355, 1094.5833333333353, 1098.2166666666685, 1108.6583333333351, 1069.1833333333352, 1052.7416666666684, 1056.4583333333358, 1074.358333333335, 1045.3333333333348, 1081.8250000000019, 1072.8500000000022, 1077.1750000000025, 1094.191666666669, 1039.9833333333354, 1077.4000000000026, 1076.5250000000024, 1099.3250000000023, 1115.0666666666684, 1042.5750000000023, 1110.0916666666687, 1100.9166666666688, 1089.3583333333354, 1089.041666666668, 1089.7916666666686, 1031.4166666666686, 1092.625000000002, 1077.000000000002, 1107.3083333333354, 1096.1416666666685, 1098.283333333335, 1095.4666666666692, 1103.8833333333357, 1104.325000000002, 1057.4166666666683, 1086.5333333333356, 1083.6333333333353, 1092.4500000000028, 1091.4666666666687, 1066.5416666666688, 1062.6500000000021, 1076.0916666666685, 1105.7416666666686, 1083.6583333333356, 1129.7583333333357, 1089.5583333333357, 1084.4750000000015, 1074.650000000002, 1072.7916666666688, 1101.525000000002, 1106.616666666669, 1086.9500000000023, 1116.7833333333356, 1091.5833333333355, 1070.650000000002, 1086.075000000002, 1115.0000000000025, 1098.641666666669, 1102.4500000000016, 1050.425000000002, 1093.1083333333352, 1104.983333333335, 1095.0916666666683, 1111.5250000000017, 1049.225000000002, 1085.4166666666688, 1076.8416666666687, 1085.0416666666688, 1111.183333333335, 1095.6000000000024, 1096.125000000002, 1114.733333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1043.1166666666688, 960.7916666666687, 1033.9000000000017, 1096.4250000000022, 1060.7500000000025, 1060.7250000000015, 1051.2500000000023, 1054.8916666666692, 1007.6416666666686, 1021.5333333333357, 1090.6166666666684, 1065.0500000000022, 1071.7333333333356, 1093.300000000002, 1059.8583333333354, 1082.7500000000016, 1021.5583333333358, 1038.0250000000017, 1049.675000000002, 1074.3000000000018, 1059.916666666669, 1073.6083333333358, 1015.9250000000021, 1067.2916666666688, 1044.091666666669, 1086.7000000000023, 1076.166666666669, 1108.4833333333358, 1088.5833333333358, 1082.2583333333355, 1094.5833333333353, 1098.2166666666685, 1108.6583333333351, 1069.1833333333352, 1052.7416666666684, 1056.4583333333358, 1074.358333333335, 1045.3333333333348, 1081.8250000000019, 1072.8500000000022, 1077.1750000000025, 1094.191666666669, 1039.9833333333354, 1077.4000000000026, 1076.5250000000024, 1099.3250000000023, 1115.0666666666684, 1042.5750000000023, 1110.0916666666687, 1100.9166666666688, 1089.3583333333354, 1089.041666666668, 1089.7916666666686, 1031.4166666666686, 1092.625000000002, 1077.000000000002, 1107.3083333333354, 1096.1416666666685, 1098.283333333335, 1095.4666666666692, 1103.8833333333357, 1104.325000000002, 1057.4166666666683, 1086.5333333333356, 1083.6333333333353, 1092.4500000000028, 1091.4666666666687, 1066.5416666666688, 1062.6500000000021, 1076.0916666666685, 1105.7416666666686, 1083.6583333333356, 1129.7583333333357, 1089.5583333333357, 1084.4750000000015, 1074.650000000002, 1072.7916666666688, 1101.525000000002, 1106.616666666669, 1086.9500000000023, 1116.7833333333356, 1091.5833333333355, 1070.650000000002, 1086.075000000002, 1115.0000000000025, 1098.641666666669, 1102.4500000000016, 1050.425000000002, 1093.1083333333352, 1104.983333333335, 1095.0916666666683, 1111.5250000000017, 1049.225000000002, 1085.4166666666688, 1076.8416666666687, 1085.0416666666688, 1111.183333333335, 1095.6000000000024, 1096.125000000002, 1114.733333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2408831130550605, "mean_inference_ms": 2.043107502511916, "mean_action_processing_ms": 0.09065217252440583, "mean_env_wait_ms": 1.530444307813582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006411314010620117, "StateBufferConnector_ms": 0.0032362937927246094, "ViewRequirementAgentConnector_ms": 0.08437442779541016}, "num_episodes": 24, "episode_return_max": 1129.7583333333357, "episode_return_min": 960.7916666666687, "episode_return_mean": 1078.0600833333356, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149550, "num_agent_steps_trained": 149400, "num_env_steps_sampled": 149550, "num_env_steps_trained": 149400, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 244.91815013605577, "num_env_steps_trained_throughput_per_sec": 259.32510014405904, "timesteps_total": 149550, "num_env_steps_sampled_lifetime": 149550, "num_agent_steps_sampled_lifetime": 149550, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 149550, "timers": {"training_iteration_time_ms": 10343.704, "restore_workers_time_ms": 0.013, "training_step_time_ms": 621.717, "sample_time_ms": 606.574, "synch_weights_time_ms": 13.794}, "counters": {"num_env_steps_sampled": 149550, "num_env_steps_trained": 149400, "num_agent_steps_sampled": 149550, "num_agent_steps_trained": 149400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 997, "num_samples_added_to_queue": 149400}, "done": false, "training_iteration": 59, "trial_id": "27800_00000", "date": "2024-10-12_15-38-00", "timestamp": 1728743880, "time_this_iter_s": 10.423628568649292, "time_total_s": 609.1514675617218, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c2d40>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 609.1514675617218, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 16.420000000000005, "ram_util_percent": 38.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 247808.765625, "policy_loss": 230349.640625, "entropy": 11.432686805725098, "entropy_coeff": 0.01, "var_gnorm": 16.65831184387207, "vf_loss": 1749341.625, "vf_explained_var": 0.20508551597595215}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 506.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 152100, "num_env_steps_trained": 151800, "num_agent_steps_sampled": 152100, "num_agent_steps_trained": 151800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1014, "num_samples_added_to_queue": 152100, "learner_queue": {"size_count": 506, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.681, "learner_load_time_ms": 0.378, "learner_load_wait_time_ms": 1173.987, "learner_dequeue_time_ms": 9817.895}}, "env_runners": {"episode_reward_max": 1129.7583333333357, "episode_reward_min": 1031.4166666666686, "episode_reward_mean": 1089.1844166666688, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1031.4166666666686}, "policy_reward_max": {"default_policy": 1129.7583333333357}, "policy_reward_mean": {"default_policy": 1089.1844166666688}, "custom_metrics": {"num_consolidated_mean": 2.7902000000000005, "num_consolidated_min": 2.68, "num_consolidated_max": 2.89, "num_overloaded_mean": 0.0114, "num_overloaded_min": 0.0, "num_overloaded_max": 0.06, "num_moves_mean": 3.2670000000000003, "num_moves_min": 2.76, "num_moves_max": 4.19, "mean_accuracy_mean": 42.235250000000015, "mean_accuracy_min": 42.05633333333334, "mean_accuracy_max": 42.46166666666668, "num_model_switches_mean": 2.1612, "num_model_switches_min": 1.89, "num_model_switches_max": 2.49, "num_slav_mean": 0.08429333333333332, "num_slav_min": 0.06588333333333334, "num_slav_max": 0.10166666666666668, "cpu_conserved_cost_mean": 7.1930000000000005, "cpu_conserved_cost_min": 6.76, "cpu_conserved_cost_max": 7.58, "mean_cluster_cpu_util_mean": 0.505394748242162, "mean_cluster_cpu_util_min": 0.4964811984002745, "mean_cluster_cpu_util_max": 0.5143872535728338, "mean_cluster_mem_util_mean": 0.326174191950831, "mean_cluster_mem_util_min": 0.32107792452424005, "mean_cluster_mem_util_max": 0.3308848434943598, "reward_consolidation_mean_mean": 5.742916666666665, "reward_consolidation_mean_min": 5.416666666666665, "reward_consolidation_mean_max": 5.979166666666666, "reward_illegal_mean_mean": -0.019, "reward_illegal_mean_min": -0.09999999999999998, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.414500000000017, "reward_accuracy_mean_min": 6.125000000000018, "reward_accuracy_mean_max": 6.716666666666689, "reward_sla_mean_mean": -1.2465725, "reward_sla_mean_min": -1.49975, "reward_sla_mean_max": -0.9762499999999998, "reward_consolidation_sum_mean": 574.2916666666666, "reward_consolidation_sum_min": 541.6666666666665, "reward_consolidation_sum_max": 597.9166666666666, "reward_illegal_sum_mean": -1.8999999999999997, "reward_illegal_sum_min": -9.999999999999998, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 641.450000000002, "reward_accuracy_sum_min": 612.5000000000018, "reward_accuracy_sum_max": 671.6666666666689, "reward_sla_sum_mean": -124.65724999999999, "reward_sla_sum_min": -149.975, "reward_sla_sum_max": -97.62499999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2282.0, "global_timestep_min": 600, "global_timestep_max": 3900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1108.4833333333358, 1088.5833333333358, 1082.2583333333355, 1094.5833333333353, 1098.2166666666685, 1108.6583333333351, 1069.1833333333352, 1052.7416666666684, 1056.4583333333358, 1074.358333333335, 1045.3333333333348, 1081.8250000000019, 1072.8500000000022, 1077.1750000000025, 1094.191666666669, 1039.9833333333354, 1077.4000000000026, 1076.5250000000024, 1099.3250000000023, 1115.0666666666684, 1042.5750000000023, 1110.0916666666687, 1100.9166666666688, 1089.3583333333354, 1089.041666666668, 1089.7916666666686, 1031.4166666666686, 1092.625000000002, 1077.000000000002, 1107.3083333333354, 1096.1416666666685, 1098.283333333335, 1095.4666666666692, 1103.8833333333357, 1104.325000000002, 1057.4166666666683, 1086.5333333333356, 1083.6333333333353, 1092.4500000000028, 1091.4666666666687, 1066.5416666666688, 1062.6500000000021, 1076.0916666666685, 1105.7416666666686, 1083.6583333333356, 1129.7583333333357, 1089.5583333333357, 1084.4750000000015, 1074.650000000002, 1072.7916666666688, 1101.525000000002, 1106.616666666669, 1086.9500000000023, 1116.7833333333356, 1091.5833333333355, 1070.650000000002, 1086.075000000002, 1115.0000000000025, 1098.641666666669, 1102.4500000000016, 1050.425000000002, 1093.1083333333352, 1104.983333333335, 1095.0916666666683, 1111.5250000000017, 1049.225000000002, 1085.4166666666688, 1076.8416666666687, 1085.0416666666688, 1111.183333333335, 1095.6000000000024, 1096.125000000002, 1114.733333333336, 1121.758333333336, 1098.3000000000022, 1079.6583333333353, 1114.7500000000016, 1103.5666666666687, 1091.8000000000025, 1080.7166666666683, 1117.6333333333353, 1100.6583333333353, 1069.1083333333354, 1112.8166666666682, 1090.9583333333358, 1102.1083333333352, 1121.2666666666692, 1088.758333333336, 1084.4500000000023, 1099.725000000002, 1101.8583333333354, 1090.4333333333354, 1090.6500000000017, 1093.375000000002, 1073.7500000000016, 1081.6416666666685, 1105.4333333333352, 1052.991666666669, 1109.125000000002, 1096.7333333333354], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1108.4833333333358, 1088.5833333333358, 1082.2583333333355, 1094.5833333333353, 1098.2166666666685, 1108.6583333333351, 1069.1833333333352, 1052.7416666666684, 1056.4583333333358, 1074.358333333335, 1045.3333333333348, 1081.8250000000019, 1072.8500000000022, 1077.1750000000025, 1094.191666666669, 1039.9833333333354, 1077.4000000000026, 1076.5250000000024, 1099.3250000000023, 1115.0666666666684, 1042.5750000000023, 1110.0916666666687, 1100.9166666666688, 1089.3583333333354, 1089.041666666668, 1089.7916666666686, 1031.4166666666686, 1092.625000000002, 1077.000000000002, 1107.3083333333354, 1096.1416666666685, 1098.283333333335, 1095.4666666666692, 1103.8833333333357, 1104.325000000002, 1057.4166666666683, 1086.5333333333356, 1083.6333333333353, 1092.4500000000028, 1091.4666666666687, 1066.5416666666688, 1062.6500000000021, 1076.0916666666685, 1105.7416666666686, 1083.6583333333356, 1129.7583333333357, 1089.5583333333357, 1084.4750000000015, 1074.650000000002, 1072.7916666666688, 1101.525000000002, 1106.616666666669, 1086.9500000000023, 1116.7833333333356, 1091.5833333333355, 1070.650000000002, 1086.075000000002, 1115.0000000000025, 1098.641666666669, 1102.4500000000016, 1050.425000000002, 1093.1083333333352, 1104.983333333335, 1095.0916666666683, 1111.5250000000017, 1049.225000000002, 1085.4166666666688, 1076.8416666666687, 1085.0416666666688, 1111.183333333335, 1095.6000000000024, 1096.125000000002, 1114.733333333336, 1121.758333333336, 1098.3000000000022, 1079.6583333333353, 1114.7500000000016, 1103.5666666666687, 1091.8000000000025, 1080.7166666666683, 1117.6333333333353, 1100.6583333333353, 1069.1083333333354, 1112.8166666666682, 1090.9583333333358, 1102.1083333333352, 1121.2666666666692, 1088.758333333336, 1084.4500000000023, 1099.725000000002, 1101.8583333333354, 1090.4333333333354, 1090.6500000000017, 1093.375000000002, 1073.7500000000016, 1081.6416666666685, 1105.4333333333352, 1052.991666666669, 1109.125000000002, 1096.7333333333354]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24091209146748654, "mean_inference_ms": 2.0432323391428, "mean_action_processing_ms": 0.09066263367736474, "mean_env_wait_ms": 1.5304930348523818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006793975830078125, "StateBufferConnector_ms": 0.0032575130462646484, "ViewRequirementAgentConnector_ms": 0.08487820625305176}, "num_episodes": 27, "episode_return_max": 1129.7583333333357, "episode_return_min": 1031.4166666666686, "episode_return_mean": 1089.1844166666688, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152100, "num_agent_steps_trained": 151800, "num_env_steps_sampled": 152100, "num_env_steps_trained": 151800, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 243.41898281467783, "num_env_steps_trained_throughput_per_sec": 229.1002191196968, "timesteps_total": 152100, "num_env_steps_sampled_lifetime": 152100, "num_agent_steps_sampled_lifetime": 152100, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 152100, "timers": {"training_iteration_time_ms": 10388.553, "restore_workers_time_ms": 0.015, "training_step_time_ms": 607.974, "sample_time_ms": 592.849, "synch_weights_time_ms": 13.552}, "counters": {"num_env_steps_sampled": 152100, "num_env_steps_trained": 151800, "num_agent_steps_sampled": 152100, "num_agent_steps_trained": 151800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1014, "num_samples_added_to_queue": 152100}, "done": false, "training_iteration": 60, "trial_id": "27800_00000", "date": "2024-10-12_15-38-10", "timestamp": 1728743890, "time_this_iter_s": 10.486007452011108, "time_total_s": 619.6374750137329, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c23e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 619.6374750137329, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 16.40666666666667, "ram_util_percent": 38.27333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 240790.515625, "policy_loss": 223063.421875, "entropy": 11.244312286376953, "entropy_coeff": 0.01, "var_gnorm": 16.6754150390625, "vf_loss": 1776083.375, "vf_explained_var": 0.2150166630744934}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 514.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 154500, "num_env_steps_trained": 154200, "num_agent_steps_sampled": 154500, "num_agent_steps_trained": 154200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1030, "num_samples_added_to_queue": 154500, "learner_queue": {"size_count": 514, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 64.076, "learner_load_time_ms": 0.409, "learner_load_wait_time_ms": 1188.877, "learner_dequeue_time_ms": 9823.99}}, "env_runners": {"episode_reward_max": 1129.7583333333357, "episode_reward_min": 1031.4166666666686, "episode_reward_mean": 1093.793666666669, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1031.4166666666686}, "policy_reward_max": {"default_policy": 1129.7583333333357}, "policy_reward_mean": {"default_policy": 1093.793666666669}, "custom_metrics": {"num_consolidated_mean": 2.8021999999999996, "num_consolidated_min": 2.71, "num_consolidated_max": 2.89, "num_overloaded_mean": 0.0097, "num_overloaded_min": 0.0, "num_overloaded_max": 0.06, "num_moves_mean": 3.149600000000001, "num_moves_min": 2.7, "num_moves_max": 3.6, "mean_accuracy_mean": 42.19408333333334, "mean_accuracy_min": 42.02466666666668, "mean_accuracy_max": 42.39833333333335, "num_model_switches_mean": 2.1841000000000004, "num_model_switches_min": 1.89, "num_model_switches_max": 2.65, "num_slav_mean": 0.08079916666666667, "num_slav_min": 0.06588333333333334, "num_slav_max": 0.09519999999999999, "cpu_conserved_cost_mean": 7.236400000000001, "cpu_conserved_cost_min": 6.84, "cpu_conserved_cost_max": 7.58, "mean_cluster_cpu_util_mean": 0.5050669412723497, "mean_cluster_cpu_util_min": 0.49484048653245083, "mean_cluster_cpu_util_max": 0.5124729934693735, "mean_cluster_mem_util_mean": 0.3264679160908034, "mean_cluster_mem_util_min": 0.32055208333333335, "mean_cluster_mem_util_max": 0.3308848434943598, "reward_consolidation_mean_mean": 5.777708333333333, "reward_consolidation_mean_min": 5.499999999999999, "reward_consolidation_mean_max": 6.020833333333332, "reward_illegal_mean_mean": -0.016166666666666666, "reward_illegal_mean_min": -0.09999999999999998, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.372250000000016, "reward_accuracy_mean_min": 6.091666666666684, "reward_accuracy_mean_max": 6.650000000000021, "reward_sla_mean_mean": -1.1958550000000003, "reward_sla_mean_min": -1.3984999999999999, "reward_sla_mean_max": -0.9762499999999998, "reward_consolidation_sum_mean": 577.7708333333333, "reward_consolidation_sum_min": 549.9999999999999, "reward_consolidation_sum_max": 602.0833333333333, "reward_illegal_sum_mean": -1.6166666666666665, "reward_illegal_sum_min": -9.999999999999998, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 637.2250000000017, "reward_accuracy_sum_min": 609.1666666666683, "reward_accuracy_sum_max": 665.000000000002, "reward_sla_sum_mean": -119.58549999999997, "reward_sla_sum_min": -139.85, "reward_sla_sum_max": -97.62499999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3082.0, "global_timestep_min": 1400, "global_timestep_max": 4700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1089.041666666668, 1089.7916666666686, 1031.4166666666686, 1092.625000000002, 1077.000000000002, 1107.3083333333354, 1096.1416666666685, 1098.283333333335, 1095.4666666666692, 1103.8833333333357, 1104.325000000002, 1057.4166666666683, 1086.5333333333356, 1083.6333333333353, 1092.4500000000028, 1091.4666666666687, 1066.5416666666688, 1062.6500000000021, 1076.0916666666685, 1105.7416666666686, 1083.6583333333356, 1129.7583333333357, 1089.5583333333357, 1084.4750000000015, 1074.650000000002, 1072.7916666666688, 1101.525000000002, 1106.616666666669, 1086.9500000000023, 1116.7833333333356, 1091.5833333333355, 1070.650000000002, 1086.075000000002, 1115.0000000000025, 1098.641666666669, 1102.4500000000016, 1050.425000000002, 1093.1083333333352, 1104.983333333335, 1095.0916666666683, 1111.5250000000017, 1049.225000000002, 1085.4166666666688, 1076.8416666666687, 1085.0416666666688, 1111.183333333335, 1095.6000000000024, 1096.125000000002, 1114.733333333336, 1121.758333333336, 1098.3000000000022, 1079.6583333333353, 1114.7500000000016, 1103.5666666666687, 1091.8000000000025, 1080.7166666666683, 1117.6333333333353, 1100.6583333333353, 1069.1083333333354, 1112.8166666666682, 1090.9583333333358, 1102.1083333333352, 1121.2666666666692, 1088.758333333336, 1084.4500000000023, 1099.725000000002, 1101.8583333333354, 1090.4333333333354, 1090.6500000000017, 1093.375000000002, 1073.7500000000016, 1081.6416666666685, 1105.4333333333352, 1052.991666666669, 1109.125000000002, 1096.7333333333354, 1081.1416666666692, 1096.1916666666689, 1111.041666666669, 1107.6750000000025, 1089.5666666666689, 1117.441666666669, 1113.3250000000019, 1067.2416666666686, 1102.1916666666689, 1121.7250000000017, 1105.5916666666687, 1125.0166666666692, 1110.983333333335, 1101.6750000000022, 1100.900000000002, 1097.5916666666692, 1067.3166666666689, 1092.625000000002, 1115.033333333335, 1097.7333333333354, 1096.7833333333356, 1078.408333333335, 1103.4833333333352, 1116.383333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1089.041666666668, 1089.7916666666686, 1031.4166666666686, 1092.625000000002, 1077.000000000002, 1107.3083333333354, 1096.1416666666685, 1098.283333333335, 1095.4666666666692, 1103.8833333333357, 1104.325000000002, 1057.4166666666683, 1086.5333333333356, 1083.6333333333353, 1092.4500000000028, 1091.4666666666687, 1066.5416666666688, 1062.6500000000021, 1076.0916666666685, 1105.7416666666686, 1083.6583333333356, 1129.7583333333357, 1089.5583333333357, 1084.4750000000015, 1074.650000000002, 1072.7916666666688, 1101.525000000002, 1106.616666666669, 1086.9500000000023, 1116.7833333333356, 1091.5833333333355, 1070.650000000002, 1086.075000000002, 1115.0000000000025, 1098.641666666669, 1102.4500000000016, 1050.425000000002, 1093.1083333333352, 1104.983333333335, 1095.0916666666683, 1111.5250000000017, 1049.225000000002, 1085.4166666666688, 1076.8416666666687, 1085.0416666666688, 1111.183333333335, 1095.6000000000024, 1096.125000000002, 1114.733333333336, 1121.758333333336, 1098.3000000000022, 1079.6583333333353, 1114.7500000000016, 1103.5666666666687, 1091.8000000000025, 1080.7166666666683, 1117.6333333333353, 1100.6583333333353, 1069.1083333333354, 1112.8166666666682, 1090.9583333333358, 1102.1083333333352, 1121.2666666666692, 1088.758333333336, 1084.4500000000023, 1099.725000000002, 1101.8583333333354, 1090.4333333333354, 1090.6500000000017, 1093.375000000002, 1073.7500000000016, 1081.6416666666685, 1105.4333333333352, 1052.991666666669, 1109.125000000002, 1096.7333333333354, 1081.1416666666692, 1096.1916666666689, 1111.041666666669, 1107.6750000000025, 1089.5666666666689, 1117.441666666669, 1113.3250000000019, 1067.2416666666686, 1102.1916666666689, 1121.7250000000017, 1105.5916666666687, 1125.0166666666692, 1110.983333333335, 1101.6750000000022, 1100.900000000002, 1097.5916666666692, 1067.3166666666689, 1092.625000000002, 1115.033333333335, 1097.7333333333354, 1096.7833333333356, 1078.408333333335, 1103.4833333333352, 1116.383333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2409355269460024, "mean_inference_ms": 2.0436741846295536, "mean_action_processing_ms": 0.09067707778806533, "mean_env_wait_ms": 1.530639828028826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006928920745849609, "StateBufferConnector_ms": 0.0032825469970703125, "ViewRequirementAgentConnector_ms": 0.08491683006286621}, "num_episodes": 24, "episode_return_max": 1129.7583333333357, "episode_return_min": 1031.4166666666686, "episode_return_mean": 1093.793666666669, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 154500, "num_agent_steps_trained": 154200, "num_env_steps_sampled": 154500, "num_env_steps_trained": 154200, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 237.99276110534063, "num_env_steps_trained_throughput_per_sec": 237.99276110534063, "timesteps_total": 154500, "num_env_steps_sampled_lifetime": 154500, "num_agent_steps_sampled_lifetime": 154500, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 154500, "timers": {"training_iteration_time_ms": 10357.992, "restore_workers_time_ms": 0.014, "training_step_time_ms": 642.91, "sample_time_ms": 627.353, "synch_weights_time_ms": 14.013}, "counters": {"num_env_steps_sampled": 154500, "num_env_steps_trained": 154200, "num_agent_steps_sampled": 154500, "num_agent_steps_trained": 154200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1030, "num_samples_added_to_queue": 154500}, "done": false, "training_iteration": 61, "trial_id": "27800_00000", "date": "2024-10-12_15-38-21", "timestamp": 1728743901, "time_this_iter_s": 10.096294641494751, "time_total_s": 629.7337696552277, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b47010>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 629.7337696552277, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 16.285714285714285, "ram_util_percent": 38.471428571428575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 227800.71875, "policy_loss": 210503.53125, "entropy": 11.123355865478516, "entropy_coeff": 0.01, "var_gnorm": 16.693269729614258, "vf_loss": 1733056.75, "vf_explained_var": 0.22483211755752563}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 523.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 157050, "num_env_steps_trained": 156900, "num_agent_steps_sampled": 157050, "num_agent_steps_trained": 156900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1047, "num_samples_added_to_queue": 156900, "learner_queue": {"size_count": 523, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.381, "learner_load_time_ms": 0.408, "learner_load_wait_time_ms": 1201.806, "learner_dequeue_time_ms": 9849.509}}, "env_runners": {"episode_reward_max": 1131.5166666666685, "episode_reward_min": 1049.225000000002, "episode_reward_mean": 1097.9330833333356, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1049.225000000002}, "policy_reward_max": {"default_policy": 1131.5166666666685}, "policy_reward_mean": {"default_policy": 1097.9330833333356}, "custom_metrics": {"num_consolidated_mean": 2.8124000000000002, "num_consolidated_min": 2.71, "num_consolidated_max": 2.91, "num_overloaded_mean": 0.0079, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 3.0793999999999992, "num_moves_min": 2.7, "num_moves_max": 3.51, "mean_accuracy_mean": 42.17863000000001, "mean_accuracy_min": 42.02466666666668, "mean_accuracy_max": 42.360333333333344, "num_model_switches_mean": 2.2367, "num_model_switches_min": 1.91, "num_model_switches_max": 2.65, "num_slav_mean": 0.07968000000000001, "num_slav_min": 0.06588333333333334, "num_slav_max": 0.09291666666666665, "cpu_conserved_cost_mean": 7.274400000000001, "cpu_conserved_cost_min": 6.84, "cpu_conserved_cost_max": 7.64, "mean_cluster_cpu_util_mean": 0.505188639438248, "mean_cluster_cpu_util_min": 0.49484048653245083, "mean_cluster_cpu_util_max": 0.5132450042517006, "mean_cluster_mem_util_mean": 0.3268245822892448, "mean_cluster_mem_util_min": 0.32055208333333335, "mean_cluster_mem_util_max": 0.33129549050632917, "reward_consolidation_mean_mean": 5.809166666666666, "reward_consolidation_mean_min": 5.499999999999999, "reward_consolidation_mean_max": 6.020833333333332, "reward_illegal_mean_mean": -0.013166666666666669, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.364583333333351, "reward_accuracy_mean_min": 6.091666666666684, "reward_accuracy_mean_max": 6.658333333333352, "reward_sla_mean_mean": -1.1812525, "reward_sla_mean_min": -1.3815, "reward_sla_mean_max": -0.9762499999999998, "reward_consolidation_sum_mean": 580.9166666666665, "reward_consolidation_sum_min": 549.9999999999999, "reward_consolidation_sum_max": 602.0833333333333, "reward_illegal_sum_mean": -1.3166666666666667, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 636.4583333333352, "reward_accuracy_sum_min": 609.1666666666683, "reward_accuracy_sum_max": 665.8333333333352, "reward_sla_sum_mean": -118.12525, "reward_sla_sum_min": -138.15, "reward_sla_sum_max": -97.62499999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3883.0, "global_timestep_min": 2200, "global_timestep_max": 5500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1074.650000000002, 1072.7916666666688, 1101.525000000002, 1106.616666666669, 1086.9500000000023, 1116.7833333333356, 1091.5833333333355, 1070.650000000002, 1086.075000000002, 1115.0000000000025, 1098.641666666669, 1102.4500000000016, 1050.425000000002, 1093.1083333333352, 1104.983333333335, 1095.0916666666683, 1111.5250000000017, 1049.225000000002, 1085.4166666666688, 1076.8416666666687, 1085.0416666666688, 1111.183333333335, 1095.6000000000024, 1096.125000000002, 1114.733333333336, 1121.758333333336, 1098.3000000000022, 1079.6583333333353, 1114.7500000000016, 1103.5666666666687, 1091.8000000000025, 1080.7166666666683, 1117.6333333333353, 1100.6583333333353, 1069.1083333333354, 1112.8166666666682, 1090.9583333333358, 1102.1083333333352, 1121.2666666666692, 1088.758333333336, 1084.4500000000023, 1099.725000000002, 1101.8583333333354, 1090.4333333333354, 1090.6500000000017, 1093.375000000002, 1073.7500000000016, 1081.6416666666685, 1105.4333333333352, 1052.991666666669, 1109.125000000002, 1096.7333333333354, 1081.1416666666692, 1096.1916666666689, 1111.041666666669, 1107.6750000000025, 1089.5666666666689, 1117.441666666669, 1113.3250000000019, 1067.2416666666686, 1102.1916666666689, 1121.7250000000017, 1105.5916666666687, 1125.0166666666692, 1110.983333333335, 1101.6750000000022, 1100.900000000002, 1097.5916666666692, 1067.3166666666689, 1092.625000000002, 1115.033333333335, 1097.7333333333354, 1096.7833333333356, 1078.408333333335, 1103.4833333333352, 1116.383333333336, 1084.925000000002, 1094.3833333333362, 1105.0666666666684, 1123.2833333333358, 1076.6583333333353, 1115.3250000000023, 1086.3333333333358, 1080.9083333333351, 1131.5166666666685, 1115.1833333333354, 1117.1500000000017, 1117.391666666669, 1104.3833333333353, 1111.8000000000022, 1105.600000000002, 1115.300000000002, 1103.1666666666688, 1114.6833333333352, 1091.1916666666687, 1089.7583333333355, 1106.4000000000021, 1106.2916666666686, 1084.4333333333361, 1128.0666666666687], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1074.650000000002, 1072.7916666666688, 1101.525000000002, 1106.616666666669, 1086.9500000000023, 1116.7833333333356, 1091.5833333333355, 1070.650000000002, 1086.075000000002, 1115.0000000000025, 1098.641666666669, 1102.4500000000016, 1050.425000000002, 1093.1083333333352, 1104.983333333335, 1095.0916666666683, 1111.5250000000017, 1049.225000000002, 1085.4166666666688, 1076.8416666666687, 1085.0416666666688, 1111.183333333335, 1095.6000000000024, 1096.125000000002, 1114.733333333336, 1121.758333333336, 1098.3000000000022, 1079.6583333333353, 1114.7500000000016, 1103.5666666666687, 1091.8000000000025, 1080.7166666666683, 1117.6333333333353, 1100.6583333333353, 1069.1083333333354, 1112.8166666666682, 1090.9583333333358, 1102.1083333333352, 1121.2666666666692, 1088.758333333336, 1084.4500000000023, 1099.725000000002, 1101.8583333333354, 1090.4333333333354, 1090.6500000000017, 1093.375000000002, 1073.7500000000016, 1081.6416666666685, 1105.4333333333352, 1052.991666666669, 1109.125000000002, 1096.7333333333354, 1081.1416666666692, 1096.1916666666689, 1111.041666666669, 1107.6750000000025, 1089.5666666666689, 1117.441666666669, 1113.3250000000019, 1067.2416666666686, 1102.1916666666689, 1121.7250000000017, 1105.5916666666687, 1125.0166666666692, 1110.983333333335, 1101.6750000000022, 1100.900000000002, 1097.5916666666692, 1067.3166666666689, 1092.625000000002, 1115.033333333335, 1097.7333333333354, 1096.7833333333356, 1078.408333333335, 1103.4833333333352, 1116.383333333336, 1084.925000000002, 1094.3833333333362, 1105.0666666666684, 1123.2833333333358, 1076.6583333333353, 1115.3250000000023, 1086.3333333333358, 1080.9083333333351, 1131.5166666666685, 1115.1833333333354, 1117.1500000000017, 1117.391666666669, 1104.3833333333353, 1111.8000000000022, 1105.600000000002, 1115.300000000002, 1103.1666666666688, 1114.6833333333352, 1091.1916666666687, 1089.7583333333355, 1106.4000000000021, 1106.2916666666686, 1084.4333333333361, 1128.0666666666687]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24098547695064895, "mean_inference_ms": 2.045859756624546, "mean_action_processing_ms": 0.09071092265897178, "mean_env_wait_ms": 1.531199898491301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006907224655151367, "StateBufferConnector_ms": 0.003291606903076172, "ViewRequirementAgentConnector_ms": 0.08476924896240234}, "num_episodes": 24, "episode_return_max": 1131.5166666666685, "episode_return_min": 1049.225000000002, "episode_return_mean": 1097.9330833333356, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 157050, "num_agent_steps_trained": 156900, "num_env_steps_sampled": 157050, "num_env_steps_trained": 156900, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 241.577522611171, "num_env_steps_trained_throughput_per_sec": 255.78796511771046, "timesteps_total": 157050, "num_env_steps_sampled_lifetime": 157050, "num_agent_steps_sampled_lifetime": 157050, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 157050, "timers": {"training_iteration_time_ms": 10359.622, "restore_workers_time_ms": 0.013, "training_step_time_ms": 615.955, "sample_time_ms": 599.463, "synch_weights_time_ms": 14.883}, "counters": {"num_env_steps_sampled": 157050, "num_env_steps_trained": 156900, "num_agent_steps_sampled": 157050, "num_agent_steps_trained": 156900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1047, "num_samples_added_to_queue": 156900}, "done": false, "training_iteration": 62, "trial_id": "27800_00000", "date": "2024-10-12_15-38-31", "timestamp": 1728743911, "time_this_iter_s": 10.577510356903076, "time_total_s": 640.3112800121307, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f33d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 640.3112800121307, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 16.56666666666667, "ram_util_percent": 38.573333333333345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 199581.546875, "policy_loss": 183497.625, "entropy": 10.51967716217041, "entropy_coeff": 0.01, "var_gnorm": 16.717939376831055, "vf_loss": 1611547.875, "vf_explained_var": 0.23965448141098022}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 531.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 159600, "num_env_steps_trained": 159300, "num_agent_steps_sampled": 159600, "num_agent_steps_trained": 159300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1064, "num_samples_added_to_queue": 159600, "learner_queue": {"size_count": 531, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.087, "learner_load_time_ms": 0.419, "learner_load_wait_time_ms": 1156.942, "learner_dequeue_time_ms": 9861.558}}, "env_runners": {"episode_reward_max": 1135.475000000002, "episode_reward_min": 1052.991666666669, "episode_reward_mean": 1103.9780000000019, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1052.991666666669}, "policy_reward_max": {"default_policy": 1135.475000000002}, "policy_reward_mean": {"default_policy": 1103.9780000000019}, "custom_metrics": {"num_consolidated_mean": 2.8265, "num_consolidated_min": 2.71, "num_consolidated_max": 2.92, "num_overloaded_mean": 0.0063, "num_overloaded_min": 0.0, "num_overloaded_max": 0.03, "num_moves_mean": 2.9424999999999994, "num_moves_min": 2.32, "num_moves_max": 3.37, "mean_accuracy_mean": 42.18996666666667, "mean_accuracy_min": 42.02466666666668, "mean_accuracy_max": 42.360333333333344, "num_model_switches_mean": 2.2323000000000004, "num_model_switches_min": 1.93, "num_model_switches_max": 2.65, "num_slav_mean": 0.08007783333333335, "num_slav_min": 0.06656666666666666, "num_slav_max": 0.09793333333333333, "cpu_conserved_cost_mean": 7.327000000000001, "cpu_conserved_cost_min": 6.84, "cpu_conserved_cost_max": 7.68, "mean_cluster_cpu_util_mean": 0.5059255202987896, "mean_cluster_cpu_util_min": 0.49484048653245083, "mean_cluster_cpu_util_max": 0.5156542758557702, "mean_cluster_mem_util_mean": 0.32742461538254547, "mean_cluster_mem_util_min": 0.32055208333333335, "mean_cluster_mem_util_max": 0.33221270612675446, "reward_consolidation_mean_mean": 5.848958333333332, "reward_consolidation_mean_min": 5.499999999999999, "reward_consolidation_mean_max": 6.0625, "reward_illegal_mean_mean": -0.0105, "reward_illegal_mean_min": -0.05, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.390666666666684, "reward_accuracy_mean_min": 6.091666666666684, "reward_accuracy_mean_max": 6.658333333333352, "reward_sla_mean_mean": -1.1893449999999999, "reward_sla_mean_min": -1.4689999999999999, "reward_sla_mean_max": -0.9984999999999999, "reward_consolidation_sum_mean": 584.8958333333333, "reward_consolidation_sum_min": 549.9999999999999, "reward_consolidation_sum_max": 606.25, "reward_illegal_sum_mean": -1.0499999999999998, "reward_illegal_sum_min": -5.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 639.0666666666684, "reward_accuracy_sum_min": 609.1666666666683, "reward_accuracy_sum_max": 665.8333333333352, "reward_sla_sum_mean": -118.93450000000003, "reward_sla_sum_min": -146.89999999999998, "reward_sla_sum_max": -99.85, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4782.0, "global_timestep_min": 3100, "global_timestep_max": 6400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1079.6583333333353, 1114.7500000000016, 1103.5666666666687, 1091.8000000000025, 1080.7166666666683, 1117.6333333333353, 1100.6583333333353, 1069.1083333333354, 1112.8166666666682, 1090.9583333333358, 1102.1083333333352, 1121.2666666666692, 1088.758333333336, 1084.4500000000023, 1099.725000000002, 1101.8583333333354, 1090.4333333333354, 1090.6500000000017, 1093.375000000002, 1073.7500000000016, 1081.6416666666685, 1105.4333333333352, 1052.991666666669, 1109.125000000002, 1096.7333333333354, 1081.1416666666692, 1096.1916666666689, 1111.041666666669, 1107.6750000000025, 1089.5666666666689, 1117.441666666669, 1113.3250000000019, 1067.2416666666686, 1102.1916666666689, 1121.7250000000017, 1105.5916666666687, 1125.0166666666692, 1110.983333333335, 1101.6750000000022, 1100.900000000002, 1097.5916666666692, 1067.3166666666689, 1092.625000000002, 1115.033333333335, 1097.7333333333354, 1096.7833333333356, 1078.408333333335, 1103.4833333333352, 1116.383333333336, 1084.925000000002, 1094.3833333333362, 1105.0666666666684, 1123.2833333333358, 1076.6583333333353, 1115.3250000000023, 1086.3333333333358, 1080.9083333333351, 1131.5166666666685, 1115.1833333333354, 1117.1500000000017, 1117.391666666669, 1104.3833333333353, 1111.8000000000022, 1105.600000000002, 1115.300000000002, 1103.1666666666688, 1114.6833333333352, 1091.1916666666687, 1089.7583333333355, 1106.4000000000021, 1106.2916666666686, 1084.4333333333361, 1128.0666666666687, 1103.7416666666693, 1117.6583333333356, 1102.8083333333354, 1127.6750000000025, 1114.5833333333358, 1101.850000000002, 1126.5666666666687, 1116.6666666666697, 1114.858333333335, 1118.9750000000024, 1092.8833333333357, 1135.475000000002, 1125.0583333333357, 1118.5333333333358, 1101.233333333335, 1121.7583333333355, 1132.0750000000023, 1111.0666666666687, 1115.7000000000023, 1126.641666666669, 1103.1750000000025, 1128.6250000000025, 1103.425000000002, 1126.4583333333353, 1129.3000000000022, 1091.6416666666687, 1109.133333333335], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1079.6583333333353, 1114.7500000000016, 1103.5666666666687, 1091.8000000000025, 1080.7166666666683, 1117.6333333333353, 1100.6583333333353, 1069.1083333333354, 1112.8166666666682, 1090.9583333333358, 1102.1083333333352, 1121.2666666666692, 1088.758333333336, 1084.4500000000023, 1099.725000000002, 1101.8583333333354, 1090.4333333333354, 1090.6500000000017, 1093.375000000002, 1073.7500000000016, 1081.6416666666685, 1105.4333333333352, 1052.991666666669, 1109.125000000002, 1096.7333333333354, 1081.1416666666692, 1096.1916666666689, 1111.041666666669, 1107.6750000000025, 1089.5666666666689, 1117.441666666669, 1113.3250000000019, 1067.2416666666686, 1102.1916666666689, 1121.7250000000017, 1105.5916666666687, 1125.0166666666692, 1110.983333333335, 1101.6750000000022, 1100.900000000002, 1097.5916666666692, 1067.3166666666689, 1092.625000000002, 1115.033333333335, 1097.7333333333354, 1096.7833333333356, 1078.408333333335, 1103.4833333333352, 1116.383333333336, 1084.925000000002, 1094.3833333333362, 1105.0666666666684, 1123.2833333333358, 1076.6583333333353, 1115.3250000000023, 1086.3333333333358, 1080.9083333333351, 1131.5166666666685, 1115.1833333333354, 1117.1500000000017, 1117.391666666669, 1104.3833333333353, 1111.8000000000022, 1105.600000000002, 1115.300000000002, 1103.1666666666688, 1114.6833333333352, 1091.1916666666687, 1089.7583333333355, 1106.4000000000021, 1106.2916666666686, 1084.4333333333361, 1128.0666666666687, 1103.7416666666693, 1117.6583333333356, 1102.8083333333354, 1127.6750000000025, 1114.5833333333358, 1101.850000000002, 1126.5666666666687, 1116.6666666666697, 1114.858333333335, 1118.9750000000024, 1092.8833333333357, 1135.475000000002, 1125.0583333333357, 1118.5333333333358, 1101.233333333335, 1121.7583333333355, 1132.0750000000023, 1111.0666666666687, 1115.7000000000023, 1126.641666666669, 1103.1750000000025, 1128.6250000000025, 1103.425000000002, 1126.4583333333353, 1129.3000000000022, 1091.6416666666687, 1109.133333333335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24099476236809128, "mean_inference_ms": 2.0447745318604262, "mean_action_processing_ms": 0.09071001061739135, "mean_env_wait_ms": 1.5310606916853822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00690460205078125, "StateBufferConnector_ms": 0.0033273696899414062, "ViewRequirementAgentConnector_ms": 0.08534836769104004}, "num_episodes": 27, "episode_return_max": 1135.475000000002, "episode_return_min": 1052.991666666669, "episode_return_mean": 1103.9780000000019, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 159600, "num_agent_steps_trained": 159300, "num_env_steps_sampled": 159600, "num_env_steps_trained": 159300, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 248.59483798263665, "num_env_steps_trained_throughput_per_sec": 233.97161221895215, "timesteps_total": 159600, "num_env_steps_sampled_lifetime": 159600, "num_agent_steps_sampled_lifetime": 159600, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 159600, "timers": {"training_iteration_time_ms": 10364.352, "restore_workers_time_ms": 0.013, "training_step_time_ms": 602.074, "sample_time_ms": 586.744, "synch_weights_time_ms": 13.883}, "counters": {"num_env_steps_sampled": 159600, "num_env_steps_trained": 159300, "num_agent_steps_sampled": 159600, "num_agent_steps_trained": 159300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1064, "num_samples_added_to_queue": 159600}, "done": false, "training_iteration": 63, "trial_id": "27800_00000", "date": "2024-10-12_15-38-42", "timestamp": 1728743922, "time_this_iter_s": 10.267881393432617, "time_total_s": 650.5791614055634, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a945ee34f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 650.5791614055634, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 16.62, "ram_util_percent": 38.75333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 179998.46875, "policy_loss": 164854.0, "entropy": 9.83318042755127, "entropy_coeff": 0.01, "var_gnorm": 16.745582580566406, "vf_loss": 1517397.375, "vf_explained_var": 0.26015979051589966}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 540.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 162150, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162150, "num_agent_steps_trained": 162000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1081, "num_samples_added_to_queue": 162000, "learner_queue": {"size_count": 540, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.713, "learner_load_time_ms": 0.44, "learner_load_wait_time_ms": 1163.976, "learner_dequeue_time_ms": 9858.567}}, "env_runners": {"episode_reward_max": 1135.475000000002, "episode_reward_min": 1067.2416666666686, "episode_reward_mean": 1108.5741666666688, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1067.2416666666686}, "policy_reward_max": {"default_policy": 1135.475000000002}, "policy_reward_mean": {"default_policy": 1108.5741666666688}, "custom_metrics": {"num_consolidated_mean": 2.8451999999999997, "num_consolidated_min": 2.71, "num_consolidated_max": 2.94, "num_overloaded_mean": 0.0054, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 2.7719, "num_moves_min": 1.85, "num_moves_max": 3.37, "mean_accuracy_mean": 42.201746666666686, "mean_accuracy_min": 42.02466666666668, "mean_accuracy_max": 42.360333333333344, "num_model_switches_mean": 2.1681, "num_model_switches_min": 1.59, "num_model_switches_max": 2.65, "num_slav_mean": 0.08144183333333332, "num_slav_min": 0.06656666666666666, "num_slav_max": 0.09793333333333333, "cpu_conserved_cost_mean": 7.398399999999999, "cpu_conserved_cost_min": 6.84, "cpu_conserved_cost_max": 7.76, "mean_cluster_cpu_util_mean": 0.5068698245423571, "mean_cluster_cpu_util_min": 0.49484048653245083, "mean_cluster_cpu_util_max": 0.5156542758557702, "mean_cluster_mem_util_mean": 0.32827731822634115, "mean_cluster_mem_util_min": 0.32055208333333335, "mean_cluster_mem_util_max": 0.3334832246189616, "reward_consolidation_mean_mean": 5.893125, "reward_consolidation_mean_min": 5.583333333333332, "reward_consolidation_mean_max": 6.125, "reward_illegal_mean_mean": -0.009000000000000001, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.412416666666684, "reward_accuracy_mean_min": 6.091666666666684, "reward_accuracy_mean_max": 6.658333333333352, "reward_sla_mean_mean": -1.2108, "reward_sla_mean_min": -1.4689999999999999, "reward_sla_mean_max": -0.9984999999999999, "reward_consolidation_sum_mean": 589.3125, "reward_consolidation_sum_min": 558.3333333333333, "reward_consolidation_sum_max": 612.5, "reward_illegal_sum_mean": -0.8999999999999999, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 641.2416666666685, "reward_accuracy_sum_min": 609.1666666666683, "reward_accuracy_sum_max": 665.8333333333352, "reward_sla_sum_mean": -121.08, "reward_sla_sum_min": -146.89999999999998, "reward_sla_sum_max": -99.85, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5583.0, "global_timestep_min": 3900, "global_timestep_max": 7200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1096.7333333333354, 1081.1416666666692, 1096.1916666666689, 1111.041666666669, 1107.6750000000025, 1089.5666666666689, 1117.441666666669, 1113.3250000000019, 1067.2416666666686, 1102.1916666666689, 1121.7250000000017, 1105.5916666666687, 1125.0166666666692, 1110.983333333335, 1101.6750000000022, 1100.900000000002, 1097.5916666666692, 1067.3166666666689, 1092.625000000002, 1115.033333333335, 1097.7333333333354, 1096.7833333333356, 1078.408333333335, 1103.4833333333352, 1116.383333333336, 1084.925000000002, 1094.3833333333362, 1105.0666666666684, 1123.2833333333358, 1076.6583333333353, 1115.3250000000023, 1086.3333333333358, 1080.9083333333351, 1131.5166666666685, 1115.1833333333354, 1117.1500000000017, 1117.391666666669, 1104.3833333333353, 1111.8000000000022, 1105.600000000002, 1115.300000000002, 1103.1666666666688, 1114.6833333333352, 1091.1916666666687, 1089.7583333333355, 1106.4000000000021, 1106.2916666666686, 1084.4333333333361, 1128.0666666666687, 1103.7416666666693, 1117.6583333333356, 1102.8083333333354, 1127.6750000000025, 1114.5833333333358, 1101.850000000002, 1126.5666666666687, 1116.6666666666697, 1114.858333333335, 1118.9750000000024, 1092.8833333333357, 1135.475000000002, 1125.0583333333357, 1118.5333333333358, 1101.233333333335, 1121.7583333333355, 1132.0750000000023, 1111.0666666666687, 1115.7000000000023, 1126.641666666669, 1103.1750000000025, 1128.6250000000025, 1103.425000000002, 1126.4583333333353, 1129.3000000000022, 1091.6416666666687, 1109.133333333335, 1087.7750000000021, 1100.3916666666694, 1118.3083333333354, 1115.9750000000024, 1125.7916666666695, 1105.241666666669, 1131.0333333333353, 1122.8500000000017, 1112.0583333333352, 1118.5583333333354, 1102.000000000002, 1105.6500000000017, 1094.2166666666687, 1126.8333333333355, 1122.8083333333354, 1130.6666666666688, 1102.2750000000021, 1115.8416666666687, 1112.3416666666694, 1120.5250000000021, 1099.2416666666693, 1118.7916666666688, 1110.8166666666682, 1116.8583333333358], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1096.7333333333354, 1081.1416666666692, 1096.1916666666689, 1111.041666666669, 1107.6750000000025, 1089.5666666666689, 1117.441666666669, 1113.3250000000019, 1067.2416666666686, 1102.1916666666689, 1121.7250000000017, 1105.5916666666687, 1125.0166666666692, 1110.983333333335, 1101.6750000000022, 1100.900000000002, 1097.5916666666692, 1067.3166666666689, 1092.625000000002, 1115.033333333335, 1097.7333333333354, 1096.7833333333356, 1078.408333333335, 1103.4833333333352, 1116.383333333336, 1084.925000000002, 1094.3833333333362, 1105.0666666666684, 1123.2833333333358, 1076.6583333333353, 1115.3250000000023, 1086.3333333333358, 1080.9083333333351, 1131.5166666666685, 1115.1833333333354, 1117.1500000000017, 1117.391666666669, 1104.3833333333353, 1111.8000000000022, 1105.600000000002, 1115.300000000002, 1103.1666666666688, 1114.6833333333352, 1091.1916666666687, 1089.7583333333355, 1106.4000000000021, 1106.2916666666686, 1084.4333333333361, 1128.0666666666687, 1103.7416666666693, 1117.6583333333356, 1102.8083333333354, 1127.6750000000025, 1114.5833333333358, 1101.850000000002, 1126.5666666666687, 1116.6666666666697, 1114.858333333335, 1118.9750000000024, 1092.8833333333357, 1135.475000000002, 1125.0583333333357, 1118.5333333333358, 1101.233333333335, 1121.7583333333355, 1132.0750000000023, 1111.0666666666687, 1115.7000000000023, 1126.641666666669, 1103.1750000000025, 1128.6250000000025, 1103.425000000002, 1126.4583333333353, 1129.3000000000022, 1091.6416666666687, 1109.133333333335, 1087.7750000000021, 1100.3916666666694, 1118.3083333333354, 1115.9750000000024, 1125.7916666666695, 1105.241666666669, 1131.0333333333353, 1122.8500000000017, 1112.0583333333352, 1118.5583333333354, 1102.000000000002, 1105.6500000000017, 1094.2166666666687, 1126.8333333333355, 1122.8083333333354, 1130.6666666666688, 1102.2750000000021, 1115.8416666666687, 1112.3416666666694, 1120.5250000000021, 1099.2416666666693, 1118.7916666666688, 1110.8166666666682, 1116.8583333333358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24102810792465754, "mean_inference_ms": 2.046818343507457, "mean_action_processing_ms": 0.09074088920530532, "mean_env_wait_ms": 1.5315321615882118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006559848785400391, "StateBufferConnector_ms": 0.003329038619995117, "ViewRequirementAgentConnector_ms": 0.08537983894348145}, "num_episodes": 24, "episode_return_max": 1135.475000000002, "episode_return_min": 1067.2416666666686, "episode_return_mean": 1108.5741666666688, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162150, "num_agent_steps_trained": 162000, "num_env_steps_sampled": 162150, "num_env_steps_trained": 162000, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 243.70243912175684, "num_env_steps_trained_throughput_per_sec": 258.0378767171543, "timesteps_total": 162150, "num_env_steps_sampled_lifetime": 162150, "num_agent_steps_sampled_lifetime": 162150, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 162150, "timers": {"training_iteration_time_ms": 10375.225, "restore_workers_time_ms": 0.012, "training_step_time_ms": 625.885, "sample_time_ms": 610.284, "synch_weights_time_ms": 14.085}, "counters": {"num_env_steps_sampled": 162150, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162150, "num_agent_steps_trained": 162000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1081, "num_samples_added_to_queue": 162000}, "done": false, "training_iteration": 64, "trial_id": "27800_00000", "date": "2024-10-12_15-38-52", "timestamp": 1728743932, "time_this_iter_s": 10.48082447052002, "time_total_s": 661.0599858760834, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b44be0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 661.0599858760834, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 16.506666666666668, "ram_util_percent": 38.95333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 139532.375, "policy_loss": 124881.2421875, "entropy": 8.617920875549316, "entropy_coeff": 0.01, "var_gnorm": 16.77590560913086, "vf_loss": 1467698.125, "vf_explained_var": 0.28848958015441895}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 548.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 164700, "num_env_steps_trained": 164400, "num_agent_steps_sampled": 164700, "num_agent_steps_trained": 164400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1098, "num_samples_added_to_queue": 164700, "learner_queue": {"size_count": 548, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.593, "learner_load_time_ms": 0.395, "learner_load_wait_time_ms": 1180.638, "learner_dequeue_time_ms": 9880.987}}, "env_runners": {"episode_reward_max": 1144.4750000000024, "episode_reward_min": 1072.5083333333355, "episode_reward_mean": 1114.137166666669, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1072.5083333333355}, "policy_reward_max": {"default_policy": 1144.4750000000024}, "policy_reward_mean": {"default_policy": 1114.137166666669}, "custom_metrics": {"num_consolidated_mean": 2.8712, "num_consolidated_min": 2.75, "num_consolidated_max": 2.96, "num_overloaded_mean": 0.0039000000000000003, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 2.4641, "num_moves_min": 1.56, "num_moves_max": 3.37, "mean_accuracy_mean": 42.20871333333335, "mean_accuracy_min": 42.06266666666668, "mean_accuracy_max": 42.360333333333344, "num_model_switches_mean": 1.9908000000000001, "num_model_switches_min": 1.32, "num_model_switches_max": 2.53, "num_slav_mean": 0.08323166666666669, "num_slav_min": 0.07213333333333334, "num_slav_max": 0.09793333333333333, "cpu_conserved_cost_mean": 7.498399999999999, "cpu_conserved_cost_min": 7.06, "cpu_conserved_cost_max": 7.86, "mean_cluster_cpu_util_mean": 0.5077812397030074, "mean_cluster_cpu_util_min": 0.4978898752068396, "mean_cluster_cpu_util_max": 0.5156542758557702, "mean_cluster_mem_util_mean": 0.32943395999634034, "mean_cluster_mem_util_min": 0.3250480883492638, "mean_cluster_mem_util_max": 0.33387464748557655, "reward_consolidation_mean_mean": 5.956874999999999, "reward_consolidation_mean_min": 5.708333333333332, "reward_consolidation_mean_max": 6.166666666666666, "reward_illegal_mean_mean": -0.006500000000000001, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.431916666666684, "reward_accuracy_mean_min": 6.216666666666682, "reward_accuracy_mean_max": 6.658333333333352, "reward_sla_mean_mean": -1.24092, "reward_sla_mean_min": -1.4689999999999999, "reward_sla_mean_max": -1.0819999999999999, "reward_consolidation_sum_mean": 595.6875, "reward_consolidation_sum_min": 570.8333333333333, "reward_consolidation_sum_max": 616.6666666666666, "reward_illegal_sum_mean": -0.6499999999999999, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 643.1916666666684, "reward_accuracy_sum_min": 621.6666666666682, "reward_accuracy_sum_max": 665.8333333333352, "reward_sla_sum_mean": -124.09199999999998, "reward_sla_sum_min": -146.89999999999998, "reward_sla_sum_max": -108.19999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5780.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1105.0666666666684, 1123.2833333333358, 1076.6583333333353, 1115.3250000000023, 1086.3333333333358, 1080.9083333333351, 1131.5166666666685, 1115.1833333333354, 1117.1500000000017, 1117.391666666669, 1104.3833333333353, 1111.8000000000022, 1105.600000000002, 1115.300000000002, 1103.1666666666688, 1114.6833333333352, 1091.1916666666687, 1089.7583333333355, 1106.4000000000021, 1106.2916666666686, 1084.4333333333361, 1128.0666666666687, 1103.7416666666693, 1117.6583333333356, 1102.8083333333354, 1127.6750000000025, 1114.5833333333358, 1101.850000000002, 1126.5666666666687, 1116.6666666666697, 1114.858333333335, 1118.9750000000024, 1092.8833333333357, 1135.475000000002, 1125.0583333333357, 1118.5333333333358, 1101.233333333335, 1121.7583333333355, 1132.0750000000023, 1111.0666666666687, 1115.7000000000023, 1126.641666666669, 1103.1750000000025, 1128.6250000000025, 1103.425000000002, 1126.4583333333353, 1129.3000000000022, 1091.6416666666687, 1109.133333333335, 1087.7750000000021, 1100.3916666666694, 1118.3083333333354, 1115.9750000000024, 1125.7916666666695, 1105.241666666669, 1131.0333333333353, 1122.8500000000017, 1112.0583333333352, 1118.5583333333354, 1102.000000000002, 1105.6500000000017, 1094.2166666666687, 1126.8333333333355, 1122.8083333333354, 1130.6666666666688, 1102.2750000000021, 1115.8416666666687, 1112.3416666666694, 1120.5250000000021, 1099.2416666666693, 1118.7916666666688, 1110.8166666666682, 1116.8583333333358, 1113.3416666666685, 1128.4583333333358, 1127.7500000000025, 1120.8416666666692, 1110.4916666666684, 1115.1083333333356, 1101.841666666669, 1126.058333333336, 1115.8833333333355, 1111.858333333335, 1113.8750000000018, 1130.4083333333353, 1124.3250000000028, 1113.6750000000018, 1139.1166666666684, 1135.6000000000022, 1127.2916666666688, 1132.0666666666687, 1072.5083333333355, 1120.0666666666684, 1105.2166666666683, 1116.0166666666685, 1120.6166666666686, 1129.225000000002, 1122.3916666666687, 1144.4750000000024, 1130.900000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1105.0666666666684, 1123.2833333333358, 1076.6583333333353, 1115.3250000000023, 1086.3333333333358, 1080.9083333333351, 1131.5166666666685, 1115.1833333333354, 1117.1500000000017, 1117.391666666669, 1104.3833333333353, 1111.8000000000022, 1105.600000000002, 1115.300000000002, 1103.1666666666688, 1114.6833333333352, 1091.1916666666687, 1089.7583333333355, 1106.4000000000021, 1106.2916666666686, 1084.4333333333361, 1128.0666666666687, 1103.7416666666693, 1117.6583333333356, 1102.8083333333354, 1127.6750000000025, 1114.5833333333358, 1101.850000000002, 1126.5666666666687, 1116.6666666666697, 1114.858333333335, 1118.9750000000024, 1092.8833333333357, 1135.475000000002, 1125.0583333333357, 1118.5333333333358, 1101.233333333335, 1121.7583333333355, 1132.0750000000023, 1111.0666666666687, 1115.7000000000023, 1126.641666666669, 1103.1750000000025, 1128.6250000000025, 1103.425000000002, 1126.4583333333353, 1129.3000000000022, 1091.6416666666687, 1109.133333333335, 1087.7750000000021, 1100.3916666666694, 1118.3083333333354, 1115.9750000000024, 1125.7916666666695, 1105.241666666669, 1131.0333333333353, 1122.8500000000017, 1112.0583333333352, 1118.5583333333354, 1102.000000000002, 1105.6500000000017, 1094.2166666666687, 1126.8333333333355, 1122.8083333333354, 1130.6666666666688, 1102.2750000000021, 1115.8416666666687, 1112.3416666666694, 1120.5250000000021, 1099.2416666666693, 1118.7916666666688, 1110.8166666666682, 1116.8583333333358, 1113.3416666666685, 1128.4583333333358, 1127.7500000000025, 1120.8416666666692, 1110.4916666666684, 1115.1083333333356, 1101.841666666669, 1126.058333333336, 1115.8833333333355, 1111.858333333335, 1113.8750000000018, 1130.4083333333353, 1124.3250000000028, 1113.6750000000018, 1139.1166666666684, 1135.6000000000022, 1127.2916666666688, 1132.0666666666687, 1072.5083333333355, 1120.0666666666684, 1105.2166666666683, 1116.0166666666685, 1120.6166666666686, 1129.225000000002, 1122.3916666666687, 1144.4750000000024, 1130.900000000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2410242079673358, "mean_inference_ms": 2.045254934022726, "mean_action_processing_ms": 0.09073248620892196, "mean_env_wait_ms": 1.5312365219827615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006501197814941406, "StateBufferConnector_ms": 0.0033643245697021484, "ViewRequirementAgentConnector_ms": 0.08598542213439941}, "num_episodes": 27, "episode_return_max": 1144.4750000000024, "episode_return_min": 1072.5083333333355, "episode_return_mean": 1114.137166666669, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164700, "num_agent_steps_trained": 164400, "num_env_steps_sampled": 164700, "num_env_steps_trained": 164400, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 244.8500321839293, "num_env_steps_trained_throughput_per_sec": 230.4470891142864, "timesteps_total": 164700, "num_env_steps_sampled_lifetime": 164700, "num_agent_steps_sampled_lifetime": 164700, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 164700, "timers": {"training_iteration_time_ms": 10394.863, "restore_workers_time_ms": 0.014, "training_step_time_ms": 618.073, "sample_time_ms": 601.084, "synch_weights_time_ms": 15.413}, "counters": {"num_env_steps_sampled": 164700, "num_env_steps_trained": 164400, "num_agent_steps_sampled": 164700, "num_agent_steps_trained": 164400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1098, "num_samples_added_to_queue": 164700}, "done": false, "training_iteration": 65, "trial_id": "27800_00000", "date": "2024-10-12_15-39-03", "timestamp": 1728743943, "time_this_iter_s": 10.426778078079224, "time_total_s": 671.4867639541626, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f6bc70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 671.4867639541626, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 16.44, "ram_util_percent": 39.06666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 117792.2890625, "policy_loss": 103862.4375, "entropy": 7.9416022300720215, "entropy_coeff": 0.01, "var_gnorm": 16.81711769104004, "vf_loss": 1395368.125, "vf_explained_var": 0.30799877643585205}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 557.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 167250, "num_env_steps_trained": 167100, "num_agent_steps_sampled": 167250, "num_agent_steps_trained": 167100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1115, "num_samples_added_to_queue": 167100, "learner_queue": {"size_count": 557, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.339, "learner_load_time_ms": 0.387, "learner_load_wait_time_ms": 1160.391, "learner_dequeue_time_ms": 9874.315}}, "env_runners": {"episode_reward_max": 1146.450000000002, "episode_reward_min": 1072.5083333333355, "episode_reward_mean": 1120.876250000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1072.5083333333355}, "policy_reward_max": {"default_policy": 1146.450000000002}, "policy_reward_mean": {"default_policy": 1120.876250000002}, "custom_metrics": {"num_consolidated_mean": 2.8972, "num_consolidated_min": 2.8, "num_consolidated_max": 2.99, "num_overloaded_mean": 0.0027, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 2.1061, "num_moves_min": 1.12, "num_moves_max": 2.9, "mean_accuracy_mean": 42.221506666666684, "mean_accuracy_min": 42.06266666666668, "mean_accuracy_max": 42.39833333333335, "num_model_switches_mean": 1.7437999999999996, "num_model_switches_min": 0.96, "num_model_switches_max": 2.39, "num_slav_mean": 0.08453, "num_slav_min": 0.07213333333333334, "num_slav_max": 0.09793333333333333, "cpu_conserved_cost_mean": 7.598400000000001, "cpu_conserved_cost_min": 7.22, "cpu_conserved_cost_max": 7.96, "mean_cluster_cpu_util_mean": 0.5084918361824076, "mean_cluster_cpu_util_min": 0.4978898752068396, "mean_cluster_cpu_util_max": 0.5156542758557702, "mean_cluster_mem_util_mean": 0.33065691875484376, "mean_cluster_mem_util_min": 0.3257770305907173, "mean_cluster_mem_util_max": 0.3355779272151899, "reward_consolidation_mean_mean": 6.018749999999999, "reward_consolidation_mean_min": 5.729166666666666, "reward_consolidation_mean_max": 6.229166666666668, "reward_illegal_mean_mean": -0.0045000000000000005, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.456750000000019, "reward_accuracy_mean_min": 6.233333333333352, "reward_accuracy_mean_max": 6.641666666666688, "reward_sla_mean_mean": -1.2622375, "reward_sla_mean_min": -1.4689999999999999, "reward_sla_mean_max": -1.0819999999999999, "reward_consolidation_sum_mean": 601.875, "reward_consolidation_sum_min": 572.9166666666666, "reward_consolidation_sum_max": 622.9166666666667, "reward_illegal_sum_mean": -0.44999999999999996, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 645.6750000000019, "reward_accuracy_sum_min": 623.3333333333352, "reward_accuracy_sum_max": 664.1666666666688, "reward_sla_sum_mean": -126.22374999999998, "reward_sla_sum_min": -146.89999999999998, "reward_sla_sum_max": -108.19999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4708.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1102.8083333333354, 1127.6750000000025, 1114.5833333333358, 1101.850000000002, 1126.5666666666687, 1116.6666666666697, 1114.858333333335, 1118.9750000000024, 1092.8833333333357, 1135.475000000002, 1125.0583333333357, 1118.5333333333358, 1101.233333333335, 1121.7583333333355, 1132.0750000000023, 1111.0666666666687, 1115.7000000000023, 1126.641666666669, 1103.1750000000025, 1128.6250000000025, 1103.425000000002, 1126.4583333333353, 1129.3000000000022, 1091.6416666666687, 1109.133333333335, 1087.7750000000021, 1100.3916666666694, 1118.3083333333354, 1115.9750000000024, 1125.7916666666695, 1105.241666666669, 1131.0333333333353, 1122.8500000000017, 1112.0583333333352, 1118.5583333333354, 1102.000000000002, 1105.6500000000017, 1094.2166666666687, 1126.8333333333355, 1122.8083333333354, 1130.6666666666688, 1102.2750000000021, 1115.8416666666687, 1112.3416666666694, 1120.5250000000021, 1099.2416666666693, 1118.7916666666688, 1110.8166666666682, 1116.8583333333358, 1113.3416666666685, 1128.4583333333358, 1127.7500000000025, 1120.8416666666692, 1110.4916666666684, 1115.1083333333356, 1101.841666666669, 1126.058333333336, 1115.8833333333355, 1111.858333333335, 1113.8750000000018, 1130.4083333333353, 1124.3250000000028, 1113.6750000000018, 1139.1166666666684, 1135.6000000000022, 1127.2916666666688, 1132.0666666666687, 1072.5083333333355, 1120.0666666666684, 1105.2166666666683, 1116.0166666666685, 1120.6166666666686, 1129.225000000002, 1122.3916666666687, 1144.4750000000024, 1130.900000000002, 1126.3916666666692, 1133.5250000000021, 1135.3250000000023, 1140.2083333333355, 1140.291666666669, 1134.3083333333357, 1135.3416666666685, 1144.2833333333356, 1131.7500000000016, 1138.9166666666695, 1109.9500000000023, 1137.1166666666688, 1146.450000000002, 1139.3000000000025, 1135.383333333336, 1134.391666666669, 1130.2500000000025, 1119.6500000000021, 1130.4916666666693, 1139.1666666666692, 1134.2416666666688, 1125.7500000000025, 1137.825000000002, 1144.8916666666698], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1102.8083333333354, 1127.6750000000025, 1114.5833333333358, 1101.850000000002, 1126.5666666666687, 1116.6666666666697, 1114.858333333335, 1118.9750000000024, 1092.8833333333357, 1135.475000000002, 1125.0583333333357, 1118.5333333333358, 1101.233333333335, 1121.7583333333355, 1132.0750000000023, 1111.0666666666687, 1115.7000000000023, 1126.641666666669, 1103.1750000000025, 1128.6250000000025, 1103.425000000002, 1126.4583333333353, 1129.3000000000022, 1091.6416666666687, 1109.133333333335, 1087.7750000000021, 1100.3916666666694, 1118.3083333333354, 1115.9750000000024, 1125.7916666666695, 1105.241666666669, 1131.0333333333353, 1122.8500000000017, 1112.0583333333352, 1118.5583333333354, 1102.000000000002, 1105.6500000000017, 1094.2166666666687, 1126.8333333333355, 1122.8083333333354, 1130.6666666666688, 1102.2750000000021, 1115.8416666666687, 1112.3416666666694, 1120.5250000000021, 1099.2416666666693, 1118.7916666666688, 1110.8166666666682, 1116.8583333333358, 1113.3416666666685, 1128.4583333333358, 1127.7500000000025, 1120.8416666666692, 1110.4916666666684, 1115.1083333333356, 1101.841666666669, 1126.058333333336, 1115.8833333333355, 1111.858333333335, 1113.8750000000018, 1130.4083333333353, 1124.3250000000028, 1113.6750000000018, 1139.1166666666684, 1135.6000000000022, 1127.2916666666688, 1132.0666666666687, 1072.5083333333355, 1120.0666666666684, 1105.2166666666683, 1116.0166666666685, 1120.6166666666686, 1129.225000000002, 1122.3916666666687, 1144.4750000000024, 1130.900000000002, 1126.3916666666692, 1133.5250000000021, 1135.3250000000023, 1140.2083333333355, 1140.291666666669, 1134.3083333333357, 1135.3416666666685, 1144.2833333333356, 1131.7500000000016, 1138.9166666666695, 1109.9500000000023, 1137.1166666666688, 1146.450000000002, 1139.3000000000025, 1135.383333333336, 1134.391666666669, 1130.2500000000025, 1119.6500000000021, 1130.4916666666693, 1139.1666666666692, 1134.2416666666688, 1125.7500000000025, 1137.825000000002, 1144.8916666666698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2410322232813276, "mean_inference_ms": 2.0449646488228326, "mean_action_processing_ms": 0.09073256974971108, "mean_env_wait_ms": 1.5311575249827774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006481170654296875, "StateBufferConnector_ms": 0.003360748291015625, "ViewRequirementAgentConnector_ms": 0.08634233474731445}, "num_episodes": 24, "episode_return_max": 1146.450000000002, "episode_return_min": 1072.5083333333355, "episode_return_mean": 1120.876250000002, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 167250, "num_agent_steps_trained": 167100, "num_env_steps_sampled": 167250, "num_env_steps_trained": 167100, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 250.09220381139016, "num_env_steps_trained_throughput_per_sec": 264.80350991794256, "timesteps_total": 167250, "num_env_steps_sampled_lifetime": 167250, "num_agent_steps_sampled_lifetime": 167250, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 167250, "timers": {"training_iteration_time_ms": 10361.328, "restore_workers_time_ms": 0.014, "training_step_time_ms": 594.231, "sample_time_ms": 578.198, "synch_weights_time_ms": 14.541}, "counters": {"num_env_steps_sampled": 167250, "num_env_steps_trained": 167100, "num_agent_steps_sampled": 167250, "num_agent_steps_trained": 167100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1115, "num_samples_added_to_queue": 167100}, "done": false, "training_iteration": 66, "trial_id": "27800_00000", "date": "2024-10-12_15-39-13", "timestamp": 1728743953, "time_this_iter_s": 10.21096158027649, "time_total_s": 681.6977255344391, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f6be80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 681.6977255344391, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 16.753333333333334, "ram_util_percent": 39.220000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 103752.5546875, "policy_loss": 89384.4296875, "entropy": 7.533593654632568, "entropy_coeff": 0.01, "var_gnorm": 16.86066436767578, "vf_loss": 1439073.0, "vf_explained_var": 0.3197851777076721}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 565.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 169800, "num_env_steps_trained": 169500, "num_agent_steps_sampled": 169800, "num_agent_steps_trained": 169500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1132, "num_samples_added_to_queue": 169800, "learner_queue": {"size_count": 565, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.401, "learner_load_time_ms": 0.367, "learner_load_wait_time_ms": 1167.694, "learner_dequeue_time_ms": 9852.163}}, "env_runners": {"episode_reward_max": 1158.1166666666688, "episode_reward_min": 1072.5083333333355, "episode_reward_mean": 1129.0599166666689, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1072.5083333333355}, "policy_reward_max": {"default_policy": 1158.1166666666688}, "policy_reward_mean": {"default_policy": 1129.0599166666689}, "custom_metrics": {"num_consolidated_mean": 2.926600000000001, "num_consolidated_min": 2.81, "num_consolidated_max": 2.99, "num_overloaded_mean": 0.0015, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 1.7342000000000002, "num_moves_min": 1.0, "num_moves_max": 2.89, "mean_accuracy_mean": 42.23803666666667, "mean_accuracy_min": 42.06266666666668, "mean_accuracy_max": 42.39833333333335, "num_model_switches_mean": 1.469, "num_model_switches_min": 0.95, "num_model_switches_max": 2.39, "num_slav_mean": 0.08564216666666667, "num_slav_min": 0.07621666666666668, "num_slav_max": 0.09328333333333334, "cpu_conserved_cost_mean": 7.712799999999999, "cpu_conserved_cost_min": 7.24, "cpu_conserved_cost_max": 7.96, "mean_cluster_cpu_util_mean": 0.5095671397453516, "mean_cluster_cpu_util_min": 0.4978898752068396, "mean_cluster_cpu_util_max": 0.5147669924537523, "mean_cluster_mem_util_mean": 0.33208511887539827, "mean_cluster_mem_util_min": 0.3257770305907173, "mean_cluster_mem_util_max": 0.3355779272151899, "reward_consolidation_mean_mean": 6.0875, "reward_consolidation_mean_min": 5.770833333333332, "reward_consolidation_mean_max": 6.229166666666668, "reward_illegal_mean_mean": -0.0025, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.486666666666687, "reward_accuracy_mean_min": 6.233333333333352, "reward_accuracy_mean_max": 6.6666666666666865, "reward_sla_mean_mean": -1.2810675, "reward_sla_mean_min": -1.3992499999999999, "reward_sla_mean_max": -1.1072499999999998, "reward_consolidation_sum_mean": 608.75, "reward_consolidation_sum_min": 577.0833333333333, "reward_consolidation_sum_max": 622.9166666666667, "reward_illegal_sum_mean": -0.25, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 648.6666666666686, "reward_accuracy_sum_min": 623.3333333333352, "reward_accuracy_sum_max": 666.6666666666687, "reward_sla_sum_mean": -128.10675, "reward_sla_sum_min": -139.92499999999998, "reward_sla_sum_max": -110.725, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3502.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1118.3083333333354, 1115.9750000000024, 1125.7916666666695, 1105.241666666669, 1131.0333333333353, 1122.8500000000017, 1112.0583333333352, 1118.5583333333354, 1102.000000000002, 1105.6500000000017, 1094.2166666666687, 1126.8333333333355, 1122.8083333333354, 1130.6666666666688, 1102.2750000000021, 1115.8416666666687, 1112.3416666666694, 1120.5250000000021, 1099.2416666666693, 1118.7916666666688, 1110.8166666666682, 1116.8583333333358, 1113.3416666666685, 1128.4583333333358, 1127.7500000000025, 1120.8416666666692, 1110.4916666666684, 1115.1083333333356, 1101.841666666669, 1126.058333333336, 1115.8833333333355, 1111.858333333335, 1113.8750000000018, 1130.4083333333353, 1124.3250000000028, 1113.6750000000018, 1139.1166666666684, 1135.6000000000022, 1127.2916666666688, 1132.0666666666687, 1072.5083333333355, 1120.0666666666684, 1105.2166666666683, 1116.0166666666685, 1120.6166666666686, 1129.225000000002, 1122.3916666666687, 1144.4750000000024, 1130.900000000002, 1126.3916666666692, 1133.5250000000021, 1135.3250000000023, 1140.2083333333355, 1140.291666666669, 1134.3083333333357, 1135.3416666666685, 1144.2833333333356, 1131.7500000000016, 1138.9166666666695, 1109.9500000000023, 1137.1166666666688, 1146.450000000002, 1139.3000000000025, 1135.383333333336, 1134.391666666669, 1130.2500000000025, 1119.6500000000021, 1130.4916666666693, 1139.1666666666692, 1134.2416666666688, 1125.7500000000025, 1137.825000000002, 1144.8916666666698, 1144.6916666666693, 1149.883333333336, 1158.1166666666688, 1146.7333333333358, 1151.0250000000026, 1152.5166666666694, 1141.8000000000025, 1141.6000000000022, 1146.700000000002, 1140.6750000000018, 1143.8916666666685, 1154.2583333333353, 1142.2500000000023, 1144.8500000000024, 1146.5333333333365, 1144.5750000000023, 1142.5500000000022, 1142.7083333333355, 1148.3916666666694, 1130.5833333333358, 1140.600000000002, 1115.2250000000026, 1151.1250000000027, 1150.8833333333355, 1140.9250000000022, 1149.5583333333363, 1140.0500000000025], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1118.3083333333354, 1115.9750000000024, 1125.7916666666695, 1105.241666666669, 1131.0333333333353, 1122.8500000000017, 1112.0583333333352, 1118.5583333333354, 1102.000000000002, 1105.6500000000017, 1094.2166666666687, 1126.8333333333355, 1122.8083333333354, 1130.6666666666688, 1102.2750000000021, 1115.8416666666687, 1112.3416666666694, 1120.5250000000021, 1099.2416666666693, 1118.7916666666688, 1110.8166666666682, 1116.8583333333358, 1113.3416666666685, 1128.4583333333358, 1127.7500000000025, 1120.8416666666692, 1110.4916666666684, 1115.1083333333356, 1101.841666666669, 1126.058333333336, 1115.8833333333355, 1111.858333333335, 1113.8750000000018, 1130.4083333333353, 1124.3250000000028, 1113.6750000000018, 1139.1166666666684, 1135.6000000000022, 1127.2916666666688, 1132.0666666666687, 1072.5083333333355, 1120.0666666666684, 1105.2166666666683, 1116.0166666666685, 1120.6166666666686, 1129.225000000002, 1122.3916666666687, 1144.4750000000024, 1130.900000000002, 1126.3916666666692, 1133.5250000000021, 1135.3250000000023, 1140.2083333333355, 1140.291666666669, 1134.3083333333357, 1135.3416666666685, 1144.2833333333356, 1131.7500000000016, 1138.9166666666695, 1109.9500000000023, 1137.1166666666688, 1146.450000000002, 1139.3000000000025, 1135.383333333336, 1134.391666666669, 1130.2500000000025, 1119.6500000000021, 1130.4916666666693, 1139.1666666666692, 1134.2416666666688, 1125.7500000000025, 1137.825000000002, 1144.8916666666698, 1144.6916666666693, 1149.883333333336, 1158.1166666666688, 1146.7333333333358, 1151.0250000000026, 1152.5166666666694, 1141.8000000000025, 1141.6000000000022, 1146.700000000002, 1140.6750000000018, 1143.8916666666685, 1154.2583333333353, 1142.2500000000023, 1144.8500000000024, 1146.5333333333365, 1144.5750000000023, 1142.5500000000022, 1142.7083333333355, 1148.3916666666694, 1130.5833333333358, 1140.600000000002, 1115.2250000000026, 1151.1250000000027, 1150.8833333333355, 1140.9250000000022, 1149.5583333333363, 1140.0500000000025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24105252607950212, "mean_inference_ms": 2.0448270597390676, "mean_action_processing_ms": 0.09073253292323796, "mean_env_wait_ms": 1.5311433573278521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006495237350463867, "StateBufferConnector_ms": 0.003370046615600586, "ViewRequirementAgentConnector_ms": 0.0861964225769043}, "num_episodes": 27, "episode_return_max": 1158.1166666666688, "episode_return_min": 1072.5083333333355, "episode_return_mean": 1129.0599166666689, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 169800, "num_agent_steps_trained": 169500, "num_env_steps_sampled": 169800, "num_env_steps_trained": 169500, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 243.83026164548957, "num_env_steps_trained_throughput_per_sec": 229.48730507810782, "timesteps_total": 169800, "num_env_steps_sampled_lifetime": 169800, "num_agent_steps_sampled_lifetime": 169800, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 169800, "timers": {"training_iteration_time_ms": 10366.675, "restore_workers_time_ms": 0.012, "training_step_time_ms": 624.986, "sample_time_ms": 609.245, "synch_weights_time_ms": 14.33}, "counters": {"num_env_steps_sampled": 169800, "num_env_steps_trained": 169500, "num_agent_steps_sampled": 169800, "num_agent_steps_trained": 169500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1132, "num_samples_added_to_queue": 169800}, "done": false, "training_iteration": 67, "trial_id": "27800_00000", "date": "2024-10-12_15-39-23", "timestamp": 1728743963, "time_this_iter_s": 10.47456693649292, "time_total_s": 692.172292470932, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a945ee3490>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 692.172292470932, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 16.426666666666666, "ram_util_percent": 39.37333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 84874.0859375, "policy_loss": 73362.84375, "entropy": 7.48764181137085, "entropy_coeff": 0.01, "var_gnorm": 16.91049575805664, "vf_loss": 1153370.5, "vf_explained_var": 0.3617396950721741}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 574.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 172350, "num_env_steps_trained": 172200, "num_agent_steps_sampled": 172350, "num_agent_steps_trained": 172200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1149, "num_samples_added_to_queue": 172200, "learner_queue": {"size_count": 574, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.875, "learner_load_time_ms": 0.347, "learner_load_wait_time_ms": 1164.809, "learner_dequeue_time_ms": 9863.755}}, "env_runners": {"episode_reward_max": 1158.1166666666688, "episode_reward_min": 1072.5083333333355, "episode_reward_mean": 1134.6788333333354, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1072.5083333333355}, "policy_reward_max": {"default_policy": 1158.1166666666688}, "policy_reward_mean": {"default_policy": 1134.6788333333354}, "custom_metrics": {"num_consolidated_mean": 2.9457000000000004, "num_consolidated_min": 2.83, "num_consolidated_max": 2.99, "num_overloaded_mean": 0.0008, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 1.462, "num_moves_min": 0.91, "num_moves_max": 2.27, "mean_accuracy_mean": 42.24905666666668, "mean_accuracy_min": 42.06266666666668, "mean_accuracy_max": 42.39833333333335, "num_model_switches_mean": 1.2828, "num_model_switches_min": 0.88, "num_model_switches_max": 1.93, "num_slav_mean": 0.08610166666666669, "num_slav_min": 0.07650000000000001, "num_slav_max": 0.09328333333333334, "cpu_conserved_cost_mean": 7.787000000000001, "cpu_conserved_cost_min": 7.34, "cpu_conserved_cost_max": 7.96, "mean_cluster_cpu_util_mean": 0.5105060346545756, "mean_cluster_cpu_util_min": 0.5003722690220885, "mean_cluster_cpu_util_max": 0.5164780319222284, "mean_cluster_mem_util_mean": 0.33302299260527, "mean_cluster_mem_util_min": 0.3276538254542324, "mean_cluster_mem_util_max": 0.3355779272151899, "reward_consolidation_mean_mean": 6.131666666666665, "reward_consolidation_mean_min": 5.770833333333332, "reward_consolidation_mean_max": 6.229166666666668, "reward_illegal_mean_mean": -0.0013333333333333333, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.50625000000002, "reward_accuracy_mean_min": 6.233333333333352, "reward_accuracy_mean_max": 6.6666666666666865, "reward_sla_mean_mean": -1.289795, "reward_sla_mean_min": -1.3992499999999999, "reward_sla_mean_max": -1.1475, "reward_consolidation_sum_mean": 613.1666666666666, "reward_consolidation_sum_min": 577.0833333333333, "reward_consolidation_sum_max": 622.9166666666667, "reward_illegal_sum_mean": -0.13333333333333333, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 650.625000000002, "reward_accuracy_sum_min": 623.3333333333352, "reward_accuracy_sum_max": 666.6666666666687, "reward_sla_sum_mean": -128.9795, "reward_sla_sum_min": -139.92499999999998, "reward_sla_sum_max": -114.75, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2430.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1127.7500000000025, 1120.8416666666692, 1110.4916666666684, 1115.1083333333356, 1101.841666666669, 1126.058333333336, 1115.8833333333355, 1111.858333333335, 1113.8750000000018, 1130.4083333333353, 1124.3250000000028, 1113.6750000000018, 1139.1166666666684, 1135.6000000000022, 1127.2916666666688, 1132.0666666666687, 1072.5083333333355, 1120.0666666666684, 1105.2166666666683, 1116.0166666666685, 1120.6166666666686, 1129.225000000002, 1122.3916666666687, 1144.4750000000024, 1130.900000000002, 1126.3916666666692, 1133.5250000000021, 1135.3250000000023, 1140.2083333333355, 1140.291666666669, 1134.3083333333357, 1135.3416666666685, 1144.2833333333356, 1131.7500000000016, 1138.9166666666695, 1109.9500000000023, 1137.1166666666688, 1146.450000000002, 1139.3000000000025, 1135.383333333336, 1134.391666666669, 1130.2500000000025, 1119.6500000000021, 1130.4916666666693, 1139.1666666666692, 1134.2416666666688, 1125.7500000000025, 1137.825000000002, 1144.8916666666698, 1144.6916666666693, 1149.883333333336, 1158.1166666666688, 1146.7333333333358, 1151.0250000000026, 1152.5166666666694, 1141.8000000000025, 1141.6000000000022, 1146.700000000002, 1140.6750000000018, 1143.8916666666685, 1154.2583333333353, 1142.2500000000023, 1144.8500000000024, 1146.5333333333365, 1144.5750000000023, 1142.5500000000022, 1142.7083333333355, 1148.3916666666694, 1130.5833333333358, 1140.600000000002, 1115.2250000000026, 1151.1250000000027, 1150.8833333333355, 1140.9250000000022, 1149.5583333333363, 1140.0500000000025, 1144.8333333333355, 1140.5416666666695, 1135.3000000000022, 1138.7666666666687, 1140.300000000002, 1131.425000000002, 1139.750000000002, 1133.0833333333353, 1137.7500000000023, 1132.1000000000026, 1131.0583333333361, 1137.4583333333358, 1145.4583333333358, 1151.558333333336, 1137.5333333333353, 1128.500000000002, 1154.8500000000024, 1141.4500000000023, 1141.3250000000028, 1144.5083333333355, 1145.7583333333355, 1143.8916666666694, 1129.6083333333356, 1125.5666666666689], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1127.7500000000025, 1120.8416666666692, 1110.4916666666684, 1115.1083333333356, 1101.841666666669, 1126.058333333336, 1115.8833333333355, 1111.858333333335, 1113.8750000000018, 1130.4083333333353, 1124.3250000000028, 1113.6750000000018, 1139.1166666666684, 1135.6000000000022, 1127.2916666666688, 1132.0666666666687, 1072.5083333333355, 1120.0666666666684, 1105.2166666666683, 1116.0166666666685, 1120.6166666666686, 1129.225000000002, 1122.3916666666687, 1144.4750000000024, 1130.900000000002, 1126.3916666666692, 1133.5250000000021, 1135.3250000000023, 1140.2083333333355, 1140.291666666669, 1134.3083333333357, 1135.3416666666685, 1144.2833333333356, 1131.7500000000016, 1138.9166666666695, 1109.9500000000023, 1137.1166666666688, 1146.450000000002, 1139.3000000000025, 1135.383333333336, 1134.391666666669, 1130.2500000000025, 1119.6500000000021, 1130.4916666666693, 1139.1666666666692, 1134.2416666666688, 1125.7500000000025, 1137.825000000002, 1144.8916666666698, 1144.6916666666693, 1149.883333333336, 1158.1166666666688, 1146.7333333333358, 1151.0250000000026, 1152.5166666666694, 1141.8000000000025, 1141.6000000000022, 1146.700000000002, 1140.6750000000018, 1143.8916666666685, 1154.2583333333353, 1142.2500000000023, 1144.8500000000024, 1146.5333333333365, 1144.5750000000023, 1142.5500000000022, 1142.7083333333355, 1148.3916666666694, 1130.5833333333358, 1140.600000000002, 1115.2250000000026, 1151.1250000000027, 1150.8833333333355, 1140.9250000000022, 1149.5583333333363, 1140.0500000000025, 1144.8333333333355, 1140.5416666666695, 1135.3000000000022, 1138.7666666666687, 1140.300000000002, 1131.425000000002, 1139.750000000002, 1133.0833333333353, 1137.7500000000023, 1132.1000000000026, 1131.0583333333361, 1137.4583333333358, 1145.4583333333358, 1151.558333333336, 1137.5333333333353, 1128.500000000002, 1154.8500000000024, 1141.4500000000023, 1141.3250000000028, 1144.5083333333355, 1145.7583333333355, 1143.8916666666694, 1129.6083333333356, 1125.5666666666689]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24109395916315107, "mean_inference_ms": 2.0447234343635694, "mean_action_processing_ms": 0.0907342459164048, "mean_env_wait_ms": 1.5311643933487937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006509065628051758, "StateBufferConnector_ms": 0.0033359527587890625, "ViewRequirementAgentConnector_ms": 0.08555340766906738}, "num_episodes": 24, "episode_return_max": 1158.1166666666688, "episode_return_min": 1072.5083333333355, "episode_return_mean": 1134.6788333333354, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172350, "num_agent_steps_trained": 172200, "num_env_steps_sampled": 172350, "num_env_steps_trained": 172200, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 242.62868503590835, "num_env_steps_trained_throughput_per_sec": 256.9009606262559, "timesteps_total": 172350, "num_env_steps_sampled_lifetime": 172350, "num_agent_steps_sampled_lifetime": 172350, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 172350, "timers": {"training_iteration_time_ms": 10382.746, "restore_workers_time_ms": 0.013, "training_step_time_ms": 622.501, "sample_time_ms": 606.605, "synch_weights_time_ms": 14.46}, "counters": {"num_env_steps_sampled": 172350, "num_env_steps_trained": 172200, "num_agent_steps_sampled": 172350, "num_agent_steps_trained": 172200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1149, "num_samples_added_to_queue": 172200}, "done": false, "training_iteration": 68, "trial_id": "27800_00000", "date": "2024-10-12_15-39-34", "timestamp": 1728743974, "time_this_iter_s": 10.522713422775269, "time_total_s": 702.6950058937073, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b464d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 702.6950058937073, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 16.519999999999996, "ram_util_percent": 39.473333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 89780.765625, "policy_loss": 76546.7109375, "entropy": 7.026852130889893, "entropy_coeff": 0.01, "var_gnorm": 16.95820426940918, "vf_loss": 1325513.5, "vf_explained_var": 0.3645995259284973}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 582.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 174900, "num_env_steps_trained": 174600, "num_agent_steps_sampled": 174900, "num_agent_steps_trained": 174600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1166, "num_samples_added_to_queue": 174900, "learner_queue": {"size_count": 582, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.908, "learner_load_time_ms": 0.371, "learner_load_wait_time_ms": 1183.826, "learner_dequeue_time_ms": 9879.329}}, "env_runners": {"episode_reward_max": 1158.1166666666688, "episode_reward_min": 1109.808333333335, "episode_reward_mean": 1136.9776666666692, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1109.808333333335}, "policy_reward_max": {"default_policy": 1158.1166666666688}, "policy_reward_mean": {"default_policy": 1136.9776666666692}, "custom_metrics": {"num_consolidated_mean": 2.9608, "num_consolidated_min": 2.89, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0006000000000000001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.01, "num_moves_mean": 1.2714, "num_moves_min": 0.91, "num_moves_max": 1.76, "mean_accuracy_mean": 42.24240666666668, "mean_accuracy_min": 42.05633333333335, "mean_accuracy_max": 42.39833333333335, "num_model_switches_mean": 1.1414, "num_model_switches_min": 0.77, "num_model_switches_max": 1.44, "num_slav_mean": 0.08626633333333336, "num_slav_min": 0.08035, "num_slav_max": 0.09193333333333334, "cpu_conserved_cost_mean": 7.8454, "cpu_conserved_cost_min": 7.56, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5111943334810205, "mean_cluster_cpu_util_min": 0.5050232952978488, "mean_cluster_cpu_util_max": 0.5164780319222284, "mean_cluster_mem_util_mean": 0.33367936698096956, "mean_cluster_mem_util_min": 0.33020305907173, "mean_cluster_mem_util_max": 0.3355779272151899, "reward_consolidation_mean_mean": 6.164374999999999, "reward_consolidation_mean_min": 5.979166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": -0.001, "reward_illegal_mean_min": -0.016666666666666666, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.498916666666686, "reward_accuracy_mean_min": 6.2583333333333515, "reward_accuracy_mean_max": 6.6666666666666865, "reward_sla_mean_mean": -1.2925149999999999, "reward_sla_mean_min": -1.3742499999999997, "reward_sla_mean_max": -1.2052500000000002, "reward_consolidation_sum_mean": 616.4374999999999, "reward_consolidation_sum_min": 597.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": -0.09999999999999998, "reward_illegal_sum_min": -1.6666666666666665, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 649.8916666666686, "reward_accuracy_sum_min": 625.8333333333352, "reward_accuracy_sum_max": 666.6666666666687, "reward_sla_sum_mean": -129.2515, "reward_sla_sum_min": -137.42499999999998, "reward_sla_sum_max": -120.525, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2082.0, "global_timestep_min": 400, "global_timestep_max": 3700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1135.3250000000023, 1140.2083333333355, 1140.291666666669, 1134.3083333333357, 1135.3416666666685, 1144.2833333333356, 1131.7500000000016, 1138.9166666666695, 1109.9500000000023, 1137.1166666666688, 1146.450000000002, 1139.3000000000025, 1135.383333333336, 1134.391666666669, 1130.2500000000025, 1119.6500000000021, 1130.4916666666693, 1139.1666666666692, 1134.2416666666688, 1125.7500000000025, 1137.825000000002, 1144.8916666666698, 1144.6916666666693, 1149.883333333336, 1158.1166666666688, 1146.7333333333358, 1151.0250000000026, 1152.5166666666694, 1141.8000000000025, 1141.6000000000022, 1146.700000000002, 1140.6750000000018, 1143.8916666666685, 1154.2583333333353, 1142.2500000000023, 1144.8500000000024, 1146.5333333333365, 1144.5750000000023, 1142.5500000000022, 1142.7083333333355, 1148.3916666666694, 1130.5833333333358, 1140.600000000002, 1115.2250000000026, 1151.1250000000027, 1150.8833333333355, 1140.9250000000022, 1149.5583333333363, 1140.0500000000025, 1144.8333333333355, 1140.5416666666695, 1135.3000000000022, 1138.7666666666687, 1140.300000000002, 1131.425000000002, 1139.750000000002, 1133.0833333333353, 1137.7500000000023, 1132.1000000000026, 1131.0583333333361, 1137.4583333333358, 1145.4583333333358, 1151.558333333336, 1137.5333333333353, 1128.500000000002, 1154.8500000000024, 1141.4500000000023, 1141.3250000000028, 1144.5083333333355, 1145.7583333333355, 1143.8916666666694, 1129.6083333333356, 1125.5666666666689, 1136.9833333333358, 1133.3750000000025, 1128.8333333333358, 1126.800000000002, 1133.8750000000016, 1139.3333333333362, 1114.2833333333358, 1139.683333333335, 1128.1916666666693, 1139.7000000000023, 1116.250000000002, 1123.4833333333356, 1126.4583333333353, 1134.616666666669, 1128.0916666666685, 1136.8583333333354, 1116.2000000000016, 1137.1916666666684, 1136.1083333333356, 1148.7333333333356, 1132.316666666669, 1124.566666666669, 1130.0166666666687, 1137.5250000000024, 1109.808333333335, 1123.2166666666687, 1114.9083333333358], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1135.3250000000023, 1140.2083333333355, 1140.291666666669, 1134.3083333333357, 1135.3416666666685, 1144.2833333333356, 1131.7500000000016, 1138.9166666666695, 1109.9500000000023, 1137.1166666666688, 1146.450000000002, 1139.3000000000025, 1135.383333333336, 1134.391666666669, 1130.2500000000025, 1119.6500000000021, 1130.4916666666693, 1139.1666666666692, 1134.2416666666688, 1125.7500000000025, 1137.825000000002, 1144.8916666666698, 1144.6916666666693, 1149.883333333336, 1158.1166666666688, 1146.7333333333358, 1151.0250000000026, 1152.5166666666694, 1141.8000000000025, 1141.6000000000022, 1146.700000000002, 1140.6750000000018, 1143.8916666666685, 1154.2583333333353, 1142.2500000000023, 1144.8500000000024, 1146.5333333333365, 1144.5750000000023, 1142.5500000000022, 1142.7083333333355, 1148.3916666666694, 1130.5833333333358, 1140.600000000002, 1115.2250000000026, 1151.1250000000027, 1150.8833333333355, 1140.9250000000022, 1149.5583333333363, 1140.0500000000025, 1144.8333333333355, 1140.5416666666695, 1135.3000000000022, 1138.7666666666687, 1140.300000000002, 1131.425000000002, 1139.750000000002, 1133.0833333333353, 1137.7500000000023, 1132.1000000000026, 1131.0583333333361, 1137.4583333333358, 1145.4583333333358, 1151.558333333336, 1137.5333333333353, 1128.500000000002, 1154.8500000000024, 1141.4500000000023, 1141.3250000000028, 1144.5083333333355, 1145.7583333333355, 1143.8916666666694, 1129.6083333333356, 1125.5666666666689, 1136.9833333333358, 1133.3750000000025, 1128.8333333333358, 1126.800000000002, 1133.8750000000016, 1139.3333333333362, 1114.2833333333358, 1139.683333333335, 1128.1916666666693, 1139.7000000000023, 1116.250000000002, 1123.4833333333356, 1126.4583333333353, 1134.616666666669, 1128.0916666666685, 1136.8583333333354, 1116.2000000000016, 1137.1916666666684, 1136.1083333333356, 1148.7333333333356, 1132.316666666669, 1124.566666666669, 1130.0166666666687, 1137.5250000000024, 1109.808333333335, 1123.2166666666687, 1114.9083333333358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24112933061642444, "mean_inference_ms": 2.0446741760657074, "mean_action_processing_ms": 0.09073753251046592, "mean_env_wait_ms": 1.53125125591363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00648808479309082, "StateBufferConnector_ms": 0.0033173561096191406, "ViewRequirementAgentConnector_ms": 0.08603310585021973}, "num_episodes": 27, "episode_return_max": 1158.1166666666688, "episode_return_min": 1109.808333333335, "episode_return_mean": 1136.9776666666692, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 174900, "num_agent_steps_trained": 174600, "num_env_steps_sampled": 174900, "num_env_steps_trained": 174600, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 243.34232799163587, "num_env_steps_trained_throughput_per_sec": 229.02807340389256, "timesteps_total": 174900, "num_env_steps_sampled_lifetime": 174900, "num_agent_steps_sampled_lifetime": 174900, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 174900, "timers": {"training_iteration_time_ms": 10389.488, "restore_workers_time_ms": 0.014, "training_step_time_ms": 618.109, "sample_time_ms": 602.649, "synch_weights_time_ms": 14.002}, "counters": {"num_env_steps_sampled": 174900, "num_env_steps_trained": 174600, "num_agent_steps_sampled": 174900, "num_agent_steps_trained": 174600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1166, "num_samples_added_to_queue": 174900}, "done": false, "training_iteration": 69, "trial_id": "27800_00000", "date": "2024-10-12_15-39-44", "timestamp": 1728743984, "time_this_iter_s": 10.490769147872925, "time_total_s": 713.1857750415802, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b45f60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 713.1857750415802, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 16.493333333333332, "ram_util_percent": 39.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 69026.421875, "policy_loss": 57739.5078125, "entropy": 6.707842826843262, "entropy_coeff": 0.01, "var_gnorm": 17.012447357177734, "vf_loss": 1130704.0, "vf_explained_var": 0.4054931402206421}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 591.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 177450, "num_env_steps_trained": 177300, "num_agent_steps_sampled": 177450, "num_agent_steps_trained": 177300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1183, "num_samples_added_to_queue": 177300, "learner_queue": {"size_count": 591, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 64.537, "learner_load_time_ms": 0.353, "learner_load_wait_time_ms": 1161.658, "learner_dequeue_time_ms": 9882.43}}, "env_runners": {"episode_reward_max": 1158.1166666666688, "episode_reward_min": 1109.808333333335, "episode_reward_mean": 1138.002666666669, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1109.808333333335}, "policy_reward_max": {"default_policy": 1158.1166666666688}, "policy_reward_mean": {"default_policy": 1138.002666666669}, "custom_metrics": {"num_consolidated_mean": 2.9693000000000005, "num_consolidated_min": 2.91, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0004, "num_overloaded_min": 0.0, "num_overloaded_max": 0.01, "num_moves_mean": 1.193, "num_moves_min": 0.89, "num_moves_max": 1.71, "mean_accuracy_mean": 42.22904333333335, "mean_accuracy_min": 42.05633333333335, "mean_accuracy_max": 42.38566666666669, "num_model_switches_mean": 1.0556, "num_model_switches_min": 0.71, "num_model_switches_max": 1.42, "num_slav_mean": 0.08575883333333335, "num_slav_min": 0.08195000000000001, "num_slav_max": 0.0916166666666667, "cpu_conserved_cost_mean": 7.878599999999999, "cpu_conserved_cost_min": 7.64, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5112495457927692, "mean_cluster_cpu_util_min": 0.5059279135640743, "mean_cluster_cpu_util_max": 0.5164780319222284, "mean_cluster_mem_util_mean": 0.3339974776112977, "mean_cluster_mem_util_min": 0.33114069092827003, "mean_cluster_mem_util_max": 0.3355346782700422, "reward_consolidation_mean_mean": 6.183333333333333, "reward_consolidation_mean_min": 6.041666666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": -0.0006666666666666666, "reward_illegal_mean_min": -0.016666666666666666, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.482750000000021, "reward_accuracy_mean_min": 6.2583333333333515, "reward_accuracy_mean_max": 6.6666666666666865, "reward_sla_mean_mean": -1.2853900000000003, "reward_sla_mean_min": -1.3742499999999997, "reward_sla_mean_max": -1.22925, "reward_consolidation_sum_mean": 618.3333333333333, "reward_consolidation_sum_min": 604.1666666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": -0.06666666666666667, "reward_illegal_sum_min": -1.6666666666666665, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 648.2750000000019, "reward_accuracy_sum_min": 625.8333333333352, "reward_accuracy_sum_max": 666.6666666666687, "reward_sla_sum_mean": -128.539, "reward_sla_sum_min": -137.42499999999998, "reward_sla_sum_max": -122.925, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2882.0, "global_timestep_min": 1200, "global_timestep_max": 4500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1158.1166666666688, 1146.7333333333358, 1151.0250000000026, 1152.5166666666694, 1141.8000000000025, 1141.6000000000022, 1146.700000000002, 1140.6750000000018, 1143.8916666666685, 1154.2583333333353, 1142.2500000000023, 1144.8500000000024, 1146.5333333333365, 1144.5750000000023, 1142.5500000000022, 1142.7083333333355, 1148.3916666666694, 1130.5833333333358, 1140.600000000002, 1115.2250000000026, 1151.1250000000027, 1150.8833333333355, 1140.9250000000022, 1149.5583333333363, 1140.0500000000025, 1144.8333333333355, 1140.5416666666695, 1135.3000000000022, 1138.7666666666687, 1140.300000000002, 1131.425000000002, 1139.750000000002, 1133.0833333333353, 1137.7500000000023, 1132.1000000000026, 1131.0583333333361, 1137.4583333333358, 1145.4583333333358, 1151.558333333336, 1137.5333333333353, 1128.500000000002, 1154.8500000000024, 1141.4500000000023, 1141.3250000000028, 1144.5083333333355, 1145.7583333333355, 1143.8916666666694, 1129.6083333333356, 1125.5666666666689, 1136.9833333333358, 1133.3750000000025, 1128.8333333333358, 1126.800000000002, 1133.8750000000016, 1139.3333333333362, 1114.2833333333358, 1139.683333333335, 1128.1916666666693, 1139.7000000000023, 1116.250000000002, 1123.4833333333356, 1126.4583333333353, 1134.616666666669, 1128.0916666666685, 1136.8583333333354, 1116.2000000000016, 1137.1916666666684, 1136.1083333333356, 1148.7333333333356, 1132.316666666669, 1124.566666666669, 1130.0166666666687, 1137.5250000000024, 1109.808333333335, 1123.2166666666687, 1114.9083333333358, 1133.3916666666687, 1126.4500000000025, 1135.5500000000027, 1136.0500000000025, 1138.9666666666692, 1139.141666666669, 1151.9500000000023, 1155.183333333336, 1137.4916666666682, 1130.2416666666693, 1139.966666666669, 1127.8416666666683, 1134.7333333333354, 1148.4583333333355, 1145.2416666666688, 1152.5416666666692, 1138.6500000000026, 1128.7916666666686, 1142.0500000000025, 1144.0166666666694, 1139.275000000002, 1144.2166666666694, 1148.8750000000025, 1143.283333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1158.1166666666688, 1146.7333333333358, 1151.0250000000026, 1152.5166666666694, 1141.8000000000025, 1141.6000000000022, 1146.700000000002, 1140.6750000000018, 1143.8916666666685, 1154.2583333333353, 1142.2500000000023, 1144.8500000000024, 1146.5333333333365, 1144.5750000000023, 1142.5500000000022, 1142.7083333333355, 1148.3916666666694, 1130.5833333333358, 1140.600000000002, 1115.2250000000026, 1151.1250000000027, 1150.8833333333355, 1140.9250000000022, 1149.5583333333363, 1140.0500000000025, 1144.8333333333355, 1140.5416666666695, 1135.3000000000022, 1138.7666666666687, 1140.300000000002, 1131.425000000002, 1139.750000000002, 1133.0833333333353, 1137.7500000000023, 1132.1000000000026, 1131.0583333333361, 1137.4583333333358, 1145.4583333333358, 1151.558333333336, 1137.5333333333353, 1128.500000000002, 1154.8500000000024, 1141.4500000000023, 1141.3250000000028, 1144.5083333333355, 1145.7583333333355, 1143.8916666666694, 1129.6083333333356, 1125.5666666666689, 1136.9833333333358, 1133.3750000000025, 1128.8333333333358, 1126.800000000002, 1133.8750000000016, 1139.3333333333362, 1114.2833333333358, 1139.683333333335, 1128.1916666666693, 1139.7000000000023, 1116.250000000002, 1123.4833333333356, 1126.4583333333353, 1134.616666666669, 1128.0916666666685, 1136.8583333333354, 1116.2000000000016, 1137.1916666666684, 1136.1083333333356, 1148.7333333333356, 1132.316666666669, 1124.566666666669, 1130.0166666666687, 1137.5250000000024, 1109.808333333335, 1123.2166666666687, 1114.9083333333358, 1133.3916666666687, 1126.4500000000025, 1135.5500000000027, 1136.0500000000025, 1138.9666666666692, 1139.141666666669, 1151.9500000000023, 1155.183333333336, 1137.4916666666682, 1130.2416666666693, 1139.966666666669, 1127.8416666666683, 1134.7333333333354, 1148.4583333333355, 1145.2416666666688, 1152.5416666666692, 1138.6500000000026, 1128.7916666666686, 1142.0500000000025, 1144.0166666666694, 1139.275000000002, 1144.2166666666694, 1148.8750000000025, 1143.283333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24118048680365942, "mean_inference_ms": 2.0448172485236933, "mean_action_processing_ms": 0.09074517991559755, "mean_env_wait_ms": 1.5314673411442328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006525993347167969, "StateBufferConnector_ms": 0.003343343734741211, "ViewRequirementAgentConnector_ms": 0.08617949485778809}, "num_episodes": 24, "episode_return_max": 1158.1166666666688, "episode_return_min": 1109.808333333335, "episode_return_mean": 1138.002666666669, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 177450, "num_agent_steps_trained": 177300, "num_env_steps_sampled": 177450, "num_env_steps_trained": 177300, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 243.91913355563082, "num_env_steps_trained_throughput_per_sec": 258.2673178824326, "timesteps_total": 177450, "num_env_steps_sampled_lifetime": 177450, "num_agent_steps_sampled_lifetime": 177450, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 177450, "timers": {"training_iteration_time_ms": 10387.341, "restore_workers_time_ms": 0.012, "training_step_time_ms": 606.565, "sample_time_ms": 591.254, "synch_weights_time_ms": 13.722}, "counters": {"num_env_steps_sampled": 177450, "num_env_steps_trained": 177300, "num_agent_steps_sampled": 177450, "num_agent_steps_trained": 177300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1183, "num_samples_added_to_queue": 177300}, "done": false, "training_iteration": 70, "trial_id": "27800_00000", "date": "2024-10-12_15-39-55", "timestamp": 1728743995, "time_this_iter_s": 10.464348316192627, "time_total_s": 723.6501233577728, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a945ee0940>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 723.6501233577728, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 16.31333333333333, "ram_util_percent": 39.839999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 59179.73828125, "policy_loss": 49434.37890625, "entropy": 6.50330924987793, "entropy_coeff": 0.01, "var_gnorm": 17.061649322509766, "vf_loss": 976487.25, "vf_explained_var": 0.4298609495162964}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 599.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 179850, "num_env_steps_trained": 179700, "num_agent_steps_sampled": 179850, "num_agent_steps_trained": 179700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1199, "num_samples_added_to_queue": 179700, "learner_queue": {"size_count": 599, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.699, "learner_load_time_ms": 0.322, "learner_load_wait_time_ms": 1186.922, "learner_dequeue_time_ms": 9881.396}}, "env_runners": {"episode_reward_max": 1192.8750000000027, "episode_reward_min": 1109.808333333335, "episode_reward_mean": 1144.5930833333357, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1109.808333333335}, "policy_reward_max": {"default_policy": 1192.8750000000027}, "policy_reward_mean": {"default_policy": 1144.5930833333357}, "custom_metrics": {"num_consolidated_mean": 2.975000000000001, "num_consolidated_min": 2.91, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0002, "num_overloaded_min": 0.0, "num_overloaded_max": 0.01, "num_moves_mean": 1.1603999999999999, "num_moves_min": 0.89, "num_moves_max": 1.54, "mean_accuracy_mean": 42.25919000000002, "mean_accuracy_min": 42.05633333333335, "mean_accuracy_max": 42.575666666666685, "num_model_switches_mean": 0.9632000000000002, "num_model_switches_min": 0.56, "num_model_switches_max": 1.32, "num_slav_mean": 0.084985, "num_slav_min": 0.08128333333333333, "num_slav_max": 0.0916166666666667, "cpu_conserved_cost_mean": 7.901199999999999, "cpu_conserved_cost_min": 7.64, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5123856768311845, "mean_cluster_cpu_util_min": 0.5061406795826437, "mean_cluster_cpu_util_max": 0.522310787828645, "mean_cluster_mem_util_mean": 0.33439725759924227, "mean_cluster_mem_util_min": 0.33114069092827003, "mean_cluster_mem_util_max": 0.3369148206751055, "reward_consolidation_mean_mean": 6.196666666666666, "reward_consolidation_mean_min": 6.0625, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": -0.0003333333333333333, "reward_illegal_mean_min": -0.016666666666666666, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.5240000000000204, "reward_accuracy_mean_min": 6.2583333333333515, "reward_accuracy_mean_max": 6.941666666666691, "reward_sla_mean_mean": -1.2744025, "reward_sla_mean_min": -1.3742499999999997, "reward_sla_mean_max": -1.21925, "reward_consolidation_sum_mean": 619.6666666666667, "reward_consolidation_sum_min": 606.25, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": -0.03333333333333333, "reward_illegal_sum_min": -1.6666666666666665, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 652.400000000002, "reward_accuracy_sum_min": 625.8333333333352, "reward_accuracy_sum_max": 694.1666666666691, "reward_sla_sum_mean": -127.44024999999998, "reward_sla_sum_min": -137.42499999999998, "reward_sla_sum_max": -121.925, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3683.0, "global_timestep_min": 2000, "global_timestep_max": 5300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1140.0500000000025, 1144.8333333333355, 1140.5416666666695, 1135.3000000000022, 1138.7666666666687, 1140.300000000002, 1131.425000000002, 1139.750000000002, 1133.0833333333353, 1137.7500000000023, 1132.1000000000026, 1131.0583333333361, 1137.4583333333358, 1145.4583333333358, 1151.558333333336, 1137.5333333333353, 1128.500000000002, 1154.8500000000024, 1141.4500000000023, 1141.3250000000028, 1144.5083333333355, 1145.7583333333355, 1143.8916666666694, 1129.6083333333356, 1125.5666666666689, 1136.9833333333358, 1133.3750000000025, 1128.8333333333358, 1126.800000000002, 1133.8750000000016, 1139.3333333333362, 1114.2833333333358, 1139.683333333335, 1128.1916666666693, 1139.7000000000023, 1116.250000000002, 1123.4833333333356, 1126.4583333333353, 1134.616666666669, 1128.0916666666685, 1136.8583333333354, 1116.2000000000016, 1137.1916666666684, 1136.1083333333356, 1148.7333333333356, 1132.316666666669, 1124.566666666669, 1130.0166666666687, 1137.5250000000024, 1109.808333333335, 1123.2166666666687, 1114.9083333333358, 1133.3916666666687, 1126.4500000000025, 1135.5500000000027, 1136.0500000000025, 1138.9666666666692, 1139.141666666669, 1151.9500000000023, 1155.183333333336, 1137.4916666666682, 1130.2416666666693, 1139.966666666669, 1127.8416666666683, 1134.7333333333354, 1148.4583333333355, 1145.2416666666688, 1152.5416666666692, 1138.6500000000026, 1128.7916666666686, 1142.0500000000025, 1144.0166666666694, 1139.275000000002, 1144.2166666666694, 1148.8750000000025, 1143.283333333336, 1153.5416666666695, 1164.5666666666696, 1164.5250000000021, 1166.9750000000026, 1186.4750000000029, 1175.5916666666694, 1185.2250000000029, 1181.1833333333354, 1149.7250000000026, 1160.708333333336, 1158.1333333333355, 1168.0666666666693, 1172.16666666667, 1175.9916666666695, 1187.7500000000027, 1192.8750000000027, 1163.9000000000024, 1163.858333333336, 1165.4583333333358, 1170.4666666666692, 1170.4000000000017, 1179.433333333336, 1187.6500000000021, 1182.4500000000028], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1140.0500000000025, 1144.8333333333355, 1140.5416666666695, 1135.3000000000022, 1138.7666666666687, 1140.300000000002, 1131.425000000002, 1139.750000000002, 1133.0833333333353, 1137.7500000000023, 1132.1000000000026, 1131.0583333333361, 1137.4583333333358, 1145.4583333333358, 1151.558333333336, 1137.5333333333353, 1128.500000000002, 1154.8500000000024, 1141.4500000000023, 1141.3250000000028, 1144.5083333333355, 1145.7583333333355, 1143.8916666666694, 1129.6083333333356, 1125.5666666666689, 1136.9833333333358, 1133.3750000000025, 1128.8333333333358, 1126.800000000002, 1133.8750000000016, 1139.3333333333362, 1114.2833333333358, 1139.683333333335, 1128.1916666666693, 1139.7000000000023, 1116.250000000002, 1123.4833333333356, 1126.4583333333353, 1134.616666666669, 1128.0916666666685, 1136.8583333333354, 1116.2000000000016, 1137.1916666666684, 1136.1083333333356, 1148.7333333333356, 1132.316666666669, 1124.566666666669, 1130.0166666666687, 1137.5250000000024, 1109.808333333335, 1123.2166666666687, 1114.9083333333358, 1133.3916666666687, 1126.4500000000025, 1135.5500000000027, 1136.0500000000025, 1138.9666666666692, 1139.141666666669, 1151.9500000000023, 1155.183333333336, 1137.4916666666682, 1130.2416666666693, 1139.966666666669, 1127.8416666666683, 1134.7333333333354, 1148.4583333333355, 1145.2416666666688, 1152.5416666666692, 1138.6500000000026, 1128.7916666666686, 1142.0500000000025, 1144.0166666666694, 1139.275000000002, 1144.2166666666694, 1148.8750000000025, 1143.283333333336, 1153.5416666666695, 1164.5666666666696, 1164.5250000000021, 1166.9750000000026, 1186.4750000000029, 1175.5916666666694, 1185.2250000000029, 1181.1833333333354, 1149.7250000000026, 1160.708333333336, 1158.1333333333355, 1168.0666666666693, 1172.16666666667, 1175.9916666666695, 1187.7500000000027, 1192.8750000000027, 1163.9000000000024, 1163.858333333336, 1165.4583333333358, 1170.4666666666692, 1170.4000000000017, 1179.433333333336, 1187.6500000000021, 1182.4500000000028]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24127510406927727, "mean_inference_ms": 2.0467606320250313, "mean_action_processing_ms": 0.09077750230877214, "mean_env_wait_ms": 1.5321640877034037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006543874740600586, "StateBufferConnector_ms": 0.0033254623413085938, "ViewRequirementAgentConnector_ms": 0.08588790893554688}, "num_episodes": 24, "episode_return_max": 1192.8750000000027, "episode_return_min": 1109.808333333335, "episode_return_mean": 1144.5930833333357, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 179850, "num_agent_steps_trained": 179700, "num_env_steps_sampled": 179850, "num_env_steps_trained": 179700, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 239.5335430924248, "num_env_steps_trained_throughput_per_sec": 239.5335430924248, "timesteps_total": 179850, "num_env_steps_sampled_lifetime": 179850, "num_agent_steps_sampled_lifetime": 179850, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 179850, "timers": {"training_iteration_time_ms": 10380.854, "restore_workers_time_ms": 0.012, "training_step_time_ms": 631.578, "sample_time_ms": 616.722, "synch_weights_time_ms": 13.414}, "counters": {"num_env_steps_sampled": 179850, "num_env_steps_trained": 179700, "num_agent_steps_sampled": 179850, "num_agent_steps_trained": 179700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1199, "num_samples_added_to_queue": 179700}, "done": false, "training_iteration": 71, "trial_id": "27800_00000", "date": "2024-10-12_15-40-05", "timestamp": 1728744005, "time_this_iter_s": 10.038494348526001, "time_total_s": 733.6886177062988, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a945ee00a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 733.6886177062988, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 16.62857142857143, "ram_util_percent": 40.02142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 56597.26171875, "policy_loss": 45624.6015625, "entropy": 6.167394638061523, "entropy_coeff": 0.01, "var_gnorm": 17.11051368713379, "vf_loss": 1099116.5, "vf_explained_var": 0.44289225339889526}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 607.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 182400, "num_env_steps_trained": 182100, "num_agent_steps_sampled": 182400, "num_agent_steps_trained": 182100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1216, "num_samples_added_to_queue": 182400, "learner_queue": {"size_count": 607, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.247, "learner_load_time_ms": 0.298, "learner_load_wait_time_ms": 1182.717, "learner_dequeue_time_ms": 9866.045}}, "env_runners": {"episode_reward_max": 1225.758333333335, "episode_reward_min": 1109.808333333335, "episode_reward_mean": 1162.675666666669, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1109.808333333335}, "policy_reward_max": {"default_policy": 1225.758333333335}, "policy_reward_mean": {"default_policy": 1162.675666666669}, "custom_metrics": {"num_consolidated_mean": 2.9808000000000003, "num_consolidated_min": 2.93, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0002, "num_overloaded_min": 0.0, "num_overloaded_max": 0.01, "num_moves_mean": 1.1454, "num_moves_min": 0.86, "num_moves_max": 1.52, "mean_accuracy_mean": 42.37908000000002, "mean_accuracy_min": 42.05633333333335, "mean_accuracy_max": 42.829000000000015, "num_model_switches_mean": 0.8372999999999999, "num_model_switches_min": 0.52, "num_model_switches_max": 1.25, "num_slav_mean": 0.08425216666666666, "num_slav_min": 0.08128333333333333, "num_slav_max": 0.08848333333333334, "cpu_conserved_cost_mean": 7.923599999999999, "cpu_conserved_cost_min": 7.72, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.516542440869894, "mean_cluster_cpu_util_min": 0.5061406795826437, "mean_cluster_cpu_util_max": 0.5350719571612429, "mean_cluster_mem_util_mean": 0.33515296082515283, "mean_cluster_mem_util_min": 0.3319299841772152, "mean_cluster_mem_util_max": 0.3381260548523208, "reward_consolidation_mean_mean": 6.20875, "reward_consolidation_mean_min": 6.104166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": -0.0003333333333333333, "reward_illegal_mean_min": -0.016666666666666666, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.681750000000021, "reward_accuracy_mean_min": 6.2583333333333515, "reward_accuracy_mean_max": 7.275000000000025, "reward_sla_mean_mean": -1.26341, "reward_sla_mean_min": -1.32725, "reward_sla_mean_max": -1.21925, "reward_consolidation_sum_mean": 620.875, "reward_consolidation_sum_min": 610.4166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": -0.03333333333333333, "reward_illegal_sum_min": -1.6666666666666665, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 668.1750000000022, "reward_accuracy_sum_min": 625.8333333333352, "reward_accuracy_sum_max": 727.5000000000025, "reward_sla_sum_mean": -126.34099999999998, "reward_sla_sum_min": -132.725, "reward_sla_sum_max": -121.925, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4582.0, "global_timestep_min": 2900, "global_timestep_max": 6200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1128.8333333333358, 1126.800000000002, 1133.8750000000016, 1139.3333333333362, 1114.2833333333358, 1139.683333333335, 1128.1916666666693, 1139.7000000000023, 1116.250000000002, 1123.4833333333356, 1126.4583333333353, 1134.616666666669, 1128.0916666666685, 1136.8583333333354, 1116.2000000000016, 1137.1916666666684, 1136.1083333333356, 1148.7333333333356, 1132.316666666669, 1124.566666666669, 1130.0166666666687, 1137.5250000000024, 1109.808333333335, 1123.2166666666687, 1114.9083333333358, 1133.3916666666687, 1126.4500000000025, 1135.5500000000027, 1136.0500000000025, 1138.9666666666692, 1139.141666666669, 1151.9500000000023, 1155.183333333336, 1137.4916666666682, 1130.2416666666693, 1139.966666666669, 1127.8416666666683, 1134.7333333333354, 1148.4583333333355, 1145.2416666666688, 1152.5416666666692, 1138.6500000000026, 1128.7916666666686, 1142.0500000000025, 1144.0166666666694, 1139.275000000002, 1144.2166666666694, 1148.8750000000025, 1143.283333333336, 1153.5416666666695, 1164.5666666666696, 1164.5250000000021, 1166.9750000000026, 1186.4750000000029, 1175.5916666666694, 1185.2250000000029, 1181.1833333333354, 1149.7250000000026, 1160.708333333336, 1158.1333333333355, 1168.0666666666693, 1172.16666666667, 1175.9916666666695, 1187.7500000000027, 1192.8750000000027, 1163.9000000000024, 1163.858333333336, 1165.4583333333358, 1170.4666666666692, 1170.4000000000017, 1179.433333333336, 1187.6500000000021, 1182.4500000000028, 1196.8833333333355, 1202.7166666666692, 1178.9833333333356, 1193.741666666669, 1209.208333333336, 1209.3750000000025, 1210.36666666667, 1216.0083333333364, 1225.758333333335, 1174.3583333333358, 1194.8916666666696, 1204.1583333333353, 1214.7750000000024, 1211.8083333333363, 1206.3500000000033, 1212.558333333336, 1213.533333333336, 1213.0416666666695, 1185.9083333333353, 1202.6833333333363, 1202.033333333336, 1202.8583333333363, 1203.7416666666693, 1211.7666666666692, 1215.7416666666693, 1225.741666666669, 1212.0500000000027], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1128.8333333333358, 1126.800000000002, 1133.8750000000016, 1139.3333333333362, 1114.2833333333358, 1139.683333333335, 1128.1916666666693, 1139.7000000000023, 1116.250000000002, 1123.4833333333356, 1126.4583333333353, 1134.616666666669, 1128.0916666666685, 1136.8583333333354, 1116.2000000000016, 1137.1916666666684, 1136.1083333333356, 1148.7333333333356, 1132.316666666669, 1124.566666666669, 1130.0166666666687, 1137.5250000000024, 1109.808333333335, 1123.2166666666687, 1114.9083333333358, 1133.3916666666687, 1126.4500000000025, 1135.5500000000027, 1136.0500000000025, 1138.9666666666692, 1139.141666666669, 1151.9500000000023, 1155.183333333336, 1137.4916666666682, 1130.2416666666693, 1139.966666666669, 1127.8416666666683, 1134.7333333333354, 1148.4583333333355, 1145.2416666666688, 1152.5416666666692, 1138.6500000000026, 1128.7916666666686, 1142.0500000000025, 1144.0166666666694, 1139.275000000002, 1144.2166666666694, 1148.8750000000025, 1143.283333333336, 1153.5416666666695, 1164.5666666666696, 1164.5250000000021, 1166.9750000000026, 1186.4750000000029, 1175.5916666666694, 1185.2250000000029, 1181.1833333333354, 1149.7250000000026, 1160.708333333336, 1158.1333333333355, 1168.0666666666693, 1172.16666666667, 1175.9916666666695, 1187.7500000000027, 1192.8750000000027, 1163.9000000000024, 1163.858333333336, 1165.4583333333358, 1170.4666666666692, 1170.4000000000017, 1179.433333333336, 1187.6500000000021, 1182.4500000000028, 1196.8833333333355, 1202.7166666666692, 1178.9833333333356, 1193.741666666669, 1209.208333333336, 1209.3750000000025, 1210.36666666667, 1216.0083333333364, 1225.758333333335, 1174.3583333333358, 1194.8916666666696, 1204.1583333333353, 1214.7750000000024, 1211.8083333333363, 1206.3500000000033, 1212.558333333336, 1213.533333333336, 1213.0416666666695, 1185.9083333333353, 1202.6833333333363, 1202.033333333336, 1202.8583333333363, 1203.7416666666693, 1211.7666666666692, 1215.7416666666693, 1225.741666666669, 1212.0500000000027]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24130643313240285, "mean_inference_ms": 2.0453300737646747, "mean_action_processing_ms": 0.09077132040981446, "mean_env_wait_ms": 1.532098249725267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006983757019042969, "StateBufferConnector_ms": 0.0033774375915527344, "ViewRequirementAgentConnector_ms": 0.08661627769470215}, "num_episodes": 27, "episode_return_max": 1225.758333333335, "episode_return_min": 1109.808333333335, "episode_return_mean": 1162.675666666669, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 182400, "num_agent_steps_trained": 182100, "num_env_steps_sampled": 182400, "num_env_steps_trained": 182100, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 243.7958691121212, "num_env_steps_trained_throughput_per_sec": 229.4549356349376, "timesteps_total": 182400, "num_env_steps_sampled_lifetime": 182400, "num_agent_steps_sampled_lifetime": 182400, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 182400, "timers": {"training_iteration_time_ms": 10371.249, "restore_workers_time_ms": 0.012, "training_step_time_ms": 611.406, "sample_time_ms": 595.798, "synch_weights_time_ms": 14.019}, "counters": {"num_env_steps_sampled": 182400, "num_env_steps_trained": 182100, "num_agent_steps_sampled": 182400, "num_agent_steps_trained": 182100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1216, "num_samples_added_to_queue": 182400}, "done": false, "training_iteration": 72, "trial_id": "27800_00000", "date": "2024-10-12_15-40-15", "timestamp": 1728744015, "time_this_iter_s": 10.471938133239746, "time_total_s": 744.1605558395386, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a945ee2590>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 744.1605558395386, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 16.56666666666667, "ram_util_percent": 40.14666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 48815.9765625, "policy_loss": 36997.53125, "entropy": 5.852044105529785, "entropy_coeff": 0.01, "var_gnorm": 17.165294647216797, "vf_loss": 1183600.0, "vf_explained_var": 0.4482960104942322}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 615.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 184800, "num_env_steps_trained": 184500, "num_agent_steps_sampled": 184800, "num_agent_steps_trained": 184500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1232, "num_samples_added_to_queue": 184800, "learner_queue": {"size_count": 615, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.234, "learner_load_time_ms": 0.322, "learner_load_wait_time_ms": 1203.143, "learner_dequeue_time_ms": 9880.755}}, "env_runners": {"episode_reward_max": 1233.8750000000027, "episode_reward_min": 1114.9083333333358, "episode_reward_mean": 1186.0299166666691, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1114.9083333333358}, "policy_reward_max": {"default_policy": 1233.8750000000027}, "policy_reward_mean": {"default_policy": 1186.0299166666691}, "custom_metrics": {"num_consolidated_mean": 2.9848000000000003, "num_consolidated_min": 2.95, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.01, "num_moves_mean": 1.1033, "num_moves_min": 0.86, "num_moves_max": 1.44, "mean_accuracy_mean": 42.541656666666675, "mean_accuracy_min": 42.06900000000002, "mean_accuracy_max": 42.87333333333335, "num_model_switches_mean": 0.7034000000000001, "num_model_switches_min": 0.35, "num_model_switches_max": 1.07, "num_slav_mean": 0.08357433333333335, "num_slav_min": 0.08116666666666666, "num_slav_max": 0.08763333333333334, "cpu_conserved_cost_mean": 7.939400000000001, "cpu_conserved_cost_min": 7.8, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5221364697260276, "mean_cluster_cpu_util_min": 0.5061406795826437, "mean_cluster_cpu_util_max": 0.5370656140834713, "mean_cluster_mem_util_mean": 0.33601153715125287, "mean_cluster_mem_util_min": 0.33226424050632913, "mean_cluster_mem_util_max": 0.33822257383966237, "reward_consolidation_mean_mean": 6.217708333333332, "reward_consolidation_mean_min": 6.125, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": -0.00016666666666666666, "reward_illegal_mean_min": -0.016666666666666666, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.896250000000024, "reward_accuracy_mean_min": 6.275000000000018, "reward_accuracy_mean_max": 7.33333333333336, "reward_sla_mean_mean": -1.2534925, "reward_sla_mean_min": -1.3144999999999998, "reward_sla_mean_max": -1.2175, "reward_consolidation_sum_mean": 621.7708333333333, "reward_consolidation_sum_min": 612.5, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": -0.016666666666666666, "reward_illegal_sum_min": -1.6666666666666665, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 689.6250000000025, "reward_accuracy_sum_min": 627.5000000000018, "reward_accuracy_sum_max": 733.333333333336, "reward_sla_sum_mean": -125.34925000000001, "reward_sla_sum_min": -131.45, "reward_sla_sum_max": -121.75, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5383.0, "global_timestep_min": 3700, "global_timestep_max": 7000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1114.9083333333358, 1133.3916666666687, 1126.4500000000025, 1135.5500000000027, 1136.0500000000025, 1138.9666666666692, 1139.141666666669, 1151.9500000000023, 1155.183333333336, 1137.4916666666682, 1130.2416666666693, 1139.966666666669, 1127.8416666666683, 1134.7333333333354, 1148.4583333333355, 1145.2416666666688, 1152.5416666666692, 1138.6500000000026, 1128.7916666666686, 1142.0500000000025, 1144.0166666666694, 1139.275000000002, 1144.2166666666694, 1148.8750000000025, 1143.283333333336, 1153.5416666666695, 1164.5666666666696, 1164.5250000000021, 1166.9750000000026, 1186.4750000000029, 1175.5916666666694, 1185.2250000000029, 1181.1833333333354, 1149.7250000000026, 1160.708333333336, 1158.1333333333355, 1168.0666666666693, 1172.16666666667, 1175.9916666666695, 1187.7500000000027, 1192.8750000000027, 1163.9000000000024, 1163.858333333336, 1165.4583333333358, 1170.4666666666692, 1170.4000000000017, 1179.433333333336, 1187.6500000000021, 1182.4500000000028, 1196.8833333333355, 1202.7166666666692, 1178.9833333333356, 1193.741666666669, 1209.208333333336, 1209.3750000000025, 1210.36666666667, 1216.0083333333364, 1225.758333333335, 1174.3583333333358, 1194.8916666666696, 1204.1583333333353, 1214.7750000000024, 1211.8083333333363, 1206.3500000000033, 1212.558333333336, 1213.533333333336, 1213.0416666666695, 1185.9083333333353, 1202.6833333333363, 1202.033333333336, 1202.8583333333363, 1203.7416666666693, 1211.7666666666692, 1215.7416666666693, 1225.741666666669, 1212.0500000000027, 1223.041666666669, 1230.5500000000025, 1216.76666666667, 1228.8833333333357, 1231.9666666666692, 1224.9750000000022, 1228.625000000003, 1228.5833333333364, 1224.1666666666695, 1215.7000000000023, 1224.4583333333358, 1222.1416666666698, 1232.6000000000026, 1228.625000000002, 1229.1583333333356, 1233.8416666666683, 1229.9166666666692, 1225.466666666669, 1215.6583333333356, 1231.066666666669, 1227.8833333333357, 1233.8750000000027, 1231.7166666666692, 1227.9000000000028], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1114.9083333333358, 1133.3916666666687, 1126.4500000000025, 1135.5500000000027, 1136.0500000000025, 1138.9666666666692, 1139.141666666669, 1151.9500000000023, 1155.183333333336, 1137.4916666666682, 1130.2416666666693, 1139.966666666669, 1127.8416666666683, 1134.7333333333354, 1148.4583333333355, 1145.2416666666688, 1152.5416666666692, 1138.6500000000026, 1128.7916666666686, 1142.0500000000025, 1144.0166666666694, 1139.275000000002, 1144.2166666666694, 1148.8750000000025, 1143.283333333336, 1153.5416666666695, 1164.5666666666696, 1164.5250000000021, 1166.9750000000026, 1186.4750000000029, 1175.5916666666694, 1185.2250000000029, 1181.1833333333354, 1149.7250000000026, 1160.708333333336, 1158.1333333333355, 1168.0666666666693, 1172.16666666667, 1175.9916666666695, 1187.7500000000027, 1192.8750000000027, 1163.9000000000024, 1163.858333333336, 1165.4583333333358, 1170.4666666666692, 1170.4000000000017, 1179.433333333336, 1187.6500000000021, 1182.4500000000028, 1196.8833333333355, 1202.7166666666692, 1178.9833333333356, 1193.741666666669, 1209.208333333336, 1209.3750000000025, 1210.36666666667, 1216.0083333333364, 1225.758333333335, 1174.3583333333358, 1194.8916666666696, 1204.1583333333353, 1214.7750000000024, 1211.8083333333363, 1206.3500000000033, 1212.558333333336, 1213.533333333336, 1213.0416666666695, 1185.9083333333353, 1202.6833333333363, 1202.033333333336, 1202.8583333333363, 1203.7416666666693, 1211.7666666666692, 1215.7416666666693, 1225.741666666669, 1212.0500000000027, 1223.041666666669, 1230.5500000000025, 1216.76666666667, 1228.8833333333357, 1231.9666666666692, 1224.9750000000022, 1228.625000000003, 1228.5833333333364, 1224.1666666666695, 1215.7000000000023, 1224.4583333333358, 1222.1416666666698, 1232.6000000000026, 1228.625000000002, 1229.1583333333356, 1233.8416666666683, 1229.9166666666692, 1225.466666666669, 1215.6583333333356, 1231.066666666669, 1227.8833333333357, 1233.8750000000027, 1231.7166666666692, 1227.9000000000028]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24140293364347126, "mean_inference_ms": 2.047550725374934, "mean_action_processing_ms": 0.09080562363446781, "mean_env_wait_ms": 1.5327900018613707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069887638092041016, "StateBufferConnector_ms": 0.0033638477325439453, "ViewRequirementAgentConnector_ms": 0.0857694149017334}, "num_episodes": 24, "episode_return_max": 1233.8750000000027, "episode_return_min": 1114.9083333333358, "episode_return_mean": 1186.0299166666691, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184800, "num_agent_steps_trained": 184500, "num_env_steps_sampled": 184800, "num_env_steps_trained": 184500, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 236.05340447814712, "num_env_steps_trained_throughput_per_sec": 236.05340447814712, "timesteps_total": 184800, "num_env_steps_sampled_lifetime": 184800, "num_agent_steps_sampled_lifetime": 184800, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 184800, "timers": {"training_iteration_time_ms": 10362.203, "restore_workers_time_ms": 0.012, "training_step_time_ms": 642.127, "sample_time_ms": 626.512, "synch_weights_time_ms": 14.098}, "counters": {"num_env_steps_sampled": 184800, "num_env_steps_trained": 184500, "num_agent_steps_sampled": 184800, "num_agent_steps_trained": 184500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1232, "num_samples_added_to_queue": 184800}, "done": false, "training_iteration": 73, "trial_id": "27800_00000", "date": "2024-10-12_15-40-26", "timestamp": 1728744026, "time_this_iter_s": 10.179216384887695, "time_total_s": 754.3397722244263, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486c0220>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 754.3397722244263, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 16.335714285714285, "ram_util_percent": 40.342857142857135}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 38636.15234375, "policy_loss": 27715.12109375, "entropy": 5.381130218505859, "entropy_coeff": 0.01, "var_gnorm": 17.23671531677246, "vf_loss": 1093717.5, "vf_explained_var": 0.48224347829818726}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 624.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 187350, "num_env_steps_trained": 187200, "num_agent_steps_sampled": 187350, "num_agent_steps_trained": 187200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1249, "num_samples_added_to_queue": 187200, "learner_queue": {"size_count": 624, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.699, "learner_load_time_ms": 0.294, "learner_load_wait_time_ms": 1171.783, "learner_dequeue_time_ms": 9928.436}}, "env_runners": {"episode_reward_max": 1242.6000000000026, "episode_reward_min": 1143.283333333336, "episode_reward_mean": 1208.854083333336, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1143.283333333336}, "policy_reward_max": {"default_policy": 1242.6000000000026}, "policy_reward_mean": {"default_policy": 1208.854083333336}, "custom_metrics": {"num_consolidated_mean": 2.9870000000000005, "num_consolidated_min": 2.96, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 1.0117999999999998, "num_moves_min": 0.43, "num_moves_max": 1.44, "mean_accuracy_mean": 42.703916666666686, "mean_accuracy_min": 42.195666666666675, "mean_accuracy_max": 42.94933333333334, "num_model_switches_mean": 0.5675, "num_model_switches_min": 0.16, "num_model_switches_max": 1.0, "num_slav_mean": 0.08298616666666668, "num_slav_min": 0.08066666666666666, "num_slav_max": 0.08763333333333334, "cpu_conserved_cost_mean": 7.9479999999999995, "cpu_conserved_cost_min": 7.84, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5283039809707666, "mean_cluster_cpu_util_min": 0.5109540414138628, "mean_cluster_cpu_util_max": 0.5391404210332781, "mean_cluster_mem_util_mean": 0.33682788370253164, "mean_cluster_mem_util_min": 0.3345737078059072, "mean_cluster_mem_util_max": 0.3385221518987342, "reward_consolidation_mean_mean": 6.222916666666666, "reward_consolidation_mean_min": 6.166666666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 7.1104166666666915, "reward_accuracy_mean_min": 6.441666666666688, "reward_accuracy_mean_max": 7.433333333333361, "reward_sla_mean_mean": -1.2447925, "reward_sla_mean_min": -1.3144999999999998, "reward_sla_mean_max": -1.21, "reward_consolidation_sum_mean": 622.2916666666666, "reward_consolidation_sum_min": 616.6666666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 711.0416666666692, "reward_accuracy_sum_min": 644.1666666666688, "reward_accuracy_sum_max": 743.3333333333361, "reward_sla_sum_mean": -124.47924999999998, "reward_sla_sum_min": -131.45, "reward_sla_sum_max": -120.99999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6183.0, "global_timestep_min": 4500, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1143.283333333336, 1153.5416666666695, 1164.5666666666696, 1164.5250000000021, 1166.9750000000026, 1186.4750000000029, 1175.5916666666694, 1185.2250000000029, 1181.1833333333354, 1149.7250000000026, 1160.708333333336, 1158.1333333333355, 1168.0666666666693, 1172.16666666667, 1175.9916666666695, 1187.7500000000027, 1192.8750000000027, 1163.9000000000024, 1163.858333333336, 1165.4583333333358, 1170.4666666666692, 1170.4000000000017, 1179.433333333336, 1187.6500000000021, 1182.4500000000028, 1196.8833333333355, 1202.7166666666692, 1178.9833333333356, 1193.741666666669, 1209.208333333336, 1209.3750000000025, 1210.36666666667, 1216.0083333333364, 1225.758333333335, 1174.3583333333358, 1194.8916666666696, 1204.1583333333353, 1214.7750000000024, 1211.8083333333363, 1206.3500000000033, 1212.558333333336, 1213.533333333336, 1213.0416666666695, 1185.9083333333353, 1202.6833333333363, 1202.033333333336, 1202.8583333333363, 1203.7416666666693, 1211.7666666666692, 1215.7416666666693, 1225.741666666669, 1212.0500000000027, 1223.041666666669, 1230.5500000000025, 1216.76666666667, 1228.8833333333357, 1231.9666666666692, 1224.9750000000022, 1228.625000000003, 1228.5833333333364, 1224.1666666666695, 1215.7000000000023, 1224.4583333333358, 1222.1416666666698, 1232.6000000000026, 1228.625000000002, 1229.1583333333356, 1233.8416666666683, 1229.9166666666692, 1225.466666666669, 1215.6583333333356, 1231.066666666669, 1227.8833333333357, 1233.8750000000027, 1231.7166666666692, 1227.9000000000028, 1233.9833333333363, 1241.5416666666688, 1222.0250000000026, 1235.316666666669, 1236.5333333333363, 1234.7833333333363, 1233.5250000000033, 1239.1583333333356, 1224.2250000000026, 1236.0416666666692, 1230.9250000000022, 1237.1500000000021, 1236.7333333333358, 1236.0833333333362, 1231.6583333333365, 1230.7666666666696, 1234.1166666666695, 1228.1083333333356, 1236.4833333333358, 1231.9416666666696, 1231.5833333333362, 1235.4916666666695, 1242.6000000000026, 1235.625000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1143.283333333336, 1153.5416666666695, 1164.5666666666696, 1164.5250000000021, 1166.9750000000026, 1186.4750000000029, 1175.5916666666694, 1185.2250000000029, 1181.1833333333354, 1149.7250000000026, 1160.708333333336, 1158.1333333333355, 1168.0666666666693, 1172.16666666667, 1175.9916666666695, 1187.7500000000027, 1192.8750000000027, 1163.9000000000024, 1163.858333333336, 1165.4583333333358, 1170.4666666666692, 1170.4000000000017, 1179.433333333336, 1187.6500000000021, 1182.4500000000028, 1196.8833333333355, 1202.7166666666692, 1178.9833333333356, 1193.741666666669, 1209.208333333336, 1209.3750000000025, 1210.36666666667, 1216.0083333333364, 1225.758333333335, 1174.3583333333358, 1194.8916666666696, 1204.1583333333353, 1214.7750000000024, 1211.8083333333363, 1206.3500000000033, 1212.558333333336, 1213.533333333336, 1213.0416666666695, 1185.9083333333353, 1202.6833333333363, 1202.033333333336, 1202.8583333333363, 1203.7416666666693, 1211.7666666666692, 1215.7416666666693, 1225.741666666669, 1212.0500000000027, 1223.041666666669, 1230.5500000000025, 1216.76666666667, 1228.8833333333357, 1231.9666666666692, 1224.9750000000022, 1228.625000000003, 1228.5833333333364, 1224.1666666666695, 1215.7000000000023, 1224.4583333333358, 1222.1416666666698, 1232.6000000000026, 1228.625000000002, 1229.1583333333356, 1233.8416666666683, 1229.9166666666692, 1225.466666666669, 1215.6583333333356, 1231.066666666669, 1227.8833333333357, 1233.8750000000027, 1231.7166666666692, 1227.9000000000028, 1233.9833333333363, 1241.5416666666688, 1222.0250000000026, 1235.316666666669, 1236.5333333333363, 1234.7833333333363, 1233.5250000000033, 1239.1583333333356, 1224.2250000000026, 1236.0416666666692, 1230.9250000000022, 1237.1500000000021, 1236.7333333333358, 1236.0833333333362, 1231.6583333333365, 1230.7666666666696, 1234.1166666666695, 1228.1083333333356, 1236.4833333333358, 1231.9416666666696, 1231.5833333333362, 1235.4916666666695, 1242.6000000000026, 1235.625000000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24146110161916212, "mean_inference_ms": 2.0482455433801436, "mean_action_processing_ms": 0.09082290491562951, "mean_env_wait_ms": 1.5330624483381285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006937265396118164, "StateBufferConnector_ms": 0.003325939178466797, "ViewRequirementAgentConnector_ms": 0.08510231971740723}, "num_episodes": 24, "episode_return_max": 1242.6000000000026, "episode_return_min": 1143.283333333336, "episode_return_mean": 1208.854083333336, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 187350, "num_agent_steps_trained": 187200, "num_env_steps_sampled": 187350, "num_env_steps_trained": 187200, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 242.49206284715976, "num_env_steps_trained_throughput_per_sec": 256.7563018381691, "timesteps_total": 187350, "num_env_steps_sampled_lifetime": 187350, "num_agent_steps_sampled_lifetime": 187350, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 187350, "timers": {"training_iteration_time_ms": 10367.425, "restore_workers_time_ms": 0.012, "training_step_time_ms": 616.343, "sample_time_ms": 601.048, "synch_weights_time_ms": 13.818}, "counters": {"num_env_steps_sampled": 187350, "num_env_steps_trained": 187200, "num_agent_steps_sampled": 187350, "num_agent_steps_trained": 187200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1249, "num_samples_added_to_queue": 187200}, "done": false, "training_iteration": 74, "trial_id": "27800_00000", "date": "2024-10-12_15-40-36", "timestamp": 1728744036, "time_this_iter_s": 10.530073165893555, "time_total_s": 764.8698453903198, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f6a260>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 764.8698453903198, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 16.466666666666665, "ram_util_percent": 40.40666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 23531.046875, "policy_loss": 12596.6533203125, "entropy": 4.951714038848877, "entropy_coeff": 0.01, "var_gnorm": 17.306400299072266, "vf_loss": 1094924.875, "vf_explained_var": 0.4903947114944458}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 632.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 189900, "num_env_steps_trained": 189600, "num_agent_steps_sampled": 189900, "num_agent_steps_trained": 189600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1266, "num_samples_added_to_queue": 189900, "learner_queue": {"size_count": 632, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.175, "learner_load_time_ms": 0.301, "learner_load_wait_time_ms": 1176.148, "learner_dequeue_time_ms": 9926.461}}, "env_runners": {"episode_reward_max": 1245.7666666666692, "episode_reward_min": 1174.3583333333358, "episode_reward_mean": 1227.1205000000025, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1174.3583333333358}, "policy_reward_max": {"default_policy": 1245.7666666666692}, "policy_reward_mean": {"default_policy": 1227.1205000000025}, "custom_metrics": {"num_consolidated_mean": 2.9890000000000008, "num_consolidated_min": 2.96, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.8173999999999999, "num_moves_min": 0.24, "num_moves_max": 1.44, "mean_accuracy_mean": 42.83577666666667, "mean_accuracy_min": 42.499666666666684, "mean_accuracy_max": 42.95566666666667, "num_model_switches_mean": 0.4301, "num_model_switches_min": 0.16, "num_model_switches_max": 0.9, "num_slav_mean": 0.082653, "num_slav_min": 0.08066666666666666, "num_slav_max": 0.08635000000000001, "cpu_conserved_cost_mean": 7.956000000000001, "cpu_conserved_cost_min": 7.84, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5338861273039621, "mean_cluster_cpu_util_min": 0.5184164741910277, "mean_cluster_cpu_util_max": 0.5403962556306307, "mean_cluster_mem_util_mean": 0.3374862579113925, "mean_cluster_mem_util_min": 0.3345737078059072, "mean_cluster_mem_util_max": 0.3387832278481012, "reward_consolidation_mean_mean": 6.227083333333331, "reward_consolidation_mean_min": 6.166666666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 7.283916666666694, "reward_accuracy_mean_min": 6.84166666666669, "reward_accuracy_mean_max": 7.441666666666695, "reward_sla_mean_mean": -1.239795, "reward_sla_mean_min": -1.29525, "reward_sla_mean_max": -1.21, "reward_consolidation_sum_mean": 622.7083333333333, "reward_consolidation_sum_min": 616.6666666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 728.3916666666695, "reward_accuracy_sum_min": 684.166666666669, "reward_accuracy_sum_max": 744.1666666666695, "reward_sla_sum_mean": -123.97949999999999, "reward_sla_sum_min": -129.525, "reward_sla_sum_max": -120.99999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4976.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1178.9833333333356, 1193.741666666669, 1209.208333333336, 1209.3750000000025, 1210.36666666667, 1216.0083333333364, 1225.758333333335, 1174.3583333333358, 1194.8916666666696, 1204.1583333333353, 1214.7750000000024, 1211.8083333333363, 1206.3500000000033, 1212.558333333336, 1213.533333333336, 1213.0416666666695, 1185.9083333333353, 1202.6833333333363, 1202.033333333336, 1202.8583333333363, 1203.7416666666693, 1211.7666666666692, 1215.7416666666693, 1225.741666666669, 1212.0500000000027, 1223.041666666669, 1230.5500000000025, 1216.76666666667, 1228.8833333333357, 1231.9666666666692, 1224.9750000000022, 1228.625000000003, 1228.5833333333364, 1224.1666666666695, 1215.7000000000023, 1224.4583333333358, 1222.1416666666698, 1232.6000000000026, 1228.625000000002, 1229.1583333333356, 1233.8416666666683, 1229.9166666666692, 1225.466666666669, 1215.6583333333356, 1231.066666666669, 1227.8833333333357, 1233.8750000000027, 1231.7166666666692, 1227.9000000000028, 1233.9833333333363, 1241.5416666666688, 1222.0250000000026, 1235.316666666669, 1236.5333333333363, 1234.7833333333363, 1233.5250000000033, 1239.1583333333356, 1224.2250000000026, 1236.0416666666692, 1230.9250000000022, 1237.1500000000021, 1236.7333333333358, 1236.0833333333362, 1231.6583333333365, 1230.7666666666696, 1234.1166666666695, 1228.1083333333356, 1236.4833333333358, 1231.9416666666696, 1231.5833333333362, 1235.4916666666695, 1242.6000000000026, 1235.625000000003, 1240.341666666669, 1242.3583333333358, 1236.6166666666686, 1239.800000000002, 1235.5166666666687, 1241.966666666669, 1241.266666666669, 1245.0916666666699, 1241.6583333333356, 1241.3500000000026, 1235.7250000000033, 1236.083333333335, 1237.9666666666692, 1243.516666666669, 1245.7666666666692, 1240.3583333333368, 1244.591666666669, 1243.7666666666692, 1242.1833333333357, 1238.4000000000026, 1238.3583333333356, 1238.3666666666688, 1242.491666666669, 1240.3166666666693, 1240.9916666666693, 1241.2083333333358, 1240.5833333333358], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1178.9833333333356, 1193.741666666669, 1209.208333333336, 1209.3750000000025, 1210.36666666667, 1216.0083333333364, 1225.758333333335, 1174.3583333333358, 1194.8916666666696, 1204.1583333333353, 1214.7750000000024, 1211.8083333333363, 1206.3500000000033, 1212.558333333336, 1213.533333333336, 1213.0416666666695, 1185.9083333333353, 1202.6833333333363, 1202.033333333336, 1202.8583333333363, 1203.7416666666693, 1211.7666666666692, 1215.7416666666693, 1225.741666666669, 1212.0500000000027, 1223.041666666669, 1230.5500000000025, 1216.76666666667, 1228.8833333333357, 1231.9666666666692, 1224.9750000000022, 1228.625000000003, 1228.5833333333364, 1224.1666666666695, 1215.7000000000023, 1224.4583333333358, 1222.1416666666698, 1232.6000000000026, 1228.625000000002, 1229.1583333333356, 1233.8416666666683, 1229.9166666666692, 1225.466666666669, 1215.6583333333356, 1231.066666666669, 1227.8833333333357, 1233.8750000000027, 1231.7166666666692, 1227.9000000000028, 1233.9833333333363, 1241.5416666666688, 1222.0250000000026, 1235.316666666669, 1236.5333333333363, 1234.7833333333363, 1233.5250000000033, 1239.1583333333356, 1224.2250000000026, 1236.0416666666692, 1230.9250000000022, 1237.1500000000021, 1236.7333333333358, 1236.0833333333362, 1231.6583333333365, 1230.7666666666696, 1234.1166666666695, 1228.1083333333356, 1236.4833333333358, 1231.9416666666696, 1231.5833333333362, 1235.4916666666695, 1242.6000000000026, 1235.625000000003, 1240.341666666669, 1242.3583333333358, 1236.6166666666686, 1239.800000000002, 1235.5166666666687, 1241.966666666669, 1241.266666666669, 1245.0916666666699, 1241.6583333333356, 1241.3500000000026, 1235.7250000000033, 1236.083333333335, 1237.9666666666692, 1243.516666666669, 1245.7666666666692, 1240.3583333333368, 1244.591666666669, 1243.7666666666692, 1242.1833333333357, 1238.4000000000026, 1238.3583333333356, 1238.3666666666688, 1242.491666666669, 1240.3166666666693, 1240.9916666666693, 1241.2083333333358, 1240.5833333333358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24146556013366577, "mean_inference_ms": 2.0471887855997566, "mean_action_processing_ms": 0.09082240235189636, "mean_env_wait_ms": 1.5328731701509304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068509578704833984, "StateBufferConnector_ms": 0.0033156871795654297, "ViewRequirementAgentConnector_ms": 0.08532452583312988}, "num_episodes": 27, "episode_return_max": 1245.7666666666692, "episode_return_min": 1174.3583333333358, "episode_return_mean": 1227.1205000000025, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 189900, "num_agent_steps_trained": 189600, "num_env_steps_sampled": 189900, "num_env_steps_trained": 189600, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 244.76220034439567, "num_env_steps_trained_throughput_per_sec": 230.36442385354886, "timesteps_total": 189900, "num_env_steps_sampled_lifetime": 189900, "num_agent_steps_sampled_lifetime": 189900, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 189900, "timers": {"training_iteration_time_ms": 10367.798, "restore_workers_time_ms": 0.013, "training_step_time_ms": 616.904, "sample_time_ms": 601.415, "synch_weights_time_ms": 14.03}, "counters": {"num_env_steps_sampled": 189900, "num_env_steps_trained": 189600, "num_agent_steps_sampled": 189900, "num_agent_steps_trained": 189600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1266, "num_samples_added_to_queue": 189900}, "done": false, "training_iteration": 75, "trial_id": "27800_00000", "date": "2024-10-12_15-40-47", "timestamp": 1728744047, "time_this_iter_s": 10.438193321228027, "time_total_s": 775.3080387115479, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f3820>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 775.3080387115479, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 16.486666666666668, "ram_util_percent": 40.58666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 18760.9765625, "policy_loss": 9576.3056640625, "entropy": 4.710977554321289, "entropy_coeff": 0.01, "var_gnorm": 17.415616989135742, "vf_loss": 919880.5, "vf_explained_var": 0.538044810295105}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 641.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 192450, "num_env_steps_trained": 192300, "num_agent_steps_sampled": 192450, "num_agent_steps_trained": 192300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1283, "num_samples_added_to_queue": 192300, "learner_queue": {"size_count": 641, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 64.5, "learner_load_time_ms": 0.295, "learner_load_wait_time_ms": 1174.804, "learner_dequeue_time_ms": 9955.074}}, "env_runners": {"episode_reward_max": 1251.0666666666698, "episode_reward_min": 1212.0500000000027, "episode_reward_mean": 1236.767416666669, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.0500000000027}, "policy_reward_max": {"default_policy": 1251.0666666666698}, "policy_reward_mean": {"default_policy": 1236.767416666669}, "custom_metrics": {"num_consolidated_mean": 2.9912, "num_consolidated_min": 2.96, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.5915, "num_moves_min": 0.1, "num_moves_max": 1.31, "mean_accuracy_mean": 42.90234, "mean_accuracy_min": 42.74666666666668, "mean_accuracy_max": 42.99366666666667, "num_model_switches_mean": 0.2958, "num_model_switches_min": 0.02, "num_model_switches_max": 0.64, "num_slav_mean": 0.08236616666666668, "num_slav_min": 0.08066666666666666, "num_slav_max": 0.08613333333333334, "cpu_conserved_cost_mean": 7.9648, "cpu_conserved_cost_min": 7.84, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5370088242898511, "mean_cluster_cpu_util_min": 0.527995820118588, "mean_cluster_cpu_util_max": 0.5421315614083472, "mean_cluster_mem_util_mean": 0.33788305643459915, "mean_cluster_mem_util_min": 0.3361950158227848, "mean_cluster_mem_util_max": 0.33888449367088613, "reward_consolidation_mean_mean": 6.231666666666666, "reward_consolidation_mean_min": 6.166666666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 7.371500000000027, "reward_accuracy_mean_min": 7.166666666666691, "reward_accuracy_mean_max": 7.491666666666695, "reward_sla_mean_mean": -1.2354924999999999, "reward_sla_mean_min": -1.2919999999999998, "reward_sla_mean_max": -1.21, "reward_consolidation_sum_mean": 623.1666666666665, "reward_consolidation_sum_min": 616.6666666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 737.1500000000029, "reward_accuracy_sum_min": 716.6666666666691, "reward_accuracy_sum_max": 749.1666666666695, "reward_sla_sum_mean": -123.54924999999997, "reward_sla_sum_min": -129.2, "reward_sla_sum_max": -120.99999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3905.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1212.0500000000027, 1223.041666666669, 1230.5500000000025, 1216.76666666667, 1228.8833333333357, 1231.9666666666692, 1224.9750000000022, 1228.625000000003, 1228.5833333333364, 1224.1666666666695, 1215.7000000000023, 1224.4583333333358, 1222.1416666666698, 1232.6000000000026, 1228.625000000002, 1229.1583333333356, 1233.8416666666683, 1229.9166666666692, 1225.466666666669, 1215.6583333333356, 1231.066666666669, 1227.8833333333357, 1233.8750000000027, 1231.7166666666692, 1227.9000000000028, 1233.9833333333363, 1241.5416666666688, 1222.0250000000026, 1235.316666666669, 1236.5333333333363, 1234.7833333333363, 1233.5250000000033, 1239.1583333333356, 1224.2250000000026, 1236.0416666666692, 1230.9250000000022, 1237.1500000000021, 1236.7333333333358, 1236.0833333333362, 1231.6583333333365, 1230.7666666666696, 1234.1166666666695, 1228.1083333333356, 1236.4833333333358, 1231.9416666666696, 1231.5833333333362, 1235.4916666666695, 1242.6000000000026, 1235.625000000003, 1240.341666666669, 1242.3583333333358, 1236.6166666666686, 1239.800000000002, 1235.5166666666687, 1241.966666666669, 1241.266666666669, 1245.0916666666699, 1241.6583333333356, 1241.3500000000026, 1235.7250000000033, 1236.083333333335, 1237.9666666666692, 1243.516666666669, 1245.7666666666692, 1240.3583333333368, 1244.591666666669, 1243.7666666666692, 1242.1833333333357, 1238.4000000000026, 1238.3583333333356, 1238.3666666666688, 1242.491666666669, 1240.3166666666693, 1240.9916666666693, 1241.2083333333358, 1240.5833333333358, 1238.7250000000026, 1244.8750000000027, 1246.4750000000024, 1249.8000000000031, 1247.4416666666689, 1243.4583333333358, 1244.883333333336, 1242.9416666666696, 1243.3083333333354, 1245.3250000000025, 1244.9083333333356, 1247.4916666666693, 1246.3166666666693, 1246.475000000002, 1248.4750000000026, 1251.0666666666698, 1244.7666666666696, 1247.541666666669, 1240.5833333333362, 1246.3333333333358, 1250.7583333333362, 1249.241666666669, 1249.0833333333355, 1243.808333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1212.0500000000027, 1223.041666666669, 1230.5500000000025, 1216.76666666667, 1228.8833333333357, 1231.9666666666692, 1224.9750000000022, 1228.625000000003, 1228.5833333333364, 1224.1666666666695, 1215.7000000000023, 1224.4583333333358, 1222.1416666666698, 1232.6000000000026, 1228.625000000002, 1229.1583333333356, 1233.8416666666683, 1229.9166666666692, 1225.466666666669, 1215.6583333333356, 1231.066666666669, 1227.8833333333357, 1233.8750000000027, 1231.7166666666692, 1227.9000000000028, 1233.9833333333363, 1241.5416666666688, 1222.0250000000026, 1235.316666666669, 1236.5333333333363, 1234.7833333333363, 1233.5250000000033, 1239.1583333333356, 1224.2250000000026, 1236.0416666666692, 1230.9250000000022, 1237.1500000000021, 1236.7333333333358, 1236.0833333333362, 1231.6583333333365, 1230.7666666666696, 1234.1166666666695, 1228.1083333333356, 1236.4833333333358, 1231.9416666666696, 1231.5833333333362, 1235.4916666666695, 1242.6000000000026, 1235.625000000003, 1240.341666666669, 1242.3583333333358, 1236.6166666666686, 1239.800000000002, 1235.5166666666687, 1241.966666666669, 1241.266666666669, 1245.0916666666699, 1241.6583333333356, 1241.3500000000026, 1235.7250000000033, 1236.083333333335, 1237.9666666666692, 1243.516666666669, 1245.7666666666692, 1240.3583333333368, 1244.591666666669, 1243.7666666666692, 1242.1833333333357, 1238.4000000000026, 1238.3583333333356, 1238.3666666666688, 1242.491666666669, 1240.3166666666693, 1240.9916666666693, 1241.2083333333358, 1240.5833333333358, 1238.7250000000026, 1244.8750000000027, 1246.4750000000024, 1249.8000000000031, 1247.4416666666689, 1243.4583333333358, 1244.883333333336, 1242.9416666666696, 1243.3083333333354, 1245.3250000000025, 1244.9083333333356, 1247.4916666666693, 1246.3166666666693, 1246.475000000002, 1248.4750000000026, 1251.0666666666698, 1244.7666666666696, 1247.541666666669, 1240.5833333333362, 1246.3333333333358, 1250.7583333333362, 1249.241666666669, 1249.0833333333355, 1243.808333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24151627949380447, "mean_inference_ms": 2.0493350619894737, "mean_action_processing_ms": 0.09085743373182811, "mean_env_wait_ms": 1.5333862937586318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006490230560302734, "StateBufferConnector_ms": 0.0033159255981445312, "ViewRequirementAgentConnector_ms": 0.08524632453918457}, "num_episodes": 24, "episode_return_max": 1251.0666666666698, "episode_return_min": 1212.0500000000027, "episode_return_mean": 1236.767416666669, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192450, "num_agent_steps_trained": 192300, "num_env_steps_sampled": 192450, "num_env_steps_trained": 192300, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 244.17336684839634, "num_env_steps_trained_throughput_per_sec": 258.5365060747726, "timesteps_total": 192450, "num_env_steps_sampled_lifetime": 192450, "num_agent_steps_sampled_lifetime": 192450, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 192450, "timers": {"training_iteration_time_ms": 10392.514, "restore_workers_time_ms": 0.015, "training_step_time_ms": 617.05, "sample_time_ms": 600.852, "synch_weights_time_ms": 14.642}, "counters": {"num_env_steps_sampled": 192450, "num_env_steps_trained": 192300, "num_agent_steps_sampled": 192450, "num_agent_steps_trained": 192300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1283, "num_samples_added_to_queue": 192300}, "done": false, "training_iteration": 76, "trial_id": "27800_00000", "date": "2024-10-12_15-40-57", "timestamp": 1728744057, "time_this_iter_s": 10.455002546310425, "time_total_s": 785.7630412578583, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b46050>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 785.7630412578583, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 16.66, "ram_util_percent": 40.76}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 15081.8515625, "policy_loss": 7805.3125, "entropy": 4.889654159545898, "entropy_coeff": 0.01, "var_gnorm": 17.517662048339844, "vf_loss": 729120.8125, "vf_explained_var": 0.5706155300140381}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 649.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 195000, "num_env_steps_trained": 194700, "num_agent_steps_sampled": 195000, "num_agent_steps_trained": 194700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1300, "num_samples_added_to_queue": 195000, "learner_queue": {"size_count": 649, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.223, "learner_load_time_ms": 0.288, "learner_load_wait_time_ms": 1171.743, "learner_dequeue_time_ms": 9941.28}}, "env_runners": {"episode_reward_max": 1252.0166666666694, "episode_reward_min": 1222.0250000000026, "episode_reward_mean": 1242.4073333333358, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1222.0250000000026}, "policy_reward_max": {"default_policy": 1252.0166666666694}, "policy_reward_mean": {"default_policy": 1242.4073333333358}, "custom_metrics": {"num_consolidated_mean": 2.9912000000000005, "num_consolidated_min": 2.96, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.38059999999999994, "num_moves_min": 0.07, "num_moves_max": 0.94, "mean_accuracy_mean": 42.943316666666675, "mean_accuracy_min": 42.822666666666684, "mean_accuracy_max": 43.00000000000002, "num_model_switches_mean": 0.18179999999999996, "num_model_switches_min": 0.02, "num_model_switches_max": 0.5, "num_slav_mean": 0.08220066666666666, "num_slav_min": 0.08066666666666666, "num_slav_max": 0.08395, "cpu_conserved_cost_mean": 7.9648, "cpu_conserved_cost_min": 7.84, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.538955742582506, "mean_cluster_cpu_util_min": 0.5313692372219158, "mean_cluster_cpu_util_max": 0.5429309385916529, "mean_cluster_mem_util_mean": 0.33806386603375527, "mean_cluster_mem_util_min": 0.336210970464135, "mean_cluster_mem_util_max": 0.33888449367088613, "reward_consolidation_mean_mean": 6.231666666666666, "reward_consolidation_mean_min": 6.166666666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 7.425416666666694, "reward_accuracy_mean_min": 7.266666666666692, "reward_accuracy_mean_max": 7.500000000000028, "reward_sla_mean_mean": -1.23301, "reward_sla_mean_min": -1.25925, "reward_sla_mean_max": -1.21, "reward_consolidation_sum_mean": 623.1666666666666, "reward_consolidation_sum_min": 616.6666666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 742.5416666666696, "reward_accuracy_sum_min": 726.6666666666692, "reward_accuracy_sum_max": 750.0000000000028, "reward_sla_sum_mean": -123.30099999999997, "reward_sla_sum_min": -125.925, "reward_sla_sum_max": -120.99999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2698.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1222.0250000000026, 1235.316666666669, 1236.5333333333363, 1234.7833333333363, 1233.5250000000033, 1239.1583333333356, 1224.2250000000026, 1236.0416666666692, 1230.9250000000022, 1237.1500000000021, 1236.7333333333358, 1236.0833333333362, 1231.6583333333365, 1230.7666666666696, 1234.1166666666695, 1228.1083333333356, 1236.4833333333358, 1231.9416666666696, 1231.5833333333362, 1235.4916666666695, 1242.6000000000026, 1235.625000000003, 1240.341666666669, 1242.3583333333358, 1236.6166666666686, 1239.800000000002, 1235.5166666666687, 1241.966666666669, 1241.266666666669, 1245.0916666666699, 1241.6583333333356, 1241.3500000000026, 1235.7250000000033, 1236.083333333335, 1237.9666666666692, 1243.516666666669, 1245.7666666666692, 1240.3583333333368, 1244.591666666669, 1243.7666666666692, 1242.1833333333357, 1238.4000000000026, 1238.3583333333356, 1238.3666666666688, 1242.491666666669, 1240.3166666666693, 1240.9916666666693, 1241.2083333333358, 1240.5833333333358, 1238.7250000000026, 1244.8750000000027, 1246.4750000000024, 1249.8000000000031, 1247.4416666666689, 1243.4583333333358, 1244.883333333336, 1242.9416666666696, 1243.3083333333354, 1245.3250000000025, 1244.9083333333356, 1247.4916666666693, 1246.3166666666693, 1246.475000000002, 1248.4750000000026, 1251.0666666666698, 1244.7666666666696, 1247.541666666669, 1240.5833333333362, 1246.3333333333358, 1250.7583333333362, 1249.241666666669, 1249.0833333333355, 1243.808333333336, 1248.2166666666694, 1249.0583333333361, 1245.891666666669, 1243.733333333336, 1247.7916666666695, 1248.9166666666692, 1244.733333333336, 1249.3833333333362, 1245.7333333333358, 1250.083333333336, 1249.4833333333358, 1249.0250000000021, 1244.6250000000025, 1248.7083333333358, 1252.0166666666694, 1248.5333333333356, 1250.1500000000024, 1245.1250000000032, 1250.1833333333357, 1246.7916666666695, 1251.7416666666697, 1250.6500000000021, 1247.7916666666688, 1249.4500000000025, 1251.050000000003, 1243.2333333333358, 1247.033333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1222.0250000000026, 1235.316666666669, 1236.5333333333363, 1234.7833333333363, 1233.5250000000033, 1239.1583333333356, 1224.2250000000026, 1236.0416666666692, 1230.9250000000022, 1237.1500000000021, 1236.7333333333358, 1236.0833333333362, 1231.6583333333365, 1230.7666666666696, 1234.1166666666695, 1228.1083333333356, 1236.4833333333358, 1231.9416666666696, 1231.5833333333362, 1235.4916666666695, 1242.6000000000026, 1235.625000000003, 1240.341666666669, 1242.3583333333358, 1236.6166666666686, 1239.800000000002, 1235.5166666666687, 1241.966666666669, 1241.266666666669, 1245.0916666666699, 1241.6583333333356, 1241.3500000000026, 1235.7250000000033, 1236.083333333335, 1237.9666666666692, 1243.516666666669, 1245.7666666666692, 1240.3583333333368, 1244.591666666669, 1243.7666666666692, 1242.1833333333357, 1238.4000000000026, 1238.3583333333356, 1238.3666666666688, 1242.491666666669, 1240.3166666666693, 1240.9916666666693, 1241.2083333333358, 1240.5833333333358, 1238.7250000000026, 1244.8750000000027, 1246.4750000000024, 1249.8000000000031, 1247.4416666666689, 1243.4583333333358, 1244.883333333336, 1242.9416666666696, 1243.3083333333354, 1245.3250000000025, 1244.9083333333356, 1247.4916666666693, 1246.3166666666693, 1246.475000000002, 1248.4750000000026, 1251.0666666666698, 1244.7666666666696, 1247.541666666669, 1240.5833333333362, 1246.3333333333358, 1250.7583333333362, 1249.241666666669, 1249.0833333333355, 1243.808333333336, 1248.2166666666694, 1249.0583333333361, 1245.891666666669, 1243.733333333336, 1247.7916666666695, 1248.9166666666692, 1244.733333333336, 1249.3833333333362, 1245.7333333333358, 1250.083333333336, 1249.4833333333358, 1249.0250000000021, 1244.6250000000025, 1248.7083333333358, 1252.0166666666694, 1248.5333333333356, 1250.1500000000024, 1245.1250000000032, 1250.1833333333357, 1246.7916666666695, 1251.7416666666697, 1250.6500000000021, 1247.7916666666688, 1249.4500000000025, 1251.050000000003, 1243.2333333333358, 1247.033333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24150055664434356, "mean_inference_ms": 2.0479329615310125, "mean_action_processing_ms": 0.0908524067590724, "mean_env_wait_ms": 1.5330413380673498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006465911865234375, "StateBufferConnector_ms": 0.003347158432006836, "ViewRequirementAgentConnector_ms": 0.08551621437072754}, "num_episodes": 27, "episode_return_max": 1252.0166666666694, "episode_return_min": 1222.0250000000026, "episode_return_mean": 1242.4073333333358, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 195000, "num_agent_steps_trained": 194700, "num_env_steps_sampled": 195000, "num_env_steps_trained": 194700, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 244.03425947312252, "num_env_steps_trained_throughput_per_sec": 229.67930303352708, "timesteps_total": 195000, "num_env_steps_sampled_lifetime": 195000, "num_agent_steps_sampled_lifetime": 195000, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 195000, "timers": {"training_iteration_time_ms": 10391.64, "restore_workers_time_ms": 0.015, "training_step_time_ms": 614.547, "sample_time_ms": 598.823, "synch_weights_time_ms": 14.154}, "counters": {"num_env_steps_sampled": 195000, "num_env_steps_trained": 194700, "num_agent_steps_sampled": 195000, "num_agent_steps_trained": 194700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1300, "num_samples_added_to_queue": 195000}, "done": false, "training_iteration": 77, "trial_id": "27800_00000", "date": "2024-10-12_15-41-08", "timestamp": 1728744068, "time_this_iter_s": 10.461600542068481, "time_total_s": 796.2246417999268, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f1c00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 796.2246417999268, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 16.426666666666666, "ram_util_percent": 40.886666666666656}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 14798.091796875, "policy_loss": 7668.7880859375, "entropy": 4.815209865570068, "entropy_coeff": 0.01, "var_gnorm": 17.633127212524414, "vf_loss": 714375.0, "vf_explained_var": 0.5793322324752808}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 658.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 197550, "num_env_steps_trained": 197400, "num_agent_steps_sampled": 197550, "num_agent_steps_trained": 197400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1317, "num_samples_added_to_queue": 197400, "learner_queue": {"size_count": 658, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.784, "learner_load_time_ms": 0.292, "learner_load_wait_time_ms": 1184.141, "learner_dequeue_time_ms": 9941.681}}, "env_runners": {"episode_reward_max": 1252.0166666666694, "episode_reward_min": 1235.5166666666687, "episode_reward_mean": 1245.9893333333357, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1235.5166666666687}, "policy_reward_max": {"default_policy": 1252.0166666666694}, "policy_reward_mean": {"default_policy": 1245.9893333333357}, "custom_metrics": {"num_consolidated_mean": 2.9919000000000007, "num_consolidated_min": 2.97, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.26560000000000006, "num_moves_min": 0.07, "num_moves_max": 0.66, "mean_accuracy_mean": 42.968903333333344, "mean_accuracy_min": 42.89233333333333, "mean_accuracy_max": 43.00633333333335, "num_model_switches_mean": 0.11059999999999999, "num_model_switches_min": 0.0, "num_model_switches_max": 0.36, "num_slav_mean": 0.08215433333333336, "num_slav_min": 0.08096666666666667, "num_slav_max": 0.08395, "cpu_conserved_cost_mean": 7.967600000000001, "cpu_conserved_cost_min": 7.88, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5402121018339767, "mean_cluster_cpu_util_min": 0.5348997489198382, "mean_cluster_cpu_util_max": 0.543940660047803, "mean_cluster_mem_util_mean": 0.33818681566455694, "mean_cluster_mem_util_min": 0.3370199103375528, "mean_cluster_mem_util_max": 0.33901213080168774, "reward_consolidation_mean_mean": 6.2331249999999985, "reward_consolidation_mean_min": 6.187499999999999, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 7.459083333333361, "reward_accuracy_mean_min": 7.358333333333362, "reward_accuracy_mean_max": 7.508333333333362, "reward_sla_mean_mean": -1.232315, "reward_sla_mean_min": -1.25925, "reward_sla_mean_max": -1.2145, "reward_consolidation_sum_mean": 623.3124999999999, "reward_consolidation_sum_min": 618.7499999999999, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 745.9083333333365, "reward_accuracy_sum_min": 735.8333333333362, "reward_accuracy_sum_max": 750.8333333333362, "reward_sla_sum_mean": -123.23150000000001, "reward_sla_sum_min": -125.925, "reward_sla_sum_max": -121.44999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1782.0, "global_timestep_min": 100, "global_timestep_max": 3400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1236.6166666666686, 1239.800000000002, 1235.5166666666687, 1241.966666666669, 1241.266666666669, 1245.0916666666699, 1241.6583333333356, 1241.3500000000026, 1235.7250000000033, 1236.083333333335, 1237.9666666666692, 1243.516666666669, 1245.7666666666692, 1240.3583333333368, 1244.591666666669, 1243.7666666666692, 1242.1833333333357, 1238.4000000000026, 1238.3583333333356, 1238.3666666666688, 1242.491666666669, 1240.3166666666693, 1240.9916666666693, 1241.2083333333358, 1240.5833333333358, 1238.7250000000026, 1244.8750000000027, 1246.4750000000024, 1249.8000000000031, 1247.4416666666689, 1243.4583333333358, 1244.883333333336, 1242.9416666666696, 1243.3083333333354, 1245.3250000000025, 1244.9083333333356, 1247.4916666666693, 1246.3166666666693, 1246.475000000002, 1248.4750000000026, 1251.0666666666698, 1244.7666666666696, 1247.541666666669, 1240.5833333333362, 1246.3333333333358, 1250.7583333333362, 1249.241666666669, 1249.0833333333355, 1243.808333333336, 1248.2166666666694, 1249.0583333333361, 1245.891666666669, 1243.733333333336, 1247.7916666666695, 1248.9166666666692, 1244.733333333336, 1249.3833333333362, 1245.7333333333358, 1250.083333333336, 1249.4833333333358, 1249.0250000000021, 1244.6250000000025, 1248.7083333333358, 1252.0166666666694, 1248.5333333333356, 1250.1500000000024, 1245.1250000000032, 1250.1833333333357, 1246.7916666666695, 1251.7416666666697, 1250.6500000000021, 1247.7916666666688, 1249.4500000000025, 1251.050000000003, 1243.2333333333358, 1247.033333333336, 1251.5416666666688, 1248.983333333336, 1248.1333333333362, 1247.783333333336, 1250.533333333336, 1252.0166666666692, 1248.5750000000025, 1250.6083333333354, 1248.383333333336, 1248.8083333333363, 1246.3500000000024, 1248.000000000003, 1249.6083333333358, 1249.5416666666692, 1249.9500000000025, 1249.9083333333358, 1247.5250000000028, 1250.4750000000024, 1250.4666666666694, 1246.316666666669, 1248.425000000003, 1250.5083333333355, 1249.0833333333358, 1250.2500000000023], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1236.6166666666686, 1239.800000000002, 1235.5166666666687, 1241.966666666669, 1241.266666666669, 1245.0916666666699, 1241.6583333333356, 1241.3500000000026, 1235.7250000000033, 1236.083333333335, 1237.9666666666692, 1243.516666666669, 1245.7666666666692, 1240.3583333333368, 1244.591666666669, 1243.7666666666692, 1242.1833333333357, 1238.4000000000026, 1238.3583333333356, 1238.3666666666688, 1242.491666666669, 1240.3166666666693, 1240.9916666666693, 1241.2083333333358, 1240.5833333333358, 1238.7250000000026, 1244.8750000000027, 1246.4750000000024, 1249.8000000000031, 1247.4416666666689, 1243.4583333333358, 1244.883333333336, 1242.9416666666696, 1243.3083333333354, 1245.3250000000025, 1244.9083333333356, 1247.4916666666693, 1246.3166666666693, 1246.475000000002, 1248.4750000000026, 1251.0666666666698, 1244.7666666666696, 1247.541666666669, 1240.5833333333362, 1246.3333333333358, 1250.7583333333362, 1249.241666666669, 1249.0833333333355, 1243.808333333336, 1248.2166666666694, 1249.0583333333361, 1245.891666666669, 1243.733333333336, 1247.7916666666695, 1248.9166666666692, 1244.733333333336, 1249.3833333333362, 1245.7333333333358, 1250.083333333336, 1249.4833333333358, 1249.0250000000021, 1244.6250000000025, 1248.7083333333358, 1252.0166666666694, 1248.5333333333356, 1250.1500000000024, 1245.1250000000032, 1250.1833333333357, 1246.7916666666695, 1251.7416666666697, 1250.6500000000021, 1247.7916666666688, 1249.4500000000025, 1251.050000000003, 1243.2333333333358, 1247.033333333336, 1251.5416666666688, 1248.983333333336, 1248.1333333333362, 1247.783333333336, 1250.533333333336, 1252.0166666666692, 1248.5750000000025, 1250.6083333333354, 1248.383333333336, 1248.8083333333363, 1246.3500000000024, 1248.000000000003, 1249.6083333333358, 1249.5416666666692, 1249.9500000000025, 1249.9083333333358, 1247.5250000000028, 1250.4750000000024, 1250.4666666666694, 1246.316666666669, 1248.425000000003, 1250.5083333333355, 1249.0833333333358, 1250.2500000000023]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24152332086141115, "mean_inference_ms": 2.0481488605034963, "mean_action_processing_ms": 0.09086611647980025, "mean_env_wait_ms": 1.5330839765402828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006595611572265625, "StateBufferConnector_ms": 0.0034143924713134766, "ViewRequirementAgentConnector_ms": 0.08741378784179688}, "num_episodes": 24, "episode_return_max": 1252.0166666666694, "episode_return_min": 1235.5166666666687, "episode_return_mean": 1245.9893333333357, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 197550, "num_agent_steps_trained": 197400, "num_env_steps_sampled": 197550, "num_env_steps_trained": 197400, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 241.4240474077525, "num_env_steps_trained_throughput_per_sec": 255.6254619611497, "timesteps_total": 197550, "num_env_steps_sampled_lifetime": 197550, "num_agent_steps_sampled_lifetime": 197550, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 197550, "timers": {"training_iteration_time_ms": 10396.884, "restore_workers_time_ms": 0.013, "training_step_time_ms": 626.156, "sample_time_ms": 610.34, "synch_weights_time_ms": 14.185}, "counters": {"num_env_steps_sampled": 197550, "num_env_steps_trained": 197400, "num_agent_steps_sampled": 197550, "num_agent_steps_trained": 197400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1317, "num_samples_added_to_queue": 197400}, "done": false, "training_iteration": 78, "trial_id": "27800_00000", "date": "2024-10-12_15-41-18", "timestamp": 1728744078, "time_this_iter_s": 10.571240186691284, "time_total_s": 806.795881986618, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b46f80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 806.795881986618, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 16.38, "ram_util_percent": 41.053333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 8806.330078125, "policy_loss": 3898.192138671875, "entropy": 4.6808366775512695, "entropy_coeff": 0.01, "var_gnorm": 17.7372989654541, "vf_loss": 492218.0625, "vf_explained_var": 0.6231212019920349}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 666.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 200100, "num_env_steps_trained": 199800, "num_agent_steps_sampled": 200100, "num_agent_steps_trained": 199800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1334, "num_samples_added_to_queue": 200100, "learner_queue": {"size_count": 666, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.946, "learner_load_time_ms": 0.304, "learner_load_wait_time_ms": 1167.968, "learner_dequeue_time_ms": 9923.276}}, "env_runners": {"episode_reward_max": 1252.8500000000029, "episode_reward_min": 1240.5833333333362, "episode_reward_mean": 1248.6312500000026, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1240.5833333333362}, "policy_reward_max": {"default_policy": 1252.8500000000029}, "policy_reward_mean": {"default_policy": 1248.6312500000026}, "custom_metrics": {"num_consolidated_mean": 2.9925, "num_consolidated_min": 2.97, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.21830000000000002, "num_moves_min": 0.06, "num_moves_max": 0.38, "mean_accuracy_mean": 42.98632000000001, "mean_accuracy_min": 42.94300000000001, "mean_accuracy_max": 43.00633333333335, "num_model_switches_mean": 0.052000000000000005, "num_model_switches_min": 0.0, "num_model_switches_max": 0.24, "num_slav_mean": 0.08200416666666667, "num_slav_min": 0.08096666666666667, "num_slav_max": 0.08395, "cpu_conserved_cost_mean": 7.97, "cpu_conserved_cost_min": 7.88, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5413444267673285, "mean_cluster_cpu_util_min": 0.5376232418643133, "mean_cluster_cpu_util_max": 0.5454367760617761, "mean_cluster_mem_util_mean": 0.3382843895042196, "mean_cluster_mem_util_min": 0.3370199103375528, "mean_cluster_mem_util_max": 0.3391334388185654, "reward_consolidation_mean_mean": 6.234374999999999, "reward_consolidation_mean_min": 6.187499999999999, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 7.482000000000027, "reward_accuracy_mean_min": 7.425000000000028, "reward_accuracy_mean_max": 7.508333333333362, "reward_sla_mean_mean": -1.2300624999999998, "reward_sla_mean_min": -1.25925, "reward_sla_mean_max": -1.2145, "reward_consolidation_sum_mean": 623.4375, "reward_consolidation_sum_min": 618.7499999999999, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 748.200000000003, "reward_accuracy_sum_min": 742.5000000000028, "reward_accuracy_sum_max": 750.8333333333362, "reward_sla_sum_mean": -123.00624999999998, "reward_sla_sum_min": -125.925, "reward_sla_sum_max": -121.44999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2682.0, "global_timestep_min": 1000, "global_timestep_max": 4300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1246.4750000000024, 1249.8000000000031, 1247.4416666666689, 1243.4583333333358, 1244.883333333336, 1242.9416666666696, 1243.3083333333354, 1245.3250000000025, 1244.9083333333356, 1247.4916666666693, 1246.3166666666693, 1246.475000000002, 1248.4750000000026, 1251.0666666666698, 1244.7666666666696, 1247.541666666669, 1240.5833333333362, 1246.3333333333358, 1250.7583333333362, 1249.241666666669, 1249.0833333333355, 1243.808333333336, 1248.2166666666694, 1249.0583333333361, 1245.891666666669, 1243.733333333336, 1247.7916666666695, 1248.9166666666692, 1244.733333333336, 1249.3833333333362, 1245.7333333333358, 1250.083333333336, 1249.4833333333358, 1249.0250000000021, 1244.6250000000025, 1248.7083333333358, 1252.0166666666694, 1248.5333333333356, 1250.1500000000024, 1245.1250000000032, 1250.1833333333357, 1246.7916666666695, 1251.7416666666697, 1250.6500000000021, 1247.7916666666688, 1249.4500000000025, 1251.050000000003, 1243.2333333333358, 1247.033333333336, 1251.5416666666688, 1248.983333333336, 1248.1333333333362, 1247.783333333336, 1250.533333333336, 1252.0166666666692, 1248.5750000000025, 1250.6083333333354, 1248.383333333336, 1248.8083333333363, 1246.3500000000024, 1248.000000000003, 1249.6083333333358, 1249.5416666666692, 1249.9500000000025, 1249.9083333333358, 1247.5250000000028, 1250.4750000000024, 1250.4666666666694, 1246.316666666669, 1248.425000000003, 1250.5083333333355, 1249.0833333333358, 1250.2500000000023, 1248.308333333336, 1251.1666666666695, 1251.9666666666694, 1248.3000000000034, 1248.5750000000023, 1248.3083333333366, 1250.683333333336, 1251.1833333333357, 1249.7500000000025, 1252.3000000000025, 1252.8500000000029, 1250.9833333333358, 1252.166666666669, 1251.358333333336, 1252.7083333333362, 1252.6833333333357, 1251.3416666666685, 1251.4666666666692, 1248.4500000000023, 1248.8916666666685, 1247.0750000000025, 1251.416666666669, 1248.8916666666687, 1248.2250000000029, 1250.6083333333356, 1251.158333333336, 1250.916666666669], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1246.4750000000024, 1249.8000000000031, 1247.4416666666689, 1243.4583333333358, 1244.883333333336, 1242.9416666666696, 1243.3083333333354, 1245.3250000000025, 1244.9083333333356, 1247.4916666666693, 1246.3166666666693, 1246.475000000002, 1248.4750000000026, 1251.0666666666698, 1244.7666666666696, 1247.541666666669, 1240.5833333333362, 1246.3333333333358, 1250.7583333333362, 1249.241666666669, 1249.0833333333355, 1243.808333333336, 1248.2166666666694, 1249.0583333333361, 1245.891666666669, 1243.733333333336, 1247.7916666666695, 1248.9166666666692, 1244.733333333336, 1249.3833333333362, 1245.7333333333358, 1250.083333333336, 1249.4833333333358, 1249.0250000000021, 1244.6250000000025, 1248.7083333333358, 1252.0166666666694, 1248.5333333333356, 1250.1500000000024, 1245.1250000000032, 1250.1833333333357, 1246.7916666666695, 1251.7416666666697, 1250.6500000000021, 1247.7916666666688, 1249.4500000000025, 1251.050000000003, 1243.2333333333358, 1247.033333333336, 1251.5416666666688, 1248.983333333336, 1248.1333333333362, 1247.783333333336, 1250.533333333336, 1252.0166666666692, 1248.5750000000025, 1250.6083333333354, 1248.383333333336, 1248.8083333333363, 1246.3500000000024, 1248.000000000003, 1249.6083333333358, 1249.5416666666692, 1249.9500000000025, 1249.9083333333358, 1247.5250000000028, 1250.4750000000024, 1250.4666666666694, 1246.316666666669, 1248.425000000003, 1250.5083333333355, 1249.0833333333358, 1250.2500000000023, 1248.308333333336, 1251.1666666666695, 1251.9666666666694, 1248.3000000000034, 1248.5750000000023, 1248.3083333333366, 1250.683333333336, 1251.1833333333357, 1249.7500000000025, 1252.3000000000025, 1252.8500000000029, 1250.9833333333358, 1252.166666666669, 1251.358333333336, 1252.7083333333362, 1252.6833333333357, 1251.3416666666685, 1251.4666666666692, 1248.4500000000023, 1248.8916666666685, 1247.0750000000025, 1251.416666666669, 1248.8916666666687, 1248.2250000000029, 1250.6083333333356, 1251.158333333336, 1250.916666666669]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24153958446040774, "mean_inference_ms": 2.0482551346658546, "mean_action_processing_ms": 0.0908785034497587, "mean_env_wait_ms": 1.5330640200095573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066013336181640625, "StateBufferConnector_ms": 0.003375530242919922, "ViewRequirementAgentConnector_ms": 0.08659243583679199}, "num_episodes": 27, "episode_return_max": 1252.8500000000029, "episode_return_min": 1240.5833333333362, "episode_return_mean": 1248.6312500000026, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200100, "num_agent_steps_trained": 199800, "num_env_steps_sampled": 200100, "num_env_steps_trained": 199800, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 247.72030319895885, "num_env_steps_trained_throughput_per_sec": 233.14852065784362, "timesteps_total": 200100, "num_env_steps_sampled_lifetime": 200100, "num_agent_steps_sampled_lifetime": 200100, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 200100, "timers": {"training_iteration_time_ms": 10378.364, "restore_workers_time_ms": 0.011, "training_step_time_ms": 613.32, "sample_time_ms": 596.92, "synch_weights_time_ms": 14.856}, "counters": {"num_env_steps_sampled": 200100, "num_env_steps_trained": 199800, "num_agent_steps_sampled": 200100, "num_agent_steps_trained": 199800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1334, "num_samples_added_to_queue": 200100}, "done": false, "training_iteration": 79, "trial_id": "27800_00000", "date": "2024-10-12_15-41-29", "timestamp": 1728744089, "time_this_iter_s": 10.305560827255249, "time_total_s": 817.1014428138733, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f12d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 817.1014428138733, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 16.56666666666667, "ram_util_percent": 41.16}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 8359.2705078125, "policy_loss": 3113.16357421875, "entropy": 4.579822540283203, "entropy_coeff": 0.01, "var_gnorm": 17.823043823242188, "vf_loss": 525984.6875, "vf_explained_var": 0.616870641708374}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 673.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 202200, "num_env_steps_trained": 201900, "num_agent_steps_sampled": 202200, "num_agent_steps_trained": 201900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1348, "num_samples_added_to_queue": 202200, "learner_queue": {"size_count": 673, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 75.281, "learner_load_time_ms": 0.338, "learner_load_wait_time_ms": 1354.634, "learner_dequeue_time_ms": 10106.217}}, "env_runners": {"episode_reward_max": 1252.8500000000029, "episode_reward_min": 1243.2333333333358, "episode_reward_mean": 1249.609916666669, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1243.2333333333358}, "policy_reward_max": {"default_policy": 1252.8500000000029}, "policy_reward_mean": {"default_policy": 1249.609916666669}, "custom_metrics": {"num_consolidated_mean": 2.9937000000000005, "num_consolidated_min": 2.97, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.19390000000000002, "num_moves_min": 0.02, "num_moves_max": 0.38, "mean_accuracy_mean": 42.99081666666667, "mean_accuracy_min": 42.95566666666667, "mean_accuracy_max": 43.01266666666668, "num_model_switches_mean": 0.0356, "num_model_switches_min": 0.0, "num_model_switches_max": 0.12, "num_slav_mean": 0.08191283333333332, "num_slav_min": 0.08096666666666667, "num_slav_max": 0.08341666666666667, "cpu_conserved_cost_mean": 7.9748, "cpu_conserved_cost_min": 7.88, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5417752156876263, "mean_cluster_cpu_util_min": 0.5381061661150948, "mean_cluster_cpu_util_max": 0.5454367760617761, "mean_cluster_mem_util_mean": 0.33837122362869204, "mean_cluster_mem_util_min": 0.3370199103375528, "mean_cluster_mem_util_max": 0.3391334388185654, "reward_consolidation_mean_mean": 6.236875, "reward_consolidation_mean_min": 6.187499999999999, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 7.487916666666694, "reward_accuracy_mean_min": 7.441666666666695, "reward_accuracy_mean_max": 7.516666666666695, "reward_sla_mean_mean": -1.2286925, "reward_sla_mean_min": -1.2512499999999998, "reward_sla_mean_max": -1.2145, "reward_consolidation_sum_mean": 623.6875, "reward_consolidation_sum_min": 618.7499999999999, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 748.7916666666696, "reward_accuracy_sum_min": 744.1666666666695, "reward_accuracy_sum_max": 751.6666666666695, "reward_sla_sum_mean": -122.86925, "reward_sla_sum_min": -125.12499999999999, "reward_sla_sum_max": -121.44999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3383.0, "global_timestep_min": 1700, "global_timestep_max": 5000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1243.808333333336, 1248.2166666666694, 1249.0583333333361, 1245.891666666669, 1243.733333333336, 1247.7916666666695, 1248.9166666666692, 1244.733333333336, 1249.3833333333362, 1245.7333333333358, 1250.083333333336, 1249.4833333333358, 1249.0250000000021, 1244.6250000000025, 1248.7083333333358, 1252.0166666666694, 1248.5333333333356, 1250.1500000000024, 1245.1250000000032, 1250.1833333333357, 1246.7916666666695, 1251.7416666666697, 1250.6500000000021, 1247.7916666666688, 1249.4500000000025, 1251.050000000003, 1243.2333333333358, 1247.033333333336, 1251.5416666666688, 1248.983333333336, 1248.1333333333362, 1247.783333333336, 1250.533333333336, 1252.0166666666692, 1248.5750000000025, 1250.6083333333354, 1248.383333333336, 1248.8083333333363, 1246.3500000000024, 1248.000000000003, 1249.6083333333358, 1249.5416666666692, 1249.9500000000025, 1249.9083333333358, 1247.5250000000028, 1250.4750000000024, 1250.4666666666694, 1246.316666666669, 1248.425000000003, 1250.5083333333355, 1249.0833333333358, 1250.2500000000023, 1248.308333333336, 1251.1666666666695, 1251.9666666666694, 1248.3000000000034, 1248.5750000000023, 1248.3083333333366, 1250.683333333336, 1251.1833333333357, 1249.7500000000025, 1252.3000000000025, 1252.8500000000029, 1250.9833333333358, 1252.166666666669, 1251.358333333336, 1252.7083333333362, 1252.6833333333357, 1251.3416666666685, 1251.4666666666692, 1248.4500000000023, 1248.8916666666685, 1247.0750000000025, 1251.416666666669, 1248.8916666666687, 1248.2250000000029, 1250.6083333333356, 1251.158333333336, 1250.916666666669, 1251.6833333333361, 1250.3916666666696, 1252.800000000003, 1250.7583333333362, 1251.8416666666692, 1251.741666666669, 1252.3916666666698, 1252.1750000000027, 1250.0500000000031, 1250.6583333333353, 1249.1583333333358, 1252.0250000000026, 1252.375000000002, 1251.191666666669, 1252.0916666666697, 1252.350000000003, 1248.4500000000035, 1250.8916666666696, 1252.2750000000026, 1250.158333333336, 1249.0833333333355], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1243.808333333336, 1248.2166666666694, 1249.0583333333361, 1245.891666666669, 1243.733333333336, 1247.7916666666695, 1248.9166666666692, 1244.733333333336, 1249.3833333333362, 1245.7333333333358, 1250.083333333336, 1249.4833333333358, 1249.0250000000021, 1244.6250000000025, 1248.7083333333358, 1252.0166666666694, 1248.5333333333356, 1250.1500000000024, 1245.1250000000032, 1250.1833333333357, 1246.7916666666695, 1251.7416666666697, 1250.6500000000021, 1247.7916666666688, 1249.4500000000025, 1251.050000000003, 1243.2333333333358, 1247.033333333336, 1251.5416666666688, 1248.983333333336, 1248.1333333333362, 1247.783333333336, 1250.533333333336, 1252.0166666666692, 1248.5750000000025, 1250.6083333333354, 1248.383333333336, 1248.8083333333363, 1246.3500000000024, 1248.000000000003, 1249.6083333333358, 1249.5416666666692, 1249.9500000000025, 1249.9083333333358, 1247.5250000000028, 1250.4750000000024, 1250.4666666666694, 1246.316666666669, 1248.425000000003, 1250.5083333333355, 1249.0833333333358, 1250.2500000000023, 1248.308333333336, 1251.1666666666695, 1251.9666666666694, 1248.3000000000034, 1248.5750000000023, 1248.3083333333366, 1250.683333333336, 1251.1833333333357, 1249.7500000000025, 1252.3000000000025, 1252.8500000000029, 1250.9833333333358, 1252.166666666669, 1251.358333333336, 1252.7083333333362, 1252.6833333333357, 1251.3416666666685, 1251.4666666666692, 1248.4500000000023, 1248.8916666666685, 1247.0750000000025, 1251.416666666669, 1248.8916666666687, 1248.2250000000029, 1250.6083333333356, 1251.158333333336, 1250.916666666669, 1251.6833333333361, 1250.3916666666696, 1252.800000000003, 1250.7583333333362, 1251.8416666666692, 1251.741666666669, 1252.3916666666698, 1252.1750000000027, 1250.0500000000031, 1250.6583333333353, 1249.1583333333358, 1252.0250000000026, 1252.375000000002, 1251.191666666669, 1252.0916666666697, 1252.350000000003, 1248.4500000000035, 1250.8916666666696, 1252.2750000000026, 1250.158333333336, 1249.0833333333355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2416871157484035, "mean_inference_ms": 2.051265293001255, "mean_action_processing_ms": 0.09094545451748759, "mean_env_wait_ms": 1.5341115025742869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068781375885009766, "StateBufferConnector_ms": 0.003525972366333008, "ViewRequirementAgentConnector_ms": 0.0908362865447998}, "num_episodes": 21, "episode_return_max": 1252.8500000000029, "episode_return_min": 1243.2333333333358, "episode_return_mean": 1249.609916666669, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 202200, "num_agent_steps_trained": 201900, "num_env_steps_sampled": 202200, "num_env_steps_trained": 201900, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 197.13835056753237, "num_env_steps_trained_throughput_per_sec": 197.13835056753237, "timesteps_total": 202200, "num_env_steps_sampled_lifetime": 202200, "num_agent_steps_sampled_lifetime": 202200, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 202200, "timers": {"training_iteration_time_ms": 10398.177, "restore_workers_time_ms": 0.012, "training_step_time_ms": 816.648, "sample_time_ms": 799.325, "synch_weights_time_ms": 15.63}, "counters": {"num_env_steps_sampled": 202200, "num_env_steps_trained": 201900, "num_agent_steps_sampled": 202200, "num_agent_steps_trained": 201900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1348, "num_samples_added_to_queue": 202200}, "done": false, "training_iteration": 80, "trial_id": "27800_00000", "date": "2024-10-12_15-41-39", "timestamp": 1728744099, "time_this_iter_s": 10.671480178833008, "time_total_s": 827.7729229927063, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f6afb0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 827.7729229927063, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 28.96, "ram_util_percent": 44.29333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4866.76171875, "policy_loss": 786.63623046875, "entropy": 4.596112251281738, "entropy_coeff": 0.01, "var_gnorm": 17.95410919189453, "vf_loss": 409391.375, "vf_explained_var": 0.6409233808517456}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 682.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 204900, "num_env_steps_trained": 204600, "num_agent_steps_sampled": 204900, "num_agent_steps_trained": 204600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1366, "num_samples_added_to_queue": 204900, "learner_queue": {"size_count": 682, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 72.945, "learner_load_time_ms": 0.356, "learner_load_wait_time_ms": 1089.375, "learner_dequeue_time_ms": 10032.232}}, "env_runners": {"episode_reward_max": 1253.2250000000029, "episode_reward_min": 1246.316666666669, "episode_reward_mean": 1250.695583333336, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1246.316666666669}, "policy_reward_max": {"default_policy": 1253.2250000000029}, "policy_reward_mean": {"default_policy": 1250.695583333336}, "custom_metrics": {"num_consolidated_mean": 2.9960000000000004, "num_consolidated_min": 2.98, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.1663, "num_moves_min": 0.02, "num_moves_max": 0.38, "mean_accuracy_mean": 42.99423666666667, "mean_accuracy_min": 42.97466666666667, "mean_accuracy_max": 43.01266666666668, "num_model_switches_mean": 0.0216, "num_model_switches_min": 0.0, "num_model_switches_max": 0.08, "num_slav_mean": 0.0818085, "num_slav_min": 0.0811, "num_slav_max": 0.08328333333333335, "cpu_conserved_cost_mean": 7.984, "cpu_conserved_cost_min": 7.92, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5422305845226603, "mean_cluster_cpu_util_min": 0.5392905520316235, "mean_cluster_cpu_util_max": 0.5454367760617761, "mean_cluster_mem_util_mean": 0.3385121228902953, "mean_cluster_mem_util_min": 0.33745754219409285, "mean_cluster_mem_util_max": 0.3391814345991561, "reward_consolidation_mean_mean": 6.241666666666667, "reward_consolidation_mean_min": 6.208333333333332, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 7.492416666666693, "reward_accuracy_mean_min": 7.466666666666694, "reward_accuracy_mean_max": 7.516666666666695, "reward_sla_mean_mean": -1.2271274999999997, "reward_sla_mean_min": -1.2492499999999997, "reward_sla_mean_max": -1.2165, "reward_consolidation_sum_mean": 624.1666666666667, "reward_consolidation_sum_min": 620.8333333333333, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 749.2416666666695, "reward_accuracy_sum_min": 746.6666666666695, "reward_accuracy_sum_max": 751.6666666666695, "reward_sla_sum_mean": -122.71275, "reward_sla_sum_min": -124.92499999999997, "reward_sla_sum_max": -121.64999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4283.0, "global_timestep_min": 2600, "global_timestep_max": 5900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1247.033333333336, 1251.5416666666688, 1248.983333333336, 1248.1333333333362, 1247.783333333336, 1250.533333333336, 1252.0166666666692, 1248.5750000000025, 1250.6083333333354, 1248.383333333336, 1248.8083333333363, 1246.3500000000024, 1248.000000000003, 1249.6083333333358, 1249.5416666666692, 1249.9500000000025, 1249.9083333333358, 1247.5250000000028, 1250.4750000000024, 1250.4666666666694, 1246.316666666669, 1248.425000000003, 1250.5083333333355, 1249.0833333333358, 1250.2500000000023, 1248.308333333336, 1251.1666666666695, 1251.9666666666694, 1248.3000000000034, 1248.5750000000023, 1248.3083333333366, 1250.683333333336, 1251.1833333333357, 1249.7500000000025, 1252.3000000000025, 1252.8500000000029, 1250.9833333333358, 1252.166666666669, 1251.358333333336, 1252.7083333333362, 1252.6833333333357, 1251.3416666666685, 1251.4666666666692, 1248.4500000000023, 1248.8916666666685, 1247.0750000000025, 1251.416666666669, 1248.8916666666687, 1248.2250000000029, 1250.6083333333356, 1251.158333333336, 1250.916666666669, 1251.6833333333361, 1250.3916666666696, 1252.800000000003, 1250.7583333333362, 1251.8416666666692, 1251.741666666669, 1252.3916666666698, 1252.1750000000027, 1250.0500000000031, 1250.6583333333353, 1249.1583333333358, 1252.0250000000026, 1252.375000000002, 1251.191666666669, 1252.0916666666697, 1252.350000000003, 1248.4500000000035, 1250.8916666666696, 1252.2750000000026, 1250.158333333336, 1249.0833333333355, 1251.3083333333361, 1252.5000000000025, 1250.216666666669, 1252.6000000000024, 1251.6000000000026, 1252.000000000003, 1251.016666666669, 1251.7250000000024, 1252.2500000000025, 1251.1166666666688, 1252.575000000003, 1253.0500000000031, 1252.700000000002, 1252.7500000000023, 1253.1250000000025, 1251.925000000003, 1252.7500000000025, 1252.2750000000024, 1249.4916666666693, 1251.291666666669, 1253.2250000000029, 1252.9000000000026, 1252.750000000003, 1250.833333333336, 1251.9750000000024, 1251.7250000000026, 1252.8000000000031], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1247.033333333336, 1251.5416666666688, 1248.983333333336, 1248.1333333333362, 1247.783333333336, 1250.533333333336, 1252.0166666666692, 1248.5750000000025, 1250.6083333333354, 1248.383333333336, 1248.8083333333363, 1246.3500000000024, 1248.000000000003, 1249.6083333333358, 1249.5416666666692, 1249.9500000000025, 1249.9083333333358, 1247.5250000000028, 1250.4750000000024, 1250.4666666666694, 1246.316666666669, 1248.425000000003, 1250.5083333333355, 1249.0833333333358, 1250.2500000000023, 1248.308333333336, 1251.1666666666695, 1251.9666666666694, 1248.3000000000034, 1248.5750000000023, 1248.3083333333366, 1250.683333333336, 1251.1833333333357, 1249.7500000000025, 1252.3000000000025, 1252.8500000000029, 1250.9833333333358, 1252.166666666669, 1251.358333333336, 1252.7083333333362, 1252.6833333333357, 1251.3416666666685, 1251.4666666666692, 1248.4500000000023, 1248.8916666666685, 1247.0750000000025, 1251.416666666669, 1248.8916666666687, 1248.2250000000029, 1250.6083333333356, 1251.158333333336, 1250.916666666669, 1251.6833333333361, 1250.3916666666696, 1252.800000000003, 1250.7583333333362, 1251.8416666666692, 1251.741666666669, 1252.3916666666698, 1252.1750000000027, 1250.0500000000031, 1250.6583333333353, 1249.1583333333358, 1252.0250000000026, 1252.375000000002, 1251.191666666669, 1252.0916666666697, 1252.350000000003, 1248.4500000000035, 1250.8916666666696, 1252.2750000000026, 1250.158333333336, 1249.0833333333355, 1251.3083333333361, 1252.5000000000025, 1250.216666666669, 1252.6000000000024, 1251.6000000000026, 1252.000000000003, 1251.016666666669, 1251.7250000000024, 1252.2500000000025, 1251.1166666666688, 1252.575000000003, 1253.0500000000031, 1252.700000000002, 1252.7500000000023, 1253.1250000000025, 1251.925000000003, 1252.7500000000025, 1252.2750000000024, 1249.4916666666693, 1251.291666666669, 1253.2250000000029, 1252.9000000000026, 1252.750000000003, 1250.833333333336, 1251.9750000000024, 1251.7250000000026, 1252.8000000000031]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2417305144736077, "mean_inference_ms": 2.052243851533799, "mean_action_processing_ms": 0.0909726495186467, "mean_env_wait_ms": 1.534549091981728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006531238555908203, "StateBufferConnector_ms": 0.003385782241821289, "ViewRequirementAgentConnector_ms": 0.08724117279052734}, "num_episodes": 27, "episode_return_max": 1253.2250000000029, "episode_return_min": 1246.316666666669, "episode_return_mean": 1250.695583333336, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204900, "num_agent_steps_trained": 204600, "num_env_steps_sampled": 204900, "num_env_steps_trained": 204600, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 268.3129431176705, "num_env_steps_trained_throughput_per_sec": 268.3129431176705, "timesteps_total": 204900, "num_env_steps_sampled_lifetime": 204900, "num_agent_steps_sampled_lifetime": 204900, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 204900, "timers": {"training_iteration_time_ms": 10402.517, "restore_workers_time_ms": 0.013, "training_step_time_ms": 564.053, "sample_time_ms": 548.264, "synch_weights_time_ms": 14.268}, "counters": {"num_env_steps_sampled": 204900, "num_env_steps_trained": 204600, "num_agent_steps_sampled": 204900, "num_agent_steps_trained": 204600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1366, "num_samples_added_to_queue": 204900}, "done": false, "training_iteration": 81, "trial_id": "27800_00000", "date": "2024-10-12_15-41-49", "timestamp": 1728744109, "time_this_iter_s": 10.073166131973267, "time_total_s": 837.8460891246796, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f2890>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 837.8460891246796, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 15.133333333333333, "ram_util_percent": 46.833333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3205.409423828125, "policy_loss": -61.66783905029297, "entropy": 4.82537317276001, "entropy_coeff": 0.01, "var_gnorm": 18.068387985229492, "vf_loss": 328155.34375, "vf_explained_var": 0.6629433631896973}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 692.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 207750, "num_env_steps_trained": 207600, "num_agent_steps_sampled": 207750, "num_agent_steps_trained": 207600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1385, "num_samples_added_to_queue": 207600, "learner_queue": {"size_count": 692, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.656, "learner_load_time_ms": 0.318, "learner_load_wait_time_ms": 1041.401, "learner_dequeue_time_ms": 9930.869}}, "env_runners": {"episode_reward_max": 1253.3250000000023, "episode_reward_min": 1247.0750000000025, "episode_reward_mean": 1251.5503333333359, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1247.0750000000025}, "policy_reward_max": {"default_policy": 1253.3250000000023}, "policy_reward_mean": {"default_policy": 1251.5503333333359}, "custom_metrics": {"num_consolidated_mean": 2.9986, "num_consolidated_min": 2.98, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.16959999999999997, "num_moves_min": 0.02, "num_moves_max": 0.38, "mean_accuracy_mean": 42.99639, "mean_accuracy_min": 42.97466666666667, "mean_accuracy_max": 43.01266666666668, "num_model_switches_mean": 0.0144, "num_model_switches_min": 0.0, "num_model_switches_max": 0.06, "num_slav_mean": 0.08178866666666666, "num_slav_min": 0.0811, "num_slav_max": 0.08328333333333335, "cpu_conserved_cost_mean": 7.994400000000001, "cpu_conserved_cost_min": 7.92, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5427299384939787, "mean_cluster_cpu_util_min": 0.5401665287736716, "mean_cluster_cpu_util_max": 0.5454367760617761, "mean_cluster_mem_util_mean": 0.3386696492616034, "mean_cluster_mem_util_min": 0.3378702531645569, "mean_cluster_mem_util_max": 0.3391814345991561, "reward_consolidation_mean_mean": 6.247083333333332, "reward_consolidation_mean_min": 6.208333333333332, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 7.495250000000027, "reward_accuracy_mean_min": 7.466666666666694, "reward_accuracy_mean_max": 7.516666666666695, "reward_sla_mean_mean": -1.2268299999999999, "reward_sla_mean_min": -1.2492499999999997, "reward_sla_mean_max": -1.2165, "reward_consolidation_sum_mean": 624.7083333333333, "reward_consolidation_sum_min": 620.8333333333333, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 749.5250000000029, "reward_accuracy_sum_min": 746.6666666666695, "reward_accuracy_sum_max": 751.6666666666695, "reward_sla_sum_mean": -122.68299999999999, "reward_sla_sum_min": -124.92499999999997, "reward_sla_sum_max": -121.64999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5182.0, "global_timestep_min": 3500, "global_timestep_max": 6800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1251.9666666666694, 1248.3000000000034, 1248.5750000000023, 1248.3083333333366, 1250.683333333336, 1251.1833333333357, 1249.7500000000025, 1252.3000000000025, 1252.8500000000029, 1250.9833333333358, 1252.166666666669, 1251.358333333336, 1252.7083333333362, 1252.6833333333357, 1251.3416666666685, 1251.4666666666692, 1248.4500000000023, 1248.8916666666685, 1247.0750000000025, 1251.416666666669, 1248.8916666666687, 1248.2250000000029, 1250.6083333333356, 1251.158333333336, 1250.916666666669, 1251.6833333333361, 1250.3916666666696, 1252.800000000003, 1250.7583333333362, 1251.8416666666692, 1251.741666666669, 1252.3916666666698, 1252.1750000000027, 1250.0500000000031, 1250.6583333333353, 1249.1583333333358, 1252.0250000000026, 1252.375000000002, 1251.191666666669, 1252.0916666666697, 1252.350000000003, 1248.4500000000035, 1250.8916666666696, 1252.2750000000026, 1250.158333333336, 1249.0833333333355, 1251.3083333333361, 1252.5000000000025, 1250.216666666669, 1252.6000000000024, 1251.6000000000026, 1252.000000000003, 1251.016666666669, 1251.7250000000024, 1252.2500000000025, 1251.1166666666688, 1252.575000000003, 1253.0500000000031, 1252.700000000002, 1252.7500000000023, 1253.1250000000025, 1251.925000000003, 1252.7500000000025, 1252.2750000000024, 1249.4916666666693, 1251.291666666669, 1253.2250000000029, 1252.9000000000026, 1252.750000000003, 1250.833333333336, 1251.9750000000024, 1251.7250000000026, 1252.8000000000031, 1252.5750000000028, 1251.6416666666694, 1252.308333333336, 1252.275000000003, 1252.5500000000022, 1251.7500000000025, 1252.200000000002, 1251.9250000000027, 1252.3000000000022, 1252.7500000000023, 1252.4000000000026, 1252.1750000000027, 1252.5833333333362, 1252.1250000000032, 1252.3500000000026, 1251.9500000000023, 1251.775000000002, 1253.3250000000023, 1252.0500000000025, 1252.6250000000025, 1252.6500000000021, 1252.175000000003, 1253.0000000000025, 1251.8000000000022, 1252.7750000000026, 1253.100000000003, 1252.6250000000027], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1251.9666666666694, 1248.3000000000034, 1248.5750000000023, 1248.3083333333366, 1250.683333333336, 1251.1833333333357, 1249.7500000000025, 1252.3000000000025, 1252.8500000000029, 1250.9833333333358, 1252.166666666669, 1251.358333333336, 1252.7083333333362, 1252.6833333333357, 1251.3416666666685, 1251.4666666666692, 1248.4500000000023, 1248.8916666666685, 1247.0750000000025, 1251.416666666669, 1248.8916666666687, 1248.2250000000029, 1250.6083333333356, 1251.158333333336, 1250.916666666669, 1251.6833333333361, 1250.3916666666696, 1252.800000000003, 1250.7583333333362, 1251.8416666666692, 1251.741666666669, 1252.3916666666698, 1252.1750000000027, 1250.0500000000031, 1250.6583333333353, 1249.1583333333358, 1252.0250000000026, 1252.375000000002, 1251.191666666669, 1252.0916666666697, 1252.350000000003, 1248.4500000000035, 1250.8916666666696, 1252.2750000000026, 1250.158333333336, 1249.0833333333355, 1251.3083333333361, 1252.5000000000025, 1250.216666666669, 1252.6000000000024, 1251.6000000000026, 1252.000000000003, 1251.016666666669, 1251.7250000000024, 1252.2500000000025, 1251.1166666666688, 1252.575000000003, 1253.0500000000031, 1252.700000000002, 1252.7500000000023, 1253.1250000000025, 1251.925000000003, 1252.7500000000025, 1252.2750000000024, 1249.4916666666693, 1251.291666666669, 1253.2250000000029, 1252.9000000000026, 1252.750000000003, 1250.833333333336, 1251.9750000000024, 1251.7250000000026, 1252.8000000000031, 1252.5750000000028, 1251.6416666666694, 1252.308333333336, 1252.275000000003, 1252.5500000000022, 1251.7500000000025, 1252.200000000002, 1251.9250000000027, 1252.3000000000022, 1252.7500000000023, 1252.4000000000026, 1252.1750000000027, 1252.5833333333362, 1252.1250000000032, 1252.3500000000026, 1251.9500000000023, 1251.775000000002, 1253.3250000000023, 1252.0500000000025, 1252.6250000000025, 1252.6500000000021, 1252.175000000003, 1253.0000000000025, 1251.8000000000022, 1252.7750000000026, 1253.100000000003, 1252.6250000000027]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2416302610000092, "mean_inference_ms": 2.0506580395169967, "mean_action_processing_ms": 0.09093935458436796, "mean_env_wait_ms": 1.5340667197112396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006151676177978516, "StateBufferConnector_ms": 0.0032644271850585938, "ViewRequirementAgentConnector_ms": 0.08387184143066406}, "num_episodes": 27, "episode_return_max": 1253.3250000000023, "episode_return_min": 1247.0750000000025, "episode_return_mean": 1251.5503333333359, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 207750, "num_agent_steps_trained": 207600, "num_env_steps_sampled": 207750, "num_env_steps_trained": 207600, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 271.20182576800295, "num_env_steps_trained_throughput_per_sec": 285.47560607158204, "timesteps_total": 207750, "num_env_steps_sampled_lifetime": 207750, "num_agent_steps_sampled_lifetime": 207750, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 207750, "timers": {"training_iteration_time_ms": 10407.438, "restore_workers_time_ms": 0.012, "training_step_time_ms": 553.639, "sample_time_ms": 538.686, "synch_weights_time_ms": 13.588}, "counters": {"num_env_steps_sampled": 207750, "num_env_steps_trained": 207600, "num_agent_steps_sampled": 207750, "num_agent_steps_trained": 207600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1385, "num_samples_added_to_queue": 207600}, "done": false, "training_iteration": 82, "trial_id": "27800_00000", "date": "2024-10-12_15-42-00", "timestamp": 1728744120, "time_this_iter_s": 10.518599033355713, "time_total_s": 848.3646881580353, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f6a740>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 848.3646881580353, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 16.166666666666668, "ram_util_percent": 46.27333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4959.45947265625, "policy_loss": 1028.6907958984375, "entropy": 4.893160343170166, "entropy_coeff": 0.01, "var_gnorm": 18.113624572753906, "vf_loss": 394544.8125, "vf_explained_var": 0.6411815881729126}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 700.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 210300, "num_env_steps_trained": 210000, "num_agent_steps_sampled": 210300, "num_agent_steps_trained": 210000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1402, "num_samples_added_to_queue": 210300, "learner_queue": {"size_count": 700, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.002, "learner_load_time_ms": 0.299, "learner_load_wait_time_ms": 1176.298, "learner_dequeue_time_ms": 9825.197}}, "env_runners": {"episode_reward_max": 1253.4250000000027, "episode_reward_min": 1248.4500000000035, "episode_reward_mean": 1252.0429166666693, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1248.4500000000035}, "policy_reward_max": {"default_policy": 1253.4250000000027}, "policy_reward_mean": {"default_policy": 1252.0429166666693}, "custom_metrics": {"num_consolidated_mean": 2.9995000000000003, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2158, "num_moves_min": 0.02, "num_moves_max": 0.49, "mean_accuracy_mean": 42.99873333333335, "mean_accuracy_min": 42.981, "mean_accuracy_max": 43.01266666666668, "num_model_switches_mean": 0.0072, "num_model_switches_min": 0.0, "num_model_switches_max": 0.06, "num_slav_mean": 0.08179083333333333, "num_slav_min": 0.08105000000000002, "num_slav_max": 0.08328333333333335, "cpu_conserved_cost_mean": 7.997999999999999, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5432713273062603, "mean_cluster_cpu_util_min": 0.5408636468100755, "mean_cluster_cpu_util_max": 0.5467595490899062, "mean_cluster_mem_util_mean": 0.3387340783227848, "mean_cluster_mem_util_min": 0.3378702531645569, "mean_cluster_mem_util_max": 0.3391814345991561, "reward_consolidation_mean_mean": 6.2489583333333325, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 7.498333333333361, "reward_accuracy_mean_min": 7.475000000000028, "reward_accuracy_mean_max": 7.516666666666695, "reward_sla_mean_mean": -1.2268625, "reward_sla_mean_min": -1.2492499999999997, "reward_sla_mean_max": -1.2157499999999999, "reward_consolidation_sum_mean": 624.8958333333333, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 749.8333333333362, "reward_accuracy_sum_min": 747.5000000000028, "reward_accuracy_sum_max": 751.6666666666695, "reward_sla_sum_mean": -122.68624999999996, "reward_sla_sum_min": -124.92499999999997, "reward_sla_sum_max": -121.57499999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6082.0, "global_timestep_min": 4400, "global_timestep_max": 7700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1252.800000000003, 1250.7583333333362, 1251.8416666666692, 1251.741666666669, 1252.3916666666698, 1252.1750000000027, 1250.0500000000031, 1250.6583333333353, 1249.1583333333358, 1252.0250000000026, 1252.375000000002, 1251.191666666669, 1252.0916666666697, 1252.350000000003, 1248.4500000000035, 1250.8916666666696, 1252.2750000000026, 1250.158333333336, 1249.0833333333355, 1251.3083333333361, 1252.5000000000025, 1250.216666666669, 1252.6000000000024, 1251.6000000000026, 1252.000000000003, 1251.016666666669, 1251.7250000000024, 1252.2500000000025, 1251.1166666666688, 1252.575000000003, 1253.0500000000031, 1252.700000000002, 1252.7500000000023, 1253.1250000000025, 1251.925000000003, 1252.7500000000025, 1252.2750000000024, 1249.4916666666693, 1251.291666666669, 1253.2250000000029, 1252.9000000000026, 1252.750000000003, 1250.833333333336, 1251.9750000000024, 1251.7250000000026, 1252.8000000000031, 1252.5750000000028, 1251.6416666666694, 1252.308333333336, 1252.275000000003, 1252.5500000000022, 1251.7500000000025, 1252.200000000002, 1251.9250000000027, 1252.3000000000022, 1252.7500000000023, 1252.4000000000026, 1252.1750000000027, 1252.5833333333362, 1252.1250000000032, 1252.3500000000026, 1251.9500000000023, 1251.775000000002, 1253.3250000000023, 1252.0500000000025, 1252.6250000000025, 1252.6500000000021, 1252.175000000003, 1253.0000000000025, 1251.8000000000022, 1252.7750000000026, 1253.100000000003, 1252.6250000000027, 1252.775000000003, 1252.4500000000019, 1252.5750000000025, 1252.8000000000034, 1252.1000000000024, 1251.6750000000022, 1251.5916666666685, 1252.1750000000025, 1253.3000000000025, 1252.4000000000024, 1252.2250000000022, 1251.5750000000028, 1252.275000000003, 1252.0333333333356, 1252.7250000000029, 1251.9000000000033, 1252.0750000000028, 1251.9250000000027, 1252.550000000002, 1252.1333333333355, 1252.600000000003, 1252.375000000002, 1253.4250000000027, 1252.450000000003, 1252.4750000000024, 1252.4083333333358, 1252.6000000000024], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1252.800000000003, 1250.7583333333362, 1251.8416666666692, 1251.741666666669, 1252.3916666666698, 1252.1750000000027, 1250.0500000000031, 1250.6583333333353, 1249.1583333333358, 1252.0250000000026, 1252.375000000002, 1251.191666666669, 1252.0916666666697, 1252.350000000003, 1248.4500000000035, 1250.8916666666696, 1252.2750000000026, 1250.158333333336, 1249.0833333333355, 1251.3083333333361, 1252.5000000000025, 1250.216666666669, 1252.6000000000024, 1251.6000000000026, 1252.000000000003, 1251.016666666669, 1251.7250000000024, 1252.2500000000025, 1251.1166666666688, 1252.575000000003, 1253.0500000000031, 1252.700000000002, 1252.7500000000023, 1253.1250000000025, 1251.925000000003, 1252.7500000000025, 1252.2750000000024, 1249.4916666666693, 1251.291666666669, 1253.2250000000029, 1252.9000000000026, 1252.750000000003, 1250.833333333336, 1251.9750000000024, 1251.7250000000026, 1252.8000000000031, 1252.5750000000028, 1251.6416666666694, 1252.308333333336, 1252.275000000003, 1252.5500000000022, 1251.7500000000025, 1252.200000000002, 1251.9250000000027, 1252.3000000000022, 1252.7500000000023, 1252.4000000000026, 1252.1750000000027, 1252.5833333333362, 1252.1250000000032, 1252.3500000000026, 1251.9500000000023, 1251.775000000002, 1253.3250000000023, 1252.0500000000025, 1252.6250000000025, 1252.6500000000021, 1252.175000000003, 1253.0000000000025, 1251.8000000000022, 1252.7750000000026, 1253.100000000003, 1252.6250000000027, 1252.775000000003, 1252.4500000000019, 1252.5750000000025, 1252.8000000000034, 1252.1000000000024, 1251.6750000000022, 1251.5916666666685, 1252.1750000000025, 1253.3000000000025, 1252.4000000000024, 1252.2250000000022, 1251.5750000000028, 1252.275000000003, 1252.0333333333356, 1252.7250000000029, 1251.9000000000033, 1252.0750000000028, 1251.9250000000027, 1252.550000000002, 1252.1333333333355, 1252.600000000003, 1252.375000000002, 1253.4250000000027, 1252.450000000003, 1252.4750000000024, 1252.4083333333358, 1252.6000000000024]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24156336619649682, "mean_inference_ms": 2.0508529144413, "mean_action_processing_ms": 0.09091892351528834, "mean_env_wait_ms": 1.5340410229565422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060460567474365234, "StateBufferConnector_ms": 0.0032503604888916016, "ViewRequirementAgentConnector_ms": 0.0831003189086914}, "num_episodes": 27, "episode_return_max": 1253.4250000000027, "episode_return_min": 1248.4500000000035, "episode_return_mean": 1252.0429166666693, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 210300, "num_agent_steps_trained": 210000, "num_env_steps_sampled": 210300, "num_env_steps_trained": 210000, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 241.4437818561265, "num_env_steps_trained_throughput_per_sec": 227.24120645282494, "timesteps_total": 210300, "num_env_steps_sampled_lifetime": 210300, "num_agent_steps_sampled_lifetime": 210300, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 210300, "timers": {"training_iteration_time_ms": 10446.865, "restore_workers_time_ms": 0.012, "training_step_time_ms": 653.391, "sample_time_ms": 637.305, "synch_weights_time_ms": 14.56}, "counters": {"num_env_steps_sampled": 210300, "num_env_steps_trained": 210000, "num_agent_steps_sampled": 210300, "num_agent_steps_trained": 210000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1402, "num_samples_added_to_queue": 210300}, "done": false, "training_iteration": 83, "trial_id": "27800_00000", "date": "2024-10-12_15-42-11", "timestamp": 1728744131, "time_this_iter_s": 10.57641887664795, "time_total_s": 858.9411070346832, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f34c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 858.9411070346832, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 20.646666666666665, "ram_util_percent": 48.373333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3933.18505859375, "policy_loss": -351.466552734375, "entropy": 4.954327583312988, "entropy_coeff": 0.01, "var_gnorm": 18.13706398010254, "vf_loss": 429951.46875, "vf_explained_var": 0.6266415119171143}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 708.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 212700, "num_env_steps_trained": 212400, "num_agent_steps_sampled": 212700, "num_agent_steps_trained": 212400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1418, "num_samples_added_to_queue": 212700, "learner_queue": {"size_count": 708, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.391, "learner_load_time_ms": 0.277, "learner_load_wait_time_ms": 1245.014, "learner_dequeue_time_ms": 9917.309}}, "env_runners": {"episode_reward_max": 1253.4250000000027, "episode_reward_min": 1249.4916666666693, "episode_reward_mean": 1252.2730833333358, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1249.4916666666693}, "policy_reward_max": {"default_policy": 1253.4250000000027}, "policy_reward_mean": {"default_policy": 1252.2730833333358}, "custom_metrics": {"num_consolidated_mean": 2.9997000000000003, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.31029999999999996, "num_moves_min": 0.04, "num_moves_max": 0.64, "mean_accuracy_mean": 43.000063333333344, "mean_accuracy_min": 42.98733333333334, "mean_accuracy_max": 43.00633333333335, "num_model_switches_mean": 0.0039000000000000003, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.08178183333333332, "num_slav_min": 0.08105000000000002, "num_slav_max": 0.08253333333333333, "cpu_conserved_cost_mean": 7.998800000000001, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5441088530175583, "mean_cluster_cpu_util_min": 0.5409170343813201, "mean_cluster_cpu_util_max": 0.5483066625298768, "mean_cluster_mem_util_mean": 0.3387399274789029, "mean_cluster_mem_util_min": 0.3378702531645569, "mean_cluster_mem_util_max": 0.3391814345991561, "reward_consolidation_mean_mean": 6.249374999999999, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 7.500083333333362, "reward_accuracy_mean_min": 7.483333333333362, "reward_accuracy_mean_max": 7.508333333333362, "reward_sla_mean_mean": -1.2267275, "reward_sla_mean_min": -1.238, "reward_sla_mean_max": -1.2157499999999999, "reward_consolidation_sum_mean": 624.9374999999999, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 750.008333333336, "reward_accuracy_sum_min": 748.3333333333362, "reward_accuracy_sum_max": 750.8333333333362, "reward_sla_sum_mean": -122.67274999999998, "reward_sla_sum_min": -123.8, "reward_sla_sum_max": -121.57499999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5237.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1252.000000000003, 1251.016666666669, 1251.7250000000024, 1252.2500000000025, 1251.1166666666688, 1252.575000000003, 1253.0500000000031, 1252.700000000002, 1252.7500000000023, 1253.1250000000025, 1251.925000000003, 1252.7500000000025, 1252.2750000000024, 1249.4916666666693, 1251.291666666669, 1253.2250000000029, 1252.9000000000026, 1252.750000000003, 1250.833333333336, 1251.9750000000024, 1251.7250000000026, 1252.8000000000031, 1252.5750000000028, 1251.6416666666694, 1252.308333333336, 1252.275000000003, 1252.5500000000022, 1251.7500000000025, 1252.200000000002, 1251.9250000000027, 1252.3000000000022, 1252.7500000000023, 1252.4000000000026, 1252.1750000000027, 1252.5833333333362, 1252.1250000000032, 1252.3500000000026, 1251.9500000000023, 1251.775000000002, 1253.3250000000023, 1252.0500000000025, 1252.6250000000025, 1252.6500000000021, 1252.175000000003, 1253.0000000000025, 1251.8000000000022, 1252.7750000000026, 1253.100000000003, 1252.6250000000027, 1252.775000000003, 1252.4500000000019, 1252.5750000000025, 1252.8000000000034, 1252.1000000000024, 1251.6750000000022, 1251.5916666666685, 1252.1750000000025, 1253.3000000000025, 1252.4000000000024, 1252.2250000000022, 1251.5750000000028, 1252.275000000003, 1252.0333333333356, 1252.7250000000029, 1251.9000000000033, 1252.0750000000028, 1251.9250000000027, 1252.550000000002, 1252.1333333333355, 1252.600000000003, 1252.375000000002, 1253.4250000000027, 1252.450000000003, 1252.4750000000024, 1252.4083333333358, 1252.6000000000024, 1252.5750000000025, 1252.6000000000029, 1251.9000000000028, 1252.525000000003, 1252.4500000000025, 1252.733333333336, 1252.7500000000027, 1252.1083333333356, 1251.4666666666694, 1251.9500000000023, 1251.7250000000024, 1252.0750000000032, 1252.3750000000027, 1251.8500000000026, 1252.1583333333363, 1252.4250000000027, 1252.5500000000027, 1253.0250000000026, 1252.7750000000024, 1252.375000000003, 1252.525000000003, 1252.8250000000025, 1251.8250000000025, 1250.1416666666692], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1252.000000000003, 1251.016666666669, 1251.7250000000024, 1252.2500000000025, 1251.1166666666688, 1252.575000000003, 1253.0500000000031, 1252.700000000002, 1252.7500000000023, 1253.1250000000025, 1251.925000000003, 1252.7500000000025, 1252.2750000000024, 1249.4916666666693, 1251.291666666669, 1253.2250000000029, 1252.9000000000026, 1252.750000000003, 1250.833333333336, 1251.9750000000024, 1251.7250000000026, 1252.8000000000031, 1252.5750000000028, 1251.6416666666694, 1252.308333333336, 1252.275000000003, 1252.5500000000022, 1251.7500000000025, 1252.200000000002, 1251.9250000000027, 1252.3000000000022, 1252.7500000000023, 1252.4000000000026, 1252.1750000000027, 1252.5833333333362, 1252.1250000000032, 1252.3500000000026, 1251.9500000000023, 1251.775000000002, 1253.3250000000023, 1252.0500000000025, 1252.6250000000025, 1252.6500000000021, 1252.175000000003, 1253.0000000000025, 1251.8000000000022, 1252.7750000000026, 1253.100000000003, 1252.6250000000027, 1252.775000000003, 1252.4500000000019, 1252.5750000000025, 1252.8000000000034, 1252.1000000000024, 1251.6750000000022, 1251.5916666666685, 1252.1750000000025, 1253.3000000000025, 1252.4000000000024, 1252.2250000000022, 1251.5750000000028, 1252.275000000003, 1252.0333333333356, 1252.7250000000029, 1251.9000000000033, 1252.0750000000028, 1251.9250000000027, 1252.550000000002, 1252.1333333333355, 1252.600000000003, 1252.375000000002, 1253.4250000000027, 1252.450000000003, 1252.4750000000024, 1252.4083333333358, 1252.6000000000024, 1252.5750000000025, 1252.6000000000029, 1251.9000000000028, 1252.525000000003, 1252.4500000000025, 1252.733333333336, 1252.7500000000027, 1252.1083333333356, 1251.4666666666694, 1251.9500000000023, 1251.7250000000024, 1252.0750000000032, 1252.3750000000027, 1251.8500000000026, 1252.1583333333363, 1252.4250000000027, 1252.5500000000027, 1253.0250000000026, 1252.7750000000024, 1252.375000000003, 1252.525000000003, 1252.8250000000025, 1251.8250000000025, 1250.1416666666692]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2413396662159487, "mean_inference_ms": 2.046551661737853, "mean_action_processing_ms": 0.09082358549108363, "mean_env_wait_ms": 1.532688496217728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006094455718994141, "StateBufferConnector_ms": 0.003142118453979492, "ViewRequirementAgentConnector_ms": 0.0789802074432373}, "num_episodes": 24, "episode_return_max": 1253.4250000000027, "episode_return_min": 1249.4916666666693, "episode_return_mean": 1252.2730833333358, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212700, "num_agent_steps_trained": 212400, "num_env_steps_sampled": 212700, "num_env_steps_trained": 212400, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 237.983578630512, "num_env_steps_trained_throughput_per_sec": 237.983578630512, "timesteps_total": 212700, "num_env_steps_sampled_lifetime": 212700, "num_agent_steps_sampled_lifetime": 212700, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 212700, "timers": {"training_iteration_time_ms": 10403.757, "restore_workers_time_ms": 0.012, "training_step_time_ms": 580.35, "sample_time_ms": 564.917, "synch_weights_time_ms": 13.911}, "counters": {"num_env_steps_sampled": 212700, "num_env_steps_trained": 212400, "num_agent_steps_sampled": 212700, "num_agent_steps_trained": 212400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1418, "num_samples_added_to_queue": 212700}, "done": false, "training_iteration": 84, "trial_id": "27800_00000", "date": "2024-10-12_15-42-21", "timestamp": 1728744141, "time_this_iter_s": 10.103790044784546, "time_total_s": 869.0448970794678, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948952b30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 869.0448970794678, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 19.842857142857138, "ram_util_percent": 51.72857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4831.88916015625, "policy_loss": 590.7208251953125, "entropy": 4.75266695022583, "entropy_coeff": 0.01, "var_gnorm": 18.12659454345703, "vf_loss": 425542.65625, "vf_explained_var": 0.6289305686950684}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 717.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 215250, "num_env_steps_trained": 215100, "num_agent_steps_sampled": 215250, "num_agent_steps_trained": 215100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1435, "num_samples_added_to_queue": 215100, "learner_queue": {"size_count": 717, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 80.213, "learner_load_time_ms": 0.294, "learner_load_wait_time_ms": 1133.794, "learner_dequeue_time_ms": 9861.921}}, "env_runners": {"episode_reward_max": 1253.4250000000027, "episode_reward_min": 1250.1416666666692, "episode_reward_mean": 1252.3113333333358, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1250.1416666666692}, "policy_reward_max": {"default_policy": 1253.4250000000027}, "policy_reward_mean": {"default_policy": 1252.3113333333358}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.36150000000000004, "num_moves_min": 0.08, "num_moves_max": 0.64, "mean_accuracy_mean": 43.000506666666666, "mean_accuracy_min": 42.99366666666667, "mean_accuracy_max": 43.00633333333335, "num_model_switches_mean": 0.0033, "num_model_switches_min": 0.0, "num_model_switches_max": 0.03, "num_slav_mean": 0.08182299999999999, "num_slav_min": 0.08105000000000002, "num_slav_max": 0.08253333333333333, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5457068277716492, "mean_cluster_cpu_util_min": 0.5420307041735614, "mean_cluster_cpu_util_max": 0.551005986854201, "mean_cluster_mem_util_mean": 0.3387516033755274, "mean_cluster_mem_util_min": 0.33812499999999995, "mean_cluster_mem_util_max": 0.3391228902953586, "reward_consolidation_mean_mean": 6.249791666666666, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 7.500666666666693, "reward_accuracy_mean_min": 7.491666666666695, "reward_accuracy_mean_max": 7.508333333333362, "reward_sla_mean_mean": -1.227345, "reward_sla_mean_min": -1.238, "reward_sla_mean_max": -1.2157499999999999, "reward_consolidation_sum_mean": 624.9791666666667, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 750.0666666666694, "reward_accuracy_sum_min": 749.1666666666695, "reward_accuracy_sum_max": 750.8333333333362, "reward_sla_sum_mean": -122.73449999999998, "reward_sla_sum_min": -123.8, "reward_sla_sum_max": -121.57499999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4172.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1252.308333333336, 1252.275000000003, 1252.5500000000022, 1251.7500000000025, 1252.200000000002, 1251.9250000000027, 1252.3000000000022, 1252.7500000000023, 1252.4000000000026, 1252.1750000000027, 1252.5833333333362, 1252.1250000000032, 1252.3500000000026, 1251.9500000000023, 1251.775000000002, 1253.3250000000023, 1252.0500000000025, 1252.6250000000025, 1252.6500000000021, 1252.175000000003, 1253.0000000000025, 1251.8000000000022, 1252.7750000000026, 1253.100000000003, 1252.6250000000027, 1252.775000000003, 1252.4500000000019, 1252.5750000000025, 1252.8000000000034, 1252.1000000000024, 1251.6750000000022, 1251.5916666666685, 1252.1750000000025, 1253.3000000000025, 1252.4000000000024, 1252.2250000000022, 1251.5750000000028, 1252.275000000003, 1252.0333333333356, 1252.7250000000029, 1251.9000000000033, 1252.0750000000028, 1251.9250000000027, 1252.550000000002, 1252.1333333333355, 1252.600000000003, 1252.375000000002, 1253.4250000000027, 1252.450000000003, 1252.4750000000024, 1252.4083333333358, 1252.6000000000024, 1252.5750000000025, 1252.6000000000029, 1251.9000000000028, 1252.525000000003, 1252.4500000000025, 1252.733333333336, 1252.7500000000027, 1252.1083333333356, 1251.4666666666694, 1251.9500000000023, 1251.7250000000024, 1252.0750000000032, 1252.3750000000027, 1251.8500000000026, 1252.1583333333363, 1252.4250000000027, 1252.5500000000027, 1253.0250000000026, 1252.7750000000024, 1252.375000000003, 1252.525000000003, 1252.8250000000025, 1251.8250000000025, 1250.1416666666692, 1252.0500000000025, 1251.725000000003, 1252.1250000000025, 1252.4750000000024, 1251.4250000000025, 1252.3500000000026, 1252.5000000000023, 1251.6750000000027, 1252.7000000000019, 1252.6250000000025, 1251.9750000000026, 1252.925000000003, 1252.8750000000027, 1251.9750000000026, 1252.0333333333358, 1252.2833333333358, 1252.5000000000027, 1251.575000000003, 1253.1750000000025, 1251.7750000000015, 1252.3250000000028, 1252.8250000000028, 1252.3500000000029, 1252.0500000000025], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1252.308333333336, 1252.275000000003, 1252.5500000000022, 1251.7500000000025, 1252.200000000002, 1251.9250000000027, 1252.3000000000022, 1252.7500000000023, 1252.4000000000026, 1252.1750000000027, 1252.5833333333362, 1252.1250000000032, 1252.3500000000026, 1251.9500000000023, 1251.775000000002, 1253.3250000000023, 1252.0500000000025, 1252.6250000000025, 1252.6500000000021, 1252.175000000003, 1253.0000000000025, 1251.8000000000022, 1252.7750000000026, 1253.100000000003, 1252.6250000000027, 1252.775000000003, 1252.4500000000019, 1252.5750000000025, 1252.8000000000034, 1252.1000000000024, 1251.6750000000022, 1251.5916666666685, 1252.1750000000025, 1253.3000000000025, 1252.4000000000024, 1252.2250000000022, 1251.5750000000028, 1252.275000000003, 1252.0333333333356, 1252.7250000000029, 1251.9000000000033, 1252.0750000000028, 1251.9250000000027, 1252.550000000002, 1252.1333333333355, 1252.600000000003, 1252.375000000002, 1253.4250000000027, 1252.450000000003, 1252.4750000000024, 1252.4083333333358, 1252.6000000000024, 1252.5750000000025, 1252.6000000000029, 1251.9000000000028, 1252.525000000003, 1252.4500000000025, 1252.733333333336, 1252.7500000000027, 1252.1083333333356, 1251.4666666666694, 1251.9500000000023, 1251.7250000000024, 1252.0750000000032, 1252.3750000000027, 1251.8500000000026, 1252.1583333333363, 1252.4250000000027, 1252.5500000000027, 1253.0250000000026, 1252.7750000000024, 1252.375000000003, 1252.525000000003, 1252.8250000000025, 1251.8250000000025, 1250.1416666666692, 1252.0500000000025, 1251.725000000003, 1252.1250000000025, 1252.4750000000024, 1251.4250000000025, 1252.3500000000026, 1252.5000000000023, 1251.6750000000027, 1252.7000000000019, 1252.6250000000025, 1251.9750000000026, 1252.925000000003, 1252.8750000000027, 1251.9750000000026, 1252.0333333333358, 1252.2833333333358, 1252.5000000000027, 1251.575000000003, 1253.1750000000025, 1251.7750000000015, 1252.3250000000028, 1252.8250000000028, 1252.3500000000029, 1252.0500000000025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2412619844976993, "mean_inference_ms": 2.049602025701344, "mean_action_processing_ms": 0.09081801924080604, "mean_env_wait_ms": 1.5331863629662963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062313079833984375, "StateBufferConnector_ms": 0.0031616687774658203, "ViewRequirementAgentConnector_ms": 0.08018708229064941}, "num_episodes": 24, "episode_return_max": 1253.4250000000027, "episode_return_min": 1250.1416666666692, "episode_return_mean": 1252.3113333333358, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 215250, "num_agent_steps_trained": 215100, "num_env_steps_sampled": 215250, "num_env_steps_trained": 215100, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 248.2730861252988, "num_env_steps_trained_throughput_per_sec": 262.87738530913987, "timesteps_total": 215250, "num_env_steps_sampled_lifetime": 215250, "num_agent_steps_sampled_lifetime": 215250, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 215250, "timers": {"training_iteration_time_ms": 10389.025, "restore_workers_time_ms": 0.011, "training_step_time_ms": 632.203, "sample_time_ms": 617.72, "synch_weights_time_ms": 13.067}, "counters": {"num_env_steps_sampled": 215250, "num_env_steps_trained": 215100, "num_agent_steps_sampled": 215250, "num_agent_steps_trained": 215100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1435, "num_samples_added_to_queue": 215100}, "done": false, "training_iteration": 85, "trial_id": "27800_00000", "date": "2024-10-12_15-42-31", "timestamp": 1728744151, "time_this_iter_s": 10.280736923217773, "time_total_s": 879.3256340026855, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f2da0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 879.3256340026855, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 18.633333333333333, "ram_util_percent": 51.73333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3253.162353515625, "policy_loss": -252.66732788085938, "entropy": 4.92226505279541, "entropy_coeff": 0.01, "var_gnorm": 18.11175537109375, "vf_loss": 352059.65625, "vf_explained_var": 0.653939962387085}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 726.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 217950, "num_env_steps_trained": 217800, "num_agent_steps_sampled": 217950, "num_agent_steps_trained": 217800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1453, "num_samples_added_to_queue": 217800, "learner_queue": {"size_count": 726, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.462, "learner_load_time_ms": 0.29, "learner_load_wait_time_ms": 1100.851, "learner_dequeue_time_ms": 9866.925}}, "env_runners": {"episode_reward_max": 1253.4250000000027, "episode_reward_min": 1250.1416666666692, "episode_reward_mean": 1252.3137500000025, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1250.1416666666692}, "policy_reward_max": {"default_policy": 1253.4250000000027}, "policy_reward_mean": {"default_policy": 1252.3137500000025}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.3888, "num_moves_min": 0.16, "num_moves_max": 0.64, "mean_accuracy_mean": 43.000443333333344, "mean_accuracy_min": 42.99366666666667, "mean_accuracy_max": 43.00633333333335, "num_model_switches_mean": 0.0031000000000000003, "num_model_switches_min": 0.0, "num_model_switches_max": 0.03, "num_slav_mean": 0.08181583333333334, "num_slav_min": 0.08105000000000002, "num_slav_max": 0.08253333333333333, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5472854322945395, "mean_cluster_cpu_util_min": 0.5420307041735614, "mean_cluster_cpu_util_max": 0.5513755630630631, "mean_cluster_mem_util_mean": 0.33875088607594933, "mean_cluster_mem_util_min": 0.33812499999999995, "mean_cluster_mem_util_max": 0.33909862869198315, "reward_consolidation_mean_mean": 6.249791666666666, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 7.50058333333336, "reward_accuracy_mean_min": 7.491666666666695, "reward_accuracy_mean_max": 7.508333333333362, "reward_sla_mean_mean": -1.2272375, "reward_sla_mean_min": -1.238, "reward_sla_mean_max": -1.2157499999999999, "reward_consolidation_sum_mean": 624.9791666666667, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 750.058333333336, "reward_accuracy_sum_min": 749.1666666666695, "reward_accuracy_sum_max": 750.8333333333362, "reward_sla_sum_mean": -122.72374999999998, "reward_sla_sum_min": -123.8, "reward_sla_sum_max": -121.57499999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2966.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1252.5750000000025, 1252.8000000000034, 1252.1000000000024, 1251.6750000000022, 1251.5916666666685, 1252.1750000000025, 1253.3000000000025, 1252.4000000000024, 1252.2250000000022, 1251.5750000000028, 1252.275000000003, 1252.0333333333356, 1252.7250000000029, 1251.9000000000033, 1252.0750000000028, 1251.9250000000027, 1252.550000000002, 1252.1333333333355, 1252.600000000003, 1252.375000000002, 1253.4250000000027, 1252.450000000003, 1252.4750000000024, 1252.4083333333358, 1252.6000000000024, 1252.5750000000025, 1252.6000000000029, 1251.9000000000028, 1252.525000000003, 1252.4500000000025, 1252.733333333336, 1252.7500000000027, 1252.1083333333356, 1251.4666666666694, 1251.9500000000023, 1251.7250000000024, 1252.0750000000032, 1252.3750000000027, 1251.8500000000026, 1252.1583333333363, 1252.4250000000027, 1252.5500000000027, 1253.0250000000026, 1252.7750000000024, 1252.375000000003, 1252.525000000003, 1252.8250000000025, 1251.8250000000025, 1250.1416666666692, 1252.0500000000025, 1251.725000000003, 1252.1250000000025, 1252.4750000000024, 1251.4250000000025, 1252.3500000000026, 1252.5000000000023, 1251.6750000000027, 1252.7000000000019, 1252.6250000000025, 1251.9750000000026, 1252.925000000003, 1252.8750000000027, 1251.9750000000026, 1252.0333333333358, 1252.2833333333358, 1252.5000000000027, 1251.575000000003, 1253.1750000000025, 1251.7750000000015, 1252.3250000000028, 1252.8250000000028, 1252.3500000000029, 1252.0500000000025, 1252.8750000000027, 1253.100000000003, 1251.9500000000028, 1253.0250000000026, 1251.9750000000026, 1252.5250000000033, 1252.4750000000029, 1252.3000000000027, 1252.5750000000028, 1252.1000000000026, 1252.175000000002, 1252.0500000000027, 1252.6000000000024, 1252.5500000000027, 1252.625000000002, 1252.1333333333362, 1253.1500000000028, 1252.1750000000025, 1252.4500000000023, 1252.5250000000024, 1252.6750000000022, 1252.0500000000025, 1251.7250000000024, 1253.0250000000028, 1252.0750000000023, 1252.1250000000025, 1252.000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1252.5750000000025, 1252.8000000000034, 1252.1000000000024, 1251.6750000000022, 1251.5916666666685, 1252.1750000000025, 1253.3000000000025, 1252.4000000000024, 1252.2250000000022, 1251.5750000000028, 1252.275000000003, 1252.0333333333356, 1252.7250000000029, 1251.9000000000033, 1252.0750000000028, 1251.9250000000027, 1252.550000000002, 1252.1333333333355, 1252.600000000003, 1252.375000000002, 1253.4250000000027, 1252.450000000003, 1252.4750000000024, 1252.4083333333358, 1252.6000000000024, 1252.5750000000025, 1252.6000000000029, 1251.9000000000028, 1252.525000000003, 1252.4500000000025, 1252.733333333336, 1252.7500000000027, 1252.1083333333356, 1251.4666666666694, 1251.9500000000023, 1251.7250000000024, 1252.0750000000032, 1252.3750000000027, 1251.8500000000026, 1252.1583333333363, 1252.4250000000027, 1252.5500000000027, 1253.0250000000026, 1252.7750000000024, 1252.375000000003, 1252.525000000003, 1252.8250000000025, 1251.8250000000025, 1250.1416666666692, 1252.0500000000025, 1251.725000000003, 1252.1250000000025, 1252.4750000000024, 1251.4250000000025, 1252.3500000000026, 1252.5000000000023, 1251.6750000000027, 1252.7000000000019, 1252.6250000000025, 1251.9750000000026, 1252.925000000003, 1252.8750000000027, 1251.9750000000026, 1252.0333333333358, 1252.2833333333358, 1252.5000000000027, 1251.575000000003, 1253.1750000000025, 1251.7750000000015, 1252.3250000000028, 1252.8250000000028, 1252.3500000000029, 1252.0500000000025, 1252.8750000000027, 1253.100000000003, 1251.9500000000028, 1253.0250000000026, 1251.9750000000026, 1252.5250000000033, 1252.4750000000029, 1252.3000000000027, 1252.5750000000028, 1252.1000000000026, 1252.175000000002, 1252.0500000000027, 1252.6000000000024, 1252.5500000000027, 1252.625000000002, 1252.1333333333362, 1253.1500000000028, 1252.1750000000025, 1252.4500000000023, 1252.5250000000024, 1252.6750000000022, 1252.0500000000025, 1251.7250000000024, 1253.0250000000028, 1252.0750000000023, 1252.1250000000025, 1252.000000000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24112354637168396, "mean_inference_ms": 2.049638670780283, "mean_action_processing_ms": 0.09077908412754594, "mean_env_wait_ms": 1.533079218077064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006181240081787109, "StateBufferConnector_ms": 0.003201007843017578, "ViewRequirementAgentConnector_ms": 0.07991266250610352}, "num_episodes": 27, "episode_return_max": 1253.4250000000027, "episode_return_min": 1250.1416666666692, "episode_return_mean": 1252.3137500000025, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 217950, "num_agent_steps_trained": 217800, "num_env_steps_sampled": 217950, "num_env_steps_trained": 217800, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 257.80434719807147, "num_env_steps_trained_throughput_per_sec": 257.80434719807147, "timesteps_total": 217950, "num_env_steps_sampled_lifetime": 217950, "num_agent_steps_sampled_lifetime": 217950, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 217950, "timers": {"training_iteration_time_ms": 10391.991, "restore_workers_time_ms": 0.012, "training_step_time_ms": 575.334, "sample_time_ms": 560.372, "synch_weights_time_ms": 13.601}, "counters": {"num_env_steps_sampled": 217950, "num_env_steps_trained": 217800, "num_agent_steps_sampled": 217950, "num_agent_steps_trained": 217800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1453, "num_samples_added_to_queue": 217800}, "done": false, "training_iteration": 86, "trial_id": "27800_00000", "date": "2024-10-12_15-42-42", "timestamp": 1728744162, "time_this_iter_s": 10.483191013336182, "time_total_s": 889.8088250160217, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d27a30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 889.8088250160217, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 15.019999999999998, "ram_util_percent": 52.51333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4712.533203125, "policy_loss": 877.3924560546875, "entropy": 4.774744510650635, "entropy_coeff": 0.01, "var_gnorm": 18.101490020751953, "vf_loss": 384946.5, "vf_explained_var": 0.6446818113327026}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 735.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 220650, "num_env_steps_trained": 220500, "num_agent_steps_sampled": 220650, "num_agent_steps_trained": 220500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1471, "num_samples_added_to_queue": 220500, "learner_queue": {"size_count": 735, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.878, "learner_load_time_ms": 0.291, "learner_load_wait_time_ms": 1077.325, "learner_dequeue_time_ms": 9839.752}}, "env_runners": {"episode_reward_max": 1253.1750000000025, "episode_reward_min": 1250.1416666666692, "episode_reward_mean": 1252.2645000000027, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1250.1416666666692}, "policy_reward_max": {"default_policy": 1253.1750000000025}, "policy_reward_mean": {"default_policy": 1252.2645000000027}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.40630000000000005, "num_moves_min": 0.16, "num_moves_max": 0.62, "mean_accuracy_mean": 43.00139333333335, "mean_accuracy_min": 42.99366666666667, "mean_accuracy_max": 43.01266666666668, "num_model_switches_mean": 0.005400000000000001, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.081932, "num_slav_min": 0.08121666666666666, "num_slav_max": 0.08396666666666666, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5477390796791689, "mean_cluster_cpu_util_min": 0.5430998460194889, "mean_cluster_cpu_util_max": 0.5513755630630631, "mean_cluster_mem_util_mean": 0.3387814926160337, "mean_cluster_mem_util_min": 0.33812499999999995, "mean_cluster_mem_util_max": 0.33919303797468353, "reward_consolidation_mean_mean": 6.249791666666666, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 7.501833333333361, "reward_accuracy_mean_min": 7.491666666666695, "reward_accuracy_mean_max": 7.516666666666695, "reward_sla_mean_mean": -1.2289799999999997, "reward_sla_mean_min": -1.2594999999999998, "reward_sla_mean_max": -1.2182499999999998, "reward_consolidation_sum_mean": 624.9791666666666, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 750.1833333333363, "reward_accuracy_sum_min": 749.1666666666695, "reward_accuracy_sum_max": 751.6666666666695, "reward_sla_sum_mean": -122.898, "reward_sla_sum_min": -125.94999999999999, "reward_sla_sum_max": -121.82499999999997, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1838.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1251.9000000000028, 1252.525000000003, 1252.4500000000025, 1252.733333333336, 1252.7500000000027, 1252.1083333333356, 1251.4666666666694, 1251.9500000000023, 1251.7250000000024, 1252.0750000000032, 1252.3750000000027, 1251.8500000000026, 1252.1583333333363, 1252.4250000000027, 1252.5500000000027, 1253.0250000000026, 1252.7750000000024, 1252.375000000003, 1252.525000000003, 1252.8250000000025, 1251.8250000000025, 1250.1416666666692, 1252.0500000000025, 1251.725000000003, 1252.1250000000025, 1252.4750000000024, 1251.4250000000025, 1252.3500000000026, 1252.5000000000023, 1251.6750000000027, 1252.7000000000019, 1252.6250000000025, 1251.9750000000026, 1252.925000000003, 1252.8750000000027, 1251.9750000000026, 1252.0333333333358, 1252.2833333333358, 1252.5000000000027, 1251.575000000003, 1253.1750000000025, 1251.7750000000015, 1252.3250000000028, 1252.8250000000028, 1252.3500000000029, 1252.0500000000025, 1252.8750000000027, 1253.100000000003, 1251.9500000000028, 1253.0250000000026, 1251.9750000000026, 1252.5250000000033, 1252.4750000000029, 1252.3000000000027, 1252.5750000000028, 1252.1000000000026, 1252.175000000002, 1252.0500000000027, 1252.6000000000024, 1252.5500000000027, 1252.625000000002, 1252.1333333333362, 1253.1500000000028, 1252.1750000000025, 1252.4500000000023, 1252.5250000000024, 1252.6750000000022, 1252.0500000000025, 1251.7250000000024, 1253.0250000000028, 1252.0750000000023, 1252.1250000000025, 1252.000000000002, 1252.5500000000027, 1251.4333333333357, 1252.4500000000025, 1250.7166666666692, 1252.2500000000023, 1251.7750000000024, 1252.408333333336, 1252.1833333333363, 1251.8916666666694, 1252.0250000000028, 1252.3500000000024, 1252.0916666666694, 1253.1250000000032, 1252.6500000000026, 1252.0750000000025, 1251.7833333333358, 1252.5250000000028, 1253.1250000000025, 1252.9250000000025, 1253.0250000000024, 1251.8583333333358, 1252.2000000000028, 1252.6000000000029, 1252.3833333333362, 1251.1833333333366, 1251.8166666666693, 1251.2166666666694], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1251.9000000000028, 1252.525000000003, 1252.4500000000025, 1252.733333333336, 1252.7500000000027, 1252.1083333333356, 1251.4666666666694, 1251.9500000000023, 1251.7250000000024, 1252.0750000000032, 1252.3750000000027, 1251.8500000000026, 1252.1583333333363, 1252.4250000000027, 1252.5500000000027, 1253.0250000000026, 1252.7750000000024, 1252.375000000003, 1252.525000000003, 1252.8250000000025, 1251.8250000000025, 1250.1416666666692, 1252.0500000000025, 1251.725000000003, 1252.1250000000025, 1252.4750000000024, 1251.4250000000025, 1252.3500000000026, 1252.5000000000023, 1251.6750000000027, 1252.7000000000019, 1252.6250000000025, 1251.9750000000026, 1252.925000000003, 1252.8750000000027, 1251.9750000000026, 1252.0333333333358, 1252.2833333333358, 1252.5000000000027, 1251.575000000003, 1253.1750000000025, 1251.7750000000015, 1252.3250000000028, 1252.8250000000028, 1252.3500000000029, 1252.0500000000025, 1252.8750000000027, 1253.100000000003, 1251.9500000000028, 1253.0250000000026, 1251.9750000000026, 1252.5250000000033, 1252.4750000000029, 1252.3000000000027, 1252.5750000000028, 1252.1000000000026, 1252.175000000002, 1252.0500000000027, 1252.6000000000024, 1252.5500000000027, 1252.625000000002, 1252.1333333333362, 1253.1500000000028, 1252.1750000000025, 1252.4500000000023, 1252.5250000000024, 1252.6750000000022, 1252.0500000000025, 1251.7250000000024, 1253.0250000000028, 1252.0750000000023, 1252.1250000000025, 1252.000000000002, 1252.5500000000027, 1251.4333333333357, 1252.4500000000025, 1250.7166666666692, 1252.2500000000023, 1251.7750000000024, 1252.408333333336, 1252.1833333333363, 1251.8916666666694, 1252.0250000000028, 1252.3500000000024, 1252.0916666666694, 1253.1250000000032, 1252.6500000000026, 1252.0750000000025, 1251.7833333333358, 1252.5250000000028, 1253.1250000000025, 1252.9250000000025, 1253.0250000000024, 1251.8583333333358, 1252.2000000000028, 1252.6000000000029, 1252.3833333333362, 1251.1833333333366, 1251.8166666666693, 1251.2166666666694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24088908352267197, "mean_inference_ms": 2.0489816933581797, "mean_action_processing_ms": 0.09070815062781508, "mean_env_wait_ms": 1.5325204451160754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005826473236083984, "StateBufferConnector_ms": 0.0030744075775146484, "ViewRequirementAgentConnector_ms": 0.07686471939086914}, "num_episodes": 27, "episode_return_max": 1253.1750000000025, "episode_return_min": 1250.1416666666692, "episode_return_mean": 1252.2645000000027, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220650, "num_agent_steps_trained": 220500, "num_env_steps_sampled": 220650, "num_env_steps_trained": 220500, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 265.72826836652104, "num_env_steps_trained_throughput_per_sec": 265.72826836652104, "timesteps_total": 220650, "num_env_steps_sampled_lifetime": 220650, "num_agent_steps_sampled_lifetime": 220650, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 220650, "timers": {"training_iteration_time_ms": 10363.131, "restore_workers_time_ms": 0.012, "training_step_time_ms": 539.558, "sample_time_ms": 525.819, "synch_weights_time_ms": 12.458}, "counters": {"num_env_steps_sampled": 220650, "num_env_steps_trained": 220500, "num_agent_steps_sampled": 220650, "num_agent_steps_trained": 220500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1471, "num_samples_added_to_queue": 220500}, "done": false, "training_iteration": 87, "trial_id": "27800_00000", "date": "2024-10-12_15-42-52", "timestamp": 1728744172, "time_this_iter_s": 10.171747207641602, "time_total_s": 899.9805722236633, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d27be0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 899.9805722236633, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 16.086666666666666, "ram_util_percent": 51.980000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 5214.6455078125, "policy_loss": 1485.28515625, "entropy": 4.923352241516113, "entropy_coeff": 0.01, "var_gnorm": 18.10134506225586, "vf_loss": 374413.03125, "vf_explained_var": 0.6479756832122803}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 743.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 223200, "num_env_steps_trained": 222900, "num_agent_steps_sampled": 223200, "num_agent_steps_trained": 222900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1488, "num_samples_added_to_queue": 223200, "learner_queue": {"size_count": 743, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.512, "learner_load_time_ms": 0.288, "learner_load_wait_time_ms": 1138.181, "learner_dequeue_time_ms": 9748.572}}, "env_runners": {"episode_reward_max": 1253.1750000000025, "episode_reward_min": 1245.366666666669, "episode_reward_mean": 1251.7809166666693, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1245.366666666669}, "policy_reward_max": {"default_policy": 1253.1750000000025}, "policy_reward_mean": {"default_policy": 1251.7809166666693}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.35840000000000005, "num_moves_min": 0.14, "num_moves_max": 0.59, "mean_accuracy_mean": 43.00950000000002, "mean_accuracy_min": 43.00000000000001, "mean_accuracy_max": 43.11400000000001, "num_model_switches_mean": 0.027100000000000003, "num_model_switches_min": 0.0, "num_model_switches_max": 0.27, "num_slav_mean": 0.08296550000000001, "num_slav_min": 0.08121666666666666, "num_slav_max": 0.09598333333333332, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5468456152613073, "mean_cluster_cpu_util_min": 0.5413338849053134, "mean_cluster_cpu_util_max": 0.5513755630630631, "mean_cluster_mem_util_mean": 0.338844401371308, "mean_cluster_mem_util_min": 0.338434599156118, "mean_cluster_mem_util_max": 0.33937605485232064, "reward_consolidation_mean_mean": 6.249791666666668, "reward_consolidation_mean_min": 6.229166666666668, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 7.512500000000029, "reward_accuracy_mean_min": 7.500000000000028, "reward_accuracy_mean_max": 7.650000000000029, "reward_sla_mean_mean": -1.2444824999999997, "reward_sla_mean_min": -1.4397499999999999, "reward_sla_mean_max": -1.2182499999999998, "reward_consolidation_sum_mean": 624.9791666666667, "reward_consolidation_sum_min": 622.9166666666667, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 751.2500000000031, "reward_accuracy_sum_min": 750.0000000000028, "reward_accuracy_sum_max": 765.0000000000028, "reward_sla_sum_mean": -124.44824999999997, "reward_sla_sum_min": -143.975, "reward_sla_sum_max": -121.82499999999997, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2575.0, "global_timestep_min": 800, "global_timestep_max": 4200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1252.3500000000026, 1252.5000000000023, 1251.6750000000027, 1252.7000000000019, 1252.6250000000025, 1251.9750000000026, 1252.925000000003, 1252.8750000000027, 1251.9750000000026, 1252.0333333333358, 1252.2833333333358, 1252.5000000000027, 1251.575000000003, 1253.1750000000025, 1251.7750000000015, 1252.3250000000028, 1252.8250000000028, 1252.3500000000029, 1252.0500000000025, 1252.8750000000027, 1253.100000000003, 1251.9500000000028, 1253.0250000000026, 1251.9750000000026, 1252.5250000000033, 1252.4750000000029, 1252.3000000000027, 1252.5750000000028, 1252.1000000000026, 1252.175000000002, 1252.0500000000027, 1252.6000000000024, 1252.5500000000027, 1252.625000000002, 1252.1333333333362, 1253.1500000000028, 1252.1750000000025, 1252.4500000000023, 1252.5250000000024, 1252.6750000000022, 1252.0500000000025, 1251.7250000000024, 1253.0250000000028, 1252.0750000000023, 1252.1250000000025, 1252.000000000002, 1252.5500000000027, 1251.4333333333357, 1252.4500000000025, 1250.7166666666692, 1252.2500000000023, 1251.7750000000024, 1252.408333333336, 1252.1833333333363, 1251.8916666666694, 1252.0250000000028, 1252.3500000000024, 1252.0916666666694, 1253.1250000000032, 1252.6500000000026, 1252.0750000000025, 1251.7833333333358, 1252.5250000000028, 1253.1250000000025, 1252.9250000000025, 1253.0250000000024, 1251.8583333333358, 1252.2000000000028, 1252.6000000000029, 1252.3833333333362, 1251.1833333333366, 1251.8166666666693, 1251.2166666666694, 1251.3916666666696, 1252.0000000000025, 1251.6500000000033, 1249.7916666666688, 1251.4416666666693, 1250.8250000000025, 1251.0166666666692, 1248.9833333333363, 1246.6000000000033, 1252.500000000002, 1252.2083333333364, 1250.400000000002, 1251.6666666666692, 1250.383333333335, 1251.8166666666696, 1250.7250000000022, 1248.9750000000024, 1246.0250000000033, 1252.1750000000025, 1252.5000000000023, 1252.075000000002, 1250.983333333336, 1250.558333333336, 1251.6666666666688, 1249.8666666666697, 1246.3833333333355, 1245.366666666669], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1252.3500000000026, 1252.5000000000023, 1251.6750000000027, 1252.7000000000019, 1252.6250000000025, 1251.9750000000026, 1252.925000000003, 1252.8750000000027, 1251.9750000000026, 1252.0333333333358, 1252.2833333333358, 1252.5000000000027, 1251.575000000003, 1253.1750000000025, 1251.7750000000015, 1252.3250000000028, 1252.8250000000028, 1252.3500000000029, 1252.0500000000025, 1252.8750000000027, 1253.100000000003, 1251.9500000000028, 1253.0250000000026, 1251.9750000000026, 1252.5250000000033, 1252.4750000000029, 1252.3000000000027, 1252.5750000000028, 1252.1000000000026, 1252.175000000002, 1252.0500000000027, 1252.6000000000024, 1252.5500000000027, 1252.625000000002, 1252.1333333333362, 1253.1500000000028, 1252.1750000000025, 1252.4500000000023, 1252.5250000000024, 1252.6750000000022, 1252.0500000000025, 1251.7250000000024, 1253.0250000000028, 1252.0750000000023, 1252.1250000000025, 1252.000000000002, 1252.5500000000027, 1251.4333333333357, 1252.4500000000025, 1250.7166666666692, 1252.2500000000023, 1251.7750000000024, 1252.408333333336, 1252.1833333333363, 1251.8916666666694, 1252.0250000000028, 1252.3500000000024, 1252.0916666666694, 1253.1250000000032, 1252.6500000000026, 1252.0750000000025, 1251.7833333333358, 1252.5250000000028, 1253.1250000000025, 1252.9250000000025, 1253.0250000000024, 1251.8583333333358, 1252.2000000000028, 1252.6000000000029, 1252.3833333333362, 1251.1833333333366, 1251.8166666666693, 1251.2166666666694, 1251.3916666666696, 1252.0000000000025, 1251.6500000000033, 1249.7916666666688, 1251.4416666666693, 1250.8250000000025, 1251.0166666666692, 1248.9833333333363, 1246.6000000000033, 1252.500000000002, 1252.2083333333364, 1250.400000000002, 1251.6666666666692, 1250.383333333335, 1251.8166666666696, 1250.7250000000022, 1248.9750000000024, 1246.0250000000033, 1252.1750000000025, 1252.5000000000023, 1252.075000000002, 1250.983333333336, 1250.558333333336, 1251.6666666666688, 1249.8666666666697, 1246.3833333333355, 1245.366666666669]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2406011484234444, "mean_inference_ms": 2.0446553278503603, "mean_action_processing_ms": 0.0905945404386489, "mean_env_wait_ms": 1.5310059011420956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005613088607788086, "StateBufferConnector_ms": 0.00308990478515625, "ViewRequirementAgentConnector_ms": 0.07816171646118164}, "num_episodes": 27, "episode_return_max": 1253.1750000000025, "episode_return_min": 1245.366666666669, "episode_return_mean": 1251.7809166666693, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223200, "num_agent_steps_trained": 222900, "num_env_steps_sampled": 223200, "num_env_steps_trained": 222900, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 248.05725987970257, "num_env_steps_trained_throughput_per_sec": 233.46565635736712, "timesteps_total": 223200, "num_env_steps_sampled_lifetime": 223200, "num_agent_steps_sampled_lifetime": 223200, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 223200, "timers": {"training_iteration_time_ms": 10334.887, "restore_workers_time_ms": 0.011, "training_step_time_ms": 607.001, "sample_time_ms": 592.423, "synch_weights_time_ms": 13.16}, "counters": {"num_env_steps_sampled": 223200, "num_env_steps_trained": 222900, "num_agent_steps_sampled": 223200, "num_agent_steps_trained": 222900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1488, "num_samples_added_to_queue": 223200}, "done": false, "training_iteration": 88, "trial_id": "27800_00000", "date": "2024-10-12_15-43-02", "timestamp": 1728744182, "time_this_iter_s": 10.291225671768188, "time_total_s": 910.2717978954315, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b45600>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 910.2717978954315, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 17.178571428571427, "ram_util_percent": 52.67142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1894.7315673828125, "policy_loss": -1719.9559326171875, "entropy": 4.97892951965332, "entropy_coeff": 0.01, "var_gnorm": 18.10165786743164, "vf_loss": 362962.4375, "vf_explained_var": 0.6459754109382629}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 751.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 225600, "num_env_steps_trained": 225300, "num_agent_steps_sampled": 225600, "num_agent_steps_trained": 225300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1504, "num_samples_added_to_queue": 225600, "learner_queue": {"size_count": 751, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 72.666, "learner_load_time_ms": 0.291, "learner_load_wait_time_ms": 1245.848, "learner_dequeue_time_ms": 9727.215}}, "env_runners": {"episode_reward_max": 1253.1500000000028, "episode_reward_min": 1215.7083333333367, "episode_reward_mean": 1245.475666666669, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1215.7083333333367}, "policy_reward_max": {"default_policy": 1253.1500000000028}, "policy_reward_mean": {"default_policy": 1245.475666666669}, "custom_metrics": {"num_consolidated_mean": 2.9997000000000003, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.4019, "num_moves_min": 0.14, "num_moves_max": 0.73, "mean_accuracy_mean": 43.11298666666669, "mean_accuracy_min": 43.00000000000001, "mean_accuracy_max": 43.61433333333334, "num_model_switches_mean": 0.09310000000000002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.52, "num_slav_mean": 0.096219, "num_slav_min": 0.08123333333333332, "num_slav_max": 0.16008333333333336, "cpu_conserved_cost_mean": 7.9988, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5447234795286358, "mean_cluster_cpu_util_min": 0.5381869484280198, "mean_cluster_cpu_util_max": 0.5513755630630631, "mean_cluster_mem_util_mean": 0.3393109005801688, "mean_cluster_mem_util_min": 0.338434599156118, "mean_cluster_mem_util_max": 0.34187236286919825, "reward_consolidation_mean_mean": 6.249375, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 7.648666666666694, "reward_accuracy_mean_min": 7.500000000000028, "reward_accuracy_mean_max": 8.30833333333336, "reward_sla_mean_mean": -1.443285, "reward_sla_mean_min": -2.4012499999999997, "reward_sla_mean_max": -1.2185, "reward_consolidation_sum_mean": 624.9375, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 764.8666666666693, "reward_accuracy_sum_min": 750.0000000000028, "reward_accuracy_sum_max": 830.8333333333361, "reward_sla_sum_mean": -144.3285, "reward_sla_sum_min": -240.12499999999997, "reward_sla_sum_max": -121.85, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3375.0, "global_timestep_min": 1600, "global_timestep_max": 5000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1252.5250000000033, 1252.4750000000029, 1252.3000000000027, 1252.5750000000028, 1252.1000000000026, 1252.175000000002, 1252.0500000000027, 1252.6000000000024, 1252.5500000000027, 1252.625000000002, 1252.1333333333362, 1253.1500000000028, 1252.1750000000025, 1252.4500000000023, 1252.5250000000024, 1252.6750000000022, 1252.0500000000025, 1251.7250000000024, 1253.0250000000028, 1252.0750000000023, 1252.1250000000025, 1252.000000000002, 1252.5500000000027, 1251.4333333333357, 1252.4500000000025, 1250.7166666666692, 1252.2500000000023, 1251.7750000000024, 1252.408333333336, 1252.1833333333363, 1251.8916666666694, 1252.0250000000028, 1252.3500000000024, 1252.0916666666694, 1253.1250000000032, 1252.6500000000026, 1252.0750000000025, 1251.7833333333358, 1252.5250000000028, 1253.1250000000025, 1252.9250000000025, 1253.0250000000024, 1251.8583333333358, 1252.2000000000028, 1252.6000000000029, 1252.3833333333362, 1251.1833333333366, 1251.8166666666693, 1251.2166666666694, 1251.3916666666696, 1252.0000000000025, 1251.6500000000033, 1249.7916666666688, 1251.4416666666693, 1250.8250000000025, 1251.0166666666692, 1248.9833333333363, 1246.6000000000033, 1252.500000000002, 1252.2083333333364, 1250.400000000002, 1251.6666666666692, 1250.383333333335, 1251.8166666666696, 1250.7250000000022, 1248.9750000000024, 1246.0250000000033, 1252.1750000000025, 1252.5000000000023, 1252.075000000002, 1250.983333333336, 1250.558333333336, 1251.6666666666688, 1249.8666666666697, 1246.3833333333355, 1245.366666666669, 1242.6583333333358, 1238.9500000000028, 1228.9083333333363, 1225.1333333333362, 1220.5416666666695, 1216.0416666666692, 1217.5916666666699, 1217.225000000003, 1245.3333333333362, 1240.1666666666697, 1236.075000000003, 1225.0666666666696, 1219.3333333333362, 1216.5083333333362, 1216.0500000000027, 1215.7083333333367, 1244.516666666669, 1236.066666666669, 1233.2250000000024, 1221.8500000000026, 1219.300000000003, 1217.1416666666694, 1217.1250000000034, 1216.3750000000032], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1252.5250000000033, 1252.4750000000029, 1252.3000000000027, 1252.5750000000028, 1252.1000000000026, 1252.175000000002, 1252.0500000000027, 1252.6000000000024, 1252.5500000000027, 1252.625000000002, 1252.1333333333362, 1253.1500000000028, 1252.1750000000025, 1252.4500000000023, 1252.5250000000024, 1252.6750000000022, 1252.0500000000025, 1251.7250000000024, 1253.0250000000028, 1252.0750000000023, 1252.1250000000025, 1252.000000000002, 1252.5500000000027, 1251.4333333333357, 1252.4500000000025, 1250.7166666666692, 1252.2500000000023, 1251.7750000000024, 1252.408333333336, 1252.1833333333363, 1251.8916666666694, 1252.0250000000028, 1252.3500000000024, 1252.0916666666694, 1253.1250000000032, 1252.6500000000026, 1252.0750000000025, 1251.7833333333358, 1252.5250000000028, 1253.1250000000025, 1252.9250000000025, 1253.0250000000024, 1251.8583333333358, 1252.2000000000028, 1252.6000000000029, 1252.3833333333362, 1251.1833333333366, 1251.8166666666693, 1251.2166666666694, 1251.3916666666696, 1252.0000000000025, 1251.6500000000033, 1249.7916666666688, 1251.4416666666693, 1250.8250000000025, 1251.0166666666692, 1248.9833333333363, 1246.6000000000033, 1252.500000000002, 1252.2083333333364, 1250.400000000002, 1251.6666666666692, 1250.383333333335, 1251.8166666666696, 1250.7250000000022, 1248.9750000000024, 1246.0250000000033, 1252.1750000000025, 1252.5000000000023, 1252.075000000002, 1250.983333333336, 1250.558333333336, 1251.6666666666688, 1249.8666666666697, 1246.3833333333355, 1245.366666666669, 1242.6583333333358, 1238.9500000000028, 1228.9083333333363, 1225.1333333333362, 1220.5416666666695, 1216.0416666666692, 1217.5916666666699, 1217.225000000003, 1245.3333333333362, 1240.1666666666697, 1236.075000000003, 1225.0666666666696, 1219.3333333333362, 1216.5083333333362, 1216.0500000000027, 1215.7083333333367, 1244.516666666669, 1236.066666666669, 1233.2250000000024, 1221.8500000000026, 1219.300000000003, 1217.1416666666694, 1217.1250000000034, 1216.3750000000032]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2404813997451931, "mean_inference_ms": 2.0443825812274126, "mean_action_processing_ms": 0.09055450808789836, "mean_env_wait_ms": 1.5306986344033475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005896329879760742, "StateBufferConnector_ms": 0.0031898021697998047, "ViewRequirementAgentConnector_ms": 0.08096837997436523}, "num_episodes": 24, "episode_return_max": 1253.1500000000028, "episode_return_min": 1215.7083333333367, "episode_return_mean": 1245.475666666669, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225600, "num_agent_steps_trained": 225300, "num_env_steps_sampled": 225600, "num_env_steps_trained": 225300, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 228.2022700009646, "num_env_steps_trained_throughput_per_sec": 228.2022700009646, "timesteps_total": 225600, "num_env_steps_sampled_lifetime": 225600, "num_agent_steps_sampled_lifetime": 225600, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 225600, "timers": {"training_iteration_time_ms": 10357.199, "restore_workers_time_ms": 0.013, "training_step_time_ms": 669.086, "sample_time_ms": 652.669, "synch_weights_time_ms": 14.679}, "counters": {"num_env_steps_sampled": 225600, "num_env_steps_trained": 225300, "num_agent_steps_sampled": 225600, "num_agent_steps_trained": 225300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1504, "num_samples_added_to_queue": 225600}, "done": false, "training_iteration": 89, "trial_id": "27800_00000", "date": "2024-10-12_15-43-13", "timestamp": 1728744193, "time_this_iter_s": 10.526490688323975, "time_total_s": 920.7982885837555, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b46080>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 920.7982885837555, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 17.793333333333333, "ram_util_percent": 52.28}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2891.90625, "policy_loss": -846.6410522460938, "entropy": 4.74045467376709, "entropy_coeff": 0.01, "var_gnorm": 18.097627639770508, "vf_loss": 375276.875, "vf_explained_var": 0.6418709754943848}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 759.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 227700, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 227700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1520, "num_samples_added_to_queue": 228000, "learner_queue": {"size_count": 759, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.69, "learner_load_time_ms": 0.281, "learner_load_wait_time_ms": 1242.928, "learner_dequeue_time_ms": 9623.137}}, "env_runners": {"episode_reward_max": 1253.1250000000032, "episode_reward_min": 1213.0833333333358, "episode_reward_mean": 1236.399333333336, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1213.0833333333358}, "policy_reward_max": {"default_policy": 1253.1250000000032}, "policy_reward_mean": {"default_policy": 1236.399333333336}, "custom_metrics": {"num_consolidated_mean": 2.9997000000000003, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.3768000000000001, "num_moves_min": 0.14, "num_moves_max": 0.73, "mean_accuracy_mean": 43.26321333333334, "mean_accuracy_min": 43.00000000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0977, "num_model_switches_min": 0.0, "num_model_switches_max": 0.52, "num_slav_mean": 0.1154476666666667, "num_slav_min": 0.08125, "num_slav_max": 0.1635, "cpu_conserved_cost_mean": 7.9988, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5423286450002298, "mean_cluster_cpu_util_min": 0.5367119645155359, "mean_cluster_cpu_util_max": 0.5482351190476189, "mean_cluster_mem_util_mean": 0.3399922349683544, "mean_cluster_mem_util_min": 0.338535864978903, "mean_cluster_mem_util_max": 0.34190611814345984, "reward_consolidation_mean_mean": 6.249375, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 7.8463333333333605, "reward_accuracy_mean_min": 7.500000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -1.7317149999999994, "reward_sla_mean_min": -2.4525, "reward_sla_mean_max": -1.21875, "reward_consolidation_sum_mean": 624.9375, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 784.6333333333364, "reward_accuracy_sum_min": 750.0000000000028, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -173.1715, "reward_sla_sum_min": -245.25, "reward_sla_sum_max": -121.875, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4182.0, "global_timestep_min": 2500, "global_timestep_max": 5800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1252.4500000000025, 1250.7166666666692, 1252.2500000000023, 1251.7750000000024, 1252.408333333336, 1252.1833333333363, 1251.8916666666694, 1252.0250000000028, 1252.3500000000024, 1252.0916666666694, 1253.1250000000032, 1252.6500000000026, 1252.0750000000025, 1251.7833333333358, 1252.5250000000028, 1253.1250000000025, 1252.9250000000025, 1253.0250000000024, 1251.8583333333358, 1252.2000000000028, 1252.6000000000029, 1252.3833333333362, 1251.1833333333366, 1251.8166666666693, 1251.2166666666694, 1251.3916666666696, 1252.0000000000025, 1251.6500000000033, 1249.7916666666688, 1251.4416666666693, 1250.8250000000025, 1251.0166666666692, 1248.9833333333363, 1246.6000000000033, 1252.500000000002, 1252.2083333333364, 1250.400000000002, 1251.6666666666692, 1250.383333333335, 1251.8166666666696, 1250.7250000000022, 1248.9750000000024, 1246.0250000000033, 1252.1750000000025, 1252.5000000000023, 1252.075000000002, 1250.983333333336, 1250.558333333336, 1251.6666666666688, 1249.8666666666697, 1246.3833333333355, 1245.366666666669, 1242.6583333333358, 1238.9500000000028, 1228.9083333333363, 1225.1333333333362, 1220.5416666666695, 1216.0416666666692, 1217.5916666666699, 1217.225000000003, 1245.3333333333362, 1240.1666666666697, 1236.075000000003, 1225.0666666666696, 1219.3333333333362, 1216.5083333333362, 1216.0500000000027, 1215.7083333333367, 1244.516666666669, 1236.066666666669, 1233.2250000000024, 1221.8500000000026, 1219.300000000003, 1217.1416666666694, 1217.1250000000034, 1216.3750000000032, 1214.2166666666697, 1213.5083333333355, 1214.3833333333362, 1215.0166666666692, 1214.5250000000033, 1214.6333333333369, 1214.8833333333362, 1213.3833333333364, 1216.8750000000032, 1214.6583333333358, 1215.2666666666694, 1214.8000000000022, 1214.4833333333358, 1213.7833333333356, 1214.4833333333363, 1214.7500000000027, 1215.4416666666689, 1213.2833333333367, 1214.4500000000028, 1215.1333333333362, 1214.6750000000031, 1215.1333333333362, 1213.0833333333358, 1213.5833333333358], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1252.4500000000025, 1250.7166666666692, 1252.2500000000023, 1251.7750000000024, 1252.408333333336, 1252.1833333333363, 1251.8916666666694, 1252.0250000000028, 1252.3500000000024, 1252.0916666666694, 1253.1250000000032, 1252.6500000000026, 1252.0750000000025, 1251.7833333333358, 1252.5250000000028, 1253.1250000000025, 1252.9250000000025, 1253.0250000000024, 1251.8583333333358, 1252.2000000000028, 1252.6000000000029, 1252.3833333333362, 1251.1833333333366, 1251.8166666666693, 1251.2166666666694, 1251.3916666666696, 1252.0000000000025, 1251.6500000000033, 1249.7916666666688, 1251.4416666666693, 1250.8250000000025, 1251.0166666666692, 1248.9833333333363, 1246.6000000000033, 1252.500000000002, 1252.2083333333364, 1250.400000000002, 1251.6666666666692, 1250.383333333335, 1251.8166666666696, 1250.7250000000022, 1248.9750000000024, 1246.0250000000033, 1252.1750000000025, 1252.5000000000023, 1252.075000000002, 1250.983333333336, 1250.558333333336, 1251.6666666666688, 1249.8666666666697, 1246.3833333333355, 1245.366666666669, 1242.6583333333358, 1238.9500000000028, 1228.9083333333363, 1225.1333333333362, 1220.5416666666695, 1216.0416666666692, 1217.5916666666699, 1217.225000000003, 1245.3333333333362, 1240.1666666666697, 1236.075000000003, 1225.0666666666696, 1219.3333333333362, 1216.5083333333362, 1216.0500000000027, 1215.7083333333367, 1244.516666666669, 1236.066666666669, 1233.2250000000024, 1221.8500000000026, 1219.300000000003, 1217.1416666666694, 1217.1250000000034, 1216.3750000000032, 1214.2166666666697, 1213.5083333333355, 1214.3833333333362, 1215.0166666666692, 1214.5250000000033, 1214.6333333333369, 1214.8833333333362, 1213.3833333333364, 1216.8750000000032, 1214.6583333333358, 1215.2666666666694, 1214.8000000000022, 1214.4833333333358, 1213.7833333333356, 1214.4833333333363, 1214.7500000000027, 1215.4416666666689, 1213.2833333333367, 1214.4500000000028, 1215.1333333333362, 1214.6750000000031, 1215.1333333333362, 1213.0833333333358, 1213.5833333333358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24048971047359174, "mean_inference_ms": 2.0482057095538138, "mean_action_processing_ms": 0.09058112410083177, "mean_env_wait_ms": 1.5315424628820136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061740875244140625, "StateBufferConnector_ms": 0.0032618045806884766, "ViewRequirementAgentConnector_ms": 0.0839231014251709}, "num_episodes": 24, "episode_return_max": 1253.1250000000032, "episode_return_min": 1213.0833333333358, "episode_return_mean": 1236.399333333336, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 227700, "num_env_steps_sampled": 228000, "num_env_steps_trained": 227700, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 233.65941984075377, "num_env_steps_trained_throughput_per_sec": 233.65941984075377, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 228000, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 10319.093, "restore_workers_time_ms": 0.014, "training_step_time_ms": 655.608, "sample_time_ms": 639.537, "synch_weights_time_ms": 14.449}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 227700, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 227700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1520, "num_samples_added_to_queue": 228000}, "done": false, "training_iteration": 90, "trial_id": "27800_00000", "date": "2024-10-12_15-43-23", "timestamp": 1728744203, "time_this_iter_s": 10.28342604637146, "time_total_s": 931.081714630127, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486c0310>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 931.081714630127, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 18.006666666666664, "ram_util_percent": 52.45333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4117.955078125, "policy_loss": 140.53060913085938, "entropy": 4.671003341674805, "entropy_coeff": 0.01, "var_gnorm": 18.094871520996094, "vf_loss": 399143.75, "vf_explained_var": 0.633500337600708}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 768.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 230550, "num_env_steps_trained": 230400, "num_agent_steps_sampled": 230550, "num_agent_steps_trained": 230400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1537, "num_samples_added_to_queue": 230400, "learner_queue": {"size_count": 768, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 68.475, "learner_load_time_ms": 0.286, "learner_load_wait_time_ms": 1157.468, "learner_dequeue_time_ms": 9695.561}}, "env_runners": {"episode_reward_max": 1252.5000000000023, "episode_reward_min": 1212.4833333333365, "episode_reward_mean": 1227.230333333336, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.4833333333365}, "policy_reward_max": {"default_policy": 1252.5000000000023}, "policy_reward_mean": {"default_policy": 1227.230333333336}, "custom_metrics": {"num_consolidated_mean": 2.9997000000000003, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.3224, "num_moves_min": 0.1, "num_moves_max": 0.73, "mean_accuracy_mean": 43.41407333333334, "mean_accuracy_min": 43.00000000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.09570000000000001, "num_model_switches_min": 0.0, "num_model_switches_max": 0.52, "num_slav_mean": 0.1347936666666667, "num_slav_min": 0.08166666666666667, "num_slav_max": 0.16390000000000005, "cpu_conserved_cost_mean": 7.9988, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5406427112348317, "mean_cluster_cpu_util_min": 0.5367119645155359, "mean_cluster_cpu_util_max": 0.5447006343077772, "mean_cluster_mem_util_mean": 0.3406458583860759, "mean_cluster_mem_util_min": 0.338535864978903, "mean_cluster_mem_util_max": 0.3420727848101265, "reward_consolidation_mean_mean": 6.249375, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.044833333333361, "reward_accuracy_mean_min": 7.500000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.021905, "reward_sla_mean_min": -2.4584999999999995, "reward_sla_mean_max": -1.225, "reward_consolidation_sum_mean": 624.9375, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 804.4833333333361, "reward_accuracy_sum_min": 750.0000000000028, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -202.1905, "reward_sla_sum_min": -245.84999999999997, "reward_sla_sum_max": -122.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4983.0, "global_timestep_min": 3300, "global_timestep_max": 6600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1251.2166666666694, 1251.3916666666696, 1252.0000000000025, 1251.6500000000033, 1249.7916666666688, 1251.4416666666693, 1250.8250000000025, 1251.0166666666692, 1248.9833333333363, 1246.6000000000033, 1252.500000000002, 1252.2083333333364, 1250.400000000002, 1251.6666666666692, 1250.383333333335, 1251.8166666666696, 1250.7250000000022, 1248.9750000000024, 1246.0250000000033, 1252.1750000000025, 1252.5000000000023, 1252.075000000002, 1250.983333333336, 1250.558333333336, 1251.6666666666688, 1249.8666666666697, 1246.3833333333355, 1245.366666666669, 1242.6583333333358, 1238.9500000000028, 1228.9083333333363, 1225.1333333333362, 1220.5416666666695, 1216.0416666666692, 1217.5916666666699, 1217.225000000003, 1245.3333333333362, 1240.1666666666697, 1236.075000000003, 1225.0666666666696, 1219.3333333333362, 1216.5083333333362, 1216.0500000000027, 1215.7083333333367, 1244.516666666669, 1236.066666666669, 1233.2250000000024, 1221.8500000000026, 1219.300000000003, 1217.1416666666694, 1217.1250000000034, 1216.3750000000032, 1214.2166666666697, 1213.5083333333355, 1214.3833333333362, 1215.0166666666692, 1214.5250000000033, 1214.6333333333369, 1214.8833333333362, 1213.3833333333364, 1216.8750000000032, 1214.6583333333358, 1215.2666666666694, 1214.8000000000022, 1214.4833333333358, 1213.7833333333356, 1214.4833333333363, 1214.7500000000027, 1215.4416666666689, 1213.2833333333367, 1214.4500000000028, 1215.1333333333362, 1214.6750000000031, 1215.1333333333362, 1213.0833333333358, 1213.5833333333358, 1213.7833333333356, 1212.7333333333358, 1213.6833333333363, 1213.583333333336, 1214.6000000000033, 1214.3833333333364, 1214.433333333336, 1214.133333333336, 1214.8833333333364, 1214.1833333333368, 1215.0333333333365, 1214.1333333333362, 1212.4833333333365, 1213.833333333337, 1213.783333333336, 1214.383333333336, 1213.6500000000026, 1213.983333333336, 1214.5833333333362, 1214.233333333336, 1213.6833333333357, 1214.4750000000026, 1213.8750000000032, 1213.983333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1251.2166666666694, 1251.3916666666696, 1252.0000000000025, 1251.6500000000033, 1249.7916666666688, 1251.4416666666693, 1250.8250000000025, 1251.0166666666692, 1248.9833333333363, 1246.6000000000033, 1252.500000000002, 1252.2083333333364, 1250.400000000002, 1251.6666666666692, 1250.383333333335, 1251.8166666666696, 1250.7250000000022, 1248.9750000000024, 1246.0250000000033, 1252.1750000000025, 1252.5000000000023, 1252.075000000002, 1250.983333333336, 1250.558333333336, 1251.6666666666688, 1249.8666666666697, 1246.3833333333355, 1245.366666666669, 1242.6583333333358, 1238.9500000000028, 1228.9083333333363, 1225.1333333333362, 1220.5416666666695, 1216.0416666666692, 1217.5916666666699, 1217.225000000003, 1245.3333333333362, 1240.1666666666697, 1236.075000000003, 1225.0666666666696, 1219.3333333333362, 1216.5083333333362, 1216.0500000000027, 1215.7083333333367, 1244.516666666669, 1236.066666666669, 1233.2250000000024, 1221.8500000000026, 1219.300000000003, 1217.1416666666694, 1217.1250000000034, 1216.3750000000032, 1214.2166666666697, 1213.5083333333355, 1214.3833333333362, 1215.0166666666692, 1214.5250000000033, 1214.6333333333369, 1214.8833333333362, 1213.3833333333364, 1216.8750000000032, 1214.6583333333358, 1215.2666666666694, 1214.8000000000022, 1214.4833333333358, 1213.7833333333356, 1214.4833333333363, 1214.7500000000027, 1215.4416666666689, 1213.2833333333367, 1214.4500000000028, 1215.1333333333362, 1214.6750000000031, 1215.1333333333362, 1213.0833333333358, 1213.5833333333358, 1213.7833333333356, 1212.7333333333358, 1213.6833333333363, 1213.583333333336, 1214.6000000000033, 1214.3833333333364, 1214.433333333336, 1214.133333333336, 1214.8833333333364, 1214.1833333333368, 1215.0333333333365, 1214.1333333333362, 1212.4833333333365, 1213.833333333337, 1213.783333333336, 1214.383333333336, 1213.6500000000026, 1213.983333333336, 1214.5833333333362, 1214.233333333336, 1213.6833333333357, 1214.4750000000026, 1213.8750000000032, 1213.983333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24055810019856147, "mean_inference_ms": 2.0506082603965883, "mean_action_processing_ms": 0.09061341894599569, "mean_env_wait_ms": 1.53221977858927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006407737731933594, "StateBufferConnector_ms": 0.0033087730407714844, "ViewRequirementAgentConnector_ms": 0.08557295799255371}, "num_episodes": 24, "episode_return_max": 1252.5000000000023, "episode_return_min": 1212.4833333333365, "episode_return_mean": 1227.230333333336, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 230550, "num_agent_steps_trained": 230400, "num_env_steps_sampled": 230550, "num_env_steps_trained": 230400, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 247.76699808209761, "num_env_steps_trained_throughput_per_sec": 262.3415273810445, "timesteps_total": 230550, "num_env_steps_sampled_lifetime": 230550, "num_agent_steps_sampled_lifetime": 230550, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 230550, "timers": {"training_iteration_time_ms": 10341.998, "restore_workers_time_ms": 0.011, "training_step_time_ms": 624.094, "sample_time_ms": 608.438, "synch_weights_time_ms": 14.174}, "counters": {"num_env_steps_sampled": 230550, "num_env_steps_trained": 230400, "num_agent_steps_sampled": 230550, "num_agent_steps_trained": 230400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1537, "num_samples_added_to_queue": 230400}, "done": false, "training_iteration": 91, "trial_id": "27800_00000", "date": "2024-10-12_15-43-33", "timestamp": 1728744213, "time_this_iter_s": 10.31059455871582, "time_total_s": 941.3923091888428, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b47f10>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 941.3923091888428, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 16.433333333333334, "ram_util_percent": 52.82666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2714.21875, "policy_loss": -909.9630737304688, "entropy": 4.740414142608643, "entropy_coeff": 0.01, "var_gnorm": 18.099748611450195, "vf_loss": 363840.3125, "vf_explained_var": 0.6460491418838501}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 776.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 233100, "num_env_steps_trained": 232800, "num_agent_steps_sampled": 233100, "num_agent_steps_trained": 232800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1554, "num_samples_added_to_queue": 233100, "learner_queue": {"size_count": 776, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.418, "learner_load_time_ms": 0.312, "learner_load_wait_time_ms": 1176.491, "learner_dequeue_time_ms": 9856.161}}, "env_runners": {"episode_reward_max": 1245.366666666669, "episode_reward_min": 1212.4833333333365, "episode_reward_mean": 1217.3755833333362, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.4833333333365}, "policy_reward_max": {"default_policy": 1245.366666666669}, "policy_reward_mean": {"default_policy": 1217.3755833333362}, "custom_metrics": {"num_consolidated_mean": 2.9998, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.30670000000000003, "num_moves_min": 0.1, "num_moves_max": 0.73, "mean_accuracy_mean": 43.57779000000001, "mean_accuracy_min": 43.107666666666674, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.07490000000000001, "num_model_switches_min": 0.0, "num_model_switches_max": 0.52, "num_slav_mean": 0.15573850000000003, "num_slav_min": 0.09586666666666668, "num_slav_max": 0.16390000000000005, "cpu_conserved_cost_mean": 7.999200000000001, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5395942113669792, "mean_cluster_cpu_util_min": 0.5367119645155359, "mean_cluster_cpu_util_max": 0.5436437649384077, "mean_cluster_mem_util_mean": 0.3413954496308016, "mean_cluster_mem_util_min": 0.3389626845991561, "mean_cluster_mem_util_max": 0.3420727848101265, "reward_consolidation_mean_mean": 6.249583333333333, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.260250000000026, "reward_accuracy_mean_min": 7.641666666666695, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.3360775, "reward_sla_mean_min": -2.4584999999999995, "reward_sla_mean_max": -1.4379999999999997, "reward_consolidation_sum_mean": 624.9583333333333, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 826.0250000000029, "reward_accuracy_sum_min": 764.1666666666695, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -233.60774999999998, "reward_sla_sum_min": -245.84999999999997, "reward_sla_sum_max": -143.79999999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5883.0, "global_timestep_min": 4200, "global_timestep_max": 7500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1245.366666666669, 1242.6583333333358, 1238.9500000000028, 1228.9083333333363, 1225.1333333333362, 1220.5416666666695, 1216.0416666666692, 1217.5916666666699, 1217.225000000003, 1245.3333333333362, 1240.1666666666697, 1236.075000000003, 1225.0666666666696, 1219.3333333333362, 1216.5083333333362, 1216.0500000000027, 1215.7083333333367, 1244.516666666669, 1236.066666666669, 1233.2250000000024, 1221.8500000000026, 1219.300000000003, 1217.1416666666694, 1217.1250000000034, 1216.3750000000032, 1214.2166666666697, 1213.5083333333355, 1214.3833333333362, 1215.0166666666692, 1214.5250000000033, 1214.6333333333369, 1214.8833333333362, 1213.3833333333364, 1216.8750000000032, 1214.6583333333358, 1215.2666666666694, 1214.8000000000022, 1214.4833333333358, 1213.7833333333356, 1214.4833333333363, 1214.7500000000027, 1215.4416666666689, 1213.2833333333367, 1214.4500000000028, 1215.1333333333362, 1214.6750000000031, 1215.1333333333362, 1213.0833333333358, 1213.5833333333358, 1213.7833333333356, 1212.7333333333358, 1213.6833333333363, 1213.583333333336, 1214.6000000000033, 1214.3833333333364, 1214.433333333336, 1214.133333333336, 1214.8833333333364, 1214.1833333333368, 1215.0333333333365, 1214.1333333333362, 1212.4833333333365, 1213.833333333337, 1213.783333333336, 1214.383333333336, 1213.6500000000026, 1213.983333333336, 1214.5833333333362, 1214.233333333336, 1213.6833333333357, 1214.4750000000026, 1213.8750000000032, 1213.983333333336, 1213.6333333333362, 1214.2333333333363, 1213.3333333333358, 1214.4833333333356, 1213.6333333333357, 1213.3833333333366, 1213.7333333333356, 1215.133333333336, 1213.5333333333356, 1214.0833333333364, 1214.0333333333365, 1214.1833333333363, 1215.1333333333366, 1214.7833333333363, 1214.4833333333356, 1214.3333333333362, 1214.533333333336, 1214.2833333333358, 1214.833333333336, 1213.383333333336, 1214.1333333333357, 1213.5833333333364, 1213.9333333333363, 1213.2833333333365, 1213.7333333333365, 1213.4333333333361, 1215.083333333337], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1245.366666666669, 1242.6583333333358, 1238.9500000000028, 1228.9083333333363, 1225.1333333333362, 1220.5416666666695, 1216.0416666666692, 1217.5916666666699, 1217.225000000003, 1245.3333333333362, 1240.1666666666697, 1236.075000000003, 1225.0666666666696, 1219.3333333333362, 1216.5083333333362, 1216.0500000000027, 1215.7083333333367, 1244.516666666669, 1236.066666666669, 1233.2250000000024, 1221.8500000000026, 1219.300000000003, 1217.1416666666694, 1217.1250000000034, 1216.3750000000032, 1214.2166666666697, 1213.5083333333355, 1214.3833333333362, 1215.0166666666692, 1214.5250000000033, 1214.6333333333369, 1214.8833333333362, 1213.3833333333364, 1216.8750000000032, 1214.6583333333358, 1215.2666666666694, 1214.8000000000022, 1214.4833333333358, 1213.7833333333356, 1214.4833333333363, 1214.7500000000027, 1215.4416666666689, 1213.2833333333367, 1214.4500000000028, 1215.1333333333362, 1214.6750000000031, 1215.1333333333362, 1213.0833333333358, 1213.5833333333358, 1213.7833333333356, 1212.7333333333358, 1213.6833333333363, 1213.583333333336, 1214.6000000000033, 1214.3833333333364, 1214.433333333336, 1214.133333333336, 1214.8833333333364, 1214.1833333333368, 1215.0333333333365, 1214.1333333333362, 1212.4833333333365, 1213.833333333337, 1213.783333333336, 1214.383333333336, 1213.6500000000026, 1213.983333333336, 1214.5833333333362, 1214.233333333336, 1213.6833333333357, 1214.4750000000026, 1213.8750000000032, 1213.983333333336, 1213.6333333333362, 1214.2333333333363, 1213.3333333333358, 1214.4833333333356, 1213.6333333333357, 1213.3833333333366, 1213.7333333333356, 1215.133333333336, 1213.5333333333356, 1214.0833333333364, 1214.0333333333365, 1214.1833333333363, 1215.1333333333366, 1214.7833333333363, 1214.4833333333356, 1214.3333333333362, 1214.533333333336, 1214.2833333333358, 1214.833333333336, 1213.383333333336, 1214.1333333333357, 1213.5833333333364, 1213.9333333333363, 1213.2833333333365, 1213.7333333333365, 1213.4333333333361, 1215.083333333337]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24062584450818458, "mean_inference_ms": 2.0514844051654513, "mean_action_processing_ms": 0.09063404105703557, "mean_env_wait_ms": 1.532558772249534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006494760513305664, "StateBufferConnector_ms": 0.0033435821533203125, "ViewRequirementAgentConnector_ms": 0.08628010749816895}, "num_episodes": 27, "episode_return_max": 1245.366666666669, "episode_return_min": 1212.4833333333365, "episode_return_mean": 1217.3755833333362, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233100, "num_agent_steps_trained": 232800, "num_env_steps_sampled": 233100, "num_env_steps_trained": 232800, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 244.9738433614076, "num_env_steps_trained_throughput_per_sec": 230.5636172813248, "timesteps_total": 233100, "num_env_steps_sampled_lifetime": 233100, "num_agent_steps_sampled_lifetime": 233100, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 233100, "timers": {"training_iteration_time_ms": 10332.048, "restore_workers_time_ms": 0.012, "training_step_time_ms": 609.103, "sample_time_ms": 593.66, "synch_weights_time_ms": 14.004}, "counters": {"num_env_steps_sampled": 233100, "num_env_steps_trained": 232800, "num_agent_steps_sampled": 233100, "num_agent_steps_trained": 232800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1554, "num_samples_added_to_queue": 233100}, "done": false, "training_iteration": 92, "trial_id": "27800_00000", "date": "2024-10-12_15-43-44", "timestamp": 1728744224, "time_this_iter_s": 10.422072887420654, "time_total_s": 951.8143820762634, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b47e50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 951.8143820762634, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 15.566666666666666, "ram_util_percent": 52.76666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2372.0078125, "policy_loss": -997.572021484375, "entropy": 4.941247940063477, "entropy_coeff": 0.01, "var_gnorm": 18.09202003479004, "vf_loss": 338440.375, "vf_explained_var": 0.657867431640625}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 785.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 235650, "num_env_steps_trained": 235500, "num_agent_steps_sampled": 235650, "num_agent_steps_trained": 235500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1571, "num_samples_added_to_queue": 235500, "learner_queue": {"size_count": 785, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 64.365, "learner_load_time_ms": 0.335, "learner_load_wait_time_ms": 1153.093, "learner_dequeue_time_ms": 9741.677}}, "env_runners": {"episode_reward_max": 1216.8750000000032, "episode_reward_min": 1212.4833333333365, "episode_reward_mean": 1214.207250000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.4833333333365}, "policy_reward_max": {"default_policy": 1216.8750000000032}, "policy_reward_mean": {"default_policy": 1214.207250000003}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2823, "num_moves_min": 0.1, "num_moves_max": 0.62, "mean_accuracy_mean": 43.63117999999999, "mean_accuracy_min": 43.60800000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0072, "num_model_switches_min": 0.0, "num_model_switches_max": 0.08, "num_slav_mean": 0.16256183333333332, "num_slav_min": 0.15875, "num_slav_max": 0.16390000000000005, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5396287411518661, "mean_cluster_cpu_util_min": 0.5367119645155359, "mean_cluster_cpu_util_max": 0.5432065407243979, "mean_cluster_mem_util_mean": 0.34163917194092824, "mean_cluster_mem_util_min": 0.3410933544303798, "mean_cluster_mem_util_max": 0.3420727848101265, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.330500000000026, "reward_accuracy_mean_min": 8.300000000000027, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4384274999999995, "reward_sla_mean_min": -2.4584999999999995, "reward_sla_mean_max": -2.38125, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.0500000000029, "reward_accuracy_sum_min": 830.0000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -243.84274999999997, "reward_sla_sum_min": -245.84999999999997, "reward_sla_sum_max": -238.125, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5513.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1216.3750000000032, 1214.2166666666697, 1213.5083333333355, 1214.3833333333362, 1215.0166666666692, 1214.5250000000033, 1214.6333333333369, 1214.8833333333362, 1213.3833333333364, 1216.8750000000032, 1214.6583333333358, 1215.2666666666694, 1214.8000000000022, 1214.4833333333358, 1213.7833333333356, 1214.4833333333363, 1214.7500000000027, 1215.4416666666689, 1213.2833333333367, 1214.4500000000028, 1215.1333333333362, 1214.6750000000031, 1215.1333333333362, 1213.0833333333358, 1213.5833333333358, 1213.7833333333356, 1212.7333333333358, 1213.6833333333363, 1213.583333333336, 1214.6000000000033, 1214.3833333333364, 1214.433333333336, 1214.133333333336, 1214.8833333333364, 1214.1833333333368, 1215.0333333333365, 1214.1333333333362, 1212.4833333333365, 1213.833333333337, 1213.783333333336, 1214.383333333336, 1213.6500000000026, 1213.983333333336, 1214.5833333333362, 1214.233333333336, 1213.6833333333357, 1214.4750000000026, 1213.8750000000032, 1213.983333333336, 1213.6333333333362, 1214.2333333333363, 1213.3333333333358, 1214.4833333333356, 1213.6333333333357, 1213.3833333333366, 1213.7333333333356, 1215.133333333336, 1213.5333333333356, 1214.0833333333364, 1214.0333333333365, 1214.1833333333363, 1215.1333333333366, 1214.7833333333363, 1214.4833333333356, 1214.3333333333362, 1214.533333333336, 1214.2833333333358, 1214.833333333336, 1213.383333333336, 1214.1333333333357, 1213.5833333333364, 1213.9333333333363, 1213.2833333333365, 1213.7333333333365, 1213.4333333333361, 1215.083333333337, 1214.683333333337, 1214.6333333333362, 1213.5833333333367, 1214.5333333333353, 1213.7833333333363, 1213.3833333333364, 1213.2833333333356, 1214.383333333336, 1213.8833333333366, 1213.8333333333358, 1213.9333333333368, 1213.7333333333368, 1214.4833333333358, 1213.8333333333364, 1214.583333333337, 1214.533333333336, 1213.9333333333363, 1214.433333333336, 1214.0833333333362, 1213.7333333333358, 1214.283333333336, 1214.0333333333365, 1214.6833333333363, 1214.7833333333363], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1216.3750000000032, 1214.2166666666697, 1213.5083333333355, 1214.3833333333362, 1215.0166666666692, 1214.5250000000033, 1214.6333333333369, 1214.8833333333362, 1213.3833333333364, 1216.8750000000032, 1214.6583333333358, 1215.2666666666694, 1214.8000000000022, 1214.4833333333358, 1213.7833333333356, 1214.4833333333363, 1214.7500000000027, 1215.4416666666689, 1213.2833333333367, 1214.4500000000028, 1215.1333333333362, 1214.6750000000031, 1215.1333333333362, 1213.0833333333358, 1213.5833333333358, 1213.7833333333356, 1212.7333333333358, 1213.6833333333363, 1213.583333333336, 1214.6000000000033, 1214.3833333333364, 1214.433333333336, 1214.133333333336, 1214.8833333333364, 1214.1833333333368, 1215.0333333333365, 1214.1333333333362, 1212.4833333333365, 1213.833333333337, 1213.783333333336, 1214.383333333336, 1213.6500000000026, 1213.983333333336, 1214.5833333333362, 1214.233333333336, 1213.6833333333357, 1214.4750000000026, 1213.8750000000032, 1213.983333333336, 1213.6333333333362, 1214.2333333333363, 1213.3333333333358, 1214.4833333333356, 1213.6333333333357, 1213.3833333333366, 1213.7333333333356, 1215.133333333336, 1213.5333333333356, 1214.0833333333364, 1214.0333333333365, 1214.1833333333363, 1215.1333333333366, 1214.7833333333363, 1214.4833333333356, 1214.3333333333362, 1214.533333333336, 1214.2833333333358, 1214.833333333336, 1213.383333333336, 1214.1333333333357, 1213.5833333333364, 1213.9333333333363, 1213.2833333333365, 1213.7333333333365, 1213.4333333333361, 1215.083333333337, 1214.683333333337, 1214.6333333333362, 1213.5833333333367, 1214.5333333333353, 1213.7833333333363, 1213.3833333333364, 1213.2833333333356, 1214.383333333336, 1213.8833333333366, 1213.8333333333358, 1213.9333333333368, 1213.7333333333368, 1214.4833333333358, 1213.8333333333364, 1214.583333333337, 1214.533333333336, 1213.9333333333363, 1214.433333333336, 1214.0833333333362, 1213.7333333333358, 1214.283333333336, 1214.0333333333365, 1214.6833333333363, 1214.7833333333363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24064764854745208, "mean_inference_ms": 2.0516913315026524, "mean_action_processing_ms": 0.09063255353834844, "mean_env_wait_ms": 1.5325573361190221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006257534027099609, "StateBufferConnector_ms": 0.0032434463500976562, "ViewRequirementAgentConnector_ms": 0.08396553993225098}, "num_episodes": 24, "episode_return_max": 1216.8750000000032, "episode_return_min": 1212.4833333333365, "episode_return_mean": 1214.207250000003, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 235650, "num_agent_steps_trained": 235500, "num_env_steps_sampled": 235650, "num_env_steps_trained": 235500, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 250.17107011341474, "num_env_steps_trained_throughput_per_sec": 264.88701541420386, "timesteps_total": 235650, "num_env_steps_sampled_lifetime": 235650, "num_agent_steps_sampled_lifetime": 235650, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 235650, "timers": {"training_iteration_time_ms": 10295.204, "restore_workers_time_ms": 0.013, "training_step_time_ms": 597.435, "sample_time_ms": 582.511, "synch_weights_time_ms": 13.459}, "counters": {"num_env_steps_sampled": 235650, "num_env_steps_trained": 235500, "num_agent_steps_sampled": 235650, "num_agent_steps_trained": 235500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1571, "num_samples_added_to_queue": 235500}, "done": false, "training_iteration": 93, "trial_id": "27800_00000", "date": "2024-10-12_15-43-54", "timestamp": 1728744234, "time_this_iter_s": 10.202308893203735, "time_total_s": 962.0166909694672, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f30d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 962.0166909694672, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 15.364285714285714, "ram_util_percent": 52.435714285714276}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3601.375732421875, "policy_loss": -138.98545837402344, "entropy": 4.804358959197998, "entropy_coeff": 0.01, "var_gnorm": 18.07929801940918, "vf_loss": 375477.4375, "vf_explained_var": 0.6511423587799072}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 793.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 238200, "num_env_steps_trained": 237900, "num_agent_steps_sampled": 238200, "num_agent_steps_trained": 237900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1588, "num_samples_added_to_queue": 238200, "learner_queue": {"size_count": 793, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.449, "learner_load_time_ms": 0.319, "learner_load_wait_time_ms": 1147.213, "learner_dequeue_time_ms": 9781.798}}, "env_runners": {"episode_reward_max": 1215.333333333336, "episode_reward_min": 1212.4833333333365, "episode_reward_mean": 1214.107000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.4833333333365}, "policy_reward_max": {"default_policy": 1215.333333333336}, "policy_reward_mean": {"default_policy": 1214.107000000003}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.325, "num_moves_min": 0.1, "num_moves_max": 0.62, "mean_accuracy_mean": 43.63307999999999, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0014000000000000002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16279533333333338, "num_slav_min": 0.16193333333333335, "num_slav_max": 0.16390000000000005, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5411557285346571, "mean_cluster_cpu_util_min": 0.5370707620886193, "mean_cluster_cpu_util_max": 0.5464767650303365, "mean_cluster_mem_util_mean": 0.34166011603375523, "mean_cluster_mem_util_min": 0.3412573839662447, "mean_cluster_mem_util_max": 0.34211497890295367, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333000000000025, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4419299999999997, "reward_sla_mean_min": -2.4584999999999995, "reward_sla_mean_max": -2.4290000000000003, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3000000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.19299999999996, "reward_sla_sum_min": -245.84999999999997, "reward_sla_sum_max": -242.9, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4306.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.6833333333363, 1213.583333333336, 1214.6000000000033, 1214.3833333333364, 1214.433333333336, 1214.133333333336, 1214.8833333333364, 1214.1833333333368, 1215.0333333333365, 1214.1333333333362, 1212.4833333333365, 1213.833333333337, 1213.783333333336, 1214.383333333336, 1213.6500000000026, 1213.983333333336, 1214.5833333333362, 1214.233333333336, 1213.6833333333357, 1214.4750000000026, 1213.8750000000032, 1213.983333333336, 1213.6333333333362, 1214.2333333333363, 1213.3333333333358, 1214.4833333333356, 1213.6333333333357, 1213.3833333333366, 1213.7333333333356, 1215.133333333336, 1213.5333333333356, 1214.0833333333364, 1214.0333333333365, 1214.1833333333363, 1215.1333333333366, 1214.7833333333363, 1214.4833333333356, 1214.3333333333362, 1214.533333333336, 1214.2833333333358, 1214.833333333336, 1213.383333333336, 1214.1333333333357, 1213.5833333333364, 1213.9333333333363, 1213.2833333333365, 1213.7333333333365, 1213.4333333333361, 1215.083333333337, 1214.683333333337, 1214.6333333333362, 1213.5833333333367, 1214.5333333333353, 1213.7833333333363, 1213.3833333333364, 1213.2833333333356, 1214.383333333336, 1213.8833333333366, 1213.8333333333358, 1213.9333333333368, 1213.7333333333368, 1214.4833333333358, 1213.8333333333364, 1214.583333333337, 1214.533333333336, 1213.9333333333363, 1214.433333333336, 1214.0833333333362, 1213.7333333333358, 1214.283333333336, 1214.0333333333365, 1214.6833333333363, 1214.7833333333363, 1213.8833333333366, 1214.3833333333364, 1213.7833333333365, 1212.983333333336, 1214.4333333333363, 1214.483333333336, 1213.933333333336, 1213.9833333333363, 1213.0833333333362, 1214.6333333333362, 1214.4333333333357, 1214.1333333333362, 1215.333333333336, 1213.4833333333368, 1214.583333333336, 1213.883333333336, 1213.2333333333356, 1213.8333333333362, 1213.2833333333365, 1215.1333333333353, 1214.0833333333364, 1214.8833333333369, 1214.3333333333367, 1214.5333333333363, 1214.0333333333358, 1214.5333333333363, 1213.9833333333365], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.6833333333363, 1213.583333333336, 1214.6000000000033, 1214.3833333333364, 1214.433333333336, 1214.133333333336, 1214.8833333333364, 1214.1833333333368, 1215.0333333333365, 1214.1333333333362, 1212.4833333333365, 1213.833333333337, 1213.783333333336, 1214.383333333336, 1213.6500000000026, 1213.983333333336, 1214.5833333333362, 1214.233333333336, 1213.6833333333357, 1214.4750000000026, 1213.8750000000032, 1213.983333333336, 1213.6333333333362, 1214.2333333333363, 1213.3333333333358, 1214.4833333333356, 1213.6333333333357, 1213.3833333333366, 1213.7333333333356, 1215.133333333336, 1213.5333333333356, 1214.0833333333364, 1214.0333333333365, 1214.1833333333363, 1215.1333333333366, 1214.7833333333363, 1214.4833333333356, 1214.3333333333362, 1214.533333333336, 1214.2833333333358, 1214.833333333336, 1213.383333333336, 1214.1333333333357, 1213.5833333333364, 1213.9333333333363, 1213.2833333333365, 1213.7333333333365, 1213.4333333333361, 1215.083333333337, 1214.683333333337, 1214.6333333333362, 1213.5833333333367, 1214.5333333333353, 1213.7833333333363, 1213.3833333333364, 1213.2833333333356, 1214.383333333336, 1213.8833333333366, 1213.8333333333358, 1213.9333333333368, 1213.7333333333368, 1214.4833333333358, 1213.8333333333364, 1214.583333333337, 1214.533333333336, 1213.9333333333363, 1214.433333333336, 1214.0833333333362, 1213.7333333333358, 1214.283333333336, 1214.0333333333365, 1214.6833333333363, 1214.7833333333363, 1213.8833333333366, 1214.3833333333364, 1213.7833333333365, 1212.983333333336, 1214.4333333333363, 1214.483333333336, 1213.933333333336, 1213.9833333333363, 1213.0833333333362, 1214.6333333333362, 1214.4333333333357, 1214.1333333333362, 1215.333333333336, 1213.4833333333368, 1214.583333333336, 1213.883333333336, 1213.2333333333356, 1213.8333333333362, 1213.2833333333365, 1215.1333333333353, 1214.0833333333364, 1214.8833333333369, 1214.3333333333367, 1214.5333333333363, 1214.0333333333358, 1214.5333333333363, 1213.9833333333365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24060369674838483, "mean_inference_ms": 2.0497266819115465, "mean_action_processing_ms": 0.09059395934578258, "mean_env_wait_ms": 1.5318894680103086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00620579719543457, "StateBufferConnector_ms": 0.003198862075805664, "ViewRequirementAgentConnector_ms": 0.08275461196899414}, "num_episodes": 27, "episode_return_max": 1215.333333333336, "episode_return_min": 1212.4833333333365, "episode_return_mean": 1214.107000000003, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 238200, "num_agent_steps_trained": 237900, "num_env_steps_sampled": 238200, "num_env_steps_trained": 237900, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 250.3142468560336, "num_env_steps_trained_throughput_per_sec": 235.58987939391398, "timesteps_total": 238200, "num_env_steps_sampled_lifetime": 238200, "num_agent_steps_sampled_lifetime": 238200, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 238200, "timers": {"training_iteration_time_ms": 10305.45, "restore_workers_time_ms": 0.012, "training_step_time_ms": 589.717, "sample_time_ms": 574.197, "synch_weights_time_ms": 14.049}, "counters": {"num_env_steps_sampled": 238200, "num_env_steps_trained": 237900, "num_agent_steps_sampled": 238200, "num_agent_steps_trained": 237900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1588, "num_samples_added_to_queue": 238200}, "done": false, "training_iteration": 94, "trial_id": "27800_00000", "date": "2024-10-12_15-44-04", "timestamp": 1728744244, "time_this_iter_s": 10.19842267036438, "time_total_s": 972.2151136398315, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b47550>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 972.2151136398315, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 15.55333333333333, "ram_util_percent": 51.91333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2000.3280029296875, "policy_loss": -1105.3416748046875, "entropy": 4.936345100402832, "entropy_coeff": 0.01, "var_gnorm": 18.060142517089844, "vf_loss": 312047.875, "vf_explained_var": 0.6722352504730225}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 802.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 240900, "num_env_steps_trained": 240600, "num_agent_steps_sampled": 240900, "num_agent_steps_trained": 240600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1606, "num_samples_added_to_queue": 240900, "learner_queue": {"size_count": 802, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.165, "learner_load_time_ms": 0.307, "learner_load_wait_time_ms": 1112.325, "learner_dequeue_time_ms": 9735.164}}, "env_runners": {"episode_reward_max": 1216.100000000003, "episode_reward_min": 1212.3000000000022, "episode_reward_mean": 1214.0550833333361, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.3000000000022}, "policy_reward_max": {"default_policy": 1216.100000000003}, "policy_reward_mean": {"default_policy": 1214.0550833333361}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.3828000000000001, "num_moves_min": 0.15, "num_moves_max": 0.62, "mean_accuracy_mean": 43.633206666666666, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.001, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.1628271666666667, "num_slav_min": 0.16093333333333334, "num_slav_max": 0.1636666666666667, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5424005681478673, "mean_cluster_cpu_util_min": 0.5370707620886193, "mean_cluster_cpu_util_max": 0.5464767650303365, "mean_cluster_mem_util_mean": 0.3416503902953587, "mean_cluster_mem_util_min": 0.3412310126582279, "mean_cluster_mem_util_max": 0.34211497890295367, "reward_consolidation_mean_mean": 6.249791666666668, "reward_consolidation_mean_min": 6.229166666666668, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333166666666692, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4424075, "reward_sla_mean_min": -2.455, "reward_sla_mean_max": -2.414, "reward_consolidation_sum_mean": 624.9791666666667, "reward_consolidation_sum_min": 622.9166666666667, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3166666666694, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.24075000000005, "reward_sla_sum_min": -245.5, "reward_sla_sum_max": -241.4, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3093.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.3833333333366, 1213.7333333333356, 1215.133333333336, 1213.5333333333356, 1214.0833333333364, 1214.0333333333365, 1214.1833333333363, 1215.1333333333366, 1214.7833333333363, 1214.4833333333356, 1214.3333333333362, 1214.533333333336, 1214.2833333333358, 1214.833333333336, 1213.383333333336, 1214.1333333333357, 1213.5833333333364, 1213.9333333333363, 1213.2833333333365, 1213.7333333333365, 1213.4333333333361, 1215.083333333337, 1214.683333333337, 1214.6333333333362, 1213.5833333333367, 1214.5333333333353, 1213.7833333333363, 1213.3833333333364, 1213.2833333333356, 1214.383333333336, 1213.8833333333366, 1213.8333333333358, 1213.9333333333368, 1213.7333333333368, 1214.4833333333358, 1213.8333333333364, 1214.583333333337, 1214.533333333336, 1213.9333333333363, 1214.433333333336, 1214.0833333333362, 1213.7333333333358, 1214.283333333336, 1214.0333333333365, 1214.6833333333363, 1214.7833333333363, 1213.8833333333366, 1214.3833333333364, 1213.7833333333365, 1212.983333333336, 1214.4333333333363, 1214.483333333336, 1213.933333333336, 1213.9833333333363, 1213.0833333333362, 1214.6333333333362, 1214.4333333333357, 1214.1333333333362, 1215.333333333336, 1213.4833333333368, 1214.583333333336, 1213.883333333336, 1213.2333333333356, 1213.8333333333362, 1213.2833333333365, 1215.1333333333353, 1214.0833333333364, 1214.8833333333369, 1214.3333333333367, 1214.5333333333363, 1214.0333333333358, 1214.5333333333363, 1213.9833333333365, 1214.2833333333367, 1214.7833333333363, 1212.8333333333362, 1212.8333333333367, 1214.233333333336, 1213.5333333333358, 1214.4833333333363, 1214.3750000000027, 1214.583333333336, 1213.5833333333362, 1213.8833333333366, 1213.933333333336, 1214.6833333333361, 1214.033333333336, 1214.3833333333362, 1212.9833333333365, 1212.3000000000022, 1214.433333333336, 1213.6833333333368, 1214.0333333333358, 1213.433333333336, 1212.8833333333362, 1213.033333333337, 1216.100000000003, 1214.333333333336, 1212.8333333333358, 1213.6333333333362], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.3833333333366, 1213.7333333333356, 1215.133333333336, 1213.5333333333356, 1214.0833333333364, 1214.0333333333365, 1214.1833333333363, 1215.1333333333366, 1214.7833333333363, 1214.4833333333356, 1214.3333333333362, 1214.533333333336, 1214.2833333333358, 1214.833333333336, 1213.383333333336, 1214.1333333333357, 1213.5833333333364, 1213.9333333333363, 1213.2833333333365, 1213.7333333333365, 1213.4333333333361, 1215.083333333337, 1214.683333333337, 1214.6333333333362, 1213.5833333333367, 1214.5333333333353, 1213.7833333333363, 1213.3833333333364, 1213.2833333333356, 1214.383333333336, 1213.8833333333366, 1213.8333333333358, 1213.9333333333368, 1213.7333333333368, 1214.4833333333358, 1213.8333333333364, 1214.583333333337, 1214.533333333336, 1213.9333333333363, 1214.433333333336, 1214.0833333333362, 1213.7333333333358, 1214.283333333336, 1214.0333333333365, 1214.6833333333363, 1214.7833333333363, 1213.8833333333366, 1214.3833333333364, 1213.7833333333365, 1212.983333333336, 1214.4333333333363, 1214.483333333336, 1213.933333333336, 1213.9833333333363, 1213.0833333333362, 1214.6333333333362, 1214.4333333333357, 1214.1333333333362, 1215.333333333336, 1213.4833333333368, 1214.583333333336, 1213.883333333336, 1213.2333333333356, 1213.8333333333362, 1213.2833333333365, 1215.1333333333353, 1214.0833333333364, 1214.8833333333369, 1214.3333333333367, 1214.5333333333363, 1214.0333333333358, 1214.5333333333363, 1213.9833333333365, 1214.2833333333367, 1214.7833333333363, 1212.8333333333362, 1212.8333333333367, 1214.233333333336, 1213.5333333333358, 1214.4833333333363, 1214.3750000000027, 1214.583333333336, 1213.5833333333362, 1213.8833333333366, 1213.933333333336, 1214.6833333333361, 1214.033333333336, 1214.3833333333362, 1212.9833333333365, 1212.3000000000022, 1214.433333333336, 1213.6833333333368, 1214.0333333333358, 1213.433333333336, 1212.8833333333362, 1213.033333333337, 1216.100000000003, 1214.333333333336, 1212.8333333333358, 1213.6333333333362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24049430963003707, "mean_inference_ms": 2.0457640219732607, "mean_action_processing_ms": 0.09052899224251199, "mean_env_wait_ms": 1.5307196103532335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063092708587646484, "StateBufferConnector_ms": 0.003178834915161133, "ViewRequirementAgentConnector_ms": 0.08197331428527832}, "num_episodes": 27, "episode_return_max": 1216.100000000003, "episode_return_min": 1212.3000000000022, "episode_return_mean": 1214.0550833333361, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240900, "num_agent_steps_trained": 240600, "num_env_steps_sampled": 240900, "num_env_steps_trained": 240600, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 254.47337718241823, "num_env_steps_trained_throughput_per_sec": 254.47337718241823, "timesteps_total": 240900, "num_env_steps_sampled_lifetime": 240900, "num_agent_steps_sampled_lifetime": 240900, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 240900, "timers": {"training_iteration_time_ms": 10339.37, "restore_workers_time_ms": 0.012, "training_step_time_ms": 588.09, "sample_time_ms": 572.815, "synch_weights_time_ms": 13.875}, "counters": {"num_env_steps_sampled": 240900, "num_env_steps_trained": 240600, "num_agent_steps_sampled": 240900, "num_agent_steps_trained": 240600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1606, "num_samples_added_to_queue": 240900}, "done": false, "training_iteration": 95, "trial_id": "27800_00000", "date": "2024-10-12_15-44-15", "timestamp": 1728744255, "time_this_iter_s": 10.622085571289062, "time_total_s": 982.8371992111206, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b47910>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 982.8371992111206, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 15.659999999999998, "ram_util_percent": 52.17333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4381.6025390625, "policy_loss": 991.1448974609375, "entropy": 4.800716876983643, "entropy_coeff": 0.01, "var_gnorm": 18.05086326599121, "vf_loss": 340485.96875, "vf_explained_var": 0.6506634950637817}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 811.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 243450, "num_env_steps_trained": 243300, "num_agent_steps_sampled": 243450, "num_agent_steps_trained": 243300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1623, "num_samples_added_to_queue": 243300, "learner_queue": {"size_count": 811, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.424, "learner_load_time_ms": 0.311, "learner_load_wait_time_ms": 1126.644, "learner_dequeue_time_ms": 9719.378}}, "env_runners": {"episode_reward_max": 1216.100000000003, "episode_reward_min": 1212.3000000000022, "episode_reward_mean": 1214.0784166666697, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.3000000000022}, "policy_reward_max": {"default_policy": 1216.100000000003}, "policy_reward_mean": {"default_policy": 1214.0784166666697}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.4186000000000001, "num_moves_min": 0.24, "num_moves_max": 0.62, "mean_accuracy_mean": 43.63308, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0013999999999999998, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16280050000000001, "num_slav_min": 0.16093333333333334, "num_slav_max": 0.1636666666666667, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5427066840469297, "mean_cluster_cpu_util_min": 0.5386606683213826, "mean_cluster_cpu_util_max": 0.5464767650303365, "mean_cluster_mem_util_mean": 0.3416387289029535, "mean_cluster_mem_util_min": 0.34120042194092837, "mean_cluster_mem_util_max": 0.34211497890295367, "reward_consolidation_mean_mean": 6.249791666666668, "reward_consolidation_mean_min": 6.229166666666668, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333000000000025, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4420075, "reward_sla_mean_min": -2.455, "reward_sla_mean_max": -2.414, "reward_consolidation_sum_mean": 624.9791666666667, "reward_consolidation_sum_min": 622.9166666666667, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3000000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.20075, "reward_sla_sum_min": -245.5, "reward_sla_sum_max": -241.4, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2028.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.5833333333367, 1214.5333333333353, 1213.7833333333363, 1213.3833333333364, 1213.2833333333356, 1214.383333333336, 1213.8833333333366, 1213.8333333333358, 1213.9333333333368, 1213.7333333333368, 1214.4833333333358, 1213.8333333333364, 1214.583333333337, 1214.533333333336, 1213.9333333333363, 1214.433333333336, 1214.0833333333362, 1213.7333333333358, 1214.283333333336, 1214.0333333333365, 1214.6833333333363, 1214.7833333333363, 1213.8833333333366, 1214.3833333333364, 1213.7833333333365, 1212.983333333336, 1214.4333333333363, 1214.483333333336, 1213.933333333336, 1213.9833333333363, 1213.0833333333362, 1214.6333333333362, 1214.4333333333357, 1214.1333333333362, 1215.333333333336, 1213.4833333333368, 1214.583333333336, 1213.883333333336, 1213.2333333333356, 1213.8333333333362, 1213.2833333333365, 1215.1333333333353, 1214.0833333333364, 1214.8833333333369, 1214.3333333333367, 1214.5333333333363, 1214.0333333333358, 1214.5333333333363, 1213.9833333333365, 1214.2833333333367, 1214.7833333333363, 1212.8333333333362, 1212.8333333333367, 1214.233333333336, 1213.5333333333358, 1214.4833333333363, 1214.3750000000027, 1214.583333333336, 1213.5833333333362, 1213.8833333333366, 1213.933333333336, 1214.6833333333361, 1214.033333333336, 1214.3833333333362, 1212.9833333333365, 1212.3000000000022, 1214.433333333336, 1213.6833333333368, 1214.0333333333358, 1213.433333333336, 1212.8833333333362, 1213.033333333337, 1216.100000000003, 1214.333333333336, 1212.8333333333358, 1213.6333333333362, 1214.883333333336, 1214.3833333333364, 1214.4000000000035, 1214.2333333333358, 1215.400000000003, 1214.283333333336, 1214.283333333336, 1214.3333333333364, 1215.483333333336, 1212.8833333333364, 1214.8333333333364, 1214.1333333333362, 1213.833333333336, 1214.833333333337, 1213.5833333333362, 1214.5333333333363, 1214.4333333333363, 1214.5833333333358, 1213.5833333333364, 1215.3833333333366, 1213.0333333333356, 1214.9333333333368, 1212.8333333333364, 1213.5833333333364], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.5833333333367, 1214.5333333333353, 1213.7833333333363, 1213.3833333333364, 1213.2833333333356, 1214.383333333336, 1213.8833333333366, 1213.8333333333358, 1213.9333333333368, 1213.7333333333368, 1214.4833333333358, 1213.8333333333364, 1214.583333333337, 1214.533333333336, 1213.9333333333363, 1214.433333333336, 1214.0833333333362, 1213.7333333333358, 1214.283333333336, 1214.0333333333365, 1214.6833333333363, 1214.7833333333363, 1213.8833333333366, 1214.3833333333364, 1213.7833333333365, 1212.983333333336, 1214.4333333333363, 1214.483333333336, 1213.933333333336, 1213.9833333333363, 1213.0833333333362, 1214.6333333333362, 1214.4333333333357, 1214.1333333333362, 1215.333333333336, 1213.4833333333368, 1214.583333333336, 1213.883333333336, 1213.2333333333356, 1213.8333333333362, 1213.2833333333365, 1215.1333333333353, 1214.0833333333364, 1214.8833333333369, 1214.3333333333367, 1214.5333333333363, 1214.0333333333358, 1214.5333333333363, 1213.9833333333365, 1214.2833333333367, 1214.7833333333363, 1212.8333333333362, 1212.8333333333367, 1214.233333333336, 1213.5333333333358, 1214.4833333333363, 1214.3750000000027, 1214.583333333336, 1213.5833333333362, 1213.8833333333366, 1213.933333333336, 1214.6833333333361, 1214.033333333336, 1214.3833333333362, 1212.9833333333365, 1212.3000000000022, 1214.433333333336, 1213.6833333333368, 1214.0333333333358, 1213.433333333336, 1212.8833333333362, 1213.033333333337, 1216.100000000003, 1214.333333333336, 1212.8333333333358, 1213.6333333333362, 1214.883333333336, 1214.3833333333364, 1214.4000000000035, 1214.2333333333358, 1215.400000000003, 1214.283333333336, 1214.283333333336, 1214.3333333333364, 1215.483333333336, 1212.8833333333364, 1214.8333333333364, 1214.1333333333362, 1213.833333333336, 1214.833333333337, 1213.5833333333362, 1214.5333333333363, 1214.4333333333363, 1214.5833333333358, 1213.5833333333364, 1215.3833333333366, 1213.0333333333356, 1214.9333333333368, 1212.8333333333364, 1213.5833333333364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24049997562786793, "mean_inference_ms": 2.0486613269993286, "mean_action_processing_ms": 0.09054538450227306, "mean_env_wait_ms": 1.5311916296232664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006566762924194336, "StateBufferConnector_ms": 0.0031499862670898438, "ViewRequirementAgentConnector_ms": 0.08137011528015137}, "num_episodes": 24, "episode_return_max": 1216.100000000003, "episode_return_min": 1212.3000000000022, "episode_return_mean": 1214.0784166666697, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 243450, "num_agent_steps_trained": 243300, "num_env_steps_sampled": 243450, "num_env_steps_trained": 243300, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 250.78648258310747, "num_env_steps_trained_throughput_per_sec": 265.5386286174079, "timesteps_total": 243450, "num_env_steps_sampled_lifetime": 243450, "num_agent_steps_sampled_lifetime": 243450, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 243450, "timers": {"training_iteration_time_ms": 10308.866, "restore_workers_time_ms": 0.013, "training_step_time_ms": 594.795, "sample_time_ms": 579.578, "synch_weights_time_ms": 13.847}, "counters": {"num_env_steps_sampled": 243450, "num_env_steps_trained": 243300, "num_agent_steps_sampled": 243450, "num_agent_steps_trained": 243300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1623, "num_samples_added_to_queue": 243300}, "done": false, "training_iteration": 96, "trial_id": "27800_00000", "date": "2024-10-12_15-44-25", "timestamp": 1728744265, "time_this_iter_s": 10.181278944015503, "time_total_s": 993.0184781551361, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f36d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 993.0184781551361, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 15.693333333333333, "ram_util_percent": 52.273333333333326}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4730.32763671875, "policy_loss": 877.6463012695312, "entropy": 4.726763725280762, "entropy_coeff": 0.01, "var_gnorm": 18.058094024658203, "vf_loss": 386686.1875, "vf_explained_var": 0.6365315914154053}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 819.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 245850, "num_env_steps_trained": 245700, "num_agent_steps_sampled": 245850, "num_agent_steps_trained": 245700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1639, "num_samples_added_to_queue": 245700, "learner_queue": {"size_count": 819, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.346, "learner_load_time_ms": 0.293, "learner_load_wait_time_ms": 1221.922, "learner_dequeue_time_ms": 9827.833}}, "env_runners": {"episode_reward_max": 1216.100000000003, "episode_reward_min": 1212.3000000000022, "episode_reward_mean": 1214.053750000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.3000000000022}, "policy_reward_max": {"default_policy": 1216.100000000003}, "policy_reward_mean": {"default_policy": 1214.053750000003}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.3779, "num_moves_min": 0.18, "num_moves_max": 0.6, "mean_accuracy_mean": 43.63295333333333, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63966666666667, "num_model_switches_mean": 0.0016, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16280583333333332, "num_slav_min": 0.16093333333333334, "num_slav_max": 0.1636666666666667, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5422624800342435, "mean_cluster_cpu_util_min": 0.5375491588527304, "mean_cluster_cpu_util_max": 0.5464767650303365, "mean_cluster_mem_util_mean": 0.3416298364978904, "mean_cluster_mem_util_min": 0.34120042194092837, "mean_cluster_mem_util_max": 0.34211497890295367, "reward_consolidation_mean_mean": 6.249791666666668, "reward_consolidation_mean_min": 6.229166666666668, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.33283333333336, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.341666666666695, "reward_sla_mean_mean": -2.4420875, "reward_sla_mean_min": -2.455, "reward_sla_mean_max": -2.414, "reward_consolidation_sum_mean": 624.9791666666667, "reward_consolidation_sum_min": 622.9166666666667, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.283333333336, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 834.1666666666695, "reward_sla_sum_mean": -244.20875000000004, "reward_sla_sum_min": -245.5, "reward_sla_sum_max": -241.4, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2282.0, "global_timestep_min": 600, "global_timestep_max": 3900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.7833333333365, 1212.983333333336, 1214.4333333333363, 1214.483333333336, 1213.933333333336, 1213.9833333333363, 1213.0833333333362, 1214.6333333333362, 1214.4333333333357, 1214.1333333333362, 1215.333333333336, 1213.4833333333368, 1214.583333333336, 1213.883333333336, 1213.2333333333356, 1213.8333333333362, 1213.2833333333365, 1215.1333333333353, 1214.0833333333364, 1214.8833333333369, 1214.3333333333367, 1214.5333333333363, 1214.0333333333358, 1214.5333333333363, 1213.9833333333365, 1214.2833333333367, 1214.7833333333363, 1212.8333333333362, 1212.8333333333367, 1214.233333333336, 1213.5333333333358, 1214.4833333333363, 1214.3750000000027, 1214.583333333336, 1213.5833333333362, 1213.8833333333366, 1213.933333333336, 1214.6833333333361, 1214.033333333336, 1214.3833333333362, 1212.9833333333365, 1212.3000000000022, 1214.433333333336, 1213.6833333333368, 1214.0333333333358, 1213.433333333336, 1212.8833333333362, 1213.033333333337, 1216.100000000003, 1214.333333333336, 1212.8333333333358, 1213.6333333333362, 1214.883333333336, 1214.3833333333364, 1214.4000000000035, 1214.2333333333358, 1215.400000000003, 1214.283333333336, 1214.283333333336, 1214.3333333333364, 1215.483333333336, 1212.8833333333364, 1214.8333333333364, 1214.1333333333362, 1213.833333333336, 1214.833333333337, 1213.5833333333362, 1214.5333333333363, 1214.4333333333363, 1214.5833333333358, 1213.5833333333364, 1215.3833333333366, 1213.0333333333356, 1214.9333333333368, 1212.8333333333364, 1213.5833333333364, 1214.4833333333358, 1213.9333333333363, 1213.9500000000037, 1213.2833333333365, 1214.1333333333369, 1214.5333333333365, 1214.1833333333357, 1214.075000000003, 1213.816666666669, 1213.7833333333365, 1214.2333333333363, 1213.9833333333354, 1214.3333333333358, 1213.383333333336, 1213.0333333333363, 1213.733333333336, 1214.0333333333365, 1213.7333333333368, 1215.1333333333364, 1213.983333333337, 1213.6833333333361, 1214.5833333333367, 1213.4750000000022, 1214.0333333333367], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.7833333333365, 1212.983333333336, 1214.4333333333363, 1214.483333333336, 1213.933333333336, 1213.9833333333363, 1213.0833333333362, 1214.6333333333362, 1214.4333333333357, 1214.1333333333362, 1215.333333333336, 1213.4833333333368, 1214.583333333336, 1213.883333333336, 1213.2333333333356, 1213.8333333333362, 1213.2833333333365, 1215.1333333333353, 1214.0833333333364, 1214.8833333333369, 1214.3333333333367, 1214.5333333333363, 1214.0333333333358, 1214.5333333333363, 1213.9833333333365, 1214.2833333333367, 1214.7833333333363, 1212.8333333333362, 1212.8333333333367, 1214.233333333336, 1213.5333333333358, 1214.4833333333363, 1214.3750000000027, 1214.583333333336, 1213.5833333333362, 1213.8833333333366, 1213.933333333336, 1214.6833333333361, 1214.033333333336, 1214.3833333333362, 1212.9833333333365, 1212.3000000000022, 1214.433333333336, 1213.6833333333368, 1214.0333333333358, 1213.433333333336, 1212.8833333333362, 1213.033333333337, 1216.100000000003, 1214.333333333336, 1212.8333333333358, 1213.6333333333362, 1214.883333333336, 1214.3833333333364, 1214.4000000000035, 1214.2333333333358, 1215.400000000003, 1214.283333333336, 1214.283333333336, 1214.3333333333364, 1215.483333333336, 1212.8833333333364, 1214.8333333333364, 1214.1333333333362, 1213.833333333336, 1214.833333333337, 1213.5833333333362, 1214.5333333333363, 1214.4333333333363, 1214.5833333333358, 1213.5833333333364, 1215.3833333333366, 1213.0333333333356, 1214.9333333333368, 1212.8333333333364, 1213.5833333333364, 1214.4833333333358, 1213.9333333333363, 1213.9500000000037, 1213.2833333333365, 1214.1333333333369, 1214.5333333333365, 1214.1833333333357, 1214.075000000003, 1213.816666666669, 1213.7833333333365, 1214.2333333333363, 1213.9833333333354, 1214.3333333333358, 1213.383333333336, 1213.0333333333363, 1213.733333333336, 1214.0333333333365, 1213.7333333333368, 1215.1333333333364, 1213.983333333337, 1213.6833333333361, 1214.5833333333367, 1213.4750000000022, 1214.0333333333367]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24046818266207245, "mean_inference_ms": 2.0484841773326847, "mean_action_processing_ms": 0.09053050998310036, "mean_env_wait_ms": 1.5309926437964843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006677389144897461, "StateBufferConnector_ms": 0.0032303333282470703, "ViewRequirementAgentConnector_ms": 0.08277010917663574}, "num_episodes": 24, "episode_return_max": 1216.100000000003, "episode_return_min": 1212.3000000000022, "episode_return_mean": 1214.053750000003, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 245850, "num_agent_steps_trained": 245700, "num_env_steps_sampled": 245850, "num_env_steps_trained": 245700, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 235.6522115725185, "num_env_steps_trained_throughput_per_sec": 235.6522115725185, "timesteps_total": 245850, "num_env_steps_sampled_lifetime": 245850, "num_agent_steps_sampled_lifetime": 245850, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 245850, "timers": {"training_iteration_time_ms": 10311.24, "restore_workers_time_ms": 0.012, "training_step_time_ms": 662.304, "sample_time_ms": 646.197, "synch_weights_time_ms": 14.665}, "counters": {"num_env_steps_sampled": 245850, "num_env_steps_trained": 245700, "num_agent_steps_sampled": 245850, "num_agent_steps_trained": 245700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1639, "num_samples_added_to_queue": 245700}, "done": false, "training_iteration": 97, "trial_id": "27800_00000", "date": "2024-10-12_15-44-35", "timestamp": 1728744275, "time_this_iter_s": 10.19752550125122, "time_total_s": 1003.2160036563873, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b447c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1003.2160036563873, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 18.892857142857142, "ram_util_percent": 53.13571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3100.0146484375, "policy_loss": -678.1468505859375, "entropy": 4.697062015533447, "entropy_coeff": 0.01, "var_gnorm": 18.070579528808594, "vf_loss": 379225.28125, "vf_explained_var": 0.6392663717269897}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 827.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 248400, "num_env_steps_trained": 248100, "num_agent_steps_sampled": 248400, "num_agent_steps_trained": 248100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1656, "num_samples_added_to_queue": 248400, "learner_queue": {"size_count": 827, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.839, "learner_load_time_ms": 0.265, "learner_load_wait_time_ms": 1142.658, "learner_dequeue_time_ms": 9875.818}}, "env_runners": {"episode_reward_max": 1216.100000000003, "episode_reward_min": 1211.7500000000027, "episode_reward_mean": 1213.9900833333363, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.7500000000027}, "policy_reward_max": {"default_policy": 1216.100000000003}, "policy_reward_mean": {"default_policy": 1213.9900833333363}, "custom_metrics": {"num_consolidated_mean": 2.9998, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.34090000000000004, "num_moves_min": 0.14, "num_moves_max": 0.6, "mean_accuracy_mean": 43.632889999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63966666666667, "num_model_switches_mean": 0.0018, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16282883333333337, "num_slav_min": 0.16093333333333334, "num_slav_max": 0.1636666666666667, "cpu_conserved_cost_mean": 7.999199999999999, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5407137515512962, "mean_cluster_cpu_util_min": 0.5375491588527304, "mean_cluster_cpu_util_max": 0.5461840182018753, "mean_cluster_mem_util_mean": 0.34161817246835435, "mean_cluster_mem_util_min": 0.34120042194092837, "mean_cluster_mem_util_max": 0.3420021097046414, "reward_consolidation_mean_mean": 6.249583333333334, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.332750000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.341666666666695, "reward_sla_mean_mean": -2.4424325, "reward_sla_mean_min": -2.455, "reward_sla_mean_max": -2.414, "reward_consolidation_sum_mean": 624.9583333333334, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.2750000000028, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 834.1666666666695, "reward_sla_sum_mean": -244.24324999999996, "reward_sla_sum_min": -245.5, "reward_sla_sum_max": -241.4, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3182.0, "global_timestep_min": 1500, "global_timestep_max": 4800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1212.8333333333362, 1212.8333333333367, 1214.233333333336, 1213.5333333333358, 1214.4833333333363, 1214.3750000000027, 1214.583333333336, 1213.5833333333362, 1213.8833333333366, 1213.933333333336, 1214.6833333333361, 1214.033333333336, 1214.3833333333362, 1212.9833333333365, 1212.3000000000022, 1214.433333333336, 1213.6833333333368, 1214.0333333333358, 1213.433333333336, 1212.8833333333362, 1213.033333333337, 1216.100000000003, 1214.333333333336, 1212.8333333333358, 1213.6333333333362, 1214.883333333336, 1214.3833333333364, 1214.4000000000035, 1214.2333333333358, 1215.400000000003, 1214.283333333336, 1214.283333333336, 1214.3333333333364, 1215.483333333336, 1212.8833333333364, 1214.8333333333364, 1214.1333333333362, 1213.833333333336, 1214.833333333337, 1213.5833333333362, 1214.5333333333363, 1214.4333333333363, 1214.5833333333358, 1213.5833333333364, 1215.3833333333366, 1213.0333333333356, 1214.9333333333368, 1212.8333333333364, 1213.5833333333364, 1214.4833333333358, 1213.9333333333363, 1213.9500000000037, 1213.2833333333365, 1214.1333333333369, 1214.5333333333365, 1214.1833333333357, 1214.075000000003, 1213.816666666669, 1213.7833333333365, 1214.2333333333363, 1213.9833333333354, 1214.3333333333358, 1213.383333333336, 1213.0333333333363, 1213.733333333336, 1214.0333333333365, 1213.7333333333368, 1215.1333333333364, 1213.983333333337, 1213.6833333333361, 1214.5833333333367, 1213.4750000000022, 1214.0333333333367, 1214.033333333336, 1213.283333333336, 1214.5833333333355, 1214.4333333333361, 1214.283333333336, 1213.733333333336, 1214.7333333333365, 1213.983333333336, 1213.2833333333365, 1214.3833333333357, 1213.633333333336, 1211.7500000000027, 1213.7333333333368, 1213.783333333336, 1214.2833333333363, 1214.183333333336, 1214.383333333336, 1213.6833333333363, 1213.4833333333363, 1213.3333333333364, 1214.5333333333363, 1213.683333333337, 1213.7333333333358, 1214.0000000000032, 1213.533333333336, 1214.983333333336, 1214.2833333333363], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1212.8333333333362, 1212.8333333333367, 1214.233333333336, 1213.5333333333358, 1214.4833333333363, 1214.3750000000027, 1214.583333333336, 1213.5833333333362, 1213.8833333333366, 1213.933333333336, 1214.6833333333361, 1214.033333333336, 1214.3833333333362, 1212.9833333333365, 1212.3000000000022, 1214.433333333336, 1213.6833333333368, 1214.0333333333358, 1213.433333333336, 1212.8833333333362, 1213.033333333337, 1216.100000000003, 1214.333333333336, 1212.8333333333358, 1213.6333333333362, 1214.883333333336, 1214.3833333333364, 1214.4000000000035, 1214.2333333333358, 1215.400000000003, 1214.283333333336, 1214.283333333336, 1214.3333333333364, 1215.483333333336, 1212.8833333333364, 1214.8333333333364, 1214.1333333333362, 1213.833333333336, 1214.833333333337, 1213.5833333333362, 1214.5333333333363, 1214.4333333333363, 1214.5833333333358, 1213.5833333333364, 1215.3833333333366, 1213.0333333333356, 1214.9333333333368, 1212.8333333333364, 1213.5833333333364, 1214.4833333333358, 1213.9333333333363, 1213.9500000000037, 1213.2833333333365, 1214.1333333333369, 1214.5333333333365, 1214.1833333333357, 1214.075000000003, 1213.816666666669, 1213.7833333333365, 1214.2333333333363, 1213.9833333333354, 1214.3333333333358, 1213.383333333336, 1213.0333333333363, 1213.733333333336, 1214.0333333333365, 1213.7333333333368, 1215.1333333333364, 1213.983333333337, 1213.6833333333361, 1214.5833333333367, 1213.4750000000022, 1214.0333333333367, 1214.033333333336, 1213.283333333336, 1214.5833333333355, 1214.4333333333361, 1214.283333333336, 1213.733333333336, 1214.7333333333365, 1213.983333333336, 1213.2833333333365, 1214.3833333333357, 1213.633333333336, 1211.7500000000027, 1213.7333333333368, 1213.783333333336, 1214.2833333333363, 1214.183333333336, 1214.383333333336, 1213.6833333333363, 1213.4833333333363, 1213.3333333333364, 1214.5333333333363, 1213.683333333337, 1213.7333333333358, 1214.0000000000032, 1213.533333333336, 1214.983333333336, 1214.2833333333363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24043864861190442, "mean_inference_ms": 2.04839340223026, "mean_action_processing_ms": 0.09051864165355245, "mean_env_wait_ms": 1.5308350225737886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006613016128540039, "StateBufferConnector_ms": 0.0032241344451904297, "ViewRequirementAgentConnector_ms": 0.0822150707244873}, "num_episodes": 27, "episode_return_max": 1216.100000000003, "episode_return_min": 1211.7500000000027, "episode_return_mean": 1213.9900833333363, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248400, "num_agent_steps_trained": 248100, "num_env_steps_sampled": 248400, "num_env_steps_trained": 248100, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 246.8845158556988, "num_env_steps_trained_throughput_per_sec": 232.3618972759518, "timesteps_total": 248400, "num_env_steps_sampled_lifetime": 248400, "num_agent_steps_sampled_lifetime": 248400, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 248400, "timers": {"training_iteration_time_ms": 10316.123, "restore_workers_time_ms": 0.013, "training_step_time_ms": 599.556, "sample_time_ms": 583.368, "synch_weights_time_ms": 14.582}, "counters": {"num_env_steps_sampled": 248400, "num_env_steps_trained": 248100, "num_agent_steps_sampled": 248400, "num_agent_steps_trained": 248100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1656, "num_samples_added_to_queue": 248400}, "done": false, "training_iteration": 98, "trial_id": "27800_00000", "date": "2024-10-12_15-44-46", "timestamp": 1728744286, "time_this_iter_s": 10.34720516204834, "time_total_s": 1013.5632088184357, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486c04c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1013.5632088184357, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 15.700000000000001, "ram_util_percent": 53.37333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3597.9091796875, "policy_loss": -210.35012817382812, "entropy": 4.489888668060303, "entropy_coeff": 0.01, "var_gnorm": 18.088363647460938, "vf_loss": 382172.90625, "vf_explained_var": 0.6384097337722778}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 836.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 250950, "num_env_steps_trained": 250800, "num_agent_steps_sampled": 250950, "num_agent_steps_trained": 250800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1673, "num_samples_added_to_queue": 250800, "learner_queue": {"size_count": 836, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.548, "learner_load_time_ms": 0.239, "learner_load_wait_time_ms": 1147.005, "learner_dequeue_time_ms": 9771.295}}, "env_runners": {"episode_reward_max": 1215.483333333336, "episode_reward_min": 1211.7500000000027, "episode_reward_mean": 1214.022000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.7500000000027}, "policy_reward_max": {"default_policy": 1215.483333333336}, "policy_reward_mean": {"default_policy": 1214.022000000003}, "custom_metrics": {"num_consolidated_mean": 2.9998, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.26780000000000004, "num_moves_min": 0.04, "num_moves_max": 0.55, "mean_accuracy_mean": 43.63301666666666, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63966666666667, "num_model_switches_mean": 0.0014000000000000002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.1628186666666667, "num_slav_min": 0.16140000000000002, "num_slav_max": 0.1636666666666667, "cpu_conserved_cost_mean": 7.999200000000001, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5395480882859901, "mean_cluster_cpu_util_min": 0.5371370081816511, "mean_cluster_cpu_util_max": 0.5427368542011398, "mean_cluster_mem_util_mean": 0.34163322521097045, "mean_cluster_mem_util_min": 0.34120042194092837, "mean_cluster_mem_util_max": 0.3420021097046414, "reward_consolidation_mean_mean": 6.249583333333333, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.332916666666693, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.341666666666695, "reward_sla_mean_mean": -2.44228, "reward_sla_mean_min": -2.4549999999999996, "reward_sla_mean_max": -2.421, "reward_consolidation_sum_mean": 624.9583333333334, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.2916666666695, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 834.1666666666695, "reward_sla_sum_mean": -244.22799999999995, "reward_sla_sum_min": -245.49999999999997, "reward_sla_sum_max": -242.1, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3983.0, "global_timestep_min": 2300, "global_timestep_max": 5600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.6333333333362, 1214.883333333336, 1214.3833333333364, 1214.4000000000035, 1214.2333333333358, 1215.400000000003, 1214.283333333336, 1214.283333333336, 1214.3333333333364, 1215.483333333336, 1212.8833333333364, 1214.8333333333364, 1214.1333333333362, 1213.833333333336, 1214.833333333337, 1213.5833333333362, 1214.5333333333363, 1214.4333333333363, 1214.5833333333358, 1213.5833333333364, 1215.3833333333366, 1213.0333333333356, 1214.9333333333368, 1212.8333333333364, 1213.5833333333364, 1214.4833333333358, 1213.9333333333363, 1213.9500000000037, 1213.2833333333365, 1214.1333333333369, 1214.5333333333365, 1214.1833333333357, 1214.075000000003, 1213.816666666669, 1213.7833333333365, 1214.2333333333363, 1213.9833333333354, 1214.3333333333358, 1213.383333333336, 1213.0333333333363, 1213.733333333336, 1214.0333333333365, 1213.7333333333368, 1215.1333333333364, 1213.983333333337, 1213.6833333333361, 1214.5833333333367, 1213.4750000000022, 1214.0333333333367, 1214.033333333336, 1213.283333333336, 1214.5833333333355, 1214.4333333333361, 1214.283333333336, 1213.733333333336, 1214.7333333333365, 1213.983333333336, 1213.2833333333365, 1214.3833333333357, 1213.633333333336, 1211.7500000000027, 1213.7333333333368, 1213.783333333336, 1214.2833333333363, 1214.183333333336, 1214.383333333336, 1213.6833333333363, 1213.4833333333363, 1213.3333333333364, 1214.5333333333363, 1213.683333333337, 1213.7333333333358, 1214.0000000000032, 1213.533333333336, 1214.983333333336, 1214.2833333333363, 1214.2333333333358, 1213.9833333333356, 1213.5333333333363, 1213.7333333333365, 1214.2833333333365, 1214.6333333333366, 1214.4333333333363, 1213.5833333333358, 1214.2333333333356, 1213.2833333333365, 1214.3833333333366, 1214.583333333337, 1212.7000000000032, 1213.3833333333362, 1214.033333333336, 1213.2833333333367, 1215.0833333333364, 1213.8833333333366, 1213.2333333333358, 1213.1333333333369, 1214.1833333333361, 1213.483333333336, 1214.2333333333358, 1215.083333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.6333333333362, 1214.883333333336, 1214.3833333333364, 1214.4000000000035, 1214.2333333333358, 1215.400000000003, 1214.283333333336, 1214.283333333336, 1214.3333333333364, 1215.483333333336, 1212.8833333333364, 1214.8333333333364, 1214.1333333333362, 1213.833333333336, 1214.833333333337, 1213.5833333333362, 1214.5333333333363, 1214.4333333333363, 1214.5833333333358, 1213.5833333333364, 1215.3833333333366, 1213.0333333333356, 1214.9333333333368, 1212.8333333333364, 1213.5833333333364, 1214.4833333333358, 1213.9333333333363, 1213.9500000000037, 1213.2833333333365, 1214.1333333333369, 1214.5333333333365, 1214.1833333333357, 1214.075000000003, 1213.816666666669, 1213.7833333333365, 1214.2333333333363, 1213.9833333333354, 1214.3333333333358, 1213.383333333336, 1213.0333333333363, 1213.733333333336, 1214.0333333333365, 1213.7333333333368, 1215.1333333333364, 1213.983333333337, 1213.6833333333361, 1214.5833333333367, 1213.4750000000022, 1214.0333333333367, 1214.033333333336, 1213.283333333336, 1214.5833333333355, 1214.4333333333361, 1214.283333333336, 1213.733333333336, 1214.7333333333365, 1213.983333333336, 1213.2833333333365, 1214.3833333333357, 1213.633333333336, 1211.7500000000027, 1213.7333333333368, 1213.783333333336, 1214.2833333333363, 1214.183333333336, 1214.383333333336, 1213.6833333333363, 1213.4833333333363, 1213.3333333333364, 1214.5333333333363, 1213.683333333337, 1213.7333333333358, 1214.0000000000032, 1213.533333333336, 1214.983333333336, 1214.2833333333363, 1214.2333333333358, 1213.9833333333356, 1213.5333333333363, 1213.7333333333365, 1214.2833333333365, 1214.6333333333366, 1214.4333333333363, 1213.5833333333358, 1214.2333333333356, 1213.2833333333365, 1214.3833333333366, 1214.583333333337, 1212.7000000000032, 1213.3833333333362, 1214.033333333336, 1213.2833333333367, 1215.0833333333364, 1213.8833333333366, 1213.2333333333358, 1213.1333333333369, 1214.1833333333361, 1213.483333333336, 1214.2333333333358, 1215.083333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2404466035178726, "mean_inference_ms": 2.0500967605072136, "mean_action_processing_ms": 0.09053194373022772, "mean_env_wait_ms": 1.531135763536043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006477832794189453, "StateBufferConnector_ms": 0.0032279491424560547, "ViewRequirementAgentConnector_ms": 0.08180642127990723}, "num_episodes": 24, "episode_return_max": 1215.483333333336, "episode_return_min": 1211.7500000000027, "episode_return_mean": 1214.022000000003, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 250950, "num_agent_steps_trained": 250800, "num_env_steps_sampled": 250950, "num_env_steps_trained": 250800, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 249.35117254656225, "num_env_steps_trained_throughput_per_sec": 264.01888857871296, "timesteps_total": 250950, "num_env_steps_sampled_lifetime": 250950, "num_agent_steps_sampled_lifetime": 250950, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 250950, "timers": {"training_iteration_time_ms": 10287.078, "restore_workers_time_ms": 0.012, "training_step_time_ms": 602.924, "sample_time_ms": 587.061, "synch_weights_time_ms": 14.416}, "counters": {"num_env_steps_sampled": 250950, "num_env_steps_trained": 250800, "num_agent_steps_sampled": 250950, "num_agent_steps_trained": 250800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1673, "num_samples_added_to_queue": 250800}, "done": false, "training_iteration": 99, "trial_id": "27800_00000", "date": "2024-10-12_15-44-56", "timestamp": 1728744296, "time_this_iter_s": 10.238990068435669, "time_total_s": 1023.8021988868713, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f1690>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1023.8021988868713, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 15.5, "ram_util_percent": 53.51333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4328.24658203125, "policy_loss": 325.0003967285156, "entropy": 4.413301467895508, "entropy_coeff": 0.01, "var_gnorm": 18.105079650878906, "vf_loss": 401648.625, "vf_explained_var": 0.6317088603973389}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 844.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 253350, "num_env_steps_trained": 253200, "num_agent_steps_sampled": 253350, "num_agent_steps_trained": 253200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1689, "num_samples_added_to_queue": 253200, "learner_queue": {"size_count": 844, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.37, "learner_load_time_ms": 0.208, "learner_load_wait_time_ms": 1187.046, "learner_dequeue_time_ms": 9757.535}}, "env_runners": {"episode_reward_max": 1215.4333333333361, "episode_reward_min": 1211.7500000000027, "episode_reward_mean": 1213.9886666666694, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.7500000000027}, "policy_reward_max": {"default_policy": 1215.4333333333361}, "policy_reward_mean": {"default_policy": 1213.9886666666694}, "custom_metrics": {"num_consolidated_mean": 2.9998, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.17990000000000006, "num_moves_min": 0.0, "num_moves_max": 0.44, "mean_accuracy_mean": 43.63295333333333, "mean_accuracy_min": 43.62066666666667, "mean_accuracy_max": 43.63966666666667, "num_model_switches_mean": 0.0016, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.16283533333333333, "num_slav_min": 0.16193333333333335, "num_slav_max": 0.1635666666666667, "cpu_conserved_cost_mean": 7.999200000000001, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5390110783806767, "mean_cluster_cpu_util_min": 0.5364139662621806, "mean_cluster_cpu_util_max": 0.5412038288288288, "mean_cluster_mem_util_mean": 0.34165952267932487, "mean_cluster_mem_util_min": 0.3412405063291139, "mean_cluster_mem_util_max": 0.34210021097046406, "reward_consolidation_mean_mean": 6.249583333333333, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.33283333333336, "reward_accuracy_mean_min": 8.316666666666695, "reward_accuracy_mean_max": 8.341666666666695, "reward_sla_mean_mean": -2.44253, "reward_sla_mean_min": -2.4535, "reward_sla_mean_max": -2.4290000000000003, "reward_consolidation_sum_mean": 624.9583333333333, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.2833333333361, "reward_accuracy_sum_min": 831.6666666666695, "reward_accuracy_sum_max": 834.1666666666695, "reward_sla_sum_mean": -244.253, "reward_sla_sum_min": -245.35, "reward_sla_sum_max": -242.90000000000003, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4783.0, "global_timestep_min": 3100, "global_timestep_max": 6400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.5833333333364, 1214.4833333333358, 1213.9333333333363, 1213.9500000000037, 1213.2833333333365, 1214.1333333333369, 1214.5333333333365, 1214.1833333333357, 1214.075000000003, 1213.816666666669, 1213.7833333333365, 1214.2333333333363, 1213.9833333333354, 1214.3333333333358, 1213.383333333336, 1213.0333333333363, 1213.733333333336, 1214.0333333333365, 1213.7333333333368, 1215.1333333333364, 1213.983333333337, 1213.6833333333361, 1214.5833333333367, 1213.4750000000022, 1214.0333333333367, 1214.033333333336, 1213.283333333336, 1214.5833333333355, 1214.4333333333361, 1214.283333333336, 1213.733333333336, 1214.7333333333365, 1213.983333333336, 1213.2833333333365, 1214.3833333333357, 1213.633333333336, 1211.7500000000027, 1213.7333333333368, 1213.783333333336, 1214.2833333333363, 1214.183333333336, 1214.383333333336, 1213.6833333333363, 1213.4833333333363, 1213.3333333333364, 1214.5333333333363, 1213.683333333337, 1213.7333333333358, 1214.0000000000032, 1213.533333333336, 1214.983333333336, 1214.2833333333363, 1214.2333333333358, 1213.9833333333356, 1213.5333333333363, 1213.7333333333365, 1214.2833333333365, 1214.6333333333366, 1214.4333333333363, 1213.5833333333358, 1214.2333333333356, 1213.2833333333365, 1214.3833333333366, 1214.583333333337, 1212.7000000000032, 1213.3833333333362, 1214.033333333336, 1213.2833333333367, 1215.0833333333364, 1213.8833333333366, 1213.2333333333358, 1213.1333333333369, 1214.1833333333361, 1213.483333333336, 1214.2333333333358, 1215.083333333336, 1213.9833333333365, 1214.4333333333366, 1214.683333333337, 1215.4333333333361, 1213.4333333333363, 1214.483333333336, 1213.7833333333367, 1214.0833333333355, 1214.133333333336, 1214.1833333333366, 1214.4333333333363, 1213.1916666666698, 1214.4833333333363, 1214.7333333333363, 1214.7333333333358, 1214.6833333333357, 1213.0833333333358, 1214.733333333336, 1214.083333333336, 1213.0833333333364, 1213.9250000000031, 1213.8833333333355, 1213.783333333336, 1213.933333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.5833333333364, 1214.4833333333358, 1213.9333333333363, 1213.9500000000037, 1213.2833333333365, 1214.1333333333369, 1214.5333333333365, 1214.1833333333357, 1214.075000000003, 1213.816666666669, 1213.7833333333365, 1214.2333333333363, 1213.9833333333354, 1214.3333333333358, 1213.383333333336, 1213.0333333333363, 1213.733333333336, 1214.0333333333365, 1213.7333333333368, 1215.1333333333364, 1213.983333333337, 1213.6833333333361, 1214.5833333333367, 1213.4750000000022, 1214.0333333333367, 1214.033333333336, 1213.283333333336, 1214.5833333333355, 1214.4333333333361, 1214.283333333336, 1213.733333333336, 1214.7333333333365, 1213.983333333336, 1213.2833333333365, 1214.3833333333357, 1213.633333333336, 1211.7500000000027, 1213.7333333333368, 1213.783333333336, 1214.2833333333363, 1214.183333333336, 1214.383333333336, 1213.6833333333363, 1213.4833333333363, 1213.3333333333364, 1214.5333333333363, 1213.683333333337, 1213.7333333333358, 1214.0000000000032, 1213.533333333336, 1214.983333333336, 1214.2833333333363, 1214.2333333333358, 1213.9833333333356, 1213.5333333333363, 1213.7333333333365, 1214.2833333333365, 1214.6333333333366, 1214.4333333333363, 1213.5833333333358, 1214.2333333333356, 1213.2833333333365, 1214.3833333333366, 1214.583333333337, 1212.7000000000032, 1213.3833333333362, 1214.033333333336, 1213.2833333333367, 1215.0833333333364, 1213.8833333333366, 1213.2333333333358, 1213.1333333333369, 1214.1833333333361, 1213.483333333336, 1214.2333333333358, 1215.083333333336, 1213.9833333333365, 1214.4333333333366, 1214.683333333337, 1215.4333333333361, 1213.4333333333363, 1214.483333333336, 1213.7833333333367, 1214.0833333333355, 1214.133333333336, 1214.1833333333366, 1214.4333333333363, 1213.1916666666698, 1214.4833333333363, 1214.7333333333363, 1214.7333333333358, 1214.6833333333357, 1213.0833333333358, 1214.733333333336, 1214.083333333336, 1213.0833333333364, 1213.9250000000031, 1213.8833333333355, 1213.783333333336, 1213.933333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2404338421347539, "mean_inference_ms": 2.0504379472269103, "mean_action_processing_ms": 0.09053445022879089, "mean_env_wait_ms": 1.5311723158237327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061757564544677734, "StateBufferConnector_ms": 0.0032448768615722656, "ViewRequirementAgentConnector_ms": 0.08246755599975586}, "num_episodes": 24, "episode_return_max": 1215.4333333333361, "episode_return_min": 1211.7500000000027, "episode_return_mean": 1213.9886666666694, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 253350, "num_agent_steps_trained": 253200, "num_env_steps_sampled": 253350, "num_env_steps_trained": 253200, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 239.69403222833859, "num_env_steps_trained_throughput_per_sec": 239.69403222833859, "timesteps_total": 253350, "num_env_steps_sampled_lifetime": 253350, "num_agent_steps_sampled_lifetime": 253350, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 253350, "timers": {"training_iteration_time_ms": 10261.219, "restore_workers_time_ms": 0.014, "training_step_time_ms": 642.339, "sample_time_ms": 626.493, "synch_weights_time_ms": 14.436}, "counters": {"num_env_steps_sampled": 253350, "num_env_steps_trained": 253200, "num_agent_steps_sampled": 253350, "num_agent_steps_trained": 253200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1689, "num_samples_added_to_queue": 253200}, "done": false, "training_iteration": 100, "trial_id": "27800_00000", "date": "2024-10-12_15-45-06", "timestamp": 1728744306, "time_this_iter_s": 10.026661157608032, "time_total_s": 1033.8288600444794, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d253f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1033.8288600444794, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 16.771428571428576, "ram_util_percent": 53.74285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3076.2265625, "policy_loss": -895.346435546875, "entropy": 4.498375415802002, "entropy_coeff": 0.01, "var_gnorm": 18.12466812133789, "vf_loss": 398506.8125, "vf_explained_var": 0.6338026523590088}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 852.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 255750, "num_env_steps_trained": 255600, "num_agent_steps_sampled": 255750, "num_agent_steps_trained": 255600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1705, "num_samples_added_to_queue": 255600, "learner_queue": {"size_count": 852, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 64.044, "learner_load_time_ms": 0.242, "learner_load_wait_time_ms": 1208.44, "learner_dequeue_time_ms": 9774.431}}, "env_runners": {"episode_reward_max": 1215.4333333333361, "episode_reward_min": 1211.7500000000027, "episode_reward_mean": 1213.9846666666695, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.7500000000027}, "policy_reward_max": {"default_policy": 1215.4333333333361}, "policy_reward_mean": {"default_policy": 1213.9846666666695}, "custom_metrics": {"num_consolidated_mean": 2.9998, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.1263, "num_moves_min": 0.0, "num_moves_max": 0.44, "mean_accuracy_mean": 43.63295333333333, "mean_accuracy_min": 43.62066666666667, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0012000000000000001, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.16283799999999998, "num_slav_min": 0.16193333333333335, "num_slav_max": 0.1635, "cpu_conserved_cost_mean": 7.999200000000001, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5387392971479132, "mean_cluster_cpu_util_min": 0.5364139662621806, "mean_cluster_cpu_util_max": 0.5412038288288288, "mean_cluster_mem_util_mean": 0.3416704614978902, "mean_cluster_mem_util_min": 0.3412405063291139, "mean_cluster_mem_util_max": 0.34210021097046406, "reward_consolidation_mean_mean": 6.249583333333333, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.33283333333336, "reward_accuracy_mean_min": 8.316666666666695, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.44257, "reward_sla_mean_min": -2.4525, "reward_sla_mean_max": -2.4290000000000003, "reward_consolidation_sum_mean": 624.9583333333333, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.2833333333361, "reward_accuracy_sum_min": 831.6666666666695, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.257, "reward_sla_sum_min": -245.25, "reward_sla_sum_max": -242.90000000000003, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5583.0, "global_timestep_min": 3900, "global_timestep_max": 7200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.0333333333367, 1214.033333333336, 1213.283333333336, 1214.5833333333355, 1214.4333333333361, 1214.283333333336, 1213.733333333336, 1214.7333333333365, 1213.983333333336, 1213.2833333333365, 1214.3833333333357, 1213.633333333336, 1211.7500000000027, 1213.7333333333368, 1213.783333333336, 1214.2833333333363, 1214.183333333336, 1214.383333333336, 1213.6833333333363, 1213.4833333333363, 1213.3333333333364, 1214.5333333333363, 1213.683333333337, 1213.7333333333358, 1214.0000000000032, 1213.533333333336, 1214.983333333336, 1214.2833333333363, 1214.2333333333358, 1213.9833333333356, 1213.5333333333363, 1213.7333333333365, 1214.2833333333365, 1214.6333333333366, 1214.4333333333363, 1213.5833333333358, 1214.2333333333356, 1213.2833333333365, 1214.3833333333366, 1214.583333333337, 1212.7000000000032, 1213.3833333333362, 1214.033333333336, 1213.2833333333367, 1215.0833333333364, 1213.8833333333366, 1213.2333333333358, 1213.1333333333369, 1214.1833333333361, 1213.483333333336, 1214.2333333333358, 1215.083333333336, 1213.9833333333365, 1214.4333333333366, 1214.683333333337, 1215.4333333333361, 1213.4333333333363, 1214.483333333336, 1213.7833333333367, 1214.0833333333355, 1214.133333333336, 1214.1833333333366, 1214.4333333333363, 1213.1916666666698, 1214.4833333333363, 1214.7333333333363, 1214.7333333333358, 1214.6833333333357, 1213.0833333333358, 1214.733333333336, 1214.083333333336, 1213.0833333333364, 1213.9250000000031, 1213.8833333333355, 1213.783333333336, 1213.933333333336, 1214.7333333333358, 1214.4333333333366, 1214.0333333333365, 1214.8833333333362, 1213.950000000003, 1213.4833333333365, 1214.5833333333367, 1214.1833333333361, 1214.6833333333363, 1213.683333333337, 1213.1833333333361, 1213.533333333336, 1213.783333333337, 1214.0333333333367, 1214.3333333333362, 1213.5833333333358, 1214.083333333336, 1213.5833333333362, 1213.8333333333362, 1213.5333333333367, 1213.8333333333358, 1214.1333333333362, 1214.133333333336, 1212.4500000000028], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.0333333333367, 1214.033333333336, 1213.283333333336, 1214.5833333333355, 1214.4333333333361, 1214.283333333336, 1213.733333333336, 1214.7333333333365, 1213.983333333336, 1213.2833333333365, 1214.3833333333357, 1213.633333333336, 1211.7500000000027, 1213.7333333333368, 1213.783333333336, 1214.2833333333363, 1214.183333333336, 1214.383333333336, 1213.6833333333363, 1213.4833333333363, 1213.3333333333364, 1214.5333333333363, 1213.683333333337, 1213.7333333333358, 1214.0000000000032, 1213.533333333336, 1214.983333333336, 1214.2833333333363, 1214.2333333333358, 1213.9833333333356, 1213.5333333333363, 1213.7333333333365, 1214.2833333333365, 1214.6333333333366, 1214.4333333333363, 1213.5833333333358, 1214.2333333333356, 1213.2833333333365, 1214.3833333333366, 1214.583333333337, 1212.7000000000032, 1213.3833333333362, 1214.033333333336, 1213.2833333333367, 1215.0833333333364, 1213.8833333333366, 1213.2333333333358, 1213.1333333333369, 1214.1833333333361, 1213.483333333336, 1214.2333333333358, 1215.083333333336, 1213.9833333333365, 1214.4333333333366, 1214.683333333337, 1215.4333333333361, 1213.4333333333363, 1214.483333333336, 1213.7833333333367, 1214.0833333333355, 1214.133333333336, 1214.1833333333366, 1214.4333333333363, 1213.1916666666698, 1214.4833333333363, 1214.7333333333363, 1214.7333333333358, 1214.6833333333357, 1213.0833333333358, 1214.733333333336, 1214.083333333336, 1213.0833333333364, 1213.9250000000031, 1213.8833333333355, 1213.783333333336, 1213.933333333336, 1214.7333333333358, 1214.4333333333366, 1214.0333333333365, 1214.8833333333362, 1213.950000000003, 1213.4833333333365, 1214.5833333333367, 1214.1833333333361, 1214.6833333333363, 1213.683333333337, 1213.1833333333361, 1213.533333333336, 1213.783333333337, 1214.0333333333367, 1214.3333333333362, 1213.5833333333358, 1214.083333333336, 1213.5833333333362, 1213.8333333333362, 1213.5333333333367, 1213.8333333333358, 1214.1333333333362, 1214.133333333336, 1212.4500000000028]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2404252240320001, "mean_inference_ms": 2.050657097061282, "mean_action_processing_ms": 0.09054027403528232, "mean_env_wait_ms": 1.5312171649898232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006230354309082031, "StateBufferConnector_ms": 0.0032453536987304688, "ViewRequirementAgentConnector_ms": 0.08263778686523438}, "num_episodes": 24, "episode_return_max": 1215.4333333333361, "episode_return_min": 1211.7500000000027, "episode_return_mean": 1213.9846666666695, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 255750, "num_agent_steps_trained": 255600, "num_env_steps_sampled": 255750, "num_env_steps_trained": 255600, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 237.80277992883632, "num_env_steps_trained_throughput_per_sec": 237.80277992883632, "timesteps_total": 255750, "num_env_steps_sampled_lifetime": 255750, "num_agent_steps_sampled_lifetime": 255750, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 255750, "timers": {"training_iteration_time_ms": 10241.266, "restore_workers_time_ms": 0.013, "training_step_time_ms": 639.074, "sample_time_ms": 623.473, "synch_weights_time_ms": 14.061}, "counters": {"num_env_steps_sampled": 255750, "num_env_steps_trained": 255600, "num_agent_steps_sampled": 255750, "num_agent_steps_trained": 255600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1705, "num_samples_added_to_queue": 255600}, "done": false, "training_iteration": 101, "trial_id": "27800_00000", "date": "2024-10-12_15-45-16", "timestamp": 1728744316, "time_this_iter_s": 10.103046655654907, "time_total_s": 1043.9319067001343, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b44760>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1043.9319067001343, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 16.39333333333333, "ram_util_percent": 53.526666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4593.85205078125, "policy_loss": 55.53681182861328, "entropy": 4.42334508895874, "entropy_coeff": 0.01, "var_gnorm": 18.128032684326172, "vf_loss": 455158.5625, "vf_explained_var": 0.6034901142120361}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 860.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 258300, "num_env_steps_trained": 258000, "num_agent_steps_sampled": 258300, "num_agent_steps_trained": 258000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1722, "num_samples_added_to_queue": 258300, "learner_queue": {"size_count": 860, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.541, "learner_load_time_ms": 0.244, "learner_load_wait_time_ms": 1169.647, "learner_dequeue_time_ms": 9802.808}}, "env_runners": {"episode_reward_max": 1215.4333333333361, "episode_reward_min": 1212.4500000000028, "episode_reward_mean": 1214.0208333333362, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.4500000000028}, "policy_reward_max": {"default_policy": 1215.4333333333361}, "policy_reward_mean": {"default_policy": 1214.0208333333362}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.07020000000000001, "num_moves_min": 0.0, "num_moves_max": 0.27, "mean_accuracy_mean": 43.63301666666666, "mean_accuracy_min": 43.62066666666667, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0016, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.16283333333333336, "num_slav_min": 0.16193333333333335, "num_slav_max": 0.16373333333333331, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5384028695819544, "mean_cluster_cpu_util_min": 0.5364139662621806, "mean_cluster_cpu_util_max": 0.5407174112888398, "mean_cluster_mem_util_mean": 0.3416667352320675, "mean_cluster_mem_util_min": 0.3412225738396625, "mean_cluster_mem_util_max": 0.34210021097046406, "reward_consolidation_mean_mean": 6.249791666666666, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.332916666666693, "reward_accuracy_mean_min": 8.316666666666695, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4425, "reward_sla_mean_min": -2.456, "reward_sla_mean_max": -2.4290000000000003, "reward_consolidation_sum_mean": 624.9791666666666, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.2916666666695, "reward_accuracy_sum_min": 831.6666666666695, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.25, "reward_sla_sum_min": -245.6, "reward_sla_sum_max": -242.90000000000003, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5781.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.2833333333363, 1214.2333333333358, 1213.9833333333356, 1213.5333333333363, 1213.7333333333365, 1214.2833333333365, 1214.6333333333366, 1214.4333333333363, 1213.5833333333358, 1214.2333333333356, 1213.2833333333365, 1214.3833333333366, 1214.583333333337, 1212.7000000000032, 1213.3833333333362, 1214.033333333336, 1213.2833333333367, 1215.0833333333364, 1213.8833333333366, 1213.2333333333358, 1213.1333333333369, 1214.1833333333361, 1213.483333333336, 1214.2333333333358, 1215.083333333336, 1213.9833333333365, 1214.4333333333366, 1214.683333333337, 1215.4333333333361, 1213.4333333333363, 1214.483333333336, 1213.7833333333367, 1214.0833333333355, 1214.133333333336, 1214.1833333333366, 1214.4333333333363, 1213.1916666666698, 1214.4833333333363, 1214.7333333333363, 1214.7333333333358, 1214.6833333333357, 1213.0833333333358, 1214.733333333336, 1214.083333333336, 1213.0833333333364, 1213.9250000000031, 1213.8833333333355, 1213.783333333336, 1213.933333333336, 1214.7333333333358, 1214.4333333333366, 1214.0333333333365, 1214.8833333333362, 1213.950000000003, 1213.4833333333365, 1214.5833333333367, 1214.1833333333361, 1214.6833333333363, 1213.683333333337, 1213.1833333333361, 1213.533333333336, 1213.783333333337, 1214.0333333333367, 1214.3333333333362, 1213.5833333333358, 1214.083333333336, 1213.5833333333362, 1213.8333333333362, 1213.5333333333367, 1213.8333333333358, 1214.1333333333362, 1214.133333333336, 1212.4500000000028, 1214.2833333333372, 1214.1833333333368, 1214.5333333333365, 1214.0833333333364, 1214.0833333333362, 1214.6333333333364, 1213.9333333333366, 1213.6833333333366, 1214.4833333333365, 1214.6833333333368, 1214.283333333336, 1214.2333333333363, 1213.8333333333364, 1214.683333333337, 1212.9333333333361, 1212.7833333333363, 1212.7333333333356, 1214.9333333333361, 1214.6333333333364, 1214.6333333333364, 1213.5833333333362, 1213.7333333333356, 1213.7333333333363, 1214.1333333333362, 1213.5833333333362, 1214.1833333333363, 1213.8833333333362], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.2833333333363, 1214.2333333333358, 1213.9833333333356, 1213.5333333333363, 1213.7333333333365, 1214.2833333333365, 1214.6333333333366, 1214.4333333333363, 1213.5833333333358, 1214.2333333333356, 1213.2833333333365, 1214.3833333333366, 1214.583333333337, 1212.7000000000032, 1213.3833333333362, 1214.033333333336, 1213.2833333333367, 1215.0833333333364, 1213.8833333333366, 1213.2333333333358, 1213.1333333333369, 1214.1833333333361, 1213.483333333336, 1214.2333333333358, 1215.083333333336, 1213.9833333333365, 1214.4333333333366, 1214.683333333337, 1215.4333333333361, 1213.4333333333363, 1214.483333333336, 1213.7833333333367, 1214.0833333333355, 1214.133333333336, 1214.1833333333366, 1214.4333333333363, 1213.1916666666698, 1214.4833333333363, 1214.7333333333363, 1214.7333333333358, 1214.6833333333357, 1213.0833333333358, 1214.733333333336, 1214.083333333336, 1213.0833333333364, 1213.9250000000031, 1213.8833333333355, 1213.783333333336, 1213.933333333336, 1214.7333333333358, 1214.4333333333366, 1214.0333333333365, 1214.8833333333362, 1213.950000000003, 1213.4833333333365, 1214.5833333333367, 1214.1833333333361, 1214.6833333333363, 1213.683333333337, 1213.1833333333361, 1213.533333333336, 1213.783333333337, 1214.0333333333367, 1214.3333333333362, 1213.5833333333358, 1214.083333333336, 1213.5833333333362, 1213.8333333333362, 1213.5333333333367, 1213.8333333333358, 1214.1333333333362, 1214.133333333336, 1212.4500000000028, 1214.2833333333372, 1214.1833333333368, 1214.5333333333365, 1214.0833333333364, 1214.0833333333362, 1214.6333333333364, 1213.9333333333366, 1213.6833333333366, 1214.4833333333365, 1214.6833333333368, 1214.283333333336, 1214.2333333333363, 1213.8333333333364, 1214.683333333337, 1212.9333333333361, 1212.7833333333363, 1212.7333333333356, 1214.9333333333361, 1214.6333333333364, 1214.6333333333364, 1213.5833333333362, 1213.7333333333356, 1213.7333333333363, 1214.1333333333362, 1213.5833333333362, 1214.1833333333363, 1213.8833333333362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24043983188015197, "mean_inference_ms": 2.0508703410772195, "mean_action_processing_ms": 0.09054929778664594, "mean_env_wait_ms": 1.531269898193932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064465999603271484, "StateBufferConnector_ms": 0.0033152103424072266, "ViewRequirementAgentConnector_ms": 0.08447122573852539}, "num_episodes": 27, "episode_return_max": 1215.4333333333361, "episode_return_min": 1212.4500000000028, "episode_return_mean": 1214.0208333333362, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 258300, "num_agent_steps_trained": 258000, "num_env_steps_sampled": 258300, "num_env_steps_trained": 258000, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 246.71801079794886, "num_env_steps_trained_throughput_per_sec": 232.20518663336364, "timesteps_total": 258300, "num_env_steps_sampled_lifetime": 258300, "num_agent_steps_sampled_lifetime": 258300, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 258300, "timers": {"training_iteration_time_ms": 10233.907, "restore_workers_time_ms": 0.015, "training_step_time_ms": 597.992, "sample_time_ms": 581.714, "synch_weights_time_ms": 14.877}, "counters": {"num_env_steps_sampled": 258300, "num_env_steps_trained": 258000, "num_agent_steps_sampled": 258300, "num_agent_steps_trained": 258000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1722, "num_samples_added_to_queue": 258300}, "done": false, "training_iteration": 102, "trial_id": "27800_00000", "date": "2024-10-12_15-45-27", "timestamp": 1728744327, "time_this_iter_s": 10.34950852394104, "time_total_s": 1054.2814152240753, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b45060>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1054.2814152240753, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 16.664285714285715, "ram_util_percent": 53.71428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2868.671875, "policy_loss": -1605.328369140625, "entropy": 4.404057025909424, "entropy_coeff": 0.01, "var_gnorm": 18.0873966217041, "vf_loss": 448721.25, "vf_explained_var": 0.5963051319122314}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 869.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 260850, "num_env_steps_trained": 260700, "num_agent_steps_sampled": 260850, "num_agent_steps_trained": 260700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1739, "num_samples_added_to_queue": 260700, "learner_queue": {"size_count": 869, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.568, "learner_load_time_ms": 0.234, "learner_load_wait_time_ms": 1169.182, "learner_dequeue_time_ms": 9816.446}}, "env_runners": {"episode_reward_max": 1215.4333333333361, "episode_reward_min": 1212.4500000000028, "episode_reward_mean": 1214.0763333333362, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.4500000000028}, "policy_reward_max": {"default_policy": 1215.4333333333361}, "policy_reward_mean": {"default_policy": 1214.0763333333362}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0375, "num_moves_min": 0.0, "num_moves_max": 0.19, "mean_accuracy_mean": 43.632953333333326, "mean_accuracy_min": 43.62066666666667, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0018, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.16280466666666665, "num_slav_min": 0.1616, "num_slav_max": 0.16380000000000003, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5381564886697923, "mean_cluster_cpu_util_min": 0.5359472329472329, "mean_cluster_cpu_util_max": 0.5407174112888398, "mean_cluster_mem_util_mean": 0.34166648206751055, "mean_cluster_mem_util_min": 0.3412225738396625, "mean_cluster_mem_util_max": 0.34210021097046406, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.332833333333358, "reward_accuracy_mean_min": 8.316666666666695, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4420699999999993, "reward_sla_mean_min": -2.4570000000000003, "reward_sla_mean_max": -2.4239999999999995, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.2833333333361, "reward_accuracy_sum_min": 831.6666666666695, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.207, "reward_sla_sum_min": -245.70000000000002, "reward_sla_sum_max": -242.39999999999995, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4709.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1215.083333333336, 1213.9833333333365, 1214.4333333333366, 1214.683333333337, 1215.4333333333361, 1213.4333333333363, 1214.483333333336, 1213.7833333333367, 1214.0833333333355, 1214.133333333336, 1214.1833333333366, 1214.4333333333363, 1213.1916666666698, 1214.4833333333363, 1214.7333333333363, 1214.7333333333358, 1214.6833333333357, 1213.0833333333358, 1214.733333333336, 1214.083333333336, 1213.0833333333364, 1213.9250000000031, 1213.8833333333355, 1213.783333333336, 1213.933333333336, 1214.7333333333358, 1214.4333333333366, 1214.0333333333365, 1214.8833333333362, 1213.950000000003, 1213.4833333333365, 1214.5833333333367, 1214.1833333333361, 1214.6833333333363, 1213.683333333337, 1213.1833333333361, 1213.533333333336, 1213.783333333337, 1214.0333333333367, 1214.3333333333362, 1213.5833333333358, 1214.083333333336, 1213.5833333333362, 1213.8333333333362, 1213.5333333333367, 1213.8333333333358, 1214.1333333333362, 1214.133333333336, 1212.4500000000028, 1214.2833333333372, 1214.1833333333368, 1214.5333333333365, 1214.0833333333364, 1214.0833333333362, 1214.6333333333364, 1213.9333333333366, 1213.6833333333366, 1214.4833333333365, 1214.6833333333368, 1214.283333333336, 1214.2333333333363, 1213.8333333333364, 1214.683333333337, 1212.9333333333361, 1212.7833333333363, 1212.7333333333356, 1214.9333333333361, 1214.6333333333364, 1214.6333333333364, 1213.5833333333362, 1213.7333333333356, 1213.7333333333363, 1214.1333333333362, 1213.5833333333362, 1214.1833333333363, 1213.8833333333362, 1215.433333333336, 1212.6333333333362, 1214.1333333333362, 1214.0833333333364, 1214.9833333333358, 1212.883333333336, 1214.1833333333366, 1213.8333333333367, 1212.9333333333366, 1213.6833333333363, 1214.4833333333358, 1213.633333333336, 1213.7333333333363, 1213.4833333333365, 1213.9333333333363, 1215.100000000003, 1214.983333333337, 1215.1833333333363, 1214.983333333337, 1213.8333333333362, 1214.0833333333355, 1215.3833333333357, 1214.1833333333363, 1213.583333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1215.083333333336, 1213.9833333333365, 1214.4333333333366, 1214.683333333337, 1215.4333333333361, 1213.4333333333363, 1214.483333333336, 1213.7833333333367, 1214.0833333333355, 1214.133333333336, 1214.1833333333366, 1214.4333333333363, 1213.1916666666698, 1214.4833333333363, 1214.7333333333363, 1214.7333333333358, 1214.6833333333357, 1213.0833333333358, 1214.733333333336, 1214.083333333336, 1213.0833333333364, 1213.9250000000031, 1213.8833333333355, 1213.783333333336, 1213.933333333336, 1214.7333333333358, 1214.4333333333366, 1214.0333333333365, 1214.8833333333362, 1213.950000000003, 1213.4833333333365, 1214.5833333333367, 1214.1833333333361, 1214.6833333333363, 1213.683333333337, 1213.1833333333361, 1213.533333333336, 1213.783333333337, 1214.0333333333367, 1214.3333333333362, 1213.5833333333358, 1214.083333333336, 1213.5833333333362, 1213.8333333333362, 1213.5333333333367, 1213.8333333333358, 1214.1333333333362, 1214.133333333336, 1212.4500000000028, 1214.2833333333372, 1214.1833333333368, 1214.5333333333365, 1214.0833333333364, 1214.0833333333362, 1214.6333333333364, 1213.9333333333366, 1213.6833333333366, 1214.4833333333365, 1214.6833333333368, 1214.283333333336, 1214.2333333333363, 1213.8333333333364, 1214.683333333337, 1212.9333333333361, 1212.7833333333363, 1212.7333333333356, 1214.9333333333361, 1214.6333333333364, 1214.6333333333364, 1213.5833333333362, 1213.7333333333356, 1213.7333333333363, 1214.1333333333362, 1213.5833333333362, 1214.1833333333363, 1213.8833333333362, 1215.433333333336, 1212.6333333333362, 1214.1333333333362, 1214.0833333333364, 1214.9833333333358, 1212.883333333336, 1214.1833333333366, 1213.8333333333367, 1212.9333333333366, 1213.6833333333363, 1214.4833333333358, 1213.633333333336, 1213.7333333333363, 1213.4833333333365, 1213.9333333333363, 1215.100000000003, 1214.983333333337, 1215.1833333333363, 1214.983333333337, 1213.8333333333362, 1214.0833333333355, 1215.3833333333357, 1214.1833333333363, 1213.583333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24048661556422674, "mean_inference_ms": 2.051269331773275, "mean_action_processing_ms": 0.09056582665978741, "mean_env_wait_ms": 1.5314131132987467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064945220947265625, "StateBufferConnector_ms": 0.003354310989379883, "ViewRequirementAgentConnector_ms": 0.08597159385681152}, "num_episodes": 24, "episode_return_max": 1215.4333333333361, "episode_return_min": 1212.4500000000028, "episode_return_mean": 1214.0763333333362, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260850, "num_agent_steps_trained": 260700, "num_env_steps_sampled": 260850, "num_env_steps_trained": 260700, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 240.35653436782803, "num_env_steps_trained_throughput_per_sec": 254.49515403652381, "timesteps_total": 260850, "num_env_steps_sampled_lifetime": 260850, "num_agent_steps_sampled_lifetime": 260850, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 260850, "timers": {"training_iteration_time_ms": 10275.529, "restore_workers_time_ms": 0.016, "training_step_time_ms": 625.668, "sample_time_ms": 609.916, "synch_weights_time_ms": 14.231}, "counters": {"num_env_steps_sampled": 260850, "num_env_steps_trained": 260700, "num_agent_steps_sampled": 260850, "num_agent_steps_trained": 260700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1739, "num_samples_added_to_queue": 260700}, "done": false, "training_iteration": 103, "trial_id": "27800_00000", "date": "2024-10-12_15-45-37", "timestamp": 1728744337, "time_this_iter_s": 10.620573282241821, "time_total_s": 1064.9019885063171, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948962aa0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1064.9019885063171, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 16.34375, "ram_util_percent": 53.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4011.10693359375, "policy_loss": -310.83782958984375, "entropy": 4.43170690536499, "entropy_coeff": 0.01, "var_gnorm": 18.049036026000977, "vf_loss": 433523.96875, "vf_explained_var": 0.6017844676971436}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 877.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 263400, "num_env_steps_trained": 263100, "num_agent_steps_sampled": 263400, "num_agent_steps_trained": 263100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1756, "num_samples_added_to_queue": 263400, "learner_queue": {"size_count": 877, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.426, "learner_load_time_ms": 0.252, "learner_load_wait_time_ms": 1188.193, "learner_dequeue_time_ms": 9850.354}}, "env_runners": {"episode_reward_max": 1215.7333333333363, "episode_reward_min": 1212.4500000000028, "episode_reward_mean": 1213.999833333336, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.4500000000028}, "policy_reward_max": {"default_policy": 1215.7333333333363}, "policy_reward_mean": {"default_policy": 1213.999833333336}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0362, "num_moves_min": 0.0, "num_moves_max": 0.19, "mean_accuracy_mean": 43.63314333333333, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0012, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16287233333333337, "num_slav_min": 0.1616, "num_slav_max": 0.16380000000000003, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5380798758963045, "mean_cluster_cpu_util_min": 0.5359472329472329, "mean_cluster_cpu_util_max": 0.5407174112888398, "mean_cluster_mem_util_mean": 0.34164147679324885, "mean_cluster_mem_util_min": 0.3412225738396625, "mean_cluster_mem_util_max": 0.34207805907172995, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.33308333333336, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.443085, "reward_sla_mean_min": -2.4570000000000003, "reward_sla_mean_max": -2.4239999999999995, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3083333333362, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.3085, "reward_sla_sum_min": -245.70000000000002, "reward_sla_sum_max": -242.39999999999995, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3502.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.0333333333365, 1214.8833333333362, 1213.950000000003, 1213.4833333333365, 1214.5833333333367, 1214.1833333333361, 1214.6833333333363, 1213.683333333337, 1213.1833333333361, 1213.533333333336, 1213.783333333337, 1214.0333333333367, 1214.3333333333362, 1213.5833333333358, 1214.083333333336, 1213.5833333333362, 1213.8333333333362, 1213.5333333333367, 1213.8333333333358, 1214.1333333333362, 1214.133333333336, 1212.4500000000028, 1214.2833333333372, 1214.1833333333368, 1214.5333333333365, 1214.0833333333364, 1214.0833333333362, 1214.6333333333364, 1213.9333333333366, 1213.6833333333366, 1214.4833333333365, 1214.6833333333368, 1214.283333333336, 1214.2333333333363, 1213.8333333333364, 1214.683333333337, 1212.9333333333361, 1212.7833333333363, 1212.7333333333356, 1214.9333333333361, 1214.6333333333364, 1214.6333333333364, 1213.5833333333362, 1213.7333333333356, 1213.7333333333363, 1214.1333333333362, 1213.5833333333362, 1214.1833333333363, 1213.8833333333362, 1215.433333333336, 1212.6333333333362, 1214.1333333333362, 1214.0833333333364, 1214.9833333333358, 1212.883333333336, 1214.1833333333366, 1213.8333333333367, 1212.9333333333366, 1213.6833333333363, 1214.4833333333358, 1213.633333333336, 1213.7333333333363, 1213.4833333333365, 1213.9333333333363, 1215.100000000003, 1214.983333333337, 1215.1833333333363, 1214.983333333337, 1213.8333333333362, 1214.0833333333355, 1215.3833333333357, 1214.1833333333363, 1213.583333333336, 1213.7833333333358, 1214.183333333336, 1214.3333333333367, 1214.883333333336, 1212.9833333333368, 1213.8833333333364, 1214.833333333336, 1213.8833333333357, 1213.3833333333366, 1213.3333333333364, 1213.2333333333363, 1212.8333333333367, 1213.4333333333361, 1214.683333333336, 1214.2333333333363, 1213.5833333333367, 1213.1833333333354, 1214.1833333333363, 1214.2833333333367, 1215.7333333333363, 1213.5833333333364, 1214.533333333336, 1213.6833333333363, 1213.1333333333364, 1213.9333333333361, 1214.6333333333366, 1213.6333333333366], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.0333333333365, 1214.8833333333362, 1213.950000000003, 1213.4833333333365, 1214.5833333333367, 1214.1833333333361, 1214.6833333333363, 1213.683333333337, 1213.1833333333361, 1213.533333333336, 1213.783333333337, 1214.0333333333367, 1214.3333333333362, 1213.5833333333358, 1214.083333333336, 1213.5833333333362, 1213.8333333333362, 1213.5333333333367, 1213.8333333333358, 1214.1333333333362, 1214.133333333336, 1212.4500000000028, 1214.2833333333372, 1214.1833333333368, 1214.5333333333365, 1214.0833333333364, 1214.0833333333362, 1214.6333333333364, 1213.9333333333366, 1213.6833333333366, 1214.4833333333365, 1214.6833333333368, 1214.283333333336, 1214.2333333333363, 1213.8333333333364, 1214.683333333337, 1212.9333333333361, 1212.7833333333363, 1212.7333333333356, 1214.9333333333361, 1214.6333333333364, 1214.6333333333364, 1213.5833333333362, 1213.7333333333356, 1213.7333333333363, 1214.1333333333362, 1213.5833333333362, 1214.1833333333363, 1213.8833333333362, 1215.433333333336, 1212.6333333333362, 1214.1333333333362, 1214.0833333333364, 1214.9833333333358, 1212.883333333336, 1214.1833333333366, 1213.8333333333367, 1212.9333333333366, 1213.6833333333363, 1214.4833333333358, 1213.633333333336, 1213.7333333333363, 1213.4833333333365, 1213.9333333333363, 1215.100000000003, 1214.983333333337, 1215.1833333333363, 1214.983333333337, 1213.8333333333362, 1214.0833333333355, 1215.3833333333357, 1214.1833333333363, 1213.583333333336, 1213.7833333333358, 1214.183333333336, 1214.3333333333367, 1214.883333333336, 1212.9833333333368, 1213.8833333333364, 1214.833333333336, 1213.8833333333357, 1213.3833333333366, 1213.3333333333364, 1213.2333333333363, 1212.8333333333367, 1213.4333333333361, 1214.683333333336, 1214.2333333333363, 1213.5833333333367, 1213.1833333333354, 1214.1833333333363, 1214.2833333333367, 1215.7333333333363, 1213.5833333333364, 1214.533333333336, 1213.6833333333363, 1213.1333333333364, 1213.9333333333361, 1214.6333333333366, 1213.6333333333366]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24052106033023687, "mean_inference_ms": 2.0500703443181383, "mean_action_processing_ms": 0.09056547515022881, "mean_env_wait_ms": 1.5311920024606918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064961910247802734, "StateBufferConnector_ms": 0.0033690929412841797, "ViewRequirementAgentConnector_ms": 0.08608865737915039}, "num_episodes": 27, "episode_return_max": 1215.7333333333363, "episode_return_min": 1212.4500000000028, "episode_return_mean": 1213.999833333336, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 263400, "num_agent_steps_trained": 263100, "num_env_steps_sampled": 263400, "num_env_steps_trained": 263100, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 239.58745746503538, "num_env_steps_trained_throughput_per_sec": 225.49407761415097, "timesteps_total": 263400, "num_env_steps_sampled_lifetime": 263400, "num_agent_steps_sampled_lifetime": 263400, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 263400, "timers": {"training_iteration_time_ms": 10321.139, "restore_workers_time_ms": 0.013, "training_step_time_ms": 635.97, "sample_time_ms": 621.034, "synch_weights_time_ms": 13.428}, "counters": {"num_env_steps_sampled": 263400, "num_env_steps_trained": 263100, "num_agent_steps_sampled": 263400, "num_agent_steps_trained": 263100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1756, "num_samples_added_to_queue": 263400}, "done": false, "training_iteration": 104, "trial_id": "27800_00000", "date": "2024-10-12_15-45-48", "timestamp": 1728744348, "time_this_iter_s": 10.654072761535645, "time_total_s": 1075.5560612678528, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b46530>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1075.5560612678528, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 16.80666666666667, "ram_util_percent": 53.37333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1233.03076171875, "policy_loss": -2744.382080078125, "entropy": 4.407966136932373, "entropy_coeff": 0.01, "var_gnorm": 18.06492042541504, "vf_loss": 399063.6875, "vf_explained_var": 0.6331925988197327}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 886.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 265950, "num_env_steps_trained": 265800, "num_agent_steps_sampled": 265950, "num_agent_steps_trained": 265800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1773, "num_samples_added_to_queue": 265800, "learner_queue": {"size_count": 886, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.094, "learner_load_time_ms": 0.245, "learner_load_wait_time_ms": 1178.519, "learner_dequeue_time_ms": 9913.463}}, "env_runners": {"episode_reward_max": 1215.7333333333363, "episode_reward_min": 1211.5000000000032, "episode_reward_mean": 1213.9394166666696, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.5000000000032}, "policy_reward_max": {"default_policy": 1215.7333333333363}, "policy_reward_mean": {"default_policy": 1213.9394166666696}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0322, "num_moves_min": 0.0, "num_moves_max": 0.19, "mean_accuracy_mean": 43.63307999999999, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0014000000000000002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16289316666666667, "num_slav_min": 0.1616, "num_slav_max": 0.16380000000000003, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5380309564890146, "mean_cluster_cpu_util_min": 0.5359472329472329, "mean_cluster_cpu_util_max": 0.5407174112888398, "mean_cluster_mem_util_mean": 0.341637194092827, "mean_cluster_mem_util_min": 0.34101845991561186, "mean_cluster_mem_util_max": 0.34207805907172995, "reward_consolidation_mean_mean": 6.249791666666668, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333000000000025, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4433974999999997, "reward_sla_mean_min": -2.4570000000000003, "reward_sla_mean_max": -2.4239999999999995, "reward_consolidation_sum_mean": 624.9791666666667, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3000000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.33974999999998, "reward_sla_sum_min": -245.70000000000002, "reward_sla_sum_max": -242.39999999999995, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2430.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.5333333333365, 1214.0833333333364, 1214.0833333333362, 1214.6333333333364, 1213.9333333333366, 1213.6833333333366, 1214.4833333333365, 1214.6833333333368, 1214.283333333336, 1214.2333333333363, 1213.8333333333364, 1214.683333333337, 1212.9333333333361, 1212.7833333333363, 1212.7333333333356, 1214.9333333333361, 1214.6333333333364, 1214.6333333333364, 1213.5833333333362, 1213.7333333333356, 1213.7333333333363, 1214.1333333333362, 1213.5833333333362, 1214.1833333333363, 1213.8833333333362, 1215.433333333336, 1212.6333333333362, 1214.1333333333362, 1214.0833333333364, 1214.9833333333358, 1212.883333333336, 1214.1833333333366, 1213.8333333333367, 1212.9333333333366, 1213.6833333333363, 1214.4833333333358, 1213.633333333336, 1213.7333333333363, 1213.4833333333365, 1213.9333333333363, 1215.100000000003, 1214.983333333337, 1215.1833333333363, 1214.983333333337, 1213.8333333333362, 1214.0833333333355, 1215.3833333333357, 1214.1833333333363, 1213.583333333336, 1213.7833333333358, 1214.183333333336, 1214.3333333333367, 1214.883333333336, 1212.9833333333368, 1213.8833333333364, 1214.833333333336, 1213.8833333333357, 1213.3833333333366, 1213.3333333333364, 1213.2333333333363, 1212.8333333333367, 1213.4333333333361, 1214.683333333336, 1214.2333333333363, 1213.5833333333367, 1213.1833333333354, 1214.1833333333363, 1214.2833333333367, 1215.7333333333363, 1213.5833333333364, 1214.533333333336, 1213.6833333333363, 1213.1333333333364, 1213.9333333333361, 1214.6333333333366, 1213.6333333333366, 1213.3333333333362, 1212.6833333333354, 1212.8833333333364, 1213.7333333333363, 1214.1333333333362, 1213.6333333333364, 1211.5000000000032, 1213.1500000000028, 1213.1833333333361, 1214.5333333333363, 1213.9333333333363, 1213.583333333336, 1213.933333333336, 1214.233333333336, 1213.4500000000032, 1214.2833333333363, 1213.3833333333362, 1214.975000000003, 1212.8833333333362, 1212.8333333333364, 1214.1333333333362, 1214.1833333333363, 1213.9833333333356, 1215.3833333333364], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.5333333333365, 1214.0833333333364, 1214.0833333333362, 1214.6333333333364, 1213.9333333333366, 1213.6833333333366, 1214.4833333333365, 1214.6833333333368, 1214.283333333336, 1214.2333333333363, 1213.8333333333364, 1214.683333333337, 1212.9333333333361, 1212.7833333333363, 1212.7333333333356, 1214.9333333333361, 1214.6333333333364, 1214.6333333333364, 1213.5833333333362, 1213.7333333333356, 1213.7333333333363, 1214.1333333333362, 1213.5833333333362, 1214.1833333333363, 1213.8833333333362, 1215.433333333336, 1212.6333333333362, 1214.1333333333362, 1214.0833333333364, 1214.9833333333358, 1212.883333333336, 1214.1833333333366, 1213.8333333333367, 1212.9333333333366, 1213.6833333333363, 1214.4833333333358, 1213.633333333336, 1213.7333333333363, 1213.4833333333365, 1213.9333333333363, 1215.100000000003, 1214.983333333337, 1215.1833333333363, 1214.983333333337, 1213.8333333333362, 1214.0833333333355, 1215.3833333333357, 1214.1833333333363, 1213.583333333336, 1213.7833333333358, 1214.183333333336, 1214.3333333333367, 1214.883333333336, 1212.9833333333368, 1213.8833333333364, 1214.833333333336, 1213.8833333333357, 1213.3833333333366, 1213.3333333333364, 1213.2333333333363, 1212.8333333333367, 1213.4333333333361, 1214.683333333336, 1214.2333333333363, 1213.5833333333367, 1213.1833333333354, 1214.1833333333363, 1214.2833333333367, 1215.7333333333363, 1213.5833333333364, 1214.533333333336, 1213.6833333333363, 1213.1333333333364, 1213.9333333333361, 1214.6333333333366, 1213.6333333333366, 1213.3333333333362, 1212.6833333333354, 1212.8833333333364, 1213.7333333333363, 1214.1333333333362, 1213.6333333333364, 1211.5000000000032, 1213.1500000000028, 1213.1833333333361, 1214.5333333333363, 1213.9333333333363, 1213.583333333336, 1213.933333333336, 1214.233333333336, 1213.4500000000032, 1214.2833333333363, 1213.3833333333362, 1214.975000000003, 1212.8833333333362, 1212.8333333333364, 1214.1333333333362, 1214.1833333333363, 1213.9833333333356, 1215.3833333333364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24058901169449767, "mean_inference_ms": 2.0503583074204728, "mean_action_processing_ms": 0.09057968003763679, "mean_env_wait_ms": 1.53129095003661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006474733352661133, "StateBufferConnector_ms": 0.0033833980560302734, "ViewRequirementAgentConnector_ms": 0.08548688888549805}, "num_episodes": 24, "episode_return_max": 1215.7333333333363, "episode_return_min": 1211.5000000000032, "episode_return_mean": 1213.9394166666696, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 265950, "num_agent_steps_trained": 265800, "num_env_steps_sampled": 265950, "num_env_steps_trained": 265800, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 241.9336185813955, "num_env_steps_trained_throughput_per_sec": 256.16500790971287, "timesteps_total": 265950, "num_env_steps_sampled_lifetime": 265950, "num_agent_steps_sampled_lifetime": 265950, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 265950, "timers": {"training_iteration_time_ms": 10314.132, "restore_workers_time_ms": 0.013, "training_step_time_ms": 623.246, "sample_time_ms": 607.367, "synch_weights_time_ms": 14.367}, "counters": {"num_env_steps_sampled": 265950, "num_env_steps_trained": 265800, "num_agent_steps_sampled": 265950, "num_agent_steps_trained": 265800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1773, "num_samples_added_to_queue": 265800}, "done": false, "training_iteration": 105, "trial_id": "27800_00000", "date": "2024-10-12_15-45-59", "timestamp": 1728744359, "time_this_iter_s": 10.553995609283447, "time_total_s": 1086.1100568771362, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948953c40>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1086.1100568771362, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 16.79333333333333, "ram_util_percent": 53.62000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3594.762939453125, "policy_loss": -391.9698181152344, "entropy": 4.4025373458862305, "entropy_coeff": 0.01, "var_gnorm": 18.120378494262695, "vf_loss": 399994.0625, "vf_explained_var": 0.6334581971168518}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 894.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 268350, "num_env_steps_trained": 268200, "num_agent_steps_sampled": 268350, "num_agent_steps_trained": 268200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1789, "num_samples_added_to_queue": 268200, "learner_queue": {"size_count": 894, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.305, "learner_load_time_ms": 0.256, "learner_load_wait_time_ms": 1204.931, "learner_dequeue_time_ms": 9978.944}}, "env_runners": {"episode_reward_max": 1215.7333333333363, "episode_reward_min": 1211.5000000000032, "episode_reward_mean": 1213.941000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.5000000000032}, "policy_reward_max": {"default_policy": 1215.7333333333363}, "policy_reward_mean": {"default_policy": 1213.941000000003}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.022799999999999997, "num_moves_min": 0.0, "num_moves_max": 0.08, "mean_accuracy_mean": 43.632953333333326, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0012, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16288100000000003, "num_slav_min": 0.1616, "num_slav_max": 0.16380000000000003, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5379339634755929, "mean_cluster_cpu_util_min": 0.5359472329472329, "mean_cluster_cpu_util_max": 0.5399041298952013, "mean_cluster_mem_util_mean": 0.34163039556962027, "mean_cluster_mem_util_min": 0.34101845991561186, "mean_cluster_mem_util_max": 0.34200738396624464, "reward_consolidation_mean_mean": 6.249791666666666, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.33283333333336, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4432149999999995, "reward_sla_mean_min": -2.4570000000000003, "reward_sla_mean_max": -2.4239999999999995, "reward_consolidation_sum_mean": 624.9791666666667, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.2833333333361, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.3215, "reward_sla_sum_min": -245.70000000000002, "reward_sla_sum_max": -242.39999999999995, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1983.0, "global_timestep_min": 300, "global_timestep_max": 3600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.8833333333362, 1215.433333333336, 1212.6333333333362, 1214.1333333333362, 1214.0833333333364, 1214.9833333333358, 1212.883333333336, 1214.1833333333366, 1213.8333333333367, 1212.9333333333366, 1213.6833333333363, 1214.4833333333358, 1213.633333333336, 1213.7333333333363, 1213.4833333333365, 1213.9333333333363, 1215.100000000003, 1214.983333333337, 1215.1833333333363, 1214.983333333337, 1213.8333333333362, 1214.0833333333355, 1215.3833333333357, 1214.1833333333363, 1213.583333333336, 1213.7833333333358, 1214.183333333336, 1214.3333333333367, 1214.883333333336, 1212.9833333333368, 1213.8833333333364, 1214.833333333336, 1213.8833333333357, 1213.3833333333366, 1213.3333333333364, 1213.2333333333363, 1212.8333333333367, 1213.4333333333361, 1214.683333333336, 1214.2333333333363, 1213.5833333333367, 1213.1833333333354, 1214.1833333333363, 1214.2833333333367, 1215.7333333333363, 1213.5833333333364, 1214.533333333336, 1213.6833333333363, 1213.1333333333364, 1213.9333333333361, 1214.6333333333366, 1213.6333333333366, 1213.3333333333362, 1212.6833333333354, 1212.8833333333364, 1213.7333333333363, 1214.1333333333362, 1213.6333333333364, 1211.5000000000032, 1213.1500000000028, 1213.1833333333361, 1214.5333333333363, 1213.9333333333363, 1213.583333333336, 1213.933333333336, 1214.233333333336, 1213.4500000000032, 1214.2833333333363, 1213.3833333333362, 1214.975000000003, 1212.8833333333362, 1212.8333333333364, 1214.1333333333362, 1214.1833333333363, 1213.9833333333356, 1215.3833333333364, 1213.6333333333364, 1213.2833333333365, 1213.7333333333363, 1213.1333333333366, 1213.8833333333366, 1213.7333333333365, 1214.3333333333364, 1213.2833333333363, 1212.6333333333362, 1213.525000000003, 1214.383333333336, 1214.8333333333362, 1214.3833333333364, 1214.3000000000027, 1214.783333333336, 1214.6833333333363, 1215.183333333336, 1213.833333333336, 1214.333333333336, 1214.233333333336, 1213.083333333337, 1214.6333333333362, 1214.2833333333365, 1214.7833333333367], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.8833333333362, 1215.433333333336, 1212.6333333333362, 1214.1333333333362, 1214.0833333333364, 1214.9833333333358, 1212.883333333336, 1214.1833333333366, 1213.8333333333367, 1212.9333333333366, 1213.6833333333363, 1214.4833333333358, 1213.633333333336, 1213.7333333333363, 1213.4833333333365, 1213.9333333333363, 1215.100000000003, 1214.983333333337, 1215.1833333333363, 1214.983333333337, 1213.8333333333362, 1214.0833333333355, 1215.3833333333357, 1214.1833333333363, 1213.583333333336, 1213.7833333333358, 1214.183333333336, 1214.3333333333367, 1214.883333333336, 1212.9833333333368, 1213.8833333333364, 1214.833333333336, 1213.8833333333357, 1213.3833333333366, 1213.3333333333364, 1213.2333333333363, 1212.8333333333367, 1213.4333333333361, 1214.683333333336, 1214.2333333333363, 1213.5833333333367, 1213.1833333333354, 1214.1833333333363, 1214.2833333333367, 1215.7333333333363, 1213.5833333333364, 1214.533333333336, 1213.6833333333363, 1213.1333333333364, 1213.9333333333361, 1214.6333333333366, 1213.6333333333366, 1213.3333333333362, 1212.6833333333354, 1212.8833333333364, 1213.7333333333363, 1214.1333333333362, 1213.6333333333364, 1211.5000000000032, 1213.1500000000028, 1213.1833333333361, 1214.5333333333363, 1213.9333333333363, 1213.583333333336, 1213.933333333336, 1214.233333333336, 1213.4500000000032, 1214.2833333333363, 1213.3833333333362, 1214.975000000003, 1212.8833333333362, 1212.8333333333364, 1214.1333333333362, 1214.1833333333363, 1213.9833333333356, 1215.3833333333364, 1213.6333333333364, 1213.2833333333365, 1213.7333333333363, 1213.1333333333366, 1213.8833333333366, 1213.7333333333365, 1214.3333333333364, 1213.2833333333363, 1212.6333333333362, 1213.525000000003, 1214.383333333336, 1214.8333333333362, 1214.3833333333364, 1214.3000000000027, 1214.783333333336, 1214.6833333333363, 1215.183333333336, 1213.833333333336, 1214.333333333336, 1214.233333333336, 1213.083333333337, 1214.6333333333362, 1214.2833333333365, 1214.7833333333367]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24070987474644231, "mean_inference_ms": 2.0525075113435505, "mean_action_processing_ms": 0.09061755163777675, "mean_env_wait_ms": 1.5318713207793484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006432056427001953, "StateBufferConnector_ms": 0.003374814987182617, "ViewRequirementAgentConnector_ms": 0.08567595481872559}, "num_episodes": 24, "episode_return_max": 1215.7333333333363, "episode_return_min": 1211.5000000000032, "episode_return_mean": 1213.941000000003, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268350, "num_agent_steps_trained": 268200, "num_env_steps_sampled": 268350, "num_env_steps_trained": 268200, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 237.64439180313755, "num_env_steps_trained_throughput_per_sec": 237.64439180313755, "timesteps_total": 268350, "num_env_steps_sampled_lifetime": 268350, "num_agent_steps_sampled_lifetime": 268350, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 268350, "timers": {"training_iteration_time_ms": 10307.243, "restore_workers_time_ms": 0.012, "training_step_time_ms": 630.81, "sample_time_ms": 615.075, "synch_weights_time_ms": 14.328}, "counters": {"num_env_steps_sampled": 268350, "num_env_steps_trained": 268200, "num_agent_steps_sampled": 268350, "num_agent_steps_trained": 268200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1789, "num_samples_added_to_queue": 268200}, "done": false, "training_iteration": 106, "trial_id": "27800_00000", "date": "2024-10-12_15-46-09", "timestamp": 1728744369, "time_this_iter_s": 10.112942934036255, "time_total_s": 1096.2229998111725, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b47d30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1096.2229998111725, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 16.378571428571426, "ram_util_percent": 53.69285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4005.014404296875, "policy_loss": -52.004817962646484, "entropy": 4.396949768066406, "entropy_coeff": 0.01, "var_gnorm": 18.137073516845703, "vf_loss": 407021.0, "vf_explained_var": 0.6312862634658813}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 902.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 270750, "num_env_steps_trained": 270600, "num_agent_steps_sampled": 270750, "num_agent_steps_trained": 270600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1805, "num_samples_added_to_queue": 270600, "learner_queue": {"size_count": 902, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.493, "learner_load_time_ms": 0.271, "learner_load_wait_time_ms": 1206.273, "learner_dequeue_time_ms": 9982.077}}, "env_runners": {"episode_reward_max": 1215.7333333333363, "episode_reward_min": 1211.5000000000032, "episode_reward_mean": 1213.9383333333365, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.5000000000032}, "policy_reward_max": {"default_policy": 1215.7333333333363}, "policy_reward_mean": {"default_policy": 1213.9383333333365}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0231, "num_moves_min": 0.0, "num_moves_max": 0.08, "mean_accuracy_mean": 43.63301666666666, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.001, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16288833333333336, "num_slav_min": 0.16168333333333332, "num_slav_max": 0.16380000000000003, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5379152704713642, "mean_cluster_cpu_util_min": 0.5360362888398602, "mean_cluster_cpu_util_max": 0.5395021833057547, "mean_cluster_mem_util_mean": 0.3416219356540085, "mean_cluster_mem_util_min": 0.34101845991561186, "mean_cluster_mem_util_max": 0.34198945147679327, "reward_consolidation_mean_mean": 6.249791666666666, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.332916666666693, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4433249999999997, "reward_sla_mean_min": -2.4570000000000003, "reward_sla_mean_max": -2.42525, "reward_consolidation_sum_mean": 624.9791666666666, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.2916666666695, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.33249999999995, "reward_sla_sum_min": -245.70000000000002, "reward_sla_sum_max": -242.525, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2783.0, "global_timestep_min": 1100, "global_timestep_max": 4400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.583333333336, 1213.7833333333358, 1214.183333333336, 1214.3333333333367, 1214.883333333336, 1212.9833333333368, 1213.8833333333364, 1214.833333333336, 1213.8833333333357, 1213.3833333333366, 1213.3333333333364, 1213.2333333333363, 1212.8333333333367, 1213.4333333333361, 1214.683333333336, 1214.2333333333363, 1213.5833333333367, 1213.1833333333354, 1214.1833333333363, 1214.2833333333367, 1215.7333333333363, 1213.5833333333364, 1214.533333333336, 1213.6833333333363, 1213.1333333333364, 1213.9333333333361, 1214.6333333333366, 1213.6333333333366, 1213.3333333333362, 1212.6833333333354, 1212.8833333333364, 1213.7333333333363, 1214.1333333333362, 1213.6333333333364, 1211.5000000000032, 1213.1500000000028, 1213.1833333333361, 1214.5333333333363, 1213.9333333333363, 1213.583333333336, 1213.933333333336, 1214.233333333336, 1213.4500000000032, 1214.2833333333363, 1213.3833333333362, 1214.975000000003, 1212.8833333333362, 1212.8333333333364, 1214.1333333333362, 1214.1833333333363, 1213.9833333333356, 1215.3833333333364, 1213.6333333333364, 1213.2833333333365, 1213.7333333333363, 1213.1333333333366, 1213.8833333333366, 1213.7333333333365, 1214.3333333333364, 1213.2833333333363, 1212.6333333333362, 1213.525000000003, 1214.383333333336, 1214.8333333333362, 1214.3833333333364, 1214.3000000000027, 1214.783333333336, 1214.6833333333363, 1215.183333333336, 1213.833333333336, 1214.333333333336, 1214.233333333336, 1213.083333333337, 1214.6333333333362, 1214.2833333333365, 1214.7833333333367, 1213.7333333333365, 1213.033333333336, 1213.0333333333365, 1213.3833333333362, 1213.8333333333362, 1212.7333333333358, 1214.183333333336, 1214.1333333333364, 1214.733333333336, 1213.1833333333357, 1215.3333333333364, 1213.4333333333354, 1215.1333333333364, 1214.4833333333365, 1214.333333333336, 1213.583333333337, 1214.8833333333366, 1214.4333333333361, 1214.783333333336, 1215.6333333333369, 1214.0333333333365, 1213.983333333336, 1215.0833333333364, 1214.283333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.583333333336, 1213.7833333333358, 1214.183333333336, 1214.3333333333367, 1214.883333333336, 1212.9833333333368, 1213.8833333333364, 1214.833333333336, 1213.8833333333357, 1213.3833333333366, 1213.3333333333364, 1213.2333333333363, 1212.8333333333367, 1213.4333333333361, 1214.683333333336, 1214.2333333333363, 1213.5833333333367, 1213.1833333333354, 1214.1833333333363, 1214.2833333333367, 1215.7333333333363, 1213.5833333333364, 1214.533333333336, 1213.6833333333363, 1213.1333333333364, 1213.9333333333361, 1214.6333333333366, 1213.6333333333366, 1213.3333333333362, 1212.6833333333354, 1212.8833333333364, 1213.7333333333363, 1214.1333333333362, 1213.6333333333364, 1211.5000000000032, 1213.1500000000028, 1213.1833333333361, 1214.5333333333363, 1213.9333333333363, 1213.583333333336, 1213.933333333336, 1214.233333333336, 1213.4500000000032, 1214.2833333333363, 1213.3833333333362, 1214.975000000003, 1212.8833333333362, 1212.8333333333364, 1214.1333333333362, 1214.1833333333363, 1213.9833333333356, 1215.3833333333364, 1213.6333333333364, 1213.2833333333365, 1213.7333333333363, 1213.1333333333366, 1213.8833333333366, 1213.7333333333365, 1214.3333333333364, 1213.2833333333363, 1212.6333333333362, 1213.525000000003, 1214.383333333336, 1214.8333333333362, 1214.3833333333364, 1214.3000000000027, 1214.783333333336, 1214.6833333333363, 1215.183333333336, 1213.833333333336, 1214.333333333336, 1214.233333333336, 1213.083333333337, 1214.6333333333362, 1214.2833333333365, 1214.7833333333367, 1213.7333333333365, 1213.033333333336, 1213.0333333333365, 1213.3833333333362, 1213.8333333333362, 1212.7333333333358, 1214.183333333336, 1214.1333333333364, 1214.733333333336, 1213.1833333333357, 1215.3333333333364, 1213.4333333333354, 1215.1333333333364, 1214.4833333333365, 1214.333333333336, 1213.583333333337, 1214.8833333333366, 1214.4333333333361, 1214.783333333336, 1215.6333333333369, 1214.0333333333365, 1213.983333333336, 1215.0833333333364, 1214.283333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24080098319090587, "mean_inference_ms": 2.053089516762228, "mean_action_processing_ms": 0.0906373297154952, "mean_env_wait_ms": 1.5320946174882255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006516218185424805, "StateBufferConnector_ms": 0.003351449966430664, "ViewRequirementAgentConnector_ms": 0.0850517749786377}, "num_episodes": 24, "episode_return_max": 1215.7333333333363, "episode_return_min": 1211.5000000000032, "episode_return_mean": 1213.9383333333365, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270750, "num_agent_steps_trained": 270600, "num_env_steps_sampled": 270750, "num_env_steps_trained": 270600, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 237.17113344369386, "num_env_steps_trained_throughput_per_sec": 237.17113344369386, "timesteps_total": 270750, "num_env_steps_sampled_lifetime": 270750, "num_agent_steps_sampled_lifetime": 270750, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 270750, "timers": {"training_iteration_time_ms": 10300.721, "restore_workers_time_ms": 0.014, "training_step_time_ms": 631.849, "sample_time_ms": 615.914, "synch_weights_time_ms": 14.267}, "counters": {"num_env_steps_sampled": 270750, "num_env_steps_trained": 270600, "num_agent_steps_sampled": 270750, "num_agent_steps_trained": 270600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1805, "num_samples_added_to_queue": 270600}, "done": false, "training_iteration": 107, "trial_id": "27800_00000", "date": "2024-10-12_15-46-19", "timestamp": 1728744379, "time_this_iter_s": 10.131508588790894, "time_total_s": 1106.3545083999634, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f2560>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1106.3545083999634, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 16.566666666666666, "ram_util_percent": 53.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4091.9697265625, "policy_loss": 105.03524780273438, "entropy": 4.47437047958374, "entropy_coeff": 0.01, "var_gnorm": 18.108688354492188, "vf_loss": 400035.78125, "vf_explained_var": 0.63274085521698}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 910.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 273300, "num_env_steps_trained": 273000, "num_agent_steps_sampled": 273300, "num_agent_steps_trained": 273000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1822, "num_samples_added_to_queue": 273300, "learner_queue": {"size_count": 910, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.053, "learner_load_time_ms": 0.302, "learner_load_wait_time_ms": 1191.376, "learner_dequeue_time_ms": 9990.228}}, "env_runners": {"episode_reward_max": 1215.6333333333369, "episode_reward_min": 1211.5000000000032, "episode_reward_mean": 1213.9873333333362, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.5000000000032}, "policy_reward_max": {"default_policy": 1215.6333333333369}, "policy_reward_mean": {"default_policy": 1213.9873333333362}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.028800000000000003, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 43.63301666666666, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.001, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16285566666666668, "num_slav_min": 0.16168333333333332, "num_slav_max": 0.16380000000000003, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5379359052387848, "mean_cluster_cpu_util_min": 0.5360362888398602, "mean_cluster_cpu_util_max": 0.5398949715021144, "mean_cluster_mem_util_mean": 0.3416366402953587, "mean_cluster_mem_util_min": 0.34101845991561186, "mean_cluster_mem_util_max": 0.34209282700421945, "reward_consolidation_mean_mean": 6.249791666666666, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.332916666666693, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.442835, "reward_sla_mean_min": -2.4570000000000003, "reward_sla_mean_max": -2.42525, "reward_consolidation_sum_mean": 624.9791666666666, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.2916666666695, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.28349999999998, "reward_sla_sum_min": -245.70000000000002, "reward_sla_sum_max": -242.525, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3683.0, "global_timestep_min": 2000, "global_timestep_max": 5300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.6333333333366, 1213.3333333333362, 1212.6833333333354, 1212.8833333333364, 1213.7333333333363, 1214.1333333333362, 1213.6333333333364, 1211.5000000000032, 1213.1500000000028, 1213.1833333333361, 1214.5333333333363, 1213.9333333333363, 1213.583333333336, 1213.933333333336, 1214.233333333336, 1213.4500000000032, 1214.2833333333363, 1213.3833333333362, 1214.975000000003, 1212.8833333333362, 1212.8333333333364, 1214.1333333333362, 1214.1833333333363, 1213.9833333333356, 1215.3833333333364, 1213.6333333333364, 1213.2833333333365, 1213.7333333333363, 1213.1333333333366, 1213.8833333333366, 1213.7333333333365, 1214.3333333333364, 1213.2833333333363, 1212.6333333333362, 1213.525000000003, 1214.383333333336, 1214.8333333333362, 1214.3833333333364, 1214.3000000000027, 1214.783333333336, 1214.6833333333363, 1215.183333333336, 1213.833333333336, 1214.333333333336, 1214.233333333336, 1213.083333333337, 1214.6333333333362, 1214.2833333333365, 1214.7833333333367, 1213.7333333333365, 1213.033333333336, 1213.0333333333365, 1213.3833333333362, 1213.8333333333362, 1212.7333333333358, 1214.183333333336, 1214.1333333333364, 1214.733333333336, 1213.1833333333357, 1215.3333333333364, 1213.4333333333354, 1215.1333333333364, 1214.4833333333365, 1214.333333333336, 1213.583333333337, 1214.8833333333366, 1214.4333333333361, 1214.783333333336, 1215.6333333333369, 1214.0333333333365, 1213.983333333336, 1215.0833333333364, 1214.283333333336, 1215.2333333333363, 1215.1333333333369, 1214.583333333337, 1214.4833333333363, 1214.1833333333366, 1214.5833333333355, 1214.5333333333367, 1213.183333333336, 1214.1333333333364, 1214.533333333336, 1214.933333333337, 1213.9333333333363, 1213.733333333336, 1214.0833333333367, 1212.883333333336, 1214.8333333333367, 1213.1833333333368, 1213.683333333336, 1213.4333333333366, 1214.9333333333363, 1213.7833333333358, 1213.333333333336, 1213.9333333333366, 1214.483333333336, 1213.0833333333367, 1214.3833333333362, 1213.633333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.6333333333366, 1213.3333333333362, 1212.6833333333354, 1212.8833333333364, 1213.7333333333363, 1214.1333333333362, 1213.6333333333364, 1211.5000000000032, 1213.1500000000028, 1213.1833333333361, 1214.5333333333363, 1213.9333333333363, 1213.583333333336, 1213.933333333336, 1214.233333333336, 1213.4500000000032, 1214.2833333333363, 1213.3833333333362, 1214.975000000003, 1212.8833333333362, 1212.8333333333364, 1214.1333333333362, 1214.1833333333363, 1213.9833333333356, 1215.3833333333364, 1213.6333333333364, 1213.2833333333365, 1213.7333333333363, 1213.1333333333366, 1213.8833333333366, 1213.7333333333365, 1214.3333333333364, 1213.2833333333363, 1212.6333333333362, 1213.525000000003, 1214.383333333336, 1214.8333333333362, 1214.3833333333364, 1214.3000000000027, 1214.783333333336, 1214.6833333333363, 1215.183333333336, 1213.833333333336, 1214.333333333336, 1214.233333333336, 1213.083333333337, 1214.6333333333362, 1214.2833333333365, 1214.7833333333367, 1213.7333333333365, 1213.033333333336, 1213.0333333333365, 1213.3833333333362, 1213.8333333333362, 1212.7333333333358, 1214.183333333336, 1214.1333333333364, 1214.733333333336, 1213.1833333333357, 1215.3333333333364, 1213.4333333333354, 1215.1333333333364, 1214.4833333333365, 1214.333333333336, 1213.583333333337, 1214.8833333333366, 1214.4333333333361, 1214.783333333336, 1215.6333333333369, 1214.0333333333365, 1213.983333333336, 1215.0833333333364, 1214.283333333336, 1215.2333333333363, 1215.1333333333369, 1214.583333333337, 1214.4833333333363, 1214.1833333333366, 1214.5833333333355, 1214.5333333333367, 1213.183333333336, 1214.1333333333364, 1214.533333333336, 1214.933333333337, 1213.9333333333363, 1213.733333333336, 1214.0833333333367, 1212.883333333336, 1214.8333333333367, 1213.1833333333368, 1213.683333333336, 1213.4333333333366, 1214.9333333333363, 1213.7833333333358, 1213.333333333336, 1213.9333333333366, 1214.483333333336, 1213.0833333333367, 1214.3833333333362, 1213.633333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24089256096978545, "mean_inference_ms": 2.053623867303105, "mean_action_processing_ms": 0.09065681580621501, "mean_env_wait_ms": 1.532296648582235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006907939910888672, "StateBufferConnector_ms": 0.003344297409057617, "ViewRequirementAgentConnector_ms": 0.08455634117126465}, "num_episodes": 27, "episode_return_max": 1215.6333333333369, "episode_return_min": 1211.5000000000032, "episode_return_mean": 1213.9873333333362, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 273300, "num_agent_steps_trained": 273000, "num_env_steps_sampled": 273300, "num_env_steps_trained": 273000, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 242.29061221886022, "num_env_steps_trained_throughput_per_sec": 228.03822326480963, "timesteps_total": 273300, "num_env_steps_sampled_lifetime": 273300, "num_agent_steps_sampled_lifetime": 273300, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 273300, "timers": {"training_iteration_time_ms": 10320.305, "restore_workers_time_ms": 0.012, "training_step_time_ms": 620.89, "sample_time_ms": 604.612, "synch_weights_time_ms": 14.649}, "counters": {"num_env_steps_sampled": 273300, "num_env_steps_trained": 273000, "num_agent_steps_sampled": 273300, "num_agent_steps_trained": 273000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1822, "num_samples_added_to_queue": 273300}, "done": false, "training_iteration": 108, "trial_id": "27800_00000", "date": "2024-10-12_15-46-29", "timestamp": 1728744389, "time_this_iter_s": 10.534621477127075, "time_total_s": 1116.8891298770905, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b44760>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1116.8891298770905, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 16.246666666666666, "ram_util_percent": 53.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3333.27978515625, "policy_loss": -64.35552978515625, "entropy": 4.794434547424316, "entropy_coeff": 0.01, "var_gnorm": 18.09384536743164, "vf_loss": 341201.875, "vf_explained_var": 0.6524626016616821}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 918.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 275700, "num_env_steps_trained": 275400, "num_agent_steps_sampled": 275700, "num_agent_steps_trained": 275400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1838, "num_samples_added_to_queue": 275700, "learner_queue": {"size_count": 918, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.45, "learner_load_time_ms": 0.328, "learner_load_wait_time_ms": 1231.209, "learner_dequeue_time_ms": 10028.184}}, "env_runners": {"episode_reward_max": 1215.6333333333369, "episode_reward_min": 1210.9500000000023, "episode_reward_mean": 1214.0384166666695, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1210.9500000000023}, "policy_reward_max": {"default_policy": 1215.6333333333369}, "policy_reward_mean": {"default_policy": 1214.0384166666695}, "custom_metrics": {"num_consolidated_mean": 2.9997000000000003, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0617, "num_moves_min": 0.0, "num_moves_max": 0.36, "mean_accuracy_mean": 43.633206666666666, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0004, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.1628105, "num_slav_min": 0.1618, "num_slav_max": 0.16380000000000003, "cpu_conserved_cost_mean": 7.9988, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5381035492795091, "mean_cluster_cpu_util_min": 0.5360362888398602, "mean_cluster_cpu_util_max": 0.5414311224489796, "mean_cluster_mem_util_mean": 0.34162523206751055, "mean_cluster_mem_util_min": 0.34087974683544303, "mean_cluster_mem_util_max": 0.34209282700421945, "reward_consolidation_mean_mean": 6.249375, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333166666666692, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4421575, "reward_sla_mean_min": -2.4570000000000003, "reward_sla_mean_max": -2.427, "reward_consolidation_sum_mean": 624.9375, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3166666666694, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.21574999999996, "reward_sla_sum_min": -245.70000000000002, "reward_sla_sum_max": -242.7, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4483.0, "global_timestep_min": 2800, "global_timestep_max": 6100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1215.3833333333364, 1213.6333333333364, 1213.2833333333365, 1213.7333333333363, 1213.1333333333366, 1213.8833333333366, 1213.7333333333365, 1214.3333333333364, 1213.2833333333363, 1212.6333333333362, 1213.525000000003, 1214.383333333336, 1214.8333333333362, 1214.3833333333364, 1214.3000000000027, 1214.783333333336, 1214.6833333333363, 1215.183333333336, 1213.833333333336, 1214.333333333336, 1214.233333333336, 1213.083333333337, 1214.6333333333362, 1214.2833333333365, 1214.7833333333367, 1213.7333333333365, 1213.033333333336, 1213.0333333333365, 1213.3833333333362, 1213.8333333333362, 1212.7333333333358, 1214.183333333336, 1214.1333333333364, 1214.733333333336, 1213.1833333333357, 1215.3333333333364, 1213.4333333333354, 1215.1333333333364, 1214.4833333333365, 1214.333333333336, 1213.583333333337, 1214.8833333333366, 1214.4333333333361, 1214.783333333336, 1215.6333333333369, 1214.0333333333365, 1213.983333333336, 1215.0833333333364, 1214.283333333336, 1215.2333333333363, 1215.1333333333369, 1214.583333333337, 1214.4833333333363, 1214.1833333333366, 1214.5833333333355, 1214.5333333333367, 1213.183333333336, 1214.1333333333364, 1214.533333333336, 1214.933333333337, 1213.9333333333363, 1213.733333333336, 1214.0833333333367, 1212.883333333336, 1214.8333333333367, 1213.1833333333368, 1213.683333333336, 1213.4333333333366, 1214.9333333333363, 1213.7833333333358, 1213.333333333336, 1213.9333333333366, 1214.483333333336, 1213.0833333333367, 1214.3833333333362, 1213.633333333336, 1214.283333333336, 1214.333333333336, 1214.7333333333368, 1214.183333333336, 1213.383333333336, 1212.400000000003, 1213.9833333333368, 1213.6333333333366, 1214.6333333333366, 1214.1333333333353, 1213.9333333333357, 1213.733333333336, 1213.233333333336, 1213.4833333333358, 1211.800000000003, 1213.8833333333362, 1214.6333333333362, 1213.8333333333362, 1214.7833333333356, 1214.2833333333367, 1214.583333333336, 1214.6333333333364, 1210.9500000000023, 1213.833333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1215.3833333333364, 1213.6333333333364, 1213.2833333333365, 1213.7333333333363, 1213.1333333333366, 1213.8833333333366, 1213.7333333333365, 1214.3333333333364, 1213.2833333333363, 1212.6333333333362, 1213.525000000003, 1214.383333333336, 1214.8333333333362, 1214.3833333333364, 1214.3000000000027, 1214.783333333336, 1214.6833333333363, 1215.183333333336, 1213.833333333336, 1214.333333333336, 1214.233333333336, 1213.083333333337, 1214.6333333333362, 1214.2833333333365, 1214.7833333333367, 1213.7333333333365, 1213.033333333336, 1213.0333333333365, 1213.3833333333362, 1213.8333333333362, 1212.7333333333358, 1214.183333333336, 1214.1333333333364, 1214.733333333336, 1213.1833333333357, 1215.3333333333364, 1213.4333333333354, 1215.1333333333364, 1214.4833333333365, 1214.333333333336, 1213.583333333337, 1214.8833333333366, 1214.4333333333361, 1214.783333333336, 1215.6333333333369, 1214.0333333333365, 1213.983333333336, 1215.0833333333364, 1214.283333333336, 1215.2333333333363, 1215.1333333333369, 1214.583333333337, 1214.4833333333363, 1214.1833333333366, 1214.5833333333355, 1214.5333333333367, 1213.183333333336, 1214.1333333333364, 1214.533333333336, 1214.933333333337, 1213.9333333333363, 1213.733333333336, 1214.0833333333367, 1212.883333333336, 1214.8333333333367, 1213.1833333333368, 1213.683333333336, 1213.4333333333366, 1214.9333333333363, 1213.7833333333358, 1213.333333333336, 1213.9333333333366, 1214.483333333336, 1213.0833333333367, 1214.3833333333362, 1213.633333333336, 1214.283333333336, 1214.333333333336, 1214.7333333333368, 1214.183333333336, 1213.383333333336, 1212.400000000003, 1213.9833333333368, 1213.6333333333366, 1214.6333333333366, 1214.1333333333353, 1213.9333333333357, 1213.733333333336, 1213.233333333336, 1213.4833333333358, 1211.800000000003, 1213.8833333333362, 1214.6333333333362, 1213.8333333333362, 1214.7833333333356, 1214.2833333333367, 1214.583333333336, 1214.6333333333364, 1210.9500000000023, 1213.833333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.240979228386577, "mean_inference_ms": 2.0544199413005035, "mean_action_processing_ms": 0.09068344687739628, "mean_env_wait_ms": 1.5326619307280265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007020711898803711, "StateBufferConnector_ms": 0.003367185592651367, "ViewRequirementAgentConnector_ms": 0.0866079330444336}, "num_episodes": 24, "episode_return_max": 1215.6333333333369, "episode_return_min": 1210.9500000000023, "episode_return_mean": 1214.0384166666695, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 275700, "num_agent_steps_trained": 275400, "num_env_steps_sampled": 275700, "num_env_steps_trained": 275400, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 224.84439372122597, "num_env_steps_trained_throughput_per_sec": 224.84439372122597, "timesteps_total": 275700, "num_env_steps_sampled_lifetime": 275700, "num_agent_steps_sampled_lifetime": 275700, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 275700, "timers": {"training_iteration_time_ms": 10365.055, "restore_workers_time_ms": 0.013, "training_step_time_ms": 686.12, "sample_time_ms": 657.431, "synch_weights_time_ms": 27.018}, "counters": {"num_env_steps_sampled": 275700, "num_env_steps_trained": 275400, "num_agent_steps_sampled": 275700, "num_agent_steps_trained": 275400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1838, "num_samples_added_to_queue": 275700}, "done": false, "training_iteration": 109, "trial_id": "27800_00000", "date": "2024-10-12_15-46-40", "timestamp": 1728744400, "time_this_iter_s": 10.686958312988281, "time_total_s": 1127.5760881900787, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d47280>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1127.5760881900787, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 19.720000000000002, "ram_util_percent": 54.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3363.65625, "policy_loss": -194.03518676757812, "entropy": 4.967831134796143, "entropy_coeff": 0.01, "var_gnorm": 18.068387985229492, "vf_loss": 357259.5, "vf_explained_var": 0.6451441049575806}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 927.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 278250, "num_env_steps_trained": 278100, "num_agent_steps_sampled": 278250, "num_agent_steps_trained": 278100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1855, "num_samples_added_to_queue": 278100, "learner_queue": {"size_count": 927, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 82.941, "learner_load_time_ms": 0.347, "learner_load_wait_time_ms": 1167.228, "learner_dequeue_time_ms": 10093.533}}, "env_runners": {"episode_reward_max": 1215.6333333333369, "episode_reward_min": 1208.9666666666694, "episode_reward_mean": 1213.835000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1208.9666666666694}, "policy_reward_max": {"default_policy": 1215.6333333333369}, "policy_reward_mean": {"default_policy": 1213.835000000003}, "custom_metrics": {"num_consolidated_mean": 2.9989000000000003, "num_consolidated_min": 2.98, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.16630000000000003, "num_moves_min": 0.0, "num_moves_max": 0.53, "mean_accuracy_mean": 43.63339666666667, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63966666666667, "num_model_switches_mean": 0.0002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16285166666666664, "num_slav_min": 0.1618, "num_slav_max": 0.16373333333333331, "cpu_conserved_cost_mean": 7.9956000000000005, "cpu_conserved_cost_min": 7.92, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5389520741691948, "mean_cluster_cpu_util_min": 0.5362608016179444, "mean_cluster_cpu_util_max": 0.5427096548078691, "mean_cluster_mem_util_mean": 0.34159931962025325, "mean_cluster_mem_util_min": 0.34041429324894507, "mean_cluster_mem_util_max": 0.34209282700421945, "reward_consolidation_mean_mean": 6.247708333333333, "reward_consolidation_mean_min": 6.208333333333332, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333416666666691, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.341666666666695, "reward_sla_mean_mean": -2.4427749999999993, "reward_sla_mean_min": -2.4560000000000004, "reward_sla_mean_max": -2.427, "reward_consolidation_sum_mean": 624.7708333333334, "reward_consolidation_sum_min": 620.8333333333333, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3416666666694, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 834.1666666666695, "reward_sla_sum_mean": -244.2775, "reward_sla_sum_min": -245.60000000000002, "reward_sla_sum_max": -242.7, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5283.0, "global_timestep_min": 3600, "global_timestep_max": 6900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.7833333333367, 1213.7333333333365, 1213.033333333336, 1213.0333333333365, 1213.3833333333362, 1213.8333333333362, 1212.7333333333358, 1214.183333333336, 1214.1333333333364, 1214.733333333336, 1213.1833333333357, 1215.3333333333364, 1213.4333333333354, 1215.1333333333364, 1214.4833333333365, 1214.333333333336, 1213.583333333337, 1214.8833333333366, 1214.4333333333361, 1214.783333333336, 1215.6333333333369, 1214.0333333333365, 1213.983333333336, 1215.0833333333364, 1214.283333333336, 1215.2333333333363, 1215.1333333333369, 1214.583333333337, 1214.4833333333363, 1214.1833333333366, 1214.5833333333355, 1214.5333333333367, 1213.183333333336, 1214.1333333333364, 1214.533333333336, 1214.933333333337, 1213.9333333333363, 1213.733333333336, 1214.0833333333367, 1212.883333333336, 1214.8333333333367, 1213.1833333333368, 1213.683333333336, 1213.4333333333366, 1214.9333333333363, 1213.7833333333358, 1213.333333333336, 1213.9333333333366, 1214.483333333336, 1213.0833333333367, 1214.3833333333362, 1213.633333333336, 1214.283333333336, 1214.333333333336, 1214.7333333333368, 1214.183333333336, 1213.383333333336, 1212.400000000003, 1213.9833333333368, 1213.6333333333366, 1214.6333333333366, 1214.1333333333353, 1213.9333333333357, 1213.733333333336, 1213.233333333336, 1213.4833333333358, 1211.800000000003, 1213.8833333333362, 1214.6333333333362, 1213.8333333333362, 1214.7833333333356, 1214.2833333333367, 1214.583333333336, 1214.6333333333364, 1210.9500000000023, 1213.833333333336, 1213.2833333333358, 1213.6333333333364, 1213.5833333333358, 1208.9666666666694, 1214.0333333333367, 1211.5500000000027, 1209.2666666666698, 1212.0500000000034, 1214.5833333333364, 1213.7833333333358, 1212.883333333336, 1214.7833333333365, 1214.0833333333364, 1213.6833333333363, 1214.8333333333358, 1211.6500000000033, 1214.2833333333363, 1213.8833333333362, 1213.9166666666695, 1213.583333333336, 1213.8333333333358, 1212.3500000000024, 1214.483333333336, 1214.1833333333363], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.7833333333367, 1213.7333333333365, 1213.033333333336, 1213.0333333333365, 1213.3833333333362, 1213.8333333333362, 1212.7333333333358, 1214.183333333336, 1214.1333333333364, 1214.733333333336, 1213.1833333333357, 1215.3333333333364, 1213.4333333333354, 1215.1333333333364, 1214.4833333333365, 1214.333333333336, 1213.583333333337, 1214.8833333333366, 1214.4333333333361, 1214.783333333336, 1215.6333333333369, 1214.0333333333365, 1213.983333333336, 1215.0833333333364, 1214.283333333336, 1215.2333333333363, 1215.1333333333369, 1214.583333333337, 1214.4833333333363, 1214.1833333333366, 1214.5833333333355, 1214.5333333333367, 1213.183333333336, 1214.1333333333364, 1214.533333333336, 1214.933333333337, 1213.9333333333363, 1213.733333333336, 1214.0833333333367, 1212.883333333336, 1214.8333333333367, 1213.1833333333368, 1213.683333333336, 1213.4333333333366, 1214.9333333333363, 1213.7833333333358, 1213.333333333336, 1213.9333333333366, 1214.483333333336, 1213.0833333333367, 1214.3833333333362, 1213.633333333336, 1214.283333333336, 1214.333333333336, 1214.7333333333368, 1214.183333333336, 1213.383333333336, 1212.400000000003, 1213.9833333333368, 1213.6333333333366, 1214.6333333333366, 1214.1333333333353, 1213.9333333333357, 1213.733333333336, 1213.233333333336, 1213.4833333333358, 1211.800000000003, 1213.8833333333362, 1214.6333333333362, 1213.8333333333362, 1214.7833333333356, 1214.2833333333367, 1214.583333333336, 1214.6333333333364, 1210.9500000000023, 1213.833333333336, 1213.2833333333358, 1213.6333333333364, 1213.5833333333358, 1208.9666666666694, 1214.0333333333367, 1211.5500000000027, 1209.2666666666698, 1212.0500000000034, 1214.5833333333364, 1213.7833333333358, 1212.883333333336, 1214.7833333333365, 1214.0833333333364, 1213.6833333333363, 1214.8333333333358, 1211.6500000000033, 1214.2833333333363, 1213.8833333333362, 1213.9166666666695, 1213.583333333336, 1213.8333333333358, 1212.3500000000024, 1214.483333333336, 1214.1833333333363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24104713385353083, "mean_inference_ms": 2.055018211580102, "mean_action_processing_ms": 0.09070862916772966, "mean_env_wait_ms": 1.5329678608050583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070552825927734375, "StateBufferConnector_ms": 0.0033779144287109375, "ViewRequirementAgentConnector_ms": 0.08629846572875977}, "num_episodes": 24, "episode_return_max": 1215.6333333333369, "episode_return_min": 1208.9666666666694, "episode_return_mean": 1213.835000000003, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 278250, "num_agent_steps_trained": 278100, "num_env_steps_sampled": 278250, "num_env_steps_trained": 278100, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 245.08963030255757, "num_env_steps_trained_throughput_per_sec": 259.50666737917857, "timesteps_total": 278250, "num_env_steps_sampled_lifetime": 278250, "num_agent_steps_sampled_lifetime": 278250, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 278250, "timers": {"training_iteration_time_ms": 10404.215, "restore_workers_time_ms": 0.013, "training_step_time_ms": 622.892, "sample_time_ms": 607.541, "synch_weights_time_ms": 13.873}, "counters": {"num_env_steps_sampled": 278250, "num_env_steps_trained": 278100, "num_agent_steps_sampled": 278250, "num_agent_steps_trained": 278100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1855, "num_samples_added_to_queue": 278100}, "done": false, "training_iteration": 110, "trial_id": "27800_00000", "date": "2024-10-12_15-46-51", "timestamp": 1728744411, "time_this_iter_s": 10.41506052017212, "time_total_s": 1137.9911487102509, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b45000>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1137.9911487102509, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 16.46, "ram_util_percent": 55.20666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4903.373046875, "policy_loss": 1114.8111572265625, "entropy": 4.79994010925293, "entropy_coeff": 0.01, "var_gnorm": 18.057435989379883, "vf_loss": 380296.15625, "vf_explained_var": 0.6388000249862671}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 935.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 280650, "num_env_steps_trained": 280500, "num_agent_steps_sampled": 280650, "num_agent_steps_trained": 280500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1871, "num_samples_added_to_queue": 280500, "learner_queue": {"size_count": 935, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.906, "learner_load_time_ms": 0.322, "learner_load_wait_time_ms": 1217.142, "learner_dequeue_time_ms": 10084.8}}, "env_runners": {"episode_reward_max": 1215.2833333333365, "episode_reward_min": 1208.9666666666694, "episode_reward_mean": 1213.7101666666695, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1208.9666666666694}, "policy_reward_max": {"default_policy": 1215.2833333333365}, "policy_reward_mean": {"default_policy": 1213.7101666666695}, "custom_metrics": {"num_consolidated_mean": 2.9982000000000006, "num_consolidated_min": 2.98, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.26380000000000003, "num_moves_min": 0.0, "num_moves_max": 0.53, "mean_accuracy_mean": 43.63339666666667, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63966666666667, "num_model_switches_mean": 0.0002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.1628376666666667, "num_slav_min": 0.16203333333333333, "num_slav_max": 0.16363333333333338, "cpu_conserved_cost_mean": 7.9928, "cpu_conserved_cost_min": 7.92, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5395659883480419, "mean_cluster_cpu_util_min": 0.5371742277992279, "mean_cluster_cpu_util_max": 0.5434009813384815, "mean_cluster_mem_util_mean": 0.3415533465189873, "mean_cluster_mem_util_min": 0.34041429324894507, "mean_cluster_mem_util_max": 0.34209282700421945, "reward_consolidation_mean_mean": 6.24625, "reward_consolidation_mean_min": 6.208333333333332, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333416666666691, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.341666666666695, "reward_sla_mean_mean": -2.442565, "reward_sla_mean_min": -2.4545, "reward_sla_mean_max": -2.4305000000000003, "reward_consolidation_sum_mean": 624.625, "reward_consolidation_sum_min": 620.8333333333333, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3416666666694, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 834.1666666666695, "reward_sla_sum_mean": -244.2565, "reward_sla_sum_min": -245.45, "reward_sla_sum_max": -243.05, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6083.0, "global_timestep_min": 4400, "global_timestep_max": 7700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.283333333336, 1215.2333333333363, 1215.1333333333369, 1214.583333333337, 1214.4833333333363, 1214.1833333333366, 1214.5833333333355, 1214.5333333333367, 1213.183333333336, 1214.1333333333364, 1214.533333333336, 1214.933333333337, 1213.9333333333363, 1213.733333333336, 1214.0833333333367, 1212.883333333336, 1214.8333333333367, 1213.1833333333368, 1213.683333333336, 1213.4333333333366, 1214.9333333333363, 1213.7833333333358, 1213.333333333336, 1213.9333333333366, 1214.483333333336, 1213.0833333333367, 1214.3833333333362, 1213.633333333336, 1214.283333333336, 1214.333333333336, 1214.7333333333368, 1214.183333333336, 1213.383333333336, 1212.400000000003, 1213.9833333333368, 1213.6333333333366, 1214.6333333333366, 1214.1333333333353, 1213.9333333333357, 1213.733333333336, 1213.233333333336, 1213.4833333333358, 1211.800000000003, 1213.8833333333362, 1214.6333333333362, 1213.8333333333362, 1214.7833333333356, 1214.2833333333367, 1214.583333333336, 1214.6333333333364, 1210.9500000000023, 1213.833333333336, 1213.2833333333358, 1213.6333333333364, 1213.5833333333358, 1208.9666666666694, 1214.0333333333367, 1211.5500000000027, 1209.2666666666698, 1212.0500000000034, 1214.5833333333364, 1213.7833333333358, 1212.883333333336, 1214.7833333333365, 1214.0833333333364, 1213.6833333333363, 1214.8333333333358, 1211.6500000000033, 1214.2833333333363, 1213.8833333333362, 1213.9166666666695, 1213.583333333336, 1213.8333333333358, 1212.3500000000024, 1214.483333333336, 1214.1833333333363, 1214.733333333336, 1214.0833333333367, 1210.6166666666695, 1214.1833333333368, 1214.1833333333357, 1211.6000000000029, 1214.7833333333363, 1214.9333333333361, 1214.333333333336, 1211.8000000000027, 1213.5333333333363, 1214.583333333336, 1215.2833333333365, 1214.033333333336, 1214.0333333333367, 1214.4833333333368, 1210.3166666666693, 1214.9833333333365, 1211.0500000000027, 1213.333333333336, 1213.9833333333368, 1214.5833333333362, 1214.1833333333361, 1213.7833333333363], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.283333333336, 1215.2333333333363, 1215.1333333333369, 1214.583333333337, 1214.4833333333363, 1214.1833333333366, 1214.5833333333355, 1214.5333333333367, 1213.183333333336, 1214.1333333333364, 1214.533333333336, 1214.933333333337, 1213.9333333333363, 1213.733333333336, 1214.0833333333367, 1212.883333333336, 1214.8333333333367, 1213.1833333333368, 1213.683333333336, 1213.4333333333366, 1214.9333333333363, 1213.7833333333358, 1213.333333333336, 1213.9333333333366, 1214.483333333336, 1213.0833333333367, 1214.3833333333362, 1213.633333333336, 1214.283333333336, 1214.333333333336, 1214.7333333333368, 1214.183333333336, 1213.383333333336, 1212.400000000003, 1213.9833333333368, 1213.6333333333366, 1214.6333333333366, 1214.1333333333353, 1213.9333333333357, 1213.733333333336, 1213.233333333336, 1213.4833333333358, 1211.800000000003, 1213.8833333333362, 1214.6333333333362, 1213.8333333333362, 1214.7833333333356, 1214.2833333333367, 1214.583333333336, 1214.6333333333364, 1210.9500000000023, 1213.833333333336, 1213.2833333333358, 1213.6333333333364, 1213.5833333333358, 1208.9666666666694, 1214.0333333333367, 1211.5500000000027, 1209.2666666666698, 1212.0500000000034, 1214.5833333333364, 1213.7833333333358, 1212.883333333336, 1214.7833333333365, 1214.0833333333364, 1213.6833333333363, 1214.8333333333358, 1211.6500000000033, 1214.2833333333363, 1213.8833333333362, 1213.9166666666695, 1213.583333333336, 1213.8333333333358, 1212.3500000000024, 1214.483333333336, 1214.1833333333363, 1214.733333333336, 1214.0833333333367, 1210.6166666666695, 1214.1833333333368, 1214.1833333333357, 1211.6000000000029, 1214.7833333333363, 1214.9333333333361, 1214.333333333336, 1211.8000000000027, 1213.5333333333363, 1214.583333333336, 1215.2833333333365, 1214.033333333336, 1214.0333333333367, 1214.4833333333368, 1210.3166666666693, 1214.9833333333365, 1211.0500000000027, 1213.333333333336, 1213.9833333333368, 1214.5833333333362, 1214.1833333333361, 1213.7833333333363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24110962164629982, "mean_inference_ms": 2.0555944658340817, "mean_action_processing_ms": 0.09073401537950328, "mean_env_wait_ms": 1.533292941383123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006952762603759766, "StateBufferConnector_ms": 0.003381013870239258, "ViewRequirementAgentConnector_ms": 0.08616518974304199}, "num_episodes": 24, "episode_return_max": 1215.2833333333365, "episode_return_min": 1208.9666666666694, "episode_return_mean": 1213.7101666666695, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280650, "num_agent_steps_trained": 280500, "num_env_steps_sampled": 280650, "num_env_steps_trained": 280500, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 236.84047551662343, "num_env_steps_trained_throughput_per_sec": 236.84047551662343, "timesteps_total": 280650, "num_env_steps_sampled_lifetime": 280650, "num_agent_steps_sampled_lifetime": 280650, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 280650, "timers": {"training_iteration_time_ms": 10408.315, "restore_workers_time_ms": 0.013, "training_step_time_ms": 626.699, "sample_time_ms": 610.65, "synch_weights_time_ms": 14.374}, "counters": {"num_env_steps_sampled": 280650, "num_env_steps_trained": 280500, "num_agent_steps_sampled": 280650, "num_agent_steps_trained": 280500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1871, "num_samples_added_to_queue": 280500}, "done": false, "training_iteration": 111, "trial_id": "27800_00000", "date": "2024-10-12_15-47-01", "timestamp": 1728744421, "time_this_iter_s": 10.151281595230103, "time_total_s": 1148.142430305481, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486c2980>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1148.142430305481, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 16.173333333333332, "ram_util_percent": 55.20000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3260.4794921875, "policy_loss": -420.5399169921875, "entropy": 4.704837322235107, "entropy_coeff": 0.01, "var_gnorm": 18.055625915527344, "vf_loss": 369513.375, "vf_explained_var": 0.6531431674957275}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 943.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 283050, "num_env_steps_trained": 282900, "num_agent_steps_sampled": 283050, "num_agent_steps_trained": 282900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1887, "num_samples_added_to_queue": 282900, "learner_queue": {"size_count": 943, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.898, "learner_load_time_ms": 0.381, "learner_load_wait_time_ms": 1209.073, "learner_dequeue_time_ms": 10094.882}}, "env_runners": {"episode_reward_max": 1215.2833333333365, "episode_reward_min": 1208.9666666666694, "episode_reward_mean": 1213.6966666666694, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1208.9666666666694}, "policy_reward_max": {"default_policy": 1215.2833333333365}, "policy_reward_mean": {"default_policy": 1213.6966666666694}, "custom_metrics": {"num_consolidated_mean": 2.9978999999999996, "num_consolidated_min": 2.98, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.31999999999999995, "num_moves_min": 0.04, "num_moves_max": 0.53, "mean_accuracy_mean": 43.63339666666667, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63966666666667, "num_model_switches_mean": 0.0008, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16280500000000003, "num_slav_min": 0.16203333333333333, "num_slav_max": 0.16363333333333333, "cpu_conserved_cost_mean": 7.991600000000001, "cpu_conserved_cost_min": 7.92, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5398964938407795, "mean_cluster_cpu_util_min": 0.5373787920573635, "mean_cluster_cpu_util_max": 0.5434009813384815, "mean_cluster_mem_util_mean": 0.3415482832278481, "mean_cluster_mem_util_min": 0.34041429324894507, "mean_cluster_mem_util_max": 0.34209282700421945, "reward_consolidation_mean_mean": 6.245625, "reward_consolidation_mean_min": 6.208333333333332, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333416666666691, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.341666666666695, "reward_sla_mean_mean": -2.442075, "reward_sla_mean_min": -2.4545, "reward_sla_mean_max": -2.4305000000000003, "reward_consolidation_sum_mean": 624.5625, "reward_consolidation_sum_min": 620.8333333333333, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3416666666694, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 834.1666666666695, "reward_sla_sum_mean": -244.2075, "reward_sla_sum_min": -245.45, "reward_sla_sum_max": -243.05, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5240.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.483333333336, 1213.0833333333367, 1214.3833333333362, 1213.633333333336, 1214.283333333336, 1214.333333333336, 1214.7333333333368, 1214.183333333336, 1213.383333333336, 1212.400000000003, 1213.9833333333368, 1213.6333333333366, 1214.6333333333366, 1214.1333333333353, 1213.9333333333357, 1213.733333333336, 1213.233333333336, 1213.4833333333358, 1211.800000000003, 1213.8833333333362, 1214.6333333333362, 1213.8333333333362, 1214.7833333333356, 1214.2833333333367, 1214.583333333336, 1214.6333333333364, 1210.9500000000023, 1213.833333333336, 1213.2833333333358, 1213.6333333333364, 1213.5833333333358, 1208.9666666666694, 1214.0333333333367, 1211.5500000000027, 1209.2666666666698, 1212.0500000000034, 1214.5833333333364, 1213.7833333333358, 1212.883333333336, 1214.7833333333365, 1214.0833333333364, 1213.6833333333363, 1214.8333333333358, 1211.6500000000033, 1214.2833333333363, 1213.8833333333362, 1213.9166666666695, 1213.583333333336, 1213.8333333333358, 1212.3500000000024, 1214.483333333336, 1214.1833333333363, 1214.733333333336, 1214.0833333333367, 1210.6166666666695, 1214.1833333333368, 1214.1833333333357, 1211.6000000000029, 1214.7833333333363, 1214.9333333333361, 1214.333333333336, 1211.8000000000027, 1213.5333333333363, 1214.583333333336, 1215.2833333333365, 1214.033333333336, 1214.0333333333367, 1214.4833333333368, 1210.3166666666693, 1214.9833333333365, 1211.0500000000027, 1213.333333333336, 1213.9833333333368, 1214.5833333333362, 1214.1833333333361, 1213.7833333333363, 1212.1000000000029, 1211.2000000000032, 1214.883333333336, 1214.383333333336, 1214.1333333333357, 1214.2333333333365, 1213.5833333333362, 1213.8333333333362, 1214.9833333333365, 1214.3833333333369, 1214.5833333333364, 1215.0833333333355, 1214.5833333333364, 1214.9833333333356, 1214.2833333333363, 1214.6333333333362, 1214.9833333333365, 1214.4333333333363, 1212.1500000000033, 1213.7833333333356, 1213.6833333333361, 1214.2333333333365, 1214.1833333333363, 1214.8833333333362], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.483333333336, 1213.0833333333367, 1214.3833333333362, 1213.633333333336, 1214.283333333336, 1214.333333333336, 1214.7333333333368, 1214.183333333336, 1213.383333333336, 1212.400000000003, 1213.9833333333368, 1213.6333333333366, 1214.6333333333366, 1214.1333333333353, 1213.9333333333357, 1213.733333333336, 1213.233333333336, 1213.4833333333358, 1211.800000000003, 1213.8833333333362, 1214.6333333333362, 1213.8333333333362, 1214.7833333333356, 1214.2833333333367, 1214.583333333336, 1214.6333333333364, 1210.9500000000023, 1213.833333333336, 1213.2833333333358, 1213.6333333333364, 1213.5833333333358, 1208.9666666666694, 1214.0333333333367, 1211.5500000000027, 1209.2666666666698, 1212.0500000000034, 1214.5833333333364, 1213.7833333333358, 1212.883333333336, 1214.7833333333365, 1214.0833333333364, 1213.6833333333363, 1214.8333333333358, 1211.6500000000033, 1214.2833333333363, 1213.8833333333362, 1213.9166666666695, 1213.583333333336, 1213.8333333333358, 1212.3500000000024, 1214.483333333336, 1214.1833333333363, 1214.733333333336, 1214.0833333333367, 1210.6166666666695, 1214.1833333333368, 1214.1833333333357, 1211.6000000000029, 1214.7833333333363, 1214.9333333333361, 1214.333333333336, 1211.8000000000027, 1213.5333333333363, 1214.583333333336, 1215.2833333333365, 1214.033333333336, 1214.0333333333367, 1214.4833333333368, 1210.3166666666693, 1214.9833333333365, 1211.0500000000027, 1213.333333333336, 1213.9833333333368, 1214.5833333333362, 1214.1833333333361, 1213.7833333333363, 1212.1000000000029, 1211.2000000000032, 1214.883333333336, 1214.383333333336, 1214.1333333333357, 1214.2333333333365, 1213.5833333333362, 1213.8333333333362, 1214.9833333333365, 1214.3833333333369, 1214.5833333333364, 1215.0833333333355, 1214.5833333333364, 1214.9833333333356, 1214.2833333333363, 1214.6333333333362, 1214.9833333333365, 1214.4333333333363, 1212.1500000000033, 1213.7833333333356, 1213.6833333333361, 1214.2333333333365, 1214.1833333333363, 1214.8833333333362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24116697824679423, "mean_inference_ms": 2.05423478494346, "mean_action_processing_ms": 0.09074022070568251, "mean_env_wait_ms": 1.5331873148374877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006747245788574219, "StateBufferConnector_ms": 0.0034537315368652344, "ViewRequirementAgentConnector_ms": 0.08808469772338867}, "num_episodes": 24, "episode_return_max": 1215.2833333333365, "episode_return_min": 1208.9666666666694, "episode_return_mean": 1213.6966666666694, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 283050, "num_agent_steps_trained": 282900, "num_env_steps_sampled": 283050, "num_env_steps_trained": 282900, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 238.21072638711735, "num_env_steps_trained_throughput_per_sec": 238.21072638711735, "timesteps_total": 283050, "num_env_steps_sampled_lifetime": 283050, "num_agent_steps_sampled_lifetime": 283050, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 283050, "timers": {"training_iteration_time_ms": 10382.258, "restore_workers_time_ms": 0.013, "training_step_time_ms": 634.795, "sample_time_ms": 619.511, "synch_weights_time_ms": 13.721}, "counters": {"num_env_steps_sampled": 283050, "num_env_steps_trained": 282900, "num_agent_steps_sampled": 283050, "num_agent_steps_trained": 282900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1887, "num_samples_added_to_queue": 282900}, "done": false, "training_iteration": 112, "trial_id": "27800_00000", "date": "2024-10-12_15-47-11", "timestamp": 1728744431, "time_this_iter_s": 10.08792781829834, "time_total_s": 1158.2303581237793, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486c2920>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1158.2303581237793, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 16.892857142857146, "ram_util_percent": 55.13571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4183.45166015625, "policy_loss": 367.8808898925781, "entropy": 4.501403331756592, "entropy_coeff": 0.01, "var_gnorm": 18.05784797668457, "vf_loss": 382907.5, "vf_explained_var": 0.633773684501648}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 951.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 285600, "num_env_steps_trained": 285300, "num_agent_steps_sampled": 285600, "num_agent_steps_trained": 285300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1904, "num_samples_added_to_queue": 285600, "learner_queue": {"size_count": 951, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.472, "learner_load_time_ms": 0.369, "learner_load_wait_time_ms": 1188.894, "learner_dequeue_time_ms": 10121.065}}, "env_runners": {"episode_reward_max": 1216.0333333333365, "episode_reward_min": 1208.9666666666694, "episode_reward_mean": 1213.7466666666694, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1208.9666666666694}, "policy_reward_max": {"default_policy": 1216.0333333333365}, "policy_reward_mean": {"default_policy": 1213.7466666666694}, "custom_metrics": {"num_consolidated_mean": 2.9979, "num_consolidated_min": 2.98, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.30929999999999996, "num_moves_min": 0.02, "num_moves_max": 0.53, "mean_accuracy_mean": 43.63339666666667, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63966666666667, "num_model_switches_mean": 0.0008, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16277166666666665, "num_slav_min": 0.16153333333333333, "num_slav_max": 0.16363333333333333, "cpu_conserved_cost_mean": 7.9916, "cpu_conserved_cost_min": 7.92, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5398037661449715, "mean_cluster_cpu_util_min": 0.5366171803180732, "mean_cluster_cpu_util_max": 0.5434009813384815, "mean_cluster_mem_util_mean": 0.3415357832278481, "mean_cluster_mem_util_min": 0.34041429324894507, "mean_cluster_mem_util_max": 0.34204324894514765, "reward_consolidation_mean_mean": 6.245625, "reward_consolidation_mean_min": 6.208333333333332, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333416666666691, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.341666666666695, "reward_sla_mean_mean": -2.441575, "reward_sla_mean_min": -2.4545, "reward_sla_mean_max": -2.423, "reward_consolidation_sum_mean": 624.5625, "reward_consolidation_sum_min": 620.8333333333333, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3416666666694, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 834.1666666666695, "reward_sla_sum_mean": -244.1575, "reward_sla_sum_min": -245.45, "reward_sla_sum_max": -242.29999999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4039.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.833333333336, 1213.2833333333358, 1213.6333333333364, 1213.5833333333358, 1208.9666666666694, 1214.0333333333367, 1211.5500000000027, 1209.2666666666698, 1212.0500000000034, 1214.5833333333364, 1213.7833333333358, 1212.883333333336, 1214.7833333333365, 1214.0833333333364, 1213.6833333333363, 1214.8333333333358, 1211.6500000000033, 1214.2833333333363, 1213.8833333333362, 1213.9166666666695, 1213.583333333336, 1213.8333333333358, 1212.3500000000024, 1214.483333333336, 1214.1833333333363, 1214.733333333336, 1214.0833333333367, 1210.6166666666695, 1214.1833333333368, 1214.1833333333357, 1211.6000000000029, 1214.7833333333363, 1214.9333333333361, 1214.333333333336, 1211.8000000000027, 1213.5333333333363, 1214.583333333336, 1215.2833333333365, 1214.033333333336, 1214.0333333333367, 1214.4833333333368, 1210.3166666666693, 1214.9833333333365, 1211.0500000000027, 1213.333333333336, 1213.9833333333368, 1214.5833333333362, 1214.1833333333361, 1213.7833333333363, 1212.1000000000029, 1211.2000000000032, 1214.883333333336, 1214.383333333336, 1214.1333333333357, 1214.2333333333365, 1213.5833333333362, 1213.8333333333362, 1214.9833333333365, 1214.3833333333369, 1214.5833333333364, 1215.0833333333355, 1214.5833333333364, 1214.9833333333356, 1214.2833333333363, 1214.6333333333362, 1214.9833333333365, 1214.4333333333363, 1212.1500000000033, 1213.7833333333356, 1213.6833333333361, 1214.2333333333365, 1214.1833333333363, 1214.8833333333362, 1214.1333333333357, 1214.4833333333358, 1211.6000000000026, 1212.0000000000032, 1214.5833333333364, 1214.433333333336, 1216.0333333333365, 1213.8833333333355, 1214.8333333333362, 1213.283333333336, 1214.1833333333366, 1211.5500000000027, 1215.083333333336, 1214.7333333333358, 1214.4333333333361, 1213.9833333333358, 1214.2833333333367, 1213.9333333333361, 1213.9333333333357, 1213.4333333333366, 1215.4833333333363, 1214.4333333333366, 1213.4833333333363, 1214.0333333333365, 1213.9833333333368, 1213.433333333336, 1214.3833333333366], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.833333333336, 1213.2833333333358, 1213.6333333333364, 1213.5833333333358, 1208.9666666666694, 1214.0333333333367, 1211.5500000000027, 1209.2666666666698, 1212.0500000000034, 1214.5833333333364, 1213.7833333333358, 1212.883333333336, 1214.7833333333365, 1214.0833333333364, 1213.6833333333363, 1214.8333333333358, 1211.6500000000033, 1214.2833333333363, 1213.8833333333362, 1213.9166666666695, 1213.583333333336, 1213.8333333333358, 1212.3500000000024, 1214.483333333336, 1214.1833333333363, 1214.733333333336, 1214.0833333333367, 1210.6166666666695, 1214.1833333333368, 1214.1833333333357, 1211.6000000000029, 1214.7833333333363, 1214.9333333333361, 1214.333333333336, 1211.8000000000027, 1213.5333333333363, 1214.583333333336, 1215.2833333333365, 1214.033333333336, 1214.0333333333367, 1214.4833333333368, 1210.3166666666693, 1214.9833333333365, 1211.0500000000027, 1213.333333333336, 1213.9833333333368, 1214.5833333333362, 1214.1833333333361, 1213.7833333333363, 1212.1000000000029, 1211.2000000000032, 1214.883333333336, 1214.383333333336, 1214.1333333333357, 1214.2333333333365, 1213.5833333333362, 1213.8333333333362, 1214.9833333333365, 1214.3833333333369, 1214.5833333333364, 1215.0833333333355, 1214.5833333333364, 1214.9833333333356, 1214.2833333333363, 1214.6333333333362, 1214.9833333333365, 1214.4333333333363, 1212.1500000000033, 1213.7833333333356, 1213.6833333333361, 1214.2333333333365, 1214.1833333333363, 1214.8833333333362, 1214.1333333333357, 1214.4833333333358, 1211.6000000000026, 1212.0000000000032, 1214.5833333333364, 1214.433333333336, 1216.0333333333365, 1213.8833333333355, 1214.8333333333362, 1213.283333333336, 1214.1833333333366, 1211.5500000000027, 1215.083333333336, 1214.7333333333358, 1214.4333333333361, 1213.9833333333358, 1214.2833333333367, 1213.9333333333361, 1213.9333333333357, 1213.4333333333366, 1215.4833333333363, 1214.4333333333366, 1213.4833333333363, 1214.0333333333365, 1213.9833333333368, 1213.433333333336, 1214.3833333333366]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2412798045450441, "mean_inference_ms": 2.0566641109828847, "mean_action_processing_ms": 0.09078254000258862, "mean_env_wait_ms": 1.5339015681022088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006680488586425781, "StateBufferConnector_ms": 0.003431081771850586, "ViewRequirementAgentConnector_ms": 0.0873723030090332}, "num_episodes": 27, "episode_return_max": 1216.0333333333365, "episode_return_min": 1208.9666666666694, "episode_return_mean": 1213.7466666666694, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 285600, "num_agent_steps_trained": 285300, "num_env_steps_sampled": 285600, "num_env_steps_trained": 285300, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 241.4992855935334, "num_env_steps_trained_throughput_per_sec": 227.293445264502, "timesteps_total": 285600, "num_env_steps_sampled_lifetime": 285600, "num_agent_steps_sampled_lifetime": 285600, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 285600, "timers": {"training_iteration_time_ms": 10377.238, "restore_workers_time_ms": 0.015, "training_step_time_ms": 616.366, "sample_time_ms": 600.521, "synch_weights_time_ms": 14.325}, "counters": {"num_env_steps_sampled": 285600, "num_env_steps_trained": 285300, "num_agent_steps_sampled": 285600, "num_agent_steps_trained": 285300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1904, "num_samples_added_to_queue": 285600}, "done": false, "training_iteration": 113, "trial_id": "27800_00000", "date": "2024-10-12_15-47-22", "timestamp": 1728744442, "time_this_iter_s": 10.57002305984497, "time_total_s": 1168.8003811836243, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f0610>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1168.8003811836243, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 16.246666666666666, "ram_util_percent": 54.74666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3641.3056640625, "policy_loss": -269.7455749511719, "entropy": 4.429064750671387, "entropy_coeff": 0.01, "var_gnorm": 18.06431007385254, "vf_loss": 392433.84375, "vf_explained_var": 0.6365683078765869}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 959.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 287850, "num_env_steps_trained": 287700, "num_agent_steps_sampled": 287850, "num_agent_steps_trained": 287700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1919, "num_samples_added_to_queue": 287700, "learner_queue": {"size_count": 959, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 77.661, "learner_load_time_ms": 0.347, "learner_load_wait_time_ms": 1288.519, "learner_dequeue_time_ms": 10123.562}}, "env_runners": {"episode_reward_max": 1216.0333333333365, "episode_reward_min": 1210.3166666666693, "episode_reward_mean": 1213.9676666666696, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1210.3166666666693}, "policy_reward_max": {"default_policy": 1216.0333333333365}, "policy_reward_mean": {"default_policy": 1213.9676666666696}, "custom_metrics": {"num_consolidated_mean": 2.9986, "num_consolidated_min": 2.98, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.22569999999999996, "num_moves_min": 0.02, "num_moves_max": 0.53, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0006, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.162716, "num_slav_min": 0.16153333333333333, "num_slav_max": 0.16356666666666667, "cpu_conserved_cost_mean": 7.994400000000001, "cpu_conserved_cost_min": 7.92, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5391663109314672, "mean_cluster_cpu_util_min": 0.5366171803180732, "mean_cluster_cpu_util_max": 0.5434009813384815, "mean_cluster_mem_util_mean": 0.34157669567510546, "mean_cluster_mem_util_min": 0.3404968354430379, "mean_cluster_mem_util_max": 0.34204324894514765, "reward_consolidation_mean_mean": 6.247083333333333, "reward_consolidation_mean_min": 6.208333333333332, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.44074, "reward_sla_mean_min": -2.4534999999999996, "reward_sla_mean_max": -2.423, "reward_consolidation_sum_mean": 624.7083333333334, "reward_consolidation_sum_min": 620.8333333333333, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.07399999999998, "reward_sla_sum_min": -245.34999999999997, "reward_sla_sum_max": -242.29999999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3096.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.8333333333358, 1212.3500000000024, 1214.483333333336, 1214.1833333333363, 1214.733333333336, 1214.0833333333367, 1210.6166666666695, 1214.1833333333368, 1214.1833333333357, 1211.6000000000029, 1214.7833333333363, 1214.9333333333361, 1214.333333333336, 1211.8000000000027, 1213.5333333333363, 1214.583333333336, 1215.2833333333365, 1214.033333333336, 1214.0333333333367, 1214.4833333333368, 1210.3166666666693, 1214.9833333333365, 1211.0500000000027, 1213.333333333336, 1213.9833333333368, 1214.5833333333362, 1214.1833333333361, 1213.7833333333363, 1212.1000000000029, 1211.2000000000032, 1214.883333333336, 1214.383333333336, 1214.1333333333357, 1214.2333333333365, 1213.5833333333362, 1213.8333333333362, 1214.9833333333365, 1214.3833333333369, 1214.5833333333364, 1215.0833333333355, 1214.5833333333364, 1214.9833333333356, 1214.2833333333363, 1214.6333333333362, 1214.9833333333365, 1214.4333333333363, 1212.1500000000033, 1213.7833333333356, 1213.6833333333361, 1214.2333333333365, 1214.1833333333363, 1214.8833333333362, 1214.1333333333357, 1214.4833333333358, 1211.6000000000026, 1212.0000000000032, 1214.5833333333364, 1214.433333333336, 1216.0333333333365, 1213.8833333333355, 1214.8333333333362, 1213.283333333336, 1214.1833333333366, 1211.5500000000027, 1215.083333333336, 1214.7333333333358, 1214.4333333333361, 1213.9833333333358, 1214.2833333333367, 1213.9333333333361, 1213.9333333333357, 1213.4333333333366, 1215.4833333333363, 1214.4333333333366, 1213.4833333333363, 1214.0333333333365, 1213.9833333333368, 1213.433333333336, 1214.3833333333366, 1212.983333333336, 1214.6833333333354, 1214.033333333336, 1214.483333333336, 1213.0833333333358, 1214.4333333333357, 1214.2833333333365, 1214.383333333336, 1214.0833333333364, 1214.2333333333368, 1214.8833333333362, 1213.6833333333366, 1213.8333333333367, 1214.733333333336, 1214.7333333333368, 1213.3833333333362, 1214.3833333333362, 1215.2833333333374, 1213.5333333333363, 1214.4333333333361, 1214.683333333337], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.8333333333358, 1212.3500000000024, 1214.483333333336, 1214.1833333333363, 1214.733333333336, 1214.0833333333367, 1210.6166666666695, 1214.1833333333368, 1214.1833333333357, 1211.6000000000029, 1214.7833333333363, 1214.9333333333361, 1214.333333333336, 1211.8000000000027, 1213.5333333333363, 1214.583333333336, 1215.2833333333365, 1214.033333333336, 1214.0333333333367, 1214.4833333333368, 1210.3166666666693, 1214.9833333333365, 1211.0500000000027, 1213.333333333336, 1213.9833333333368, 1214.5833333333362, 1214.1833333333361, 1213.7833333333363, 1212.1000000000029, 1211.2000000000032, 1214.883333333336, 1214.383333333336, 1214.1333333333357, 1214.2333333333365, 1213.5833333333362, 1213.8333333333362, 1214.9833333333365, 1214.3833333333369, 1214.5833333333364, 1215.0833333333355, 1214.5833333333364, 1214.9833333333356, 1214.2833333333363, 1214.6333333333362, 1214.9833333333365, 1214.4333333333363, 1212.1500000000033, 1213.7833333333356, 1213.6833333333361, 1214.2333333333365, 1214.1833333333363, 1214.8833333333362, 1214.1333333333357, 1214.4833333333358, 1211.6000000000026, 1212.0000000000032, 1214.5833333333364, 1214.433333333336, 1216.0333333333365, 1213.8833333333355, 1214.8333333333362, 1213.283333333336, 1214.1833333333366, 1211.5500000000027, 1215.083333333336, 1214.7333333333358, 1214.4333333333361, 1213.9833333333358, 1214.2833333333367, 1213.9333333333361, 1213.9333333333357, 1213.4333333333366, 1215.4833333333363, 1214.4333333333366, 1213.4833333333363, 1214.0333333333365, 1213.9833333333368, 1213.433333333336, 1214.3833333333366, 1212.983333333336, 1214.6833333333354, 1214.033333333336, 1214.483333333336, 1213.0833333333358, 1214.4333333333357, 1214.2833333333365, 1214.383333333336, 1214.0833333333364, 1214.2333333333368, 1214.8833333333362, 1213.6833333333366, 1213.8333333333367, 1214.733333333336, 1214.7333333333368, 1213.3833333333362, 1214.3833333333362, 1215.2833333333374, 1213.5333333333363, 1214.4333333333361, 1214.683333333337]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24135820876332126, "mean_inference_ms": 2.0555133138855077, "mean_action_processing_ms": 0.09079105493646032, "mean_env_wait_ms": 1.5338745649432826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006713390350341797, "StateBufferConnector_ms": 0.0035033226013183594, "ViewRequirementAgentConnector_ms": 0.08969402313232422}, "num_episodes": 21, "episode_return_max": 1216.0333333333365, "episode_return_min": 1210.3166666666693, "episode_return_mean": 1213.9676666666696, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 287850, "num_agent_steps_trained": 287700, "num_env_steps_sampled": 287850, "num_env_steps_trained": 287700, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 214.7749054037059, "num_env_steps_trained_throughput_per_sec": 229.09323243061962, "timesteps_total": 287850, "num_env_steps_sampled_lifetime": 287850, "num_agent_steps_sampled_lifetime": 287850, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 287850, "timers": {"training_iteration_time_ms": 10360.517, "restore_workers_time_ms": 0.014, "training_step_time_ms": 670.835, "sample_time_ms": 654.125, "synch_weights_time_ms": 15.088}, "counters": {"num_env_steps_sampled": 287850, "num_env_steps_trained": 287700, "num_agent_steps_sampled": 287850, "num_agent_steps_trained": 287700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1919, "num_samples_added_to_queue": 287700}, "done": false, "training_iteration": 114, "trial_id": "27800_00000", "date": "2024-10-12_15-47-32", "timestamp": 1728744452, "time_this_iter_s": 10.490639686584473, "time_total_s": 1179.2910208702087, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f2410>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1179.2910208702087, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 23.50666666666667, "ram_util_percent": 56.82000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3192.605712890625, "policy_loss": -758.6055297851562, "entropy": 4.389480113983154, "entropy_coeff": 0.01, "var_gnorm": 18.090789794921875, "vf_loss": 396437.96875, "vf_explained_var": 0.6341534852981567}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 966.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 290100, "num_env_steps_trained": 289800, "num_agent_steps_sampled": 290100, "num_agent_steps_trained": 289800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1934, "num_samples_added_to_queue": 290100, "learner_queue": {"size_count": 966, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 72.025, "learner_load_time_ms": 0.347, "learner_load_wait_time_ms": 1266.922, "learner_dequeue_time_ms": 10230.353}}, "env_runners": {"episode_reward_max": 1216.0333333333365, "episode_reward_min": 1211.2000000000032, "episode_reward_mean": 1214.1293333333365, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.2000000000032}, "policy_reward_max": {"default_policy": 1216.0333333333365}, "policy_reward_mean": {"default_policy": 1214.1293333333365}, "custom_metrics": {"num_consolidated_mean": 2.9994, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.12280000000000003, "num_moves_min": 0.0, "num_moves_max": 0.5, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0006, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16271933333333333, "num_slav_min": 0.16153333333333333, "num_slav_max": 0.1635666666666667, "cpu_conserved_cost_mean": 7.9976, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5385460639306398, "mean_cluster_cpu_util_min": 0.5365622816694247, "mean_cluster_cpu_util_max": 0.5409105534105535, "mean_cluster_mem_util_mean": 0.34162881329113914, "mean_cluster_mem_util_min": 0.3408494198312236, "mean_cluster_mem_util_max": 0.34204324894514765, "reward_consolidation_mean_mean": 6.24875, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.44079, "reward_sla_mean_min": -2.4534999999999996, "reward_sla_mean_max": -2.423, "reward_consolidation_sum_mean": 624.875, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.07899999999995, "reward_sla_sum_min": -245.34999999999997, "reward_sla_sum_max": -242.29999999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2024.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.9833333333368, 1214.5833333333362, 1214.1833333333361, 1213.7833333333363, 1212.1000000000029, 1211.2000000000032, 1214.883333333336, 1214.383333333336, 1214.1333333333357, 1214.2333333333365, 1213.5833333333362, 1213.8333333333362, 1214.9833333333365, 1214.3833333333369, 1214.5833333333364, 1215.0833333333355, 1214.5833333333364, 1214.9833333333356, 1214.2833333333363, 1214.6333333333362, 1214.9833333333365, 1214.4333333333363, 1212.1500000000033, 1213.7833333333356, 1213.6833333333361, 1214.2333333333365, 1214.1833333333363, 1214.8833333333362, 1214.1333333333357, 1214.4833333333358, 1211.6000000000026, 1212.0000000000032, 1214.5833333333364, 1214.433333333336, 1216.0333333333365, 1213.8833333333355, 1214.8333333333362, 1213.283333333336, 1214.1833333333366, 1211.5500000000027, 1215.083333333336, 1214.7333333333358, 1214.4333333333361, 1213.9833333333358, 1214.2833333333367, 1213.9333333333361, 1213.9333333333357, 1213.4333333333366, 1215.4833333333363, 1214.4333333333366, 1213.4833333333363, 1214.0333333333365, 1213.9833333333368, 1213.433333333336, 1214.3833333333366, 1212.983333333336, 1214.6833333333354, 1214.033333333336, 1214.483333333336, 1213.0833333333358, 1214.4333333333357, 1214.2833333333365, 1214.383333333336, 1214.0833333333364, 1214.2333333333368, 1214.8833333333362, 1213.6833333333366, 1213.8333333333367, 1214.733333333336, 1214.7333333333368, 1213.3833333333362, 1214.3833333333362, 1215.2833333333374, 1213.5333333333363, 1214.4333333333361, 1214.683333333337, 1213.0333333333367, 1212.9833333333363, 1213.733333333336, 1213.9833333333365, 1215.2333333333368, 1214.733333333336, 1214.533333333336, 1214.4333333333366, 1214.8833333333362, 1213.5833333333355, 1214.9833333333363, 1213.5833333333364, 1215.5833333333362, 1214.4333333333361, 1215.4333333333366, 1214.1333333333369, 1213.7833333333365, 1213.5333333333365, 1214.3833333333369, 1214.0833333333358, 1214.5833333333358, 1214.233333333337, 1213.5333333333365, 1214.4833333333358], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.9833333333368, 1214.5833333333362, 1214.1833333333361, 1213.7833333333363, 1212.1000000000029, 1211.2000000000032, 1214.883333333336, 1214.383333333336, 1214.1333333333357, 1214.2333333333365, 1213.5833333333362, 1213.8333333333362, 1214.9833333333365, 1214.3833333333369, 1214.5833333333364, 1215.0833333333355, 1214.5833333333364, 1214.9833333333356, 1214.2833333333363, 1214.6333333333362, 1214.9833333333365, 1214.4333333333363, 1212.1500000000033, 1213.7833333333356, 1213.6833333333361, 1214.2333333333365, 1214.1833333333363, 1214.8833333333362, 1214.1333333333357, 1214.4833333333358, 1211.6000000000026, 1212.0000000000032, 1214.5833333333364, 1214.433333333336, 1216.0333333333365, 1213.8833333333355, 1214.8333333333362, 1213.283333333336, 1214.1833333333366, 1211.5500000000027, 1215.083333333336, 1214.7333333333358, 1214.4333333333361, 1213.9833333333358, 1214.2833333333367, 1213.9333333333361, 1213.9333333333357, 1213.4333333333366, 1215.4833333333363, 1214.4333333333366, 1213.4833333333363, 1214.0333333333365, 1213.9833333333368, 1213.433333333336, 1214.3833333333366, 1212.983333333336, 1214.6833333333354, 1214.033333333336, 1214.483333333336, 1213.0833333333358, 1214.4333333333357, 1214.2833333333365, 1214.383333333336, 1214.0833333333364, 1214.2333333333368, 1214.8833333333362, 1213.6833333333366, 1213.8333333333367, 1214.733333333336, 1214.7333333333368, 1213.3833333333362, 1214.3833333333362, 1215.2833333333374, 1213.5333333333363, 1214.4333333333361, 1214.683333333337, 1213.0333333333367, 1212.9833333333363, 1213.733333333336, 1213.9833333333365, 1215.2333333333368, 1214.733333333336, 1214.533333333336, 1214.4333333333366, 1214.8833333333362, 1213.5833333333355, 1214.9833333333363, 1213.5833333333364, 1215.5833333333362, 1214.4333333333361, 1215.4333333333366, 1214.1333333333369, 1213.7833333333365, 1213.5333333333365, 1214.3833333333369, 1214.0833333333358, 1214.5833333333358, 1214.233333333337, 1213.5333333333365, 1214.4833333333358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24150422319979925, "mean_inference_ms": 2.0568380917912448, "mean_action_processing_ms": 0.09083238551879631, "mean_env_wait_ms": 1.534561440321176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006801605224609375, "StateBufferConnector_ms": 0.0035114288330078125, "ViewRequirementAgentConnector_ms": 0.09052848815917969}, "num_episodes": 24, "episode_return_max": 1216.0333333333365, "episode_return_min": 1211.2000000000032, "episode_return_mean": 1214.1293333333365, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 290100, "num_agent_steps_trained": 289800, "num_env_steps_sampled": 290100, "num_env_steps_trained": 289800, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 221.4097999411306, "num_env_steps_trained_throughput_per_sec": 206.64914661172187, "timesteps_total": 290100, "num_env_steps_sampled_lifetime": 290100, "num_agent_steps_sampled_lifetime": 290100, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 290100, "timers": {"training_iteration_time_ms": 10322.724, "restore_workers_time_ms": 0.012, "training_step_time_ms": 633.558, "sample_time_ms": 618.053, "synch_weights_time_ms": 14.038}, "counters": {"num_env_steps_sampled": 290100, "num_env_steps_trained": 289800, "num_agent_steps_sampled": 290100, "num_agent_steps_trained": 289800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1934, "num_samples_added_to_queue": 290100}, "done": false, "training_iteration": 115, "trial_id": "27800_00000", "date": "2024-10-12_15-47-42", "timestamp": 1728744462, "time_this_iter_s": 10.18092679977417, "time_total_s": 1189.471947669983, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948952fe0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1189.471947669983, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 21.326666666666664, "ram_util_percent": 58.006666666666675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4023.260986328125, "policy_loss": -43.584781646728516, "entropy": 4.384758949279785, "entropy_coeff": 0.01, "var_gnorm": 18.149272918701172, "vf_loss": 408000.0, "vf_explained_var": 0.6312531232833862}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 975.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 292650, "num_env_steps_trained": 292500, "num_agent_steps_sampled": 292650, "num_agent_steps_trained": 292500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1951, "num_samples_added_to_queue": 292500, "learner_queue": {"size_count": 975, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.108, "learner_load_time_ms": 0.313, "learner_load_wait_time_ms": 1141.896, "learner_dequeue_time_ms": 10291.948}}, "env_runners": {"episode_reward_max": 1216.0333333333365, "episode_reward_min": 1211.5500000000027, "episode_reward_mean": 1214.1123333333362, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.5500000000027}, "policy_reward_max": {"default_policy": 1216.0333333333365}, "policy_reward_mean": {"default_policy": 1214.1123333333362}, "custom_metrics": {"num_consolidated_mean": 2.9997000000000003, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0558, "num_moves_min": 0.0, "num_moves_max": 0.29, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.16277233333333335, "num_slav_min": 0.16153333333333333, "num_slav_max": 0.1635666666666667, "cpu_conserved_cost_mean": 7.9988, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5381499276923608, "mean_cluster_cpu_util_min": 0.5364965526751242, "mean_cluster_cpu_util_max": 0.5409105534105535, "mean_cluster_mem_util_mean": 0.34162702004219403, "mean_cluster_mem_util_min": 0.3411215717299578, "mean_cluster_mem_util_max": 0.34204324894514765, "reward_consolidation_mean_mean": 6.249375, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.441585, "reward_sla_mean_min": -2.4534999999999996, "reward_sla_mean_max": -2.423, "reward_consolidation_sum_mean": 624.9375, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.15849999999998, "reward_sla_sum_min": -245.34999999999997, "reward_sla_sum_max": -242.29999999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2278.0, "global_timestep_min": 400, "global_timestep_max": 3900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.6833333333361, 1214.2333333333365, 1214.1833333333363, 1214.8833333333362, 1214.1333333333357, 1214.4833333333358, 1211.6000000000026, 1212.0000000000032, 1214.5833333333364, 1214.433333333336, 1216.0333333333365, 1213.8833333333355, 1214.8333333333362, 1213.283333333336, 1214.1833333333366, 1211.5500000000027, 1215.083333333336, 1214.7333333333358, 1214.4333333333361, 1213.9833333333358, 1214.2833333333367, 1213.9333333333361, 1213.9333333333357, 1213.4333333333366, 1215.4833333333363, 1214.4333333333366, 1213.4833333333363, 1214.0333333333365, 1213.9833333333368, 1213.433333333336, 1214.3833333333366, 1212.983333333336, 1214.6833333333354, 1214.033333333336, 1214.483333333336, 1213.0833333333358, 1214.4333333333357, 1214.2833333333365, 1214.383333333336, 1214.0833333333364, 1214.2333333333368, 1214.8833333333362, 1213.6833333333366, 1213.8333333333367, 1214.733333333336, 1214.7333333333368, 1213.3833333333362, 1214.3833333333362, 1215.2833333333374, 1213.5333333333363, 1214.4333333333361, 1214.683333333337, 1213.0333333333367, 1212.9833333333363, 1213.733333333336, 1213.9833333333365, 1215.2333333333368, 1214.733333333336, 1214.533333333336, 1214.4333333333366, 1214.8833333333362, 1213.5833333333355, 1214.9833333333363, 1213.5833333333364, 1215.5833333333362, 1214.4333333333361, 1215.4333333333366, 1214.1333333333369, 1213.7833333333365, 1213.5333333333365, 1214.3833333333369, 1214.0833333333358, 1214.5833333333358, 1214.233333333337, 1213.5333333333365, 1214.4833333333358, 1214.9333333333363, 1214.533333333336, 1214.6833333333366, 1213.0833333333364, 1213.9333333333354, 1213.2833333333358, 1214.283333333336, 1213.3833333333366, 1213.833333333336, 1214.1833333333363, 1213.583333333336, 1214.3833333333364, 1214.4333333333363, 1213.833333333337, 1213.6333333333366, 1213.8333333333355, 1213.933333333336, 1213.2833333333365, 1214.533333333336, 1213.4333333333357, 1215.1833333333366, 1213.8333333333364, 1213.9833333333356, 1214.0333333333358], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.6833333333361, 1214.2333333333365, 1214.1833333333363, 1214.8833333333362, 1214.1333333333357, 1214.4833333333358, 1211.6000000000026, 1212.0000000000032, 1214.5833333333364, 1214.433333333336, 1216.0333333333365, 1213.8833333333355, 1214.8333333333362, 1213.283333333336, 1214.1833333333366, 1211.5500000000027, 1215.083333333336, 1214.7333333333358, 1214.4333333333361, 1213.9833333333358, 1214.2833333333367, 1213.9333333333361, 1213.9333333333357, 1213.4333333333366, 1215.4833333333363, 1214.4333333333366, 1213.4833333333363, 1214.0333333333365, 1213.9833333333368, 1213.433333333336, 1214.3833333333366, 1212.983333333336, 1214.6833333333354, 1214.033333333336, 1214.483333333336, 1213.0833333333358, 1214.4333333333357, 1214.2833333333365, 1214.383333333336, 1214.0833333333364, 1214.2333333333368, 1214.8833333333362, 1213.6833333333366, 1213.8333333333367, 1214.733333333336, 1214.7333333333368, 1213.3833333333362, 1214.3833333333362, 1215.2833333333374, 1213.5333333333363, 1214.4333333333361, 1214.683333333337, 1213.0333333333367, 1212.9833333333363, 1213.733333333336, 1213.9833333333365, 1215.2333333333368, 1214.733333333336, 1214.533333333336, 1214.4333333333366, 1214.8833333333362, 1213.5833333333355, 1214.9833333333363, 1213.5833333333364, 1215.5833333333362, 1214.4333333333361, 1215.4333333333366, 1214.1333333333369, 1213.7833333333365, 1213.5333333333365, 1214.3833333333369, 1214.0833333333358, 1214.5833333333358, 1214.233333333337, 1213.5333333333365, 1214.4833333333358, 1214.9333333333363, 1214.533333333336, 1214.6833333333366, 1213.0833333333364, 1213.9333333333354, 1213.2833333333358, 1214.283333333336, 1213.3833333333366, 1213.833333333336, 1214.1833333333363, 1213.583333333336, 1214.3833333333364, 1214.4333333333363, 1213.833333333337, 1213.6333333333366, 1213.8333333333355, 1213.933333333336, 1213.2833333333365, 1214.533333333336, 1213.4333333333357, 1215.1833333333366, 1213.8333333333364, 1213.9833333333356, 1214.0333333333358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24161734543027102, "mean_inference_ms": 2.0579294182624626, "mean_action_processing_ms": 0.09086782759483851, "mean_env_wait_ms": 1.535140062852691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067136287689208984, "StateBufferConnector_ms": 0.003479480743408203, "ViewRequirementAgentConnector_ms": 0.0899500846862793}, "num_episodes": 24, "episode_return_max": 1216.0333333333365, "episode_return_min": 1211.5500000000027, "episode_return_mean": 1214.1123333333362, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292650, "num_agent_steps_trained": 292500, "num_env_steps_sampled": 292650, "num_env_steps_trained": 292500, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 247.66734587103502, "num_env_steps_trained_throughput_per_sec": 262.23601327521357, "timesteps_total": 292650, "num_env_steps_sampled_lifetime": 292650, "num_agent_steps_sampled_lifetime": 292650, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 292650, "timers": {"training_iteration_time_ms": 10342.418, "restore_workers_time_ms": 0.013, "training_step_time_ms": 615.135, "sample_time_ms": 599.423, "synch_weights_time_ms": 14.324}, "counters": {"num_env_steps_sampled": 292650, "num_env_steps_trained": 292500, "num_agent_steps_sampled": 292650, "num_agent_steps_trained": 292500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1951, "num_samples_added_to_queue": 292500}, "done": false, "training_iteration": 116, "trial_id": "27800_00000", "date": "2024-10-12_15-47-53", "timestamp": 1728744473, "time_this_iter_s": 10.307218551635742, "time_total_s": 1199.7791662216187, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f2830>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1199.7791662216187, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 17.146666666666665, "ram_util_percent": 58.08666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3117.09521484375, "policy_loss": -923.1240844726562, "entropy": 4.408708095550537, "entropy_coeff": 0.01, "var_gnorm": 18.12579917907715, "vf_loss": 405344.5625, "vf_explained_var": 0.631208062171936}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 983.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 295200, "num_env_steps_trained": 294900, "num_agent_steps_sampled": 295200, "num_agent_steps_trained": 294900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1968, "num_samples_added_to_queue": 295200, "learner_queue": {"size_count": 983, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.196, "learner_load_time_ms": 0.302, "learner_load_wait_time_ms": 1214.087, "learner_dequeue_time_ms": 10252.548}}, "env_runners": {"episode_reward_max": 1215.5833333333362, "episode_reward_min": 1212.983333333336, "episode_reward_mean": 1214.1403333333362, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.983333333336}, "policy_reward_max": {"default_policy": 1215.5833333333362}, "policy_reward_mean": {"default_policy": 1214.1403333333362}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.022, "num_moves_min": 0.0, "num_moves_max": 0.12, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.16279533333333338, "num_slav_min": 0.16183333333333333, "num_slav_max": 0.1635666666666667, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5379576128424343, "mean_cluster_cpu_util_min": 0.5358247609854753, "mean_cluster_cpu_util_max": 0.5404511054421769, "mean_cluster_mem_util_mean": 0.3416366983122363, "mean_cluster_mem_util_min": 0.34120253164556963, "mean_cluster_mem_util_max": 0.3420390295358649, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4419299999999993, "reward_sla_mean_min": -2.4535, "reward_sla_mean_max": -2.4274999999999998, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.19300000000004, "reward_sla_sum_min": -245.35, "reward_sla_sum_max": -242.74999999999997, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3178.0, "global_timestep_min": 1300, "global_timestep_max": 4800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.0333333333365, 1213.9833333333368, 1213.433333333336, 1214.3833333333366, 1212.983333333336, 1214.6833333333354, 1214.033333333336, 1214.483333333336, 1213.0833333333358, 1214.4333333333357, 1214.2833333333365, 1214.383333333336, 1214.0833333333364, 1214.2333333333368, 1214.8833333333362, 1213.6833333333366, 1213.8333333333367, 1214.733333333336, 1214.7333333333368, 1213.3833333333362, 1214.3833333333362, 1215.2833333333374, 1213.5333333333363, 1214.4333333333361, 1214.683333333337, 1213.0333333333367, 1212.9833333333363, 1213.733333333336, 1213.9833333333365, 1215.2333333333368, 1214.733333333336, 1214.533333333336, 1214.4333333333366, 1214.8833333333362, 1213.5833333333355, 1214.9833333333363, 1213.5833333333364, 1215.5833333333362, 1214.4333333333361, 1215.4333333333366, 1214.1333333333369, 1213.7833333333365, 1213.5333333333365, 1214.3833333333369, 1214.0833333333358, 1214.5833333333358, 1214.233333333337, 1213.5333333333365, 1214.4833333333358, 1214.9333333333363, 1214.533333333336, 1214.6833333333366, 1213.0833333333364, 1213.9333333333354, 1213.2833333333358, 1214.283333333336, 1213.3833333333366, 1213.833333333336, 1214.1833333333363, 1213.583333333336, 1214.3833333333364, 1214.4333333333363, 1213.833333333337, 1213.6333333333366, 1213.8333333333355, 1213.933333333336, 1213.2833333333365, 1214.533333333336, 1213.4333333333357, 1215.1833333333366, 1213.8333333333364, 1213.9833333333356, 1214.0333333333358, 1213.7833333333363, 1213.1833333333363, 1214.6833333333366, 1214.4333333333366, 1214.9333333333366, 1214.3333333333362, 1214.8333333333367, 1214.3833333333362, 1214.6833333333363, 1214.8833333333366, 1213.7333333333358, 1214.1333333333362, 1214.0333333333358, 1214.1333333333364, 1214.2833333333363, 1214.3833333333364, 1214.033333333336, 1212.9833333333363, 1212.9833333333365, 1214.5833333333362, 1213.9333333333363, 1214.7333333333363, 1213.1833333333366, 1214.1833333333363, 1213.9333333333361, 1214.7833333333365, 1213.833333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.0333333333365, 1213.9833333333368, 1213.433333333336, 1214.3833333333366, 1212.983333333336, 1214.6833333333354, 1214.033333333336, 1214.483333333336, 1213.0833333333358, 1214.4333333333357, 1214.2833333333365, 1214.383333333336, 1214.0833333333364, 1214.2333333333368, 1214.8833333333362, 1213.6833333333366, 1213.8333333333367, 1214.733333333336, 1214.7333333333368, 1213.3833333333362, 1214.3833333333362, 1215.2833333333374, 1213.5333333333363, 1214.4333333333361, 1214.683333333337, 1213.0333333333367, 1212.9833333333363, 1213.733333333336, 1213.9833333333365, 1215.2333333333368, 1214.733333333336, 1214.533333333336, 1214.4333333333366, 1214.8833333333362, 1213.5833333333355, 1214.9833333333363, 1213.5833333333364, 1215.5833333333362, 1214.4333333333361, 1215.4333333333366, 1214.1333333333369, 1213.7833333333365, 1213.5333333333365, 1214.3833333333369, 1214.0833333333358, 1214.5833333333358, 1214.233333333337, 1213.5333333333365, 1214.4833333333358, 1214.9333333333363, 1214.533333333336, 1214.6833333333366, 1213.0833333333364, 1213.9333333333354, 1213.2833333333358, 1214.283333333336, 1213.3833333333366, 1213.833333333336, 1214.1833333333363, 1213.583333333336, 1214.3833333333364, 1214.4333333333363, 1213.833333333337, 1213.6333333333366, 1213.8333333333355, 1213.933333333336, 1213.2833333333365, 1214.533333333336, 1213.4333333333357, 1215.1833333333366, 1213.8333333333364, 1213.9833333333356, 1214.0333333333358, 1213.7833333333363, 1213.1833333333363, 1214.6833333333366, 1214.4333333333366, 1214.9333333333366, 1214.3333333333362, 1214.8333333333367, 1214.3833333333362, 1214.6833333333363, 1214.8833333333366, 1213.7333333333358, 1214.1333333333362, 1214.0333333333358, 1214.1333333333364, 1214.2833333333363, 1214.3833333333364, 1214.033333333336, 1212.9833333333363, 1212.9833333333365, 1214.5833333333362, 1213.9333333333363, 1214.7333333333363, 1213.1833333333366, 1214.1833333333363, 1213.9333333333361, 1214.7833333333365, 1213.833333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2417258177715678, "mean_inference_ms": 2.059226570729771, "mean_action_processing_ms": 0.0909072736459215, "mean_env_wait_ms": 1.5358150466890197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066034793853759766, "StateBufferConnector_ms": 0.003420114517211914, "ViewRequirementAgentConnector_ms": 0.08868932723999023}, "num_episodes": 27, "episode_return_max": 1215.5833333333362, "episode_return_min": 1212.983333333336, "episode_return_mean": 1214.1403333333362, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 295200, "num_agent_steps_trained": 294900, "num_env_steps_sampled": 295200, "num_env_steps_trained": 294900, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 239.4569666254134, "num_env_steps_trained_throughput_per_sec": 225.37126270627144, "timesteps_total": 295200, "num_env_steps_sampled_lifetime": 295200, "num_agent_steps_sampled_lifetime": 295200, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 295200, "timers": {"training_iteration_time_ms": 10395.4, "restore_workers_time_ms": 0.012, "training_step_time_ms": 631.053, "sample_time_ms": 615.651, "synch_weights_time_ms": 13.934}, "counters": {"num_env_steps_sampled": 295200, "num_env_steps_trained": 294900, "num_agent_steps_sampled": 295200, "num_agent_steps_trained": 294900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1968, "num_samples_added_to_queue": 295200}, "done": false, "training_iteration": 117, "trial_id": "27800_00000", "date": "2024-10-12_15-48-03", "timestamp": 1728744483, "time_this_iter_s": 10.661540031433105, "time_total_s": 1210.4407062530518, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948951a50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1210.4407062530518, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 16.860000000000003, "ram_util_percent": 57.09333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4277.7783203125, "policy_loss": 478.6772155761719, "entropy": 4.523326873779297, "entropy_coeff": 0.01, "var_gnorm": 18.119565963745117, "vf_loss": 381267.125, "vf_explained_var": 0.6391421556472778}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 991.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 297600, "num_env_steps_trained": 297300, "num_agent_steps_sampled": 297600, "num_agent_steps_trained": 297300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1984, "num_samples_added_to_queue": 297600, "learner_queue": {"size_count": 991, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.095, "learner_load_time_ms": 0.271, "learner_load_wait_time_ms": 1193.687, "learner_dequeue_time_ms": 10255.732}}, "env_runners": {"episode_reward_max": 1215.5833333333362, "episode_reward_min": 1212.9833333333363, "episode_reward_mean": 1214.1168333333364, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.9833333333363}, "policy_reward_max": {"default_policy": 1215.5833333333362}, "policy_reward_mean": {"default_policy": 1214.1168333333364}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.021800000000000007, "num_moves_min": 0.0, "num_moves_max": 0.14, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.16281099999999998, "num_slav_min": 0.16183333333333333, "num_slav_max": 0.1635666666666667, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.537968466170252, "mean_cluster_cpu_util_min": 0.5358247609854753, "mean_cluster_cpu_util_max": 0.5404511054421769, "mean_cluster_mem_util_mean": 0.341641223628692, "mean_cluster_mem_util_min": 0.34120253164556963, "mean_cluster_mem_util_max": 0.34209915611814345, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4421649999999997, "reward_sla_mean_min": -2.4535, "reward_sla_mean_max": -2.4274999999999998, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.21650000000002, "reward_sla_sum_min": -245.35, "reward_sla_sum_max": -242.74999999999997, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3983.0, "global_timestep_min": 2300, "global_timestep_max": 5600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.683333333337, 1213.0333333333367, 1212.9833333333363, 1213.733333333336, 1213.9833333333365, 1215.2333333333368, 1214.733333333336, 1214.533333333336, 1214.4333333333366, 1214.8833333333362, 1213.5833333333355, 1214.9833333333363, 1213.5833333333364, 1215.5833333333362, 1214.4333333333361, 1215.4333333333366, 1214.1333333333369, 1213.7833333333365, 1213.5333333333365, 1214.3833333333369, 1214.0833333333358, 1214.5833333333358, 1214.233333333337, 1213.5333333333365, 1214.4833333333358, 1214.9333333333363, 1214.533333333336, 1214.6833333333366, 1213.0833333333364, 1213.9333333333354, 1213.2833333333358, 1214.283333333336, 1213.3833333333366, 1213.833333333336, 1214.1833333333363, 1213.583333333336, 1214.3833333333364, 1214.4333333333363, 1213.833333333337, 1213.6333333333366, 1213.8333333333355, 1213.933333333336, 1213.2833333333365, 1214.533333333336, 1213.4333333333357, 1215.1833333333366, 1213.8333333333364, 1213.9833333333356, 1214.0333333333358, 1213.7833333333363, 1213.1833333333363, 1214.6833333333366, 1214.4333333333366, 1214.9333333333366, 1214.3333333333362, 1214.8333333333367, 1214.3833333333362, 1214.6833333333363, 1214.8833333333366, 1213.7333333333358, 1214.1333333333362, 1214.0333333333358, 1214.1333333333364, 1214.2833333333363, 1214.3833333333364, 1214.033333333336, 1212.9833333333363, 1212.9833333333365, 1214.5833333333362, 1213.9333333333363, 1214.7333333333363, 1213.1833333333366, 1214.1833333333363, 1213.9333333333361, 1214.7833333333365, 1213.833333333336, 1213.8833333333364, 1214.0833333333364, 1213.6333333333373, 1214.2333333333368, 1214.033333333336, 1213.4333333333363, 1213.7833333333365, 1214.3833333333364, 1213.8333333333364, 1214.2833333333365, 1214.5333333333363, 1214.2333333333365, 1214.5833333333367, 1213.3833333333366, 1214.1333333333357, 1215.3833333333364, 1214.0833333333362, 1213.783333333336, 1213.7833333333365, 1214.6333333333362, 1214.1833333333368, 1213.4833333333365, 1214.0833333333367, 1213.1833333333357], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.683333333337, 1213.0333333333367, 1212.9833333333363, 1213.733333333336, 1213.9833333333365, 1215.2333333333368, 1214.733333333336, 1214.533333333336, 1214.4333333333366, 1214.8833333333362, 1213.5833333333355, 1214.9833333333363, 1213.5833333333364, 1215.5833333333362, 1214.4333333333361, 1215.4333333333366, 1214.1333333333369, 1213.7833333333365, 1213.5333333333365, 1214.3833333333369, 1214.0833333333358, 1214.5833333333358, 1214.233333333337, 1213.5333333333365, 1214.4833333333358, 1214.9333333333363, 1214.533333333336, 1214.6833333333366, 1213.0833333333364, 1213.9333333333354, 1213.2833333333358, 1214.283333333336, 1213.3833333333366, 1213.833333333336, 1214.1833333333363, 1213.583333333336, 1214.3833333333364, 1214.4333333333363, 1213.833333333337, 1213.6333333333366, 1213.8333333333355, 1213.933333333336, 1213.2833333333365, 1214.533333333336, 1213.4333333333357, 1215.1833333333366, 1213.8333333333364, 1213.9833333333356, 1214.0333333333358, 1213.7833333333363, 1213.1833333333363, 1214.6833333333366, 1214.4333333333366, 1214.9333333333366, 1214.3333333333362, 1214.8333333333367, 1214.3833333333362, 1214.6833333333363, 1214.8833333333366, 1213.7333333333358, 1214.1333333333362, 1214.0333333333358, 1214.1333333333364, 1214.2833333333363, 1214.3833333333364, 1214.033333333336, 1212.9833333333363, 1212.9833333333365, 1214.5833333333362, 1213.9333333333363, 1214.7333333333363, 1213.1833333333366, 1214.1833333333363, 1213.9333333333361, 1214.7833333333365, 1213.833333333336, 1213.8833333333364, 1214.0833333333364, 1213.6333333333373, 1214.2333333333368, 1214.033333333336, 1213.4333333333363, 1213.7833333333365, 1214.3833333333364, 1213.8333333333364, 1214.2833333333365, 1214.5333333333363, 1214.2333333333365, 1214.5833333333367, 1213.3833333333366, 1214.1333333333357, 1215.3833333333364, 1214.0833333333362, 1213.783333333336, 1213.7833333333365, 1214.6333333333362, 1214.1833333333368, 1213.4833333333365, 1214.0833333333367, 1213.1833333333357]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2418164961359489, "mean_inference_ms": 2.0618892873367938, "mean_action_processing_ms": 0.09094864127419906, "mean_env_wait_ms": 1.5366418803731454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065135955810546875, "StateBufferConnector_ms": 0.0033380985260009766, "ViewRequirementAgentConnector_ms": 0.08674812316894531}, "num_episodes": 24, "episode_return_max": 1215.5833333333362, "episode_return_min": 1212.9833333333363, "episode_return_mean": 1214.1168333333364, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 297600, "num_agent_steps_trained": 297300, "num_env_steps_sampled": 297600, "num_env_steps_trained": 297300, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 239.57097969398987, "num_env_steps_trained_throughput_per_sec": 239.57097969398987, "timesteps_total": 297600, "num_env_steps_sampled_lifetime": 297600, "num_agent_steps_sampled_lifetime": 297600, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 297600, "timers": {"training_iteration_time_ms": 10344.736, "restore_workers_time_ms": 0.013, "training_step_time_ms": 630.203, "sample_time_ms": 614.481, "synch_weights_time_ms": 14.239}, "counters": {"num_env_steps_sampled": 297600, "num_env_steps_trained": 297300, "num_agent_steps_sampled": 297600, "num_agent_steps_trained": 297300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1984, "num_samples_added_to_queue": 297600}, "done": false, "training_iteration": 118, "trial_id": "27800_00000", "date": "2024-10-12_15-48-13", "timestamp": 1728744493, "time_this_iter_s": 10.02867865562439, "time_total_s": 1220.4693849086761, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b46a40>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1220.4693849086761, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 16.47857142857143, "ram_util_percent": 56.435714285714276}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4485.47802734375, "policy_loss": 675.3021850585938, "entropy": 4.678702354431152, "entropy_coeff": 0.01, "var_gnorm": 18.116453170776367, "vf_loss": 382421.21875, "vf_explained_var": 0.638679563999176}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 300150, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300150, "num_agent_steps_trained": 300000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2001, "num_samples_added_to_queue": 300000, "learner_queue": {"size_count": 1000, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.14, "learner_load_time_ms": 0.276, "learner_load_wait_time_ms": 1174.955, "learner_dequeue_time_ms": 10257.162}}, "env_runners": {"episode_reward_max": 1215.3833333333364, "episode_reward_min": 1212.7833333333367, "episode_reward_mean": 1214.0743333333364, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.7833333333367}, "policy_reward_max": {"default_policy": 1215.3833333333364}, "policy_reward_mean": {"default_policy": 1214.0743333333364}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.08039999999999999, "num_moves_min": 0.0, "num_moves_max": 0.47, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.16283933333333336, "num_slav_min": 0.16196666666666665, "num_slav_max": 0.1637, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5379204502206288, "mean_cluster_cpu_util_min": 0.5358247609854753, "mean_cluster_cpu_util_max": 0.5396019029233314, "mean_cluster_mem_util_mean": 0.3416294303797468, "mean_cluster_mem_util_min": 0.34120253164556963, "mean_cluster_mem_util_max": 0.34209915611814345, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.44259, "reward_sla_mean_min": -2.4554999999999993, "reward_sla_mean_max": -2.4295, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.259, "reward_sla_sum_min": -245.54999999999995, "reward_sla_sum_max": -242.95, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4783.0, "global_timestep_min": 3100, "global_timestep_max": 6400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.4833333333358, 1214.9333333333363, 1214.533333333336, 1214.6833333333366, 1213.0833333333364, 1213.9333333333354, 1213.2833333333358, 1214.283333333336, 1213.3833333333366, 1213.833333333336, 1214.1833333333363, 1213.583333333336, 1214.3833333333364, 1214.4333333333363, 1213.833333333337, 1213.6333333333366, 1213.8333333333355, 1213.933333333336, 1213.2833333333365, 1214.533333333336, 1213.4333333333357, 1215.1833333333366, 1213.8333333333364, 1213.9833333333356, 1214.0333333333358, 1213.7833333333363, 1213.1833333333363, 1214.6833333333366, 1214.4333333333366, 1214.9333333333366, 1214.3333333333362, 1214.8333333333367, 1214.3833333333362, 1214.6833333333363, 1214.8833333333366, 1213.7333333333358, 1214.1333333333362, 1214.0333333333358, 1214.1333333333364, 1214.2833333333363, 1214.3833333333364, 1214.033333333336, 1212.9833333333363, 1212.9833333333365, 1214.5833333333362, 1213.9333333333363, 1214.7333333333363, 1213.1833333333366, 1214.1833333333363, 1213.9333333333361, 1214.7833333333365, 1213.833333333336, 1213.8833333333364, 1214.0833333333364, 1213.6333333333373, 1214.2333333333368, 1214.033333333336, 1213.4333333333363, 1213.7833333333365, 1214.3833333333364, 1213.8333333333364, 1214.2833333333365, 1214.5333333333363, 1214.2333333333365, 1214.5833333333367, 1213.3833333333366, 1214.1333333333357, 1215.3833333333364, 1214.0833333333362, 1213.783333333336, 1213.7833333333365, 1214.6333333333362, 1214.1833333333368, 1213.4833333333365, 1214.0833333333367, 1213.1833333333357, 1213.7333333333363, 1215.2833333333365, 1213.6833333333361, 1213.733333333337, 1214.0833333333364, 1214.9333333333363, 1214.7333333333363, 1213.7333333333365, 1214.533333333336, 1214.3333333333364, 1212.7833333333367, 1214.7833333333356, 1213.9333333333366, 1214.4833333333356, 1213.1833333333361, 1214.3333333333364, 1214.4833333333368, 1213.2833333333365, 1214.2833333333363, 1213.283333333336, 1212.933333333336, 1214.5333333333367, 1215.233333333336, 1213.533333333337], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.4833333333358, 1214.9333333333363, 1214.533333333336, 1214.6833333333366, 1213.0833333333364, 1213.9333333333354, 1213.2833333333358, 1214.283333333336, 1213.3833333333366, 1213.833333333336, 1214.1833333333363, 1213.583333333336, 1214.3833333333364, 1214.4333333333363, 1213.833333333337, 1213.6333333333366, 1213.8333333333355, 1213.933333333336, 1213.2833333333365, 1214.533333333336, 1213.4333333333357, 1215.1833333333366, 1213.8333333333364, 1213.9833333333356, 1214.0333333333358, 1213.7833333333363, 1213.1833333333363, 1214.6833333333366, 1214.4333333333366, 1214.9333333333366, 1214.3333333333362, 1214.8333333333367, 1214.3833333333362, 1214.6833333333363, 1214.8833333333366, 1213.7333333333358, 1214.1333333333362, 1214.0333333333358, 1214.1333333333364, 1214.2833333333363, 1214.3833333333364, 1214.033333333336, 1212.9833333333363, 1212.9833333333365, 1214.5833333333362, 1213.9333333333363, 1214.7333333333363, 1213.1833333333366, 1214.1833333333363, 1213.9333333333361, 1214.7833333333365, 1213.833333333336, 1213.8833333333364, 1214.0833333333364, 1213.6333333333373, 1214.2333333333368, 1214.033333333336, 1213.4333333333363, 1213.7833333333365, 1214.3833333333364, 1213.8333333333364, 1214.2833333333365, 1214.5333333333363, 1214.2333333333365, 1214.5833333333367, 1213.3833333333366, 1214.1333333333357, 1215.3833333333364, 1214.0833333333362, 1213.783333333336, 1213.7833333333365, 1214.6333333333362, 1214.1833333333368, 1213.4833333333365, 1214.0833333333367, 1213.1833333333357, 1213.7333333333363, 1215.2833333333365, 1213.6833333333361, 1213.733333333337, 1214.0833333333364, 1214.9333333333363, 1214.7333333333363, 1213.7333333333365, 1214.533333333336, 1214.3333333333364, 1212.7833333333367, 1214.7833333333356, 1213.9333333333366, 1214.4833333333356, 1213.1833333333361, 1214.3333333333364, 1214.4833333333368, 1213.2833333333365, 1214.2833333333363, 1213.283333333336, 1212.933333333336, 1214.5333333333367, 1215.233333333336, 1213.533333333337]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24183783928658353, "mean_inference_ms": 2.0620164078608862, "mean_action_processing_ms": 0.0909556001134524, "mean_env_wait_ms": 1.5367321151538926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006457328796386719, "StateBufferConnector_ms": 0.0033011436462402344, "ViewRequirementAgentConnector_ms": 0.08593416213989258}, "num_episodes": 24, "episode_return_max": 1215.3833333333364, "episode_return_min": 1212.7833333333367, "episode_return_mean": 1214.0743333333364, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300150, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300150, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 243.18794659925464, "num_env_steps_trained_throughput_per_sec": 257.49311992862255, "timesteps_total": 300150, "num_env_steps_sampled_lifetime": 300150, "num_agent_steps_sampled_lifetime": 300150, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 300150, "timers": {"training_iteration_time_ms": 10325.902, "restore_workers_time_ms": 0.012, "training_step_time_ms": 625.407, "sample_time_ms": 609.204, "synch_weights_time_ms": 14.616}, "counters": {"num_env_steps_sampled": 300150, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300150, "num_agent_steps_trained": 300000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2001, "num_samples_added_to_queue": 300000}, "done": false, "training_iteration": 119, "trial_id": "27800_00000", "date": "2024-10-12_15-48-24", "timestamp": 1728744504, "time_this_iter_s": 10.50443172454834, "time_total_s": 1230.9738166332245, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486c36d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1230.9738166332245, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 16.413333333333334, "ram_util_percent": 56.053333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3116.2333984375, "policy_loss": -405.3557434082031, "entropy": 4.689217567443848, "entropy_coeff": 0.01, "var_gnorm": 18.108684539794922, "vf_loss": 353565.6875, "vf_explained_var": 0.6486896276473999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1008.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 302700, "num_env_steps_trained": 302400, "num_agent_steps_sampled": 302700, "num_agent_steps_trained": 302400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2018, "num_samples_added_to_queue": 302700, "learner_queue": {"size_count": 1008, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.271, "learner_load_time_ms": 0.228, "learner_load_wait_time_ms": 1188.343, "learner_dequeue_time_ms": 10191.011}}, "env_runners": {"episode_reward_max": 1215.3833333333364, "episode_reward_min": 1212.7833333333367, "episode_reward_mean": 1214.0943333333364, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.7833333333367}, "policy_reward_max": {"default_policy": 1215.3833333333364}, "policy_reward_mean": {"default_policy": 1214.0943333333364}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.1432, "num_moves_min": 0.0, "num_moves_max": 0.47, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.16282600000000003, "num_slav_min": 0.16196666666666665, "num_slav_max": 0.1637, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5380368966032358, "mean_cluster_cpu_util_min": 0.5358247609854753, "mean_cluster_cpu_util_max": 0.5396019029233314, "mean_cluster_mem_util_mean": 0.3416391139240506, "mean_cluster_mem_util_min": 0.34120253164556963, "mean_cluster_mem_util_max": 0.34209915611814345, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.44239, "reward_sla_mean_min": -2.4554999999999993, "reward_sla_mean_max": -2.4295, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.23899999999998, "reward_sla_sum_min": -245.54999999999995, "reward_sla_sum_max": -242.95, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5682.0, "global_timestep_min": 4000, "global_timestep_max": 7300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.6833333333366, 1214.4333333333366, 1214.9333333333366, 1214.3333333333362, 1214.8333333333367, 1214.3833333333362, 1214.6833333333363, 1214.8833333333366, 1213.7333333333358, 1214.1333333333362, 1214.0333333333358, 1214.1333333333364, 1214.2833333333363, 1214.3833333333364, 1214.033333333336, 1212.9833333333363, 1212.9833333333365, 1214.5833333333362, 1213.9333333333363, 1214.7333333333363, 1213.1833333333366, 1214.1833333333363, 1213.9333333333361, 1214.7833333333365, 1213.833333333336, 1213.8833333333364, 1214.0833333333364, 1213.6333333333373, 1214.2333333333368, 1214.033333333336, 1213.4333333333363, 1213.7833333333365, 1214.3833333333364, 1213.8333333333364, 1214.2833333333365, 1214.5333333333363, 1214.2333333333365, 1214.5833333333367, 1213.3833333333366, 1214.1333333333357, 1215.3833333333364, 1214.0833333333362, 1213.783333333336, 1213.7833333333365, 1214.6333333333362, 1214.1833333333368, 1213.4833333333365, 1214.0833333333367, 1213.1833333333357, 1213.7333333333363, 1215.2833333333365, 1213.6833333333361, 1213.733333333337, 1214.0833333333364, 1214.9333333333363, 1214.7333333333363, 1213.7333333333365, 1214.533333333336, 1214.3333333333364, 1212.7833333333367, 1214.7833333333356, 1213.9333333333366, 1214.4833333333356, 1213.1833333333361, 1214.3333333333364, 1214.4833333333368, 1213.2833333333365, 1214.2833333333363, 1213.283333333336, 1212.933333333336, 1214.5333333333367, 1215.233333333336, 1213.533333333337, 1214.033333333336, 1213.9333333333366, 1214.833333333337, 1213.683333333336, 1213.7833333333358, 1213.0833333333362, 1215.2833333333358, 1214.6833333333368, 1214.8833333333362, 1214.033333333336, 1213.9333333333361, 1213.7333333333363, 1212.933333333336, 1213.7833333333367, 1213.3333333333362, 1213.9833333333356, 1214.1333333333362, 1214.6833333333361, 1214.4333333333361, 1213.1833333333363, 1214.3833333333362, 1213.8833333333362, 1215.1833333333368, 1213.3833333333362, 1214.9833333333365, 1213.7833333333365, 1213.5333333333358], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.6833333333366, 1214.4333333333366, 1214.9333333333366, 1214.3333333333362, 1214.8333333333367, 1214.3833333333362, 1214.6833333333363, 1214.8833333333366, 1213.7333333333358, 1214.1333333333362, 1214.0333333333358, 1214.1333333333364, 1214.2833333333363, 1214.3833333333364, 1214.033333333336, 1212.9833333333363, 1212.9833333333365, 1214.5833333333362, 1213.9333333333363, 1214.7333333333363, 1213.1833333333366, 1214.1833333333363, 1213.9333333333361, 1214.7833333333365, 1213.833333333336, 1213.8833333333364, 1214.0833333333364, 1213.6333333333373, 1214.2333333333368, 1214.033333333336, 1213.4333333333363, 1213.7833333333365, 1214.3833333333364, 1213.8333333333364, 1214.2833333333365, 1214.5333333333363, 1214.2333333333365, 1214.5833333333367, 1213.3833333333366, 1214.1333333333357, 1215.3833333333364, 1214.0833333333362, 1213.783333333336, 1213.7833333333365, 1214.6333333333362, 1214.1833333333368, 1213.4833333333365, 1214.0833333333367, 1213.1833333333357, 1213.7333333333363, 1215.2833333333365, 1213.6833333333361, 1213.733333333337, 1214.0833333333364, 1214.9333333333363, 1214.7333333333363, 1213.7333333333365, 1214.533333333336, 1214.3333333333364, 1212.7833333333367, 1214.7833333333356, 1213.9333333333366, 1214.4833333333356, 1213.1833333333361, 1214.3333333333364, 1214.4833333333368, 1213.2833333333365, 1214.2833333333363, 1213.283333333336, 1212.933333333336, 1214.5333333333367, 1215.233333333336, 1213.533333333337, 1214.033333333336, 1213.9333333333366, 1214.833333333337, 1213.683333333336, 1213.7833333333358, 1213.0833333333362, 1215.2833333333358, 1214.6833333333368, 1214.8833333333362, 1214.033333333336, 1213.9333333333361, 1213.7333333333363, 1212.933333333336, 1213.7833333333367, 1213.3333333333362, 1213.9833333333356, 1214.1333333333362, 1214.6833333333361, 1214.4333333333361, 1213.1833333333363, 1214.3833333333362, 1213.8833333333362, 1215.1833333333368, 1213.3833333333362, 1214.9833333333365, 1213.7833333333365, 1213.5333333333358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2418428735690599, "mean_inference_ms": 2.0606334600974177, "mean_action_processing_ms": 0.09094552294216207, "mean_env_wait_ms": 1.5364924445258048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069544315338134766, "StateBufferConnector_ms": 0.0033600330352783203, "ViewRequirementAgentConnector_ms": 0.0861668586730957}, "num_episodes": 27, "episode_return_max": 1215.3833333333364, "episode_return_min": 1212.7833333333367, "episode_return_mean": 1214.0943333333364, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 302700, "num_agent_steps_trained": 302400, "num_env_steps_sampled": 302700, "num_env_steps_trained": 302400, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 241.308779005431, "num_env_steps_trained_throughput_per_sec": 227.114144946288, "timesteps_total": 302700, "num_env_steps_sampled_lifetime": 302700, "num_agent_steps_sampled_lifetime": 302700, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 302700, "timers": {"training_iteration_time_ms": 10342.204, "restore_workers_time_ms": 0.016, "training_step_time_ms": 619.107, "sample_time_ms": 603.214, "synch_weights_time_ms": 14.287}, "counters": {"num_env_steps_sampled": 302700, "num_env_steps_trained": 302400, "num_agent_steps_sampled": 302700, "num_agent_steps_trained": 302400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2018, "num_samples_added_to_queue": 302700}, "done": false, "training_iteration": 120, "trial_id": "27800_00000", "date": "2024-10-12_15-48-35", "timestamp": 1728744515, "time_this_iter_s": 10.578423500061035, "time_total_s": 1241.5522401332855, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a945ee2770>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1241.5522401332855, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 16.459999999999997, "ram_util_percent": 56.106666666666676}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4165.13671875, "policy_loss": 548.7528076171875, "entropy": 4.436302661895752, "entropy_coeff": 0.01, "var_gnorm": 18.099470138549805, "vf_loss": 362969.28125, "vf_explained_var": 0.6647909879684448}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1017.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 305250, "num_env_steps_trained": 305100, "num_agent_steps_sampled": 305250, "num_agent_steps_trained": 305100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2035, "num_samples_added_to_queue": 305100, "learner_queue": {"size_count": 1017, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.183, "learner_load_time_ms": 0.162, "learner_load_wait_time_ms": 1182.569, "learner_dequeue_time_ms": 10176.704}}, "env_runners": {"episode_reward_max": 1215.3833333333364, "episode_reward_min": 1212.5833333333367, "episode_reward_mean": 1214.0838333333363, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.5833333333367}, "policy_reward_max": {"default_policy": 1215.3833333333364}, "policy_reward_mean": {"default_policy": 1214.0838333333363}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.16260000000000002, "num_moves_min": 0.0, "num_moves_max": 0.47, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0006, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.162833, "num_slav_min": 0.16196666666666665, "num_slav_max": 0.16383333333333336, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5380096934179077, "mean_cluster_cpu_util_min": 0.5360724168045596, "mean_cluster_cpu_util_max": 0.5396019029233314, "mean_cluster_mem_util_mean": 0.34163848101265815, "mean_cluster_mem_util_min": 0.3412267932489452, "mean_cluster_mem_util_max": 0.34209915611814345, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4424949999999996, "reward_sla_mean_min": -2.4574999999999996, "reward_sla_mean_max": -2.4295, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.2495, "reward_sla_sum_min": -245.74999999999997, "reward_sla_sum_max": -242.95, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5781.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.833333333336, 1213.8833333333364, 1214.0833333333364, 1213.6333333333373, 1214.2333333333368, 1214.033333333336, 1213.4333333333363, 1213.7833333333365, 1214.3833333333364, 1213.8333333333364, 1214.2833333333365, 1214.5333333333363, 1214.2333333333365, 1214.5833333333367, 1213.3833333333366, 1214.1333333333357, 1215.3833333333364, 1214.0833333333362, 1213.783333333336, 1213.7833333333365, 1214.6333333333362, 1214.1833333333368, 1213.4833333333365, 1214.0833333333367, 1213.1833333333357, 1213.7333333333363, 1215.2833333333365, 1213.6833333333361, 1213.733333333337, 1214.0833333333364, 1214.9333333333363, 1214.7333333333363, 1213.7333333333365, 1214.533333333336, 1214.3333333333364, 1212.7833333333367, 1214.7833333333356, 1213.9333333333366, 1214.4833333333356, 1213.1833333333361, 1214.3333333333364, 1214.4833333333368, 1213.2833333333365, 1214.2833333333363, 1213.283333333336, 1212.933333333336, 1214.5333333333367, 1215.233333333336, 1213.533333333337, 1214.033333333336, 1213.9333333333366, 1214.833333333337, 1213.683333333336, 1213.7833333333358, 1213.0833333333362, 1215.2833333333358, 1214.6833333333368, 1214.8833333333362, 1214.033333333336, 1213.9333333333361, 1213.7333333333363, 1212.933333333336, 1213.7833333333367, 1213.3333333333362, 1213.9833333333356, 1214.1333333333362, 1214.6833333333361, 1214.4333333333361, 1213.1833333333363, 1214.3833333333362, 1213.8833333333362, 1215.1833333333368, 1213.3833333333362, 1214.9833333333365, 1213.7833333333365, 1213.5333333333358, 1212.5833333333367, 1214.8333333333364, 1214.5333333333353, 1214.7333333333354, 1214.283333333336, 1215.1333333333364, 1213.3833333333353, 1214.6333333333362, 1213.9833333333358, 1213.8333333333358, 1213.3833333333364, 1214.0333333333356, 1214.7333333333363, 1213.3333333333362, 1214.833333333337, 1214.4833333333368, 1214.8333333333362, 1214.433333333336, 1214.3833333333357, 1213.8333333333362, 1214.2333333333358, 1213.1833333333361, 1213.8333333333364, 1214.6833333333363], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.833333333336, 1213.8833333333364, 1214.0833333333364, 1213.6333333333373, 1214.2333333333368, 1214.033333333336, 1213.4333333333363, 1213.7833333333365, 1214.3833333333364, 1213.8333333333364, 1214.2833333333365, 1214.5333333333363, 1214.2333333333365, 1214.5833333333367, 1213.3833333333366, 1214.1333333333357, 1215.3833333333364, 1214.0833333333362, 1213.783333333336, 1213.7833333333365, 1214.6333333333362, 1214.1833333333368, 1213.4833333333365, 1214.0833333333367, 1213.1833333333357, 1213.7333333333363, 1215.2833333333365, 1213.6833333333361, 1213.733333333337, 1214.0833333333364, 1214.9333333333363, 1214.7333333333363, 1213.7333333333365, 1214.533333333336, 1214.3333333333364, 1212.7833333333367, 1214.7833333333356, 1213.9333333333366, 1214.4833333333356, 1213.1833333333361, 1214.3333333333364, 1214.4833333333368, 1213.2833333333365, 1214.2833333333363, 1213.283333333336, 1212.933333333336, 1214.5333333333367, 1215.233333333336, 1213.533333333337, 1214.033333333336, 1213.9333333333366, 1214.833333333337, 1213.683333333336, 1213.7833333333358, 1213.0833333333362, 1215.2833333333358, 1214.6833333333368, 1214.8833333333362, 1214.033333333336, 1213.9333333333361, 1213.7333333333363, 1212.933333333336, 1213.7833333333367, 1213.3333333333362, 1213.9833333333356, 1214.1333333333362, 1214.6833333333361, 1214.4333333333361, 1213.1833333333363, 1214.3833333333362, 1213.8833333333362, 1215.1833333333368, 1213.3833333333362, 1214.9833333333365, 1213.7833333333365, 1213.5333333333358, 1212.5833333333367, 1214.8333333333364, 1214.5333333333353, 1214.7333333333354, 1214.283333333336, 1215.1333333333364, 1213.3833333333353, 1214.6333333333362, 1213.9833333333358, 1213.8333333333358, 1213.3833333333364, 1214.0333333333356, 1214.7333333333363, 1213.3333333333362, 1214.833333333337, 1214.4833333333368, 1214.8333333333362, 1214.433333333336, 1214.3833333333357, 1213.8333333333362, 1214.2333333333358, 1213.1833333333361, 1213.8333333333364, 1214.6833333333363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24191403337130524, "mean_inference_ms": 2.0624098081186344, "mean_action_processing_ms": 0.09096975653316956, "mean_env_wait_ms": 1.5369990950691936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007019996643066406, "StateBufferConnector_ms": 0.0033600330352783203, "ViewRequirementAgentConnector_ms": 0.08620262145996094}, "num_episodes": 24, "episode_return_max": 1215.3833333333364, "episode_return_min": 1212.5833333333367, "episode_return_mean": 1214.0838333333363, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 305250, "num_agent_steps_trained": 305100, "num_env_steps_sampled": 305250, "num_env_steps_trained": 305100, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 242.3577032607593, "num_env_steps_trained_throughput_per_sec": 256.61403874668633, "timesteps_total": 305250, "num_env_steps_sampled_lifetime": 305250, "num_agent_steps_sampled_lifetime": 305250, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 305250, "timers": {"training_iteration_time_ms": 10381.027, "restore_workers_time_ms": 0.014, "training_step_time_ms": 622.193, "sample_time_ms": 606.109, "synch_weights_time_ms": 14.581}, "counters": {"num_env_steps_sampled": 305250, "num_env_steps_trained": 305100, "num_agent_steps_sampled": 305250, "num_agent_steps_trained": 305100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2035, "num_samples_added_to_queue": 305100}, "done": false, "training_iteration": 121, "trial_id": "27800_00000", "date": "2024-10-12_15-48-45", "timestamp": 1728744525, "time_this_iter_s": 10.533110857009888, "time_total_s": 1252.0853509902954, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b45ab0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1252.0853509902954, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 16.56, "ram_util_percent": 56.36666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3877.451416015625, "policy_loss": -40.62200927734375, "entropy": 4.421362400054932, "entropy_coeff": 0.01, "var_gnorm": 18.08632469177246, "vf_loss": 393133.75, "vf_explained_var": 0.6449055671691895}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1024.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 307500, "num_env_steps_trained": 307200, "num_agent_steps_sampled": 307500, "num_agent_steps_trained": 307200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2050, "num_samples_added_to_queue": 307500, "learner_queue": {"size_count": 1024, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.261, "learner_load_time_ms": 0.191, "learner_load_wait_time_ms": 1281.828, "learner_dequeue_time_ms": 10253.44}}, "env_runners": {"episode_reward_max": 1215.4333333333361, "episode_reward_min": 1212.5833333333367, "episode_reward_mean": 1214.083333333336, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.5833333333367}, "policy_reward_max": {"default_policy": 1215.4333333333361}, "policy_reward_mean": {"default_policy": 1214.083333333336}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.1582, "num_moves_min": 0.0, "num_moves_max": 0.47, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0006, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16283333333333336, "num_slav_min": 0.16193333333333332, "num_slav_max": 0.16383333333333336, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5379556917631918, "mean_cluster_cpu_util_min": 0.5360724168045596, "mean_cluster_cpu_util_max": 0.5394830161794448, "mean_cluster_mem_util_mean": 0.34162253164556966, "mean_cluster_mem_util_min": 0.341129746835443, "mean_cluster_mem_util_max": 0.341987341772152, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4425, "reward_sla_mean_min": -2.4574999999999996, "reward_sla_mean_max": -2.4290000000000003, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.25000000000003, "reward_sla_sum_min": -245.74999999999997, "reward_sla_sum_max": -242.9, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4709.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.1833333333357, 1213.7333333333363, 1215.2833333333365, 1213.6833333333361, 1213.733333333337, 1214.0833333333364, 1214.9333333333363, 1214.7333333333363, 1213.7333333333365, 1214.533333333336, 1214.3333333333364, 1212.7833333333367, 1214.7833333333356, 1213.9333333333366, 1214.4833333333356, 1213.1833333333361, 1214.3333333333364, 1214.4833333333368, 1213.2833333333365, 1214.2833333333363, 1213.283333333336, 1212.933333333336, 1214.5333333333367, 1215.233333333336, 1213.533333333337, 1214.033333333336, 1213.9333333333366, 1214.833333333337, 1213.683333333336, 1213.7833333333358, 1213.0833333333362, 1215.2833333333358, 1214.6833333333368, 1214.8833333333362, 1214.033333333336, 1213.9333333333361, 1213.7333333333363, 1212.933333333336, 1213.7833333333367, 1213.3333333333362, 1213.9833333333356, 1214.1333333333362, 1214.6833333333361, 1214.4333333333361, 1213.1833333333363, 1214.3833333333362, 1213.8833333333362, 1215.1833333333368, 1213.3833333333362, 1214.9833333333365, 1213.7833333333365, 1213.5333333333358, 1212.5833333333367, 1214.8333333333364, 1214.5333333333353, 1214.7333333333354, 1214.283333333336, 1215.1333333333364, 1213.3833333333353, 1214.6333333333362, 1213.9833333333358, 1213.8333333333358, 1213.3833333333364, 1214.0333333333356, 1214.7333333333363, 1213.3333333333362, 1214.833333333337, 1214.4833333333368, 1214.8333333333362, 1214.433333333336, 1214.3833333333357, 1213.8333333333362, 1214.2333333333358, 1213.1833333333361, 1213.8333333333364, 1214.6833333333363, 1213.583333333336, 1213.083333333337, 1212.9833333333363, 1214.5333333333363, 1214.2333333333368, 1213.9833333333365, 1213.5833333333362, 1214.8833333333355, 1214.6833333333361, 1213.783333333336, 1215.4333333333361, 1214.6333333333362, 1214.7833333333363, 1213.8333333333358, 1214.0333333333356, 1214.1833333333363, 1213.6833333333366, 1214.233333333336, 1214.183333333337, 1212.933333333337, 1214.1833333333363, 1213.6333333333366, 1214.6333333333366, 1213.933333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.1833333333357, 1213.7333333333363, 1215.2833333333365, 1213.6833333333361, 1213.733333333337, 1214.0833333333364, 1214.9333333333363, 1214.7333333333363, 1213.7333333333365, 1214.533333333336, 1214.3333333333364, 1212.7833333333367, 1214.7833333333356, 1213.9333333333366, 1214.4833333333356, 1213.1833333333361, 1214.3333333333364, 1214.4833333333368, 1213.2833333333365, 1214.2833333333363, 1213.283333333336, 1212.933333333336, 1214.5333333333367, 1215.233333333336, 1213.533333333337, 1214.033333333336, 1213.9333333333366, 1214.833333333337, 1213.683333333336, 1213.7833333333358, 1213.0833333333362, 1215.2833333333358, 1214.6833333333368, 1214.8833333333362, 1214.033333333336, 1213.9333333333361, 1213.7333333333363, 1212.933333333336, 1213.7833333333367, 1213.3333333333362, 1213.9833333333356, 1214.1333333333362, 1214.6833333333361, 1214.4333333333361, 1213.1833333333363, 1214.3833333333362, 1213.8833333333362, 1215.1833333333368, 1213.3833333333362, 1214.9833333333365, 1213.7833333333365, 1213.5333333333358, 1212.5833333333367, 1214.8333333333364, 1214.5333333333353, 1214.7333333333354, 1214.283333333336, 1215.1333333333364, 1213.3833333333353, 1214.6333333333362, 1213.9833333333358, 1213.8333333333358, 1213.3833333333364, 1214.0333333333356, 1214.7333333333363, 1213.3333333333362, 1214.833333333337, 1214.4833333333368, 1214.8333333333362, 1214.433333333336, 1214.3833333333357, 1213.8333333333362, 1214.2333333333358, 1213.1833333333361, 1213.8333333333364, 1214.6833333333363, 1213.583333333336, 1213.083333333337, 1212.9833333333363, 1214.5333333333363, 1214.2333333333368, 1213.9833333333365, 1213.5833333333362, 1214.8833333333355, 1214.6833333333361, 1213.783333333336, 1215.4333333333361, 1214.6333333333362, 1214.7833333333363, 1213.8333333333358, 1214.0333333333356, 1214.1833333333363, 1213.6833333333366, 1214.233333333336, 1214.183333333337, 1212.933333333337, 1214.1833333333363, 1213.6333333333366, 1214.6333333333366, 1213.933333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24196528111318805, "mean_inference_ms": 2.063001239906108, "mean_action_processing_ms": 0.09098692114465301, "mean_env_wait_ms": 1.5373145364770295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0071489810943603516, "StateBufferConnector_ms": 0.003446817398071289, "ViewRequirementAgentConnector_ms": 0.08779120445251465}, "num_episodes": 24, "episode_return_max": 1215.4333333333361, "episode_return_min": 1212.5833333333367, "episode_return_mean": 1214.083333333336, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 307500, "num_agent_steps_trained": 307200, "num_env_steps_sampled": 307500, "num_env_steps_trained": 307200, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 219.45406418584153, "num_env_steps_trained_throughput_per_sec": 204.82379324011876, "timesteps_total": 307500, "num_env_steps_sampled_lifetime": 307500, "num_agent_steps_sampled_lifetime": 307500, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 307500, "timers": {"training_iteration_time_ms": 10398.787, "restore_workers_time_ms": 0.014, "training_step_time_ms": 710.008, "sample_time_ms": 693.311, "synch_weights_time_ms": 15.182}, "counters": {"num_env_steps_sampled": 307500, "num_env_steps_trained": 307200, "num_agent_steps_sampled": 307500, "num_agent_steps_trained": 307200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2050, "num_samples_added_to_queue": 307500}, "done": false, "training_iteration": 122, "trial_id": "27800_00000", "date": "2024-10-12_15-48-55", "timestamp": 1728744535, "time_this_iter_s": 10.26992678642273, "time_total_s": 1262.3552777767181, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9489516c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1262.3552777767181, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 19.560000000000006, "ram_util_percent": 56.96}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3920.552978515625, "policy_loss": 314.9136962890625, "entropy": 4.572056293487549, "entropy_coeff": 0.01, "var_gnorm": 18.06024932861328, "vf_loss": 361935.5625, "vf_explained_var": 0.64577716588974}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1032.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 309900, "num_env_steps_trained": 309600, "num_agent_steps_sampled": 309900, "num_agent_steps_trained": 309600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2066, "num_samples_added_to_queue": 309900, "learner_queue": {"size_count": 1032, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.324, "learner_load_time_ms": 0.201, "learner_load_wait_time_ms": 1219.804, "learner_dequeue_time_ms": 10275.179}}, "env_runners": {"episode_reward_max": 1215.4333333333361, "episode_reward_min": 1212.2833333333367, "episode_reward_mean": 1214.063833333336, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.2833333333367}, "policy_reward_max": {"default_policy": 1215.4333333333361}, "policy_reward_mean": {"default_policy": 1214.063833333336}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.11020000000000002, "num_moves_min": 0.0, "num_moves_max": 0.38, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0006, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16284633333333334, "num_slav_min": 0.16193333333333332, "num_slav_max": 0.16403333333333334, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.537958510410921, "mean_cluster_cpu_util_min": 0.5358358498804927, "mean_cluster_cpu_util_max": 0.5393839975179262, "mean_cluster_mem_util_mean": 0.3416318143459916, "mean_cluster_mem_util_min": 0.341129746835443, "mean_cluster_mem_util_max": 0.341987341772152, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.442694999999999, "reward_sla_mean_min": -2.4604999999999997, "reward_sla_mean_max": -2.4290000000000003, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.2695, "reward_sla_sum_min": -246.04999999999995, "reward_sla_sum_max": -242.9, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3637.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.533333333337, 1214.033333333336, 1213.9333333333366, 1214.833333333337, 1213.683333333336, 1213.7833333333358, 1213.0833333333362, 1215.2833333333358, 1214.6833333333368, 1214.8833333333362, 1214.033333333336, 1213.9333333333361, 1213.7333333333363, 1212.933333333336, 1213.7833333333367, 1213.3333333333362, 1213.9833333333356, 1214.1333333333362, 1214.6833333333361, 1214.4333333333361, 1213.1833333333363, 1214.3833333333362, 1213.8833333333362, 1215.1833333333368, 1213.3833333333362, 1214.9833333333365, 1213.7833333333365, 1213.5333333333358, 1212.5833333333367, 1214.8333333333364, 1214.5333333333353, 1214.7333333333354, 1214.283333333336, 1215.1333333333364, 1213.3833333333353, 1214.6333333333362, 1213.9833333333358, 1213.8333333333358, 1213.3833333333364, 1214.0333333333356, 1214.7333333333363, 1213.3333333333362, 1214.833333333337, 1214.4833333333368, 1214.8333333333362, 1214.433333333336, 1214.3833333333357, 1213.8333333333362, 1214.2333333333358, 1213.1833333333361, 1213.8333333333364, 1214.6833333333363, 1213.583333333336, 1213.083333333337, 1212.9833333333363, 1214.5333333333363, 1214.2333333333368, 1213.9833333333365, 1213.5833333333362, 1214.8833333333355, 1214.6833333333361, 1213.783333333336, 1215.4333333333361, 1214.6333333333362, 1214.7833333333363, 1213.8333333333358, 1214.0333333333356, 1214.1833333333363, 1213.6833333333366, 1214.233333333336, 1214.183333333337, 1212.933333333337, 1214.1833333333363, 1213.6333333333366, 1214.6333333333366, 1213.933333333336, 1214.0333333333358, 1213.533333333336, 1215.133333333336, 1214.4333333333361, 1213.6833333333366, 1213.333333333336, 1214.083333333336, 1213.4833333333354, 1214.2833333333356, 1213.9833333333363, 1214.2333333333365, 1213.7333333333356, 1213.9333333333366, 1214.5833333333362, 1213.9833333333363, 1214.6333333333362, 1214.4333333333366, 1213.0333333333363, 1214.533333333337, 1214.0833333333358, 1212.2833333333367, 1213.3333333333362, 1214.5833333333358, 1214.1833333333361], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.533333333337, 1214.033333333336, 1213.9333333333366, 1214.833333333337, 1213.683333333336, 1213.7833333333358, 1213.0833333333362, 1215.2833333333358, 1214.6833333333368, 1214.8833333333362, 1214.033333333336, 1213.9333333333361, 1213.7333333333363, 1212.933333333336, 1213.7833333333367, 1213.3333333333362, 1213.9833333333356, 1214.1333333333362, 1214.6833333333361, 1214.4333333333361, 1213.1833333333363, 1214.3833333333362, 1213.8833333333362, 1215.1833333333368, 1213.3833333333362, 1214.9833333333365, 1213.7833333333365, 1213.5333333333358, 1212.5833333333367, 1214.8333333333364, 1214.5333333333353, 1214.7333333333354, 1214.283333333336, 1215.1333333333364, 1213.3833333333353, 1214.6333333333362, 1213.9833333333358, 1213.8333333333358, 1213.3833333333364, 1214.0333333333356, 1214.7333333333363, 1213.3333333333362, 1214.833333333337, 1214.4833333333368, 1214.8333333333362, 1214.433333333336, 1214.3833333333357, 1213.8333333333362, 1214.2333333333358, 1213.1833333333361, 1213.8333333333364, 1214.6833333333363, 1213.583333333336, 1213.083333333337, 1212.9833333333363, 1214.5333333333363, 1214.2333333333368, 1213.9833333333365, 1213.5833333333362, 1214.8833333333355, 1214.6833333333361, 1213.783333333336, 1215.4333333333361, 1214.6333333333362, 1214.7833333333363, 1213.8333333333358, 1214.0333333333356, 1214.1833333333363, 1213.6833333333366, 1214.233333333336, 1214.183333333337, 1212.933333333337, 1214.1833333333363, 1213.6333333333366, 1214.6333333333366, 1213.933333333336, 1214.0333333333358, 1213.533333333336, 1215.133333333336, 1214.4333333333361, 1213.6833333333366, 1213.333333333336, 1214.083333333336, 1213.4833333333354, 1214.2833333333356, 1213.9833333333363, 1214.2333333333365, 1213.7333333333356, 1213.9333333333366, 1214.5833333333362, 1213.9833333333363, 1214.6333333333362, 1214.4333333333366, 1213.0333333333363, 1214.533333333337, 1214.0833333333358, 1212.2833333333367, 1213.3333333333362, 1214.5833333333358, 1214.1833333333361]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24202391354590436, "mean_inference_ms": 2.0636897000718046, "mean_action_processing_ms": 0.09100828718622467, "mean_env_wait_ms": 1.5376868522176925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007126808166503906, "StateBufferConnector_ms": 0.003464937210083008, "ViewRequirementAgentConnector_ms": 0.08773088455200195}, "num_episodes": 24, "episode_return_max": 1215.4333333333361, "episode_return_min": 1212.2833333333367, "episode_return_mean": 1214.063833333336, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 309900, "num_agent_steps_trained": 309600, "num_env_steps_sampled": 309900, "num_env_steps_trained": 309600, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 236.41988497161162, "num_env_steps_trained_throughput_per_sec": 236.41988497161162, "timesteps_total": 309900, "num_env_steps_sampled_lifetime": 309900, "num_agent_steps_sampled_lifetime": 309900, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 309900, "timers": {"training_iteration_time_ms": 10358.027, "restore_workers_time_ms": 0.013, "training_step_time_ms": 636.272, "sample_time_ms": 619.267, "synch_weights_time_ms": 15.429}, "counters": {"num_env_steps_sampled": 309900, "num_env_steps_trained": 309600, "num_agent_steps_sampled": 309900, "num_agent_steps_trained": 309600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2066, "num_samples_added_to_queue": 309900}, "done": false, "training_iteration": 123, "trial_id": "27800_00000", "date": "2024-10-12_15-49-06", "timestamp": 1728744546, "time_this_iter_s": 10.162697076797485, "time_total_s": 1272.5179748535156, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948952650>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1272.5179748535156, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 16.439999999999998, "ram_util_percent": 57.399999999999984}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4810.54931640625, "policy_loss": 1030.8154296875, "entropy": 4.966526031494141, "entropy_coeff": 0.01, "var_gnorm": 18.036334991455078, "vf_loss": 379463.34375, "vf_explained_var": 0.6293907165527344}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1040.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 312300, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312300, "num_agent_steps_trained": 312000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2082, "num_samples_added_to_queue": 312300, "learner_queue": {"size_count": 1040, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.196, "learner_load_time_ms": 0.231, "learner_load_wait_time_ms": 1200.12, "learner_dequeue_time_ms": 10172.116}}, "env_runners": {"episode_reward_max": 1215.4333333333361, "episode_reward_min": 1212.2833333333367, "episode_reward_mean": 1214.0733333333364, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.2833333333367}, "policy_reward_max": {"default_policy": 1215.4333333333361}, "policy_reward_mean": {"default_policy": 1214.0733333333364}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.1588, "num_moves_min": 0.0, "num_moves_max": 0.62, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0006, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16284, "num_slav_min": 0.16193333333333332, "num_slav_max": 0.16403333333333334, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5379604183903292, "mean_cluster_cpu_util_min": 0.5358358498804927, "mean_cluster_cpu_util_max": 0.5405637525280383, "mean_cluster_mem_util_mean": 0.3416400316455696, "mean_cluster_mem_util_min": 0.341129746835443, "mean_cluster_mem_util_max": 0.34217510548523195, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4425999999999997, "reward_sla_mean_min": -2.4604999999999997, "reward_sla_mean_max": -2.4290000000000003, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.25999999999996, "reward_sla_sum_min": -246.04999999999995, "reward_sla_sum_max": -242.9, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2560.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.3833333333362, 1214.9833333333365, 1213.7833333333365, 1213.5333333333358, 1212.5833333333367, 1214.8333333333364, 1214.5333333333353, 1214.7333333333354, 1214.283333333336, 1215.1333333333364, 1213.3833333333353, 1214.6333333333362, 1213.9833333333358, 1213.8333333333358, 1213.3833333333364, 1214.0333333333356, 1214.7333333333363, 1213.3333333333362, 1214.833333333337, 1214.4833333333368, 1214.8333333333362, 1214.433333333336, 1214.3833333333357, 1213.8333333333362, 1214.2333333333358, 1213.1833333333361, 1213.8333333333364, 1214.6833333333363, 1213.583333333336, 1213.083333333337, 1212.9833333333363, 1214.5333333333363, 1214.2333333333368, 1213.9833333333365, 1213.5833333333362, 1214.8833333333355, 1214.6833333333361, 1213.783333333336, 1215.4333333333361, 1214.6333333333362, 1214.7833333333363, 1213.8333333333358, 1214.0333333333356, 1214.1833333333363, 1213.6833333333366, 1214.233333333336, 1214.183333333337, 1212.933333333337, 1214.1833333333363, 1213.6333333333366, 1214.6333333333366, 1213.933333333336, 1214.0333333333358, 1213.533333333336, 1215.133333333336, 1214.4333333333361, 1213.6833333333366, 1213.333333333336, 1214.083333333336, 1213.4833333333354, 1214.2833333333356, 1213.9833333333363, 1214.2333333333365, 1213.7333333333356, 1213.9333333333366, 1214.5833333333362, 1213.9833333333363, 1214.6333333333362, 1214.4333333333366, 1213.0333333333363, 1214.533333333337, 1214.0833333333358, 1212.2833333333367, 1213.3333333333362, 1214.5833333333358, 1214.1833333333361, 1214.0833333333362, 1215.2833333333363, 1214.8833333333369, 1213.9833333333363, 1214.7833333333363, 1212.8333333333364, 1214.6833333333363, 1213.5833333333364, 1213.4833333333363, 1215.0833333333358, 1214.6833333333363, 1214.3833333333366, 1212.7333333333358, 1214.2333333333358, 1214.1833333333363, 1213.9333333333366, 1214.4833333333363, 1212.3333333333362, 1212.8333333333367, 1213.7833333333358, 1215.0833333333367, 1215.1333333333364, 1214.3333333333364, 1213.483333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.3833333333362, 1214.9833333333365, 1213.7833333333365, 1213.5333333333358, 1212.5833333333367, 1214.8333333333364, 1214.5333333333353, 1214.7333333333354, 1214.283333333336, 1215.1333333333364, 1213.3833333333353, 1214.6333333333362, 1213.9833333333358, 1213.8333333333358, 1213.3833333333364, 1214.0333333333356, 1214.7333333333363, 1213.3333333333362, 1214.833333333337, 1214.4833333333368, 1214.8333333333362, 1214.433333333336, 1214.3833333333357, 1213.8333333333362, 1214.2333333333358, 1213.1833333333361, 1213.8333333333364, 1214.6833333333363, 1213.583333333336, 1213.083333333337, 1212.9833333333363, 1214.5333333333363, 1214.2333333333368, 1213.9833333333365, 1213.5833333333362, 1214.8833333333355, 1214.6833333333361, 1213.783333333336, 1215.4333333333361, 1214.6333333333362, 1214.7833333333363, 1213.8333333333358, 1214.0333333333356, 1214.1833333333363, 1213.6833333333366, 1214.233333333336, 1214.183333333337, 1212.933333333337, 1214.1833333333363, 1213.6333333333366, 1214.6333333333366, 1213.933333333336, 1214.0333333333358, 1213.533333333336, 1215.133333333336, 1214.4333333333361, 1213.6833333333366, 1213.333333333336, 1214.083333333336, 1213.4833333333354, 1214.2833333333356, 1213.9833333333363, 1214.2333333333365, 1213.7333333333356, 1213.9333333333366, 1214.5833333333362, 1213.9833333333363, 1214.6333333333362, 1214.4333333333366, 1213.0333333333363, 1214.533333333337, 1214.0833333333358, 1212.2833333333367, 1213.3333333333362, 1214.5833333333358, 1214.1833333333361, 1214.0833333333362, 1215.2833333333363, 1214.8833333333369, 1213.9833333333363, 1214.7833333333363, 1212.8333333333364, 1214.6833333333363, 1213.5833333333364, 1213.4833333333363, 1215.0833333333358, 1214.6833333333363, 1214.3833333333366, 1212.7333333333358, 1214.2333333333358, 1214.1833333333363, 1213.9333333333366, 1214.4833333333363, 1212.3333333333362, 1212.8333333333367, 1213.7833333333358, 1215.0833333333367, 1215.1333333333364, 1214.3333333333364, 1213.483333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2420518903313581, "mean_inference_ms": 2.062399700888836, "mean_action_processing_ms": 0.09101369051697122, "mean_env_wait_ms": 1.5376108883015194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006803035736083984, "StateBufferConnector_ms": 0.0034372806549072266, "ViewRequirementAgentConnector_ms": 0.08798003196716309}, "num_episodes": 24, "episode_return_max": 1215.4333333333361, "episode_return_min": 1212.2833333333367, "episode_return_mean": 1214.0733333333364, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312300, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312300, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 238.18227398417085, "num_env_steps_trained_throughput_per_sec": 238.18227398417085, "timesteps_total": 312300, "num_env_steps_sampled_lifetime": 312300, "num_agent_steps_sampled_lifetime": 312300, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 312300, "timers": {"training_iteration_time_ms": 10318.05, "restore_workers_time_ms": 0.014, "training_step_time_ms": 627.093, "sample_time_ms": 611.319, "synch_weights_time_ms": 14.248}, "counters": {"num_env_steps_sampled": 312300, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312300, "num_agent_steps_trained": 312000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2082, "num_samples_added_to_queue": 312300}, "done": false, "training_iteration": 124, "trial_id": "27800_00000", "date": "2024-10-12_15-49-16", "timestamp": 1728744556, "time_this_iter_s": 10.08670163154602, "time_total_s": 1282.6046764850616, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c0340>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1282.6046764850616, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 16.428571428571427, "ram_util_percent": 57.49285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3347.7421875, "policy_loss": 178.033935546875, "entropy": 4.789275646209717, "entropy_coeff": 0.01, "var_gnorm": 18.030864715576172, "vf_loss": 318407.625, "vf_explained_var": 0.6578591465950012}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1049.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 314850, "num_env_steps_trained": 314700, "num_agent_steps_sampled": 314850, "num_agent_steps_trained": 314700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2099, "num_samples_added_to_queue": 314700, "learner_queue": {"size_count": 1049, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 72.137, "learner_load_time_ms": 0.24, "learner_load_wait_time_ms": 1185.1, "learner_dequeue_time_ms": 10105.197}}, "env_runners": {"episode_reward_max": 1215.4333333333361, "episode_reward_min": 1212.2833333333367, "episode_reward_mean": 1214.0497500000029, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.2833333333367}, "policy_reward_max": {"default_policy": 1215.4333333333361}, "policy_reward_mean": {"default_policy": 1214.0497500000029}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2386, "num_moves_min": 0.0, "num_moves_max": 0.62, "mean_accuracy_mean": 43.63327, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0004, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.1628501666666667, "num_slav_min": 0.16161666666666666, "num_slav_max": 0.16403333333333334, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5380302235015628, "mean_cluster_cpu_util_min": 0.5358358498804927, "mean_cluster_cpu_util_max": 0.5405637525280383, "mean_cluster_mem_util_mean": 0.3416315189873418, "mean_cluster_mem_util_min": 0.341129746835443, "mean_cluster_mem_util_max": 0.34217510548523195, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4427524999999997, "reward_sla_mean_min": -2.4604999999999997, "reward_sla_mean_max": -2.4242500000000002, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000028, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.27524999999997, "reward_sla_sum_min": -246.04999999999995, "reward_sla_sum_max": -242.425, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1956.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.2333333333358, 1213.1833333333361, 1213.8333333333364, 1214.6833333333363, 1213.583333333336, 1213.083333333337, 1212.9833333333363, 1214.5333333333363, 1214.2333333333368, 1213.9833333333365, 1213.5833333333362, 1214.8833333333355, 1214.6833333333361, 1213.783333333336, 1215.4333333333361, 1214.6333333333362, 1214.7833333333363, 1213.8333333333358, 1214.0333333333356, 1214.1833333333363, 1213.6833333333366, 1214.233333333336, 1214.183333333337, 1212.933333333337, 1214.1833333333363, 1213.6333333333366, 1214.6333333333366, 1213.933333333336, 1214.0333333333358, 1213.533333333336, 1215.133333333336, 1214.4333333333361, 1213.6833333333366, 1213.333333333336, 1214.083333333336, 1213.4833333333354, 1214.2833333333356, 1213.9833333333363, 1214.2333333333365, 1213.7333333333356, 1213.9333333333366, 1214.5833333333362, 1213.9833333333363, 1214.6333333333362, 1214.4333333333366, 1213.0333333333363, 1214.533333333337, 1214.0833333333358, 1212.2833333333367, 1213.3333333333362, 1214.5833333333358, 1214.1833333333361, 1214.0833333333362, 1215.2833333333363, 1214.8833333333369, 1213.9833333333363, 1214.7833333333363, 1212.8333333333364, 1214.6833333333363, 1213.5833333333364, 1213.4833333333363, 1215.0833333333358, 1214.6833333333363, 1214.3833333333366, 1212.7333333333358, 1214.2333333333358, 1214.1833333333363, 1213.9333333333366, 1214.4833333333363, 1212.3333333333362, 1212.8333333333367, 1213.7833333333358, 1215.0833333333367, 1215.1333333333364, 1214.3333333333364, 1213.483333333336, 1213.5833333333364, 1212.8333333333358, 1213.4333333333366, 1214.0333333333367, 1213.533333333336, 1214.2833333333363, 1214.0833333333362, 1214.7333333333368, 1214.9833333333368, 1213.8833333333369, 1213.033333333336, 1213.9333333333363, 1214.1833333333357, 1214.8833333333364, 1214.5333333333363, 1213.933333333336, 1215.1333333333362, 1213.1333333333355, 1213.8333333333362, 1213.8833333333364, 1213.7333333333365, 1214.5833333333362, 1215.0750000000035, 1214.2833333333365], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.2333333333358, 1213.1833333333361, 1213.8333333333364, 1214.6833333333363, 1213.583333333336, 1213.083333333337, 1212.9833333333363, 1214.5333333333363, 1214.2333333333368, 1213.9833333333365, 1213.5833333333362, 1214.8833333333355, 1214.6833333333361, 1213.783333333336, 1215.4333333333361, 1214.6333333333362, 1214.7833333333363, 1213.8333333333358, 1214.0333333333356, 1214.1833333333363, 1213.6833333333366, 1214.233333333336, 1214.183333333337, 1212.933333333337, 1214.1833333333363, 1213.6333333333366, 1214.6333333333366, 1213.933333333336, 1214.0333333333358, 1213.533333333336, 1215.133333333336, 1214.4333333333361, 1213.6833333333366, 1213.333333333336, 1214.083333333336, 1213.4833333333354, 1214.2833333333356, 1213.9833333333363, 1214.2333333333365, 1213.7333333333356, 1213.9333333333366, 1214.5833333333362, 1213.9833333333363, 1214.6333333333362, 1214.4333333333366, 1213.0333333333363, 1214.533333333337, 1214.0833333333358, 1212.2833333333367, 1213.3333333333362, 1214.5833333333358, 1214.1833333333361, 1214.0833333333362, 1215.2833333333363, 1214.8833333333369, 1213.9833333333363, 1214.7833333333363, 1212.8333333333364, 1214.6833333333363, 1213.5833333333364, 1213.4833333333363, 1215.0833333333358, 1214.6833333333363, 1214.3833333333366, 1212.7333333333358, 1214.2333333333358, 1214.1833333333363, 1213.9333333333366, 1214.4833333333363, 1212.3333333333362, 1212.8333333333367, 1213.7833333333358, 1215.0833333333367, 1215.1333333333364, 1214.3333333333364, 1213.483333333336, 1213.5833333333364, 1212.8333333333358, 1213.4333333333366, 1214.0333333333367, 1213.533333333336, 1214.2833333333363, 1214.0833333333362, 1214.7333333333368, 1214.9833333333368, 1213.8833333333369, 1213.033333333336, 1213.9333333333363, 1214.1833333333357, 1214.8833333333364, 1214.5333333333363, 1213.933333333336, 1215.1333333333362, 1213.1333333333355, 1213.8333333333362, 1213.8833333333364, 1213.7333333333365, 1214.5833333333362, 1215.0750000000035, 1214.2833333333365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24211944720407988, "mean_inference_ms": 2.063140582172842, "mean_action_processing_ms": 0.09104188853455085, "mean_env_wait_ms": 1.5380168900025633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00666356086730957, "StateBufferConnector_ms": 0.003456592559814453, "ViewRequirementAgentConnector_ms": 0.0883326530456543}, "num_episodes": 24, "episode_return_max": 1215.4333333333361, "episode_return_min": 1212.2833333333367, "episode_return_mean": 1214.0497500000029, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 314850, "num_agent_steps_trained": 314700, "num_env_steps_sampled": 314850, "num_env_steps_trained": 314700, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 240.2588561275282, "num_env_steps_trained_throughput_per_sec": 254.39173001738277, "timesteps_total": 314850, "num_env_steps_sampled_lifetime": 314850, "num_agent_steps_sampled_lifetime": 314850, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 314850, "timers": {"training_iteration_time_ms": 10363.19, "restore_workers_time_ms": 0.012, "training_step_time_ms": 629.348, "sample_time_ms": 613.371, "synch_weights_time_ms": 14.533}, "counters": {"num_env_steps_sampled": 314850, "num_env_steps_trained": 314700, "num_agent_steps_sampled": 314850, "num_agent_steps_trained": 314700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2099, "num_samples_added_to_queue": 314700}, "done": false, "training_iteration": 125, "trial_id": "27800_00000", "date": "2024-10-12_15-49-26", "timestamp": 1728744566, "time_this_iter_s": 10.632102251052856, "time_total_s": 1293.2367787361145, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c05b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1293.2367787361145, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 16.779999999999998, "ram_util_percent": 57.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4855.38427734375, "policy_loss": 996.749755859375, "entropy": 4.499505996704102, "entropy_coeff": 0.01, "var_gnorm": 18.037097930908203, "vf_loss": 387213.3125, "vf_explained_var": 0.6362080574035645}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1057.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 317400, "num_env_steps_trained": 317100, "num_agent_steps_sampled": 317400, "num_agent_steps_trained": 317100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2116, "num_samples_added_to_queue": 317400, "learner_queue": {"size_count": 1057, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.766, "learner_load_time_ms": 0.258, "learner_load_wait_time_ms": 1163.033, "learner_dequeue_time_ms": 10112.928}}, "env_runners": {"episode_reward_max": 1215.2833333333363, "episode_reward_min": 1212.2833333333367, "episode_reward_mean": 1214.0342500000029, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.2833333333367}, "policy_reward_max": {"default_policy": 1215.2833333333363}, "policy_reward_mean": {"default_policy": 1214.0342500000029}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.26270000000000004, "num_moves_min": 0.0, "num_moves_max": 0.62, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16286050000000002, "num_slav_min": 0.16161666666666666, "num_slav_max": 0.16403333333333334, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5381250182708218, "mean_cluster_cpu_util_min": 0.5358358498804927, "mean_cluster_cpu_util_max": 0.5405637525280383, "mean_cluster_mem_util_mean": 0.3416491666666666, "mean_cluster_mem_util_min": 0.34120675105485226, "mean_cluster_mem_util_max": 0.34217510548523195, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4429074999999996, "reward_sla_mean_min": -2.4604999999999997, "reward_sla_mean_max": -2.4242500000000002, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.29075, "reward_sla_sum_min": -246.04999999999995, "reward_sla_sum_max": -242.425, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2783.0, "global_timestep_min": 1100, "global_timestep_max": 4400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.933333333336, 1214.0333333333358, 1213.533333333336, 1215.133333333336, 1214.4333333333361, 1213.6833333333366, 1213.333333333336, 1214.083333333336, 1213.4833333333354, 1214.2833333333356, 1213.9833333333363, 1214.2333333333365, 1213.7333333333356, 1213.9333333333366, 1214.5833333333362, 1213.9833333333363, 1214.6333333333362, 1214.4333333333366, 1213.0333333333363, 1214.533333333337, 1214.0833333333358, 1212.2833333333367, 1213.3333333333362, 1214.5833333333358, 1214.1833333333361, 1214.0833333333362, 1215.2833333333363, 1214.8833333333369, 1213.9833333333363, 1214.7833333333363, 1212.8333333333364, 1214.6833333333363, 1213.5833333333364, 1213.4833333333363, 1215.0833333333358, 1214.6833333333363, 1214.3833333333366, 1212.7333333333358, 1214.2333333333358, 1214.1833333333363, 1213.9333333333366, 1214.4833333333363, 1212.3333333333362, 1212.8333333333367, 1213.7833333333358, 1215.0833333333367, 1215.1333333333364, 1214.3333333333364, 1213.483333333336, 1213.5833333333364, 1212.8333333333358, 1213.4333333333366, 1214.0333333333367, 1213.533333333336, 1214.2833333333363, 1214.0833333333362, 1214.7333333333368, 1214.9833333333368, 1213.8833333333369, 1213.033333333336, 1213.9333333333363, 1214.1833333333357, 1214.8833333333364, 1214.5333333333363, 1213.933333333336, 1215.1333333333362, 1213.1333333333355, 1213.8333333333362, 1213.8833333333364, 1213.7333333333365, 1214.5833333333362, 1215.0750000000035, 1214.2833333333365, 1212.7333333333356, 1213.083333333336, 1214.4833333333365, 1213.833333333337, 1213.2833333333363, 1213.6833333333363, 1214.633333333336, 1213.2333333333358, 1213.0333333333363, 1214.1833333333361, 1213.883333333336, 1213.9833333333365, 1213.833333333337, 1215.1333333333357, 1214.0333333333356, 1214.6833333333357, 1213.533333333337, 1214.433333333336, 1215.083333333336, 1215.233333333336, 1214.2333333333358, 1214.083333333337, 1213.2333333333356, 1214.8833333333366, 1213.7333333333363, 1214.433333333336, 1213.4833333333365], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.933333333336, 1214.0333333333358, 1213.533333333336, 1215.133333333336, 1214.4333333333361, 1213.6833333333366, 1213.333333333336, 1214.083333333336, 1213.4833333333354, 1214.2833333333356, 1213.9833333333363, 1214.2333333333365, 1213.7333333333356, 1213.9333333333366, 1214.5833333333362, 1213.9833333333363, 1214.6333333333362, 1214.4333333333366, 1213.0333333333363, 1214.533333333337, 1214.0833333333358, 1212.2833333333367, 1213.3333333333362, 1214.5833333333358, 1214.1833333333361, 1214.0833333333362, 1215.2833333333363, 1214.8833333333369, 1213.9833333333363, 1214.7833333333363, 1212.8333333333364, 1214.6833333333363, 1213.5833333333364, 1213.4833333333363, 1215.0833333333358, 1214.6833333333363, 1214.3833333333366, 1212.7333333333358, 1214.2333333333358, 1214.1833333333363, 1213.9333333333366, 1214.4833333333363, 1212.3333333333362, 1212.8333333333367, 1213.7833333333358, 1215.0833333333367, 1215.1333333333364, 1214.3333333333364, 1213.483333333336, 1213.5833333333364, 1212.8333333333358, 1213.4333333333366, 1214.0333333333367, 1213.533333333336, 1214.2833333333363, 1214.0833333333362, 1214.7333333333368, 1214.9833333333368, 1213.8833333333369, 1213.033333333336, 1213.9333333333363, 1214.1833333333357, 1214.8833333333364, 1214.5333333333363, 1213.933333333336, 1215.1333333333362, 1213.1333333333355, 1213.8333333333362, 1213.8833333333364, 1213.7333333333365, 1214.5833333333362, 1215.0750000000035, 1214.2833333333365, 1212.7333333333356, 1213.083333333336, 1214.4833333333365, 1213.833333333337, 1213.2833333333363, 1213.6833333333363, 1214.633333333336, 1213.2333333333358, 1213.0333333333363, 1214.1833333333361, 1213.883333333336, 1213.9833333333365, 1213.833333333337, 1215.1333333333357, 1214.0333333333356, 1214.6833333333357, 1213.533333333337, 1214.433333333336, 1215.083333333336, 1215.233333333336, 1214.2333333333358, 1214.083333333337, 1213.2333333333356, 1214.8833333333366, 1213.7333333333363, 1214.433333333336, 1213.4833333333365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.242201973692278, "mean_inference_ms": 2.0655111876217944, "mean_action_processing_ms": 0.09108276111640094, "mean_env_wait_ms": 1.5387541072571345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00654911994934082, "StateBufferConnector_ms": 0.003363370895385742, "ViewRequirementAgentConnector_ms": 0.08615851402282715}, "num_episodes": 27, "episode_return_max": 1215.2833333333363, "episode_return_min": 1212.2833333333367, "episode_return_mean": 1214.0342500000029, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 317400, "num_agent_steps_trained": 317100, "num_env_steps_sampled": 317400, "num_env_steps_trained": 317100, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 245.28113254992866, "num_env_steps_trained_throughput_per_sec": 230.85283063522698, "timesteps_total": 317400, "num_env_steps_sampled_lifetime": 317400, "num_agent_steps_sampled_lifetime": 317400, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 317400, "timers": {"training_iteration_time_ms": 10373.207, "restore_workers_time_ms": 0.014, "training_step_time_ms": 606.614, "sample_time_ms": 590.21, "synch_weights_time_ms": 14.972}, "counters": {"num_env_steps_sampled": 317400, "num_env_steps_trained": 317100, "num_agent_steps_sampled": 317400, "num_agent_steps_trained": 317100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2116, "num_samples_added_to_queue": 317400}, "done": false, "training_iteration": 126, "trial_id": "27800_00000", "date": "2024-10-12_15-49-37", "timestamp": 1728744577, "time_this_iter_s": 10.406655311584473, "time_total_s": 1303.643434047699, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b46bc0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1303.643434047699, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 16.560000000000002, "ram_util_percent": 57.040000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4903.54541015625, "policy_loss": 970.8704223632812, "entropy": 4.511798858642578, "entropy_coeff": 0.01, "var_gnorm": 18.063762664794922, "vf_loss": 394621.0625, "vf_explained_var": 0.6336275339126587}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1066.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 319950, "num_env_steps_trained": 319800, "num_agent_steps_sampled": 319950, "num_agent_steps_trained": 319800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2133, "num_samples_added_to_queue": 319800, "learner_queue": {"size_count": 1066, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.73, "learner_load_time_ms": 0.279, "learner_load_wait_time_ms": 1174.27, "learner_dequeue_time_ms": 10095.792}}, "env_runners": {"episode_reward_max": 1215.433333333336, "episode_reward_min": 1211.8000000000031, "episode_reward_mean": 1214.0194166666695, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.8000000000031}, "policy_reward_max": {"default_policy": 1215.433333333336}, "policy_reward_mean": {"default_policy": 1214.0194166666695}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2667, "num_moves_min": 0.0, "num_moves_max": 0.62, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16285650000000004, "num_slav_min": 0.16161666666666666, "num_slav_max": 0.16400000000000003, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5381631294527945, "mean_cluster_cpu_util_min": 0.5365123069498069, "mean_cluster_cpu_util_max": 0.5405637525280383, "mean_cluster_mem_util_mean": 0.34163871571729953, "mean_cluster_mem_util_min": 0.34120675105485226, "mean_cluster_mem_util_max": 0.34217510548523195, "reward_consolidation_mean_mean": 6.249791666666668, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4428474999999996, "reward_sla_mean_min": -2.4599999999999995, "reward_sla_mean_max": -2.4242500000000002, "reward_consolidation_sum_mean": 624.9791666666667, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.28474999999997, "reward_sla_sum_min": -245.99999999999997, "reward_sla_sum_max": -242.425, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3583.0, "global_timestep_min": 1900, "global_timestep_max": 5200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.1833333333361, 1214.0833333333362, 1215.2833333333363, 1214.8833333333369, 1213.9833333333363, 1214.7833333333363, 1212.8333333333364, 1214.6833333333363, 1213.5833333333364, 1213.4833333333363, 1215.0833333333358, 1214.6833333333363, 1214.3833333333366, 1212.7333333333358, 1214.2333333333358, 1214.1833333333363, 1213.9333333333366, 1214.4833333333363, 1212.3333333333362, 1212.8333333333367, 1213.7833333333358, 1215.0833333333367, 1215.1333333333364, 1214.3333333333364, 1213.483333333336, 1213.5833333333364, 1212.8333333333358, 1213.4333333333366, 1214.0333333333367, 1213.533333333336, 1214.2833333333363, 1214.0833333333362, 1214.7333333333368, 1214.9833333333368, 1213.8833333333369, 1213.033333333336, 1213.9333333333363, 1214.1833333333357, 1214.8833333333364, 1214.5333333333363, 1213.933333333336, 1215.1333333333362, 1213.1333333333355, 1213.8333333333362, 1213.8833333333364, 1213.7333333333365, 1214.5833333333362, 1215.0750000000035, 1214.2833333333365, 1212.7333333333356, 1213.083333333336, 1214.4833333333365, 1213.833333333337, 1213.2833333333363, 1213.6833333333363, 1214.633333333336, 1213.2333333333358, 1213.0333333333363, 1214.1833333333361, 1213.883333333336, 1213.9833333333365, 1213.833333333337, 1215.1333333333357, 1214.0333333333356, 1214.6833333333357, 1213.533333333337, 1214.433333333336, 1215.083333333336, 1215.233333333336, 1214.2333333333358, 1214.083333333337, 1213.2333333333356, 1214.8833333333366, 1213.7333333333363, 1214.433333333336, 1213.4833333333365, 1212.6833333333363, 1214.4833333333363, 1213.8833333333364, 1214.3333333333358, 1213.1333333333362, 1213.8333333333362, 1213.9333333333354, 1214.2833333333363, 1211.8000000000031, 1215.033333333336, 1213.733333333336, 1213.6833333333361, 1215.083333333336, 1213.983333333336, 1213.1333333333362, 1214.783333333337, 1214.4333333333363, 1213.333333333336, 1212.3833333333364, 1214.5333333333367, 1213.7333333333368, 1215.433333333336, 1214.1833333333363, 1213.983333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.1833333333361, 1214.0833333333362, 1215.2833333333363, 1214.8833333333369, 1213.9833333333363, 1214.7833333333363, 1212.8333333333364, 1214.6833333333363, 1213.5833333333364, 1213.4833333333363, 1215.0833333333358, 1214.6833333333363, 1214.3833333333366, 1212.7333333333358, 1214.2333333333358, 1214.1833333333363, 1213.9333333333366, 1214.4833333333363, 1212.3333333333362, 1212.8333333333367, 1213.7833333333358, 1215.0833333333367, 1215.1333333333364, 1214.3333333333364, 1213.483333333336, 1213.5833333333364, 1212.8333333333358, 1213.4333333333366, 1214.0333333333367, 1213.533333333336, 1214.2833333333363, 1214.0833333333362, 1214.7333333333368, 1214.9833333333368, 1213.8833333333369, 1213.033333333336, 1213.9333333333363, 1214.1833333333357, 1214.8833333333364, 1214.5333333333363, 1213.933333333336, 1215.1333333333362, 1213.1333333333355, 1213.8333333333362, 1213.8833333333364, 1213.7333333333365, 1214.5833333333362, 1215.0750000000035, 1214.2833333333365, 1212.7333333333356, 1213.083333333336, 1214.4833333333365, 1213.833333333337, 1213.2833333333363, 1213.6833333333363, 1214.633333333336, 1213.2333333333358, 1213.0333333333363, 1214.1833333333361, 1213.883333333336, 1213.9833333333365, 1213.833333333337, 1215.1333333333357, 1214.0333333333356, 1214.6833333333357, 1213.533333333337, 1214.433333333336, 1215.083333333336, 1215.233333333336, 1214.2333333333358, 1214.083333333337, 1213.2333333333356, 1214.8833333333366, 1213.7333333333363, 1214.433333333336, 1213.4833333333365, 1212.6833333333363, 1214.4833333333363, 1213.8833333333364, 1214.3333333333358, 1213.1333333333362, 1213.8333333333362, 1213.9333333333354, 1214.2833333333363, 1211.8000000000031, 1215.033333333336, 1213.733333333336, 1213.6833333333361, 1215.083333333336, 1213.983333333336, 1213.1333333333362, 1214.783333333337, 1214.4333333333363, 1213.333333333336, 1212.3833333333364, 1214.5333333333367, 1213.7333333333368, 1215.433333333336, 1214.1833333333363, 1213.983333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24226801662133823, "mean_inference_ms": 2.065648801482348, "mean_action_processing_ms": 0.09109528407456889, "mean_env_wait_ms": 1.5388809228707607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006615638732910156, "StateBufferConnector_ms": 0.003387928009033203, "ViewRequirementAgentConnector_ms": 0.08701038360595703}, "num_episodes": 24, "episode_return_max": 1215.433333333336, "episode_return_min": 1211.8000000000031, "episode_return_mean": 1214.0194166666695, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 319950, "num_agent_steps_trained": 319800, "num_env_steps_sampled": 319950, "num_env_steps_trained": 319800, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 240.27615500917804, "num_env_steps_trained_throughput_per_sec": 254.41004648030616, "timesteps_total": 319950, "num_env_steps_sampled_lifetime": 319950, "num_agent_steps_sampled_lifetime": 319950, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 319950, "timers": {"training_iteration_time_ms": 10369.576, "restore_workers_time_ms": 0.015, "training_step_time_ms": 615.846, "sample_time_ms": 601.493, "synch_weights_time_ms": 12.956}, "counters": {"num_env_steps_sampled": 319950, "num_env_steps_trained": 319800, "num_agent_steps_sampled": 319950, "num_agent_steps_trained": 319800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2133, "num_samples_added_to_queue": 319800}, "done": false, "training_iteration": 127, "trial_id": "27800_00000", "date": "2024-10-12_15-49-48", "timestamp": 1728744588, "time_this_iter_s": 10.63282060623169, "time_total_s": 1314.2762546539307, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f2500>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1314.2762546539307, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 16.279999999999998, "ram_util_percent": 57.240000000000016}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2613.10986328125, "policy_loss": -1283.1396484375, "entropy": 4.514703273773193, "entropy_coeff": 0.01, "var_gnorm": 18.088558197021484, "vf_loss": 390979.34375, "vf_explained_var": 0.6356488466262817}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1074.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 322350, "num_env_steps_trained": 322200, "num_agent_steps_sampled": 322350, "num_agent_steps_trained": 322200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2149, "num_samples_added_to_queue": 322200, "learner_queue": {"size_count": 1074, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.414, "learner_load_time_ms": 0.277, "learner_load_wait_time_ms": 1217.558, "learner_dequeue_time_ms": 10128.984}}, "env_runners": {"episode_reward_max": 1215.433333333336, "episode_reward_min": 1211.8000000000031, "episode_reward_mean": 1213.9804166666693, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.8000000000031}, "policy_reward_max": {"default_policy": 1215.433333333336}, "policy_reward_mean": {"default_policy": 1213.9804166666693}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.18720000000000003, "num_moves_min": 0.0, "num_moves_max": 0.58, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.1628825, "num_slav_min": 0.16161666666666666, "num_slav_max": 0.16413333333333338, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5381617285748759, "mean_cluster_cpu_util_min": 0.5365123069498069, "mean_cluster_cpu_util_max": 0.5399405221548078, "mean_cluster_mem_util_mean": 0.34161720727848105, "mean_cluster_mem_util_min": 0.34120675105485226, "mean_cluster_mem_util_max": 0.3420358649789029, "reward_consolidation_mean_mean": 6.249791666666666, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4432374999999995, "reward_sla_mean_min": -2.4619999999999997, "reward_sla_mean_max": -2.4242500000000002, "reward_consolidation_sum_mean": 624.9791666666667, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.32375000000005, "reward_sla_sum_min": -246.2, "reward_sla_sum_max": -242.425, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4383.0, "global_timestep_min": 2700, "global_timestep_max": 6000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.483333333336, 1213.5833333333364, 1212.8333333333358, 1213.4333333333366, 1214.0333333333367, 1213.533333333336, 1214.2833333333363, 1214.0833333333362, 1214.7333333333368, 1214.9833333333368, 1213.8833333333369, 1213.033333333336, 1213.9333333333363, 1214.1833333333357, 1214.8833333333364, 1214.5333333333363, 1213.933333333336, 1215.1333333333362, 1213.1333333333355, 1213.8333333333362, 1213.8833333333364, 1213.7333333333365, 1214.5833333333362, 1215.0750000000035, 1214.2833333333365, 1212.7333333333356, 1213.083333333336, 1214.4833333333365, 1213.833333333337, 1213.2833333333363, 1213.6833333333363, 1214.633333333336, 1213.2333333333358, 1213.0333333333363, 1214.1833333333361, 1213.883333333336, 1213.9833333333365, 1213.833333333337, 1215.1333333333357, 1214.0333333333356, 1214.6833333333357, 1213.533333333337, 1214.433333333336, 1215.083333333336, 1215.233333333336, 1214.2333333333358, 1214.083333333337, 1213.2333333333356, 1214.8833333333366, 1213.7333333333363, 1214.433333333336, 1213.4833333333365, 1212.6833333333363, 1214.4833333333363, 1213.8833333333364, 1214.3333333333358, 1213.1333333333362, 1213.8333333333362, 1213.9333333333354, 1214.2833333333363, 1211.8000000000031, 1215.033333333336, 1213.733333333336, 1213.6833333333361, 1215.083333333336, 1213.983333333336, 1213.1333333333362, 1214.783333333337, 1214.4333333333363, 1213.333333333336, 1212.3833333333364, 1214.5333333333367, 1213.7333333333368, 1215.433333333336, 1214.1833333333363, 1213.983333333336, 1214.6833333333366, 1214.0333333333367, 1214.0333333333365, 1214.533333333336, 1214.0833333333362, 1213.083333333336, 1214.583333333336, 1212.8833333333364, 1213.133333333336, 1214.5833333333358, 1214.833333333336, 1213.9833333333368, 1214.8333333333362, 1214.7333333333358, 1213.283333333336, 1214.3333333333364, 1214.4833333333363, 1213.6333333333366, 1213.7333333333368, 1212.1333333333364, 1213.8333333333355, 1213.8333333333358, 1213.633333333336, 1214.1833333333361], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.483333333336, 1213.5833333333364, 1212.8333333333358, 1213.4333333333366, 1214.0333333333367, 1213.533333333336, 1214.2833333333363, 1214.0833333333362, 1214.7333333333368, 1214.9833333333368, 1213.8833333333369, 1213.033333333336, 1213.9333333333363, 1214.1833333333357, 1214.8833333333364, 1214.5333333333363, 1213.933333333336, 1215.1333333333362, 1213.1333333333355, 1213.8333333333362, 1213.8833333333364, 1213.7333333333365, 1214.5833333333362, 1215.0750000000035, 1214.2833333333365, 1212.7333333333356, 1213.083333333336, 1214.4833333333365, 1213.833333333337, 1213.2833333333363, 1213.6833333333363, 1214.633333333336, 1213.2333333333358, 1213.0333333333363, 1214.1833333333361, 1213.883333333336, 1213.9833333333365, 1213.833333333337, 1215.1333333333357, 1214.0333333333356, 1214.6833333333357, 1213.533333333337, 1214.433333333336, 1215.083333333336, 1215.233333333336, 1214.2333333333358, 1214.083333333337, 1213.2333333333356, 1214.8833333333366, 1213.7333333333363, 1214.433333333336, 1213.4833333333365, 1212.6833333333363, 1214.4833333333363, 1213.8833333333364, 1214.3333333333358, 1213.1333333333362, 1213.8333333333362, 1213.9333333333354, 1214.2833333333363, 1211.8000000000031, 1215.033333333336, 1213.733333333336, 1213.6833333333361, 1215.083333333336, 1213.983333333336, 1213.1333333333362, 1214.783333333337, 1214.4333333333363, 1213.333333333336, 1212.3833333333364, 1214.5333333333367, 1213.7333333333368, 1215.433333333336, 1214.1833333333363, 1213.983333333336, 1214.6833333333366, 1214.0333333333367, 1214.0333333333365, 1214.533333333336, 1214.0833333333362, 1213.083333333336, 1214.583333333336, 1212.8833333333364, 1213.133333333336, 1214.5833333333358, 1214.833333333336, 1213.9833333333368, 1214.8333333333362, 1214.7333333333358, 1213.283333333336, 1214.3333333333364, 1214.4833333333363, 1213.6333333333366, 1213.7333333333368, 1212.1333333333364, 1213.8333333333355, 1213.8333333333358, 1213.633333333336, 1214.1833333333361]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24233880882461686, "mean_inference_ms": 2.065787540113756, "mean_action_processing_ms": 0.0911077381604227, "mean_env_wait_ms": 1.5390376403103005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064737796783447266, "StateBufferConnector_ms": 0.00335693359375, "ViewRequirementAgentConnector_ms": 0.08649754524230957}, "num_episodes": 24, "episode_return_max": 1215.433333333336, "episode_return_min": 1211.8000000000031, "episode_return_mean": 1213.9804166666693, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 322350, "num_agent_steps_trained": 322200, "num_env_steps_sampled": 322350, "num_env_steps_trained": 322200, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 236.9299348440476, "num_env_steps_trained_throughput_per_sec": 236.9299348440476, "timesteps_total": 322350, "num_env_steps_sampled_lifetime": 322350, "num_agent_steps_sampled_lifetime": 322350, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 322350, "timers": {"training_iteration_time_ms": 10380.743, "restore_workers_time_ms": 0.014, "training_step_time_ms": 624.029, "sample_time_ms": 608.248, "synch_weights_time_ms": 14.106}, "counters": {"num_env_steps_sampled": 322350, "num_env_steps_trained": 322200, "num_agent_steps_sampled": 322350, "num_agent_steps_trained": 322200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2149, "num_samples_added_to_queue": 322200}, "done": false, "training_iteration": 128, "trial_id": "27800_00000", "date": "2024-10-12_15-49-58", "timestamp": 1728744598, "time_this_iter_s": 10.13953447341919, "time_total_s": 1324.4157891273499, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c2b00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1324.4157891273499, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 16.466666666666665, "ram_util_percent": 57.386666666666656}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3161.9169921875, "policy_loss": -796.1351318359375, "entropy": 4.483449459075928, "entropy_coeff": 0.01, "var_gnorm": 18.106374740600586, "vf_loss": 397150.25, "vf_explained_var": 0.6336360573768616}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1082.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 324750, "num_env_steps_trained": 324600, "num_agent_steps_sampled": 324750, "num_agent_steps_trained": 324600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2165, "num_samples_added_to_queue": 324600, "learner_queue": {"size_count": 1082, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.37, "learner_load_time_ms": 0.278, "learner_load_wait_time_ms": 1221.922, "learner_dequeue_time_ms": 10139.969}}, "env_runners": {"episode_reward_max": 1215.6833333333361, "episode_reward_min": 1211.8000000000031, "episode_reward_mean": 1214.004500000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.8000000000031}, "policy_reward_max": {"default_policy": 1215.6833333333361}, "policy_reward_mean": {"default_policy": 1214.004500000003}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0858, "num_moves_min": 0.0, "num_moves_max": 0.28, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.162872, "num_slav_min": 0.16176666666666667, "num_slav_max": 0.16413333333333338, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5381769717261906, "mean_cluster_cpu_util_min": 0.5363758043758043, "mean_cluster_cpu_util_max": 0.5399405221548078, "mean_cluster_mem_util_mean": 0.341624401371308, "mean_cluster_mem_util_min": 0.34120675105485226, "mean_cluster_mem_util_max": 0.3420358649789029, "reward_consolidation_mean_mean": 6.249791666666666, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.44308, "reward_sla_mean_min": -2.4619999999999997, "reward_sla_mean_max": -2.4265, "reward_consolidation_sum_mean": 624.9791666666666, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.308, "reward_sla_sum_min": -246.2, "reward_sla_sum_max": -242.65, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5183.0, "global_timestep_min": 3500, "global_timestep_max": 6800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.2833333333365, 1212.7333333333356, 1213.083333333336, 1214.4833333333365, 1213.833333333337, 1213.2833333333363, 1213.6833333333363, 1214.633333333336, 1213.2333333333358, 1213.0333333333363, 1214.1833333333361, 1213.883333333336, 1213.9833333333365, 1213.833333333337, 1215.1333333333357, 1214.0333333333356, 1214.6833333333357, 1213.533333333337, 1214.433333333336, 1215.083333333336, 1215.233333333336, 1214.2333333333358, 1214.083333333337, 1213.2333333333356, 1214.8833333333366, 1213.7333333333363, 1214.433333333336, 1213.4833333333365, 1212.6833333333363, 1214.4833333333363, 1213.8833333333364, 1214.3333333333358, 1213.1333333333362, 1213.8333333333362, 1213.9333333333354, 1214.2833333333363, 1211.8000000000031, 1215.033333333336, 1213.733333333336, 1213.6833333333361, 1215.083333333336, 1213.983333333336, 1213.1333333333362, 1214.783333333337, 1214.4333333333363, 1213.333333333336, 1212.3833333333364, 1214.5333333333367, 1213.7333333333368, 1215.433333333336, 1214.1833333333363, 1213.983333333336, 1214.6833333333366, 1214.0333333333367, 1214.0333333333365, 1214.533333333336, 1214.0833333333362, 1213.083333333336, 1214.583333333336, 1212.8833333333364, 1213.133333333336, 1214.5833333333358, 1214.833333333336, 1213.9833333333368, 1214.8333333333362, 1214.7333333333358, 1213.283333333336, 1214.3333333333364, 1214.4833333333363, 1213.6333333333366, 1213.7333333333368, 1212.1333333333364, 1213.8333333333355, 1213.8333333333358, 1213.633333333336, 1214.1833333333361, 1214.183333333336, 1213.8333333333362, 1213.883333333336, 1214.733333333336, 1214.1333333333364, 1214.0333333333367, 1214.1833333333361, 1215.6833333333361, 1213.533333333336, 1214.5833333333364, 1214.5833333333371, 1214.583333333336, 1213.0833333333362, 1213.9333333333366, 1214.7833333333365, 1213.3333333333358, 1214.083333333336, 1214.3833333333355, 1214.3333333333364, 1213.6333333333362, 1214.7333333333358, 1213.9333333333361, 1213.4333333333361, 1213.5333333333365], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.2833333333365, 1212.7333333333356, 1213.083333333336, 1214.4833333333365, 1213.833333333337, 1213.2833333333363, 1213.6833333333363, 1214.633333333336, 1213.2333333333358, 1213.0333333333363, 1214.1833333333361, 1213.883333333336, 1213.9833333333365, 1213.833333333337, 1215.1333333333357, 1214.0333333333356, 1214.6833333333357, 1213.533333333337, 1214.433333333336, 1215.083333333336, 1215.233333333336, 1214.2333333333358, 1214.083333333337, 1213.2333333333356, 1214.8833333333366, 1213.7333333333363, 1214.433333333336, 1213.4833333333365, 1212.6833333333363, 1214.4833333333363, 1213.8833333333364, 1214.3333333333358, 1213.1333333333362, 1213.8333333333362, 1213.9333333333354, 1214.2833333333363, 1211.8000000000031, 1215.033333333336, 1213.733333333336, 1213.6833333333361, 1215.083333333336, 1213.983333333336, 1213.1333333333362, 1214.783333333337, 1214.4333333333363, 1213.333333333336, 1212.3833333333364, 1214.5333333333367, 1213.7333333333368, 1215.433333333336, 1214.1833333333363, 1213.983333333336, 1214.6833333333366, 1214.0333333333367, 1214.0333333333365, 1214.533333333336, 1214.0833333333362, 1213.083333333336, 1214.583333333336, 1212.8833333333364, 1213.133333333336, 1214.5833333333358, 1214.833333333336, 1213.9833333333368, 1214.8333333333362, 1214.7333333333358, 1213.283333333336, 1214.3333333333364, 1214.4833333333363, 1213.6333333333366, 1213.7333333333368, 1212.1333333333364, 1213.8333333333355, 1213.8333333333358, 1213.633333333336, 1214.1833333333361, 1214.183333333336, 1213.8333333333362, 1213.883333333336, 1214.733333333336, 1214.1333333333364, 1214.0333333333367, 1214.1833333333361, 1215.6833333333361, 1213.533333333336, 1214.5833333333364, 1214.5833333333371, 1214.583333333336, 1213.0833333333362, 1213.9333333333366, 1214.7833333333365, 1213.3333333333358, 1214.083333333336, 1214.3833333333355, 1214.3333333333364, 1213.6333333333362, 1214.7333333333358, 1213.9333333333361, 1213.4333333333361, 1213.5333333333365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24240900206331503, "mean_inference_ms": 2.0660702586693818, "mean_action_processing_ms": 0.09112139847911191, "mean_env_wait_ms": 1.5392296068502782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006601810455322266, "StateBufferConnector_ms": 0.0034055709838867188, "ViewRequirementAgentConnector_ms": 0.08736991882324219}, "num_episodes": 24, "episode_return_max": 1215.6833333333361, "episode_return_min": 1211.8000000000031, "episode_return_mean": 1214.004500000003, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324750, "num_agent_steps_trained": 324600, "num_env_steps_sampled": 324750, "num_env_steps_trained": 324600, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 233.98351160607152, "num_env_steps_trained_throughput_per_sec": 233.98351160607152, "timesteps_total": 324750, "num_env_steps_sampled_lifetime": 324750, "num_agent_steps_sampled_lifetime": 324750, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 324750, "timers": {"training_iteration_time_ms": 10357.885, "restore_workers_time_ms": 0.013, "training_step_time_ms": 645.021, "sample_time_ms": 629.229, "synch_weights_time_ms": 14.326}, "counters": {"num_env_steps_sampled": 324750, "num_env_steps_trained": 324600, "num_agent_steps_sampled": 324750, "num_agent_steps_trained": 324600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2165, "num_samples_added_to_queue": 324600}, "done": false, "training_iteration": 129, "trial_id": "27800_00000", "date": "2024-10-12_15-50-08", "timestamp": 1728744608, "time_this_iter_s": 10.266578197479248, "time_total_s": 1334.682367324829, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b45db0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1334.682367324829, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 16.573333333333334, "ram_util_percent": 57.526666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4359.7822265625, "policy_loss": 404.99322509765625, "entropy": 4.399724960327148, "entropy_coeff": 0.01, "var_gnorm": 18.117647171020508, "vf_loss": 396798.84375, "vf_explained_var": 0.6341352462768555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1090.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 327300, "num_env_steps_trained": 327000, "num_agent_steps_sampled": 327300, "num_agent_steps_trained": 327000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2182, "num_samples_added_to_queue": 327300, "learner_queue": {"size_count": 1090, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.108, "learner_load_time_ms": 0.281, "learner_load_wait_time_ms": 1186.044, "learner_dequeue_time_ms": 10143.891}}, "env_runners": {"episode_reward_max": 1215.6833333333361, "episode_reward_min": 1211.8000000000031, "episode_reward_mean": 1213.9946666666697, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.8000000000031}, "policy_reward_max": {"default_policy": 1215.6833333333361}, "policy_reward_mean": {"default_policy": 1213.9946666666697}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0574, "num_moves_min": 0.0, "num_moves_max": 0.18, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16287300000000002, "num_slav_min": 0.16176666666666667, "num_slav_max": 0.16413333333333338, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5381036933202336, "mean_cluster_cpu_util_min": 0.5363758043758043, "mean_cluster_cpu_util_max": 0.5399405221548078, "mean_cluster_mem_util_mean": 0.3416178401898734, "mean_cluster_mem_util_min": 0.3412352320675106, "mean_cluster_mem_util_max": 0.3420358649789029, "reward_consolidation_mean_mean": 6.249791666666666, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4430949999999996, "reward_sla_mean_min": -2.4619999999999997, "reward_sla_mean_max": -2.4265, "reward_consolidation_sum_mean": 624.9791666666666, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.3095, "reward_sla_sum_min": -246.2, "reward_sla_sum_max": -242.65, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6083.0, "global_timestep_min": 4400, "global_timestep_max": 7700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.4833333333365, 1212.6833333333363, 1214.4833333333363, 1213.8833333333364, 1214.3333333333358, 1213.1333333333362, 1213.8333333333362, 1213.9333333333354, 1214.2833333333363, 1211.8000000000031, 1215.033333333336, 1213.733333333336, 1213.6833333333361, 1215.083333333336, 1213.983333333336, 1213.1333333333362, 1214.783333333337, 1214.4333333333363, 1213.333333333336, 1212.3833333333364, 1214.5333333333367, 1213.7333333333368, 1215.433333333336, 1214.1833333333363, 1213.983333333336, 1214.6833333333366, 1214.0333333333367, 1214.0333333333365, 1214.533333333336, 1214.0833333333362, 1213.083333333336, 1214.583333333336, 1212.8833333333364, 1213.133333333336, 1214.5833333333358, 1214.833333333336, 1213.9833333333368, 1214.8333333333362, 1214.7333333333358, 1213.283333333336, 1214.3333333333364, 1214.4833333333363, 1213.6333333333366, 1213.7333333333368, 1212.1333333333364, 1213.8333333333355, 1213.8333333333358, 1213.633333333336, 1214.1833333333361, 1214.183333333336, 1213.8333333333362, 1213.883333333336, 1214.733333333336, 1214.1333333333364, 1214.0333333333367, 1214.1833333333361, 1215.6833333333361, 1213.533333333336, 1214.5833333333364, 1214.5833333333371, 1214.583333333336, 1213.0833333333362, 1213.9333333333366, 1214.7833333333365, 1213.3333333333358, 1214.083333333336, 1214.3833333333355, 1214.3333333333364, 1213.6333333333362, 1214.7333333333358, 1213.9333333333361, 1213.4333333333361, 1213.5333333333365, 1213.2833333333367, 1212.8333333333353, 1213.5833333333358, 1214.1333333333362, 1213.8833333333362, 1212.583333333336, 1214.2833333333358, 1214.7333333333363, 1214.1333333333366, 1214.5333333333367, 1214.7333333333363, 1214.0833333333362, 1214.7833333333363, 1214.7333333333363, 1214.250000000003, 1214.8333333333364, 1213.833333333336, 1213.8333333333358, 1214.1333333333364, 1214.8333333333367, 1214.533333333336, 1213.2333333333363, 1214.183333333336, 1213.583333333336, 1213.6833333333361, 1213.2833333333358, 1213.3833333333362], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.4833333333365, 1212.6833333333363, 1214.4833333333363, 1213.8833333333364, 1214.3333333333358, 1213.1333333333362, 1213.8333333333362, 1213.9333333333354, 1214.2833333333363, 1211.8000000000031, 1215.033333333336, 1213.733333333336, 1213.6833333333361, 1215.083333333336, 1213.983333333336, 1213.1333333333362, 1214.783333333337, 1214.4333333333363, 1213.333333333336, 1212.3833333333364, 1214.5333333333367, 1213.7333333333368, 1215.433333333336, 1214.1833333333363, 1213.983333333336, 1214.6833333333366, 1214.0333333333367, 1214.0333333333365, 1214.533333333336, 1214.0833333333362, 1213.083333333336, 1214.583333333336, 1212.8833333333364, 1213.133333333336, 1214.5833333333358, 1214.833333333336, 1213.9833333333368, 1214.8333333333362, 1214.7333333333358, 1213.283333333336, 1214.3333333333364, 1214.4833333333363, 1213.6333333333366, 1213.7333333333368, 1212.1333333333364, 1213.8333333333355, 1213.8333333333358, 1213.633333333336, 1214.1833333333361, 1214.183333333336, 1213.8333333333362, 1213.883333333336, 1214.733333333336, 1214.1333333333364, 1214.0333333333367, 1214.1833333333361, 1215.6833333333361, 1213.533333333336, 1214.5833333333364, 1214.5833333333371, 1214.583333333336, 1213.0833333333362, 1213.9333333333366, 1214.7833333333365, 1213.3333333333358, 1214.083333333336, 1214.3833333333355, 1214.3333333333364, 1213.6333333333362, 1214.7333333333358, 1213.9333333333361, 1213.4333333333361, 1213.5333333333365, 1213.2833333333367, 1212.8333333333353, 1213.5833333333358, 1214.1333333333362, 1213.8833333333362, 1212.583333333336, 1214.2833333333358, 1214.7333333333363, 1214.1333333333366, 1214.5333333333367, 1214.7333333333363, 1214.0833333333362, 1214.7833333333363, 1214.7333333333363, 1214.250000000003, 1214.8333333333364, 1213.833333333336, 1213.8333333333358, 1214.1333333333364, 1214.8333333333367, 1214.533333333336, 1213.2333333333363, 1214.183333333336, 1213.583333333336, 1213.6833333333361, 1213.2833333333358, 1213.3833333333362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24248107653400922, "mean_inference_ms": 2.0664743348692256, "mean_action_processing_ms": 0.09113824743946974, "mean_env_wait_ms": 1.5394657910029492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006651878356933594, "StateBufferConnector_ms": 0.003450632095336914, "ViewRequirementAgentConnector_ms": 0.0888526439666748}, "num_episodes": 27, "episode_return_max": 1215.6833333333361, "episode_return_min": 1211.8000000000031, "episode_return_mean": 1213.9946666666697, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 327300, "num_agent_steps_trained": 327000, "num_env_steps_sampled": 327300, "num_env_steps_trained": 327000, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 242.33278959096066, "num_env_steps_trained_throughput_per_sec": 228.07791961502178, "timesteps_total": 327300, "num_env_steps_sampled_lifetime": 327300, "num_agent_steps_sampled_lifetime": 327300, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 327300, "timers": {"training_iteration_time_ms": 10353.419, "restore_workers_time_ms": 0.012, "training_step_time_ms": 629.432, "sample_time_ms": 613.96, "synch_weights_time_ms": 13.933}, "counters": {"num_env_steps_sampled": 327300, "num_env_steps_trained": 327000, "num_agent_steps_sampled": 327300, "num_agent_steps_trained": 327000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2182, "num_samples_added_to_queue": 327300}, "done": false, "training_iteration": 130, "trial_id": "27800_00000", "date": "2024-10-12_15-50-19", "timestamp": 1728744619, "time_this_iter_s": 10.534260988235474, "time_total_s": 1345.2166283130646, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c1390>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1345.2166283130646, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 16.473333333333333, "ram_util_percent": 57.686666666666675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2769.47412109375, "policy_loss": -1171.401611328125, "entropy": 4.442169189453125, "entropy_coeff": 0.01, "var_gnorm": 18.096771240234375, "vf_loss": 395420.25, "vf_explained_var": 0.6441460251808167}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1099.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 329850, "num_env_steps_trained": 329700, "num_agent_steps_sampled": 329850, "num_agent_steps_trained": 329700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2199, "num_samples_added_to_queue": 329700, "learner_queue": {"size_count": 1099, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.552, "learner_load_time_ms": 0.299, "learner_load_wait_time_ms": 1186.954, "learner_dequeue_time_ms": 10159.211}}, "env_runners": {"episode_reward_max": 1215.6833333333361, "episode_reward_min": 1212.1333333333364, "episode_reward_mean": 1214.0320000000029, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.1333333333364}, "policy_reward_max": {"default_policy": 1215.6833333333361}, "policy_reward_mean": {"default_policy": 1214.0320000000029}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.049699999999999994, "num_moves_min": 0.0, "num_moves_max": 0.18, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0008, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.162862, "num_slav_min": 0.16176666666666667, "num_slav_max": 0.16413333333333338, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5380525209137709, "mean_cluster_cpu_util_min": 0.5356786863394005, "mean_cluster_cpu_util_max": 0.5399323634859349, "mean_cluster_mem_util_mean": 0.3416293037974683, "mean_cluster_mem_util_min": 0.34115928270042195, "mean_cluster_mem_util_max": 0.3420137130801688, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.44293, "reward_sla_mean_min": -2.4619999999999997, "reward_sla_mean_max": -2.4265, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.293, "reward_sla_sum_min": -246.2, "reward_sla_sum_max": -242.65, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5245.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.983333333336, 1214.6833333333366, 1214.0333333333367, 1214.0333333333365, 1214.533333333336, 1214.0833333333362, 1213.083333333336, 1214.583333333336, 1212.8833333333364, 1213.133333333336, 1214.5833333333358, 1214.833333333336, 1213.9833333333368, 1214.8333333333362, 1214.7333333333358, 1213.283333333336, 1214.3333333333364, 1214.4833333333363, 1213.6333333333366, 1213.7333333333368, 1212.1333333333364, 1213.8333333333355, 1213.8333333333358, 1213.633333333336, 1214.1833333333361, 1214.183333333336, 1213.8333333333362, 1213.883333333336, 1214.733333333336, 1214.1333333333364, 1214.0333333333367, 1214.1833333333361, 1215.6833333333361, 1213.533333333336, 1214.5833333333364, 1214.5833333333371, 1214.583333333336, 1213.0833333333362, 1213.9333333333366, 1214.7833333333365, 1213.3333333333358, 1214.083333333336, 1214.3833333333355, 1214.3333333333364, 1213.6333333333362, 1214.7333333333358, 1213.9333333333361, 1213.4333333333361, 1213.5333333333365, 1213.2833333333367, 1212.8333333333353, 1213.5833333333358, 1214.1333333333362, 1213.8833333333362, 1212.583333333336, 1214.2833333333358, 1214.7333333333363, 1214.1333333333366, 1214.5333333333367, 1214.7333333333363, 1214.0833333333362, 1214.7833333333363, 1214.7333333333363, 1214.250000000003, 1214.8333333333364, 1213.833333333336, 1213.8333333333358, 1214.1333333333364, 1214.8333333333367, 1214.533333333336, 1213.2333333333363, 1214.183333333336, 1213.583333333336, 1213.6833333333361, 1213.2833333333358, 1213.3833333333362, 1214.683333333336, 1213.7333333333358, 1213.6833333333363, 1214.5833333333358, 1214.6833333333368, 1213.7833333333365, 1213.5833333333364, 1214.7333333333368, 1212.7333333333354, 1214.8833333333364, 1214.033333333337, 1214.4833333333365, 1214.4333333333363, 1213.2833333333363, 1212.933333333336, 1213.983333333336, 1213.2833333333358, 1214.033333333336, 1214.4333333333368, 1215.3333333333364, 1213.7833333333351, 1214.4833333333356, 1213.9333333333366, 1213.5333333333365], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.983333333336, 1214.6833333333366, 1214.0333333333367, 1214.0333333333365, 1214.533333333336, 1214.0833333333362, 1213.083333333336, 1214.583333333336, 1212.8833333333364, 1213.133333333336, 1214.5833333333358, 1214.833333333336, 1213.9833333333368, 1214.8333333333362, 1214.7333333333358, 1213.283333333336, 1214.3333333333364, 1214.4833333333363, 1213.6333333333366, 1213.7333333333368, 1212.1333333333364, 1213.8333333333355, 1213.8333333333358, 1213.633333333336, 1214.1833333333361, 1214.183333333336, 1213.8333333333362, 1213.883333333336, 1214.733333333336, 1214.1333333333364, 1214.0333333333367, 1214.1833333333361, 1215.6833333333361, 1213.533333333336, 1214.5833333333364, 1214.5833333333371, 1214.583333333336, 1213.0833333333362, 1213.9333333333366, 1214.7833333333365, 1213.3333333333358, 1214.083333333336, 1214.3833333333355, 1214.3333333333364, 1213.6333333333362, 1214.7333333333358, 1213.9333333333361, 1213.4333333333361, 1213.5333333333365, 1213.2833333333367, 1212.8333333333353, 1213.5833333333358, 1214.1333333333362, 1213.8833333333362, 1212.583333333336, 1214.2833333333358, 1214.7333333333363, 1214.1333333333366, 1214.5333333333367, 1214.7333333333363, 1214.0833333333362, 1214.7833333333363, 1214.7333333333363, 1214.250000000003, 1214.8333333333364, 1213.833333333336, 1213.8333333333358, 1214.1333333333364, 1214.8333333333367, 1214.533333333336, 1213.2333333333363, 1214.183333333336, 1213.583333333336, 1213.6833333333361, 1213.2833333333358, 1213.3833333333362, 1214.683333333336, 1213.7333333333358, 1213.6833333333363, 1214.5833333333358, 1214.6833333333368, 1213.7833333333365, 1213.5833333333364, 1214.7333333333368, 1212.7333333333354, 1214.8833333333364, 1214.033333333337, 1214.4833333333365, 1214.4333333333363, 1213.2833333333363, 1212.933333333336, 1213.983333333336, 1213.2833333333358, 1214.033333333336, 1214.4333333333368, 1215.3333333333364, 1213.7833333333351, 1214.4833333333356, 1213.9333333333366, 1213.5333333333365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24251614497746268, "mean_inference_ms": 2.066818932307568, "mean_action_processing_ms": 0.09115181363732919, "mean_env_wait_ms": 1.5396662100167282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006563663482666016, "StateBufferConnector_ms": 0.003392934799194336, "ViewRequirementAgentConnector_ms": 0.0877695083618164}, "num_episodes": 24, "episode_return_max": 1215.6833333333361, "episode_return_min": 1212.1333333333364, "episode_return_mean": 1214.0320000000029, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 329850, "num_agent_steps_trained": 329700, "num_env_steps_sampled": 329850, "num_env_steps_trained": 329700, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 241.68240357080225, "num_env_steps_trained_throughput_per_sec": 255.8990155455553, "timesteps_total": 329850, "num_env_steps_sampled_lifetime": 329850, "num_agent_steps_sampled_lifetime": 329850, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 329850, "timers": {"training_iteration_time_ms": 10356.359, "restore_workers_time_ms": 0.014, "training_step_time_ms": 619.187, "sample_time_ms": 603.165, "synch_weights_time_ms": 14.477}, "counters": {"num_env_steps_sampled": 329850, "num_env_steps_trained": 329700, "num_agent_steps_sampled": 329850, "num_agent_steps_trained": 329700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2199, "num_samples_added_to_queue": 329700}, "done": false, "training_iteration": 131, "trial_id": "27800_00000", "date": "2024-10-12_15-50-29", "timestamp": 1728744629, "time_this_iter_s": 10.563741683959961, "time_total_s": 1355.7803699970245, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f01c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1355.7803699970245, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 16.533333333333335, "ram_util_percent": 57.83999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3859.774658203125, "policy_loss": -302.06597900390625, "entropy": 4.474186897277832, "entropy_coeff": 0.01, "var_gnorm": 18.059585571289062, "vf_loss": 417526.3125, "vf_explained_var": 0.6246716976165771}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1106.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 332100, "num_env_steps_trained": 331800, "num_agent_steps_sampled": 332100, "num_agent_steps_trained": 331800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2214, "num_samples_added_to_queue": 332100, "learner_queue": {"size_count": 1106, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.929, "learner_load_time_ms": 0.294, "learner_load_wait_time_ms": 1286.484, "learner_dequeue_time_ms": 10179.571}}, "env_runners": {"episode_reward_max": 1215.6833333333361, "episode_reward_min": 1212.583333333336, "episode_reward_mean": 1214.0435000000027, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.583333333336}, "policy_reward_max": {"default_policy": 1215.6833333333361}, "policy_reward_mean": {"default_policy": 1214.0435000000027}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0421, "num_moves_min": 0.0, "num_moves_max": 0.15, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0008, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16285433333333332, "num_slav_min": 0.16176666666666667, "num_slav_max": 0.16383333333333333, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5379786905911013, "mean_cluster_cpu_util_min": 0.5356786863394005, "mean_cluster_cpu_util_max": 0.5399323634859349, "mean_cluster_mem_util_mean": 0.3416303375527426, "mean_cluster_mem_util_min": 0.3410537974683544, "mean_cluster_mem_util_max": 0.3420137130801688, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.442815, "reward_sla_mean_min": -2.4575, "reward_sla_mean_max": -2.4265, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.28149999999994, "reward_sla_sum_min": -245.75, "reward_sla_sum_max": -242.65, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4173.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.1833333333361, 1214.183333333336, 1213.8333333333362, 1213.883333333336, 1214.733333333336, 1214.1333333333364, 1214.0333333333367, 1214.1833333333361, 1215.6833333333361, 1213.533333333336, 1214.5833333333364, 1214.5833333333371, 1214.583333333336, 1213.0833333333362, 1213.9333333333366, 1214.7833333333365, 1213.3333333333358, 1214.083333333336, 1214.3833333333355, 1214.3333333333364, 1213.6333333333362, 1214.7333333333358, 1213.9333333333361, 1213.4333333333361, 1213.5333333333365, 1213.2833333333367, 1212.8333333333353, 1213.5833333333358, 1214.1333333333362, 1213.8833333333362, 1212.583333333336, 1214.2833333333358, 1214.7333333333363, 1214.1333333333366, 1214.5333333333367, 1214.7333333333363, 1214.0833333333362, 1214.7833333333363, 1214.7333333333363, 1214.250000000003, 1214.8333333333364, 1213.833333333336, 1213.8333333333358, 1214.1333333333364, 1214.8333333333367, 1214.533333333336, 1213.2333333333363, 1214.183333333336, 1213.583333333336, 1213.6833333333361, 1213.2833333333358, 1213.3833333333362, 1214.683333333336, 1213.7333333333358, 1213.6833333333363, 1214.5833333333358, 1214.6833333333368, 1213.7833333333365, 1213.5833333333364, 1214.7333333333368, 1212.7333333333354, 1214.8833333333364, 1214.033333333337, 1214.4833333333365, 1214.4333333333363, 1213.2833333333363, 1212.933333333336, 1213.983333333336, 1213.2833333333358, 1214.033333333336, 1214.4333333333368, 1215.3333333333364, 1213.7833333333351, 1214.4833333333356, 1213.9333333333366, 1213.5333333333365, 1214.183333333336, 1213.383333333336, 1213.7333333333365, 1213.5833333333362, 1213.6333333333362, 1214.6833333333361, 1214.133333333336, 1214.4333333333366, 1213.733333333336, 1214.0833333333364, 1213.9333333333366, 1214.0333333333367, 1214.2333333333365, 1213.2333333333358, 1213.5833333333367, 1213.4833333333365, 1213.9333333333361, 1213.9833333333365, 1214.1833333333361, 1214.733333333336, 1214.2833333333363, 1214.1333333333357, 1213.7333333333368, 1214.9833333333358], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.1833333333361, 1214.183333333336, 1213.8333333333362, 1213.883333333336, 1214.733333333336, 1214.1333333333364, 1214.0333333333367, 1214.1833333333361, 1215.6833333333361, 1213.533333333336, 1214.5833333333364, 1214.5833333333371, 1214.583333333336, 1213.0833333333362, 1213.9333333333366, 1214.7833333333365, 1213.3333333333358, 1214.083333333336, 1214.3833333333355, 1214.3333333333364, 1213.6333333333362, 1214.7333333333358, 1213.9333333333361, 1213.4333333333361, 1213.5333333333365, 1213.2833333333367, 1212.8333333333353, 1213.5833333333358, 1214.1333333333362, 1213.8833333333362, 1212.583333333336, 1214.2833333333358, 1214.7333333333363, 1214.1333333333366, 1214.5333333333367, 1214.7333333333363, 1214.0833333333362, 1214.7833333333363, 1214.7333333333363, 1214.250000000003, 1214.8333333333364, 1213.833333333336, 1213.8333333333358, 1214.1333333333364, 1214.8333333333367, 1214.533333333336, 1213.2333333333363, 1214.183333333336, 1213.583333333336, 1213.6833333333361, 1213.2833333333358, 1213.3833333333362, 1214.683333333336, 1213.7333333333358, 1213.6833333333363, 1214.5833333333358, 1214.6833333333368, 1213.7833333333365, 1213.5833333333364, 1214.7333333333368, 1212.7333333333354, 1214.8833333333364, 1214.033333333337, 1214.4833333333365, 1214.4333333333363, 1213.2833333333363, 1212.933333333336, 1213.983333333336, 1213.2833333333358, 1214.033333333336, 1214.4333333333368, 1215.3333333333364, 1213.7833333333351, 1214.4833333333356, 1213.9333333333366, 1213.5333333333365, 1214.183333333336, 1213.383333333336, 1213.7333333333365, 1213.5833333333362, 1213.6333333333362, 1214.6833333333361, 1214.133333333336, 1214.4333333333366, 1213.733333333336, 1214.0833333333364, 1213.9333333333366, 1214.0333333333367, 1214.2333333333365, 1213.2333333333358, 1213.5833333333367, 1213.4833333333365, 1213.9333333333361, 1213.9833333333365, 1214.1833333333361, 1214.733333333336, 1214.2833333333363, 1214.1333333333357, 1213.7333333333368, 1214.9833333333358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24256993807030774, "mean_inference_ms": 2.0675823744038335, "mean_action_processing_ms": 0.09117166534483509, "mean_env_wait_ms": 1.540051857635011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006979942321777344, "StateBufferConnector_ms": 0.003448963165283203, "ViewRequirementAgentConnector_ms": 0.0887594223022461}, "num_episodes": 24, "episode_return_max": 1215.6833333333361, "episode_return_min": 1212.583333333336, "episode_return_mean": 1214.0435000000027, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332100, "num_agent_steps_trained": 331800, "num_env_steps_sampled": 332100, "num_env_steps_trained": 331800, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 216.00403755105592, "num_env_steps_trained_throughput_per_sec": 201.6037683809855, "timesteps_total": 332100, "num_env_steps_sampled_lifetime": 332100, "num_agent_steps_sampled_lifetime": 332100, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 332100, "timers": {"training_iteration_time_ms": 10372.735, "restore_workers_time_ms": 0.026, "training_step_time_ms": 709.255, "sample_time_ms": 693.321, "synch_weights_time_ms": 14.404}, "counters": {"num_env_steps_sampled": 332100, "num_env_steps_trained": 331800, "num_agent_steps_sampled": 332100, "num_agent_steps_trained": 331800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2214, "num_samples_added_to_queue": 332100}, "done": false, "training_iteration": 132, "trial_id": "27800_00000", "date": "2024-10-12_15-50-40", "timestamp": 1728744640, "time_this_iter_s": 10.427145957946777, "time_total_s": 1366.2075159549713, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948950b50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1366.2075159549713, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 22.506666666666668, "ram_util_percent": 59.94666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3557.87353515625, "policy_loss": -399.2359619140625, "entropy": 4.427183628082275, "entropy_coeff": 0.01, "var_gnorm": 18.045101165771484, "vf_loss": 397039.125, "vf_explained_var": 0.6344743967056274}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1115.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 334650, "num_env_steps_trained": 334500, "num_agent_steps_sampled": 334650, "num_agent_steps_trained": 334500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2231, "num_samples_added_to_queue": 334500, "learner_queue": {"size_count": 1115, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.359, "learner_load_time_ms": 0.305, "learner_load_wait_time_ms": 1162.129, "learner_dequeue_time_ms": 10139.914}}, "env_runners": {"episode_reward_max": 1215.8833333333364, "episode_reward_min": 1212.583333333336, "episode_reward_mean": 1214.0425000000025, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.583333333336}, "policy_reward_max": {"default_policy": 1215.8833333333364}, "policy_reward_mean": {"default_policy": 1214.0425000000025}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0381, "num_moves_min": 0.0, "num_moves_max": 0.13, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0008, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.162855, "num_slav_min": 0.16163333333333335, "num_slav_max": 0.16383333333333333, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5379646619323405, "mean_cluster_cpu_util_min": 0.5356786863394005, "mean_cluster_cpu_util_max": 0.5399323634859349, "mean_cluster_mem_util_mean": 0.3416261181434599, "mean_cluster_mem_util_min": 0.3410537974683544, "mean_cluster_mem_util_max": 0.3420137130801688, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4428249999999996, "reward_sla_mean_min": -2.4575, "reward_sla_mean_max": -2.4245, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.28250000000003, "reward_sla_sum_min": -245.75, "reward_sla_sum_max": -242.45, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3101.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.5333333333365, 1213.2833333333367, 1212.8333333333353, 1213.5833333333358, 1214.1333333333362, 1213.8833333333362, 1212.583333333336, 1214.2833333333358, 1214.7333333333363, 1214.1333333333366, 1214.5333333333367, 1214.7333333333363, 1214.0833333333362, 1214.7833333333363, 1214.7333333333363, 1214.250000000003, 1214.8333333333364, 1213.833333333336, 1213.8333333333358, 1214.1333333333364, 1214.8333333333367, 1214.533333333336, 1213.2333333333363, 1214.183333333336, 1213.583333333336, 1213.6833333333361, 1213.2833333333358, 1213.3833333333362, 1214.683333333336, 1213.7333333333358, 1213.6833333333363, 1214.5833333333358, 1214.6833333333368, 1213.7833333333365, 1213.5833333333364, 1214.7333333333368, 1212.7333333333354, 1214.8833333333364, 1214.033333333337, 1214.4833333333365, 1214.4333333333363, 1213.2833333333363, 1212.933333333336, 1213.983333333336, 1213.2833333333358, 1214.033333333336, 1214.4333333333368, 1215.3333333333364, 1213.7833333333351, 1214.4833333333356, 1213.9333333333366, 1213.5333333333365, 1214.183333333336, 1213.383333333336, 1213.7333333333365, 1213.5833333333362, 1213.6333333333362, 1214.6833333333361, 1214.133333333336, 1214.4333333333366, 1213.733333333336, 1214.0833333333364, 1213.9333333333366, 1214.0333333333367, 1214.2333333333365, 1213.2333333333358, 1213.5833333333367, 1213.4833333333365, 1213.9333333333361, 1213.9833333333365, 1214.1833333333361, 1214.733333333336, 1214.2833333333363, 1214.1333333333357, 1213.7333333333368, 1214.9833333333358, 1215.8833333333364, 1213.9333333333361, 1214.2833333333358, 1213.3833333333362, 1214.033333333336, 1214.4333333333357, 1215.0833333333362, 1215.0333333333365, 1213.8833333333366, 1214.5833333333367, 1213.9333333333366, 1213.4333333333361, 1214.1833333333368, 1213.683333333336, 1213.5833333333362, 1214.4333333333363, 1214.1333333333364, 1213.733333333336, 1212.9833333333358, 1214.1833333333363, 1213.6333333333369, 1214.4333333333361, 1214.6333333333362, 1214.1833333333361], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.5333333333365, 1213.2833333333367, 1212.8333333333353, 1213.5833333333358, 1214.1333333333362, 1213.8833333333362, 1212.583333333336, 1214.2833333333358, 1214.7333333333363, 1214.1333333333366, 1214.5333333333367, 1214.7333333333363, 1214.0833333333362, 1214.7833333333363, 1214.7333333333363, 1214.250000000003, 1214.8333333333364, 1213.833333333336, 1213.8333333333358, 1214.1333333333364, 1214.8333333333367, 1214.533333333336, 1213.2333333333363, 1214.183333333336, 1213.583333333336, 1213.6833333333361, 1213.2833333333358, 1213.3833333333362, 1214.683333333336, 1213.7333333333358, 1213.6833333333363, 1214.5833333333358, 1214.6833333333368, 1213.7833333333365, 1213.5833333333364, 1214.7333333333368, 1212.7333333333354, 1214.8833333333364, 1214.033333333337, 1214.4833333333365, 1214.4333333333363, 1213.2833333333363, 1212.933333333336, 1213.983333333336, 1213.2833333333358, 1214.033333333336, 1214.4333333333368, 1215.3333333333364, 1213.7833333333351, 1214.4833333333356, 1213.9333333333366, 1213.5333333333365, 1214.183333333336, 1213.383333333336, 1213.7333333333365, 1213.5833333333362, 1213.6333333333362, 1214.6833333333361, 1214.133333333336, 1214.4333333333366, 1213.733333333336, 1214.0833333333364, 1213.9333333333366, 1214.0333333333367, 1214.2333333333365, 1213.2333333333358, 1213.5833333333367, 1213.4833333333365, 1213.9333333333361, 1213.9833333333365, 1214.1833333333361, 1214.733333333336, 1214.2833333333363, 1214.1333333333357, 1213.7333333333368, 1214.9833333333358, 1215.8833333333364, 1213.9333333333361, 1214.2833333333358, 1213.3833333333362, 1214.033333333336, 1214.4333333333357, 1215.0833333333362, 1215.0333333333365, 1213.8833333333366, 1214.5833333333367, 1213.9333333333366, 1213.4333333333361, 1214.1833333333368, 1213.683333333336, 1213.5833333333362, 1214.4333333333363, 1214.1333333333364, 1213.733333333336, 1212.9833333333358, 1214.1833333333363, 1213.6333333333369, 1214.4333333333361, 1214.6333333333362, 1214.1833333333361]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2425915161567061, "mean_inference_ms": 2.0680991094046357, "mean_action_processing_ms": 0.09118260969178603, "mean_env_wait_ms": 1.5403328522143176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069081783294677734, "StateBufferConnector_ms": 0.003336191177368164, "ViewRequirementAgentConnector_ms": 0.0864262580871582}, "num_episodes": 24, "episode_return_max": 1215.8833333333364, "episode_return_min": 1212.583333333336, "episode_return_mean": 1214.0425000000025, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 334650, "num_agent_steps_trained": 334500, "num_env_steps_sampled": 334650, "num_env_steps_trained": 334500, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 247.14952894283556, "num_env_steps_trained_throughput_per_sec": 261.68773652770824, "timesteps_total": 334650, "num_env_steps_sampled_lifetime": 334650, "num_agent_steps_sampled_lifetime": 334650, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 334650, "timers": {"training_iteration_time_ms": 10389.356, "restore_workers_time_ms": 0.016, "training_step_time_ms": 599.683, "sample_time_ms": 584.416, "synch_weights_time_ms": 13.709}, "counters": {"num_env_steps_sampled": 334650, "num_env_steps_trained": 334500, "num_agent_steps_sampled": 334650, "num_agent_steps_trained": 334500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2231, "num_samples_added_to_queue": 334500}, "done": false, "training_iteration": 133, "trial_id": "27800_00000", "date": "2024-10-12_15-50-50", "timestamp": 1728744650, "time_this_iter_s": 10.32965874671936, "time_total_s": 1376.5371747016907, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948950790>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1376.5371747016907, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 15.585714285714284, "ram_util_percent": 60.47142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4648.92431640625, "policy_loss": 695.7171020507812, "entropy": 4.415787696838379, "entropy_coeff": 0.01, "var_gnorm": 18.073877334594727, "vf_loss": 396645.46875, "vf_explained_var": 0.6324614882469177}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1123.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 337200, "num_env_steps_trained": 336900, "num_agent_steps_sampled": 337200, "num_agent_steps_trained": 336900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2248, "num_samples_added_to_queue": 337200, "learner_queue": {"size_count": 1123, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 52.986, "learner_load_time_ms": 0.275, "learner_load_wait_time_ms": 1179.482, "learner_dequeue_time_ms": 10098.452}}, "env_runners": {"episode_reward_max": 1215.8833333333364, "episode_reward_min": 1211.8666666666693, "episode_reward_mean": 1214.0411666666696, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.8666666666693}, "policy_reward_max": {"default_policy": 1215.8833333333364}, "policy_reward_mean": {"default_policy": 1214.0411666666696}, "custom_metrics": {"num_consolidated_mean": 2.9998, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.036500000000000005, "num_moves_min": 0.0, "num_moves_max": 0.13, "mean_accuracy_mean": 43.63314333333333, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0012, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16281700000000002, "num_slav_min": 0.16163333333333335, "num_slav_max": 0.16373333333333334, "cpu_conserved_cost_mean": 7.9994000000000005, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5380458564633055, "mean_cluster_cpu_util_min": 0.5356786863394005, "mean_cluster_cpu_util_max": 0.5399323634859349, "mean_cluster_mem_util_mean": 0.3416347822752519, "mean_cluster_mem_util_min": 0.34093881856540087, "mean_cluster_mem_util_max": 0.3420984806897442, "reward_consolidation_mean_mean": 6.249583333333334, "reward_consolidation_mean_min": 6.229166666666668, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.33308333333336, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4422549999999994, "reward_sla_mean_min": -2.4560000000000004, "reward_sla_mean_max": -2.4245, "reward_consolidation_sum_mean": 624.9583333333334, "reward_consolidation_sum_min": 622.9166666666667, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3083333333362, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.22549999999998, "reward_sla_sum_min": -245.60000000000002, "reward_sla_sum_max": -242.45, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1895.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.3833333333362, 1214.683333333336, 1213.7333333333358, 1213.6833333333363, 1214.5833333333358, 1214.6833333333368, 1213.7833333333365, 1213.5833333333364, 1214.7333333333368, 1212.7333333333354, 1214.8833333333364, 1214.033333333337, 1214.4833333333365, 1214.4333333333363, 1213.2833333333363, 1212.933333333336, 1213.983333333336, 1213.2833333333358, 1214.033333333336, 1214.4333333333368, 1215.3333333333364, 1213.7833333333351, 1214.4833333333356, 1213.9333333333366, 1213.5333333333365, 1214.183333333336, 1213.383333333336, 1213.7333333333365, 1213.5833333333362, 1213.6333333333362, 1214.6833333333361, 1214.133333333336, 1214.4333333333366, 1213.733333333336, 1214.0833333333364, 1213.9333333333366, 1214.0333333333367, 1214.2333333333365, 1213.2333333333358, 1213.5833333333367, 1213.4833333333365, 1213.9333333333361, 1213.9833333333365, 1214.1833333333361, 1214.733333333336, 1214.2833333333363, 1214.1333333333357, 1213.7333333333368, 1214.9833333333358, 1215.8833333333364, 1213.9333333333361, 1214.2833333333358, 1213.3833333333362, 1214.033333333336, 1214.4333333333357, 1215.0833333333362, 1215.0333333333365, 1213.8833333333366, 1214.5833333333367, 1213.9333333333366, 1213.4333333333361, 1214.1833333333368, 1213.683333333336, 1213.5833333333362, 1214.4333333333363, 1214.1333333333364, 1213.733333333336, 1212.9833333333358, 1214.1833333333363, 1213.6333333333369, 1214.4333333333361, 1214.6333333333362, 1214.1833333333361, 1213.2333333333358, 1214.7833333333365, 1214.7833333333367, 1214.5833333333362, 1213.4333333333366, 1213.833333333337, 1213.3500000000026, 1214.4333333333363, 1214.0333333333356, 1213.9833333333368, 1214.3333333333358, 1214.683333333336, 1214.8333333333362, 1214.3833333333369, 1214.4333333333363, 1214.3833333333362, 1213.3333333333362, 1212.8000000000027, 1213.7833333333367, 1214.0333333333365, 1214.7833333333356, 1212.3000000000034, 1211.8666666666693, 1215.7333333333354, 1214.6833333333366, 1213.0333333333367, 1214.0833333333364], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.3833333333362, 1214.683333333336, 1213.7333333333358, 1213.6833333333363, 1214.5833333333358, 1214.6833333333368, 1213.7833333333365, 1213.5833333333364, 1214.7333333333368, 1212.7333333333354, 1214.8833333333364, 1214.033333333337, 1214.4833333333365, 1214.4333333333363, 1213.2833333333363, 1212.933333333336, 1213.983333333336, 1213.2833333333358, 1214.033333333336, 1214.4333333333368, 1215.3333333333364, 1213.7833333333351, 1214.4833333333356, 1213.9333333333366, 1213.5333333333365, 1214.183333333336, 1213.383333333336, 1213.7333333333365, 1213.5833333333362, 1213.6333333333362, 1214.6833333333361, 1214.133333333336, 1214.4333333333366, 1213.733333333336, 1214.0833333333364, 1213.9333333333366, 1214.0333333333367, 1214.2333333333365, 1213.2333333333358, 1213.5833333333367, 1213.4833333333365, 1213.9333333333361, 1213.9833333333365, 1214.1833333333361, 1214.733333333336, 1214.2833333333363, 1214.1333333333357, 1213.7333333333368, 1214.9833333333358, 1215.8833333333364, 1213.9333333333361, 1214.2833333333358, 1213.3833333333362, 1214.033333333336, 1214.4333333333357, 1215.0833333333362, 1215.0333333333365, 1213.8833333333366, 1214.5833333333367, 1213.9333333333366, 1213.4333333333361, 1214.1833333333368, 1213.683333333336, 1213.5833333333362, 1214.4333333333363, 1214.1333333333364, 1213.733333333336, 1212.9833333333358, 1214.1833333333363, 1213.6333333333369, 1214.4333333333361, 1214.6333333333362, 1214.1833333333361, 1213.2333333333358, 1214.7833333333365, 1214.7833333333367, 1214.5833333333362, 1213.4333333333366, 1213.833333333337, 1213.3500000000026, 1214.4333333333363, 1214.0333333333356, 1213.9833333333368, 1214.3333333333358, 1214.683333333336, 1214.8333333333362, 1214.3833333333369, 1214.4333333333363, 1214.3833333333362, 1213.3333333333362, 1212.8000000000027, 1213.7833333333367, 1214.0333333333365, 1214.7833333333356, 1212.3000000000034, 1211.8666666666693, 1215.7333333333354, 1214.6833333333366, 1213.0333333333367, 1214.0833333333364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24261047775238231, "mean_inference_ms": 2.0686798814726965, "mean_action_processing_ms": 0.09118889740189702, "mean_env_wait_ms": 1.540609926801033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006844997406005859, "StateBufferConnector_ms": 0.0032842159271240234, "ViewRequirementAgentConnector_ms": 0.08517241477966309}, "num_episodes": 27, "episode_return_max": 1215.8833333333364, "episode_return_min": 1211.8666666666693, "episode_return_mean": 1214.0411666666696, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 337200, "num_agent_steps_trained": 336900, "num_env_steps_sampled": 337200, "num_env_steps_trained": 336900, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 243.05802358769338, "num_env_steps_trained_throughput_per_sec": 228.76049278841728, "timesteps_total": 337200, "num_env_steps_sampled_lifetime": 337200, "num_agent_steps_sampled_lifetime": 337200, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 337200, "timers": {"training_iteration_time_ms": 10430.856, "restore_workers_time_ms": 0.015, "training_step_time_ms": 621.706, "sample_time_ms": 606.147, "synch_weights_time_ms": 13.863}, "counters": {"num_env_steps_sampled": 337200, "num_env_steps_trained": 336900, "num_agent_steps_sampled": 337200, "num_agent_steps_trained": 336900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2248, "num_samples_added_to_queue": 337200}, "done": false, "training_iteration": 134, "trial_id": "27800_00000", "date": "2024-10-12_15-51-01", "timestamp": 1728744661, "time_this_iter_s": 10.502520322799683, "time_total_s": 1387.0396950244904, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948952a10>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1387.0396950244904, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 15.579999999999997, "ram_util_percent": 60.45333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2770.750244140625, "policy_loss": -1153.1239013671875, "entropy": 4.4754486083984375, "entropy_coeff": 0.01, "var_gnorm": 18.111040115356445, "vf_loss": 393730.0625, "vf_explained_var": 0.6349091529846191}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1132.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 339900, "num_env_steps_trained": 339600, "num_agent_steps_sampled": 339900, "num_agent_steps_trained": 339600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2266, "num_samples_added_to_queue": 339900, "learner_queue": {"size_count": 1132, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.224, "learner_load_time_ms": 0.293, "learner_load_wait_time_ms": 1139.845, "learner_dequeue_time_ms": 10071.382}}, "env_runners": {"episode_reward_max": 1215.8833333333364, "episode_reward_min": 1211.8666666666693, "episode_reward_mean": 1214.0766666666696, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.8666666666693}, "policy_reward_max": {"default_policy": 1215.8833333333364}, "policy_reward_mean": {"default_policy": 1214.0766666666696}, "custom_metrics": {"num_consolidated_mean": 2.9998, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0388, "num_moves_min": 0.0, "num_moves_max": 0.14, "mean_accuracy_mean": 43.63314333333333, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0006, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16279333333333335, "num_slav_min": 0.16163333333333335, "num_slav_max": 0.16360000000000002, "cpu_conserved_cost_mean": 7.9994000000000005, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5380536370755503, "mean_cluster_cpu_util_min": 0.5360006435006435, "mean_cluster_cpu_util_max": 0.5399135870564442, "mean_cluster_mem_util_mean": 0.3416301303765177, "mean_cluster_mem_util_min": 0.34093881856540087, "mean_cluster_mem_util_max": 0.3420984806897442, "reward_consolidation_mean_mean": 6.249583333333334, "reward_consolidation_mean_min": 6.229166666666668, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.33308333333336, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4419, "reward_sla_mean_min": -2.4539999999999997, "reward_sla_mean_max": -2.4245, "reward_consolidation_sum_mean": 624.9583333333334, "reward_consolidation_sum_min": 622.9166666666667, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3083333333362, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.19, "reward_sla_sum_min": -245.39999999999998, "reward_sla_sum_max": -242.45, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2482.0, "global_timestep_min": 800, "global_timestep_max": 4100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.7333333333365, 1213.5833333333362, 1213.6333333333362, 1214.6833333333361, 1214.133333333336, 1214.4333333333366, 1213.733333333336, 1214.0833333333364, 1213.9333333333366, 1214.0333333333367, 1214.2333333333365, 1213.2333333333358, 1213.5833333333367, 1213.4833333333365, 1213.9333333333361, 1213.9833333333365, 1214.1833333333361, 1214.733333333336, 1214.2833333333363, 1214.1333333333357, 1213.7333333333368, 1214.9833333333358, 1215.8833333333364, 1213.9333333333361, 1214.2833333333358, 1213.3833333333362, 1214.033333333336, 1214.4333333333357, 1215.0833333333362, 1215.0333333333365, 1213.8833333333366, 1214.5833333333367, 1213.9333333333366, 1213.4333333333361, 1214.1833333333368, 1213.683333333336, 1213.5833333333362, 1214.4333333333363, 1214.1333333333364, 1213.733333333336, 1212.9833333333358, 1214.1833333333363, 1213.6333333333369, 1214.4333333333361, 1214.6333333333362, 1214.1833333333361, 1213.2333333333358, 1214.7833333333365, 1214.7833333333367, 1214.5833333333362, 1213.4333333333366, 1213.833333333337, 1213.3500000000026, 1214.4333333333363, 1214.0333333333356, 1213.9833333333368, 1214.3333333333358, 1214.683333333336, 1214.8333333333362, 1214.3833333333369, 1214.4333333333363, 1214.3833333333362, 1213.3333333333362, 1212.8000000000027, 1213.7833333333367, 1214.0333333333365, 1214.7833333333356, 1212.3000000000034, 1211.8666666666693, 1215.7333333333354, 1214.6833333333366, 1213.0333333333367, 1214.0833333333364, 1214.8333333333362, 1212.9333333333361, 1213.3833333333364, 1214.3333333333362, 1213.8833333333362, 1214.9833333333365, 1214.1833333333361, 1213.9333333333363, 1214.0333333333363, 1213.9333333333366, 1214.083333333336, 1213.933333333336, 1214.2333333333365, 1214.2833333333365, 1215.0333333333363, 1213.6333333333362, 1213.183333333336, 1214.5833333333362, 1214.6333333333362, 1214.2833333333356, 1213.6333333333355, 1214.3833333333364, 1213.983333333336, 1214.3833333333362, 1214.033333333336, 1214.783333333336, 1214.0333333333367], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.7333333333365, 1213.5833333333362, 1213.6333333333362, 1214.6833333333361, 1214.133333333336, 1214.4333333333366, 1213.733333333336, 1214.0833333333364, 1213.9333333333366, 1214.0333333333367, 1214.2333333333365, 1213.2333333333358, 1213.5833333333367, 1213.4833333333365, 1213.9333333333361, 1213.9833333333365, 1214.1833333333361, 1214.733333333336, 1214.2833333333363, 1214.1333333333357, 1213.7333333333368, 1214.9833333333358, 1215.8833333333364, 1213.9333333333361, 1214.2833333333358, 1213.3833333333362, 1214.033333333336, 1214.4333333333357, 1215.0833333333362, 1215.0333333333365, 1213.8833333333366, 1214.5833333333367, 1213.9333333333366, 1213.4333333333361, 1214.1833333333368, 1213.683333333336, 1213.5833333333362, 1214.4333333333363, 1214.1333333333364, 1213.733333333336, 1212.9833333333358, 1214.1833333333363, 1213.6333333333369, 1214.4333333333361, 1214.6333333333362, 1214.1833333333361, 1213.2333333333358, 1214.7833333333365, 1214.7833333333367, 1214.5833333333362, 1213.4333333333366, 1213.833333333337, 1213.3500000000026, 1214.4333333333363, 1214.0333333333356, 1213.9833333333368, 1214.3333333333358, 1214.683333333336, 1214.8333333333362, 1214.3833333333369, 1214.4333333333363, 1214.3833333333362, 1213.3333333333362, 1212.8000000000027, 1213.7833333333367, 1214.0333333333365, 1214.7833333333356, 1212.3000000000034, 1211.8666666666693, 1215.7333333333354, 1214.6833333333366, 1213.0333333333367, 1214.0833333333364, 1214.8333333333362, 1212.9333333333361, 1213.3833333333364, 1214.3333333333362, 1213.8833333333362, 1214.9833333333365, 1214.1833333333361, 1213.9333333333363, 1214.0333333333363, 1213.9333333333366, 1214.083333333336, 1213.933333333336, 1214.2333333333365, 1214.2833333333365, 1215.0333333333363, 1213.6333333333362, 1213.183333333336, 1214.5833333333362, 1214.6333333333362, 1214.2833333333356, 1213.6333333333355, 1214.3833333333364, 1213.983333333336, 1214.3833333333362, 1214.033333333336, 1214.783333333336, 1214.0333333333367]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24256256968714787, "mean_inference_ms": 2.0673108542549934, "mean_action_processing_ms": 0.09116640706541748, "mean_env_wait_ms": 1.5403475233511497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00682830810546875, "StateBufferConnector_ms": 0.003305196762084961, "ViewRequirementAgentConnector_ms": 0.08434486389160156}, "num_episodes": 27, "episode_return_max": 1215.8833333333364, "episode_return_min": 1211.8666666666693, "episode_return_mean": 1214.0766666666696, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 339900, "num_agent_steps_trained": 339600, "num_env_steps_sampled": 339900, "num_env_steps_trained": 339600, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 255.1170604123911, "num_env_steps_trained_throughput_per_sec": 255.1170604123911, "timesteps_total": 339900, "num_env_steps_sampled_lifetime": 339900, "num_agent_steps_sampled_lifetime": 339900, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 339900, "timers": {"training_iteration_time_ms": 10427.839, "restore_workers_time_ms": 0.024, "training_step_time_ms": 578.795, "sample_time_ms": 564.176, "synch_weights_time_ms": 13.163}, "counters": {"num_env_steps_sampled": 339900, "num_env_steps_trained": 339600, "num_agent_steps_sampled": 339900, "num_agent_steps_trained": 339600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2266, "num_samples_added_to_queue": 339900}, "done": false, "training_iteration": 135, "trial_id": "27800_00000", "date": "2024-10-12_15-51-11", "timestamp": 1728744671, "time_this_iter_s": 10.595121622085571, "time_total_s": 1397.634816646576, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948952dd0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1397.634816646576, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 15.925, "ram_util_percent": 59.33125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3415.4482421875, "policy_loss": -496.3309326171875, "entropy": 4.556661128997803, "entropy_coeff": 0.01, "var_gnorm": 18.122312545776367, "vf_loss": 392544.9375, "vf_explained_var": 0.6357309818267822}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1141.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 342450, "num_env_steps_trained": 342300, "num_agent_steps_sampled": 342450, "num_agent_steps_trained": 342300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2283, "num_samples_added_to_queue": 342300, "learner_queue": {"size_count": 1141, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 64.56, "learner_load_time_ms": 0.294, "learner_load_wait_time_ms": 1144.629, "learner_dequeue_time_ms": 10037.533}}, "env_runners": {"episode_reward_max": 1215.7333333333354, "episode_reward_min": 1211.8666666666693, "episode_reward_mean": 1214.0466666666696, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.8666666666693}, "policy_reward_max": {"default_policy": 1215.7333333333354}, "policy_reward_mean": {"default_policy": 1214.0466666666696}, "custom_metrics": {"num_consolidated_mean": 2.9998, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0409, "num_moves_min": 0.0, "num_moves_max": 0.2, "mean_accuracy_mean": 43.63314333333333, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0006, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16281333333333334, "num_slav_min": 0.1617333333333333, "num_slav_max": 0.1637, "cpu_conserved_cost_mean": 7.9994000000000005, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5381258015359291, "mean_cluster_cpu_util_min": 0.5364933236808236, "mean_cluster_cpu_util_max": 0.5401885686707115, "mean_cluster_mem_util_mean": 0.34164593206428134, "mean_cluster_mem_util_min": 0.34093881856540087, "mean_cluster_mem_util_max": 0.3420984806897442, "reward_consolidation_mean_mean": 6.249583333333334, "reward_consolidation_mean_min": 6.229166666666668, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.33308333333336, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4421999999999997, "reward_sla_mean_min": -2.4555000000000002, "reward_sla_mean_max": -2.426, "reward_consolidation_sum_mean": 624.9583333333334, "reward_consolidation_sum_min": 622.9166666666667, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3083333333362, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.22, "reward_sla_sum_min": -245.55, "reward_sla_sum_max": -242.6, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3282.0, "global_timestep_min": 1600, "global_timestep_max": 4900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.2833333333358, 1213.3833333333362, 1214.033333333336, 1214.4333333333357, 1215.0833333333362, 1215.0333333333365, 1213.8833333333366, 1214.5833333333367, 1213.9333333333366, 1213.4333333333361, 1214.1833333333368, 1213.683333333336, 1213.5833333333362, 1214.4333333333363, 1214.1333333333364, 1213.733333333336, 1212.9833333333358, 1214.1833333333363, 1213.6333333333369, 1214.4333333333361, 1214.6333333333362, 1214.1833333333361, 1213.2333333333358, 1214.7833333333365, 1214.7833333333367, 1214.5833333333362, 1213.4333333333366, 1213.833333333337, 1213.3500000000026, 1214.4333333333363, 1214.0333333333356, 1213.9833333333368, 1214.3333333333358, 1214.683333333336, 1214.8333333333362, 1214.3833333333369, 1214.4333333333363, 1214.3833333333362, 1213.3333333333362, 1212.8000000000027, 1213.7833333333367, 1214.0333333333365, 1214.7833333333356, 1212.3000000000034, 1211.8666666666693, 1215.7333333333354, 1214.6833333333366, 1213.0333333333367, 1214.0833333333364, 1214.8333333333362, 1212.9333333333361, 1213.3833333333364, 1214.3333333333362, 1213.8833333333362, 1214.9833333333365, 1214.1833333333361, 1213.9333333333363, 1214.0333333333363, 1213.9333333333366, 1214.083333333336, 1213.933333333336, 1214.2333333333365, 1214.2833333333365, 1215.0333333333363, 1213.6333333333362, 1213.183333333336, 1214.5833333333362, 1214.6333333333362, 1214.2833333333356, 1213.6333333333355, 1214.3833333333364, 1213.983333333336, 1214.3833333333362, 1214.033333333336, 1214.783333333336, 1214.0333333333367, 1214.0333333333367, 1213.933333333336, 1214.5833333333358, 1214.4833333333365, 1213.8833333333366, 1214.0833333333364, 1214.533333333336, 1213.8333333333364, 1213.083333333336, 1215.133333333336, 1213.9333333333357, 1215.3333333333371, 1213.0333333333365, 1214.033333333336, 1213.7833333333365, 1214.933333333337, 1213.683333333336, 1213.483333333337, 1213.3833333333364, 1213.6833333333361, 1212.7833333333363, 1213.5333333333367, 1214.433333333336, 1213.6833333333366], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.2833333333358, 1213.3833333333362, 1214.033333333336, 1214.4333333333357, 1215.0833333333362, 1215.0333333333365, 1213.8833333333366, 1214.5833333333367, 1213.9333333333366, 1213.4333333333361, 1214.1833333333368, 1213.683333333336, 1213.5833333333362, 1214.4333333333363, 1214.1333333333364, 1213.733333333336, 1212.9833333333358, 1214.1833333333363, 1213.6333333333369, 1214.4333333333361, 1214.6333333333362, 1214.1833333333361, 1213.2333333333358, 1214.7833333333365, 1214.7833333333367, 1214.5833333333362, 1213.4333333333366, 1213.833333333337, 1213.3500000000026, 1214.4333333333363, 1214.0333333333356, 1213.9833333333368, 1214.3333333333358, 1214.683333333336, 1214.8333333333362, 1214.3833333333369, 1214.4333333333363, 1214.3833333333362, 1213.3333333333362, 1212.8000000000027, 1213.7833333333367, 1214.0333333333365, 1214.7833333333356, 1212.3000000000034, 1211.8666666666693, 1215.7333333333354, 1214.6833333333366, 1213.0333333333367, 1214.0833333333364, 1214.8333333333362, 1212.9333333333361, 1213.3833333333364, 1214.3333333333362, 1213.8833333333362, 1214.9833333333365, 1214.1833333333361, 1213.9333333333363, 1214.0333333333363, 1213.9333333333366, 1214.083333333336, 1213.933333333336, 1214.2333333333365, 1214.2833333333365, 1215.0333333333363, 1213.6333333333362, 1213.183333333336, 1214.5833333333362, 1214.6333333333362, 1214.2833333333356, 1213.6333333333355, 1214.3833333333364, 1213.983333333336, 1214.3833333333362, 1214.033333333336, 1214.783333333336, 1214.0333333333367, 1214.0333333333367, 1213.933333333336, 1214.5833333333358, 1214.4833333333365, 1213.8833333333366, 1214.0833333333364, 1214.533333333336, 1213.8333333333364, 1213.083333333336, 1215.133333333336, 1213.9333333333357, 1215.3333333333371, 1213.0333333333365, 1214.033333333336, 1213.7833333333365, 1214.933333333337, 1213.683333333336, 1213.483333333337, 1213.3833333333364, 1213.6833333333361, 1212.7833333333363, 1213.5333333333367, 1214.433333333336, 1213.6833333333366]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.242515160765308, "mean_inference_ms": 2.0669199098500677, "mean_action_processing_ms": 0.09114846425443288, "mean_env_wait_ms": 1.5401456540923426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063457489013671875, "StateBufferConnector_ms": 0.0032241344451904297, "ViewRequirementAgentConnector_ms": 0.08244585990905762}, "num_episodes": 24, "episode_return_max": 1215.7333333333354, "episode_return_min": 1211.8666666666693, "episode_return_mean": 1214.0466666666696, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 342450, "num_agent_steps_trained": 342300, "num_env_steps_sampled": 342450, "num_env_steps_trained": 342300, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 250.71865855372914, "num_env_steps_trained_throughput_per_sec": 265.4668149392426, "timesteps_total": 342450, "num_env_steps_sampled_lifetime": 342450, "num_agent_steps_sampled_lifetime": 342450, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 342450, "timers": {"training_iteration_time_ms": 10405.291, "restore_workers_time_ms": 0.013, "training_step_time_ms": 602.637, "sample_time_ms": 586.72, "synch_weights_time_ms": 14.422}, "counters": {"num_env_steps_sampled": 342450, "num_env_steps_trained": 342300, "num_agent_steps_sampled": 342450, "num_agent_steps_trained": 342300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2283, "num_samples_added_to_queue": 342300}, "done": false, "training_iteration": 136, "trial_id": "27800_00000", "date": "2024-10-12_15-51-21", "timestamp": 1728744681, "time_this_iter_s": 10.189186334609985, "time_total_s": 1407.824002981186, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b47e50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1407.824002981186, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 15.385714285714286, "ram_util_percent": 58.92857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2721.2802734375, "policy_loss": -1005.8721313476562, "entropy": 4.846039295196533, "entropy_coeff": 0.01, "var_gnorm": 18.118728637695312, "vf_loss": 374169.0625, "vf_explained_var": 0.64222252368927}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1149.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 345000, "num_env_steps_trained": 344700, "num_agent_steps_sampled": 345000, "num_agent_steps_trained": 344700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2300, "num_samples_added_to_queue": 345000, "learner_queue": {"size_count": 1149, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.03, "learner_load_time_ms": 0.294, "learner_load_wait_time_ms": 1145.054, "learner_dequeue_time_ms": 10003.044}}, "env_runners": {"episode_reward_max": 1215.7333333333354, "episode_reward_min": 1211.8666666666693, "episode_reward_mean": 1214.0456666666696, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.8666666666693}, "policy_reward_max": {"default_policy": 1215.7333333333354}, "policy_reward_mean": {"default_policy": 1214.0456666666696}, "custom_metrics": {"num_consolidated_mean": 2.9998, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.09869999999999997, "num_moves_min": 0.0, "num_moves_max": 0.44, "mean_accuracy_mean": 43.63314333333333, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0006, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16281400000000004, "num_slav_min": 0.1617333333333333, "num_slav_max": 0.1637, "cpu_conserved_cost_mean": 7.9994000000000005, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5380414552636364, "mean_cluster_cpu_util_min": 0.5355525257400258, "mean_cluster_cpu_util_max": 0.5401885686707115, "mean_cluster_mem_util_mean": 0.3416362168744079, "mean_cluster_mem_util_min": 0.34093881856540087, "mean_cluster_mem_util_max": 0.3420984806897442, "reward_consolidation_mean_mean": 6.249583333333334, "reward_consolidation_mean_min": 6.229166666666668, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.33308333333336, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4422099999999998, "reward_sla_mean_min": -2.4555000000000002, "reward_sla_mean_max": -2.426, "reward_consolidation_sum_mean": 624.9583333333334, "reward_consolidation_sum_min": 622.9166666666667, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3083333333362, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.22099999999998, "reward_sla_sum_min": -245.55, "reward_sla_sum_max": -242.6, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4175.0, "global_timestep_min": 2400, "global_timestep_max": 5800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.833333333337, 1213.3500000000026, 1214.4333333333363, 1214.0333333333356, 1213.9833333333368, 1214.3333333333358, 1214.683333333336, 1214.8333333333362, 1214.3833333333369, 1214.4333333333363, 1214.3833333333362, 1213.3333333333362, 1212.8000000000027, 1213.7833333333367, 1214.0333333333365, 1214.7833333333356, 1212.3000000000034, 1211.8666666666693, 1215.7333333333354, 1214.6833333333366, 1213.0333333333367, 1214.0833333333364, 1214.8333333333362, 1212.9333333333361, 1213.3833333333364, 1214.3333333333362, 1213.8833333333362, 1214.9833333333365, 1214.1833333333361, 1213.9333333333363, 1214.0333333333363, 1213.9333333333366, 1214.083333333336, 1213.933333333336, 1214.2333333333365, 1214.2833333333365, 1215.0333333333363, 1213.6333333333362, 1213.183333333336, 1214.5833333333362, 1214.6333333333362, 1214.2833333333356, 1213.6333333333355, 1214.3833333333364, 1213.983333333336, 1214.3833333333362, 1214.033333333336, 1214.783333333336, 1214.0333333333367, 1214.0333333333367, 1213.933333333336, 1214.5833333333358, 1214.4833333333365, 1213.8833333333366, 1214.0833333333364, 1214.533333333336, 1213.8333333333364, 1213.083333333336, 1215.133333333336, 1213.9333333333357, 1215.3333333333371, 1213.0333333333365, 1214.033333333336, 1213.7833333333365, 1214.933333333337, 1213.683333333336, 1213.483333333337, 1213.3833333333364, 1213.6833333333361, 1212.7833333333363, 1213.5333333333367, 1214.433333333336, 1213.6833333333366, 1214.7333333333365, 1214.633333333336, 1214.8333333333362, 1214.183333333336, 1213.2833333333365, 1213.6333333333373, 1214.033333333336, 1214.1833333333363, 1213.683333333336, 1214.4333333333366, 1213.2333333333363, 1215.1333333333362, 1214.0833333333362, 1213.7333333333358, 1212.9333333333363, 1213.1333333333357, 1214.283333333337, 1213.8833333333362, 1214.1833333333361, 1214.683333333336, 1214.0333333333367, 1215.1333333333366, 1214.5833333333367, 1213.8833333333364, 1214.383333333336, 1213.733333333336, 1213.9333333333368], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.833333333337, 1213.3500000000026, 1214.4333333333363, 1214.0333333333356, 1213.9833333333368, 1214.3333333333358, 1214.683333333336, 1214.8333333333362, 1214.3833333333369, 1214.4333333333363, 1214.3833333333362, 1213.3333333333362, 1212.8000000000027, 1213.7833333333367, 1214.0333333333365, 1214.7833333333356, 1212.3000000000034, 1211.8666666666693, 1215.7333333333354, 1214.6833333333366, 1213.0333333333367, 1214.0833333333364, 1214.8333333333362, 1212.9333333333361, 1213.3833333333364, 1214.3333333333362, 1213.8833333333362, 1214.9833333333365, 1214.1833333333361, 1213.9333333333363, 1214.0333333333363, 1213.9333333333366, 1214.083333333336, 1213.933333333336, 1214.2333333333365, 1214.2833333333365, 1215.0333333333363, 1213.6333333333362, 1213.183333333336, 1214.5833333333362, 1214.6333333333362, 1214.2833333333356, 1213.6333333333355, 1214.3833333333364, 1213.983333333336, 1214.3833333333362, 1214.033333333336, 1214.783333333336, 1214.0333333333367, 1214.0333333333367, 1213.933333333336, 1214.5833333333358, 1214.4833333333365, 1213.8833333333366, 1214.0833333333364, 1214.533333333336, 1213.8333333333364, 1213.083333333336, 1215.133333333336, 1213.9333333333357, 1215.3333333333371, 1213.0333333333365, 1214.033333333336, 1213.7833333333365, 1214.933333333337, 1213.683333333336, 1213.483333333337, 1213.3833333333364, 1213.6833333333361, 1212.7833333333363, 1213.5333333333367, 1214.433333333336, 1213.6833333333366, 1214.7333333333365, 1214.633333333336, 1214.8333333333362, 1214.183333333336, 1213.2833333333365, 1213.6333333333373, 1214.033333333336, 1214.1833333333363, 1213.683333333336, 1214.4333333333366, 1213.2333333333363, 1215.1333333333362, 1214.0833333333362, 1213.7333333333358, 1212.9333333333363, 1213.1333333333357, 1214.283333333337, 1213.8833333333362, 1214.1833333333361, 1214.683333333336, 1214.0333333333367, 1215.1333333333366, 1214.5833333333367, 1213.8833333333364, 1214.383333333336, 1213.733333333336, 1213.9333333333368]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24239079873552213, "mean_inference_ms": 2.063057792726033, "mean_action_processing_ms": 0.09108837144050874, "mean_env_wait_ms": 1.5390606218478888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006157636642456055, "StateBufferConnector_ms": 0.003211498260498047, "ViewRequirementAgentConnector_ms": 0.08226156234741211}, "num_episodes": 27, "episode_return_max": 1215.7333333333354, "episode_return_min": 1211.8666666666693, "episode_return_mean": 1214.0456666666696, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 345000, "num_agent_steps_trained": 344700, "num_env_steps_sampled": 345000, "num_env_steps_trained": 344700, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 248.4809578416595, "num_env_steps_trained_throughput_per_sec": 233.86443090979716, "timesteps_total": 345000, "num_env_steps_sampled_lifetime": 345000, "num_agent_steps_sampled_lifetime": 345000, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 345000, "timers": {"training_iteration_time_ms": 10370.248, "restore_workers_time_ms": 0.013, "training_step_time_ms": 607.99, "sample_time_ms": 592.409, "synch_weights_time_ms": 14.036}, "counters": {"num_env_steps_sampled": 345000, "num_env_steps_trained": 344700, "num_agent_steps_sampled": 345000, "num_agent_steps_trained": 344700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2300, "num_samples_added_to_queue": 345000}, "done": false, "training_iteration": 137, "trial_id": "27800_00000", "date": "2024-10-12_15-51-32", "timestamp": 1728744692, "time_this_iter_s": 10.272544860839844, "time_total_s": 1418.0965478420258, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948952c80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1418.0965478420258, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 15.500000000000002, "ram_util_percent": 59.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4394.30078125, "policy_loss": 536.9703979492188, "entropy": 4.529382228851318, "entropy_coeff": 0.01, "var_gnorm": 18.10872459411621, "vf_loss": 387091.84375, "vf_explained_var": 0.6367495059967041}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1157.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 347400, "num_env_steps_trained": 347100, "num_agent_steps_sampled": 347400, "num_agent_steps_trained": 347100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2316, "num_samples_added_to_queue": 347400, "learner_queue": {"size_count": 1157, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.133, "learner_load_time_ms": 0.269, "learner_load_wait_time_ms": 1230.884, "learner_dequeue_time_ms": 9991.616}}, "env_runners": {"episode_reward_max": 1215.3333333333371, "episode_reward_min": 1212.233333333336, "episode_reward_mean": 1214.022750000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.233333333336}, "policy_reward_max": {"default_policy": 1215.3333333333371}, "policy_reward_mean": {"default_policy": 1214.022750000003}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.1448, "num_moves_min": 0.0, "num_moves_max": 0.44, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16286816666666667, "num_slav_min": 0.16158333333333336, "num_slav_max": 0.16406666666666667, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.537911719640559, "mean_cluster_cpu_util_min": 0.5355525257400258, "mean_cluster_cpu_util_max": 0.5401885686707115, "mean_cluster_mem_util_mean": 0.3416260126582278, "mean_cluster_mem_util_min": 0.3412120253164557, "mean_cluster_mem_util_max": 0.34209388185654016, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4430224999999997, "reward_sla_mean_min": -2.461, "reward_sla_mean_max": -2.42375, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.30225, "reward_sla_sum_min": -246.1, "reward_sla_sum_max": -242.375, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4982.0, "global_timestep_min": 3300, "global_timestep_max": 6600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.3833333333364, 1214.3333333333362, 1213.8833333333362, 1214.9833333333365, 1214.1833333333361, 1213.9333333333363, 1214.0333333333363, 1213.9333333333366, 1214.083333333336, 1213.933333333336, 1214.2333333333365, 1214.2833333333365, 1215.0333333333363, 1213.6333333333362, 1213.183333333336, 1214.5833333333362, 1214.6333333333362, 1214.2833333333356, 1213.6333333333355, 1214.3833333333364, 1213.983333333336, 1214.3833333333362, 1214.033333333336, 1214.783333333336, 1214.0333333333367, 1214.0333333333367, 1213.933333333336, 1214.5833333333358, 1214.4833333333365, 1213.8833333333366, 1214.0833333333364, 1214.533333333336, 1213.8333333333364, 1213.083333333336, 1215.133333333336, 1213.9333333333357, 1215.3333333333371, 1213.0333333333365, 1214.033333333336, 1213.7833333333365, 1214.933333333337, 1213.683333333336, 1213.483333333337, 1213.3833333333364, 1213.6833333333361, 1212.7833333333363, 1213.5333333333367, 1214.433333333336, 1213.6833333333366, 1214.7333333333365, 1214.633333333336, 1214.8333333333362, 1214.183333333336, 1213.2833333333365, 1213.6333333333373, 1214.033333333336, 1214.1833333333363, 1213.683333333336, 1214.4333333333366, 1213.2333333333363, 1215.1333333333362, 1214.0833333333362, 1213.7333333333358, 1212.9333333333363, 1213.1333333333357, 1214.283333333337, 1213.8833333333362, 1214.1833333333361, 1214.683333333336, 1214.0333333333367, 1215.1333333333366, 1214.5833333333367, 1213.8833333333364, 1214.383333333336, 1213.733333333336, 1213.9333333333368, 1213.733333333336, 1213.033333333336, 1214.0333333333363, 1214.133333333336, 1213.1333333333364, 1215.1250000000027, 1214.3833333333366, 1214.2833333333363, 1213.883333333336, 1213.9833333333363, 1213.1833333333361, 1213.6833333333357, 1214.1833333333363, 1214.6333333333353, 1213.9333333333363, 1213.133333333336, 1212.233333333336, 1212.9833333333365, 1212.933333333336, 1212.983333333336, 1214.383333333336, 1214.7833333333358, 1215.283333333336, 1214.5333333333358], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.3833333333364, 1214.3333333333362, 1213.8833333333362, 1214.9833333333365, 1214.1833333333361, 1213.9333333333363, 1214.0333333333363, 1213.9333333333366, 1214.083333333336, 1213.933333333336, 1214.2333333333365, 1214.2833333333365, 1215.0333333333363, 1213.6333333333362, 1213.183333333336, 1214.5833333333362, 1214.6333333333362, 1214.2833333333356, 1213.6333333333355, 1214.3833333333364, 1213.983333333336, 1214.3833333333362, 1214.033333333336, 1214.783333333336, 1214.0333333333367, 1214.0333333333367, 1213.933333333336, 1214.5833333333358, 1214.4833333333365, 1213.8833333333366, 1214.0833333333364, 1214.533333333336, 1213.8333333333364, 1213.083333333336, 1215.133333333336, 1213.9333333333357, 1215.3333333333371, 1213.0333333333365, 1214.033333333336, 1213.7833333333365, 1214.933333333337, 1213.683333333336, 1213.483333333337, 1213.3833333333364, 1213.6833333333361, 1212.7833333333363, 1213.5333333333367, 1214.433333333336, 1213.6833333333366, 1214.7333333333365, 1214.633333333336, 1214.8333333333362, 1214.183333333336, 1213.2833333333365, 1213.6333333333373, 1214.033333333336, 1214.1833333333363, 1213.683333333336, 1214.4333333333366, 1213.2333333333363, 1215.1333333333362, 1214.0833333333362, 1213.7333333333358, 1212.9333333333363, 1213.1333333333357, 1214.283333333337, 1213.8833333333362, 1214.1833333333361, 1214.683333333336, 1214.0333333333367, 1215.1333333333366, 1214.5833333333367, 1213.8833333333364, 1214.383333333336, 1213.733333333336, 1213.9333333333368, 1213.733333333336, 1213.033333333336, 1214.0333333333363, 1214.133333333336, 1213.1333333333364, 1215.1250000000027, 1214.3833333333366, 1214.2833333333363, 1213.883333333336, 1213.9833333333363, 1213.1833333333361, 1213.6833333333357, 1214.1833333333363, 1214.6333333333353, 1213.9333333333363, 1213.133333333336, 1212.233333333336, 1212.9833333333365, 1212.933333333336, 1212.983333333336, 1214.383333333336, 1214.7833333333358, 1215.283333333336, 1214.5333333333358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2424428989973827, "mean_inference_ms": 2.0663361953608996, "mean_action_processing_ms": 0.0911155567700811, "mean_env_wait_ms": 1.5398168970294748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006139278411865234, "StateBufferConnector_ms": 0.003241300582885742, "ViewRequirementAgentConnector_ms": 0.08318710327148438}, "num_episodes": 24, "episode_return_max": 1215.3333333333371, "episode_return_min": 1212.233333333336, "episode_return_mean": 1214.022750000003, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 347400, "num_agent_steps_trained": 347100, "num_env_steps_sampled": 347400, "num_env_steps_trained": 347100, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 229.41974658175542, "num_env_steps_trained_throughput_per_sec": 229.41974658175542, "timesteps_total": 347400, "num_env_steps_sampled_lifetime": 347400, "num_agent_steps_sampled_lifetime": 347400, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 347400, "timers": {"training_iteration_time_ms": 10403.408, "restore_workers_time_ms": 0.013, "training_step_time_ms": 637.093, "sample_time_ms": 621.806, "synch_weights_time_ms": 13.888}, "counters": {"num_env_steps_sampled": 347400, "num_env_steps_trained": 347100, "num_agent_steps_sampled": 347400, "num_agent_steps_trained": 347100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2316, "num_samples_added_to_queue": 347400}, "done": false, "training_iteration": 138, "trial_id": "27800_00000", "date": "2024-10-12_15-51-42", "timestamp": 1728744702, "time_this_iter_s": 10.47168755531311, "time_total_s": 1428.5682353973389, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c0250>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1428.5682353973389, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 18.860000000000003, "ram_util_percent": 59.95333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3926.418212890625, "policy_loss": -56.05650329589844, "entropy": 4.450725078582764, "entropy_coeff": 0.01, "var_gnorm": 18.09743309020996, "vf_loss": 399582.6875, "vf_explained_var": 0.6328051090240479}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1166.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 349950, "num_env_steps_trained": 349800, "num_agent_steps_sampled": 349950, "num_agent_steps_trained": 349800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2333, "num_samples_added_to_queue": 349800, "learner_queue": {"size_count": 1166, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.927, "learner_load_time_ms": 0.291, "learner_load_wait_time_ms": 1142.407, "learner_dequeue_time_ms": 9976.063}}, "env_runners": {"episode_reward_max": 1215.3333333333371, "episode_reward_min": 1212.233333333336, "episode_reward_mean": 1213.980250000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.233333333336}, "policy_reward_max": {"default_policy": 1215.3333333333371}, "policy_reward_mean": {"default_policy": 1213.980250000003}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.1504, "num_moves_min": 0.0, "num_moves_max": 0.44, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16289649999999997, "num_slav_min": 0.16158333333333336, "num_slav_max": 0.16406666666666667, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5378687429904394, "mean_cluster_cpu_util_min": 0.5350746345835631, "mean_cluster_cpu_util_max": 0.5401885686707115, "mean_cluster_mem_util_mean": 0.3416162025316456, "mean_cluster_mem_util_min": 0.3412120253164557, "mean_cluster_mem_util_max": 0.34196729957805905, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4434474999999996, "reward_sla_mean_min": -2.461, "reward_sla_mean_max": -2.42375, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.34474999999995, "reward_sla_sum_min": -246.1, "reward_sla_sum_max": -242.375, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5783.0, "global_timestep_min": 4100, "global_timestep_max": 7400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.0333333333367, 1214.0333333333367, 1213.933333333336, 1214.5833333333358, 1214.4833333333365, 1213.8833333333366, 1214.0833333333364, 1214.533333333336, 1213.8333333333364, 1213.083333333336, 1215.133333333336, 1213.9333333333357, 1215.3333333333371, 1213.0333333333365, 1214.033333333336, 1213.7833333333365, 1214.933333333337, 1213.683333333336, 1213.483333333337, 1213.3833333333364, 1213.6833333333361, 1212.7833333333363, 1213.5333333333367, 1214.433333333336, 1213.6833333333366, 1214.7333333333365, 1214.633333333336, 1214.8333333333362, 1214.183333333336, 1213.2833333333365, 1213.6333333333373, 1214.033333333336, 1214.1833333333363, 1213.683333333336, 1214.4333333333366, 1213.2333333333363, 1215.1333333333362, 1214.0833333333362, 1213.7333333333358, 1212.9333333333363, 1213.1333333333357, 1214.283333333337, 1213.8833333333362, 1214.1833333333361, 1214.683333333336, 1214.0333333333367, 1215.1333333333366, 1214.5833333333367, 1213.8833333333364, 1214.383333333336, 1213.733333333336, 1213.9333333333368, 1213.733333333336, 1213.033333333336, 1214.0333333333363, 1214.133333333336, 1213.1333333333364, 1215.1250000000027, 1214.3833333333366, 1214.2833333333363, 1213.883333333336, 1213.9833333333363, 1213.1833333333361, 1213.6833333333357, 1214.1833333333363, 1214.6333333333353, 1213.9333333333363, 1213.133333333336, 1212.233333333336, 1212.9833333333365, 1212.933333333336, 1212.983333333336, 1214.383333333336, 1214.7833333333358, 1215.283333333336, 1214.5333333333358, 1213.9333333333366, 1214.7333333333363, 1215.1833333333363, 1214.283333333336, 1214.1833333333361, 1214.3833333333364, 1213.8833333333362, 1215.0333333333365, 1213.9833333333363, 1213.683333333337, 1213.933333333336, 1213.733333333336, 1213.483333333336, 1213.0833333333362, 1212.7833333333356, 1213.8333333333362, 1215.1833333333361, 1213.4833333333356, 1212.9333333333357, 1214.6833333333361, 1214.283333333336, 1214.2833333333365, 1214.2833333333363, 1212.2333333333365], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.0333333333367, 1214.0333333333367, 1213.933333333336, 1214.5833333333358, 1214.4833333333365, 1213.8833333333366, 1214.0833333333364, 1214.533333333336, 1213.8333333333364, 1213.083333333336, 1215.133333333336, 1213.9333333333357, 1215.3333333333371, 1213.0333333333365, 1214.033333333336, 1213.7833333333365, 1214.933333333337, 1213.683333333336, 1213.483333333337, 1213.3833333333364, 1213.6833333333361, 1212.7833333333363, 1213.5333333333367, 1214.433333333336, 1213.6833333333366, 1214.7333333333365, 1214.633333333336, 1214.8333333333362, 1214.183333333336, 1213.2833333333365, 1213.6333333333373, 1214.033333333336, 1214.1833333333363, 1213.683333333336, 1214.4333333333366, 1213.2333333333363, 1215.1333333333362, 1214.0833333333362, 1213.7333333333358, 1212.9333333333363, 1213.1333333333357, 1214.283333333337, 1213.8833333333362, 1214.1833333333361, 1214.683333333336, 1214.0333333333367, 1215.1333333333366, 1214.5833333333367, 1213.8833333333364, 1214.383333333336, 1213.733333333336, 1213.9333333333368, 1213.733333333336, 1213.033333333336, 1214.0333333333363, 1214.133333333336, 1213.1333333333364, 1215.1250000000027, 1214.3833333333366, 1214.2833333333363, 1213.883333333336, 1213.9833333333363, 1213.1833333333361, 1213.6833333333357, 1214.1833333333363, 1214.6333333333353, 1213.9333333333363, 1213.133333333336, 1212.233333333336, 1212.9833333333365, 1212.933333333336, 1212.983333333336, 1214.383333333336, 1214.7833333333358, 1215.283333333336, 1214.5333333333358, 1213.9333333333366, 1214.7333333333363, 1215.1833333333363, 1214.283333333336, 1214.1833333333361, 1214.3833333333364, 1213.8833333333362, 1215.0333333333365, 1213.9833333333363, 1213.683333333337, 1213.933333333336, 1213.733333333336, 1213.483333333336, 1213.0833333333362, 1212.7833333333356, 1213.8333333333362, 1215.1833333333361, 1213.4833333333356, 1212.9333333333357, 1214.6833333333361, 1214.283333333336, 1214.2833333333365, 1214.2833333333363, 1212.2333333333365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24246944590810904, "mean_inference_ms": 2.0678945274926006, "mean_action_processing_ms": 0.09112457666859033, "mean_env_wait_ms": 1.5401664425293524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006133317947387695, "StateBufferConnector_ms": 0.003223896026611328, "ViewRequirementAgentConnector_ms": 0.08311128616333008}, "num_episodes": 24, "episode_return_max": 1215.3333333333371, "episode_return_min": 1212.233333333336, "episode_return_mean": 1213.980250000003, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 349950, "num_agent_steps_trained": 349800, "num_env_steps_sampled": 349950, "num_env_steps_trained": 349800, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 249.82714224789405, "num_env_steps_trained_throughput_per_sec": 264.52285649777014, "timesteps_total": 349950, "num_env_steps_sampled_lifetime": 349950, "num_agent_steps_sampled_lifetime": 349950, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 349950, "timers": {"training_iteration_time_ms": 10398.4, "restore_workers_time_ms": 0.014, "training_step_time_ms": 605.21, "sample_time_ms": 590.287, "synch_weights_time_ms": 13.479}, "counters": {"num_env_steps_sampled": 349950, "num_env_steps_trained": 349800, "num_agent_steps_sampled": 349950, "num_agent_steps_trained": 349800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2333, "num_samples_added_to_queue": 349800}, "done": false, "training_iteration": 139, "trial_id": "27800_00000", "date": "2024-10-12_15-51-52", "timestamp": 1728744712, "time_this_iter_s": 10.221820831298828, "time_total_s": 1438.7900562286377, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948951f00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1438.7900562286377, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 15.564285714285715, "ram_util_percent": 60.15714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3788.3681640625, "policy_loss": -324.7392578125, "entropy": 4.457802772521973, "entropy_coeff": 0.01, "var_gnorm": 18.09292221069336, "vf_loss": 412648.125, "vf_explained_var": 0.6261658668518066}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1174.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 352500, "num_env_steps_trained": 352200, "num_agent_steps_sampled": 352500, "num_agent_steps_trained": 352200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2350, "num_samples_added_to_queue": 352500, "learner_queue": {"size_count": 1174, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.664, "learner_load_time_ms": 0.325, "learner_load_wait_time_ms": 1169.485, "learner_dequeue_time_ms": 9963.295}}, "env_runners": {"episode_reward_max": 1215.283333333336, "episode_reward_min": 1212.233333333336, "episode_reward_mean": 1213.966250000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.233333333336}, "policy_reward_max": {"default_policy": 1215.283333333336}, "policy_reward_mean": {"default_policy": 1213.966250000003}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.14740000000000003, "num_moves_min": 0.0, "num_moves_max": 0.44, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0008, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16290583333333333, "num_slav_min": 0.16158333333333336, "num_slav_max": 0.16406666666666667, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5379428865600294, "mean_cluster_cpu_util_min": 0.5350746345835631, "mean_cluster_cpu_util_max": 0.5397461849604708, "mean_cluster_mem_util_mean": 0.3416273206751054, "mean_cluster_mem_util_min": 0.3412120253164557, "mean_cluster_mem_util_max": 0.3420854430379746, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4435875, "reward_sla_mean_min": -2.461, "reward_sla_mean_max": -2.42375, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.35874999999993, "reward_sla_sum_min": -246.1, "reward_sla_sum_max": -242.375, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5512.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.8333333333362, 1214.183333333336, 1213.2833333333365, 1213.6333333333373, 1214.033333333336, 1214.1833333333363, 1213.683333333336, 1214.4333333333366, 1213.2333333333363, 1215.1333333333362, 1214.0833333333362, 1213.7333333333358, 1212.9333333333363, 1213.1333333333357, 1214.283333333337, 1213.8833333333362, 1214.1833333333361, 1214.683333333336, 1214.0333333333367, 1215.1333333333366, 1214.5833333333367, 1213.8833333333364, 1214.383333333336, 1213.733333333336, 1213.9333333333368, 1213.733333333336, 1213.033333333336, 1214.0333333333363, 1214.133333333336, 1213.1333333333364, 1215.1250000000027, 1214.3833333333366, 1214.2833333333363, 1213.883333333336, 1213.9833333333363, 1213.1833333333361, 1213.6833333333357, 1214.1833333333363, 1214.6333333333353, 1213.9333333333363, 1213.133333333336, 1212.233333333336, 1212.9833333333365, 1212.933333333336, 1212.983333333336, 1214.383333333336, 1214.7833333333358, 1215.283333333336, 1214.5333333333358, 1213.9333333333366, 1214.7333333333363, 1215.1833333333363, 1214.283333333336, 1214.1833333333361, 1214.3833333333364, 1213.8833333333362, 1215.0333333333365, 1213.9833333333363, 1213.683333333337, 1213.933333333336, 1213.733333333336, 1213.483333333336, 1213.0833333333362, 1212.7833333333356, 1213.8333333333362, 1215.1833333333361, 1213.4833333333356, 1212.9333333333357, 1214.6833333333361, 1214.283333333336, 1214.2833333333365, 1214.2833333333363, 1212.2333333333365, 1214.9833333333363, 1212.8833333333366, 1214.4833333333363, 1214.683333333336, 1214.5333333333367, 1214.6833333333363, 1214.333333333335, 1213.3333333333358, 1213.2333333333363, 1212.7833333333363, 1213.8833333333362, 1213.8833333333357, 1212.9833333333358, 1214.3333333333367, 1214.1833333333366, 1213.8833333333355, 1213.9833333333363, 1214.2333333333363, 1214.1333333333362, 1214.2833333333358, 1213.9833333333358, 1213.2333333333358, 1214.4833333333354, 1213.9833333333363, 1214.583333333337, 1213.3333333333355, 1213.9833333333363], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.8333333333362, 1214.183333333336, 1213.2833333333365, 1213.6333333333373, 1214.033333333336, 1214.1833333333363, 1213.683333333336, 1214.4333333333366, 1213.2333333333363, 1215.1333333333362, 1214.0833333333362, 1213.7333333333358, 1212.9333333333363, 1213.1333333333357, 1214.283333333337, 1213.8833333333362, 1214.1833333333361, 1214.683333333336, 1214.0333333333367, 1215.1333333333366, 1214.5833333333367, 1213.8833333333364, 1214.383333333336, 1213.733333333336, 1213.9333333333368, 1213.733333333336, 1213.033333333336, 1214.0333333333363, 1214.133333333336, 1213.1333333333364, 1215.1250000000027, 1214.3833333333366, 1214.2833333333363, 1213.883333333336, 1213.9833333333363, 1213.1833333333361, 1213.6833333333357, 1214.1833333333363, 1214.6333333333353, 1213.9333333333363, 1213.133333333336, 1212.233333333336, 1212.9833333333365, 1212.933333333336, 1212.983333333336, 1214.383333333336, 1214.7833333333358, 1215.283333333336, 1214.5333333333358, 1213.9333333333366, 1214.7333333333363, 1215.1833333333363, 1214.283333333336, 1214.1833333333361, 1214.3833333333364, 1213.8833333333362, 1215.0333333333365, 1213.9833333333363, 1213.683333333337, 1213.933333333336, 1213.733333333336, 1213.483333333336, 1213.0833333333362, 1212.7833333333356, 1213.8333333333362, 1215.1833333333361, 1213.4833333333356, 1212.9333333333357, 1214.6833333333361, 1214.283333333336, 1214.2833333333365, 1214.2833333333363, 1212.2333333333365, 1214.9833333333363, 1212.8833333333366, 1214.4833333333363, 1214.683333333336, 1214.5333333333367, 1214.6833333333363, 1214.333333333335, 1213.3333333333358, 1213.2333333333363, 1212.7833333333363, 1213.8833333333362, 1213.8833333333357, 1212.9833333333358, 1214.3333333333367, 1214.1833333333366, 1213.8833333333355, 1213.9833333333363, 1214.2333333333363, 1214.1333333333362, 1214.2833333333358, 1213.9833333333358, 1213.2333333333358, 1214.4833333333354, 1213.9833333333363, 1214.583333333337, 1213.3333333333355, 1213.9833333333363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2424229241425845, "mean_inference_ms": 2.066296346016123, "mean_action_processing_ms": 0.09109852625297807, "mean_env_wait_ms": 1.539809609821961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006215572357177734, "StateBufferConnector_ms": 0.003245830535888672, "ViewRequirementAgentConnector_ms": 0.08336257934570312}, "num_episodes": 27, "episode_return_max": 1215.283333333336, "episode_return_min": 1212.233333333336, "episode_return_mean": 1213.966250000003, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352500, "num_agent_steps_trained": 352200, "num_env_steps_sampled": 352500, "num_env_steps_trained": 352200, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 245.25853308709355, "num_env_steps_trained_throughput_per_sec": 230.83156055255864, "timesteps_total": 352500, "num_env_steps_sampled_lifetime": 352500, "num_agent_steps_sampled_lifetime": 352500, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 352500, "timers": {"training_iteration_time_ms": 10385.847, "restore_workers_time_ms": 0.015, "training_step_time_ms": 602.251, "sample_time_ms": 586.376, "synch_weights_time_ms": 14.384}, "counters": {"num_env_steps_sampled": 352500, "num_env_steps_trained": 352200, "num_agent_steps_sampled": 352500, "num_agent_steps_trained": 352200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2350, "num_samples_added_to_queue": 352500}, "done": false, "training_iteration": 140, "trial_id": "27800_00000", "date": "2024-10-12_15-52-03", "timestamp": 1728744723, "time_this_iter_s": 10.409547328948975, "time_total_s": 1449.1996035575867, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d448e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1449.1996035575867, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 15.506666666666668, "ram_util_percent": 60.239999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3826.9228515625, "policy_loss": 260.71319580078125, "entropy": 4.765144348144531, "entropy_coeff": 0.01, "var_gnorm": 18.068626403808594, "vf_loss": 358050.53125, "vf_explained_var": 0.6567879915237427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1183.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 355050, "num_env_steps_trained": 354900, "num_agent_steps_sampled": 355050, "num_agent_steps_trained": 354900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2367, "num_samples_added_to_queue": 354900, "learner_queue": {"size_count": 1183, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.37, "learner_load_time_ms": 0.318, "learner_load_wait_time_ms": 1144.6, "learner_dequeue_time_ms": 9934.605}}, "env_runners": {"episode_reward_max": 1215.733333333336, "episode_reward_min": 1212.233333333336, "episode_reward_mean": 1214.020250000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.233333333336}, "policy_reward_max": {"default_policy": 1215.733333333336}, "policy_reward_mean": {"default_policy": 1214.020250000003}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.1174, "num_moves_min": 0.0, "num_moves_max": 0.44, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0008, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16286983333333335, "num_slav_min": 0.16158333333333336, "num_slav_max": 0.16406666666666667, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5382018170849421, "mean_cluster_cpu_util_min": 0.5350746345835631, "mean_cluster_cpu_util_max": 0.5407388651406508, "mean_cluster_mem_util_mean": 0.34166279535864974, "mean_cluster_mem_util_min": 0.3412753164556962, "mean_cluster_mem_util_max": 0.3421223628691984, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4430474999999996, "reward_sla_mean_min": -2.461, "reward_sla_mean_max": -2.42375, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.30474999999998, "reward_sla_sum_min": -246.1, "reward_sla_sum_max": -242.375, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4441.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.9333333333368, 1213.733333333336, 1213.033333333336, 1214.0333333333363, 1214.133333333336, 1213.1333333333364, 1215.1250000000027, 1214.3833333333366, 1214.2833333333363, 1213.883333333336, 1213.9833333333363, 1213.1833333333361, 1213.6833333333357, 1214.1833333333363, 1214.6333333333353, 1213.9333333333363, 1213.133333333336, 1212.233333333336, 1212.9833333333365, 1212.933333333336, 1212.983333333336, 1214.383333333336, 1214.7833333333358, 1215.283333333336, 1214.5333333333358, 1213.9333333333366, 1214.7333333333363, 1215.1833333333363, 1214.283333333336, 1214.1833333333361, 1214.3833333333364, 1213.8833333333362, 1215.0333333333365, 1213.9833333333363, 1213.683333333337, 1213.933333333336, 1213.733333333336, 1213.483333333336, 1213.0833333333362, 1212.7833333333356, 1213.8333333333362, 1215.1833333333361, 1213.4833333333356, 1212.9333333333357, 1214.6833333333361, 1214.283333333336, 1214.2833333333365, 1214.2833333333363, 1212.2333333333365, 1214.9833333333363, 1212.8833333333366, 1214.4833333333363, 1214.683333333336, 1214.5333333333367, 1214.6833333333363, 1214.333333333335, 1213.3333333333358, 1213.2333333333363, 1212.7833333333363, 1213.8833333333362, 1213.8833333333357, 1212.9833333333358, 1214.3333333333367, 1214.1833333333366, 1213.8833333333355, 1213.9833333333363, 1214.2333333333363, 1214.1333333333362, 1214.2833333333358, 1213.9833333333358, 1213.2333333333358, 1214.4833333333354, 1213.9833333333363, 1214.583333333337, 1213.3333333333355, 1213.9833333333363, 1214.3833333333364, 1213.783333333337, 1213.5833333333358, 1214.8333333333367, 1215.3833333333362, 1214.2833333333358, 1214.5833333333362, 1214.5333333333365, 1214.2833333333356, 1214.7333333333363, 1214.133333333336, 1213.483333333336, 1213.883333333336, 1213.5833333333362, 1213.7833333333358, 1214.5833333333362, 1214.1833333333366, 1213.7833333333363, 1213.9333333333366, 1215.2333333333363, 1215.733333333336, 1215.183333333336, 1212.4833333333363, 1214.3333333333364], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.9333333333368, 1213.733333333336, 1213.033333333336, 1214.0333333333363, 1214.133333333336, 1213.1333333333364, 1215.1250000000027, 1214.3833333333366, 1214.2833333333363, 1213.883333333336, 1213.9833333333363, 1213.1833333333361, 1213.6833333333357, 1214.1833333333363, 1214.6333333333353, 1213.9333333333363, 1213.133333333336, 1212.233333333336, 1212.9833333333365, 1212.933333333336, 1212.983333333336, 1214.383333333336, 1214.7833333333358, 1215.283333333336, 1214.5333333333358, 1213.9333333333366, 1214.7333333333363, 1215.1833333333363, 1214.283333333336, 1214.1833333333361, 1214.3833333333364, 1213.8833333333362, 1215.0333333333365, 1213.9833333333363, 1213.683333333337, 1213.933333333336, 1213.733333333336, 1213.483333333336, 1213.0833333333362, 1212.7833333333356, 1213.8333333333362, 1215.1833333333361, 1213.4833333333356, 1212.9333333333357, 1214.6833333333361, 1214.283333333336, 1214.2833333333365, 1214.2833333333363, 1212.2333333333365, 1214.9833333333363, 1212.8833333333366, 1214.4833333333363, 1214.683333333336, 1214.5333333333367, 1214.6833333333363, 1214.333333333335, 1213.3333333333358, 1213.2333333333363, 1212.7833333333363, 1213.8833333333362, 1213.8833333333357, 1212.9833333333358, 1214.3333333333367, 1214.1833333333366, 1213.8833333333355, 1213.9833333333363, 1214.2333333333363, 1214.1333333333362, 1214.2833333333358, 1213.9833333333358, 1213.2333333333358, 1214.4833333333354, 1213.9833333333363, 1214.583333333337, 1213.3333333333355, 1213.9833333333363, 1214.3833333333364, 1213.783333333337, 1213.5833333333358, 1214.8333333333367, 1215.3833333333362, 1214.2833333333358, 1214.5833333333362, 1214.5333333333365, 1214.2833333333356, 1214.7333333333363, 1214.133333333336, 1213.483333333336, 1213.883333333336, 1213.5833333333362, 1213.7833333333358, 1214.5833333333362, 1214.1833333333366, 1213.7833333333363, 1213.9333333333366, 1215.2333333333363, 1215.733333333336, 1215.183333333336, 1212.4833333333363, 1214.3333333333364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2424693282930269, "mean_inference_ms": 2.067984374014049, "mean_action_processing_ms": 0.09111463089637617, "mean_env_wait_ms": 1.5402522967408276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006334781646728516, "StateBufferConnector_ms": 0.003304004669189453, "ViewRequirementAgentConnector_ms": 0.08423948287963867}, "num_episodes": 24, "episode_return_max": 1215.733333333336, "episode_return_min": 1212.233333333336, "episode_return_mean": 1214.020250000003, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 355050, "num_agent_steps_trained": 354900, "num_env_steps_sampled": 355050, "num_env_steps_trained": 354900, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 245.75241623403028, "num_env_steps_trained_throughput_per_sec": 260.208440718385, "timesteps_total": 355050, "num_env_steps_sampled_lifetime": 355050, "num_agent_steps_sampled_lifetime": 355050, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 355050, "timers": {"training_iteration_time_ms": 10368.373, "restore_workers_time_ms": 0.012, "training_step_time_ms": 616.819, "sample_time_ms": 600.849, "synch_weights_time_ms": 14.448}, "counters": {"num_env_steps_sampled": 355050, "num_env_steps_trained": 354900, "num_agent_steps_sampled": 355050, "num_agent_steps_trained": 354900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2367, "num_samples_added_to_queue": 354900}, "done": false, "training_iteration": 141, "trial_id": "27800_00000", "date": "2024-10-12_15-52-13", "timestamp": 1728744733, "time_this_iter_s": 10.385904550552368, "time_total_s": 1459.585508108139, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d44490>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1459.585508108139, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 17.546666666666667, "ram_util_percent": 60.61333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2760.1318359375, "policy_loss": -604.9207763671875, "entropy": 5.125524997711182, "entropy_coeff": 0.01, "var_gnorm": 18.05252456665039, "vf_loss": 338042.9375, "vf_explained_var": 0.657783031463623}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1191.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 357600, "num_env_steps_trained": 357300, "num_agent_steps_sampled": 357600, "num_agent_steps_trained": 357300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2384, "num_samples_added_to_queue": 357600, "learner_queue": {"size_count": 1191, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.372, "learner_load_time_ms": 0.291, "learner_load_wait_time_ms": 1185.8, "learner_dequeue_time_ms": 9810.064}}, "env_runners": {"episode_reward_max": 1215.7333333333363, "episode_reward_min": 1212.133333333336, "episode_reward_mean": 1214.107833333336, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.133333333336}, "policy_reward_max": {"default_policy": 1215.7333333333363}, "policy_reward_mean": {"default_policy": 1214.107833333336}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.17220000000000002, "num_moves_min": 0.0, "num_moves_max": 0.62, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0006, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16281700000000002, "num_slav_min": 0.1617333333333333, "num_slav_max": 0.1641333333333333, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5388378557639272, "mean_cluster_cpu_util_min": 0.5350746345835631, "mean_cluster_cpu_util_max": 0.5415859418091561, "mean_cluster_mem_util_mean": 0.34167167721518993, "mean_cluster_mem_util_min": 0.34123945147679324, "mean_cluster_mem_util_max": 0.3421223628691984, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.442255, "reward_sla_mean_min": -2.4619999999999997, "reward_sla_mean_max": -2.4259999999999997, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.22549999999998, "reward_sla_sum_min": -246.2, "reward_sla_sum_max": -242.59999999999997, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3234.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1215.1833333333363, 1214.283333333336, 1214.1833333333361, 1214.3833333333364, 1213.8833333333362, 1215.0333333333365, 1213.9833333333363, 1213.683333333337, 1213.933333333336, 1213.733333333336, 1213.483333333336, 1213.0833333333362, 1212.7833333333356, 1213.8333333333362, 1215.1833333333361, 1213.4833333333356, 1212.9333333333357, 1214.6833333333361, 1214.283333333336, 1214.2833333333365, 1214.2833333333363, 1212.2333333333365, 1214.9833333333363, 1212.8833333333366, 1214.4833333333363, 1214.683333333336, 1214.5333333333367, 1214.6833333333363, 1214.333333333335, 1213.3333333333358, 1213.2333333333363, 1212.7833333333363, 1213.8833333333362, 1213.8833333333357, 1212.9833333333358, 1214.3333333333367, 1214.1833333333366, 1213.8833333333355, 1213.9833333333363, 1214.2333333333363, 1214.1333333333362, 1214.2833333333358, 1213.9833333333358, 1213.2333333333358, 1214.4833333333354, 1213.9833333333363, 1214.583333333337, 1213.3333333333355, 1213.9833333333363, 1214.3833333333364, 1213.783333333337, 1213.5833333333358, 1214.8333333333367, 1215.3833333333362, 1214.2833333333358, 1214.5833333333362, 1214.5333333333365, 1214.2833333333356, 1214.7333333333363, 1214.133333333336, 1213.483333333336, 1213.883333333336, 1213.5833333333362, 1213.7833333333358, 1214.5833333333362, 1214.1833333333366, 1213.7833333333363, 1213.9333333333366, 1215.2333333333363, 1215.733333333336, 1215.183333333336, 1212.4833333333363, 1214.3333333333364, 1214.633333333336, 1214.2333333333363, 1215.0333333333363, 1214.083333333336, 1213.6333333333355, 1213.3833333333362, 1214.933333333336, 1214.8833333333369, 1214.7333333333356, 1214.1333333333364, 1214.6333333333362, 1213.6333333333353, 1213.9833333333363, 1213.8333333333358, 1215.7333333333363, 1213.5833333333367, 1214.2833333333365, 1214.4333333333368, 1213.0833333333362, 1214.1833333333361, 1214.7833333333367, 1214.3833333333366, 1213.7333333333365, 1215.3333333333364, 1212.133333333336, 1214.4333333333361, 1214.0833333333362], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1215.1833333333363, 1214.283333333336, 1214.1833333333361, 1214.3833333333364, 1213.8833333333362, 1215.0333333333365, 1213.9833333333363, 1213.683333333337, 1213.933333333336, 1213.733333333336, 1213.483333333336, 1213.0833333333362, 1212.7833333333356, 1213.8333333333362, 1215.1833333333361, 1213.4833333333356, 1212.9333333333357, 1214.6833333333361, 1214.283333333336, 1214.2833333333365, 1214.2833333333363, 1212.2333333333365, 1214.9833333333363, 1212.8833333333366, 1214.4833333333363, 1214.683333333336, 1214.5333333333367, 1214.6833333333363, 1214.333333333335, 1213.3333333333358, 1213.2333333333363, 1212.7833333333363, 1213.8833333333362, 1213.8833333333357, 1212.9833333333358, 1214.3333333333367, 1214.1833333333366, 1213.8833333333355, 1213.9833333333363, 1214.2333333333363, 1214.1333333333362, 1214.2833333333358, 1213.9833333333358, 1213.2333333333358, 1214.4833333333354, 1213.9833333333363, 1214.583333333337, 1213.3333333333355, 1213.9833333333363, 1214.3833333333364, 1213.783333333337, 1213.5833333333358, 1214.8333333333367, 1215.3833333333362, 1214.2833333333358, 1214.5833333333362, 1214.5333333333365, 1214.2833333333356, 1214.7333333333363, 1214.133333333336, 1213.483333333336, 1213.883333333336, 1213.5833333333362, 1213.7833333333358, 1214.5833333333362, 1214.1833333333366, 1213.7833333333363, 1213.9333333333366, 1215.2333333333363, 1215.733333333336, 1215.183333333336, 1212.4833333333363, 1214.3333333333364, 1214.633333333336, 1214.2333333333363, 1215.0333333333363, 1214.083333333336, 1213.6333333333355, 1213.3833333333362, 1214.933333333336, 1214.8833333333369, 1214.7333333333356, 1214.1333333333364, 1214.6333333333362, 1213.6333333333353, 1213.9833333333363, 1213.8333333333358, 1215.7333333333363, 1213.5833333333367, 1214.2833333333365, 1214.4333333333368, 1213.0833333333362, 1214.1833333333361, 1214.7833333333367, 1214.3833333333366, 1213.7333333333365, 1215.3333333333364, 1212.133333333336, 1214.4333333333361, 1214.0833333333362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24242567694441938, "mean_inference_ms": 2.066106997504705, "mean_action_processing_ms": 0.09108799800847128, "mean_env_wait_ms": 1.539805454053556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006375789642333984, "StateBufferConnector_ms": 0.0034012794494628906, "ViewRequirementAgentConnector_ms": 0.08437681198120117}, "num_episodes": 27, "episode_return_max": 1215.7333333333363, "episode_return_min": 1212.133333333336, "episode_return_mean": 1214.107833333336, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 357600, "num_agent_steps_trained": 357300, "num_env_steps_sampled": 357600, "num_env_steps_trained": 357300, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 244.29521107870102, "num_env_steps_trained_throughput_per_sec": 229.9249045446598, "timesteps_total": 357600, "num_env_steps_sampled_lifetime": 357600, "num_agent_steps_sampled_lifetime": 357600, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 357600, "timers": {"training_iteration_time_ms": 10370.545, "restore_workers_time_ms": 0.013, "training_step_time_ms": 607.439, "sample_time_ms": 591.891, "synch_weights_time_ms": 14.037}, "counters": {"num_env_steps_sampled": 357600, "num_env_steps_trained": 357300, "num_agent_steps_sampled": 357600, "num_agent_steps_trained": 357300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2384, "num_samples_added_to_queue": 357600}, "done": false, "training_iteration": 142, "trial_id": "27800_00000", "date": "2024-10-12_15-52-24", "timestamp": 1728744744, "time_this_iter_s": 10.448511600494385, "time_total_s": 1470.0340197086334, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f69180>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1470.0340197086334, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 17.286666666666672, "ram_util_percent": 61.113333333333344}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4657.890625, "policy_loss": 1277.8399658203125, "entropy": 5.271968364715576, "entropy_coeff": 0.01, "var_gnorm": 18.044532775878906, "vf_loss": 339586.6875, "vf_explained_var": 0.6516552567481995}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1200.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 360150, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360150, "num_agent_steps_trained": 360000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2401, "num_samples_added_to_queue": 360000, "learner_queue": {"size_count": 1200, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.826, "learner_load_time_ms": 0.284, "learner_load_wait_time_ms": 1157.477, "learner_dequeue_time_ms": 9804.925}}, "env_runners": {"episode_reward_max": 1215.7333333333363, "episode_reward_min": 1212.133333333336, "episode_reward_mean": 1214.1463333333363, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.133333333336}, "policy_reward_max": {"default_policy": 1215.7333333333363}, "policy_reward_mean": {"default_policy": 1214.1463333333363}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.3118, "num_moves_min": 0.0, "num_moves_max": 0.84, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0006, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16279133333333334, "num_slav_min": 0.1617333333333333, "num_slav_max": 0.1641333333333333, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5392397380033094, "mean_cluster_cpu_util_min": 0.5360564212171355, "mean_cluster_cpu_util_max": 0.5415859418091561, "mean_cluster_mem_util_mean": 0.34166177215189875, "mean_cluster_mem_util_min": 0.34122362869198297, "mean_cluster_mem_util_max": 0.3421223628691984, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4418699999999998, "reward_sla_mean_min": -2.4619999999999997, "reward_sla_mean_max": -2.4259999999999997, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.187, "reward_sla_sum_min": -246.2, "reward_sla_sum_max": -242.59999999999997, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2162.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.4833333333363, 1214.683333333336, 1214.5333333333367, 1214.6833333333363, 1214.333333333335, 1213.3333333333358, 1213.2333333333363, 1212.7833333333363, 1213.8833333333362, 1213.8833333333357, 1212.9833333333358, 1214.3333333333367, 1214.1833333333366, 1213.8833333333355, 1213.9833333333363, 1214.2333333333363, 1214.1333333333362, 1214.2833333333358, 1213.9833333333358, 1213.2333333333358, 1214.4833333333354, 1213.9833333333363, 1214.583333333337, 1213.3333333333355, 1213.9833333333363, 1214.3833333333364, 1213.783333333337, 1213.5833333333358, 1214.8333333333367, 1215.3833333333362, 1214.2833333333358, 1214.5833333333362, 1214.5333333333365, 1214.2833333333356, 1214.7333333333363, 1214.133333333336, 1213.483333333336, 1213.883333333336, 1213.5833333333362, 1213.7833333333358, 1214.5833333333362, 1214.1833333333366, 1213.7833333333363, 1213.9333333333366, 1215.2333333333363, 1215.733333333336, 1215.183333333336, 1212.4833333333363, 1214.3333333333364, 1214.633333333336, 1214.2333333333363, 1215.0333333333363, 1214.083333333336, 1213.6333333333355, 1213.3833333333362, 1214.933333333336, 1214.8833333333369, 1214.7333333333356, 1214.1333333333364, 1214.6333333333362, 1213.6333333333353, 1213.9833333333363, 1213.8333333333358, 1215.7333333333363, 1213.5833333333367, 1214.2833333333365, 1214.4333333333368, 1213.0833333333362, 1214.1833333333361, 1214.7833333333367, 1214.3833333333366, 1213.7333333333365, 1215.3333333333364, 1212.133333333336, 1214.4333333333361, 1214.0833333333362, 1215.533333333336, 1215.6333333333362, 1213.633333333336, 1213.9333333333361, 1213.783333333336, 1214.333333333336, 1213.7833333333358, 1213.6833333333361, 1214.0333333333367, 1214.6833333333363, 1212.7833333333351, 1214.3333333333364, 1214.6833333333363, 1213.6833333333368, 1214.1833333333366, 1214.6833333333357, 1214.2833333333351, 1214.6333333333362, 1212.883333333336, 1213.5333333333365, 1214.533333333337, 1213.1333333333364, 1213.783333333337, 1214.3833333333362], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.4833333333363, 1214.683333333336, 1214.5333333333367, 1214.6833333333363, 1214.333333333335, 1213.3333333333358, 1213.2333333333363, 1212.7833333333363, 1213.8833333333362, 1213.8833333333357, 1212.9833333333358, 1214.3333333333367, 1214.1833333333366, 1213.8833333333355, 1213.9833333333363, 1214.2333333333363, 1214.1333333333362, 1214.2833333333358, 1213.9833333333358, 1213.2333333333358, 1214.4833333333354, 1213.9833333333363, 1214.583333333337, 1213.3333333333355, 1213.9833333333363, 1214.3833333333364, 1213.783333333337, 1213.5833333333358, 1214.8333333333367, 1215.3833333333362, 1214.2833333333358, 1214.5833333333362, 1214.5333333333365, 1214.2833333333356, 1214.7333333333363, 1214.133333333336, 1213.483333333336, 1213.883333333336, 1213.5833333333362, 1213.7833333333358, 1214.5833333333362, 1214.1833333333366, 1213.7833333333363, 1213.9333333333366, 1215.2333333333363, 1215.733333333336, 1215.183333333336, 1212.4833333333363, 1214.3333333333364, 1214.633333333336, 1214.2333333333363, 1215.0333333333363, 1214.083333333336, 1213.6333333333355, 1213.3833333333362, 1214.933333333336, 1214.8833333333369, 1214.7333333333356, 1214.1333333333364, 1214.6333333333362, 1213.6333333333353, 1213.9833333333363, 1213.8333333333358, 1215.7333333333363, 1213.5833333333367, 1214.2833333333365, 1214.4333333333368, 1213.0833333333362, 1214.1833333333361, 1214.7833333333367, 1214.3833333333366, 1213.7333333333365, 1215.3333333333364, 1212.133333333336, 1214.4333333333361, 1214.0833333333362, 1215.533333333336, 1215.6333333333362, 1213.633333333336, 1213.9333333333361, 1213.783333333336, 1214.333333333336, 1213.7833333333358, 1213.6833333333361, 1214.0333333333367, 1214.6833333333363, 1212.7833333333351, 1214.3333333333364, 1214.6833333333363, 1213.6833333333368, 1214.1833333333366, 1214.6833333333357, 1214.2833333333351, 1214.6333333333362, 1212.883333333336, 1213.5333333333365, 1214.533333333337, 1213.1333333333364, 1213.783333333337, 1214.3833333333362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2424348564142523, "mean_inference_ms": 2.065958375320059, "mean_action_processing_ms": 0.09108225201622719, "mean_env_wait_ms": 1.5397687518441898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006424903869628906, "StateBufferConnector_ms": 0.003465414047241211, "ViewRequirementAgentConnector_ms": 0.08532071113586426}, "num_episodes": 24, "episode_return_max": 1215.7333333333363, "episode_return_min": 1212.133333333336, "episode_return_mean": 1214.1463333333363, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360150, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360150, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 245.06104670305461, "num_env_steps_trained_throughput_per_sec": 259.4764023914696, "timesteps_total": 360150, "num_env_steps_sampled_lifetime": 360150, "num_agent_steps_sampled_lifetime": 360150, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 360150, "timers": {"training_iteration_time_ms": 10379.338, "restore_workers_time_ms": 0.012, "training_step_time_ms": 610.547, "sample_time_ms": 594.896, "synch_weights_time_ms": 14.036}, "counters": {"num_env_steps_sampled": 360150, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360150, "num_agent_steps_trained": 360000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2401, "num_samples_added_to_queue": 360000}, "done": false, "training_iteration": 143, "trial_id": "27800_00000", "date": "2024-10-12_15-52-34", "timestamp": 1728744754, "time_this_iter_s": 10.42168641090393, "time_total_s": 1480.4557061195374, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c1f90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1480.4557061195374, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 16.033333333333335, "ram_util_percent": 60.98666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4471.25830078125, "policy_loss": 1115.8321533203125, "entropy": 5.25009298324585, "entropy_coeff": 0.01, "var_gnorm": 18.041370391845703, "vf_loss": 337117.625, "vf_explained_var": 0.6517301797866821}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1208.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 362700, "num_env_steps_trained": 362400, "num_agent_steps_sampled": 362700, "num_agent_steps_trained": 362400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2418, "num_samples_added_to_queue": 362700, "learner_queue": {"size_count": 1208, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.351, "learner_load_time_ms": 0.281, "learner_load_wait_time_ms": 1155.521, "learner_dequeue_time_ms": 9805.83}}, "env_runners": {"episode_reward_max": 1215.7333333333363, "episode_reward_min": 1211.0500000000027, "episode_reward_mean": 1214.1580000000029, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.0500000000027}, "policy_reward_max": {"default_policy": 1215.7333333333363}, "policy_reward_mean": {"default_policy": 1214.1580000000029}, "custom_metrics": {"num_consolidated_mean": 2.9998, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.4861999999999999, "num_moves_min": 0.04, "num_moves_max": 0.84, "mean_accuracy_mean": 43.633206666666666, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0004, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16274466666666668, "num_slav_min": 0.1617333333333333, "num_slav_max": 0.1641333333333333, "cpu_conserved_cost_mean": 7.999200000000001, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5395115994151038, "mean_cluster_cpu_util_min": 0.5367190430226144, "mean_cluster_cpu_util_max": 0.5424977592388306, "mean_cluster_mem_util_mean": 0.34163766613924046, "mean_cluster_mem_util_min": 0.3412088607594937, "mean_cluster_mem_util_max": 0.3421930379746836, "reward_consolidation_mean_mean": 6.249583333333334, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333166666666692, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.44117, "reward_sla_mean_min": -2.4619999999999997, "reward_sla_mean_max": -2.4259999999999997, "reward_consolidation_sum_mean": 624.9583333333334, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3166666666694, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.11700000000005, "reward_sla_sum_min": -246.2, "reward_sla_sum_max": -242.59999999999997, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2282.0, "global_timestep_min": 600, "global_timestep_max": 3900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.5833333333358, 1214.8333333333367, 1215.3833333333362, 1214.2833333333358, 1214.5833333333362, 1214.5333333333365, 1214.2833333333356, 1214.7333333333363, 1214.133333333336, 1213.483333333336, 1213.883333333336, 1213.5833333333362, 1213.7833333333358, 1214.5833333333362, 1214.1833333333366, 1213.7833333333363, 1213.9333333333366, 1215.2333333333363, 1215.733333333336, 1215.183333333336, 1212.4833333333363, 1214.3333333333364, 1214.633333333336, 1214.2333333333363, 1215.0333333333363, 1214.083333333336, 1213.6333333333355, 1213.3833333333362, 1214.933333333336, 1214.8833333333369, 1214.7333333333356, 1214.1333333333364, 1214.6333333333362, 1213.6333333333353, 1213.9833333333363, 1213.8333333333358, 1215.7333333333363, 1213.5833333333367, 1214.2833333333365, 1214.4333333333368, 1213.0833333333362, 1214.1833333333361, 1214.7833333333367, 1214.3833333333366, 1213.7333333333365, 1215.3333333333364, 1212.133333333336, 1214.4333333333361, 1214.0833333333362, 1215.533333333336, 1215.6333333333362, 1213.633333333336, 1213.9333333333361, 1213.783333333336, 1214.333333333336, 1213.7833333333358, 1213.6833333333361, 1214.0333333333367, 1214.6833333333363, 1212.7833333333351, 1214.3333333333364, 1214.6833333333363, 1213.6833333333368, 1214.1833333333366, 1214.6833333333357, 1214.2833333333351, 1214.6333333333362, 1212.883333333336, 1213.5333333333365, 1214.533333333337, 1213.1333333333364, 1213.783333333337, 1214.3833333333362, 1213.9833333333363, 1213.533333333336, 1214.0833333333355, 1213.6500000000021, 1214.6833333333363, 1213.783333333337, 1214.0333333333356, 1213.4500000000025, 1213.583333333337, 1214.533333333336, 1214.733333333336, 1214.1833333333368, 1214.3333333333358, 1214.5333333333358, 1211.0500000000027, 1215.3833333333362, 1213.583333333335, 1213.5833333333364, 1214.6333333333364, 1214.9333333333361, 1213.6333333333366, 1214.983333333336, 1215.433333333336, 1213.6333333333362, 1214.033333333337, 1214.6833333333357, 1212.1000000000026], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.5833333333358, 1214.8333333333367, 1215.3833333333362, 1214.2833333333358, 1214.5833333333362, 1214.5333333333365, 1214.2833333333356, 1214.7333333333363, 1214.133333333336, 1213.483333333336, 1213.883333333336, 1213.5833333333362, 1213.7833333333358, 1214.5833333333362, 1214.1833333333366, 1213.7833333333363, 1213.9333333333366, 1215.2333333333363, 1215.733333333336, 1215.183333333336, 1212.4833333333363, 1214.3333333333364, 1214.633333333336, 1214.2333333333363, 1215.0333333333363, 1214.083333333336, 1213.6333333333355, 1213.3833333333362, 1214.933333333336, 1214.8833333333369, 1214.7333333333356, 1214.1333333333364, 1214.6333333333362, 1213.6333333333353, 1213.9833333333363, 1213.8333333333358, 1215.7333333333363, 1213.5833333333367, 1214.2833333333365, 1214.4333333333368, 1213.0833333333362, 1214.1833333333361, 1214.7833333333367, 1214.3833333333366, 1213.7333333333365, 1215.3333333333364, 1212.133333333336, 1214.4333333333361, 1214.0833333333362, 1215.533333333336, 1215.6333333333362, 1213.633333333336, 1213.9333333333361, 1213.783333333336, 1214.333333333336, 1213.7833333333358, 1213.6833333333361, 1214.0333333333367, 1214.6833333333363, 1212.7833333333351, 1214.3333333333364, 1214.6833333333363, 1213.6833333333368, 1214.1833333333366, 1214.6833333333357, 1214.2833333333351, 1214.6333333333362, 1212.883333333336, 1213.5333333333365, 1214.533333333337, 1213.1333333333364, 1213.783333333337, 1214.3833333333362, 1213.9833333333363, 1213.533333333336, 1214.0833333333355, 1213.6500000000021, 1214.6833333333363, 1213.783333333337, 1214.0333333333356, 1213.4500000000025, 1213.583333333337, 1214.533333333336, 1214.733333333336, 1214.1833333333368, 1214.3333333333358, 1214.5333333333358, 1211.0500000000027, 1215.3833333333362, 1213.583333333335, 1213.5833333333364, 1214.6333333333364, 1214.9333333333361, 1213.6333333333366, 1214.983333333336, 1215.433333333336, 1213.6333333333362, 1214.033333333337, 1214.6833333333357, 1212.1000000000026]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2424484795561564, "mean_inference_ms": 2.0656900242525014, "mean_action_processing_ms": 0.09107458676968705, "mean_env_wait_ms": 1.5396943215976813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068759918212890625, "StateBufferConnector_ms": 0.0034589767456054688, "ViewRequirementAgentConnector_ms": 0.08576321601867676}, "num_episodes": 27, "episode_return_max": 1215.7333333333363, "episode_return_min": 1211.0500000000027, "episode_return_mean": 1214.1580000000029, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 362700, "num_agent_steps_trained": 362400, "num_env_steps_sampled": 362700, "num_env_steps_trained": 362400, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 249.19938091325662, "num_env_steps_trained_throughput_per_sec": 234.54059380071212, "timesteps_total": 362700, "num_env_steps_sampled_lifetime": 362700, "num_agent_steps_sampled_lifetime": 362700, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 362700, "timers": {"training_iteration_time_ms": 10353.483, "restore_workers_time_ms": 0.013, "training_step_time_ms": 593.391, "sample_time_ms": 578.827, "synch_weights_time_ms": 12.966}, "counters": {"num_env_steps_sampled": 362700, "num_env_steps_trained": 362400, "num_agent_steps_sampled": 362700, "num_agent_steps_trained": 362400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2418, "num_samples_added_to_queue": 362700}, "done": false, "training_iteration": 144, "trial_id": "27800_00000", "date": "2024-10-12_15-52-45", "timestamp": 1728744765, "time_this_iter_s": 10.244216442108154, "time_total_s": 1490.6999225616455, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c20b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1490.6999225616455, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 16.08666666666667, "ram_util_percent": 60.613333333333344}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 5865.8076171875, "policy_loss": 2473.190185546875, "entropy": 4.986968517303467, "entropy_coeff": 0.01, "var_gnorm": 18.04181480407715, "vf_loss": 340757.875, "vf_explained_var": 0.6500329971313477}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1217.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 365250, "num_env_steps_trained": 365100, "num_agent_steps_sampled": 365250, "num_agent_steps_trained": 365100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2435, "num_samples_added_to_queue": 365100, "learner_queue": {"size_count": 1217, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.461, "learner_load_time_ms": 0.28, "learner_load_wait_time_ms": 1140.129, "learner_dequeue_time_ms": 9830.648}}, "env_runners": {"episode_reward_max": 1215.7333333333363, "episode_reward_min": 1211.0500000000027, "episode_reward_mean": 1214.103833333336, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.0500000000027}, "policy_reward_max": {"default_policy": 1215.7333333333363}, "policy_reward_mean": {"default_policy": 1214.103833333336}, "custom_metrics": {"num_consolidated_mean": 2.9998, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.5763, "num_moves_min": 0.16, "num_moves_max": 0.84, "mean_accuracy_mean": 43.632889999999996, "mean_accuracy_min": 43.62066666666667, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0014000000000000002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.16275300000000004, "num_slav_min": 0.1617333333333333, "num_slav_max": 0.1641333333333333, "cpu_conserved_cost_mean": 7.999200000000001, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5394966421619324, "mean_cluster_cpu_util_min": 0.5367745679352822, "mean_cluster_cpu_util_max": 0.5424977592388306, "mean_cluster_mem_util_mean": 0.34161573048523197, "mean_cluster_mem_util_min": 0.3412088607594937, "mean_cluster_mem_util_max": 0.3421930379746836, "reward_consolidation_mean_mean": 6.249583333333333, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.332750000000026, "reward_accuracy_mean_min": 8.316666666666695, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4412949999999998, "reward_sla_mean_min": -2.4619999999999997, "reward_sla_mean_max": -2.4259999999999997, "reward_consolidation_sum_mean": 624.9583333333334, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.2750000000029, "reward_accuracy_sum_min": 831.6666666666695, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.1295, "reward_sla_sum_min": -246.2, "reward_sla_sum_max": -242.59999999999997, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3082.0, "global_timestep_min": 1400, "global_timestep_max": 4700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1215.0333333333363, 1214.083333333336, 1213.6333333333355, 1213.3833333333362, 1214.933333333336, 1214.8833333333369, 1214.7333333333356, 1214.1333333333364, 1214.6333333333362, 1213.6333333333353, 1213.9833333333363, 1213.8333333333358, 1215.7333333333363, 1213.5833333333367, 1214.2833333333365, 1214.4333333333368, 1213.0833333333362, 1214.1833333333361, 1214.7833333333367, 1214.3833333333366, 1213.7333333333365, 1215.3333333333364, 1212.133333333336, 1214.4333333333361, 1214.0833333333362, 1215.533333333336, 1215.6333333333362, 1213.633333333336, 1213.9333333333361, 1213.783333333336, 1214.333333333336, 1213.7833333333358, 1213.6833333333361, 1214.0333333333367, 1214.6833333333363, 1212.7833333333351, 1214.3333333333364, 1214.6833333333363, 1213.6833333333368, 1214.1833333333366, 1214.6833333333357, 1214.2833333333351, 1214.6333333333362, 1212.883333333336, 1213.5333333333365, 1214.533333333337, 1213.1333333333364, 1213.783333333337, 1214.3833333333362, 1213.9833333333363, 1213.533333333336, 1214.0833333333355, 1213.6500000000021, 1214.6833333333363, 1213.783333333337, 1214.0333333333356, 1213.4500000000025, 1213.583333333337, 1214.533333333336, 1214.733333333336, 1214.1833333333368, 1214.3333333333358, 1214.5333333333358, 1211.0500000000027, 1215.3833333333362, 1213.583333333335, 1213.5833333333364, 1214.6333333333364, 1214.9333333333361, 1213.6333333333366, 1214.983333333336, 1215.433333333336, 1213.6333333333362, 1214.033333333337, 1214.6833333333357, 1212.1000000000026, 1214.7500000000025, 1214.7833333333367, 1214.033333333336, 1214.5500000000025, 1214.0333333333363, 1213.0333333333358, 1212.9333333333366, 1213.9333333333366, 1214.7500000000025, 1214.1333333333366, 1213.8333333333362, 1215.033333333336, 1214.0166666666696, 1213.8833333333357, 1215.0833333333364, 1213.7333333333365, 1213.6333333333362, 1214.683333333336, 1213.9333333333361, 1214.5833333333362, 1213.5333333333363, 1214.2333333333363, 1212.9333333333363, 1213.9333333333361], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1215.0333333333363, 1214.083333333336, 1213.6333333333355, 1213.3833333333362, 1214.933333333336, 1214.8833333333369, 1214.7333333333356, 1214.1333333333364, 1214.6333333333362, 1213.6333333333353, 1213.9833333333363, 1213.8333333333358, 1215.7333333333363, 1213.5833333333367, 1214.2833333333365, 1214.4333333333368, 1213.0833333333362, 1214.1833333333361, 1214.7833333333367, 1214.3833333333366, 1213.7333333333365, 1215.3333333333364, 1212.133333333336, 1214.4333333333361, 1214.0833333333362, 1215.533333333336, 1215.6333333333362, 1213.633333333336, 1213.9333333333361, 1213.783333333336, 1214.333333333336, 1213.7833333333358, 1213.6833333333361, 1214.0333333333367, 1214.6833333333363, 1212.7833333333351, 1214.3333333333364, 1214.6833333333363, 1213.6833333333368, 1214.1833333333366, 1214.6833333333357, 1214.2833333333351, 1214.6333333333362, 1212.883333333336, 1213.5333333333365, 1214.533333333337, 1213.1333333333364, 1213.783333333337, 1214.3833333333362, 1213.9833333333363, 1213.533333333336, 1214.0833333333355, 1213.6500000000021, 1214.6833333333363, 1213.783333333337, 1214.0333333333356, 1213.4500000000025, 1213.583333333337, 1214.533333333336, 1214.733333333336, 1214.1833333333368, 1214.3333333333358, 1214.5333333333358, 1211.0500000000027, 1215.3833333333362, 1213.583333333335, 1213.5833333333364, 1214.6333333333364, 1214.9333333333361, 1213.6333333333366, 1214.983333333336, 1215.433333333336, 1213.6333333333362, 1214.033333333337, 1214.6833333333357, 1212.1000000000026, 1214.7500000000025, 1214.7833333333367, 1214.033333333336, 1214.5500000000025, 1214.0333333333363, 1213.0333333333358, 1212.9333333333366, 1213.9333333333366, 1214.7500000000025, 1214.1333333333366, 1213.8333333333362, 1215.033333333336, 1214.0166666666696, 1213.8833333333357, 1215.0833333333364, 1213.7333333333365, 1213.6333333333362, 1214.683333333336, 1213.9333333333361, 1214.5833333333362, 1213.5333333333363, 1214.2333333333363, 1212.9333333333363, 1213.9333333333361]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24244344930097378, "mean_inference_ms": 2.065423861460395, "mean_action_processing_ms": 0.09106525974445918, "mean_env_wait_ms": 1.5395991861991791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006838321685791016, "StateBufferConnector_ms": 0.0034193992614746094, "ViewRequirementAgentConnector_ms": 0.08525919914245605}, "num_episodes": 24, "episode_return_max": 1215.7333333333363, "episode_return_min": 1211.0500000000027, "episode_return_mean": 1214.103833333336, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 365250, "num_agent_steps_trained": 365100, "num_env_steps_sampled": 365250, "num_env_steps_trained": 365100, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 249.0433086980408, "num_env_steps_trained_throughput_per_sec": 263.6929150920432, "timesteps_total": 365250, "num_env_steps_sampled_lifetime": 365250, "num_agent_steps_sampled_lifetime": 365250, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 365250, "timers": {"training_iteration_time_ms": 10319.064, "restore_workers_time_ms": 0.012, "training_step_time_ms": 589.246, "sample_time_ms": 574.391, "synch_weights_time_ms": 13.293}, "counters": {"num_env_steps_sampled": 365250, "num_env_steps_trained": 365100, "num_agent_steps_sampled": 365250, "num_agent_steps_trained": 365100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2435, "num_samples_added_to_queue": 365100}, "done": false, "training_iteration": 145, "trial_id": "27800_00000", "date": "2024-10-12_15-52-55", "timestamp": 1728744775, "time_this_iter_s": 10.25175929069519, "time_total_s": 1500.9516818523407, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f698a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1500.9516818523407, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 16.371428571428574, "ram_util_percent": 60.85714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1631.9927978515625, "policy_loss": -1642.346435546875, "entropy": 5.021368980407715, "entropy_coeff": 0.01, "var_gnorm": 18.04533576965332, "vf_loss": 328940.34375, "vf_explained_var": 0.6554081439971924}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1224.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 367500, "num_env_steps_trained": 367200, "num_agent_steps_sampled": 367500, "num_agent_steps_trained": 367200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2450, "num_samples_added_to_queue": 367500, "learner_queue": {"size_count": 1224, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.482, "learner_load_time_ms": 0.272, "learner_load_wait_time_ms": 1244.419, "learner_dequeue_time_ms": 9943.628}}, "env_runners": {"episode_reward_max": 1215.6333333333362, "episode_reward_min": 1211.0500000000027, "episode_reward_mean": 1214.0596666666695, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.0500000000027}, "policy_reward_max": {"default_policy": 1215.6333333333362}, "policy_reward_mean": {"default_policy": 1214.0596666666695}, "custom_metrics": {"num_consolidated_mean": 2.9998, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.5861999999999999, "num_moves_min": 0.31, "num_moves_max": 0.84, "mean_accuracy_mean": 43.63276333333333, "mean_accuracy_min": 43.62066666666667, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0018, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.16277133333333335, "num_slav_min": 0.1617666666666667, "num_slav_max": 0.16390000000000002, "cpu_conserved_cost_mean": 7.999200000000001, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5391214206138537, "mean_cluster_cpu_util_min": 0.5367745679352822, "mean_cluster_cpu_util_max": 0.5424977592388306, "mean_cluster_mem_util_mean": 0.3416302347046414, "mean_cluster_mem_util_min": 0.3412088607594937, "mean_cluster_mem_util_max": 0.3421930379746836, "reward_consolidation_mean_mean": 6.249583333333333, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.332583333333359, "reward_accuracy_mean_min": 8.316666666666695, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4415699999999996, "reward_sla_mean_min": -2.4585, "reward_sla_mean_max": -2.4264999999999994, "reward_consolidation_sum_mean": 624.9583333333333, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.2583333333362, "reward_accuracy_sum_min": 831.6666666666695, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.15699999999998, "reward_sla_sum_min": -245.85, "reward_sla_sum_max": -242.64999999999995, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3883.0, "global_timestep_min": 2200, "global_timestep_max": 5500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.0833333333362, 1215.533333333336, 1215.6333333333362, 1213.633333333336, 1213.9333333333361, 1213.783333333336, 1214.333333333336, 1213.7833333333358, 1213.6833333333361, 1214.0333333333367, 1214.6833333333363, 1212.7833333333351, 1214.3333333333364, 1214.6833333333363, 1213.6833333333368, 1214.1833333333366, 1214.6833333333357, 1214.2833333333351, 1214.6333333333362, 1212.883333333336, 1213.5333333333365, 1214.533333333337, 1213.1333333333364, 1213.783333333337, 1214.3833333333362, 1213.9833333333363, 1213.533333333336, 1214.0833333333355, 1213.6500000000021, 1214.6833333333363, 1213.783333333337, 1214.0333333333356, 1213.4500000000025, 1213.583333333337, 1214.533333333336, 1214.733333333336, 1214.1833333333368, 1214.3333333333358, 1214.5333333333358, 1211.0500000000027, 1215.3833333333362, 1213.583333333335, 1213.5833333333364, 1214.6333333333364, 1214.9333333333361, 1213.6333333333366, 1214.983333333336, 1215.433333333336, 1213.6333333333362, 1214.033333333337, 1214.6833333333357, 1212.1000000000026, 1214.7500000000025, 1214.7833333333367, 1214.033333333336, 1214.5500000000025, 1214.0333333333363, 1213.0333333333358, 1212.9333333333366, 1213.9333333333366, 1214.7500000000025, 1214.1333333333366, 1213.8333333333362, 1215.033333333336, 1214.0166666666696, 1213.8833333333357, 1215.0833333333364, 1213.7333333333365, 1213.6333333333362, 1214.683333333336, 1213.9333333333361, 1214.5833333333362, 1213.5333333333363, 1214.2333333333363, 1212.9333333333363, 1213.9333333333361, 1214.2833333333365, 1213.4833333333356, 1212.4833333333365, 1214.0833333333367, 1214.5333333333358, 1214.633333333336, 1213.4833333333365, 1214.783333333336, 1213.7333333333354, 1214.6000000000033, 1213.6333333333364, 1213.3833333333369, 1214.8833333333364, 1213.883333333336, 1214.850000000003, 1215.2333333333365, 1213.083333333336, 1214.4333333333361, 1214.9333333333366, 1214.7833333333365, 1213.9333333333368, 1212.4833333333365, 1212.9833333333356, 1213.9833333333358], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.0833333333362, 1215.533333333336, 1215.6333333333362, 1213.633333333336, 1213.9333333333361, 1213.783333333336, 1214.333333333336, 1213.7833333333358, 1213.6833333333361, 1214.0333333333367, 1214.6833333333363, 1212.7833333333351, 1214.3333333333364, 1214.6833333333363, 1213.6833333333368, 1214.1833333333366, 1214.6833333333357, 1214.2833333333351, 1214.6333333333362, 1212.883333333336, 1213.5333333333365, 1214.533333333337, 1213.1333333333364, 1213.783333333337, 1214.3833333333362, 1213.9833333333363, 1213.533333333336, 1214.0833333333355, 1213.6500000000021, 1214.6833333333363, 1213.783333333337, 1214.0333333333356, 1213.4500000000025, 1213.583333333337, 1214.533333333336, 1214.733333333336, 1214.1833333333368, 1214.3333333333358, 1214.5333333333358, 1211.0500000000027, 1215.3833333333362, 1213.583333333335, 1213.5833333333364, 1214.6333333333364, 1214.9333333333361, 1213.6333333333366, 1214.983333333336, 1215.433333333336, 1213.6333333333362, 1214.033333333337, 1214.6833333333357, 1212.1000000000026, 1214.7500000000025, 1214.7833333333367, 1214.033333333336, 1214.5500000000025, 1214.0333333333363, 1213.0333333333358, 1212.9333333333366, 1213.9333333333366, 1214.7500000000025, 1214.1333333333366, 1213.8333333333362, 1215.033333333336, 1214.0166666666696, 1213.8833333333357, 1215.0833333333364, 1213.7333333333365, 1213.6333333333362, 1214.683333333336, 1213.9333333333361, 1214.5833333333362, 1213.5333333333363, 1214.2333333333363, 1212.9333333333363, 1213.9333333333361, 1214.2833333333365, 1213.4833333333356, 1212.4833333333365, 1214.0833333333367, 1214.5333333333358, 1214.633333333336, 1213.4833333333365, 1214.783333333336, 1213.7333333333354, 1214.6000000000033, 1213.6333333333364, 1213.3833333333369, 1214.8833333333364, 1213.883333333336, 1214.850000000003, 1215.2333333333365, 1213.083333333336, 1214.4333333333361, 1214.9333333333366, 1214.7833333333365, 1213.9333333333368, 1212.4833333333365, 1212.9833333333356, 1213.9833333333358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2424979963326393, "mean_inference_ms": 2.0671836477738346, "mean_action_processing_ms": 0.09108397607876081, "mean_env_wait_ms": 1.5400609032649293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006826877593994141, "StateBufferConnector_ms": 0.0033223628997802734, "ViewRequirementAgentConnector_ms": 0.08552885055541992}, "num_episodes": 24, "episode_return_max": 1215.6333333333362, "episode_return_min": 1211.0500000000027, "episode_return_mean": 1214.0596666666695, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 367500, "num_agent_steps_trained": 367200, "num_env_steps_sampled": 367500, "num_env_steps_trained": 367200, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 221.2295542762661, "num_env_steps_trained_throughput_per_sec": 206.48091732451502, "timesteps_total": 367500, "num_env_steps_sampled_lifetime": 367500, "num_agent_steps_sampled_lifetime": 367500, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 367500, "timers": {"training_iteration_time_ms": 10319.031, "restore_workers_time_ms": 0.012, "training_step_time_ms": 645.057, "sample_time_ms": 628.777, "synch_weights_time_ms": 14.721}, "counters": {"num_env_steps_sampled": 367500, "num_env_steps_trained": 367200, "num_agent_steps_sampled": 367500, "num_agent_steps_trained": 367200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2450, "num_samples_added_to_queue": 367500}, "done": false, "training_iteration": 146, "trial_id": "27800_00000", "date": "2024-10-12_15-53-05", "timestamp": 1728744785, "time_this_iter_s": 10.180034160614014, "time_total_s": 1511.1317160129547, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f1ea0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1511.1317160129547, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 22.22666666666667, "ram_util_percent": 62.54666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1918.7799072265625, "policy_loss": -1079.7926025390625, "entropy": 4.952948093414307, "entropy_coeff": 0.01, "var_gnorm": 18.0529842376709, "vf_loss": 301343.15625, "vf_explained_var": 0.6640737652778625}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1232.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 369900, "num_env_steps_trained": 369600, "num_agent_steps_sampled": 369900, "num_agent_steps_trained": 369600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2466, "num_samples_added_to_queue": 369900, "learner_queue": {"size_count": 1232, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.675, "learner_load_time_ms": 0.306, "learner_load_wait_time_ms": 1198.5, "learner_dequeue_time_ms": 9940.719}}, "env_runners": {"episode_reward_max": 1216.1333333333362, "episode_reward_min": 1211.0500000000027, "episode_reward_mean": 1214.0676666666693, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.0500000000027}, "policy_reward_max": {"default_policy": 1216.1333333333362}, "policy_reward_mean": {"default_policy": 1214.0676666666693}, "custom_metrics": {"num_consolidated_mean": 2.9998, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.5432000000000001, "num_moves_min": 0.31, "num_moves_max": 0.81, "mean_accuracy_mean": 43.63257333333333, "mean_accuracy_min": 43.62066666666667, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0024, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.16274933333333336, "num_slav_min": 0.16146666666666665, "num_slav_max": 0.16390000000000002, "cpu_conserved_cost_mean": 7.999200000000001, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5387230778578322, "mean_cluster_cpu_util_min": 0.5365409772016916, "mean_cluster_cpu_util_max": 0.5424977592388306, "mean_cluster_mem_util_mean": 0.3416334994725739, "mean_cluster_mem_util_min": 0.3411951476793249, "mean_cluster_mem_util_max": 0.3421930379746836, "reward_consolidation_mean_mean": 6.249583333333333, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.33233333333336, "reward_accuracy_mean_min": 8.316666666666695, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.44124, "reward_sla_mean_min": -2.4585, "reward_sla_mean_max": -2.4219999999999997, "reward_consolidation_sum_mean": 624.9583333333333, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.2333333333363, "reward_accuracy_sum_min": 831.6666666666695, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.12400000000005, "reward_sla_sum_min": -245.85, "reward_sla_sum_max": -242.19999999999996, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4683.0, "global_timestep_min": 3000, "global_timestep_max": 6300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.3833333333362, 1213.9833333333363, 1213.533333333336, 1214.0833333333355, 1213.6500000000021, 1214.6833333333363, 1213.783333333337, 1214.0333333333356, 1213.4500000000025, 1213.583333333337, 1214.533333333336, 1214.733333333336, 1214.1833333333368, 1214.3333333333358, 1214.5333333333358, 1211.0500000000027, 1215.3833333333362, 1213.583333333335, 1213.5833333333364, 1214.6333333333364, 1214.9333333333361, 1213.6333333333366, 1214.983333333336, 1215.433333333336, 1213.6333333333362, 1214.033333333337, 1214.6833333333357, 1212.1000000000026, 1214.7500000000025, 1214.7833333333367, 1214.033333333336, 1214.5500000000025, 1214.0333333333363, 1213.0333333333358, 1212.9333333333366, 1213.9333333333366, 1214.7500000000025, 1214.1333333333366, 1213.8333333333362, 1215.033333333336, 1214.0166666666696, 1213.8833333333357, 1215.0833333333364, 1213.7333333333365, 1213.6333333333362, 1214.683333333336, 1213.9333333333361, 1214.5833333333362, 1213.5333333333363, 1214.2333333333363, 1212.9333333333363, 1213.9333333333361, 1214.2833333333365, 1213.4833333333356, 1212.4833333333365, 1214.0833333333367, 1214.5333333333358, 1214.633333333336, 1213.4833333333365, 1214.783333333336, 1213.7333333333354, 1214.6000000000033, 1213.6333333333364, 1213.3833333333369, 1214.8833333333364, 1213.883333333336, 1214.850000000003, 1215.2333333333365, 1213.083333333336, 1214.4333333333361, 1214.9333333333366, 1214.7833333333365, 1213.9333333333368, 1212.4833333333365, 1212.9833333333356, 1213.9833333333358, 1214.683333333336, 1213.5833333333358, 1213.783333333337, 1213.3833333333364, 1215.033333333336, 1214.283333333336, 1214.5000000000034, 1213.5833333333362, 1214.4833333333363, 1214.4833333333358, 1214.0333333333358, 1214.0000000000027, 1213.6833333333363, 1213.9333333333357, 1214.4333333333366, 1213.400000000002, 1214.183333333336, 1213.883333333336, 1213.633333333336, 1215.0833333333358, 1213.3833333333369, 1216.1333333333362, 1213.8333333333362, 1213.6333333333364], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.3833333333362, 1213.9833333333363, 1213.533333333336, 1214.0833333333355, 1213.6500000000021, 1214.6833333333363, 1213.783333333337, 1214.0333333333356, 1213.4500000000025, 1213.583333333337, 1214.533333333336, 1214.733333333336, 1214.1833333333368, 1214.3333333333358, 1214.5333333333358, 1211.0500000000027, 1215.3833333333362, 1213.583333333335, 1213.5833333333364, 1214.6333333333364, 1214.9333333333361, 1213.6333333333366, 1214.983333333336, 1215.433333333336, 1213.6333333333362, 1214.033333333337, 1214.6833333333357, 1212.1000000000026, 1214.7500000000025, 1214.7833333333367, 1214.033333333336, 1214.5500000000025, 1214.0333333333363, 1213.0333333333358, 1212.9333333333366, 1213.9333333333366, 1214.7500000000025, 1214.1333333333366, 1213.8333333333362, 1215.033333333336, 1214.0166666666696, 1213.8833333333357, 1215.0833333333364, 1213.7333333333365, 1213.6333333333362, 1214.683333333336, 1213.9333333333361, 1214.5833333333362, 1213.5333333333363, 1214.2333333333363, 1212.9333333333363, 1213.9333333333361, 1214.2833333333365, 1213.4833333333356, 1212.4833333333365, 1214.0833333333367, 1214.5333333333358, 1214.633333333336, 1213.4833333333365, 1214.783333333336, 1213.7333333333354, 1214.6000000000033, 1213.6333333333364, 1213.3833333333369, 1214.8833333333364, 1213.883333333336, 1214.850000000003, 1215.2333333333365, 1213.083333333336, 1214.4333333333361, 1214.9333333333366, 1214.7833333333365, 1213.9333333333368, 1212.4833333333365, 1212.9833333333356, 1213.9833333333358, 1214.683333333336, 1213.5833333333358, 1213.783333333337, 1213.3833333333364, 1215.033333333336, 1214.283333333336, 1214.5000000000034, 1213.5833333333362, 1214.4833333333363, 1214.4833333333358, 1214.0333333333358, 1214.0000000000027, 1213.6833333333363, 1213.9333333333357, 1214.4333333333366, 1213.400000000002, 1214.183333333336, 1213.883333333336, 1213.633333333336, 1215.0833333333358, 1213.3833333333369, 1216.1333333333362, 1213.8333333333362, 1213.6333333333364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24252472241474954, "mean_inference_ms": 2.0674443339768853, "mean_action_processing_ms": 0.09108828292806422, "mean_env_wait_ms": 1.5402178347495317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006898641586303711, "StateBufferConnector_ms": 0.0033402442932128906, "ViewRequirementAgentConnector_ms": 0.0863962173461914}, "num_episodes": 24, "episode_return_max": 1216.1333333333362, "episode_return_min": 1211.0500000000027, "episode_return_mean": 1214.0676666666693, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 369900, "num_agent_steps_trained": 369600, "num_env_steps_sampled": 369900, "num_env_steps_trained": 369600, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 236.9151131948101, "num_env_steps_trained_throughput_per_sec": 236.9151131948101, "timesteps_total": 369900, "num_env_steps_sampled_lifetime": 369900, "num_agent_steps_sampled_lifetime": 369900, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 369900, "timers": {"training_iteration_time_ms": 10305.816, "restore_workers_time_ms": 0.013, "training_step_time_ms": 635.811, "sample_time_ms": 619.912, "synch_weights_time_ms": 14.335}, "counters": {"num_env_steps_sampled": 369900, "num_env_steps_trained": 369600, "num_agent_steps_sampled": 369900, "num_agent_steps_trained": 369600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2466, "num_samples_added_to_queue": 369900}, "done": false, "training_iteration": 147, "trial_id": "27800_00000", "date": "2024-10-12_15-53-15", "timestamp": 1728744795, "time_this_iter_s": 10.140805006027222, "time_total_s": 1521.272521018982, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d47e80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1521.272521018982, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 16.27142857142857, "ram_util_percent": 62.99999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4961.6083984375, "policy_loss": 1182.281494140625, "entropy": 4.737060546875, "entropy_coeff": 0.01, "var_gnorm": 18.05350112915039, "vf_loss": 379353.78125, "vf_explained_var": 0.638534426689148}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1241.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 372450, "num_env_steps_trained": 372300, "num_agent_steps_sampled": 372450, "num_agent_steps_trained": 372300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2483, "num_samples_added_to_queue": 372300, "learner_queue": {"size_count": 1241, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 68.188, "learner_load_time_ms": 0.311, "learner_load_wait_time_ms": 1163.304, "learner_dequeue_time_ms": 9909.4}}, "env_runners": {"episode_reward_max": 1216.1333333333362, "episode_reward_min": 1212.1000000000026, "episode_reward_mean": 1214.0586666666698, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.1000000000026}, "policy_reward_max": {"default_policy": 1216.1333333333362}, "policy_reward_mean": {"default_policy": 1214.0586666666698}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.429, "num_moves_min": 0.1, "num_moves_max": 0.76, "mean_accuracy_mean": 43.63251, "mean_accuracy_min": 43.62066666666667, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0026, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.16276366666666667, "num_slav_min": 0.16146666666666665, "num_slav_max": 0.16390000000000002, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5383391583356316, "mean_cluster_cpu_util_min": 0.5364991841331127, "mean_cluster_cpu_util_max": 0.5408239336275051, "mean_cluster_mem_util_mean": 0.34164165348101266, "mean_cluster_mem_util_min": 0.3411951476793249, "mean_cluster_mem_util_max": 0.34209282700421945, "reward_consolidation_mean_mean": 6.249791666666666, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.332250000000025, "reward_accuracy_mean_min": 8.316666666666695, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4414549999999995, "reward_sla_mean_min": -2.4585, "reward_sla_mean_max": -2.4219999999999997, "reward_consolidation_sum_mean": 624.9791666666666, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.2250000000029, "reward_accuracy_sum_min": 831.6666666666695, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.14549999999997, "reward_sla_sum_min": -245.85, "reward_sla_sum_max": -242.19999999999996, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5478.0, "global_timestep_min": 3600, "global_timestep_max": 7100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.6333333333362, 1214.033333333337, 1214.6833333333357, 1212.1000000000026, 1214.7500000000025, 1214.7833333333367, 1214.033333333336, 1214.5500000000025, 1214.0333333333363, 1213.0333333333358, 1212.9333333333366, 1213.9333333333366, 1214.7500000000025, 1214.1333333333366, 1213.8333333333362, 1215.033333333336, 1214.0166666666696, 1213.8833333333357, 1215.0833333333364, 1213.7333333333365, 1213.6333333333362, 1214.683333333336, 1213.9333333333361, 1214.5833333333362, 1213.5333333333363, 1214.2333333333363, 1212.9333333333363, 1213.9333333333361, 1214.2833333333365, 1213.4833333333356, 1212.4833333333365, 1214.0833333333367, 1214.5333333333358, 1214.633333333336, 1213.4833333333365, 1214.783333333336, 1213.7333333333354, 1214.6000000000033, 1213.6333333333364, 1213.3833333333369, 1214.8833333333364, 1213.883333333336, 1214.850000000003, 1215.2333333333365, 1213.083333333336, 1214.4333333333361, 1214.9333333333366, 1214.7833333333365, 1213.9333333333368, 1212.4833333333365, 1212.9833333333356, 1213.9833333333358, 1214.683333333336, 1213.5833333333358, 1213.783333333337, 1213.3833333333364, 1215.033333333336, 1214.283333333336, 1214.5000000000034, 1213.5833333333362, 1214.4833333333363, 1214.4833333333358, 1214.0333333333358, 1214.0000000000027, 1213.6833333333363, 1213.9333333333357, 1214.4333333333366, 1213.400000000002, 1214.183333333336, 1213.883333333336, 1213.633333333336, 1215.0833333333358, 1213.3833333333369, 1216.1333333333362, 1213.8333333333362, 1213.6333333333364, 1215.3833333333364, 1212.5333333333363, 1214.0833333333362, 1214.1833333333361, 1214.6333333333369, 1215.0000000000036, 1214.3333333333364, 1213.1333333333364, 1214.7250000000026, 1213.2833333333358, 1214.633333333336, 1213.2833333333358, 1214.5333333333367, 1214.183333333336, 1214.3833333333366, 1214.8250000000025, 1214.133333333336, 1213.733333333336, 1213.383333333336, 1213.2333333333363, 1214.0833333333367, 1213.333333333336, 1214.4833333333363, 1214.2833333333358], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.6333333333362, 1214.033333333337, 1214.6833333333357, 1212.1000000000026, 1214.7500000000025, 1214.7833333333367, 1214.033333333336, 1214.5500000000025, 1214.0333333333363, 1213.0333333333358, 1212.9333333333366, 1213.9333333333366, 1214.7500000000025, 1214.1333333333366, 1213.8333333333362, 1215.033333333336, 1214.0166666666696, 1213.8833333333357, 1215.0833333333364, 1213.7333333333365, 1213.6333333333362, 1214.683333333336, 1213.9333333333361, 1214.5833333333362, 1213.5333333333363, 1214.2333333333363, 1212.9333333333363, 1213.9333333333361, 1214.2833333333365, 1213.4833333333356, 1212.4833333333365, 1214.0833333333367, 1214.5333333333358, 1214.633333333336, 1213.4833333333365, 1214.783333333336, 1213.7333333333354, 1214.6000000000033, 1213.6333333333364, 1213.3833333333369, 1214.8833333333364, 1213.883333333336, 1214.850000000003, 1215.2333333333365, 1213.083333333336, 1214.4333333333361, 1214.9333333333366, 1214.7833333333365, 1213.9333333333368, 1212.4833333333365, 1212.9833333333356, 1213.9833333333358, 1214.683333333336, 1213.5833333333358, 1213.783333333337, 1213.3833333333364, 1215.033333333336, 1214.283333333336, 1214.5000000000034, 1213.5833333333362, 1214.4833333333363, 1214.4833333333358, 1214.0333333333358, 1214.0000000000027, 1213.6833333333363, 1213.9333333333357, 1214.4333333333366, 1213.400000000002, 1214.183333333336, 1213.883333333336, 1213.633333333336, 1215.0833333333358, 1213.3833333333369, 1216.1333333333362, 1213.8333333333362, 1213.6333333333364, 1215.3833333333364, 1212.5333333333363, 1214.0833333333362, 1214.1833333333361, 1214.6333333333369, 1215.0000000000036, 1214.3333333333364, 1213.1333333333364, 1214.7250000000026, 1213.2833333333358, 1214.633333333336, 1213.2833333333358, 1214.5333333333367, 1214.183333333336, 1214.3833333333366, 1214.8250000000025, 1214.133333333336, 1213.733333333336, 1213.383333333336, 1213.2333333333363, 1214.0833333333367, 1213.333333333336, 1214.4833333333363, 1214.2833333333358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24250744120957124, "mean_inference_ms": 2.065720316706993, "mean_action_processing_ms": 0.0910711700712217, "mean_env_wait_ms": 1.5398456085994412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006418943405151367, "StateBufferConnector_ms": 0.0033359527587890625, "ViewRequirementAgentConnector_ms": 0.08599972724914551}, "num_episodes": 24, "episode_return_max": 1216.1333333333362, "episode_return_min": 1212.1000000000026, "episode_return_mean": 1214.0586666666698, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372450, "num_agent_steps_trained": 372300, "num_env_steps_sampled": 372450, "num_env_steps_trained": 372300, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 249.0894827308543, "num_env_steps_trained_throughput_per_sec": 263.741805244434, "timesteps_total": 372450, "num_env_steps_sampled_lifetime": 372450, "num_agent_steps_sampled_lifetime": 372450, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 372450, "timers": {"training_iteration_time_ms": 10283.428, "restore_workers_time_ms": 0.014, "training_step_time_ms": 600.03, "sample_time_ms": 584.137, "synch_weights_time_ms": 14.376}, "counters": {"num_env_steps_sampled": 372450, "num_env_steps_trained": 372300, "num_agent_steps_sampled": 372450, "num_agent_steps_trained": 372300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2483, "num_samples_added_to_queue": 372300}, "done": false, "training_iteration": 148, "trial_id": "27800_00000", "date": "2024-10-12_15-53-26", "timestamp": 1728744806, "time_this_iter_s": 10.246902465820312, "time_total_s": 1531.5194234848022, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d26470>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1531.5194234848022, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 16.253333333333334, "ram_util_percent": 63.04666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3474.424560546875, "policy_loss": 46.926239013671875, "entropy": 4.997527122497559, "entropy_coeff": 0.01, "var_gnorm": 18.05491828918457, "vf_loss": 344249.09375, "vf_explained_var": 0.648236095905304}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1249.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 375000, "num_env_steps_trained": 374700, "num_agent_steps_sampled": 375000, "num_agent_steps_trained": 374700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2500, "num_samples_added_to_queue": 375000, "learner_queue": {"size_count": 1249, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.242, "learner_load_time_ms": 0.293, "learner_load_wait_time_ms": 1151.796, "learner_dequeue_time_ms": 9915.436}}, "env_runners": {"episode_reward_max": 1216.1333333333362, "episode_reward_min": 1212.4833333333365, "episode_reward_mean": 1214.088250000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.4833333333365}, "policy_reward_max": {"default_policy": 1216.1333333333362}, "policy_reward_mean": {"default_policy": 1214.088250000003}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.3992, "num_moves_min": 0.1, "num_moves_max": 0.63, "mean_accuracy_mean": 43.63269999999999, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0026, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.1627745, "num_slav_min": 0.16125, "num_slav_max": 0.16390000000000002, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5379959577817613, "mean_cluster_cpu_util_min": 0.5363999126677698, "mean_cluster_cpu_util_max": 0.5408239336275051, "mean_cluster_mem_util_mean": 0.3416290717299578, "mean_cluster_mem_util_min": 0.3411951476793249, "mean_cluster_mem_util_max": 0.34209282700421945, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.332500000000024, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4416175, "reward_sla_mean_min": -2.4585, "reward_sla_mean_max": -2.4187499999999997, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.250000000003, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.16174999999996, "reward_sla_sum_min": -245.85, "reward_sla_sum_max": -241.87499999999997, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5915.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.9333333333361, 1214.2833333333365, 1213.4833333333356, 1212.4833333333365, 1214.0833333333367, 1214.5333333333358, 1214.633333333336, 1213.4833333333365, 1214.783333333336, 1213.7333333333354, 1214.6000000000033, 1213.6333333333364, 1213.3833333333369, 1214.8833333333364, 1213.883333333336, 1214.850000000003, 1215.2333333333365, 1213.083333333336, 1214.4333333333361, 1214.9333333333366, 1214.7833333333365, 1213.9333333333368, 1212.4833333333365, 1212.9833333333356, 1213.9833333333358, 1214.683333333336, 1213.5833333333358, 1213.783333333337, 1213.3833333333364, 1215.033333333336, 1214.283333333336, 1214.5000000000034, 1213.5833333333362, 1214.4833333333363, 1214.4833333333358, 1214.0333333333358, 1214.0000000000027, 1213.6833333333363, 1213.9333333333357, 1214.4333333333366, 1213.400000000002, 1214.183333333336, 1213.883333333336, 1213.633333333336, 1215.0833333333358, 1213.3833333333369, 1216.1333333333362, 1213.8333333333362, 1213.6333333333364, 1215.3833333333364, 1212.5333333333363, 1214.0833333333362, 1214.1833333333361, 1214.6333333333369, 1215.0000000000036, 1214.3333333333364, 1213.1333333333364, 1214.7250000000026, 1213.2833333333358, 1214.633333333336, 1213.2833333333358, 1214.5333333333367, 1214.183333333336, 1214.3833333333366, 1214.8250000000025, 1214.133333333336, 1213.733333333336, 1213.383333333336, 1213.2333333333363, 1214.0833333333367, 1213.333333333336, 1214.4833333333363, 1214.2833333333358, 1214.6333333333357, 1213.8333333333367, 1213.7333333333365, 1214.0833333333364, 1214.4333333333363, 1214.083333333336, 1213.7333333333363, 1214.2000000000028, 1214.3833333333366, 1214.1333333333364, 1213.4833333333363, 1213.9333333333361, 1214.033333333336, 1213.6333333333362, 1213.5333333333365, 1213.3333333333362, 1214.783333333336, 1215.625000000003, 1214.6333333333364, 1214.2833333333365, 1213.3833333333362, 1214.6333333333355, 1214.5333333333365, 1214.4333333333363, 1214.233333333336, 1213.4833333333363, 1214.233333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.9333333333361, 1214.2833333333365, 1213.4833333333356, 1212.4833333333365, 1214.0833333333367, 1214.5333333333358, 1214.633333333336, 1213.4833333333365, 1214.783333333336, 1213.7333333333354, 1214.6000000000033, 1213.6333333333364, 1213.3833333333369, 1214.8833333333364, 1213.883333333336, 1214.850000000003, 1215.2333333333365, 1213.083333333336, 1214.4333333333361, 1214.9333333333366, 1214.7833333333365, 1213.9333333333368, 1212.4833333333365, 1212.9833333333356, 1213.9833333333358, 1214.683333333336, 1213.5833333333358, 1213.783333333337, 1213.3833333333364, 1215.033333333336, 1214.283333333336, 1214.5000000000034, 1213.5833333333362, 1214.4833333333363, 1214.4833333333358, 1214.0333333333358, 1214.0000000000027, 1213.6833333333363, 1213.9333333333357, 1214.4333333333366, 1213.400000000002, 1214.183333333336, 1213.883333333336, 1213.633333333336, 1215.0833333333358, 1213.3833333333369, 1216.1333333333362, 1213.8333333333362, 1213.6333333333364, 1215.3833333333364, 1212.5333333333363, 1214.0833333333362, 1214.1833333333361, 1214.6333333333369, 1215.0000000000036, 1214.3333333333364, 1213.1333333333364, 1214.7250000000026, 1213.2833333333358, 1214.633333333336, 1213.2833333333358, 1214.5333333333367, 1214.183333333336, 1214.3833333333366, 1214.8250000000025, 1214.133333333336, 1213.733333333336, 1213.383333333336, 1213.2333333333363, 1214.0833333333367, 1213.333333333336, 1214.4833333333363, 1214.2833333333358, 1214.6333333333357, 1213.8333333333367, 1213.7333333333365, 1214.0833333333364, 1214.4333333333363, 1214.083333333336, 1213.7333333333363, 1214.2000000000028, 1214.3833333333366, 1214.1333333333364, 1213.4833333333363, 1213.9333333333361, 1214.033333333336, 1213.6333333333362, 1213.5333333333365, 1213.3333333333362, 1214.783333333336, 1215.625000000003, 1214.6333333333364, 1214.2833333333365, 1213.3833333333362, 1214.6333333333355, 1214.5333333333365, 1214.4333333333363, 1214.233333333336, 1213.4833333333363, 1214.233333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2425836168347626, "mean_inference_ms": 2.068039170280957, "mean_action_processing_ms": 0.09109708090412807, "mean_env_wait_ms": 1.5405557240390033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006357669830322266, "StateBufferConnector_ms": 0.003355741500854492, "ViewRequirementAgentConnector_ms": 0.08644437789916992}, "num_episodes": 27, "episode_return_max": 1216.1333333333362, "episode_return_min": 1212.4833333333365, "episode_return_mean": 1214.088250000003, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 375000, "num_agent_steps_trained": 374700, "num_env_steps_sampled": 375000, "num_env_steps_trained": 374700, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 246.6622214858687, "num_env_steps_trained_throughput_per_sec": 232.15267904552348, "timesteps_total": 375000, "num_env_steps_sampled_lifetime": 375000, "num_agent_steps_sampled_lifetime": 375000, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 375000, "timers": {"training_iteration_time_ms": 10296.524, "restore_workers_time_ms": 0.012, "training_step_time_ms": 611.872, "sample_time_ms": 596.431, "synch_weights_time_ms": 13.999}, "counters": {"num_env_steps_sampled": 375000, "num_env_steps_trained": 374700, "num_agent_steps_sampled": 375000, "num_agent_steps_trained": 374700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2500, "num_samples_added_to_queue": 375000}, "done": false, "training_iteration": 149, "trial_id": "27800_00000", "date": "2024-10-12_15-53-36", "timestamp": 1728744816, "time_this_iter_s": 10.349422216415405, "time_total_s": 1541.8688457012177, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948950f70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1541.8688457012177, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 16.14, "ram_util_percent": 61.953333333333326}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3247.326904296875, "policy_loss": -329.6883544921875, "entropy": 4.775972366333008, "entropy_coeff": 0.01, "var_gnorm": 18.048439025878906, "vf_loss": 359134.34375, "vf_explained_var": 0.6547059416770935}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1258.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 377550, "num_env_steps_trained": 377400, "num_agent_steps_sampled": 377550, "num_agent_steps_trained": 377400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2517, "num_samples_added_to_queue": 377400, "learner_queue": {"size_count": 1258, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 68.51, "learner_load_time_ms": 0.312, "learner_load_wait_time_ms": 1129.441, "learner_dequeue_time_ms": 9877.515}}, "env_runners": {"episode_reward_max": 1216.1333333333362, "episode_reward_min": 1212.5333333333363, "episode_reward_mean": 1214.1216666666694, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.5333333333363}, "policy_reward_max": {"default_policy": 1216.1333333333362}, "policy_reward_mean": {"default_policy": 1214.1216666666694}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.3957, "num_moves_min": 0.1, "num_moves_max": 0.68, "mean_accuracy_mean": 43.632636666666656, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0028000000000000004, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.16274666666666665, "num_slav_min": 0.16125, "num_slav_max": 0.16386666666666663, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5379219899108292, "mean_cluster_cpu_util_min": 0.5358068693693694, "mean_cluster_cpu_util_max": 0.5400931582092298, "mean_cluster_mem_util_mean": 0.341639282700422, "mean_cluster_mem_util_min": 0.3411951476793249, "mean_cluster_mem_util_max": 0.34217088607594937, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.332416666666694, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4411999999999994, "reward_sla_mean_min": -2.458, "reward_sla_mean_max": -2.4187499999999997, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.2416666666695, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.12, "reward_sla_sum_min": -245.8, "reward_sla_sum_max": -241.87499999999997, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4843.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.9833333333358, 1214.683333333336, 1213.5833333333358, 1213.783333333337, 1213.3833333333364, 1215.033333333336, 1214.283333333336, 1214.5000000000034, 1213.5833333333362, 1214.4833333333363, 1214.4833333333358, 1214.0333333333358, 1214.0000000000027, 1213.6833333333363, 1213.9333333333357, 1214.4333333333366, 1213.400000000002, 1214.183333333336, 1213.883333333336, 1213.633333333336, 1215.0833333333358, 1213.3833333333369, 1216.1333333333362, 1213.8333333333362, 1213.6333333333364, 1215.3833333333364, 1212.5333333333363, 1214.0833333333362, 1214.1833333333361, 1214.6333333333369, 1215.0000000000036, 1214.3333333333364, 1213.1333333333364, 1214.7250000000026, 1213.2833333333358, 1214.633333333336, 1213.2833333333358, 1214.5333333333367, 1214.183333333336, 1214.3833333333366, 1214.8250000000025, 1214.133333333336, 1213.733333333336, 1213.383333333336, 1213.2333333333363, 1214.0833333333367, 1213.333333333336, 1214.4833333333363, 1214.2833333333358, 1214.6333333333357, 1213.8333333333367, 1213.7333333333365, 1214.0833333333364, 1214.4333333333363, 1214.083333333336, 1213.7333333333363, 1214.2000000000028, 1214.3833333333366, 1214.1333333333364, 1213.4833333333363, 1213.9333333333361, 1214.033333333336, 1213.6333333333362, 1213.5333333333365, 1213.3333333333362, 1214.783333333336, 1215.625000000003, 1214.6333333333364, 1214.2833333333365, 1213.3833333333362, 1214.6333333333355, 1214.5333333333365, 1214.4333333333363, 1214.233333333336, 1213.4833333333363, 1214.233333333336, 1213.5833333333364, 1214.2833333333363, 1213.7833333333365, 1213.9333333333363, 1214.950000000003, 1213.1833333333354, 1213.9333333333363, 1215.2000000000028, 1214.7833333333358, 1214.3333333333364, 1215.8833333333369, 1215.1833333333361, 1214.075000000002, 1213.4833333333358, 1213.383333333336, 1213.8833333333366, 1214.8333333333362, 1213.4833333333363, 1214.6833333333363, 1213.6833333333363, 1213.883333333336, 1213.3333333333362, 1213.233333333336, 1214.8833333333369], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.9833333333358, 1214.683333333336, 1213.5833333333358, 1213.783333333337, 1213.3833333333364, 1215.033333333336, 1214.283333333336, 1214.5000000000034, 1213.5833333333362, 1214.4833333333363, 1214.4833333333358, 1214.0333333333358, 1214.0000000000027, 1213.6833333333363, 1213.9333333333357, 1214.4333333333366, 1213.400000000002, 1214.183333333336, 1213.883333333336, 1213.633333333336, 1215.0833333333358, 1213.3833333333369, 1216.1333333333362, 1213.8333333333362, 1213.6333333333364, 1215.3833333333364, 1212.5333333333363, 1214.0833333333362, 1214.1833333333361, 1214.6333333333369, 1215.0000000000036, 1214.3333333333364, 1213.1333333333364, 1214.7250000000026, 1213.2833333333358, 1214.633333333336, 1213.2833333333358, 1214.5333333333367, 1214.183333333336, 1214.3833333333366, 1214.8250000000025, 1214.133333333336, 1213.733333333336, 1213.383333333336, 1213.2333333333363, 1214.0833333333367, 1213.333333333336, 1214.4833333333363, 1214.2833333333358, 1214.6333333333357, 1213.8333333333367, 1213.7333333333365, 1214.0833333333364, 1214.4333333333363, 1214.083333333336, 1213.7333333333363, 1214.2000000000028, 1214.3833333333366, 1214.1333333333364, 1213.4833333333363, 1213.9333333333361, 1214.033333333336, 1213.6333333333362, 1213.5333333333365, 1213.3333333333362, 1214.783333333336, 1215.625000000003, 1214.6333333333364, 1214.2833333333365, 1213.3833333333362, 1214.6333333333355, 1214.5333333333365, 1214.4333333333363, 1214.233333333336, 1213.4833333333363, 1214.233333333336, 1213.5833333333364, 1214.2833333333363, 1213.7833333333365, 1213.9333333333363, 1214.950000000003, 1213.1833333333354, 1213.9333333333363, 1215.2000000000028, 1214.7833333333358, 1214.3333333333364, 1215.8833333333369, 1215.1833333333361, 1214.075000000002, 1213.4833333333358, 1213.383333333336, 1213.8833333333366, 1214.8333333333362, 1213.4833333333363, 1214.6833333333363, 1213.6833333333363, 1213.883333333336, 1213.3333333333362, 1213.233333333336, 1214.8833333333369]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24257620827383775, "mean_inference_ms": 2.0678749721172873, "mean_action_processing_ms": 0.09108780259889915, "mean_env_wait_ms": 1.540475945797616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062465667724609375, "StateBufferConnector_ms": 0.00330352783203125, "ViewRequirementAgentConnector_ms": 0.08465170860290527}, "num_episodes": 24, "episode_return_max": 1216.1333333333362, "episode_return_min": 1212.5333333333363, "episode_return_mean": 1214.1216666666694, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 377550, "num_agent_steps_trained": 377400, "num_env_steps_sampled": 377550, "num_env_steps_trained": 377400, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 251.3713100002181, "num_env_steps_trained_throughput_per_sec": 266.15785764728975, "timesteps_total": 377550, "num_env_steps_sampled_lifetime": 377550, "num_agent_steps_sampled_lifetime": 377550, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 377550, "timers": {"training_iteration_time_ms": 10271.24, "restore_workers_time_ms": 0.013, "training_step_time_ms": 609.279, "sample_time_ms": 593.767, "synch_weights_time_ms": 13.912}, "counters": {"num_env_steps_sampled": 377550, "num_env_steps_trained": 377400, "num_agent_steps_sampled": 377550, "num_agent_steps_trained": 377400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2517, "num_samples_added_to_queue": 377400}, "done": false, "training_iteration": 150, "trial_id": "27800_00000", "date": "2024-10-12_15-53-46", "timestamp": 1728744826, "time_this_iter_s": 10.156269550323486, "time_total_s": 1552.0251152515411, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f2e90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1552.0251152515411, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 16.20714285714286, "ram_util_percent": 61.557142857142864}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1753.614013671875, "policy_loss": -1759.4281005859375, "entropy": 4.750707626342773, "entropy_coeff": 0.01, "var_gnorm": 18.040931701660156, "vf_loss": 352729.4375, "vf_explained_var": 0.6489930748939514}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1266.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 380100, "num_env_steps_trained": 379800, "num_agent_steps_sampled": 380100, "num_agent_steps_trained": 379800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2534, "num_samples_added_to_queue": 380100, "learner_queue": {"size_count": 1266, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 64.08, "learner_load_time_ms": 0.338, "learner_load_wait_time_ms": 1186.306, "learner_dequeue_time_ms": 9885.086}}, "env_runners": {"episode_reward_max": 1215.8833333333369, "episode_reward_min": 1213.1333333333364, "episode_reward_mean": 1214.1641666666696, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1213.1333333333364}, "policy_reward_max": {"default_policy": 1215.8833333333369}, "policy_reward_mean": {"default_policy": 1214.1641666666696}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.3335, "num_moves_min": 0.08, "num_moves_max": 0.68, "mean_accuracy_mean": 43.63282666666666, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0022, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.16273500000000002, "num_slav_min": 0.16125, "num_slav_max": 0.16346666666666668, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.537903771488325, "mean_cluster_cpu_util_min": 0.5358068693693694, "mean_cluster_cpu_util_max": 0.5400931582092298, "mean_cluster_mem_util_mean": 0.34165030063291135, "mean_cluster_mem_util_min": 0.34125632911392395, "mean_cluster_mem_util_max": 0.34217088607594937, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.332666666666691, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.441025, "reward_sla_mean_min": -2.452, "reward_sla_mean_max": -2.4187499999999997, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.2666666666695, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.1025, "reward_sla_sum_min": -245.2, "reward_sla_sum_max": -241.87499999999997, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3636.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.0833333333362, 1214.1833333333361, 1214.6333333333369, 1215.0000000000036, 1214.3333333333364, 1213.1333333333364, 1214.7250000000026, 1213.2833333333358, 1214.633333333336, 1213.2833333333358, 1214.5333333333367, 1214.183333333336, 1214.3833333333366, 1214.8250000000025, 1214.133333333336, 1213.733333333336, 1213.383333333336, 1213.2333333333363, 1214.0833333333367, 1213.333333333336, 1214.4833333333363, 1214.2833333333358, 1214.6333333333357, 1213.8333333333367, 1213.7333333333365, 1214.0833333333364, 1214.4333333333363, 1214.083333333336, 1213.7333333333363, 1214.2000000000028, 1214.3833333333366, 1214.1333333333364, 1213.4833333333363, 1213.9333333333361, 1214.033333333336, 1213.6333333333362, 1213.5333333333365, 1213.3333333333362, 1214.783333333336, 1215.625000000003, 1214.6333333333364, 1214.2833333333365, 1213.3833333333362, 1214.6333333333355, 1214.5333333333365, 1214.4333333333363, 1214.233333333336, 1213.4833333333363, 1214.233333333336, 1213.5833333333364, 1214.2833333333363, 1213.7833333333365, 1213.9333333333363, 1214.950000000003, 1213.1833333333354, 1213.9333333333363, 1215.2000000000028, 1214.7833333333358, 1214.3333333333364, 1215.8833333333369, 1215.1833333333361, 1214.075000000002, 1213.4833333333358, 1213.383333333336, 1213.8833333333366, 1214.8333333333362, 1213.4833333333363, 1214.6833333333363, 1213.6833333333363, 1213.883333333336, 1213.3333333333362, 1213.233333333336, 1214.8833333333369, 1214.3333333333364, 1214.0333333333363, 1213.9333333333366, 1214.583333333336, 1213.6833333333357, 1213.7333333333365, 1214.4333333333363, 1214.0833333333367, 1214.2333333333363, 1213.3333333333364, 1213.6833333333357, 1215.133333333336, 1214.183333333336, 1214.6333333333357, 1214.1333333333364, 1213.7833333333367, 1214.3833333333364, 1214.5833333333362, 1214.4333333333361, 1215.2333333333365, 1214.1833333333366, 1214.8333333333358, 1214.1333333333355, 1214.5333333333363, 1214.5833333333362, 1213.7333333333358, 1214.633333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.0833333333362, 1214.1833333333361, 1214.6333333333369, 1215.0000000000036, 1214.3333333333364, 1213.1333333333364, 1214.7250000000026, 1213.2833333333358, 1214.633333333336, 1213.2833333333358, 1214.5333333333367, 1214.183333333336, 1214.3833333333366, 1214.8250000000025, 1214.133333333336, 1213.733333333336, 1213.383333333336, 1213.2333333333363, 1214.0833333333367, 1213.333333333336, 1214.4833333333363, 1214.2833333333358, 1214.6333333333357, 1213.8333333333367, 1213.7333333333365, 1214.0833333333364, 1214.4333333333363, 1214.083333333336, 1213.7333333333363, 1214.2000000000028, 1214.3833333333366, 1214.1333333333364, 1213.4833333333363, 1213.9333333333361, 1214.033333333336, 1213.6333333333362, 1213.5333333333365, 1213.3333333333362, 1214.783333333336, 1215.625000000003, 1214.6333333333364, 1214.2833333333365, 1213.3833333333362, 1214.6333333333355, 1214.5333333333365, 1214.4333333333363, 1214.233333333336, 1213.4833333333363, 1214.233333333336, 1213.5833333333364, 1214.2833333333363, 1213.7833333333365, 1213.9333333333363, 1214.950000000003, 1213.1833333333354, 1213.9333333333363, 1215.2000000000028, 1214.7833333333358, 1214.3333333333364, 1215.8833333333369, 1215.1833333333361, 1214.075000000002, 1213.4833333333358, 1213.383333333336, 1213.8833333333366, 1214.8333333333362, 1213.4833333333363, 1214.6833333333363, 1213.6833333333363, 1213.883333333336, 1213.3333333333362, 1213.233333333336, 1214.8833333333369, 1214.3333333333364, 1214.0333333333363, 1213.9333333333366, 1214.583333333336, 1213.6833333333357, 1213.7333333333365, 1214.4333333333363, 1214.0833333333367, 1214.2333333333363, 1213.3333333333364, 1213.6833333333357, 1215.133333333336, 1214.183333333336, 1214.6333333333357, 1214.1333333333364, 1213.7833333333367, 1214.3833333333364, 1214.5833333333362, 1214.4333333333361, 1215.2333333333365, 1214.1833333333366, 1214.8333333333358, 1214.1333333333355, 1214.5333333333363, 1214.5833333333362, 1213.7333333333358, 1214.633333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24252287654817117, "mean_inference_ms": 2.065999564525414, "mean_action_processing_ms": 0.09105602362545262, "mean_env_wait_ms": 1.5399696430836907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006211519241333008, "StateBufferConnector_ms": 0.0033109188079833984, "ViewRequirementAgentConnector_ms": 0.08446598052978516}, "num_episodes": 27, "episode_return_max": 1215.8833333333369, "episode_return_min": 1213.1333333333364, "episode_return_mean": 1214.1641666666696, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380100, "num_agent_steps_trained": 379800, "num_env_steps_sampled": 380100, "num_env_steps_trained": 379800, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 240.1930891467528, "num_env_steps_trained_throughput_per_sec": 226.06408390282616, "timesteps_total": 380100, "num_env_steps_sampled_lifetime": 380100, "num_agent_steps_sampled_lifetime": 380100, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 380100, "timers": {"training_iteration_time_ms": 10295.257, "restore_workers_time_ms": 0.016, "training_step_time_ms": 644.505, "sample_time_ms": 628.631, "synch_weights_time_ms": 14.389}, "counters": {"num_env_steps_sampled": 380100, "num_env_steps_trained": 379800, "num_agent_steps_sampled": 380100, "num_agent_steps_trained": 379800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2534, "num_samples_added_to_queue": 380100}, "done": false, "training_iteration": 151, "trial_id": "27800_00000", "date": "2024-10-12_15-53-57", "timestamp": 1728744837, "time_this_iter_s": 10.628327369689941, "time_total_s": 1562.653442621231, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b44ac0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1562.653442621231, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 15.95625, "ram_util_percent": 61.712500000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4883.765625, "policy_loss": 1210.9461669921875, "entropy": 4.9829182624816895, "entropy_coeff": 0.01, "var_gnorm": 18.036157608032227, "vf_loss": 368776.84375, "vf_explained_var": 0.6322430372238159}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1274.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 382350, "num_env_steps_trained": 382200, "num_agent_steps_sampled": 382350, "num_agent_steps_trained": 382200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2549, "num_samples_added_to_queue": 382200, "learner_queue": {"size_count": 1274, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 68.792, "learner_load_time_ms": 0.343, "learner_load_wait_time_ms": 1262.892, "learner_dequeue_time_ms": 9989.592}}, "env_runners": {"episode_reward_max": 1215.8833333333369, "episode_reward_min": 1213.0833333333362, "episode_reward_mean": 1214.1786666666694, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1213.0833333333362}, "policy_reward_max": {"default_policy": 1215.8833333333369}, "policy_reward_mean": {"default_policy": 1214.1786666666694}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.37000000000000005, "num_moves_min": 0.08, "num_moves_max": 0.68, "mean_accuracy_mean": 43.63301666666666, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0016, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.162742, "num_slav_min": 0.16125, "num_slav_max": 0.16350000000000006, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5378868139823496, "mean_cluster_cpu_util_min": 0.5358068693693694, "mean_cluster_cpu_util_max": 0.5404655612244897, "mean_cluster_mem_util_mean": 0.3416402689873418, "mean_cluster_mem_util_min": 0.34125632911392395, "mean_cluster_mem_util_max": 0.34217088607594937, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.332916666666693, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.44113, "reward_sla_mean_min": -2.4525, "reward_sla_mean_max": -2.4187499999999997, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.2916666666695, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.11300000000003, "reward_sla_sum_min": -245.25, "reward_sla_sum_max": -241.87499999999997, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2699.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.2833333333358, 1214.6333333333357, 1213.8333333333367, 1213.7333333333365, 1214.0833333333364, 1214.4333333333363, 1214.083333333336, 1213.7333333333363, 1214.2000000000028, 1214.3833333333366, 1214.1333333333364, 1213.4833333333363, 1213.9333333333361, 1214.033333333336, 1213.6333333333362, 1213.5333333333365, 1213.3333333333362, 1214.783333333336, 1215.625000000003, 1214.6333333333364, 1214.2833333333365, 1213.3833333333362, 1214.6333333333355, 1214.5333333333365, 1214.4333333333363, 1214.233333333336, 1213.4833333333363, 1214.233333333336, 1213.5833333333364, 1214.2833333333363, 1213.7833333333365, 1213.9333333333363, 1214.950000000003, 1213.1833333333354, 1213.9333333333363, 1215.2000000000028, 1214.7833333333358, 1214.3333333333364, 1215.8833333333369, 1215.1833333333361, 1214.075000000002, 1213.4833333333358, 1213.383333333336, 1213.8833333333366, 1214.8333333333362, 1213.4833333333363, 1214.6833333333363, 1213.6833333333363, 1213.883333333336, 1213.3333333333362, 1213.233333333336, 1214.8833333333369, 1214.3333333333364, 1214.0333333333363, 1213.9333333333366, 1214.583333333336, 1213.6833333333357, 1213.7333333333365, 1214.4333333333363, 1214.0833333333367, 1214.2333333333363, 1213.3333333333364, 1213.6833333333357, 1215.133333333336, 1214.183333333336, 1214.6333333333357, 1214.1333333333364, 1213.7833333333367, 1214.3833333333364, 1214.5833333333362, 1214.4333333333361, 1215.2333333333365, 1214.1833333333366, 1214.8333333333358, 1214.1333333333355, 1214.5333333333363, 1214.5833333333362, 1213.7333333333358, 1214.633333333336, 1214.483333333336, 1213.7833333333367, 1214.6833333333363, 1214.1833333333368, 1213.9333333333361, 1214.3333333333371, 1214.083333333336, 1214.0333333333365, 1214.2833333333363, 1214.433333333336, 1214.2333333333363, 1213.883333333336, 1213.8333333333364, 1213.0833333333362, 1213.583333333336, 1214.6333333333366, 1214.6833333333366, 1214.6333333333357, 1214.3333333333362, 1213.533333333336, 1214.3833333333364], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.2833333333358, 1214.6333333333357, 1213.8333333333367, 1213.7333333333365, 1214.0833333333364, 1214.4333333333363, 1214.083333333336, 1213.7333333333363, 1214.2000000000028, 1214.3833333333366, 1214.1333333333364, 1213.4833333333363, 1213.9333333333361, 1214.033333333336, 1213.6333333333362, 1213.5333333333365, 1213.3333333333362, 1214.783333333336, 1215.625000000003, 1214.6333333333364, 1214.2833333333365, 1213.3833333333362, 1214.6333333333355, 1214.5333333333365, 1214.4333333333363, 1214.233333333336, 1213.4833333333363, 1214.233333333336, 1213.5833333333364, 1214.2833333333363, 1213.7833333333365, 1213.9333333333363, 1214.950000000003, 1213.1833333333354, 1213.9333333333363, 1215.2000000000028, 1214.7833333333358, 1214.3333333333364, 1215.8833333333369, 1215.1833333333361, 1214.075000000002, 1213.4833333333358, 1213.383333333336, 1213.8833333333366, 1214.8333333333362, 1213.4833333333363, 1214.6833333333363, 1213.6833333333363, 1213.883333333336, 1213.3333333333362, 1213.233333333336, 1214.8833333333369, 1214.3333333333364, 1214.0333333333363, 1213.9333333333366, 1214.583333333336, 1213.6833333333357, 1213.7333333333365, 1214.4333333333363, 1214.0833333333367, 1214.2333333333363, 1213.3333333333364, 1213.6833333333357, 1215.133333333336, 1214.183333333336, 1214.6333333333357, 1214.1333333333364, 1213.7833333333367, 1214.3833333333364, 1214.5833333333362, 1214.4333333333361, 1215.2333333333365, 1214.1833333333366, 1214.8333333333358, 1214.1333333333355, 1214.5333333333363, 1214.5833333333362, 1213.7333333333358, 1214.633333333336, 1214.483333333336, 1213.7833333333367, 1214.6833333333363, 1214.1833333333368, 1213.9333333333361, 1214.3333333333371, 1214.083333333336, 1214.0333333333365, 1214.2833333333363, 1214.433333333336, 1214.2333333333363, 1213.883333333336, 1213.8333333333364, 1213.0833333333362, 1213.583333333336, 1214.6333333333366, 1214.6833333333366, 1214.6333333333357, 1214.3333333333362, 1213.533333333336, 1214.3833333333364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24257477388534568, "mean_inference_ms": 2.067826278037296, "mean_action_processing_ms": 0.0910756596671937, "mean_env_wait_ms": 1.5404548367745097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064198970794677734, "StateBufferConnector_ms": 0.003371000289916992, "ViewRequirementAgentConnector_ms": 0.08600521087646484}, "num_episodes": 21, "episode_return_max": 1215.8833333333369, "episode_return_min": 1213.0833333333362, "episode_return_mean": 1214.1786666666694, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 382350, "num_agent_steps_trained": 382200, "num_env_steps_sampled": 382350, "num_env_steps_trained": 382200, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 222.4193483383923, "num_env_steps_trained_throughput_per_sec": 237.24730489428512, "timesteps_total": 382350, "num_env_steps_sampled_lifetime": 382350, "num_agent_steps_sampled_lifetime": 382350, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 382350, "timers": {"training_iteration_time_ms": 10263.04, "restore_workers_time_ms": 0.014, "training_step_time_ms": 689.892, "sample_time_ms": 672.308, "synch_weights_time_ms": 15.859}, "counters": {"num_env_steps_sampled": 382350, "num_env_steps_trained": 382200, "num_agent_steps_sampled": 382350, "num_agent_steps_trained": 382200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2549, "num_samples_added_to_queue": 382200}, "done": false, "training_iteration": 152, "trial_id": "27800_00000", "date": "2024-10-12_15-54-07", "timestamp": 1728744847, "time_this_iter_s": 10.134461879730225, "time_total_s": 1572.7879045009613, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948951180>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1572.7879045009613, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 21.678571428571427, "ram_util_percent": 62.88571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4635.18505859375, "policy_loss": 934.6533203125, "entropy": 4.860377788543701, "entropy_coeff": 0.01, "var_gnorm": 18.037229537963867, "vf_loss": 371511.28125, "vf_explained_var": 0.6418619155883789}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1282.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 384750, "num_env_steps_trained": 384600, "num_agent_steps_sampled": 384750, "num_agent_steps_trained": 384600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2565, "num_samples_added_to_queue": 384600, "learner_queue": {"size_count": 1282, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.116, "learner_load_time_ms": 0.352, "learner_load_wait_time_ms": 1258.259, "learner_dequeue_time_ms": 10040.038}}, "env_runners": {"episode_reward_max": 1215.8833333333369, "episode_reward_min": 1213.0833333333362, "episode_reward_mean": 1214.2040833333363, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1213.0833333333362}, "policy_reward_max": {"default_policy": 1215.8833333333369}, "policy_reward_mean": {"default_policy": 1214.2040833333363}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.37140000000000006, "num_moves_min": 0.08, "num_moves_max": 0.68, "mean_accuracy_mean": 43.63314333333333, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0008, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16273616666666668, "num_slav_min": 0.16153333333333336, "num_slav_max": 0.16350000000000006, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5378431636100387, "mean_cluster_cpu_util_min": 0.5358068693693694, "mean_cluster_cpu_util_max": 0.5404655612244897, "mean_cluster_mem_util_mean": 0.3416457700421941, "mean_cluster_mem_util_min": 0.34123945147679324, "mean_cluster_mem_util_max": 0.34217088607594937, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.33308333333336, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4410425, "reward_sla_mean_min": -2.4525, "reward_sla_mean_max": -2.423, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3083333333362, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.10424999999998, "reward_sla_sum_min": -245.25, "reward_sla_sum_max": -242.29999999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1934.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.4333333333363, 1214.233333333336, 1213.4833333333363, 1214.233333333336, 1213.5833333333364, 1214.2833333333363, 1213.7833333333365, 1213.9333333333363, 1214.950000000003, 1213.1833333333354, 1213.9333333333363, 1215.2000000000028, 1214.7833333333358, 1214.3333333333364, 1215.8833333333369, 1215.1833333333361, 1214.075000000002, 1213.4833333333358, 1213.383333333336, 1213.8833333333366, 1214.8333333333362, 1213.4833333333363, 1214.6833333333363, 1213.6833333333363, 1213.883333333336, 1213.3333333333362, 1213.233333333336, 1214.8833333333369, 1214.3333333333364, 1214.0333333333363, 1213.9333333333366, 1214.583333333336, 1213.6833333333357, 1213.7333333333365, 1214.4333333333363, 1214.0833333333367, 1214.2333333333363, 1213.3333333333364, 1213.6833333333357, 1215.133333333336, 1214.183333333336, 1214.6333333333357, 1214.1333333333364, 1213.7833333333367, 1214.3833333333364, 1214.5833333333362, 1214.4333333333361, 1215.2333333333365, 1214.1833333333366, 1214.8333333333358, 1214.1333333333355, 1214.5333333333363, 1214.5833333333362, 1213.7333333333358, 1214.633333333336, 1214.483333333336, 1213.7833333333367, 1214.6833333333363, 1214.1833333333368, 1213.9333333333361, 1214.3333333333371, 1214.083333333336, 1214.0333333333365, 1214.2833333333363, 1214.433333333336, 1214.2333333333363, 1213.883333333336, 1213.8333333333364, 1213.0833333333362, 1213.583333333336, 1214.6333333333366, 1214.6833333333366, 1214.6333333333357, 1214.3333333333362, 1213.533333333336, 1214.3833333333364, 1214.2333333333365, 1213.6833333333363, 1214.8833333333366, 1214.3833333333369, 1214.3833333333362, 1213.3333333333364, 1213.6833333333363, 1214.083333333336, 1213.6833333333361, 1214.1833333333366, 1214.8833333333366, 1214.633333333336, 1213.1833333333361, 1215.3833333333362, 1214.7333333333365, 1214.183333333336, 1213.4833333333365, 1214.5333333333363, 1214.6333333333357, 1214.4333333333366, 1214.433333333336, 1214.0333333333365, 1214.3333333333362, 1214.4833333333352], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.4333333333363, 1214.233333333336, 1213.4833333333363, 1214.233333333336, 1213.5833333333364, 1214.2833333333363, 1213.7833333333365, 1213.9333333333363, 1214.950000000003, 1213.1833333333354, 1213.9333333333363, 1215.2000000000028, 1214.7833333333358, 1214.3333333333364, 1215.8833333333369, 1215.1833333333361, 1214.075000000002, 1213.4833333333358, 1213.383333333336, 1213.8833333333366, 1214.8333333333362, 1213.4833333333363, 1214.6833333333363, 1213.6833333333363, 1213.883333333336, 1213.3333333333362, 1213.233333333336, 1214.8833333333369, 1214.3333333333364, 1214.0333333333363, 1213.9333333333366, 1214.583333333336, 1213.6833333333357, 1213.7333333333365, 1214.4333333333363, 1214.0833333333367, 1214.2333333333363, 1213.3333333333364, 1213.6833333333357, 1215.133333333336, 1214.183333333336, 1214.6333333333357, 1214.1333333333364, 1213.7833333333367, 1214.3833333333364, 1214.5833333333362, 1214.4333333333361, 1215.2333333333365, 1214.1833333333366, 1214.8333333333358, 1214.1333333333355, 1214.5333333333363, 1214.5833333333362, 1213.7333333333358, 1214.633333333336, 1214.483333333336, 1213.7833333333367, 1214.6833333333363, 1214.1833333333368, 1213.9333333333361, 1214.3333333333371, 1214.083333333336, 1214.0333333333365, 1214.2833333333363, 1214.433333333336, 1214.2333333333363, 1213.883333333336, 1213.8333333333364, 1213.0833333333362, 1213.583333333336, 1214.6333333333366, 1214.6833333333366, 1214.6333333333357, 1214.3333333333362, 1213.533333333336, 1214.3833333333364, 1214.2333333333365, 1213.6833333333363, 1214.8833333333366, 1214.3833333333369, 1214.3833333333362, 1213.3333333333364, 1213.6833333333363, 1214.083333333336, 1213.6833333333361, 1214.1833333333366, 1214.8833333333366, 1214.633333333336, 1213.1833333333361, 1215.3833333333362, 1214.7333333333365, 1214.183333333336, 1213.4833333333365, 1214.5333333333363, 1214.6333333333357, 1214.4333333333366, 1214.433333333336, 1214.0333333333365, 1214.3333333333362, 1214.4833333333352]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24255710524661275, "mean_inference_ms": 2.066183664925542, "mean_action_processing_ms": 0.09106078932365368, "mean_env_wait_ms": 1.540122569026501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006479740142822266, "StateBufferConnector_ms": 0.003371715545654297, "ViewRequirementAgentConnector_ms": 0.08592820167541504}, "num_episodes": 24, "episode_return_max": 1215.8833333333369, "episode_return_min": 1213.0833333333362, "episode_return_mean": 1214.2040833333363, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384750, "num_agent_steps_trained": 384600, "num_env_steps_sampled": 384750, "num_env_steps_trained": 384600, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 238.0700693947036, "num_env_steps_trained_throughput_per_sec": 238.0700693947036, "timesteps_total": 384750, "num_env_steps_sampled_lifetime": 384750, "num_agent_steps_sampled_lifetime": 384750, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 384750, "timers": {"training_iteration_time_ms": 10230.59, "restore_workers_time_ms": 0.014, "training_step_time_ms": 596.82, "sample_time_ms": 580.697, "synch_weights_time_ms": 14.615}, "counters": {"num_env_steps_sampled": 384750, "num_env_steps_trained": 384600, "num_agent_steps_sampled": 384750, "num_agent_steps_trained": 384600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2565, "num_samples_added_to_queue": 384600}, "done": false, "training_iteration": 153, "trial_id": "27800_00000", "date": "2024-10-12_15-54-17", "timestamp": 1728744857, "time_this_iter_s": 10.090809345245361, "time_total_s": 1582.8787138462067, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f0370>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1582.8787138462067, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 17.71333333333333, "ram_util_percent": 64.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4663.76953125, "policy_loss": 760.1168212890625, "entropy": 4.663557052612305, "entropy_coeff": 0.01, "var_gnorm": 18.044084548950195, "vf_loss": 391764.34375, "vf_explained_var": 0.6353107690811157}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1290.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 387150, "num_env_steps_trained": 387000, "num_agent_steps_sampled": 387150, "num_agent_steps_trained": 387000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2581, "num_samples_added_to_queue": 387000, "learner_queue": {"size_count": 1290, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.93, "learner_load_time_ms": 0.394, "learner_load_wait_time_ms": 1203.083, "learner_dequeue_time_ms": 10088.513}}, "env_runners": {"episode_reward_max": 1215.5333333333358, "episode_reward_min": 1212.783333333336, "episode_reward_mean": 1214.1803333333364, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.783333333336}, "policy_reward_max": {"default_policy": 1215.5333333333358}, "policy_reward_mean": {"default_policy": 1214.1803333333364}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.31880000000000003, "num_moves_min": 0.08, "num_moves_max": 0.57, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.1627686666666667, "num_slav_min": 0.16186666666666663, "num_slav_max": 0.1637, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5377936924296746, "mean_cluster_cpu_util_min": 0.5358663701967273, "mean_cluster_cpu_util_max": 0.5404655612244897, "mean_cluster_mem_util_mean": 0.34162234177215195, "mean_cluster_mem_util_min": 0.34123945147679324, "mean_cluster_mem_util_max": 0.34217088607594937, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4415299999999998, "reward_sla_mean_min": -2.4555000000000002, "reward_sla_mean_max": -2.428, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.153, "reward_sla_sum_min": -245.55, "reward_sla_sum_max": -242.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2578.0, "global_timestep_min": 700, "global_timestep_max": 4200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.883333333336, 1213.3333333333362, 1213.233333333336, 1214.8833333333369, 1214.3333333333364, 1214.0333333333363, 1213.9333333333366, 1214.583333333336, 1213.6833333333357, 1213.7333333333365, 1214.4333333333363, 1214.0833333333367, 1214.2333333333363, 1213.3333333333364, 1213.6833333333357, 1215.133333333336, 1214.183333333336, 1214.6333333333357, 1214.1333333333364, 1213.7833333333367, 1214.3833333333364, 1214.5833333333362, 1214.4333333333361, 1215.2333333333365, 1214.1833333333366, 1214.8333333333358, 1214.1333333333355, 1214.5333333333363, 1214.5833333333362, 1213.7333333333358, 1214.633333333336, 1214.483333333336, 1213.7833333333367, 1214.6833333333363, 1214.1833333333368, 1213.9333333333361, 1214.3333333333371, 1214.083333333336, 1214.0333333333365, 1214.2833333333363, 1214.433333333336, 1214.2333333333363, 1213.883333333336, 1213.8333333333364, 1213.0833333333362, 1213.583333333336, 1214.6333333333366, 1214.6833333333366, 1214.6333333333357, 1214.3333333333362, 1213.533333333336, 1214.3833333333364, 1214.2333333333365, 1213.6833333333363, 1214.8833333333366, 1214.3833333333369, 1214.3833333333362, 1213.3333333333364, 1213.6833333333363, 1214.083333333336, 1213.6833333333361, 1214.1833333333366, 1214.8833333333366, 1214.633333333336, 1213.1833333333361, 1215.3833333333362, 1214.7333333333365, 1214.183333333336, 1213.4833333333365, 1214.5333333333363, 1214.6333333333357, 1214.4333333333366, 1214.433333333336, 1214.0333333333365, 1214.3333333333362, 1214.4833333333352, 1213.7333333333363, 1214.6833333333357, 1213.5833333333362, 1213.8833333333355, 1214.283333333336, 1213.683333333336, 1213.8333333333362, 1214.2833333333363, 1214.4333333333357, 1214.2833333333358, 1214.1833333333361, 1213.9833333333363, 1213.533333333336, 1214.3833333333369, 1214.6333333333362, 1214.933333333336, 1214.733333333336, 1214.1833333333357, 1213.8333333333362, 1213.2333333333358, 1214.0833333333358, 1213.8333333333358, 1212.783333333336, 1215.5333333333358], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.883333333336, 1213.3333333333362, 1213.233333333336, 1214.8833333333369, 1214.3333333333364, 1214.0333333333363, 1213.9333333333366, 1214.583333333336, 1213.6833333333357, 1213.7333333333365, 1214.4333333333363, 1214.0833333333367, 1214.2333333333363, 1213.3333333333364, 1213.6833333333357, 1215.133333333336, 1214.183333333336, 1214.6333333333357, 1214.1333333333364, 1213.7833333333367, 1214.3833333333364, 1214.5833333333362, 1214.4333333333361, 1215.2333333333365, 1214.1833333333366, 1214.8333333333358, 1214.1333333333355, 1214.5333333333363, 1214.5833333333362, 1213.7333333333358, 1214.633333333336, 1214.483333333336, 1213.7833333333367, 1214.6833333333363, 1214.1833333333368, 1213.9333333333361, 1214.3333333333371, 1214.083333333336, 1214.0333333333365, 1214.2833333333363, 1214.433333333336, 1214.2333333333363, 1213.883333333336, 1213.8333333333364, 1213.0833333333362, 1213.583333333336, 1214.6333333333366, 1214.6833333333366, 1214.6333333333357, 1214.3333333333362, 1213.533333333336, 1214.3833333333364, 1214.2333333333365, 1213.6833333333363, 1214.8833333333366, 1214.3833333333369, 1214.3833333333362, 1213.3333333333364, 1213.6833333333363, 1214.083333333336, 1213.6833333333361, 1214.1833333333366, 1214.8833333333366, 1214.633333333336, 1213.1833333333361, 1215.3833333333362, 1214.7333333333365, 1214.183333333336, 1213.4833333333365, 1214.5333333333363, 1214.6333333333357, 1214.4333333333366, 1214.433333333336, 1214.0333333333365, 1214.3333333333362, 1214.4833333333352, 1213.7333333333363, 1214.6833333333357, 1213.5833333333362, 1213.8833333333355, 1214.283333333336, 1213.683333333336, 1213.8333333333362, 1214.2833333333363, 1214.4333333333357, 1214.2833333333358, 1214.1833333333361, 1213.9833333333363, 1213.533333333336, 1214.3833333333369, 1214.6333333333362, 1214.933333333336, 1214.733333333336, 1214.1833333333357, 1213.8333333333362, 1213.2333333333358, 1214.0833333333358, 1213.8333333333358, 1212.783333333336, 1215.5333333333358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24262617155398736, "mean_inference_ms": 2.0668364184546073, "mean_action_processing_ms": 0.09107850284713713, "mean_env_wait_ms": 1.5404559657500005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00662994384765625, "StateBufferConnector_ms": 0.003464221954345703, "ViewRequirementAgentConnector_ms": 0.08779358863830566}, "num_episodes": 24, "episode_return_max": 1215.5333333333358, "episode_return_min": 1212.783333333336, "episode_return_mean": 1214.1803333333364, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 387150, "num_agent_steps_trained": 387000, "num_env_steps_sampled": 387150, "num_env_steps_trained": 387000, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 229.43307521172122, "num_env_steps_trained_throughput_per_sec": 229.43307521172122, "timesteps_total": 387150, "num_env_steps_sampled_lifetime": 387150, "num_agent_steps_sampled_lifetime": 387150, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 387150, "timers": {"training_iteration_time_ms": 10253.37, "restore_workers_time_ms": 0.014, "training_step_time_ms": 687.938, "sample_time_ms": 670.038, "synch_weights_time_ms": 16.143}, "counters": {"num_env_steps_sampled": 387150, "num_env_steps_trained": 387000, "num_agent_steps_sampled": 387150, "num_agent_steps_trained": 387000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2581, "num_samples_added_to_queue": 387000}, "done": false, "training_iteration": 154, "trial_id": "27800_00000", "date": "2024-10-12_15-54-28", "timestamp": 1728744868, "time_this_iter_s": 10.480006456375122, "time_total_s": 1593.3587203025818, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9489520b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1593.3587203025818, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 19.26, "ram_util_percent": 64.67333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1809.1234130859375, "policy_loss": -1512.419189453125, "entropy": 4.9219841957092285, "entropy_coeff": 0.01, "var_gnorm": 18.057109832763672, "vf_loss": 333630.875, "vf_explained_var": 0.6542349457740784}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1298.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 389700, "num_env_steps_trained": 389400, "num_agent_steps_sampled": 389700, "num_agent_steps_trained": 389400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2598, "num_samples_added_to_queue": 389700, "learner_queue": {"size_count": 1298, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 75.054, "learner_load_time_ms": 0.393, "learner_load_wait_time_ms": 1185.57, "learner_dequeue_time_ms": 10139.724}}, "env_runners": {"episode_reward_max": 1215.5333333333358, "episode_reward_min": 1212.783333333336, "episode_reward_mean": 1214.1703333333362, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.783333333336}, "policy_reward_max": {"default_policy": 1215.5333333333358}, "policy_reward_mean": {"default_policy": 1214.1703333333362}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.3338000000000001, "num_moves_min": 0.12, "num_moves_max": 0.57, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.16277533333333336, "num_slav_min": 0.16186666666666663, "num_slav_max": 0.1637, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5378101615646258, "mean_cluster_cpu_util_min": 0.5353149246184961, "mean_cluster_cpu_util_max": 0.5404655612244897, "mean_cluster_mem_util_mean": 0.34161119198312234, "mean_cluster_mem_util_min": 0.34086708860759496, "mean_cluster_mem_util_max": 0.342129746835443, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4416299999999995, "reward_sla_mean_min": -2.4555000000000002, "reward_sla_mean_max": -2.428, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.16299999999995, "reward_sla_sum_min": -245.55, "reward_sla_sum_max": -242.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3478.0, "global_timestep_min": 1600, "global_timestep_max": 5100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.5333333333363, 1214.5833333333362, 1213.7333333333358, 1214.633333333336, 1214.483333333336, 1213.7833333333367, 1214.6833333333363, 1214.1833333333368, 1213.9333333333361, 1214.3333333333371, 1214.083333333336, 1214.0333333333365, 1214.2833333333363, 1214.433333333336, 1214.2333333333363, 1213.883333333336, 1213.8333333333364, 1213.0833333333362, 1213.583333333336, 1214.6333333333366, 1214.6833333333366, 1214.6333333333357, 1214.3333333333362, 1213.533333333336, 1214.3833333333364, 1214.2333333333365, 1213.6833333333363, 1214.8833333333366, 1214.3833333333369, 1214.3833333333362, 1213.3333333333364, 1213.6833333333363, 1214.083333333336, 1213.6833333333361, 1214.1833333333366, 1214.8833333333366, 1214.633333333336, 1213.1833333333361, 1215.3833333333362, 1214.7333333333365, 1214.183333333336, 1213.4833333333365, 1214.5333333333363, 1214.6333333333357, 1214.4333333333366, 1214.433333333336, 1214.0333333333365, 1214.3333333333362, 1214.4833333333352, 1213.7333333333363, 1214.6833333333357, 1213.5833333333362, 1213.8833333333355, 1214.283333333336, 1213.683333333336, 1213.8333333333362, 1214.2833333333363, 1214.4333333333357, 1214.2833333333358, 1214.1833333333361, 1213.9833333333363, 1213.533333333336, 1214.3833333333369, 1214.6333333333362, 1214.933333333336, 1214.733333333336, 1214.1833333333357, 1213.8333333333362, 1213.2333333333358, 1214.0833333333358, 1213.8333333333358, 1212.783333333336, 1215.5333333333358, 1214.2333333333365, 1213.7333333333358, 1213.433333333336, 1214.7333333333358, 1214.6833333333363, 1214.5833333333358, 1214.233333333336, 1213.7833333333367, 1213.8833333333364, 1214.733333333337, 1213.8333333333362, 1213.5333333333367, 1215.4333333333361, 1214.733333333336, 1214.1333333333366, 1213.233333333336, 1214.3833333333362, 1213.0333333333358, 1213.8833333333357, 1213.483333333336, 1214.9333333333361, 1214.1833333333366, 1213.7333333333368, 1213.6833333333363, 1214.5333333333363, 1214.4833333333365, 1214.7833333333365], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.5333333333363, 1214.5833333333362, 1213.7333333333358, 1214.633333333336, 1214.483333333336, 1213.7833333333367, 1214.6833333333363, 1214.1833333333368, 1213.9333333333361, 1214.3333333333371, 1214.083333333336, 1214.0333333333365, 1214.2833333333363, 1214.433333333336, 1214.2333333333363, 1213.883333333336, 1213.8333333333364, 1213.0833333333362, 1213.583333333336, 1214.6333333333366, 1214.6833333333366, 1214.6333333333357, 1214.3333333333362, 1213.533333333336, 1214.3833333333364, 1214.2333333333365, 1213.6833333333363, 1214.8833333333366, 1214.3833333333369, 1214.3833333333362, 1213.3333333333364, 1213.6833333333363, 1214.083333333336, 1213.6833333333361, 1214.1833333333366, 1214.8833333333366, 1214.633333333336, 1213.1833333333361, 1215.3833333333362, 1214.7333333333365, 1214.183333333336, 1213.4833333333365, 1214.5333333333363, 1214.6333333333357, 1214.4333333333366, 1214.433333333336, 1214.0333333333365, 1214.3333333333362, 1214.4833333333352, 1213.7333333333363, 1214.6833333333357, 1213.5833333333362, 1213.8833333333355, 1214.283333333336, 1213.683333333336, 1213.8333333333362, 1214.2833333333363, 1214.4333333333357, 1214.2833333333358, 1214.1833333333361, 1213.9833333333363, 1213.533333333336, 1214.3833333333369, 1214.6333333333362, 1214.933333333336, 1214.733333333336, 1214.1833333333357, 1213.8333333333362, 1213.2333333333358, 1214.0833333333358, 1213.8333333333358, 1212.783333333336, 1215.5333333333358, 1214.2333333333365, 1213.7333333333358, 1213.433333333336, 1214.7333333333358, 1214.6833333333363, 1214.5833333333358, 1214.233333333336, 1213.7833333333367, 1213.8833333333364, 1214.733333333337, 1213.8333333333362, 1213.5333333333367, 1215.4333333333361, 1214.733333333336, 1214.1333333333366, 1213.233333333336, 1214.3833333333362, 1213.0333333333358, 1213.8833333333357, 1213.483333333336, 1214.9333333333361, 1214.1833333333366, 1213.7333333333368, 1213.6833333333363, 1214.5333333333363, 1214.4833333333365, 1214.7833333333365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2426926427982506, "mean_inference_ms": 2.067518131647319, "mean_action_processing_ms": 0.09109839343145108, "mean_env_wait_ms": 1.5407927839061557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065076351165771484, "StateBufferConnector_ms": 0.003378152847290039, "ViewRequirementAgentConnector_ms": 0.0866086483001709}, "num_episodes": 27, "episode_return_max": 1215.5333333333358, "episode_return_min": 1212.783333333336, "episode_return_mean": 1214.1703333333362, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 389700, "num_agent_steps_trained": 389400, "num_env_steps_sampled": 389700, "num_env_steps_trained": 389400, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 244.80203765123807, "num_env_steps_trained_throughput_per_sec": 230.40191778940056, "timesteps_total": 389700, "num_env_steps_sampled_lifetime": 389700, "num_agent_steps_sampled_lifetime": 389700, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 389700, "timers": {"training_iteration_time_ms": 10271.109, "restore_workers_time_ms": 0.013, "training_step_time_ms": 611.556, "sample_time_ms": 595.913, "synch_weights_time_ms": 14.123}, "counters": {"num_env_steps_sampled": 389700, "num_env_steps_trained": 389400, "num_agent_steps_sampled": 389700, "num_agent_steps_trained": 389400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2598, "num_samples_added_to_queue": 389700}, "done": false, "training_iteration": 155, "trial_id": "27800_00000", "date": "2024-10-12_15-54-38", "timestamp": 1728744878, "time_this_iter_s": 10.4284987449646, "time_total_s": 1603.7872190475464, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9488c0190>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1603.7872190475464, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 17.214285714285715, "ram_util_percent": 64.18571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 5317.94140625, "policy_loss": 1628.397216796875, "entropy": 4.959802150726318, "entropy_coeff": 0.01, "var_gnorm": 18.068471908569336, "vf_loss": 370442.375, "vf_explained_var": 0.6421221494674683}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1306.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 392100, "num_env_steps_trained": 391800, "num_agent_steps_sampled": 392100, "num_agent_steps_trained": 391800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2614, "num_samples_added_to_queue": 392100, "learner_queue": {"size_count": 1306, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 68.953, "learner_load_time_ms": 0.405, "learner_load_wait_time_ms": 1184.775, "learner_dequeue_time_ms": 10061.896}}, "env_runners": {"episode_reward_max": 1216.3833333333369, "episode_reward_min": 1212.783333333336, "episode_reward_mean": 1214.1368333333362, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.783333333336}, "policy_reward_max": {"default_policy": 1216.3833333333369}, "policy_reward_mean": {"default_policy": 1214.1368333333362}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.3631, "num_moves_min": 0.12, "num_moves_max": 0.62, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.16279766666666667, "num_slav_min": 0.1613, "num_slav_max": 0.1637, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5378258251746645, "mean_cluster_cpu_util_min": 0.5353149246184961, "mean_cluster_cpu_util_max": 0.539666046148189, "mean_cluster_mem_util_mean": 0.341613111814346, "mean_cluster_mem_util_min": 0.34086708860759496, "mean_cluster_mem_util_max": 0.3421286919831224, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4419649999999997, "reward_sla_mean_min": -2.4555000000000002, "reward_sla_mean_max": -2.4194999999999998, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.1965, "reward_sla_sum_min": -245.55, "reward_sla_sum_max": -241.94999999999996, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4283.0, "global_timestep_min": 2600, "global_timestep_max": 5900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.3833333333364, 1214.2333333333365, 1213.6833333333363, 1214.8833333333366, 1214.3833333333369, 1214.3833333333362, 1213.3333333333364, 1213.6833333333363, 1214.083333333336, 1213.6833333333361, 1214.1833333333366, 1214.8833333333366, 1214.633333333336, 1213.1833333333361, 1215.3833333333362, 1214.7333333333365, 1214.183333333336, 1213.4833333333365, 1214.5333333333363, 1214.6333333333357, 1214.4333333333366, 1214.433333333336, 1214.0333333333365, 1214.3333333333362, 1214.4833333333352, 1213.7333333333363, 1214.6833333333357, 1213.5833333333362, 1213.8833333333355, 1214.283333333336, 1213.683333333336, 1213.8333333333362, 1214.2833333333363, 1214.4333333333357, 1214.2833333333358, 1214.1833333333361, 1213.9833333333363, 1213.533333333336, 1214.3833333333369, 1214.6333333333362, 1214.933333333336, 1214.733333333336, 1214.1833333333357, 1213.8333333333362, 1213.2333333333358, 1214.0833333333358, 1213.8333333333358, 1212.783333333336, 1215.5333333333358, 1214.2333333333365, 1213.7333333333358, 1213.433333333336, 1214.7333333333358, 1214.6833333333363, 1214.5833333333358, 1214.233333333336, 1213.7833333333367, 1213.8833333333364, 1214.733333333337, 1213.8333333333362, 1213.5333333333367, 1215.4333333333361, 1214.733333333336, 1214.1333333333366, 1213.233333333336, 1214.3833333333362, 1213.0333333333358, 1213.8833333333357, 1213.483333333336, 1214.9333333333361, 1214.1833333333366, 1213.7333333333368, 1213.6833333333363, 1214.5333333333363, 1214.4833333333365, 1214.7833333333365, 1213.7333333333356, 1212.983333333336, 1212.983333333336, 1213.7833333333358, 1214.2833333333365, 1214.033333333336, 1213.3833333333362, 1214.3333333333364, 1214.2833333333363, 1213.8833333333369, 1214.4333333333363, 1214.533333333336, 1214.033333333336, 1213.6333333333364, 1213.1833333333361, 1214.283333333336, 1214.183333333336, 1216.3833333333369, 1214.7833333333367, 1214.0833333333364, 1213.7333333333363, 1215.0333333333365, 1213.0833333333364, 1213.7333333333368], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.3833333333364, 1214.2333333333365, 1213.6833333333363, 1214.8833333333366, 1214.3833333333369, 1214.3833333333362, 1213.3333333333364, 1213.6833333333363, 1214.083333333336, 1213.6833333333361, 1214.1833333333366, 1214.8833333333366, 1214.633333333336, 1213.1833333333361, 1215.3833333333362, 1214.7333333333365, 1214.183333333336, 1213.4833333333365, 1214.5333333333363, 1214.6333333333357, 1214.4333333333366, 1214.433333333336, 1214.0333333333365, 1214.3333333333362, 1214.4833333333352, 1213.7333333333363, 1214.6833333333357, 1213.5833333333362, 1213.8833333333355, 1214.283333333336, 1213.683333333336, 1213.8333333333362, 1214.2833333333363, 1214.4333333333357, 1214.2833333333358, 1214.1833333333361, 1213.9833333333363, 1213.533333333336, 1214.3833333333369, 1214.6333333333362, 1214.933333333336, 1214.733333333336, 1214.1833333333357, 1213.8333333333362, 1213.2333333333358, 1214.0833333333358, 1213.8333333333358, 1212.783333333336, 1215.5333333333358, 1214.2333333333365, 1213.7333333333358, 1213.433333333336, 1214.7333333333358, 1214.6833333333363, 1214.5833333333358, 1214.233333333336, 1213.7833333333367, 1213.8833333333364, 1214.733333333337, 1213.8333333333362, 1213.5333333333367, 1215.4333333333361, 1214.733333333336, 1214.1333333333366, 1213.233333333336, 1214.3833333333362, 1213.0333333333358, 1213.8833333333357, 1213.483333333336, 1214.9333333333361, 1214.1833333333366, 1213.7333333333368, 1213.6833333333363, 1214.5333333333363, 1214.4833333333365, 1214.7833333333365, 1213.7333333333356, 1212.983333333336, 1212.983333333336, 1213.7833333333358, 1214.2833333333365, 1214.033333333336, 1213.3833333333362, 1214.3333333333364, 1214.2833333333363, 1213.8833333333369, 1214.4333333333363, 1214.533333333336, 1214.033333333336, 1213.6333333333364, 1213.1833333333361, 1214.283333333336, 1214.183333333336, 1216.3833333333369, 1214.7833333333367, 1214.0833333333364, 1213.7333333333363, 1215.0333333333365, 1213.0833333333364, 1213.7333333333368]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2427869752797032, "mean_inference_ms": 2.0699137194425634, "mean_action_processing_ms": 0.0911302931115113, "mean_env_wait_ms": 1.5414868416336487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006802558898925781, "StateBufferConnector_ms": 0.003400087356567383, "ViewRequirementAgentConnector_ms": 0.08694243431091309}, "num_episodes": 24, "episode_return_max": 1216.3833333333369, "episode_return_min": 1212.783333333336, "episode_return_mean": 1214.1368333333362, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392100, "num_agent_steps_trained": 391800, "num_env_steps_sampled": 392100, "num_env_steps_trained": 391800, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 237.28813575303363, "num_env_steps_trained_throughput_per_sec": 237.28813575303363, "timesteps_total": 392100, "num_env_steps_sampled_lifetime": 392100, "num_agent_steps_sampled_lifetime": 392100, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 392100, "timers": {"training_iteration_time_ms": 10265.494, "restore_workers_time_ms": 0.015, "training_step_time_ms": 631.318, "sample_time_ms": 615.621, "synch_weights_time_ms": 14.108}, "counters": {"num_env_steps_sampled": 392100, "num_env_steps_trained": 391800, "num_agent_steps_sampled": 392100, "num_agent_steps_trained": 391800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2614, "num_samples_added_to_queue": 392100}, "done": false, "training_iteration": 156, "trial_id": "27800_00000", "date": "2024-10-12_15-54-48", "timestamp": 1728744888, "time_this_iter_s": 10.124712467193604, "time_total_s": 1613.91193151474, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d462c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1613.91193151474, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 16.3, "ram_util_percent": 63.62666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3947.2333984375, "policy_loss": 305.8704528808594, "entropy": 5.063220500946045, "entropy_coeff": 0.01, "var_gnorm": 18.074237823486328, "vf_loss": 365655.25, "vf_explained_var": 0.6440367698669434}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1315.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 394650, "num_env_steps_trained": 394500, "num_agent_steps_sampled": 394650, "num_agent_steps_trained": 394500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2631, "num_samples_added_to_queue": 394500, "learner_queue": {"size_count": 1315, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.738, "learner_load_time_ms": 0.393, "learner_load_wait_time_ms": 1170.582, "learner_dequeue_time_ms": 10046.151}}, "env_runners": {"episode_reward_max": 1216.3833333333369, "episode_reward_min": 1212.6833333333363, "episode_reward_mean": 1214.0691666666696, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.6833333333363}, "policy_reward_max": {"default_policy": 1216.3833333333369}, "policy_reward_mean": {"default_policy": 1214.0691666666696}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.38410000000000005, "num_moves_min": 0.12, "num_moves_max": 0.66, "mean_accuracy_mean": 43.633206666666666, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0004, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.1628316666666667, "num_slav_min": 0.1613, "num_slav_max": 0.1637666666666667, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5378898641754, "mean_cluster_cpu_util_min": 0.5353149246184961, "mean_cluster_cpu_util_max": 0.539666046148189, "mean_cluster_mem_util_mean": 0.3416233860759494, "mean_cluster_mem_util_min": 0.34086708860759496, "mean_cluster_mem_util_max": 0.3421286919831224, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333166666666692, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.442475, "reward_sla_mean_min": -2.4564999999999997, "reward_sla_mean_max": -2.4194999999999998, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3166666666694, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.24749999999997, "reward_sla_sum_min": -245.64999999999995, "reward_sla_sum_max": -241.94999999999996, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5083.0, "global_timestep_min": 3400, "global_timestep_max": 6700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.4833333333352, 1213.7333333333363, 1214.6833333333357, 1213.5833333333362, 1213.8833333333355, 1214.283333333336, 1213.683333333336, 1213.8333333333362, 1214.2833333333363, 1214.4333333333357, 1214.2833333333358, 1214.1833333333361, 1213.9833333333363, 1213.533333333336, 1214.3833333333369, 1214.6333333333362, 1214.933333333336, 1214.733333333336, 1214.1833333333357, 1213.8333333333362, 1213.2333333333358, 1214.0833333333358, 1213.8333333333358, 1212.783333333336, 1215.5333333333358, 1214.2333333333365, 1213.7333333333358, 1213.433333333336, 1214.7333333333358, 1214.6833333333363, 1214.5833333333358, 1214.233333333336, 1213.7833333333367, 1213.8833333333364, 1214.733333333337, 1213.8333333333362, 1213.5333333333367, 1215.4333333333361, 1214.733333333336, 1214.1333333333366, 1213.233333333336, 1214.3833333333362, 1213.0333333333358, 1213.8833333333357, 1213.483333333336, 1214.9333333333361, 1214.1833333333366, 1213.7333333333368, 1213.6833333333363, 1214.5333333333363, 1214.4833333333365, 1214.7833333333365, 1213.7333333333356, 1212.983333333336, 1212.983333333336, 1213.7833333333358, 1214.2833333333365, 1214.033333333336, 1213.3833333333362, 1214.3333333333364, 1214.2833333333363, 1213.8833333333369, 1214.4333333333363, 1214.533333333336, 1214.033333333336, 1213.6333333333364, 1213.1833333333361, 1214.283333333336, 1214.183333333336, 1216.3833333333369, 1214.7833333333367, 1214.0833333333364, 1213.7333333333363, 1215.0333333333365, 1213.0833333333364, 1213.7333333333368, 1212.9833333333365, 1213.4333333333361, 1213.8333333333367, 1214.4833333333368, 1213.283333333337, 1214.9750000000033, 1214.3833333333366, 1213.4833333333368, 1214.8333333333358, 1213.7333333333363, 1213.6333333333364, 1214.2333333333356, 1214.683333333336, 1214.1333333333357, 1214.533333333336, 1214.7833333333363, 1214.3833333333355, 1214.3833333333366, 1213.3833333333362, 1213.5250000000026, 1214.4833333333365, 1212.6833333333363, 1213.533333333336, 1213.2333333333354], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.4833333333352, 1213.7333333333363, 1214.6833333333357, 1213.5833333333362, 1213.8833333333355, 1214.283333333336, 1213.683333333336, 1213.8333333333362, 1214.2833333333363, 1214.4333333333357, 1214.2833333333358, 1214.1833333333361, 1213.9833333333363, 1213.533333333336, 1214.3833333333369, 1214.6333333333362, 1214.933333333336, 1214.733333333336, 1214.1833333333357, 1213.8333333333362, 1213.2333333333358, 1214.0833333333358, 1213.8333333333358, 1212.783333333336, 1215.5333333333358, 1214.2333333333365, 1213.7333333333358, 1213.433333333336, 1214.7333333333358, 1214.6833333333363, 1214.5833333333358, 1214.233333333336, 1213.7833333333367, 1213.8833333333364, 1214.733333333337, 1213.8333333333362, 1213.5333333333367, 1215.4333333333361, 1214.733333333336, 1214.1333333333366, 1213.233333333336, 1214.3833333333362, 1213.0333333333358, 1213.8833333333357, 1213.483333333336, 1214.9333333333361, 1214.1833333333366, 1213.7333333333368, 1213.6833333333363, 1214.5333333333363, 1214.4833333333365, 1214.7833333333365, 1213.7333333333356, 1212.983333333336, 1212.983333333336, 1213.7833333333358, 1214.2833333333365, 1214.033333333336, 1213.3833333333362, 1214.3333333333364, 1214.2833333333363, 1213.8833333333369, 1214.4333333333363, 1214.533333333336, 1214.033333333336, 1213.6333333333364, 1213.1833333333361, 1214.283333333336, 1214.183333333336, 1216.3833333333369, 1214.7833333333367, 1214.0833333333364, 1213.7333333333363, 1215.0333333333365, 1213.0833333333364, 1213.7333333333368, 1212.9833333333365, 1213.4333333333361, 1213.8333333333367, 1214.4833333333368, 1213.283333333337, 1214.9750000000033, 1214.3833333333366, 1213.4833333333368, 1214.8333333333358, 1213.7333333333363, 1213.6333333333364, 1214.2333333333356, 1214.683333333336, 1214.1333333333357, 1214.533333333336, 1214.7833333333363, 1214.3833333333355, 1214.3833333333366, 1213.3833333333362, 1213.5250000000026, 1214.4833333333365, 1212.6833333333363, 1213.533333333336, 1213.2333333333354]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2428141019189328, "mean_inference_ms": 2.0702050086752193, "mean_action_processing_ms": 0.09113516056739165, "mean_env_wait_ms": 1.5415954016872009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068705081939697266, "StateBufferConnector_ms": 0.0033769607543945312, "ViewRequirementAgentConnector_ms": 0.08615565299987793}, "num_episodes": 24, "episode_return_max": 1216.3833333333369, "episode_return_min": 1212.6833333333363, "episode_return_mean": 1214.0691666666696, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 394650, "num_agent_steps_trained": 394500, "num_env_steps_sampled": 394650, "num_env_steps_trained": 394500, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 244.13001145317187, "num_env_steps_trained_throughput_per_sec": 258.490600362182, "timesteps_total": 394650, "num_env_steps_sampled_lifetime": 394650, "num_agent_steps_sampled_lifetime": 394650, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 394650, "timers": {"training_iteration_time_ms": 10296.999, "restore_workers_time_ms": 0.014, "training_step_time_ms": 615.257, "sample_time_ms": 599.745, "synch_weights_time_ms": 14.112}, "counters": {"num_env_steps_sampled": 394650, "num_env_steps_trained": 394500, "num_agent_steps_sampled": 394650, "num_agent_steps_trained": 394500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2631, "num_samples_added_to_queue": 394500}, "done": false, "training_iteration": 157, "trial_id": "27800_00000", "date": "2024-10-12_15-54-59", "timestamp": 1728744899, "time_this_iter_s": 10.457370519638062, "time_total_s": 1624.369302034378, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f2c80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1624.369302034378, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 15.893333333333334, "ram_util_percent": 63.31333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3018.928955078125, "policy_loss": -467.20233154296875, "entropy": 5.062376976013184, "entropy_coeff": 0.01, "var_gnorm": 18.076263427734375, "vf_loss": 350131.84375, "vf_explained_var": 0.6491885781288147}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1323.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 397200, "num_env_steps_trained": 396900, "num_agent_steps_sampled": 397200, "num_agent_steps_trained": 396900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2648, "num_samples_added_to_queue": 397200, "learner_queue": {"size_count": 1323, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.548, "learner_load_time_ms": 0.391, "learner_load_wait_time_ms": 1159.57, "learner_dequeue_time_ms": 10054.687}}, "env_runners": {"episode_reward_max": 1216.3833333333369, "episode_reward_min": 1212.6833333333363, "episode_reward_mean": 1214.055500000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.6833333333363}, "policy_reward_max": {"default_policy": 1216.3833333333369}, "policy_reward_mean": {"default_policy": 1214.055500000003}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.4649999999999999, "num_moves_min": 0.12, "num_moves_max": 0.66, "mean_accuracy_mean": 43.63307999999999, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0008, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.1628296666666667, "num_slav_min": 0.1613, "num_slav_max": 0.1637666666666667, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5379820696589446, "mean_cluster_cpu_util_min": 0.5353149246184961, "mean_cluster_cpu_util_max": 0.539467675583747, "mean_cluster_mem_util_mean": 0.3416452109704642, "mean_cluster_mem_util_min": 0.34086708860759496, "mean_cluster_mem_util_max": 0.3421286919831224, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333000000000025, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4424449999999998, "reward_sla_mean_min": -2.4564999999999997, "reward_sla_mean_max": -2.4194999999999998, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3000000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.24450000000004, "reward_sla_sum_min": -245.64999999999995, "reward_sla_sum_max": -241.94999999999996, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5982.0, "global_timestep_min": 4300, "global_timestep_max": 7600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.433333333336, 1214.7333333333358, 1214.6833333333363, 1214.5833333333358, 1214.233333333336, 1213.7833333333367, 1213.8833333333364, 1214.733333333337, 1213.8333333333362, 1213.5333333333367, 1215.4333333333361, 1214.733333333336, 1214.1333333333366, 1213.233333333336, 1214.3833333333362, 1213.0333333333358, 1213.8833333333357, 1213.483333333336, 1214.9333333333361, 1214.1833333333366, 1213.7333333333368, 1213.6833333333363, 1214.5333333333363, 1214.4833333333365, 1214.7833333333365, 1213.7333333333356, 1212.983333333336, 1212.983333333336, 1213.7833333333358, 1214.2833333333365, 1214.033333333336, 1213.3833333333362, 1214.3333333333364, 1214.2833333333363, 1213.8833333333369, 1214.4333333333363, 1214.533333333336, 1214.033333333336, 1213.6333333333364, 1213.1833333333361, 1214.283333333336, 1214.183333333336, 1216.3833333333369, 1214.7833333333367, 1214.0833333333364, 1213.7333333333363, 1215.0333333333365, 1213.0833333333364, 1213.7333333333368, 1212.9833333333365, 1213.4333333333361, 1213.8333333333367, 1214.4833333333368, 1213.283333333337, 1214.9750000000033, 1214.3833333333366, 1213.4833333333368, 1214.8333333333358, 1213.7333333333363, 1213.6333333333364, 1214.2333333333356, 1214.683333333336, 1214.1333333333357, 1214.533333333336, 1214.7833333333363, 1214.3833333333355, 1214.3833333333366, 1213.3833333333362, 1213.5250000000026, 1214.4833333333365, 1212.6833333333363, 1213.533333333336, 1213.2333333333354, 1215.1000000000033, 1214.3333333333364, 1213.5833333333358, 1213.1833333333363, 1213.6000000000024, 1212.7333333333365, 1213.1833333333366, 1213.933333333336, 1214.6333333333364, 1213.933333333336, 1215.033333333336, 1214.1333333333357, 1213.983333333336, 1214.3333333333362, 1213.433333333336, 1214.3833333333362, 1214.1833333333363, 1213.733333333335, 1215.1833333333363, 1214.033333333336, 1213.683333333336, 1215.483333333336, 1214.4333333333363, 1213.433333333336, 1213.5833333333362, 1213.9333333333361, 1214.433333333337], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.433333333336, 1214.7333333333358, 1214.6833333333363, 1214.5833333333358, 1214.233333333336, 1213.7833333333367, 1213.8833333333364, 1214.733333333337, 1213.8333333333362, 1213.5333333333367, 1215.4333333333361, 1214.733333333336, 1214.1333333333366, 1213.233333333336, 1214.3833333333362, 1213.0333333333358, 1213.8833333333357, 1213.483333333336, 1214.9333333333361, 1214.1833333333366, 1213.7333333333368, 1213.6833333333363, 1214.5333333333363, 1214.4833333333365, 1214.7833333333365, 1213.7333333333356, 1212.983333333336, 1212.983333333336, 1213.7833333333358, 1214.2833333333365, 1214.033333333336, 1213.3833333333362, 1214.3333333333364, 1214.2833333333363, 1213.8833333333369, 1214.4333333333363, 1214.533333333336, 1214.033333333336, 1213.6333333333364, 1213.1833333333361, 1214.283333333336, 1214.183333333336, 1216.3833333333369, 1214.7833333333367, 1214.0833333333364, 1213.7333333333363, 1215.0333333333365, 1213.0833333333364, 1213.7333333333368, 1212.9833333333365, 1213.4333333333361, 1213.8333333333367, 1214.4833333333368, 1213.283333333337, 1214.9750000000033, 1214.3833333333366, 1213.4833333333368, 1214.8333333333358, 1213.7333333333363, 1213.6333333333364, 1214.2333333333356, 1214.683333333336, 1214.1333333333357, 1214.533333333336, 1214.7833333333363, 1214.3833333333355, 1214.3833333333366, 1213.3833333333362, 1213.5250000000026, 1214.4833333333365, 1212.6833333333363, 1213.533333333336, 1213.2333333333354, 1215.1000000000033, 1214.3333333333364, 1213.5833333333358, 1213.1833333333363, 1213.6000000000024, 1212.7333333333365, 1213.1833333333366, 1213.933333333336, 1214.6333333333364, 1213.933333333336, 1215.033333333336, 1214.1333333333357, 1213.983333333336, 1214.3333333333362, 1213.433333333336, 1214.3833333333362, 1214.1833333333363, 1213.733333333335, 1215.1833333333363, 1214.033333333336, 1213.683333333336, 1215.483333333336, 1214.4333333333363, 1213.433333333336, 1213.5833333333362, 1213.9333333333361, 1214.433333333337]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2427592255011551, "mean_inference_ms": 2.068601465343372, "mean_action_processing_ms": 0.09111004921742648, "mean_env_wait_ms": 1.541199317558204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006719350814819336, "StateBufferConnector_ms": 0.0032939910888671875, "ViewRequirementAgentConnector_ms": 0.08441686630249023}, "num_episodes": 27, "episode_return_max": 1216.3833333333369, "episode_return_min": 1212.6833333333363, "episode_return_mean": 1214.055500000003, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 397200, "num_agent_steps_trained": 396900, "num_env_steps_sampled": 397200, "num_env_steps_trained": 396900, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 246.76326390514967, "num_env_steps_trained_throughput_per_sec": 232.24777779308204, "timesteps_total": 397200, "num_env_steps_sampled_lifetime": 397200, "num_agent_steps_sampled_lifetime": 397200, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 397200, "timers": {"training_iteration_time_ms": 10306.649, "restore_workers_time_ms": 0.014, "training_step_time_ms": 605.63, "sample_time_ms": 589.595, "synch_weights_time_ms": 14.244}, "counters": {"num_env_steps_sampled": 397200, "num_env_steps_trained": 396900, "num_agent_steps_sampled": 397200, "num_agent_steps_trained": 396900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2648, "num_samples_added_to_queue": 397200}, "done": false, "training_iteration": 158, "trial_id": "27800_00000", "date": "2024-10-12_15-55-09", "timestamp": 1728744909, "time_this_iter_s": 10.343560695648193, "time_total_s": 1634.7128627300262, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f23b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1634.7128627300262, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 15.740000000000002, "ram_util_percent": 62.68666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2158.273681640625, "policy_loss": -1733.395263671875, "entropy": 5.024900913238525, "entropy_coeff": 0.01, "var_gnorm": 18.075971603393555, "vf_loss": 390674.375, "vf_explained_var": 0.6311918497085571}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1332.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 399750, "num_env_steps_trained": 399600, "num_agent_steps_sampled": 399750, "num_agent_steps_trained": 399600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2665, "num_samples_added_to_queue": 399600, "learner_queue": {"size_count": 1332, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.849, "learner_load_time_ms": 0.377, "learner_load_wait_time_ms": 1164.176, "learner_dequeue_time_ms": 10051.998}}, "env_runners": {"episode_reward_max": 1216.3833333333369, "episode_reward_min": 1212.6833333333363, "episode_reward_mean": 1214.021083333336, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.6833333333363}, "policy_reward_max": {"default_policy": 1216.3833333333369}, "policy_reward_mean": {"default_policy": 1214.021083333336}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.5309, "num_moves_min": 0.4, "num_moves_max": 0.79, "mean_accuracy_mean": 43.63295333333333, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0018, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.1628415, "num_slav_min": 0.1613, "num_slav_max": 0.1637666666666667, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5379609472099651, "mean_cluster_cpu_util_min": 0.5363279095421953, "mean_cluster_cpu_util_max": 0.539467675583747, "mean_cluster_mem_util_mean": 0.3416382278481013, "mean_cluster_mem_util_min": 0.3412468354430379, "mean_cluster_mem_util_max": 0.34203481012658216, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.33283333333336, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4426224999999997, "reward_sla_mean_min": -2.4564999999999997, "reward_sla_mean_max": -2.4194999999999998, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.2833333333361, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.26225000000002, "reward_sla_sum_min": -245.64999999999995, "reward_sla_sum_max": -241.94999999999996, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5379.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.7833333333365, 1213.7333333333356, 1212.983333333336, 1212.983333333336, 1213.7833333333358, 1214.2833333333365, 1214.033333333336, 1213.3833333333362, 1214.3333333333364, 1214.2833333333363, 1213.8833333333369, 1214.4333333333363, 1214.533333333336, 1214.033333333336, 1213.6333333333364, 1213.1833333333361, 1214.283333333336, 1214.183333333336, 1216.3833333333369, 1214.7833333333367, 1214.0833333333364, 1213.7333333333363, 1215.0333333333365, 1213.0833333333364, 1213.7333333333368, 1212.9833333333365, 1213.4333333333361, 1213.8333333333367, 1214.4833333333368, 1213.283333333337, 1214.9750000000033, 1214.3833333333366, 1213.4833333333368, 1214.8333333333358, 1213.7333333333363, 1213.6333333333364, 1214.2333333333356, 1214.683333333336, 1214.1333333333357, 1214.533333333336, 1214.7833333333363, 1214.3833333333355, 1214.3833333333366, 1213.3833333333362, 1213.5250000000026, 1214.4833333333365, 1212.6833333333363, 1213.533333333336, 1213.2333333333354, 1215.1000000000033, 1214.3333333333364, 1213.5833333333358, 1213.1833333333363, 1213.6000000000024, 1212.7333333333365, 1213.1833333333366, 1213.933333333336, 1214.6333333333364, 1213.933333333336, 1215.033333333336, 1214.1333333333357, 1213.983333333336, 1214.3333333333362, 1213.433333333336, 1214.3833333333362, 1214.1833333333363, 1213.733333333335, 1215.1833333333363, 1214.033333333336, 1213.683333333336, 1215.483333333336, 1214.4333333333363, 1213.433333333336, 1213.5833333333362, 1213.9333333333361, 1214.433333333337, 1213.0833333333358, 1213.2333333333365, 1215.6833333333363, 1213.9333333333361, 1213.983333333336, 1214.8833333333364, 1214.1833333333363, 1214.383333333336, 1214.4833333333363, 1212.983333333336, 1213.3333333333362, 1213.8333333333367, 1214.4333333333361, 1215.5250000000026, 1213.8333333333362, 1214.7333333333368, 1213.383333333336, 1213.7833333333358, 1212.8833333333362, 1213.0333333333358, 1214.3500000000026, 1213.8333333333364, 1212.8833333333355, 1215.1833333333373], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.7833333333365, 1213.7333333333356, 1212.983333333336, 1212.983333333336, 1213.7833333333358, 1214.2833333333365, 1214.033333333336, 1213.3833333333362, 1214.3333333333364, 1214.2833333333363, 1213.8833333333369, 1214.4333333333363, 1214.533333333336, 1214.033333333336, 1213.6333333333364, 1213.1833333333361, 1214.283333333336, 1214.183333333336, 1216.3833333333369, 1214.7833333333367, 1214.0833333333364, 1213.7333333333363, 1215.0333333333365, 1213.0833333333364, 1213.7333333333368, 1212.9833333333365, 1213.4333333333361, 1213.8333333333367, 1214.4833333333368, 1213.283333333337, 1214.9750000000033, 1214.3833333333366, 1213.4833333333368, 1214.8333333333358, 1213.7333333333363, 1213.6333333333364, 1214.2333333333356, 1214.683333333336, 1214.1333333333357, 1214.533333333336, 1214.7833333333363, 1214.3833333333355, 1214.3833333333366, 1213.3833333333362, 1213.5250000000026, 1214.4833333333365, 1212.6833333333363, 1213.533333333336, 1213.2333333333354, 1215.1000000000033, 1214.3333333333364, 1213.5833333333358, 1213.1833333333363, 1213.6000000000024, 1212.7333333333365, 1213.1833333333366, 1213.933333333336, 1214.6333333333364, 1213.933333333336, 1215.033333333336, 1214.1333333333357, 1213.983333333336, 1214.3333333333362, 1213.433333333336, 1214.3833333333362, 1214.1833333333363, 1213.733333333335, 1215.1833333333363, 1214.033333333336, 1213.683333333336, 1215.483333333336, 1214.4333333333363, 1213.433333333336, 1213.5833333333362, 1213.9333333333361, 1214.433333333337, 1213.0833333333358, 1213.2333333333365, 1215.6833333333363, 1213.9333333333361, 1213.983333333336, 1214.8833333333364, 1214.1833333333363, 1214.383333333336, 1214.4833333333363, 1212.983333333336, 1213.3333333333362, 1213.8333333333367, 1214.4333333333361, 1215.5250000000026, 1213.8333333333362, 1214.7333333333368, 1213.383333333336, 1213.7833333333358, 1212.8833333333362, 1213.0333333333358, 1214.3500000000026, 1213.8333333333364, 1212.8833333333355, 1215.1833333333373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2428010032700606, "mean_inference_ms": 2.070322991550073, "mean_action_processing_ms": 0.09112404027359482, "mean_env_wait_ms": 1.5415989860404766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068721771240234375, "StateBufferConnector_ms": 0.0033931732177734375, "ViewRequirementAgentConnector_ms": 0.08603882789611816}, "num_episodes": 24, "episode_return_max": 1216.3833333333369, "episode_return_min": 1212.6833333333363, "episode_return_mean": 1214.021083333336, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 399750, "num_agent_steps_trained": 399600, "num_env_steps_sampled": 399750, "num_env_steps_trained": 399600, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 240.704280911538, "num_env_steps_trained_throughput_per_sec": 254.86335625927555, "timesteps_total": 399750, "num_env_steps_sampled_lifetime": 399750, "num_agent_steps_sampled_lifetime": 399750, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 399750, "timers": {"training_iteration_time_ms": 10332.238, "restore_workers_time_ms": 0.016, "training_step_time_ms": 632.793, "sample_time_ms": 615.863, "synch_weights_time_ms": 15.402}, "counters": {"num_env_steps_sampled": 399750, "num_env_steps_trained": 399600, "num_agent_steps_sampled": 399750, "num_agent_steps_trained": 399600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2665, "num_samples_added_to_queue": 399600}, "done": false, "training_iteration": 159, "trial_id": "27800_00000", "date": "2024-10-12_15-55-20", "timestamp": 1728744920, "time_this_iter_s": 10.6036376953125, "time_total_s": 1645.3165004253387, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f3c10>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1645.3165004253387, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 17.14, "ram_util_percent": 62.54666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2283.49462890625, "policy_loss": -1598.542724609375, "entropy": 4.795935153961182, "entropy_coeff": 0.01, "var_gnorm": 18.06985092163086, "vf_loss": 389642.53125, "vf_explained_var": 0.6367146372795105}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1340.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 402300, "num_env_steps_trained": 402000, "num_agent_steps_sampled": 402300, "num_agent_steps_trained": 402000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2682, "num_samples_added_to_queue": 402300, "learner_queue": {"size_count": 1340, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.729, "learner_load_time_ms": 0.341, "learner_load_wait_time_ms": 1170.376, "learner_dequeue_time_ms": 10090.14}}, "env_runners": {"episode_reward_max": 1215.6833333333363, "episode_reward_min": 1212.3833333333364, "episode_reward_mean": 1214.0580833333363, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.3833333333364}, "policy_reward_max": {"default_policy": 1215.6833333333363}, "policy_reward_mean": {"default_policy": 1214.0580833333363}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.5116, "num_moves_min": 0.22, "num_moves_max": 0.79, "mean_accuracy_mean": 43.632953333333326, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0018, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16281683333333333, "num_slav_min": 0.16131666666666666, "num_slav_max": 0.16396666666666668, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5379597514478764, "mean_cluster_cpu_util_min": 0.5363279095421953, "mean_cluster_cpu_util_max": 0.5397463458356315, "mean_cluster_mem_util_mean": 0.3416364029535865, "mean_cluster_mem_util_min": 0.3412468354430379, "mean_cluster_mem_util_max": 0.34211603375527416, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.33283333333336, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4422525, "reward_sla_mean_min": -2.4595000000000002, "reward_sla_mean_max": -2.41975, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.2833333333361, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.22525, "reward_sla_sum_min": -245.95000000000002, "reward_sla_sum_max": -241.975, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4172.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.8333333333367, 1214.4833333333368, 1213.283333333337, 1214.9750000000033, 1214.3833333333366, 1213.4833333333368, 1214.8333333333358, 1213.7333333333363, 1213.6333333333364, 1214.2333333333356, 1214.683333333336, 1214.1333333333357, 1214.533333333336, 1214.7833333333363, 1214.3833333333355, 1214.3833333333366, 1213.3833333333362, 1213.5250000000026, 1214.4833333333365, 1212.6833333333363, 1213.533333333336, 1213.2333333333354, 1215.1000000000033, 1214.3333333333364, 1213.5833333333358, 1213.1833333333363, 1213.6000000000024, 1212.7333333333365, 1213.1833333333366, 1213.933333333336, 1214.6333333333364, 1213.933333333336, 1215.033333333336, 1214.1333333333357, 1213.983333333336, 1214.3333333333362, 1213.433333333336, 1214.3833333333362, 1214.1833333333363, 1213.733333333335, 1215.1833333333363, 1214.033333333336, 1213.683333333336, 1215.483333333336, 1214.4333333333363, 1213.433333333336, 1213.5833333333362, 1213.9333333333361, 1214.433333333337, 1213.0833333333358, 1213.2333333333365, 1215.6833333333363, 1213.9333333333361, 1213.983333333336, 1214.8833333333364, 1214.1833333333363, 1214.383333333336, 1214.4833333333363, 1212.983333333336, 1213.3333333333362, 1213.8333333333367, 1214.4333333333361, 1215.5250000000026, 1213.8333333333362, 1214.7333333333368, 1213.383333333336, 1213.7833333333358, 1212.8833333333362, 1213.0333333333358, 1214.3500000000026, 1213.8333333333364, 1212.8833333333355, 1215.1833333333373, 1213.9833333333368, 1213.8333333333358, 1213.733333333337, 1213.733333333336, 1214.8833333333366, 1213.483333333336, 1214.4333333333361, 1214.133333333336, 1213.8333333333358, 1212.3833333333364, 1213.783333333336, 1214.2333333333365, 1213.8833333333364, 1213.5833333333364, 1214.2333333333356, 1214.4833333333363, 1214.2833333333353, 1214.1833333333363, 1214.1833333333361, 1214.6333333333362, 1214.2833333333363, 1214.983333333337, 1215.1333333333369, 1214.333333333336, 1214.3833333333362, 1214.933333333336, 1213.7333333333363], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.8333333333367, 1214.4833333333368, 1213.283333333337, 1214.9750000000033, 1214.3833333333366, 1213.4833333333368, 1214.8333333333358, 1213.7333333333363, 1213.6333333333364, 1214.2333333333356, 1214.683333333336, 1214.1333333333357, 1214.533333333336, 1214.7833333333363, 1214.3833333333355, 1214.3833333333366, 1213.3833333333362, 1213.5250000000026, 1214.4833333333365, 1212.6833333333363, 1213.533333333336, 1213.2333333333354, 1215.1000000000033, 1214.3333333333364, 1213.5833333333358, 1213.1833333333363, 1213.6000000000024, 1212.7333333333365, 1213.1833333333366, 1213.933333333336, 1214.6333333333364, 1213.933333333336, 1215.033333333336, 1214.1333333333357, 1213.983333333336, 1214.3333333333362, 1213.433333333336, 1214.3833333333362, 1214.1833333333363, 1213.733333333335, 1215.1833333333363, 1214.033333333336, 1213.683333333336, 1215.483333333336, 1214.4333333333363, 1213.433333333336, 1213.5833333333362, 1213.9333333333361, 1214.433333333337, 1213.0833333333358, 1213.2333333333365, 1215.6833333333363, 1213.9333333333361, 1213.983333333336, 1214.8833333333364, 1214.1833333333363, 1214.383333333336, 1214.4833333333363, 1212.983333333336, 1213.3333333333362, 1213.8333333333367, 1214.4333333333361, 1215.5250000000026, 1213.8333333333362, 1214.7333333333368, 1213.383333333336, 1213.7833333333358, 1212.8833333333362, 1213.0333333333358, 1214.3500000000026, 1213.8333333333364, 1212.8833333333355, 1215.1833333333373, 1213.9833333333368, 1213.8333333333358, 1213.733333333337, 1213.733333333336, 1214.8833333333366, 1213.483333333336, 1214.4333333333361, 1214.133333333336, 1213.8333333333358, 1212.3833333333364, 1213.783333333336, 1214.2333333333365, 1213.8833333333364, 1213.5833333333364, 1214.2333333333356, 1214.4833333333363, 1214.2833333333353, 1214.1833333333363, 1214.1833333333361, 1214.6333333333362, 1214.2833333333363, 1214.983333333337, 1215.1333333333369, 1214.333333333336, 1214.3833333333362, 1214.933333333336, 1213.7333333333363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24274112850465684, "mean_inference_ms": 2.0686128228970078, "mean_action_processing_ms": 0.09109545049632907, "mean_env_wait_ms": 1.5411338477840866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006349325180053711, "StateBufferConnector_ms": 0.0032958984375, "ViewRequirementAgentConnector_ms": 0.08398008346557617}, "num_episodes": 27, "episode_return_max": 1215.6833333333363, "episode_return_min": 1212.3833333333364, "episode_return_mean": 1214.0580833333363, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 402300, "num_agent_steps_trained": 402000, "num_env_steps_sampled": 402300, "num_env_steps_trained": 402000, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 247.74098863372225, "num_env_steps_trained_throughput_per_sec": 233.16798930232682, "timesteps_total": 402300, "num_env_steps_sampled_lifetime": 402300, "num_agent_steps_sampled_lifetime": 402300, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 402300, "timers": {"training_iteration_time_ms": 10347.103, "restore_workers_time_ms": 0.012, "training_step_time_ms": 611.298, "sample_time_ms": 595.868, "synch_weights_time_ms": 13.902}, "counters": {"num_env_steps_sampled": 402300, "num_env_steps_trained": 402000, "num_agent_steps_sampled": 402300, "num_agent_steps_trained": 402000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2682, "num_samples_added_to_queue": 402300}, "done": false, "training_iteration": 160, "trial_id": "27800_00000", "date": "2024-10-12_15-55-30", "timestamp": 1728744930, "time_this_iter_s": 10.30380916595459, "time_total_s": 1655.6203095912933, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d44550>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1655.6203095912933, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 15.82, "ram_util_percent": 61.646666666666675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3637.1318359375, "policy_loss": -268.6671142578125, "entropy": 4.677342891693115, "entropy_coeff": 0.01, "var_gnorm": 18.0577335357666, "vf_loss": 391983.125, "vf_explained_var": 0.636111855506897}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1349.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 404850, "num_env_steps_trained": 404700, "num_agent_steps_sampled": 404850, "num_agent_steps_trained": 404700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2699, "num_samples_added_to_queue": 404700, "learner_queue": {"size_count": 1349, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.901, "learner_load_time_ms": 0.336, "learner_load_wait_time_ms": 1164.861, "learner_dequeue_time_ms": 10102.358}}, "env_runners": {"episode_reward_max": 1215.6833333333363, "episode_reward_min": 1212.3833333333364, "episode_reward_mean": 1214.0440833333364, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.3833333333364}, "policy_reward_max": {"default_policy": 1215.6833333333363}, "policy_reward_mean": {"default_policy": 1214.0440833333364}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.42839999999999995, "num_moves_min": 0.1, "num_moves_max": 0.79, "mean_accuracy_mean": 43.63314333333333, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0012, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16284283333333335, "num_slav_min": 0.16131666666666666, "num_slav_max": 0.16396666666666668, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5380871892811178, "mean_cluster_cpu_util_min": 0.5361772384629526, "mean_cluster_cpu_util_max": 0.5404098294723295, "mean_cluster_mem_util_mean": 0.3416536867088608, "mean_cluster_mem_util_min": 0.3412911392405063, "mean_cluster_mem_util_max": 0.34211603375527416, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.33308333333336, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4426424999999994, "reward_sla_mean_min": -2.4595000000000002, "reward_sla_mean_max": -2.41975, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3083333333362, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.26425, "reward_sla_sum_min": -245.95000000000002, "reward_sla_sum_max": -241.975, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3100.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.5833333333358, 1213.1833333333363, 1213.6000000000024, 1212.7333333333365, 1213.1833333333366, 1213.933333333336, 1214.6333333333364, 1213.933333333336, 1215.033333333336, 1214.1333333333357, 1213.983333333336, 1214.3333333333362, 1213.433333333336, 1214.3833333333362, 1214.1833333333363, 1213.733333333335, 1215.1833333333363, 1214.033333333336, 1213.683333333336, 1215.483333333336, 1214.4333333333363, 1213.433333333336, 1213.5833333333362, 1213.9333333333361, 1214.433333333337, 1213.0833333333358, 1213.2333333333365, 1215.6833333333363, 1213.9333333333361, 1213.983333333336, 1214.8833333333364, 1214.1833333333363, 1214.383333333336, 1214.4833333333363, 1212.983333333336, 1213.3333333333362, 1213.8333333333367, 1214.4333333333361, 1215.5250000000026, 1213.8333333333362, 1214.7333333333368, 1213.383333333336, 1213.7833333333358, 1212.8833333333362, 1213.0333333333358, 1214.3500000000026, 1213.8333333333364, 1212.8833333333355, 1215.1833333333373, 1213.9833333333368, 1213.8333333333358, 1213.733333333337, 1213.733333333336, 1214.8833333333366, 1213.483333333336, 1214.4333333333361, 1214.133333333336, 1213.8333333333358, 1212.3833333333364, 1213.783333333336, 1214.2333333333365, 1213.8833333333364, 1213.5833333333364, 1214.2333333333356, 1214.4833333333363, 1214.2833333333353, 1214.1833333333363, 1214.1833333333361, 1214.6333333333362, 1214.2833333333363, 1214.983333333337, 1215.1333333333369, 1214.333333333336, 1214.3833333333362, 1214.933333333336, 1213.7333333333363, 1214.2833333333365, 1214.0333333333367, 1215.1333333333362, 1214.4833333333365, 1214.9833333333368, 1213.9333333333357, 1214.2833333333367, 1214.0833333333362, 1213.0333333333367, 1213.483333333336, 1213.9833333333368, 1213.1833333333354, 1215.133333333337, 1213.7833333333365, 1214.1833333333361, 1214.2833333333363, 1213.8833333333366, 1212.8833333333362, 1213.933333333336, 1215.1333333333364, 1214.4833333333354, 1212.883333333336, 1213.6833333333361, 1213.483333333337], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.5833333333358, 1213.1833333333363, 1213.6000000000024, 1212.7333333333365, 1213.1833333333366, 1213.933333333336, 1214.6333333333364, 1213.933333333336, 1215.033333333336, 1214.1333333333357, 1213.983333333336, 1214.3333333333362, 1213.433333333336, 1214.3833333333362, 1214.1833333333363, 1213.733333333335, 1215.1833333333363, 1214.033333333336, 1213.683333333336, 1215.483333333336, 1214.4333333333363, 1213.433333333336, 1213.5833333333362, 1213.9333333333361, 1214.433333333337, 1213.0833333333358, 1213.2333333333365, 1215.6833333333363, 1213.9333333333361, 1213.983333333336, 1214.8833333333364, 1214.1833333333363, 1214.383333333336, 1214.4833333333363, 1212.983333333336, 1213.3333333333362, 1213.8333333333367, 1214.4333333333361, 1215.5250000000026, 1213.8333333333362, 1214.7333333333368, 1213.383333333336, 1213.7833333333358, 1212.8833333333362, 1213.0333333333358, 1214.3500000000026, 1213.8333333333364, 1212.8833333333355, 1215.1833333333373, 1213.9833333333368, 1213.8333333333358, 1213.733333333337, 1213.733333333336, 1214.8833333333366, 1213.483333333336, 1214.4333333333361, 1214.133333333336, 1213.8333333333358, 1212.3833333333364, 1213.783333333336, 1214.2333333333365, 1213.8833333333364, 1213.5833333333364, 1214.2333333333356, 1214.4833333333363, 1214.2833333333353, 1214.1833333333363, 1214.1833333333361, 1214.6333333333362, 1214.2833333333363, 1214.983333333337, 1215.1333333333369, 1214.333333333336, 1214.3833333333362, 1214.933333333336, 1213.7333333333363, 1214.2833333333365, 1214.0333333333367, 1215.1333333333362, 1214.4833333333365, 1214.9833333333368, 1213.9333333333357, 1214.2833333333367, 1214.0833333333362, 1213.0333333333367, 1213.483333333336, 1213.9833333333368, 1213.1833333333354, 1215.133333333337, 1213.7833333333365, 1214.1833333333361, 1214.2833333333363, 1213.8833333333366, 1212.8833333333362, 1213.933333333336, 1215.1333333333364, 1214.4833333333354, 1212.883333333336, 1213.6833333333361, 1213.483333333337]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24272440600351794, "mean_inference_ms": 2.068502478086726, "mean_action_processing_ms": 0.0910858441793972, "mean_env_wait_ms": 1.5410413465565211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006193876266479492, "StateBufferConnector_ms": 0.0033075809478759766, "ViewRequirementAgentConnector_ms": 0.08431434631347656}, "num_episodes": 24, "episode_return_max": 1215.6833333333363, "episode_return_min": 1212.3833333333364, "episode_return_mean": 1214.0440833333364, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 404850, "num_agent_steps_trained": 404700, "num_env_steps_sampled": 404850, "num_env_steps_trained": 404700, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 247.28329807207825, "num_env_steps_trained_throughput_per_sec": 261.8293744292593, "timesteps_total": 404850, "num_env_steps_sampled_lifetime": 404850, "num_agent_steps_sampled_lifetime": 404850, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 404850, "timers": {"training_iteration_time_ms": 10316.663, "restore_workers_time_ms": 0.015, "training_step_time_ms": 594.753, "sample_time_ms": 579.767, "synch_weights_time_ms": 13.417}, "counters": {"num_env_steps_sampled": 404850, "num_env_steps_trained": 404700, "num_agent_steps_sampled": 404850, "num_agent_steps_trained": 404700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2699, "num_samples_added_to_queue": 404700}, "done": false, "training_iteration": 161, "trial_id": "27800_00000", "date": "2024-10-12_15-55-40", "timestamp": 1728744940, "time_this_iter_s": 10.323509931564331, "time_total_s": 1665.9438195228577, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f6a110>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1665.9438195228577, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 15.571428571428571, "ram_util_percent": 61.65714285714288}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 5661.74365234375, "policy_loss": 1809.8155517578125, "entropy": 4.830904006958008, "entropy_coeff": 0.01, "var_gnorm": 18.055635452270508, "vf_loss": 386642.0625, "vf_explained_var": 0.636096715927124}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1357.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 407250, "num_env_steps_trained": 407100, "num_agent_steps_sampled": 407250, "num_agent_steps_trained": 407100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2715, "num_samples_added_to_queue": 407100, "learner_queue": {"size_count": 1357, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.017, "learner_load_time_ms": 0.351, "learner_load_wait_time_ms": 1190.775, "learner_dequeue_time_ms": 9979.048}}, "env_runners": {"episode_reward_max": 1215.6833333333363, "episode_reward_min": 1212.3833333333364, "episode_reward_mean": 1214.0748333333365, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.3833333333364}, "policy_reward_max": {"default_policy": 1215.6833333333363}, "policy_reward_mean": {"default_policy": 1214.0748333333365}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.3541, "num_moves_min": 0.1, "num_moves_max": 0.79, "mean_accuracy_mean": 43.63314333333333, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0012, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16282233333333337, "num_slav_min": 0.16131666666666666, "num_slav_max": 0.16396666666666668, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5380694454403382, "mean_cluster_cpu_util_min": 0.5361772384629526, "mean_cluster_cpu_util_max": 0.5404098294723295, "mean_cluster_mem_util_mean": 0.3416357383966245, "mean_cluster_mem_util_min": 0.3412911392405063, "mean_cluster_mem_util_max": 0.34211603375527416, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.33308333333336, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.442335, "reward_sla_mean_min": -2.4595000000000002, "reward_sla_mean_max": -2.41975, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3083333333362, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.23350000000002, "reward_sla_sum_min": -245.95000000000002, "reward_sla_sum_max": -241.975, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2029.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.433333333337, 1213.0833333333358, 1213.2333333333365, 1215.6833333333363, 1213.9333333333361, 1213.983333333336, 1214.8833333333364, 1214.1833333333363, 1214.383333333336, 1214.4833333333363, 1212.983333333336, 1213.3333333333362, 1213.8333333333367, 1214.4333333333361, 1215.5250000000026, 1213.8333333333362, 1214.7333333333368, 1213.383333333336, 1213.7833333333358, 1212.8833333333362, 1213.0333333333358, 1214.3500000000026, 1213.8333333333364, 1212.8833333333355, 1215.1833333333373, 1213.9833333333368, 1213.8333333333358, 1213.733333333337, 1213.733333333336, 1214.8833333333366, 1213.483333333336, 1214.4333333333361, 1214.133333333336, 1213.8333333333358, 1212.3833333333364, 1213.783333333336, 1214.2333333333365, 1213.8833333333364, 1213.5833333333364, 1214.2333333333356, 1214.4833333333363, 1214.2833333333353, 1214.1833333333363, 1214.1833333333361, 1214.6333333333362, 1214.2833333333363, 1214.983333333337, 1215.1333333333369, 1214.333333333336, 1214.3833333333362, 1214.933333333336, 1213.7333333333363, 1214.2833333333365, 1214.0333333333367, 1215.1333333333362, 1214.4833333333365, 1214.9833333333368, 1213.9333333333357, 1214.2833333333367, 1214.0833333333362, 1213.0333333333367, 1213.483333333336, 1213.9833333333368, 1213.1833333333354, 1215.133333333337, 1213.7833333333365, 1214.1833333333361, 1214.2833333333363, 1213.8833333333366, 1212.8833333333362, 1213.933333333336, 1215.1333333333364, 1214.4833333333354, 1212.883333333336, 1213.6833333333361, 1213.483333333337, 1214.133333333336, 1213.7833333333358, 1214.0833333333358, 1213.2333333333356, 1213.4833333333365, 1213.5833333333364, 1214.3333333333348, 1214.5333333333365, 1214.4333333333361, 1213.5333333333363, 1213.283333333337, 1213.775000000003, 1214.0333333333356, 1213.983333333336, 1213.683333333336, 1214.6333333333364, 1213.283333333336, 1214.5833333333355, 1214.7333333333363, 1214.5833333333367, 1215.3333333333364, 1213.8333333333353, 1214.8833333333366, 1215.0833333333362], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.433333333337, 1213.0833333333358, 1213.2333333333365, 1215.6833333333363, 1213.9333333333361, 1213.983333333336, 1214.8833333333364, 1214.1833333333363, 1214.383333333336, 1214.4833333333363, 1212.983333333336, 1213.3333333333362, 1213.8333333333367, 1214.4333333333361, 1215.5250000000026, 1213.8333333333362, 1214.7333333333368, 1213.383333333336, 1213.7833333333358, 1212.8833333333362, 1213.0333333333358, 1214.3500000000026, 1213.8333333333364, 1212.8833333333355, 1215.1833333333373, 1213.9833333333368, 1213.8333333333358, 1213.733333333337, 1213.733333333336, 1214.8833333333366, 1213.483333333336, 1214.4333333333361, 1214.133333333336, 1213.8333333333358, 1212.3833333333364, 1213.783333333336, 1214.2333333333365, 1213.8833333333364, 1213.5833333333364, 1214.2333333333356, 1214.4833333333363, 1214.2833333333353, 1214.1833333333363, 1214.1833333333361, 1214.6333333333362, 1214.2833333333363, 1214.983333333337, 1215.1333333333369, 1214.333333333336, 1214.3833333333362, 1214.933333333336, 1213.7333333333363, 1214.2833333333365, 1214.0333333333367, 1215.1333333333362, 1214.4833333333365, 1214.9833333333368, 1213.9333333333357, 1214.2833333333367, 1214.0833333333362, 1213.0333333333367, 1213.483333333336, 1213.9833333333368, 1213.1833333333354, 1215.133333333337, 1213.7833333333365, 1214.1833333333361, 1214.2833333333363, 1213.8833333333366, 1212.8833333333362, 1213.933333333336, 1215.1333333333364, 1214.4833333333354, 1212.883333333336, 1213.6833333333361, 1213.483333333337, 1214.133333333336, 1213.7833333333358, 1214.0833333333358, 1213.2333333333356, 1213.4833333333365, 1213.5833333333364, 1214.3333333333348, 1214.5333333333365, 1214.4333333333361, 1213.5333333333363, 1213.283333333337, 1213.775000000003, 1214.0333333333356, 1213.983333333336, 1213.683333333336, 1214.6333333333364, 1213.283333333336, 1214.5833333333355, 1214.7333333333363, 1214.5833333333367, 1215.3333333333364, 1213.8333333333353, 1214.8833333333366, 1215.0833333333362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24277427731692036, "mean_inference_ms": 2.0702681487823593, "mean_action_processing_ms": 0.09110315492666808, "mean_env_wait_ms": 1.5414499101282164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006250143051147461, "StateBufferConnector_ms": 0.0033502578735351562, "ViewRequirementAgentConnector_ms": 0.08570003509521484}, "num_episodes": 24, "episode_return_max": 1215.6833333333363, "episode_return_min": 1212.3833333333364, "episode_return_mean": 1214.0748333333365, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 407250, "num_agent_steps_trained": 407100, "num_env_steps_sampled": 407250, "num_env_steps_trained": 407100, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 230.84348147995777, "num_env_steps_trained_throughput_per_sec": 230.84348147995777, "timesteps_total": 407250, "num_env_steps_sampled_lifetime": 407250, "num_agent_steps_sampled_lifetime": 407250, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 407250, "timers": {"training_iteration_time_ms": 10344.726, "restore_workers_time_ms": 0.014, "training_step_time_ms": 670.709, "sample_time_ms": 653.556, "synch_weights_time_ms": 15.22}, "counters": {"num_env_steps_sampled": 407250, "num_env_steps_trained": 407100, "num_agent_steps_sampled": 407250, "num_agent_steps_trained": 407100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2715, "num_samples_added_to_queue": 407100}, "done": false, "training_iteration": 162, "trial_id": "27800_00000", "date": "2024-10-12_15-55-51", "timestamp": 1728744951, "time_this_iter_s": 10.422130107879639, "time_total_s": 1676.3659496307373, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f03a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1676.3659496307373, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 19.613333333333337, "ram_util_percent": 62.46666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4942.33984375, "policy_loss": 1526.8720703125, "entropy": 5.302635669708252, "entropy_coeff": 0.01, "var_gnorm": 18.05562400817871, "vf_loss": 343137.5625, "vf_explained_var": 0.6506410837173462}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1365.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 409800, "num_env_steps_trained": 409500, "num_agent_steps_sampled": 409800, "num_agent_steps_trained": 409500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2732, "num_samples_added_to_queue": 409800, "learner_queue": {"size_count": 1365, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.318, "learner_load_time_ms": 0.315, "learner_load_wait_time_ms": 1198.995, "learner_dequeue_time_ms": 10027.055}}, "env_runners": {"episode_reward_max": 1215.3333333333364, "episode_reward_min": 1212.3833333333364, "episode_reward_mean": 1214.081250000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.3833333333364}, "policy_reward_max": {"default_policy": 1215.3333333333364}, "policy_reward_mean": {"default_policy": 1214.081250000003}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.34619999999999995, "num_moves_min": 0.1, "num_moves_max": 0.8, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16282916666666672, "num_slav_min": 0.16200000000000003, "num_slav_max": 0.16396666666666668, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5383841558650487, "mean_cluster_cpu_util_min": 0.5361772384629526, "mean_cluster_cpu_util_max": 0.5420524108291965, "mean_cluster_mem_util_mean": 0.34164742616033755, "mean_cluster_mem_util_min": 0.341223628691983, "mean_cluster_mem_util_max": 0.34211603375527416, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4424375, "reward_sla_mean_min": -2.4595000000000002, "reward_sla_mean_max": -2.4299999999999993, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.24374999999992, "reward_sla_sum_min": -245.95000000000002, "reward_sla_sum_max": -242.99999999999994, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2382.0, "global_timestep_min": 700, "global_timestep_max": 4000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.733333333337, 1213.733333333336, 1214.8833333333366, 1213.483333333336, 1214.4333333333361, 1214.133333333336, 1213.8333333333358, 1212.3833333333364, 1213.783333333336, 1214.2333333333365, 1213.8833333333364, 1213.5833333333364, 1214.2333333333356, 1214.4833333333363, 1214.2833333333353, 1214.1833333333363, 1214.1833333333361, 1214.6333333333362, 1214.2833333333363, 1214.983333333337, 1215.1333333333369, 1214.333333333336, 1214.3833333333362, 1214.933333333336, 1213.7333333333363, 1214.2833333333365, 1214.0333333333367, 1215.1333333333362, 1214.4833333333365, 1214.9833333333368, 1213.9333333333357, 1214.2833333333367, 1214.0833333333362, 1213.0333333333367, 1213.483333333336, 1213.9833333333368, 1213.1833333333354, 1215.133333333337, 1213.7833333333365, 1214.1833333333361, 1214.2833333333363, 1213.8833333333366, 1212.8833333333362, 1213.933333333336, 1215.1333333333364, 1214.4833333333354, 1212.883333333336, 1213.6833333333361, 1213.483333333337, 1214.133333333336, 1213.7833333333358, 1214.0833333333358, 1213.2333333333356, 1213.4833333333365, 1213.5833333333364, 1214.3333333333348, 1214.5333333333365, 1214.4333333333361, 1213.5333333333363, 1213.283333333337, 1213.775000000003, 1214.0333333333356, 1213.983333333336, 1213.683333333336, 1214.6333333333364, 1213.283333333336, 1214.5833333333355, 1214.7333333333363, 1214.5833333333367, 1215.3333333333364, 1213.8333333333353, 1214.8833333333366, 1215.0833333333362, 1212.8333333333362, 1213.6833333333366, 1213.6333333333357, 1214.3333333333367, 1214.733333333336, 1213.733333333336, 1213.983333333336, 1214.2333333333365, 1213.2333333333363, 1213.383333333337, 1214.1833333333361, 1213.283333333336, 1214.1833333333354, 1214.983333333336, 1213.6333333333362, 1213.8833333333366, 1214.133333333336, 1214.8833333333362, 1213.9833333333368, 1214.1833333333357, 1214.4833333333365, 1215.2833333333367, 1214.7333333333363, 1212.6333333333364, 1213.9833333333358, 1214.733333333336, 1213.7833333333363], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.733333333337, 1213.733333333336, 1214.8833333333366, 1213.483333333336, 1214.4333333333361, 1214.133333333336, 1213.8333333333358, 1212.3833333333364, 1213.783333333336, 1214.2333333333365, 1213.8833333333364, 1213.5833333333364, 1214.2333333333356, 1214.4833333333363, 1214.2833333333353, 1214.1833333333363, 1214.1833333333361, 1214.6333333333362, 1214.2833333333363, 1214.983333333337, 1215.1333333333369, 1214.333333333336, 1214.3833333333362, 1214.933333333336, 1213.7333333333363, 1214.2833333333365, 1214.0333333333367, 1215.1333333333362, 1214.4833333333365, 1214.9833333333368, 1213.9333333333357, 1214.2833333333367, 1214.0833333333362, 1213.0333333333367, 1213.483333333336, 1213.9833333333368, 1213.1833333333354, 1215.133333333337, 1213.7833333333365, 1214.1833333333361, 1214.2833333333363, 1213.8833333333366, 1212.8833333333362, 1213.933333333336, 1215.1333333333364, 1214.4833333333354, 1212.883333333336, 1213.6833333333361, 1213.483333333337, 1214.133333333336, 1213.7833333333358, 1214.0833333333358, 1213.2333333333356, 1213.4833333333365, 1213.5833333333364, 1214.3333333333348, 1214.5333333333365, 1214.4333333333361, 1213.5333333333363, 1213.283333333337, 1213.775000000003, 1214.0333333333356, 1213.983333333336, 1213.683333333336, 1214.6333333333364, 1213.283333333336, 1214.5833333333355, 1214.7333333333363, 1214.5833333333367, 1215.3333333333364, 1213.8333333333353, 1214.8833333333366, 1215.0833333333362, 1212.8333333333362, 1213.6833333333366, 1213.6333333333357, 1214.3333333333367, 1214.733333333336, 1213.733333333336, 1213.983333333336, 1214.2333333333365, 1213.2333333333363, 1213.383333333337, 1214.1833333333361, 1213.283333333336, 1214.1833333333354, 1214.983333333336, 1213.6333333333362, 1213.8833333333366, 1214.133333333336, 1214.8833333333362, 1213.9833333333368, 1214.1833333333357, 1214.4833333333365, 1215.2833333333367, 1214.7333333333363, 1212.6333333333364, 1213.9833333333358, 1214.733333333336, 1213.7833333333363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24274082849997997, "mean_inference_ms": 2.0686961828964385, "mean_action_processing_ms": 0.09108206197247845, "mean_env_wait_ms": 1.5410791993921351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006192207336425781, "StateBufferConnector_ms": 0.003289461135864258, "ViewRequirementAgentConnector_ms": 0.08532142639160156}, "num_episodes": 27, "episode_return_max": 1215.3333333333364, "episode_return_min": 1212.3833333333364, "episode_return_mean": 1214.081250000003, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 409800, "num_agent_steps_trained": 409500, "num_env_steps_sampled": 409800, "num_env_steps_trained": 409500, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 245.33632693816548, "num_env_steps_trained_throughput_per_sec": 230.904778294744, "timesteps_total": 409800, "num_env_steps_sampled_lifetime": 409800, "num_agent_steps_sampled_lifetime": 409800, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 409800, "timers": {"training_iteration_time_ms": 10376.009, "restore_workers_time_ms": 0.012, "training_step_time_ms": 575.063, "sample_time_ms": 560.361, "synch_weights_time_ms": 13.143}, "counters": {"num_env_steps_sampled": 409800, "num_env_steps_trained": 409500, "num_agent_steps_sampled": 409800, "num_agent_steps_trained": 409500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2732, "num_samples_added_to_queue": 409800}, "done": false, "training_iteration": 163, "trial_id": "27800_00000", "date": "2024-10-12_15-56-01", "timestamp": 1728744961, "time_this_iter_s": 10.404454231262207, "time_total_s": 1686.7704038619995, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948950220>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1686.7704038619995, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 19.220000000000002, "ram_util_percent": 64.74666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3564.0205078125, "policy_loss": 272.8034362792969, "entropy": 5.327184200286865, "entropy_coeff": 0.01, "var_gnorm": 18.05376434326172, "vf_loss": 330719.875, "vf_explained_var": 0.6542801856994629}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1373.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 412200, "num_env_steps_trained": 411900, "num_agent_steps_sampled": 412200, "num_agent_steps_trained": 411900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2748, "num_samples_added_to_queue": 412200, "learner_queue": {"size_count": 1373, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.903, "learner_load_time_ms": 0.299, "learner_load_wait_time_ms": 1192.635, "learner_dequeue_time_ms": 9985.729}}, "env_runners": {"episode_reward_max": 1215.3333333333364, "episode_reward_min": 1212.6333333333364, "episode_reward_mean": 1214.095250000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.6333333333364}, "policy_reward_max": {"default_policy": 1215.3333333333364}, "policy_reward_mean": {"default_policy": 1214.095250000003}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.44370000000000004, "num_moves_min": 0.1, "num_moves_max": 0.98, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16281983333333333, "num_slav_min": 0.16200000000000003, "num_slav_max": 0.16380000000000003, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5388260278773671, "mean_cluster_cpu_util_min": 0.5361772384629526, "mean_cluster_cpu_util_max": 0.5420524108291965, "mean_cluster_mem_util_mean": 0.34164553797468344, "mean_cluster_mem_util_min": 0.341223628691983, "mean_cluster_mem_util_max": 0.3420664556962025, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4422974999999996, "reward_sla_mean_min": -2.457, "reward_sla_mean_max": -2.4299999999999993, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.22975, "reward_sla_sum_min": -245.7, "reward_sla_sum_max": -242.99999999999994, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3183.0, "global_timestep_min": 1500, "global_timestep_max": 4800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.7333333333363, 1214.2833333333365, 1214.0333333333367, 1215.1333333333362, 1214.4833333333365, 1214.9833333333368, 1213.9333333333357, 1214.2833333333367, 1214.0833333333362, 1213.0333333333367, 1213.483333333336, 1213.9833333333368, 1213.1833333333354, 1215.133333333337, 1213.7833333333365, 1214.1833333333361, 1214.2833333333363, 1213.8833333333366, 1212.8833333333362, 1213.933333333336, 1215.1333333333364, 1214.4833333333354, 1212.883333333336, 1213.6833333333361, 1213.483333333337, 1214.133333333336, 1213.7833333333358, 1214.0833333333358, 1213.2333333333356, 1213.4833333333365, 1213.5833333333364, 1214.3333333333348, 1214.5333333333365, 1214.4333333333361, 1213.5333333333363, 1213.283333333337, 1213.775000000003, 1214.0333333333356, 1213.983333333336, 1213.683333333336, 1214.6333333333364, 1213.283333333336, 1214.5833333333355, 1214.7333333333363, 1214.5833333333367, 1215.3333333333364, 1213.8333333333353, 1214.8833333333366, 1215.0833333333362, 1212.8333333333362, 1213.6833333333366, 1213.6333333333357, 1214.3333333333367, 1214.733333333336, 1213.733333333336, 1213.983333333336, 1214.2333333333365, 1213.2333333333363, 1213.383333333337, 1214.1833333333361, 1213.283333333336, 1214.1833333333354, 1214.983333333336, 1213.6333333333362, 1213.8833333333366, 1214.133333333336, 1214.8833333333362, 1213.9833333333368, 1214.1833333333357, 1214.4833333333365, 1215.2833333333367, 1214.7333333333363, 1212.6333333333364, 1213.9833333333358, 1214.733333333336, 1213.7833333333363, 1213.9333333333357, 1213.2333333333363, 1214.2833333333367, 1213.4833333333358, 1213.683333333336, 1214.2333333333365, 1214.8333333333362, 1214.3333333333367, 1215.0333333333358, 1214.4833333333363, 1214.833333333336, 1215.283333333336, 1214.4333333333361, 1214.083333333336, 1213.7833333333365, 1213.7333333333354, 1213.783333333336, 1214.5333333333367, 1213.7333333333363, 1214.1333333333357, 1214.8833333333364, 1213.9833333333354, 1214.1333333333355, 1214.6833333333363], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.7333333333363, 1214.2833333333365, 1214.0333333333367, 1215.1333333333362, 1214.4833333333365, 1214.9833333333368, 1213.9333333333357, 1214.2833333333367, 1214.0833333333362, 1213.0333333333367, 1213.483333333336, 1213.9833333333368, 1213.1833333333354, 1215.133333333337, 1213.7833333333365, 1214.1833333333361, 1214.2833333333363, 1213.8833333333366, 1212.8833333333362, 1213.933333333336, 1215.1333333333364, 1214.4833333333354, 1212.883333333336, 1213.6833333333361, 1213.483333333337, 1214.133333333336, 1213.7833333333358, 1214.0833333333358, 1213.2333333333356, 1213.4833333333365, 1213.5833333333364, 1214.3333333333348, 1214.5333333333365, 1214.4333333333361, 1213.5333333333363, 1213.283333333337, 1213.775000000003, 1214.0333333333356, 1213.983333333336, 1213.683333333336, 1214.6333333333364, 1213.283333333336, 1214.5833333333355, 1214.7333333333363, 1214.5833333333367, 1215.3333333333364, 1213.8333333333353, 1214.8833333333366, 1215.0833333333362, 1212.8333333333362, 1213.6833333333366, 1213.6333333333357, 1214.3333333333367, 1214.733333333336, 1213.733333333336, 1213.983333333336, 1214.2333333333365, 1213.2333333333363, 1213.383333333337, 1214.1833333333361, 1213.283333333336, 1214.1833333333354, 1214.983333333336, 1213.6333333333362, 1213.8833333333366, 1214.133333333336, 1214.8833333333362, 1213.9833333333368, 1214.1833333333357, 1214.4833333333365, 1215.2833333333367, 1214.7333333333363, 1212.6333333333364, 1213.9833333333358, 1214.733333333336, 1213.7833333333363, 1213.9333333333357, 1213.2333333333363, 1214.2833333333367, 1213.4833333333358, 1213.683333333336, 1214.2333333333365, 1214.8333333333362, 1214.3333333333367, 1215.0333333333358, 1214.4833333333363, 1214.833333333336, 1215.283333333336, 1214.4333333333361, 1214.083333333336, 1213.7833333333365, 1213.7333333333354, 1213.783333333336, 1214.5333333333367, 1213.7333333333363, 1214.1333333333357, 1214.8833333333364, 1213.9833333333354, 1214.1333333333355, 1214.6833333333363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24282316773729362, "mean_inference_ms": 2.070541101383652, "mean_action_processing_ms": 0.09110618900614999, "mean_env_wait_ms": 1.541607078145226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006294727325439453, "StateBufferConnector_ms": 0.003322124481201172, "ViewRequirementAgentConnector_ms": 0.08629679679870605}, "num_episodes": 24, "episode_return_max": 1215.3333333333364, "episode_return_min": 1212.6333333333364, "episode_return_mean": 1214.095250000003, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 412200, "num_agent_steps_trained": 411900, "num_env_steps_sampled": 412200, "num_env_steps_trained": 411900, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 232.17997145889797, "num_env_steps_trained_throughput_per_sec": 232.17997145889797, "timesteps_total": 412200, "num_env_steps_sampled_lifetime": 412200, "num_agent_steps_sampled_lifetime": 412200, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 412200, "timers": {"training_iteration_time_ms": 10363.633, "restore_workers_time_ms": 0.012, "training_step_time_ms": 640.343, "sample_time_ms": 625.049, "synch_weights_time_ms": 13.913}, "counters": {"num_env_steps_sampled": 412200, "num_env_steps_trained": 411900, "num_agent_steps_sampled": 412200, "num_agent_steps_trained": 411900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2748, "num_samples_added_to_queue": 412200}, "done": false, "training_iteration": 164, "trial_id": "27800_00000", "date": "2024-10-12_15-56-12", "timestamp": 1728744972, "time_this_iter_s": 10.348830461502075, "time_total_s": 1697.1192343235016, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d470a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1697.1192343235016, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 19.26, "ram_util_percent": 64.72666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3864.4111328125, "policy_loss": 334.770751953125, "entropy": 4.976078510284424, "entropy_coeff": 0.01, "var_gnorm": 18.053077697753906, "vf_loss": 354456.875, "vf_explained_var": 0.6474221348762512}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1382.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 414750, "num_env_steps_trained": 414600, "num_agent_steps_sampled": 414750, "num_agent_steps_trained": 414600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2765, "num_samples_added_to_queue": 414600, "learner_queue": {"size_count": 1382, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 68.99, "learner_load_time_ms": 0.294, "learner_load_wait_time_ms": 1168.352, "learner_dequeue_time_ms": 9955.785}}, "env_runners": {"episode_reward_max": 1215.8333333333358, "episode_reward_min": 1212.6333333333364, "episode_reward_mean": 1214.0977500000029, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.6333333333364}, "policy_reward_max": {"default_policy": 1215.8333333333358}, "policy_reward_mean": {"default_policy": 1214.0977500000029}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.5394000000000001, "num_moves_min": 0.14, "num_moves_max": 0.98, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.1628181666666667, "num_slav_min": 0.16166666666666668, "num_slav_max": 0.16380000000000003, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5391061756526936, "mean_cluster_cpu_util_min": 0.5367469203897776, "mean_cluster_cpu_util_max": 0.5420524108291965, "mean_cluster_mem_util_mean": 0.3416317616033755, "mean_cluster_mem_util_min": 0.341204641350211, "mean_cluster_mem_util_max": 0.34195358649789026, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4422724999999996, "reward_sla_mean_min": -2.457, "reward_sla_mean_max": -2.4250000000000003, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.22724999999994, "reward_sla_sum_min": -245.7, "reward_sla_sum_max": -242.50000000000003, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3983.0, "global_timestep_min": 2300, "global_timestep_max": 5600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.483333333337, 1214.133333333336, 1213.7833333333358, 1214.0833333333358, 1213.2333333333356, 1213.4833333333365, 1213.5833333333364, 1214.3333333333348, 1214.5333333333365, 1214.4333333333361, 1213.5333333333363, 1213.283333333337, 1213.775000000003, 1214.0333333333356, 1213.983333333336, 1213.683333333336, 1214.6333333333364, 1213.283333333336, 1214.5833333333355, 1214.7333333333363, 1214.5833333333367, 1215.3333333333364, 1213.8333333333353, 1214.8833333333366, 1215.0833333333362, 1212.8333333333362, 1213.6833333333366, 1213.6333333333357, 1214.3333333333367, 1214.733333333336, 1213.733333333336, 1213.983333333336, 1214.2333333333365, 1213.2333333333363, 1213.383333333337, 1214.1833333333361, 1213.283333333336, 1214.1833333333354, 1214.983333333336, 1213.6333333333362, 1213.8833333333366, 1214.133333333336, 1214.8833333333362, 1213.9833333333368, 1214.1833333333357, 1214.4833333333365, 1215.2833333333367, 1214.7333333333363, 1212.6333333333364, 1213.9833333333358, 1214.733333333336, 1213.7833333333363, 1213.9333333333357, 1213.2333333333363, 1214.2833333333367, 1213.4833333333358, 1213.683333333336, 1214.2333333333365, 1214.8333333333362, 1214.3333333333367, 1215.0333333333358, 1214.4833333333363, 1214.833333333336, 1215.283333333336, 1214.4333333333361, 1214.083333333336, 1213.7833333333365, 1213.7333333333354, 1213.783333333336, 1214.5333333333367, 1213.7333333333363, 1214.1333333333357, 1214.8833333333364, 1213.9833333333354, 1214.1333333333355, 1214.6833333333363, 1214.3333333333358, 1214.2333333333365, 1214.183333333336, 1213.883333333336, 1213.0333333333367, 1213.483333333337, 1214.833333333337, 1214.0333333333365, 1213.8833333333357, 1214.1333333333357, 1214.6833333333361, 1215.8333333333358, 1214.1833333333363, 1213.6833333333366, 1214.0833333333362, 1213.733333333336, 1213.6333333333364, 1214.5333333333358, 1214.0333333333365, 1213.0833333333362, 1213.7333333333363, 1213.9833333333365, 1213.9833333333363, 1213.933333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.483333333337, 1214.133333333336, 1213.7833333333358, 1214.0833333333358, 1213.2333333333356, 1213.4833333333365, 1213.5833333333364, 1214.3333333333348, 1214.5333333333365, 1214.4333333333361, 1213.5333333333363, 1213.283333333337, 1213.775000000003, 1214.0333333333356, 1213.983333333336, 1213.683333333336, 1214.6333333333364, 1213.283333333336, 1214.5833333333355, 1214.7333333333363, 1214.5833333333367, 1215.3333333333364, 1213.8333333333353, 1214.8833333333366, 1215.0833333333362, 1212.8333333333362, 1213.6833333333366, 1213.6333333333357, 1214.3333333333367, 1214.733333333336, 1213.733333333336, 1213.983333333336, 1214.2333333333365, 1213.2333333333363, 1213.383333333337, 1214.1833333333361, 1213.283333333336, 1214.1833333333354, 1214.983333333336, 1213.6333333333362, 1213.8833333333366, 1214.133333333336, 1214.8833333333362, 1213.9833333333368, 1214.1833333333357, 1214.4833333333365, 1215.2833333333367, 1214.7333333333363, 1212.6333333333364, 1213.9833333333358, 1214.733333333336, 1213.7833333333363, 1213.9333333333357, 1213.2333333333363, 1214.2833333333367, 1213.4833333333358, 1213.683333333336, 1214.2333333333365, 1214.8333333333362, 1214.3333333333367, 1215.0333333333358, 1214.4833333333363, 1214.833333333336, 1215.283333333336, 1214.4333333333361, 1214.083333333336, 1213.7833333333365, 1213.7333333333354, 1213.783333333336, 1214.5333333333367, 1213.7333333333363, 1214.1333333333357, 1214.8833333333364, 1213.9833333333354, 1214.1333333333355, 1214.6833333333363, 1214.3333333333358, 1214.2333333333365, 1214.183333333336, 1213.883333333336, 1213.0333333333367, 1213.483333333337, 1214.833333333337, 1214.0333333333365, 1213.8833333333357, 1214.1333333333357, 1214.6833333333361, 1215.8333333333358, 1214.1833333333363, 1213.6833333333366, 1214.0833333333362, 1213.733333333336, 1213.6333333333364, 1214.5333333333358, 1214.0333333333365, 1213.0833333333362, 1213.7333333333363, 1213.9833333333365, 1213.9833333333363, 1213.933333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2428674933759756, "mean_inference_ms": 2.070750617719641, "mean_action_processing_ms": 0.09111068411726525, "mean_env_wait_ms": 1.5417324753010582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063800811767578125, "StateBufferConnector_ms": 0.003359556198120117, "ViewRequirementAgentConnector_ms": 0.08727788925170898}, "num_episodes": 24, "episode_return_max": 1215.8333333333358, "episode_return_min": 1212.6333333333364, "episode_return_mean": 1214.0977500000029, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 414750, "num_agent_steps_trained": 414600, "num_env_steps_sampled": 414750, "num_env_steps_trained": 414600, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 248.51561098966903, "num_env_steps_trained_throughput_per_sec": 263.1341763420025, "timesteps_total": 414750, "num_env_steps_sampled_lifetime": 414750, "num_agent_steps_sampled_lifetime": 414750, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 414750, "timers": {"training_iteration_time_ms": 10348.068, "restore_workers_time_ms": 0.013, "training_step_time_ms": 618.1, "sample_time_ms": 603.698, "synch_weights_time_ms": 12.954}, "counters": {"num_env_steps_sampled": 414750, "num_env_steps_trained": 414600, "num_agent_steps_sampled": 414750, "num_agent_steps_trained": 414600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2765, "num_samples_added_to_queue": 414600}, "done": false, "training_iteration": 165, "trial_id": "27800_00000", "date": "2024-10-12_15-56-22", "timestamp": 1728744982, "time_this_iter_s": 10.271560430526733, "time_total_s": 1707.3907947540283, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f35b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1707.3907947540283, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 15.946666666666667, "ram_util_percent": 64.32666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4629.3857421875, "policy_loss": 947.1961059570312, "entropy": 4.991103649139404, "entropy_coeff": 0.01, "var_gnorm": 18.055103302001953, "vf_loss": 369716.3125, "vf_explained_var": 0.6419488191604614}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1390.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 417300, "num_env_steps_trained": 417000, "num_agent_steps_sampled": 417300, "num_agent_steps_trained": 417000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2782, "num_samples_added_to_queue": 417300, "learner_queue": {"size_count": 1390, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.345, "learner_load_time_ms": 0.289, "learner_load_wait_time_ms": 1150.266, "learner_dequeue_time_ms": 9932.33}}, "env_runners": {"episode_reward_max": 1215.8333333333358, "episode_reward_min": 1212.6333333333364, "episode_reward_mean": 1214.1053333333361, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.6333333333364}, "policy_reward_max": {"default_policy": 1215.8333333333358}, "policy_reward_mean": {"default_policy": 1214.1053333333361}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.5724, "num_moves_min": 0.14, "num_moves_max": 0.98, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.1628186666666667, "num_slav_min": 0.16166666666666668, "num_slav_max": 0.16380000000000003, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5394277125850341, "mean_cluster_cpu_util_min": 0.5370419999080712, "mean_cluster_cpu_util_max": 0.5420524108291965, "mean_cluster_mem_util_mean": 0.34165313291139243, "mean_cluster_mem_util_min": 0.341204641350211, "mean_cluster_mem_util_max": 0.34195358649789026, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.44228, "reward_sla_mean_min": -2.457, "reward_sla_mean_max": -2.4250000000000003, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.22799999999995, "reward_sla_sum_min": -245.7, "reward_sla_sum_max": -242.50000000000003, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4882.0, "global_timestep_min": 3200, "global_timestep_max": 6500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.6333333333357, 1214.3333333333367, 1214.733333333336, 1213.733333333336, 1213.983333333336, 1214.2333333333365, 1213.2333333333363, 1213.383333333337, 1214.1833333333361, 1213.283333333336, 1214.1833333333354, 1214.983333333336, 1213.6333333333362, 1213.8833333333366, 1214.133333333336, 1214.8833333333362, 1213.9833333333368, 1214.1833333333357, 1214.4833333333365, 1215.2833333333367, 1214.7333333333363, 1212.6333333333364, 1213.9833333333358, 1214.733333333336, 1213.7833333333363, 1213.9333333333357, 1213.2333333333363, 1214.2833333333367, 1213.4833333333358, 1213.683333333336, 1214.2333333333365, 1214.8333333333362, 1214.3333333333367, 1215.0333333333358, 1214.4833333333363, 1214.833333333336, 1215.283333333336, 1214.4333333333361, 1214.083333333336, 1213.7833333333365, 1213.7333333333354, 1213.783333333336, 1214.5333333333367, 1213.7333333333363, 1214.1333333333357, 1214.8833333333364, 1213.9833333333354, 1214.1333333333355, 1214.6833333333363, 1214.3333333333358, 1214.2333333333365, 1214.183333333336, 1213.883333333336, 1213.0333333333367, 1213.483333333337, 1214.833333333337, 1214.0333333333365, 1213.8833333333357, 1214.1333333333357, 1214.6833333333361, 1215.8333333333358, 1214.1833333333363, 1213.6833333333366, 1214.0833333333362, 1213.733333333336, 1213.6333333333364, 1214.5333333333358, 1214.0333333333365, 1213.0833333333362, 1213.7333333333363, 1213.9833333333365, 1213.9833333333363, 1213.933333333336, 1213.3833333333355, 1213.5333333333358, 1214.6333333333362, 1214.0833333333362, 1213.8333333333364, 1213.1833333333357, 1215.0833333333362, 1214.7333333333365, 1214.133333333336, 1215.6333333333366, 1214.9833333333363, 1214.6833333333361, 1213.8833333333362, 1214.3333333333367, 1214.183333333336, 1214.2833333333365, 1213.4833333333363, 1213.0833333333362, 1213.8833333333364, 1213.3333333333362, 1212.9333333333366, 1214.5333333333365, 1213.8333333333362, 1214.083333333336, 1214.2333333333356, 1214.1333333333362, 1213.4833333333363], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.6333333333357, 1214.3333333333367, 1214.733333333336, 1213.733333333336, 1213.983333333336, 1214.2333333333365, 1213.2333333333363, 1213.383333333337, 1214.1833333333361, 1213.283333333336, 1214.1833333333354, 1214.983333333336, 1213.6333333333362, 1213.8833333333366, 1214.133333333336, 1214.8833333333362, 1213.9833333333368, 1214.1833333333357, 1214.4833333333365, 1215.2833333333367, 1214.7333333333363, 1212.6333333333364, 1213.9833333333358, 1214.733333333336, 1213.7833333333363, 1213.9333333333357, 1213.2333333333363, 1214.2833333333367, 1213.4833333333358, 1213.683333333336, 1214.2333333333365, 1214.8333333333362, 1214.3333333333367, 1215.0333333333358, 1214.4833333333363, 1214.833333333336, 1215.283333333336, 1214.4333333333361, 1214.083333333336, 1213.7833333333365, 1213.7333333333354, 1213.783333333336, 1214.5333333333367, 1213.7333333333363, 1214.1333333333357, 1214.8833333333364, 1213.9833333333354, 1214.1333333333355, 1214.6833333333363, 1214.3333333333358, 1214.2333333333365, 1214.183333333336, 1213.883333333336, 1213.0333333333367, 1213.483333333337, 1214.833333333337, 1214.0333333333365, 1213.8833333333357, 1214.1333333333357, 1214.6833333333361, 1215.8333333333358, 1214.1833333333363, 1213.6833333333366, 1214.0833333333362, 1213.733333333336, 1213.6333333333364, 1214.5333333333358, 1214.0333333333365, 1213.0833333333362, 1213.7333333333363, 1213.9833333333365, 1213.9833333333363, 1213.933333333336, 1213.3833333333355, 1213.5333333333358, 1214.6333333333362, 1214.0833333333362, 1213.8333333333364, 1213.1833333333357, 1215.0833333333362, 1214.7333333333365, 1214.133333333336, 1215.6333333333366, 1214.9833333333363, 1214.6833333333361, 1213.8833333333362, 1214.3333333333367, 1214.183333333336, 1214.2833333333365, 1213.4833333333363, 1213.0833333333362, 1213.8833333333364, 1213.3333333333362, 1212.9333333333366, 1214.5333333333365, 1213.8333333333362, 1214.083333333336, 1214.2333333333356, 1214.1333333333362, 1213.4833333333363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2428442995989424, "mean_inference_ms": 2.0690412070078334, "mean_action_processing_ms": 0.09108722043001859, "mean_env_wait_ms": 1.5413325962255968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006312370300292969, "StateBufferConnector_ms": 0.0032994747161865234, "ViewRequirementAgentConnector_ms": 0.08530426025390625}, "num_episodes": 27, "episode_return_max": 1215.8333333333358, "episode_return_min": 1212.6333333333364, "episode_return_mean": 1214.1053333333361, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 417300, "num_agent_steps_trained": 417000, "num_env_steps_sampled": 417300, "num_env_steps_trained": 417000, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 250.52744165505575, "num_env_steps_trained_throughput_per_sec": 235.7905333224054, "timesteps_total": 417300, "num_env_steps_sampled_lifetime": 417300, "num_agent_steps_sampled_lifetime": 417300, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 417300, "timers": {"training_iteration_time_ms": 10354.492, "restore_workers_time_ms": 0.014, "training_step_time_ms": 602.881, "sample_time_ms": 586.934, "synch_weights_time_ms": 14.556}, "counters": {"num_env_steps_sampled": 417300, "num_env_steps_trained": 417000, "num_agent_steps_sampled": 417300, "num_agent_steps_trained": 417000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2782, "num_samples_added_to_queue": 417300}, "done": false, "training_iteration": 166, "trial_id": "27800_00000", "date": "2024-10-12_15-56-32", "timestamp": 1728744992, "time_this_iter_s": 10.191441297531128, "time_total_s": 1717.5822360515594, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d44b80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1717.5822360515594, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 15.742857142857142, "ram_util_percent": 63.685714285714276}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3191.6689453125, "policy_loss": -194.64840698242188, "entropy": 5.298274517059326, "entropy_coeff": 0.01, "var_gnorm": 18.0607967376709, "vf_loss": 340221.21875, "vf_explained_var": 0.654090404510498}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1399.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 419850, "num_env_steps_trained": 419700, "num_agent_steps_sampled": 419850, "num_agent_steps_trained": 419700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2799, "num_samples_added_to_queue": 419700, "learner_queue": {"size_count": 1399, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.816, "learner_load_time_ms": 0.288, "learner_load_wait_time_ms": 1152.775, "learner_dequeue_time_ms": 9901.706}}, "env_runners": {"episode_reward_max": 1215.8333333333358, "episode_reward_min": 1212.383333333336, "episode_reward_mean": 1214.0701666666694, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.383333333336}, "policy_reward_max": {"default_policy": 1215.8333333333358}, "policy_reward_mean": {"default_policy": 1214.0701666666694}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.5937, "num_moves_min": 0.22, "num_moves_max": 0.98, "mean_accuracy_mean": 43.63339666666667, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63966666666667, "num_model_switches_mean": 0.0002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16284766666666667, "num_slav_min": 0.16166666666666668, "num_slav_max": 0.16396666666666668, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.539615156738371, "mean_cluster_cpu_util_min": 0.5372978143960286, "mean_cluster_cpu_util_max": 0.5420524108291965, "mean_cluster_mem_util_mean": 0.3416222257383966, "mean_cluster_mem_util_min": 0.341204641350211, "mean_cluster_mem_util_max": 0.34195358649789026, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333416666666691, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.341666666666695, "reward_sla_mean_mean": -2.442715, "reward_sla_mean_min": -2.4595, "reward_sla_mean_max": -2.4250000000000003, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3416666666694, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 834.1666666666695, "reward_sla_sum_mean": -244.2715, "reward_sla_sum_min": -245.94999999999996, "reward_sla_sum_max": -242.50000000000003, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5683.0, "global_timestep_min": 4000, "global_timestep_max": 7300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.7833333333363, 1213.9333333333357, 1213.2333333333363, 1214.2833333333367, 1213.4833333333358, 1213.683333333336, 1214.2333333333365, 1214.8333333333362, 1214.3333333333367, 1215.0333333333358, 1214.4833333333363, 1214.833333333336, 1215.283333333336, 1214.4333333333361, 1214.083333333336, 1213.7833333333365, 1213.7333333333354, 1213.783333333336, 1214.5333333333367, 1213.7333333333363, 1214.1333333333357, 1214.8833333333364, 1213.9833333333354, 1214.1333333333355, 1214.6833333333363, 1214.3333333333358, 1214.2333333333365, 1214.183333333336, 1213.883333333336, 1213.0333333333367, 1213.483333333337, 1214.833333333337, 1214.0333333333365, 1213.8833333333357, 1214.1333333333357, 1214.6833333333361, 1215.8333333333358, 1214.1833333333363, 1213.6833333333366, 1214.0833333333362, 1213.733333333336, 1213.6333333333364, 1214.5333333333358, 1214.0333333333365, 1213.0833333333362, 1213.7333333333363, 1213.9833333333365, 1213.9833333333363, 1213.933333333336, 1213.3833333333355, 1213.5333333333358, 1214.6333333333362, 1214.0833333333362, 1213.8333333333364, 1213.1833333333357, 1215.0833333333362, 1214.7333333333365, 1214.133333333336, 1215.6333333333366, 1214.9833333333363, 1214.6833333333361, 1213.8833333333362, 1214.3333333333367, 1214.183333333336, 1214.2833333333365, 1213.4833333333363, 1213.0833333333362, 1213.8833333333364, 1213.3333333333362, 1212.9333333333366, 1214.5333333333365, 1213.8333333333362, 1214.083333333336, 1214.2333333333356, 1214.1333333333362, 1213.4833333333363, 1213.833333333336, 1215.0833333333362, 1214.3833333333357, 1213.2333333333358, 1215.1333333333357, 1213.3833333333366, 1215.0333333333363, 1213.1833333333363, 1213.083333333336, 1213.8833333333362, 1213.083333333337, 1214.933333333336, 1212.383333333336, 1214.1833333333361, 1213.5333333333358, 1214.1333333333366, 1214.4333333333361, 1213.2833333333356, 1214.9166666666697, 1213.1333333333364, 1214.8833333333364, 1213.6333333333362, 1214.1833333333363, 1213.9833333333365], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.7833333333363, 1213.9333333333357, 1213.2333333333363, 1214.2833333333367, 1213.4833333333358, 1213.683333333336, 1214.2333333333365, 1214.8333333333362, 1214.3333333333367, 1215.0333333333358, 1214.4833333333363, 1214.833333333336, 1215.283333333336, 1214.4333333333361, 1214.083333333336, 1213.7833333333365, 1213.7333333333354, 1213.783333333336, 1214.5333333333367, 1213.7333333333363, 1214.1333333333357, 1214.8833333333364, 1213.9833333333354, 1214.1333333333355, 1214.6833333333363, 1214.3333333333358, 1214.2333333333365, 1214.183333333336, 1213.883333333336, 1213.0333333333367, 1213.483333333337, 1214.833333333337, 1214.0333333333365, 1213.8833333333357, 1214.1333333333357, 1214.6833333333361, 1215.8333333333358, 1214.1833333333363, 1213.6833333333366, 1214.0833333333362, 1213.733333333336, 1213.6333333333364, 1214.5333333333358, 1214.0333333333365, 1213.0833333333362, 1213.7333333333363, 1213.9833333333365, 1213.9833333333363, 1213.933333333336, 1213.3833333333355, 1213.5333333333358, 1214.6333333333362, 1214.0833333333362, 1213.8333333333364, 1213.1833333333357, 1215.0833333333362, 1214.7333333333365, 1214.133333333336, 1215.6333333333366, 1214.9833333333363, 1214.6833333333361, 1213.8833333333362, 1214.3333333333367, 1214.183333333336, 1214.2833333333365, 1213.4833333333363, 1213.0833333333362, 1213.8833333333364, 1213.3333333333362, 1212.9333333333366, 1214.5333333333365, 1213.8333333333362, 1214.083333333336, 1214.2333333333356, 1214.1333333333362, 1213.4833333333363, 1213.833333333336, 1215.0833333333362, 1214.3833333333357, 1213.2333333333358, 1215.1333333333357, 1213.3833333333366, 1215.0333333333363, 1213.1833333333363, 1213.083333333336, 1213.8833333333362, 1213.083333333337, 1214.933333333336, 1212.383333333336, 1214.1833333333361, 1213.5333333333358, 1214.1333333333366, 1214.4333333333361, 1213.2833333333356, 1214.9166666666697, 1213.1333333333364, 1214.8833333333364, 1213.6333333333362, 1214.1833333333363, 1213.9833333333365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24289127814030834, "mean_inference_ms": 2.0705884452046703, "mean_action_processing_ms": 0.09110156313419848, "mean_env_wait_ms": 1.54170667633417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006289958953857422, "StateBufferConnector_ms": 0.0032806396484375, "ViewRequirementAgentConnector_ms": 0.08461856842041016}, "num_episodes": 24, "episode_return_max": 1215.8333333333358, "episode_return_min": 1212.383333333336, "episode_return_mean": 1214.0701666666694, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 419850, "num_agent_steps_trained": 419700, "num_env_steps_sampled": 419850, "num_env_steps_trained": 419700, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 244.97071247007, "num_env_steps_trained_throughput_per_sec": 259.3807543800741, "timesteps_total": 419850, "num_env_steps_sampled_lifetime": 419850, "num_agent_steps_sampled_lifetime": 419850, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 419850, "timers": {"training_iteration_time_ms": 10350.907, "restore_workers_time_ms": 0.013, "training_step_time_ms": 618.125, "sample_time_ms": 602.324, "synch_weights_time_ms": 14.224}, "counters": {"num_env_steps_sampled": 419850, "num_env_steps_trained": 419700, "num_agent_steps_sampled": 419850, "num_agent_steps_trained": 419700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2799, "num_samples_added_to_queue": 419700}, "done": false, "training_iteration": 167, "trial_id": "27800_00000", "date": "2024-10-12_15-56-43", "timestamp": 1728745003, "time_this_iter_s": 10.421860218048096, "time_total_s": 1728.0040962696075, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948953010>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1728.0040962696075, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 16.09333333333333, "ram_util_percent": 63.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2860.9345703125, "policy_loss": -1204.0947265625, "entropy": 5.410640239715576, "entropy_coeff": 0.01, "var_gnorm": 18.06365394592285, "vf_loss": 408126.125, "vf_explained_var": 0.6166557669639587}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1406.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 422100, "num_env_steps_trained": 421800, "num_agent_steps_sampled": 422100, "num_agent_steps_trained": 421800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2814, "num_samples_added_to_queue": 422100, "learner_queue": {"size_count": 1406, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.151, "learner_load_time_ms": 0.286, "learner_load_wait_time_ms": 1272.792, "learner_dequeue_time_ms": 9909.519}}, "env_runners": {"episode_reward_max": 1215.8333333333358, "episode_reward_min": 1212.2833333333356, "episode_reward_mean": 1214.0041666666698, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.2833333333356}, "policy_reward_max": {"default_policy": 1215.8333333333358}, "policy_reward_mean": {"default_policy": 1214.0041666666698}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.5994, "num_moves_min": 0.22, "num_moves_max": 1.03, "mean_accuracy_mean": 43.63339666666667, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63966666666667, "num_model_switches_mean": 0.0008, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16289166666666666, "num_slav_min": 0.16166666666666668, "num_slav_max": 0.16403333333333336, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5399014086918552, "mean_cluster_cpu_util_min": 0.5372978143960286, "mean_cluster_cpu_util_max": 0.543040494576209, "mean_cluster_mem_util_mean": 0.34162693037974684, "mean_cluster_mem_util_min": 0.341204641350211, "mean_cluster_mem_util_max": 0.34197362869198317, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333416666666691, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.341666666666695, "reward_sla_mean_mean": -2.4433749999999996, "reward_sla_mean_min": -2.4605, "reward_sla_mean_max": -2.4250000000000003, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3416666666694, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 834.1666666666695, "reward_sla_sum_mean": -244.33749999999998, "reward_sla_sum_min": -246.05, "reward_sla_sum_max": -242.50000000000003, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5781.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.6833333333363, 1214.3333333333358, 1214.2333333333365, 1214.183333333336, 1213.883333333336, 1213.0333333333367, 1213.483333333337, 1214.833333333337, 1214.0333333333365, 1213.8833333333357, 1214.1333333333357, 1214.6833333333361, 1215.8333333333358, 1214.1833333333363, 1213.6833333333366, 1214.0833333333362, 1213.733333333336, 1213.6333333333364, 1214.5333333333358, 1214.0333333333365, 1213.0833333333362, 1213.7333333333363, 1213.9833333333365, 1213.9833333333363, 1213.933333333336, 1213.3833333333355, 1213.5333333333358, 1214.6333333333362, 1214.0833333333362, 1213.8333333333364, 1213.1833333333357, 1215.0833333333362, 1214.7333333333365, 1214.133333333336, 1215.6333333333366, 1214.9833333333363, 1214.6833333333361, 1213.8833333333362, 1214.3333333333367, 1214.183333333336, 1214.2833333333365, 1213.4833333333363, 1213.0833333333362, 1213.8833333333364, 1213.3333333333362, 1212.9333333333366, 1214.5333333333365, 1213.8333333333362, 1214.083333333336, 1214.2333333333356, 1214.1333333333362, 1213.4833333333363, 1213.833333333336, 1215.0833333333362, 1214.3833333333357, 1213.2333333333358, 1215.1333333333357, 1213.3833333333366, 1215.0333333333363, 1213.1833333333363, 1213.083333333336, 1213.8833333333362, 1213.083333333337, 1214.933333333336, 1212.383333333336, 1214.1833333333361, 1213.5333333333358, 1214.1333333333366, 1214.4333333333361, 1213.2833333333356, 1214.9166666666697, 1213.1333333333364, 1214.8833333333364, 1213.6333333333362, 1214.1833333333363, 1213.9833333333365, 1215.5833333333367, 1215.3333333333364, 1214.1833333333354, 1213.833333333337, 1214.4833333333368, 1214.6333333333364, 1213.6833333333354, 1213.2333333333365, 1213.7833333333358, 1213.5333333333353, 1212.9833333333363, 1214.1333333333366, 1213.8833333333362, 1212.2833333333356, 1213.5833333333367, 1213.9333333333368, 1213.583333333336, 1213.1333333333366, 1213.8833333333364, 1213.4333333333363, 1214.4833333333358, 1214.783333333336, 1213.6833333333357, 1213.983333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.6833333333363, 1214.3333333333358, 1214.2333333333365, 1214.183333333336, 1213.883333333336, 1213.0333333333367, 1213.483333333337, 1214.833333333337, 1214.0333333333365, 1213.8833333333357, 1214.1333333333357, 1214.6833333333361, 1215.8333333333358, 1214.1833333333363, 1213.6833333333366, 1214.0833333333362, 1213.733333333336, 1213.6333333333364, 1214.5333333333358, 1214.0333333333365, 1213.0833333333362, 1213.7333333333363, 1213.9833333333365, 1213.9833333333363, 1213.933333333336, 1213.3833333333355, 1213.5333333333358, 1214.6333333333362, 1214.0833333333362, 1213.8333333333364, 1213.1833333333357, 1215.0833333333362, 1214.7333333333365, 1214.133333333336, 1215.6333333333366, 1214.9833333333363, 1214.6833333333361, 1213.8833333333362, 1214.3333333333367, 1214.183333333336, 1214.2833333333365, 1213.4833333333363, 1213.0833333333362, 1213.8833333333364, 1213.3333333333362, 1212.9333333333366, 1214.5333333333365, 1213.8333333333362, 1214.083333333336, 1214.2333333333356, 1214.1333333333362, 1213.4833333333363, 1213.833333333336, 1215.0833333333362, 1214.3833333333357, 1213.2333333333358, 1215.1333333333357, 1213.3833333333366, 1215.0333333333363, 1213.1833333333363, 1213.083333333336, 1213.8833333333362, 1213.083333333337, 1214.933333333336, 1212.383333333336, 1214.1833333333361, 1213.5333333333358, 1214.1333333333366, 1214.4333333333361, 1213.2833333333356, 1214.9166666666697, 1213.1333333333364, 1214.8833333333364, 1213.6333333333362, 1214.1833333333363, 1213.9833333333365, 1215.5833333333367, 1215.3333333333364, 1214.1833333333354, 1213.833333333337, 1214.4833333333368, 1214.6333333333364, 1213.6833333333354, 1213.2333333333365, 1213.7833333333358, 1213.5333333333353, 1212.9833333333363, 1214.1333333333366, 1213.8833333333362, 1212.2833333333356, 1213.5833333333367, 1213.9333333333368, 1213.583333333336, 1213.1333333333366, 1213.8833333333364, 1213.4333333333363, 1214.4833333333358, 1214.783333333336, 1213.6833333333357, 1213.983333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24290647812642557, "mean_inference_ms": 2.0707342779818223, "mean_action_processing_ms": 0.09110273098864298, "mean_env_wait_ms": 1.5417894791406996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006807565689086914, "StateBufferConnector_ms": 0.003395557403564453, "ViewRequirementAgentConnector_ms": 0.08659863471984863}, "num_episodes": 24, "episode_return_max": 1215.8333333333358, "episode_return_min": 1212.2833333333356, "episode_return_mean": 1214.0041666666698, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 422100, "num_agent_steps_trained": 421800, "num_env_steps_sampled": 422100, "num_env_steps_trained": 421800, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 218.93661056126183, "num_env_steps_trained_throughput_per_sec": 204.3408365238444, "timesteps_total": 422100, "num_env_steps_sampled_lifetime": 422100, "num_agent_steps_sampled_lifetime": 422100, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 422100, "timers": {"training_iteration_time_ms": 10345.223, "restore_workers_time_ms": 0.013, "training_step_time_ms": 710.605, "sample_time_ms": 695.175, "synch_weights_time_ms": 13.948}, "counters": {"num_env_steps_sampled": 422100, "num_env_steps_trained": 421800, "num_agent_steps_sampled": 422100, "num_agent_steps_trained": 421800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2814, "num_samples_added_to_queue": 422100}, "done": false, "training_iteration": 168, "trial_id": "27800_00000", "date": "2024-10-12_15-56-53", "timestamp": 1728745013, "time_this_iter_s": 10.286693811416626, "time_total_s": 1738.2907900810242, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948952590>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1738.2907900810242, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 23.566666666666666, "ram_util_percent": 64.56}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2332.10595703125, "policy_loss": -1763.1490478515625, "entropy": 5.51346492767334, "entropy_coeff": 0.01, "var_gnorm": 18.06243324279785, "vf_loss": 411179.53125, "vf_explained_var": 0.6091792583465576}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1415.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 424650, "num_env_steps_trained": 424500, "num_agent_steps_sampled": 424650, "num_agent_steps_trained": 424500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2831, "num_samples_added_to_queue": 424500, "learner_queue": {"size_count": 1415, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.243, "learner_load_time_ms": 0.299, "learner_load_wait_time_ms": 1156.231, "learner_dequeue_time_ms": 10029.774}}, "env_runners": {"episode_reward_max": 1215.6333333333366, "episode_reward_min": 1212.2833333333356, "episode_reward_mean": 1214.0180833333363, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.2833333333356}, "policy_reward_max": {"default_policy": 1215.6333333333366}, "policy_reward_mean": {"default_policy": 1214.0180833333363}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.6670999999999999, "num_moves_min": 0.22, "num_moves_max": 1.14, "mean_accuracy_mean": 43.63333333333332, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63966666666667, "num_model_switches_mean": 0.001, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16287683333333336, "num_slav_min": 0.1618, "num_slav_max": 0.16403333333333336, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5402324210562603, "mean_cluster_cpu_util_min": 0.5374114152417723, "mean_cluster_cpu_util_max": 0.5430474466813753, "mean_cluster_mem_util_mean": 0.34160885548523207, "mean_cluster_mem_util_min": 0.34119303797468353, "mean_cluster_mem_util_max": 0.34197362869198317, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.33333333333336, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.341666666666695, "reward_sla_mean_mean": -2.4431524999999996, "reward_sla_mean_min": -2.4605, "reward_sla_mean_max": -2.427, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 834.1666666666695, "reward_sla_sum_mean": -244.31525000000005, "reward_sla_sum_min": -246.05, "reward_sla_sum_max": -242.7, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4709.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.933333333336, 1213.3833333333355, 1213.5333333333358, 1214.6333333333362, 1214.0833333333362, 1213.8333333333364, 1213.1833333333357, 1215.0833333333362, 1214.7333333333365, 1214.133333333336, 1215.6333333333366, 1214.9833333333363, 1214.6833333333361, 1213.8833333333362, 1214.3333333333367, 1214.183333333336, 1214.2833333333365, 1213.4833333333363, 1213.0833333333362, 1213.8833333333364, 1213.3333333333362, 1212.9333333333366, 1214.5333333333365, 1213.8333333333362, 1214.083333333336, 1214.2333333333356, 1214.1333333333362, 1213.4833333333363, 1213.833333333336, 1215.0833333333362, 1214.3833333333357, 1213.2333333333358, 1215.1333333333357, 1213.3833333333366, 1215.0333333333363, 1213.1833333333363, 1213.083333333336, 1213.8833333333362, 1213.083333333337, 1214.933333333336, 1212.383333333336, 1214.1833333333361, 1213.5333333333358, 1214.1333333333366, 1214.4333333333361, 1213.2833333333356, 1214.9166666666697, 1213.1333333333364, 1214.8833333333364, 1213.6333333333362, 1214.1833333333363, 1213.9833333333365, 1215.5833333333367, 1215.3333333333364, 1214.1833333333354, 1213.833333333337, 1214.4833333333368, 1214.6333333333364, 1213.6833333333354, 1213.2333333333365, 1213.7833333333358, 1213.5333333333353, 1212.9833333333363, 1214.1333333333366, 1213.8833333333362, 1212.2833333333356, 1213.5833333333367, 1213.9333333333368, 1213.583333333336, 1213.1333333333366, 1213.8833333333364, 1213.4333333333363, 1214.4833333333358, 1214.783333333336, 1213.6833333333357, 1213.983333333336, 1213.8333333333367, 1214.0333333333367, 1214.4333333333366, 1214.1333333333369, 1213.9333333333363, 1213.933333333336, 1214.5333333333365, 1213.4833333333363, 1213.9833333333365, 1214.3333333333362, 1214.033333333336, 1214.433333333336, 1214.5833333333362, 1214.383333333336, 1214.1333333333366, 1213.6333333333364, 1214.2750000000035, 1214.5333333333356, 1215.0833333333362, 1215.2833333333363, 1213.383333333336, 1213.0833333333358, 1213.8833333333362, 1213.933333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.933333333336, 1213.3833333333355, 1213.5333333333358, 1214.6333333333362, 1214.0833333333362, 1213.8333333333364, 1213.1833333333357, 1215.0833333333362, 1214.7333333333365, 1214.133333333336, 1215.6333333333366, 1214.9833333333363, 1214.6833333333361, 1213.8833333333362, 1214.3333333333367, 1214.183333333336, 1214.2833333333365, 1213.4833333333363, 1213.0833333333362, 1213.8833333333364, 1213.3333333333362, 1212.9333333333366, 1214.5333333333365, 1213.8333333333362, 1214.083333333336, 1214.2333333333356, 1214.1333333333362, 1213.4833333333363, 1213.833333333336, 1215.0833333333362, 1214.3833333333357, 1213.2333333333358, 1215.1333333333357, 1213.3833333333366, 1215.0333333333363, 1213.1833333333363, 1213.083333333336, 1213.8833333333362, 1213.083333333337, 1214.933333333336, 1212.383333333336, 1214.1833333333361, 1213.5333333333358, 1214.1333333333366, 1214.4333333333361, 1213.2833333333356, 1214.9166666666697, 1213.1333333333364, 1214.8833333333364, 1213.6333333333362, 1214.1833333333363, 1213.9833333333365, 1215.5833333333367, 1215.3333333333364, 1214.1833333333354, 1213.833333333337, 1214.4833333333368, 1214.6333333333364, 1213.6833333333354, 1213.2333333333365, 1213.7833333333358, 1213.5333333333353, 1212.9833333333363, 1214.1333333333366, 1213.8833333333362, 1212.2833333333356, 1213.5833333333367, 1213.9333333333368, 1213.583333333336, 1213.1333333333366, 1213.8833333333364, 1213.4333333333363, 1214.4833333333358, 1214.783333333336, 1213.6833333333357, 1213.983333333336, 1213.8333333333367, 1214.0333333333367, 1214.4333333333366, 1214.1333333333369, 1213.9333333333363, 1213.933333333336, 1214.5333333333365, 1213.4833333333363, 1213.9833333333365, 1214.3333333333362, 1214.033333333336, 1214.433333333336, 1214.5833333333362, 1214.383333333336, 1214.1333333333366, 1213.6333333333364, 1214.2750000000035, 1214.5333333333356, 1215.0833333333362, 1215.2833333333363, 1213.383333333336, 1213.0833333333358, 1213.8833333333362, 1213.933333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2429368013992808, "mean_inference_ms": 2.070998244384475, "mean_action_processing_ms": 0.0911087821805685, "mean_env_wait_ms": 1.541961415862651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00696253776550293, "StateBufferConnector_ms": 0.0033681392669677734, "ViewRequirementAgentConnector_ms": 0.0857698917388916}, "num_episodes": 24, "episode_return_max": 1215.6333333333366, "episode_return_min": 1212.2833333333356, "episode_return_mean": 1214.0180833333363, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 424650, "num_agent_steps_trained": 424500, "num_env_steps_sampled": 424650, "num_env_steps_trained": 424500, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 237.28303100373827, "num_env_steps_trained_throughput_per_sec": 251.24085635689934, "timesteps_total": 424650, "num_env_steps_sampled_lifetime": 424650, "num_agent_steps_sampled_lifetime": 424650, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 424650, "timers": {"training_iteration_time_ms": 10360.498, "restore_workers_time_ms": 0.013, "training_step_time_ms": 635.464, "sample_time_ms": 618.332, "synch_weights_time_ms": 15.597}, "counters": {"num_env_steps_sampled": 424650, "num_env_steps_trained": 424500, "num_agent_steps_sampled": 424650, "num_agent_steps_trained": 424500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2831, "num_samples_added_to_queue": 424500}, "done": false, "training_iteration": 169, "trial_id": "27800_00000", "date": "2024-10-12_15-57-04", "timestamp": 1728745024, "time_this_iter_s": 10.757270336151123, "time_total_s": 1749.0480604171753, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d26b60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1749.0480604171753, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 17.706666666666667, "ram_util_percent": 65.58}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2903.916259765625, "policy_loss": -954.8919677734375, "entropy": 5.532013416290283, "entropy_coeff": 0.01, "var_gnorm": 18.059524536132812, "vf_loss": 387540.4375, "vf_explained_var": 0.6170599460601807}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1423.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 427050, "num_env_steps_trained": 426900, "num_agent_steps_sampled": 427050, "num_agent_steps_trained": 426900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2847, "num_samples_added_to_queue": 426900, "learner_queue": {"size_count": 1423, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.585, "learner_load_time_ms": 0.3, "learner_load_wait_time_ms": 1239.806, "learner_dequeue_time_ms": 10079.386}}, "env_runners": {"episode_reward_max": 1215.5833333333367, "episode_reward_min": 1212.2833333333356, "episode_reward_mean": 1214.0120833333362, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.2833333333356}, "policy_reward_max": {"default_policy": 1215.5833333333367}, "policy_reward_mean": {"default_policy": 1214.0120833333362}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.8094, "num_moves_min": 0.32, "num_moves_max": 1.14, "mean_accuracy_mean": 43.63333333333332, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63966666666667, "num_model_switches_mean": 0.001, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16288083333333336, "num_slav_min": 0.16183333333333333, "num_slav_max": 0.16403333333333336, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5409005018155911, "mean_cluster_cpu_util_min": 0.5378585217870931, "mean_cluster_cpu_util_max": 0.5442944130354844, "mean_cluster_mem_util_mean": 0.3416125685654008, "mean_cluster_mem_util_min": 0.34119303797468353, "mean_cluster_mem_util_max": 0.34198206751054855, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.33333333333336, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.341666666666695, "reward_sla_mean_mean": -2.4432124999999996, "reward_sla_mean_min": -2.4605, "reward_sla_mean_max": -2.4275, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 834.1666666666695, "reward_sla_sum_mean": -244.32125, "reward_sla_sum_min": -246.05, "reward_sla_sum_max": -242.75, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3632.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.083333333336, 1214.2333333333356, 1214.1333333333362, 1213.4833333333363, 1213.833333333336, 1215.0833333333362, 1214.3833333333357, 1213.2333333333358, 1215.1333333333357, 1213.3833333333366, 1215.0333333333363, 1213.1833333333363, 1213.083333333336, 1213.8833333333362, 1213.083333333337, 1214.933333333336, 1212.383333333336, 1214.1833333333361, 1213.5333333333358, 1214.1333333333366, 1214.4333333333361, 1213.2833333333356, 1214.9166666666697, 1213.1333333333364, 1214.8833333333364, 1213.6333333333362, 1214.1833333333363, 1213.9833333333365, 1215.5833333333367, 1215.3333333333364, 1214.1833333333354, 1213.833333333337, 1214.4833333333368, 1214.6333333333364, 1213.6833333333354, 1213.2333333333365, 1213.7833333333358, 1213.5333333333353, 1212.9833333333363, 1214.1333333333366, 1213.8833333333362, 1212.2833333333356, 1213.5833333333367, 1213.9333333333368, 1213.583333333336, 1213.1333333333366, 1213.8833333333364, 1213.4333333333363, 1214.4833333333358, 1214.783333333336, 1213.6833333333357, 1213.983333333336, 1213.8333333333367, 1214.0333333333367, 1214.4333333333366, 1214.1333333333369, 1213.9333333333363, 1213.933333333336, 1214.5333333333365, 1213.4833333333363, 1213.9833333333365, 1214.3333333333362, 1214.033333333336, 1214.433333333336, 1214.5833333333362, 1214.383333333336, 1214.1333333333366, 1213.6333333333364, 1214.2750000000035, 1214.5333333333356, 1215.0833333333362, 1215.2833333333363, 1213.383333333336, 1213.0833333333358, 1213.8833333333362, 1213.933333333336, 1214.3833333333357, 1213.8333333333367, 1214.2833333333365, 1214.1833333333357, 1213.6333333333364, 1213.7333333333365, 1214.4333333333361, 1213.7333333333368, 1213.7333333333363, 1214.2833333333358, 1213.6833333333354, 1214.633333333336, 1214.033333333336, 1214.8833333333369, 1213.683333333336, 1214.0333333333358, 1213.6333333333366, 1214.7333333333363, 1214.4333333333363, 1213.833333333336, 1213.6833333333361, 1214.183333333336, 1213.833333333337, 1213.4833333333363], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.083333333336, 1214.2333333333356, 1214.1333333333362, 1213.4833333333363, 1213.833333333336, 1215.0833333333362, 1214.3833333333357, 1213.2333333333358, 1215.1333333333357, 1213.3833333333366, 1215.0333333333363, 1213.1833333333363, 1213.083333333336, 1213.8833333333362, 1213.083333333337, 1214.933333333336, 1212.383333333336, 1214.1833333333361, 1213.5333333333358, 1214.1333333333366, 1214.4333333333361, 1213.2833333333356, 1214.9166666666697, 1213.1333333333364, 1214.8833333333364, 1213.6333333333362, 1214.1833333333363, 1213.9833333333365, 1215.5833333333367, 1215.3333333333364, 1214.1833333333354, 1213.833333333337, 1214.4833333333368, 1214.6333333333364, 1213.6833333333354, 1213.2333333333365, 1213.7833333333358, 1213.5333333333353, 1212.9833333333363, 1214.1333333333366, 1213.8833333333362, 1212.2833333333356, 1213.5833333333367, 1213.9333333333368, 1213.583333333336, 1213.1333333333366, 1213.8833333333364, 1213.4333333333363, 1214.4833333333358, 1214.783333333336, 1213.6833333333357, 1213.983333333336, 1213.8333333333367, 1214.0333333333367, 1214.4333333333366, 1214.1333333333369, 1213.9333333333363, 1213.933333333336, 1214.5333333333365, 1213.4833333333363, 1213.9833333333365, 1214.3333333333362, 1214.033333333336, 1214.433333333336, 1214.5833333333362, 1214.383333333336, 1214.1333333333366, 1213.6333333333364, 1214.2750000000035, 1214.5333333333356, 1215.0833333333362, 1215.2833333333363, 1213.383333333336, 1213.0833333333358, 1213.8833333333362, 1213.933333333336, 1214.3833333333357, 1213.8333333333367, 1214.2833333333365, 1214.1833333333357, 1213.6333333333364, 1213.7333333333365, 1214.4333333333361, 1213.7333333333368, 1213.7333333333363, 1214.2833333333358, 1213.6833333333354, 1214.633333333336, 1214.033333333336, 1214.8833333333369, 1213.683333333336, 1214.0333333333358, 1213.6333333333366, 1214.7333333333363, 1214.4333333333363, 1213.833333333336, 1213.6833333333361, 1214.183333333336, 1213.833333333337, 1213.4833333333363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24294182159775815, "mean_inference_ms": 2.069484623379732, "mean_action_processing_ms": 0.09109917315847448, "mean_env_wait_ms": 1.5417228688286395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007114887237548828, "StateBufferConnector_ms": 0.003416299819946289, "ViewRequirementAgentConnector_ms": 0.08764290809631348}, "num_episodes": 24, "episode_return_max": 1215.5833333333367, "episode_return_min": 1212.2833333333356, "episode_return_mean": 1214.0120833333362, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 427050, "num_agent_steps_trained": 426900, "num_env_steps_sampled": 427050, "num_env_steps_trained": 426900, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 237.18744020290666, "num_env_steps_trained_throughput_per_sec": 237.18744020290666, "timesteps_total": 427050, "num_env_steps_sampled_lifetime": 427050, "num_agent_steps_sampled_lifetime": 427050, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 427050, "timers": {"training_iteration_time_ms": 10343.058, "restore_workers_time_ms": 0.012, "training_step_time_ms": 622.957, "sample_time_ms": 607.807, "synch_weights_time_ms": 13.708}, "counters": {"num_env_steps_sampled": 427050, "num_env_steps_trained": 426900, "num_agent_steps_sampled": 427050, "num_agent_steps_trained": 426900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2847, "num_samples_added_to_queue": 426900}, "done": false, "training_iteration": 170, "trial_id": "27800_00000", "date": "2024-10-12_15-57-14", "timestamp": 1728745034, "time_this_iter_s": 10.129726648330688, "time_total_s": 1759.177787065506, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f2680>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1759.177787065506, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 19.166666666666664, "ram_util_percent": 66.14666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3455.44873046875, "policy_loss": 65.3760986328125, "entropy": 5.450967788696289, "entropy_coeff": 0.01, "var_gnorm": 18.055641174316406, "vf_loss": 340642.5625, "vf_explained_var": 0.6554100513458252}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1431.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 429600, "num_env_steps_trained": 429300, "num_agent_steps_sampled": 429600, "num_agent_steps_trained": 429300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2864, "num_samples_added_to_queue": 429600, "learner_queue": {"size_count": 1431, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.74, "learner_load_time_ms": 0.307, "learner_load_wait_time_ms": 1153.726, "learner_dequeue_time_ms": 10060.355}}, "env_runners": {"episode_reward_max": 1215.5833333333367, "episode_reward_min": 1212.2833333333356, "episode_reward_mean": 1214.0582500000028, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.2833333333356}, "policy_reward_max": {"default_policy": 1215.5833333333367}, "policy_reward_mean": {"default_policy": 1214.0582500000028}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.9030000000000001, "num_moves_min": 0.71, "num_moves_max": 1.14, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0008, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.1628445, "num_slav_min": 0.16183333333333333, "num_slav_max": 0.16403333333333336, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5420614845330024, "mean_cluster_cpu_util_min": 0.5387690407243979, "mean_cluster_cpu_util_max": 0.5459707896672182, "mean_cluster_mem_util_mean": 0.34163755801687773, "mean_cluster_mem_util_min": 0.34119303797468353, "mean_cluster_mem_util_max": 0.34198206751054855, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4426675, "reward_sla_mean_min": -2.4605, "reward_sla_mean_max": -2.4275, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.26675, "reward_sla_sum_min": -246.05, "reward_sla_sum_max": -242.75, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2431.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.9833333333365, 1215.5833333333367, 1215.3333333333364, 1214.1833333333354, 1213.833333333337, 1214.4833333333368, 1214.6333333333364, 1213.6833333333354, 1213.2333333333365, 1213.7833333333358, 1213.5333333333353, 1212.9833333333363, 1214.1333333333366, 1213.8833333333362, 1212.2833333333356, 1213.5833333333367, 1213.9333333333368, 1213.583333333336, 1213.1333333333366, 1213.8833333333364, 1213.4333333333363, 1214.4833333333358, 1214.783333333336, 1213.6833333333357, 1213.983333333336, 1213.8333333333367, 1214.0333333333367, 1214.4333333333366, 1214.1333333333369, 1213.9333333333363, 1213.933333333336, 1214.5333333333365, 1213.4833333333363, 1213.9833333333365, 1214.3333333333362, 1214.033333333336, 1214.433333333336, 1214.5833333333362, 1214.383333333336, 1214.1333333333366, 1213.6333333333364, 1214.2750000000035, 1214.5333333333356, 1215.0833333333362, 1215.2833333333363, 1213.383333333336, 1213.0833333333358, 1213.8833333333362, 1213.933333333336, 1214.3833333333357, 1213.8333333333367, 1214.2833333333365, 1214.1833333333357, 1213.6333333333364, 1213.7333333333365, 1214.4333333333361, 1213.7333333333368, 1213.7333333333363, 1214.2833333333358, 1213.6833333333354, 1214.633333333336, 1214.033333333336, 1214.8833333333369, 1213.683333333336, 1214.0333333333358, 1213.6333333333366, 1214.7333333333363, 1214.4333333333363, 1213.833333333336, 1213.6833333333361, 1214.183333333336, 1213.833333333337, 1213.4833333333363, 1214.5333333333363, 1214.5333333333363, 1213.8333333333364, 1214.7833333333365, 1214.3333333333364, 1213.733333333336, 1215.2333333333358, 1214.4833333333368, 1213.833333333336, 1214.2833333333358, 1213.983333333336, 1214.2833333333358, 1214.1833333333363, 1214.8333333333367, 1214.5333333333353, 1213.3333333333358, 1214.433333333337, 1213.1833333333368, 1215.0833333333362, 1213.2833333333367, 1213.483333333337, 1213.233333333336, 1213.9833333333358, 1214.033333333336, 1214.7833333333363, 1213.5333333333365, 1213.7333333333354], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.9833333333365, 1215.5833333333367, 1215.3333333333364, 1214.1833333333354, 1213.833333333337, 1214.4833333333368, 1214.6333333333364, 1213.6833333333354, 1213.2333333333365, 1213.7833333333358, 1213.5333333333353, 1212.9833333333363, 1214.1333333333366, 1213.8833333333362, 1212.2833333333356, 1213.5833333333367, 1213.9333333333368, 1213.583333333336, 1213.1333333333366, 1213.8833333333364, 1213.4333333333363, 1214.4833333333358, 1214.783333333336, 1213.6833333333357, 1213.983333333336, 1213.8333333333367, 1214.0333333333367, 1214.4333333333366, 1214.1333333333369, 1213.9333333333363, 1213.933333333336, 1214.5333333333365, 1213.4833333333363, 1213.9833333333365, 1214.3333333333362, 1214.033333333336, 1214.433333333336, 1214.5833333333362, 1214.383333333336, 1214.1333333333366, 1213.6333333333364, 1214.2750000000035, 1214.5333333333356, 1215.0833333333362, 1215.2833333333363, 1213.383333333336, 1213.0833333333358, 1213.8833333333362, 1213.933333333336, 1214.3833333333357, 1213.8333333333367, 1214.2833333333365, 1214.1833333333357, 1213.6333333333364, 1213.7333333333365, 1214.4333333333361, 1213.7333333333368, 1213.7333333333363, 1214.2833333333358, 1213.6833333333354, 1214.633333333336, 1214.033333333336, 1214.8833333333369, 1213.683333333336, 1214.0333333333358, 1213.6333333333366, 1214.7333333333363, 1214.4333333333363, 1213.833333333336, 1213.6833333333361, 1214.183333333336, 1213.833333333337, 1213.4833333333363, 1214.5333333333363, 1214.5333333333363, 1213.8333333333364, 1214.7833333333365, 1214.3333333333364, 1213.733333333336, 1215.2333333333358, 1214.4833333333368, 1213.833333333336, 1214.2833333333358, 1213.983333333336, 1214.2833333333358, 1214.1833333333363, 1214.8333333333367, 1214.5333333333353, 1213.3333333333358, 1214.433333333337, 1213.1833333333368, 1215.0833333333362, 1213.2833333333367, 1213.483333333337, 1213.233333333336, 1213.9833333333358, 1214.033333333336, 1214.7833333333363, 1213.5333333333365, 1213.7333333333354]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24302548601328552, "mean_inference_ms": 2.0720174656392545, "mean_action_processing_ms": 0.09113092731078722, "mean_env_wait_ms": 1.5424956438029447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007016658782958984, "StateBufferConnector_ms": 0.0033941268920898438, "ViewRequirementAgentConnector_ms": 0.08689451217651367}, "num_episodes": 27, "episode_return_max": 1215.5833333333367, "episode_return_min": 1212.2833333333356, "episode_return_mean": 1214.0582500000028, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 429600, "num_agent_steps_trained": 429300, "num_env_steps_sampled": 429600, "num_env_steps_trained": 429300, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 246.38449865067, "num_env_steps_trained_throughput_per_sec": 231.8912928476894, "timesteps_total": 429600, "num_env_steps_sampled_lifetime": 429600, "num_agent_steps_sampled_lifetime": 429600, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 429600, "timers": {"training_iteration_time_ms": 10346.819, "restore_workers_time_ms": 0.013, "training_step_time_ms": 613.9, "sample_time_ms": 598.728, "synch_weights_time_ms": 13.686}, "counters": {"num_env_steps_sampled": 429600, "num_env_steps_trained": 429300, "num_agent_steps_sampled": 429600, "num_agent_steps_trained": 429300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2864, "num_samples_added_to_queue": 429600}, "done": false, "training_iteration": 171, "trial_id": "27800_00000", "date": "2024-10-12_15-57-24", "timestamp": 1728745044, "time_this_iter_s": 10.359337568283081, "time_total_s": 1769.537124633789, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d44820>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1769.537124633789, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 15.893333333333333, "ram_util_percent": 65.22666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 5565.2919921875, "policy_loss": 1976.0509033203125, "entropy": 5.292809009552002, "entropy_coeff": 0.01, "var_gnorm": 18.05487632751465, "vf_loss": 360511.9375, "vf_explained_var": 0.6447923183441162}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1440.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 432300, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432300, "num_agent_steps_trained": 432000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2882, "num_samples_added_to_queue": 432300, "learner_queue": {"size_count": 1440, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.705, "learner_load_time_ms": 0.297, "learner_load_wait_time_ms": 1105.448, "learner_dequeue_time_ms": 9936.436}}, "env_runners": {"episode_reward_max": 1215.4833333333363, "episode_reward_min": 1212.8333333333367, "episode_reward_mean": 1214.0898333333362, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.8333333333367}, "policy_reward_max": {"default_policy": 1215.4833333333363}, "policy_reward_mean": {"default_policy": 1214.0898333333362}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.8865999999999998, "num_moves_min": 0.63, "num_moves_max": 1.14, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63966666666667, "num_model_switches_mean": 0.0004, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.162829, "num_slav_min": 0.16190000000000002, "num_slav_max": 0.16415000000000002, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5428100471134399, "mean_cluster_cpu_util_min": 0.5396767903107189, "mean_cluster_cpu_util_max": 0.5465002298216584, "mean_cluster_mem_util_mean": 0.3416336075949368, "mean_cluster_mem_util_min": 0.34119303797468353, "mean_cluster_mem_util_max": 0.34198206751054855, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.33333333333336, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.341666666666695, "reward_sla_mean_mean": -2.4424349999999997, "reward_sla_mean_min": -2.46225, "reward_sla_mean_max": -2.4284999999999997, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 834.1666666666695, "reward_sla_sum_mean": -244.24349999999998, "reward_sla_sum_min": -246.225, "reward_sla_sum_max": -242.84999999999997, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2082.0, "global_timestep_min": 400, "global_timestep_max": 3700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.4333333333366, 1214.1333333333369, 1213.9333333333363, 1213.933333333336, 1214.5333333333365, 1213.4833333333363, 1213.9833333333365, 1214.3333333333362, 1214.033333333336, 1214.433333333336, 1214.5833333333362, 1214.383333333336, 1214.1333333333366, 1213.6333333333364, 1214.2750000000035, 1214.5333333333356, 1215.0833333333362, 1215.2833333333363, 1213.383333333336, 1213.0833333333358, 1213.8833333333362, 1213.933333333336, 1214.3833333333357, 1213.8333333333367, 1214.2833333333365, 1214.1833333333357, 1213.6333333333364, 1213.7333333333365, 1214.4333333333361, 1213.7333333333368, 1213.7333333333363, 1214.2833333333358, 1213.6833333333354, 1214.633333333336, 1214.033333333336, 1214.8833333333369, 1213.683333333336, 1214.0333333333358, 1213.6333333333366, 1214.7333333333363, 1214.4333333333363, 1213.833333333336, 1213.6833333333361, 1214.183333333336, 1213.833333333337, 1213.4833333333363, 1214.5333333333363, 1214.5333333333363, 1213.8333333333364, 1214.7833333333365, 1214.3333333333364, 1213.733333333336, 1215.2333333333358, 1214.4833333333368, 1213.833333333336, 1214.2833333333358, 1213.983333333336, 1214.2833333333358, 1214.1833333333363, 1214.8333333333367, 1214.5333333333353, 1213.3333333333358, 1214.433333333337, 1213.1833333333368, 1215.0833333333362, 1213.2833333333367, 1213.483333333337, 1213.233333333336, 1213.9833333333358, 1214.033333333336, 1214.7833333333363, 1213.5333333333365, 1213.7333333333354, 1215.1333333333364, 1215.1833333333361, 1213.833333333336, 1213.133333333336, 1214.3833333333364, 1213.9333333333361, 1214.4833333333358, 1213.3833333333364, 1213.5333333333363, 1215.0333333333363, 1212.9416666666693, 1213.9333333333366, 1214.2333333333365, 1214.4833333333368, 1214.2833333333358, 1214.033333333336, 1213.733333333336, 1213.8833333333362, 1215.4833333333363, 1213.4333333333361, 1213.9333333333363, 1214.8333333333358, 1212.8333333333367, 1214.0833333333364, 1214.0833333333362, 1213.6333333333366, 1213.1833333333363], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.4333333333366, 1214.1333333333369, 1213.9333333333363, 1213.933333333336, 1214.5333333333365, 1213.4833333333363, 1213.9833333333365, 1214.3333333333362, 1214.033333333336, 1214.433333333336, 1214.5833333333362, 1214.383333333336, 1214.1333333333366, 1213.6333333333364, 1214.2750000000035, 1214.5333333333356, 1215.0833333333362, 1215.2833333333363, 1213.383333333336, 1213.0833333333358, 1213.8833333333362, 1213.933333333336, 1214.3833333333357, 1213.8333333333367, 1214.2833333333365, 1214.1833333333357, 1213.6333333333364, 1213.7333333333365, 1214.4333333333361, 1213.7333333333368, 1213.7333333333363, 1214.2833333333358, 1213.6833333333354, 1214.633333333336, 1214.033333333336, 1214.8833333333369, 1213.683333333336, 1214.0333333333358, 1213.6333333333366, 1214.7333333333363, 1214.4333333333363, 1213.833333333336, 1213.6833333333361, 1214.183333333336, 1213.833333333337, 1213.4833333333363, 1214.5333333333363, 1214.5333333333363, 1213.8333333333364, 1214.7833333333365, 1214.3333333333364, 1213.733333333336, 1215.2333333333358, 1214.4833333333368, 1213.833333333336, 1214.2833333333358, 1213.983333333336, 1214.2833333333358, 1214.1833333333363, 1214.8333333333367, 1214.5333333333353, 1213.3333333333358, 1214.433333333337, 1213.1833333333368, 1215.0833333333362, 1213.2833333333367, 1213.483333333337, 1213.233333333336, 1213.9833333333358, 1214.033333333336, 1214.7833333333363, 1213.5333333333365, 1213.7333333333354, 1215.1333333333364, 1215.1833333333361, 1213.833333333336, 1213.133333333336, 1214.3833333333364, 1213.9333333333361, 1214.4833333333358, 1213.3833333333364, 1213.5333333333363, 1215.0333333333363, 1212.9416666666693, 1213.9333333333366, 1214.2333333333365, 1214.4833333333368, 1214.2833333333358, 1214.033333333336, 1213.733333333336, 1213.8833333333362, 1215.4833333333363, 1213.4333333333361, 1213.9333333333363, 1214.8333333333358, 1212.8333333333367, 1214.0833333333364, 1214.0833333333362, 1213.6333333333366, 1213.1833333333363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.242974048375888, "mean_inference_ms": 2.070368591612766, "mean_action_processing_ms": 0.09110464470644111, "mean_env_wait_ms": 1.5420501165847476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006411552429199219, "StateBufferConnector_ms": 0.003254413604736328, "ViewRequirementAgentConnector_ms": 0.08372640609741211}, "num_episodes": 27, "episode_return_max": 1215.4833333333363, "episode_return_min": 1212.8333333333367, "episode_return_mean": 1214.0898333333362, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432300, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432300, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 257.04147095017487, "num_env_steps_trained_throughput_per_sec": 257.04147095017487, "timesteps_total": 432300, "num_env_steps_sampled_lifetime": 432300, "num_agent_steps_sampled_lifetime": 432300, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 432300, "timers": {"training_iteration_time_ms": 10357.568, "restore_workers_time_ms": 0.014, "training_step_time_ms": 575.239, "sample_time_ms": 559.814, "synch_weights_time_ms": 13.823}, "counters": {"num_env_steps_sampled": 432300, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432300, "num_agent_steps_trained": 432000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2882, "num_samples_added_to_queue": 432300}, "done": false, "training_iteration": 172, "trial_id": "27800_00000", "date": "2024-10-12_15-57-35", "timestamp": 1728745055, "time_this_iter_s": 10.517228126525879, "time_total_s": 1780.054352760315, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f683a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1780.054352760315, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 15.520000000000003, "ram_util_percent": 64.88}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4149.78564453125, "policy_loss": 618.5548706054688, "entropy": 5.152869701385498, "entropy_coeff": 0.01, "var_gnorm": 18.0571231842041, "vf_loss": 354668.9375, "vf_explained_var": 0.646567702293396}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1448.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 434550, "num_env_steps_trained": 434400, "num_agent_steps_sampled": 434550, "num_agent_steps_trained": 434400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2897, "num_samples_added_to_queue": 434400, "learner_queue": {"size_count": 1448, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.861, "learner_load_time_ms": 0.297, "learner_load_wait_time_ms": 1266.693, "learner_dequeue_time_ms": 9936.436}}, "env_runners": {"episode_reward_max": 1215.4833333333363, "episode_reward_min": 1212.6333333333357, "episode_reward_mean": 1214.035833333336, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.6333333333357}, "policy_reward_max": {"default_policy": 1215.4833333333363}, "policy_reward_mean": {"default_policy": 1214.035833333336}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.8360999999999998, "num_moves_min": 0.46, "num_moves_max": 1.08, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63966666666667, "num_model_switches_mean": 0.0004, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16286500000000004, "num_slav_min": 0.16190000000000002, "num_slav_max": 0.16415000000000002, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5437091789621253, "mean_cluster_cpu_util_min": 0.5398701852362566, "mean_cluster_cpu_util_max": 0.5472974351902924, "mean_cluster_mem_util_mean": 0.3416480696202532, "mean_cluster_mem_util_min": 0.34119303797468353, "mean_cluster_mem_util_max": 0.34198206751054855, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.33333333333336, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.341666666666695, "reward_sla_mean_mean": -2.4429749999999997, "reward_sla_mean_min": -2.46225, "reward_sla_mean_max": -2.4284999999999997, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 834.1666666666695, "reward_sla_sum_mean": -244.2975, "reward_sla_sum_min": -246.225, "reward_sla_sum_max": -242.84999999999997, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2783.0, "global_timestep_min": 1100, "global_timestep_max": 4400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.933333333336, 1214.3833333333357, 1213.8333333333367, 1214.2833333333365, 1214.1833333333357, 1213.6333333333364, 1213.7333333333365, 1214.4333333333361, 1213.7333333333368, 1213.7333333333363, 1214.2833333333358, 1213.6833333333354, 1214.633333333336, 1214.033333333336, 1214.8833333333369, 1213.683333333336, 1214.0333333333358, 1213.6333333333366, 1214.7333333333363, 1214.4333333333363, 1213.833333333336, 1213.6833333333361, 1214.183333333336, 1213.833333333337, 1213.4833333333363, 1214.5333333333363, 1214.5333333333363, 1213.8333333333364, 1214.7833333333365, 1214.3333333333364, 1213.733333333336, 1215.2333333333358, 1214.4833333333368, 1213.833333333336, 1214.2833333333358, 1213.983333333336, 1214.2833333333358, 1214.1833333333363, 1214.8333333333367, 1214.5333333333353, 1213.3333333333358, 1214.433333333337, 1213.1833333333368, 1215.0833333333362, 1213.2833333333367, 1213.483333333337, 1213.233333333336, 1213.9833333333358, 1214.033333333336, 1214.7833333333363, 1213.5333333333365, 1213.7333333333354, 1215.1333333333364, 1215.1833333333361, 1213.833333333336, 1213.133333333336, 1214.3833333333364, 1213.9333333333361, 1214.4833333333358, 1213.3833333333364, 1213.5333333333363, 1215.0333333333363, 1212.9416666666693, 1213.9333333333366, 1214.2333333333365, 1214.4833333333368, 1214.2833333333358, 1214.033333333336, 1213.733333333336, 1213.8833333333362, 1215.4833333333363, 1213.4333333333361, 1213.9333333333363, 1214.8333333333358, 1212.8333333333367, 1214.0833333333364, 1214.0833333333362, 1213.6333333333366, 1213.1833333333363, 1214.3833333333362, 1213.233333333336, 1214.2250000000022, 1213.583333333336, 1214.5833333333364, 1214.6333333333366, 1213.683333333336, 1214.0333333333363, 1212.6333333333357, 1214.1833333333363, 1213.633333333336, 1213.8333333333367, 1213.5333333333358, 1213.3333333333367, 1215.3333333333362, 1214.3333333333362, 1213.783333333337, 1212.933333333336, 1214.033333333336, 1214.1833333333361, 1213.9833333333358], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.933333333336, 1214.3833333333357, 1213.8333333333367, 1214.2833333333365, 1214.1833333333357, 1213.6333333333364, 1213.7333333333365, 1214.4333333333361, 1213.7333333333368, 1213.7333333333363, 1214.2833333333358, 1213.6833333333354, 1214.633333333336, 1214.033333333336, 1214.8833333333369, 1213.683333333336, 1214.0333333333358, 1213.6333333333366, 1214.7333333333363, 1214.4333333333363, 1213.833333333336, 1213.6833333333361, 1214.183333333336, 1213.833333333337, 1213.4833333333363, 1214.5333333333363, 1214.5333333333363, 1213.8333333333364, 1214.7833333333365, 1214.3333333333364, 1213.733333333336, 1215.2333333333358, 1214.4833333333368, 1213.833333333336, 1214.2833333333358, 1213.983333333336, 1214.2833333333358, 1214.1833333333363, 1214.8333333333367, 1214.5333333333353, 1213.3333333333358, 1214.433333333337, 1213.1833333333368, 1215.0833333333362, 1213.2833333333367, 1213.483333333337, 1213.233333333336, 1213.9833333333358, 1214.033333333336, 1214.7833333333363, 1213.5333333333365, 1213.7333333333354, 1215.1333333333364, 1215.1833333333361, 1213.833333333336, 1213.133333333336, 1214.3833333333364, 1213.9333333333361, 1214.4833333333358, 1213.3833333333364, 1213.5333333333363, 1215.0333333333363, 1212.9416666666693, 1213.9333333333366, 1214.2333333333365, 1214.4833333333368, 1214.2833333333358, 1214.033333333336, 1213.733333333336, 1213.8833333333362, 1215.4833333333363, 1213.4333333333361, 1213.9333333333363, 1214.8333333333358, 1212.8333333333367, 1214.0833333333364, 1214.0833333333362, 1213.6333333333366, 1213.1833333333363, 1214.3833333333362, 1213.233333333336, 1214.2250000000022, 1213.583333333336, 1214.5833333333364, 1214.6333333333366, 1213.683333333336, 1214.0333333333363, 1212.6333333333357, 1214.1833333333363, 1213.633333333336, 1213.8333333333367, 1213.5333333333358, 1213.3333333333367, 1215.3333333333362, 1214.3333333333362, 1213.783333333337, 1212.933333333336, 1214.033333333336, 1214.1833333333361, 1213.9833333333358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2430274851264748, "mean_inference_ms": 2.072244065507914, "mean_action_processing_ms": 0.09112605633638424, "mean_env_wait_ms": 1.542526734502719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006571292877197266, "StateBufferConnector_ms": 0.0034296512603759766, "ViewRequirementAgentConnector_ms": 0.08802390098571777}, "num_episodes": 21, "episode_return_max": 1215.4833333333363, "episode_return_min": 1212.6333333333357, "episode_return_mean": 1214.035833333336, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 434550, "num_agent_steps_trained": 434400, "num_env_steps_sampled": 434550, "num_env_steps_trained": 434400, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 213.91387782575526, "num_env_steps_trained_throughput_per_sec": 228.17480301413897, "timesteps_total": 434550, "num_env_steps_sampled_lifetime": 434550, "num_agent_steps_sampled_lifetime": 434550, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 434550, "timers": {"training_iteration_time_ms": 10370.004, "restore_workers_time_ms": 0.014, "training_step_time_ms": 649.755, "sample_time_ms": 633.996, "synch_weights_time_ms": 14.289}, "counters": {"num_env_steps_sampled": 434550, "num_env_steps_trained": 434400, "num_agent_steps_sampled": 434550, "num_agent_steps_trained": 434400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2897, "num_samples_added_to_queue": 434400}, "done": false, "training_iteration": 173, "trial_id": "27800_00000", "date": "2024-10-12_15-57-46", "timestamp": 1728745066, "time_this_iter_s": 10.53039836883545, "time_total_s": 1790.5847511291504, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d44d30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1790.5847511291504, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 23.973333333333333, "ram_util_percent": 66.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3954.39599609375, "policy_loss": 284.875244140625, "entropy": 5.005941867828369, "entropy_coeff": 0.01, "var_gnorm": 18.063396453857422, "vf_loss": 368453.875, "vf_explained_var": 0.6416012048721313}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1456.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 437100, "num_env_steps_trained": 436800, "num_agent_steps_sampled": 437100, "num_agent_steps_trained": 436800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2914, "num_samples_added_to_queue": 437100, "learner_queue": {"size_count": 1456, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.505, "learner_load_time_ms": 0.249, "learner_load_wait_time_ms": 1159.707, "learner_dequeue_time_ms": 10060.241}}, "env_runners": {"episode_reward_max": 1215.7333333333365, "episode_reward_min": 1212.6333333333357, "episode_reward_mean": 1214.032333333336, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.6333333333357}, "policy_reward_max": {"default_policy": 1215.7333333333365}, "policy_reward_mean": {"default_policy": 1214.032333333336}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.7215000000000003, "num_moves_min": 0.31, "num_moves_max": 1.08, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63966666666667, "num_model_switches_mean": 0.0004, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16286733333333334, "num_slav_min": 0.1617333333333333, "num_slav_max": 0.16415000000000002, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.544845152027027, "mean_cluster_cpu_util_min": 0.5414937718330576, "mean_cluster_cpu_util_max": 0.5480942728442729, "mean_cluster_mem_util_mean": 0.3416540506329113, "mean_cluster_mem_util_min": 0.3413016877637131, "mean_cluster_mem_util_max": 0.34197468354430377, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.33333333333336, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.341666666666695, "reward_sla_mean_mean": -2.4430099999999997, "reward_sla_mean_min": -2.46225, "reward_sla_mean_max": -2.426, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 834.1666666666695, "reward_sla_sum_mean": -244.301, "reward_sla_sum_min": -246.225, "reward_sla_sum_max": -242.60000000000002, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3682.0, "global_timestep_min": 2000, "global_timestep_max": 5300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.8333333333364, 1214.7833333333365, 1214.3333333333364, 1213.733333333336, 1215.2333333333358, 1214.4833333333368, 1213.833333333336, 1214.2833333333358, 1213.983333333336, 1214.2833333333358, 1214.1833333333363, 1214.8333333333367, 1214.5333333333353, 1213.3333333333358, 1214.433333333337, 1213.1833333333368, 1215.0833333333362, 1213.2833333333367, 1213.483333333337, 1213.233333333336, 1213.9833333333358, 1214.033333333336, 1214.7833333333363, 1213.5333333333365, 1213.7333333333354, 1215.1333333333364, 1215.1833333333361, 1213.833333333336, 1213.133333333336, 1214.3833333333364, 1213.9333333333361, 1214.4833333333358, 1213.3833333333364, 1213.5333333333363, 1215.0333333333363, 1212.9416666666693, 1213.9333333333366, 1214.2333333333365, 1214.4833333333368, 1214.2833333333358, 1214.033333333336, 1213.733333333336, 1213.8833333333362, 1215.4833333333363, 1213.4333333333361, 1213.9333333333363, 1214.8333333333358, 1212.8333333333367, 1214.0833333333364, 1214.0833333333362, 1213.6333333333366, 1213.1833333333363, 1214.3833333333362, 1213.233333333336, 1214.2250000000022, 1213.583333333336, 1214.5833333333364, 1214.6333333333366, 1213.683333333336, 1214.0333333333363, 1212.6333333333357, 1214.1833333333363, 1213.633333333336, 1213.8333333333367, 1213.5333333333358, 1213.3333333333367, 1215.3333333333362, 1214.3333333333362, 1213.783333333337, 1212.933333333336, 1214.033333333336, 1214.1833333333361, 1213.9833333333358, 1213.3833333333362, 1214.7833333333365, 1213.9833333333358, 1213.6833333333357, 1214.2333333333363, 1213.2333333333363, 1214.1833333333368, 1214.333333333336, 1214.5833333333364, 1213.6833333333363, 1214.0833333333364, 1214.283333333337, 1213.0833333333362, 1214.133333333336, 1213.8833333333357, 1213.4833333333365, 1214.1333333333369, 1214.283333333336, 1214.5833333333364, 1215.4333333333366, 1214.8833333333369, 1213.7333333333365, 1212.8333333333358, 1214.6333333333362, 1215.7333333333365, 1212.6333333333362, 1213.7333333333363], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.8333333333364, 1214.7833333333365, 1214.3333333333364, 1213.733333333336, 1215.2333333333358, 1214.4833333333368, 1213.833333333336, 1214.2833333333358, 1213.983333333336, 1214.2833333333358, 1214.1833333333363, 1214.8333333333367, 1214.5333333333353, 1213.3333333333358, 1214.433333333337, 1213.1833333333368, 1215.0833333333362, 1213.2833333333367, 1213.483333333337, 1213.233333333336, 1213.9833333333358, 1214.033333333336, 1214.7833333333363, 1213.5333333333365, 1213.7333333333354, 1215.1333333333364, 1215.1833333333361, 1213.833333333336, 1213.133333333336, 1214.3833333333364, 1213.9333333333361, 1214.4833333333358, 1213.3833333333364, 1213.5333333333363, 1215.0333333333363, 1212.9416666666693, 1213.9333333333366, 1214.2333333333365, 1214.4833333333368, 1214.2833333333358, 1214.033333333336, 1213.733333333336, 1213.8833333333362, 1215.4833333333363, 1213.4333333333361, 1213.9333333333363, 1214.8333333333358, 1212.8333333333367, 1214.0833333333364, 1214.0833333333362, 1213.6333333333366, 1213.1833333333363, 1214.3833333333362, 1213.233333333336, 1214.2250000000022, 1213.583333333336, 1214.5833333333364, 1214.6333333333366, 1213.683333333336, 1214.0333333333363, 1212.6333333333357, 1214.1833333333363, 1213.633333333336, 1213.8333333333367, 1213.5333333333358, 1213.3333333333367, 1215.3333333333362, 1214.3333333333362, 1213.783333333337, 1212.933333333336, 1214.033333333336, 1214.1833333333361, 1213.9833333333358, 1213.3833333333362, 1214.7833333333365, 1213.9833333333358, 1213.6833333333357, 1214.2333333333363, 1213.2333333333363, 1214.1833333333368, 1214.333333333336, 1214.5833333333364, 1213.6833333333363, 1214.0833333333364, 1214.283333333337, 1213.0833333333362, 1214.133333333336, 1213.8833333333357, 1213.4833333333365, 1214.1333333333369, 1214.283333333336, 1214.5833333333364, 1215.4333333333366, 1214.8833333333369, 1213.7333333333365, 1212.8333333333358, 1214.6333333333362, 1215.7333333333365, 1212.6333333333362, 1213.7333333333363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24300100822616802, "mean_inference_ms": 2.070794382702593, "mean_action_processing_ms": 0.09110633224453984, "mean_env_wait_ms": 1.542172467388537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062825679779052734, "StateBufferConnector_ms": 0.003335714340209961, "ViewRequirementAgentConnector_ms": 0.08519840240478516}, "num_episodes": 27, "episode_return_max": 1215.7333333333365, "episode_return_min": 1212.6333333333357, "episode_return_mean": 1214.032333333336, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 437100, "num_agent_steps_trained": 436800, "num_env_steps_sampled": 437100, "num_env_steps_trained": 436800, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 248.2282915552774, "num_env_steps_trained_throughput_per_sec": 233.6266273461434, "timesteps_total": 437100, "num_env_steps_sampled_lifetime": 437100, "num_agent_steps_sampled_lifetime": 437100, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 437100, "timers": {"training_iteration_time_ms": 10363.603, "restore_workers_time_ms": 0.012, "training_step_time_ms": 587.035, "sample_time_ms": 572.067, "synch_weights_time_ms": 13.411}, "counters": {"num_env_steps_sampled": 437100, "num_env_steps_trained": 436800, "num_agent_steps_sampled": 437100, "num_agent_steps_trained": 436800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2914, "num_samples_added_to_queue": 437100}, "done": false, "training_iteration": 174, "trial_id": "27800_00000", "date": "2024-10-12_15-57-56", "timestamp": 1728745076, "time_this_iter_s": 10.283653974533081, "time_total_s": 1800.8684051036835, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f25c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1800.8684051036835, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 15.98571428571429, "ram_util_percent": 66.07142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3130.206298828125, "policy_loss": -652.295166015625, "entropy": 4.913981914520264, "entropy_coeff": 0.01, "var_gnorm": 18.070634841918945, "vf_loss": 379724.34375, "vf_explained_var": 0.6389560699462891}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1465.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 439650, "num_env_steps_trained": 439500, "num_agent_steps_sampled": 439650, "num_agent_steps_trained": 439500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2931, "num_samples_added_to_queue": 439500, "learner_queue": {"size_count": 1465, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.851, "learner_load_time_ms": 0.229, "learner_load_wait_time_ms": 1131.628, "learner_dequeue_time_ms": 10051.254}}, "env_runners": {"episode_reward_max": 1215.7333333333365, "episode_reward_min": 1212.6333333333357, "episode_reward_mean": 1214.047750000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.6333333333357}, "policy_reward_max": {"default_policy": 1215.7333333333365}, "policy_reward_mean": {"default_policy": 1214.047750000003}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.5977999999999999, "num_moves_min": 0.27, "num_moves_max": 0.93, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63966666666667, "num_model_switches_mean": 0.0006, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.1628515, "num_slav_min": 0.1615833333333333, "num_slav_max": 0.16415000000000002, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5452047614451185, "mean_cluster_cpu_util_min": 0.5414937718330576, "mean_cluster_cpu_util_max": 0.5480942728442729, "mean_cluster_mem_util_mean": 0.3416452056962026, "mean_cluster_mem_util_min": 0.3413016877637131, "mean_cluster_mem_util_max": 0.34197468354430377, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.341666666666695, "reward_sla_mean_mean": -2.4427725, "reward_sla_mean_min": -2.46225, "reward_sla_mean_max": -2.42375, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 834.1666666666695, "reward_sla_sum_mean": -244.27724999999998, "reward_sla_sum_min": -246.225, "reward_sla_sum_max": -242.375, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4483.0, "global_timestep_min": 2800, "global_timestep_max": 6100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.7333333333354, 1215.1333333333364, 1215.1833333333361, 1213.833333333336, 1213.133333333336, 1214.3833333333364, 1213.9333333333361, 1214.4833333333358, 1213.3833333333364, 1213.5333333333363, 1215.0333333333363, 1212.9416666666693, 1213.9333333333366, 1214.2333333333365, 1214.4833333333368, 1214.2833333333358, 1214.033333333336, 1213.733333333336, 1213.8833333333362, 1215.4833333333363, 1213.4333333333361, 1213.9333333333363, 1214.8333333333358, 1212.8333333333367, 1214.0833333333364, 1214.0833333333362, 1213.6333333333366, 1213.1833333333363, 1214.3833333333362, 1213.233333333336, 1214.2250000000022, 1213.583333333336, 1214.5833333333364, 1214.6333333333366, 1213.683333333336, 1214.0333333333363, 1212.6333333333357, 1214.1833333333363, 1213.633333333336, 1213.8333333333367, 1213.5333333333358, 1213.3333333333367, 1215.3333333333362, 1214.3333333333362, 1213.783333333337, 1212.933333333336, 1214.033333333336, 1214.1833333333361, 1213.9833333333358, 1213.3833333333362, 1214.7833333333365, 1213.9833333333358, 1213.6833333333357, 1214.2333333333363, 1213.2333333333363, 1214.1833333333368, 1214.333333333336, 1214.5833333333364, 1213.6833333333363, 1214.0833333333364, 1214.283333333337, 1213.0833333333362, 1214.133333333336, 1213.8833333333357, 1213.4833333333365, 1214.1333333333369, 1214.283333333336, 1214.5833333333364, 1215.4333333333366, 1214.8833333333369, 1213.7333333333365, 1212.8333333333358, 1214.6333333333362, 1215.7333333333365, 1212.6333333333362, 1213.7333333333363, 1214.7333333333356, 1213.633333333336, 1213.0333333333365, 1214.533333333336, 1215.125000000003, 1213.8333333333362, 1214.3833333333362, 1215.1833333333361, 1214.3833333333357, 1214.2833333333363, 1214.9333333333361, 1214.0833333333367, 1213.2833333333358, 1213.833333333336, 1213.9333333333357, 1213.0833333333367, 1213.0333333333363, 1214.0833333333364, 1214.7833333333363, 1213.9833333333354, 1214.8333333333362, 1213.9333333333361, 1214.0833333333362, 1215.2333333333365], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.7333333333354, 1215.1333333333364, 1215.1833333333361, 1213.833333333336, 1213.133333333336, 1214.3833333333364, 1213.9333333333361, 1214.4833333333358, 1213.3833333333364, 1213.5333333333363, 1215.0333333333363, 1212.9416666666693, 1213.9333333333366, 1214.2333333333365, 1214.4833333333368, 1214.2833333333358, 1214.033333333336, 1213.733333333336, 1213.8833333333362, 1215.4833333333363, 1213.4333333333361, 1213.9333333333363, 1214.8333333333358, 1212.8333333333367, 1214.0833333333364, 1214.0833333333362, 1213.6333333333366, 1213.1833333333363, 1214.3833333333362, 1213.233333333336, 1214.2250000000022, 1213.583333333336, 1214.5833333333364, 1214.6333333333366, 1213.683333333336, 1214.0333333333363, 1212.6333333333357, 1214.1833333333363, 1213.633333333336, 1213.8333333333367, 1213.5333333333358, 1213.3333333333367, 1215.3333333333362, 1214.3333333333362, 1213.783333333337, 1212.933333333336, 1214.033333333336, 1214.1833333333361, 1213.9833333333358, 1213.3833333333362, 1214.7833333333365, 1213.9833333333358, 1213.6833333333357, 1214.2333333333363, 1213.2333333333363, 1214.1833333333368, 1214.333333333336, 1214.5833333333364, 1213.6833333333363, 1214.0833333333364, 1214.283333333337, 1213.0833333333362, 1214.133333333336, 1213.8833333333357, 1213.4833333333365, 1214.1333333333369, 1214.283333333336, 1214.5833333333364, 1215.4333333333366, 1214.8833333333369, 1213.7333333333365, 1212.8333333333358, 1214.6333333333362, 1215.7333333333365, 1212.6333333333362, 1213.7333333333363, 1214.7333333333356, 1213.633333333336, 1213.0333333333365, 1214.533333333336, 1215.125000000003, 1213.8333333333362, 1214.3833333333362, 1215.1833333333361, 1214.3833333333357, 1214.2833333333363, 1214.9333333333361, 1214.0833333333367, 1213.2833333333358, 1213.833333333336, 1213.9333333333357, 1213.0833333333367, 1213.0333333333363, 1214.0833333333364, 1214.7833333333363, 1213.9833333333354, 1214.8333333333362, 1213.9333333333361, 1214.0833333333362, 1215.2333333333365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24304906621296177, "mean_inference_ms": 2.072450625911911, "mean_action_processing_ms": 0.09112455207014503, "mean_env_wait_ms": 1.5425839353640824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006352901458740234, "StateBufferConnector_ms": 0.003367185592651367, "ViewRequirementAgentConnector_ms": 0.08584022521972656}, "num_episodes": 24, "episode_return_max": 1215.7333333333365, "episode_return_min": 1212.6333333333357, "episode_return_mean": 1214.047750000003, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 439650, "num_agent_steps_trained": 439500, "num_env_steps_sampled": 439650, "num_env_steps_trained": 439500, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 248.91526407188474, "num_env_steps_trained_throughput_per_sec": 263.5573384290544, "timesteps_total": 439650, "num_env_steps_sampled_lifetime": 439650, "num_agent_steps_sampled_lifetime": 439650, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 439650, "timers": {"training_iteration_time_ms": 10361.957, "restore_workers_time_ms": 0.015, "training_step_time_ms": 601.215, "sample_time_ms": 586.163, "synch_weights_time_ms": 13.63}, "counters": {"num_env_steps_sampled": 439650, "num_env_steps_trained": 439500, "num_agent_steps_sampled": 439650, "num_agent_steps_trained": 439500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2931, "num_samples_added_to_queue": 439500}, "done": false, "training_iteration": 175, "trial_id": "27800_00000", "date": "2024-10-12_15-58-06", "timestamp": 1728745086, "time_this_iter_s": 10.255131721496582, "time_total_s": 1811.12353682518, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b45720>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1811.12353682518, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 15.546666666666669, "ram_util_percent": 65.85999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3934.148193359375, "policy_loss": 56.5906982421875, "entropy": 4.929352283477783, "entropy_coeff": 0.01, "var_gnorm": 18.078506469726562, "vf_loss": 389234.5625, "vf_explained_var": 0.6354498863220215}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1473.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 442050, "num_env_steps_trained": 441900, "num_agent_steps_sampled": 442050, "num_agent_steps_trained": 441900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2947, "num_samples_added_to_queue": 441900, "learner_queue": {"size_count": 1473, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.58, "learner_load_time_ms": 0.261, "learner_load_wait_time_ms": 1201.989, "learner_dequeue_time_ms": 10113.241}}, "env_runners": {"episode_reward_max": 1215.7333333333365, "episode_reward_min": 1212.6333333333357, "episode_reward_mean": 1214.0801666666696, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.6333333333357}, "policy_reward_max": {"default_policy": 1215.7333333333365}, "policy_reward_mean": {"default_policy": 1214.0801666666696}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.5131, "num_moves_min": 0.27, "num_moves_max": 0.85, "mean_accuracy_mean": 43.633206666666666, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0004, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16282433333333335, "num_slav_min": 0.1615833333333333, "num_slav_max": 0.16380000000000003, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5455124573680824, "mean_cluster_cpu_util_min": 0.5436183236808236, "mean_cluster_cpu_util_max": 0.5480942728442729, "mean_cluster_mem_util_mean": 0.3416661603375527, "mean_cluster_mem_util_min": 0.3413417721518987, "mean_cluster_mem_util_max": 0.342039029535865, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333166666666692, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4423649999999997, "reward_sla_mean_min": -2.4570000000000003, "reward_sla_mean_max": -2.42375, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3166666666694, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.23649999999998, "reward_sla_sum_min": -245.70000000000005, "reward_sla_sum_max": -242.375, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5278.0, "global_timestep_min": 3400, "global_timestep_max": 6900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.0833333333364, 1214.0833333333362, 1213.6333333333366, 1213.1833333333363, 1214.3833333333362, 1213.233333333336, 1214.2250000000022, 1213.583333333336, 1214.5833333333364, 1214.6333333333366, 1213.683333333336, 1214.0333333333363, 1212.6333333333357, 1214.1833333333363, 1213.633333333336, 1213.8333333333367, 1213.5333333333358, 1213.3333333333367, 1215.3333333333362, 1214.3333333333362, 1213.783333333337, 1212.933333333336, 1214.033333333336, 1214.1833333333361, 1213.9833333333358, 1213.3833333333362, 1214.7833333333365, 1213.9833333333358, 1213.6833333333357, 1214.2333333333363, 1213.2333333333363, 1214.1833333333368, 1214.333333333336, 1214.5833333333364, 1213.6833333333363, 1214.0833333333364, 1214.283333333337, 1213.0833333333362, 1214.133333333336, 1213.8833333333357, 1213.4833333333365, 1214.1333333333369, 1214.283333333336, 1214.5833333333364, 1215.4333333333366, 1214.8833333333369, 1213.7333333333365, 1212.8333333333358, 1214.6333333333362, 1215.7333333333365, 1212.6333333333362, 1213.7333333333363, 1214.7333333333356, 1213.633333333336, 1213.0333333333365, 1214.533333333336, 1215.125000000003, 1213.8333333333362, 1214.3833333333362, 1215.1833333333361, 1214.3833333333357, 1214.2833333333363, 1214.9333333333361, 1214.0833333333367, 1213.2833333333358, 1213.833333333336, 1213.9333333333357, 1213.0833333333367, 1213.0333333333363, 1214.0833333333364, 1214.7833333333363, 1213.9833333333354, 1214.8333333333362, 1213.9333333333361, 1214.0833333333362, 1215.2333333333365, 1215.1333333333364, 1214.283333333336, 1214.983333333336, 1214.2833333333363, 1213.4833333333363, 1213.8833333333364, 1213.933333333336, 1214.4833333333368, 1214.6833333333368, 1213.1833333333363, 1214.9333333333357, 1213.8333333333358, 1213.9333333333368, 1214.0833333333362, 1214.2833333333358, 1215.333333333336, 1213.7333333333358, 1214.7833333333358, 1214.3833333333364, 1214.0333333333363, 1214.1833333333363, 1214.0333333333363, 1214.1833333333366, 1212.983333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.0833333333364, 1214.0833333333362, 1213.6333333333366, 1213.1833333333363, 1214.3833333333362, 1213.233333333336, 1214.2250000000022, 1213.583333333336, 1214.5833333333364, 1214.6333333333366, 1213.683333333336, 1214.0333333333363, 1212.6333333333357, 1214.1833333333363, 1213.633333333336, 1213.8333333333367, 1213.5333333333358, 1213.3333333333367, 1215.3333333333362, 1214.3333333333362, 1213.783333333337, 1212.933333333336, 1214.033333333336, 1214.1833333333361, 1213.9833333333358, 1213.3833333333362, 1214.7833333333365, 1213.9833333333358, 1213.6833333333357, 1214.2333333333363, 1213.2333333333363, 1214.1833333333368, 1214.333333333336, 1214.5833333333364, 1213.6833333333363, 1214.0833333333364, 1214.283333333337, 1213.0833333333362, 1214.133333333336, 1213.8833333333357, 1213.4833333333365, 1214.1333333333369, 1214.283333333336, 1214.5833333333364, 1215.4333333333366, 1214.8833333333369, 1213.7333333333365, 1212.8333333333358, 1214.6333333333362, 1215.7333333333365, 1212.6333333333362, 1213.7333333333363, 1214.7333333333356, 1213.633333333336, 1213.0333333333365, 1214.533333333336, 1215.125000000003, 1213.8333333333362, 1214.3833333333362, 1215.1833333333361, 1214.3833333333357, 1214.2833333333363, 1214.9333333333361, 1214.0833333333367, 1213.2833333333358, 1213.833333333336, 1213.9333333333357, 1213.0833333333367, 1213.0333333333363, 1214.0833333333364, 1214.7833333333363, 1213.9833333333354, 1214.8333333333362, 1213.9333333333361, 1214.0833333333362, 1215.2333333333365, 1215.1333333333364, 1214.283333333336, 1214.983333333336, 1214.2833333333363, 1213.4833333333363, 1213.8833333333364, 1213.933333333336, 1214.4833333333368, 1214.6833333333368, 1213.1833333333363, 1214.9333333333357, 1213.8333333333358, 1213.9333333333368, 1214.0833333333362, 1214.2833333333358, 1215.333333333336, 1213.7333333333358, 1214.7833333333358, 1214.3833333333364, 1214.0333333333363, 1214.1833333333363, 1214.0333333333363, 1214.1833333333366, 1212.983333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24305314845761386, "mean_inference_ms": 2.0708664954438665, "mean_action_processing_ms": 0.09111597842440736, "mean_env_wait_ms": 1.5423240485360707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006447315216064453, "StateBufferConnector_ms": 0.0034110546112060547, "ViewRequirementAgentConnector_ms": 0.08723115921020508}, "num_episodes": 24, "episode_return_max": 1215.7333333333365, "episode_return_min": 1212.6333333333357, "episode_return_mean": 1214.0801666666696, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 442050, "num_agent_steps_trained": 441900, "num_env_steps_sampled": 442050, "num_env_steps_trained": 441900, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 232.6771909621763, "num_env_steps_trained_throughput_per_sec": 232.6771909621763, "timesteps_total": 442050, "num_env_steps_sampled_lifetime": 442050, "num_agent_steps_sampled_lifetime": 442050, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 442050, "timers": {"training_iteration_time_ms": 10375.576, "restore_workers_time_ms": 0.014, "training_step_time_ms": 647.489, "sample_time_ms": 629.655, "synch_weights_time_ms": 15.957}, "counters": {"num_env_steps_sampled": 442050, "num_env_steps_trained": 441900, "num_agent_steps_sampled": 442050, "num_agent_steps_trained": 441900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2947, "num_samples_added_to_queue": 441900}, "done": false, "training_iteration": 176, "trial_id": "27800_00000", "date": "2024-10-12_15-58-17", "timestamp": 1728745097, "time_this_iter_s": 10.33332633972168, "time_total_s": 1821.4568631649017, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f6bb20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1821.4568631649017, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 18.699999999999996, "ram_util_percent": 65.74}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3383.00927734375, "policy_loss": -331.6186828613281, "entropy": 4.932994842529297, "entropy_coeff": 0.01, "var_gnorm": 18.08405876159668, "vf_loss": 372942.71875, "vf_explained_var": 0.6405983567237854}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1481.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 444600, "num_env_steps_trained": 444300, "num_agent_steps_sampled": 444600, "num_agent_steps_trained": 444300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2964, "num_samples_added_to_queue": 444600, "learner_queue": {"size_count": 1481, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 68.445, "learner_load_time_ms": 0.267, "learner_load_wait_time_ms": 1179.202, "learner_dequeue_time_ms": 10125.889}}, "env_runners": {"episode_reward_max": 1215.7333333333365, "episode_reward_min": 1212.4333333333363, "episode_reward_mean": 1214.103750000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.4333333333363}, "policy_reward_max": {"default_policy": 1215.7333333333365}, "policy_reward_mean": {"default_policy": 1214.103750000003}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.45339999999999997, "num_moves_min": 0.27, "num_moves_max": 0.7, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16281416666666668, "num_slav_min": 0.1615833333333333, "num_slav_max": 0.16393333333333335, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5452594293528222, "mean_cluster_cpu_util_min": 0.5425449416252988, "mean_cluster_cpu_util_max": 0.5480942728442729, "mean_cluster_mem_util_mean": 0.341644773206751, "mean_cluster_mem_util_min": 0.3413417721518987, "mean_cluster_mem_util_max": 0.342039029535865, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4422124999999997, "reward_sla_mean_min": -2.459, "reward_sla_mean_max": -2.42375, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.22124999999997, "reward_sla_sum_min": -245.9, "reward_sla_sum_max": -242.375, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6182.0, "global_timestep_min": 4500, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.9833333333358, 1213.6833333333357, 1214.2333333333363, 1213.2333333333363, 1214.1833333333368, 1214.333333333336, 1214.5833333333364, 1213.6833333333363, 1214.0833333333364, 1214.283333333337, 1213.0833333333362, 1214.133333333336, 1213.8833333333357, 1213.4833333333365, 1214.1333333333369, 1214.283333333336, 1214.5833333333364, 1215.4333333333366, 1214.8833333333369, 1213.7333333333365, 1212.8333333333358, 1214.6333333333362, 1215.7333333333365, 1212.6333333333362, 1213.7333333333363, 1214.7333333333356, 1213.633333333336, 1213.0333333333365, 1214.533333333336, 1215.125000000003, 1213.8333333333362, 1214.3833333333362, 1215.1833333333361, 1214.3833333333357, 1214.2833333333363, 1214.9333333333361, 1214.0833333333367, 1213.2833333333358, 1213.833333333336, 1213.9333333333357, 1213.0833333333367, 1213.0333333333363, 1214.0833333333364, 1214.7833333333363, 1213.9833333333354, 1214.8333333333362, 1213.9333333333361, 1214.0833333333362, 1215.2333333333365, 1215.1333333333364, 1214.283333333336, 1214.983333333336, 1214.2833333333363, 1213.4833333333363, 1213.8833333333364, 1213.933333333336, 1214.4833333333368, 1214.6833333333368, 1213.1833333333363, 1214.9333333333357, 1213.8333333333358, 1213.9333333333368, 1214.0833333333362, 1214.2833333333358, 1215.333333333336, 1213.7333333333358, 1214.7833333333358, 1214.3833333333364, 1214.0333333333363, 1214.1833333333363, 1214.0333333333363, 1214.1833333333366, 1212.983333333336, 1214.6833333333363, 1213.7333333333365, 1213.6333333333366, 1214.783333333336, 1214.4333333333368, 1214.533333333336, 1215.4333333333366, 1214.6333333333366, 1214.233333333336, 1213.4333333333361, 1214.4333333333366, 1213.3333333333364, 1213.2333333333356, 1214.0333333333363, 1215.0833333333362, 1214.033333333336, 1214.3333333333364, 1212.4333333333363, 1214.3833333333366, 1214.2333333333363, 1213.0833333333362, 1213.1333333333366, 1213.9333333333363, 1213.1833333333368, 1213.5333333333367, 1213.233333333336, 1214.4333333333363], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.9833333333358, 1213.6833333333357, 1214.2333333333363, 1213.2333333333363, 1214.1833333333368, 1214.333333333336, 1214.5833333333364, 1213.6833333333363, 1214.0833333333364, 1214.283333333337, 1213.0833333333362, 1214.133333333336, 1213.8833333333357, 1213.4833333333365, 1214.1333333333369, 1214.283333333336, 1214.5833333333364, 1215.4333333333366, 1214.8833333333369, 1213.7333333333365, 1212.8333333333358, 1214.6333333333362, 1215.7333333333365, 1212.6333333333362, 1213.7333333333363, 1214.7333333333356, 1213.633333333336, 1213.0333333333365, 1214.533333333336, 1215.125000000003, 1213.8333333333362, 1214.3833333333362, 1215.1833333333361, 1214.3833333333357, 1214.2833333333363, 1214.9333333333361, 1214.0833333333367, 1213.2833333333358, 1213.833333333336, 1213.9333333333357, 1213.0833333333367, 1213.0333333333363, 1214.0833333333364, 1214.7833333333363, 1213.9833333333354, 1214.8333333333362, 1213.9333333333361, 1214.0833333333362, 1215.2333333333365, 1215.1333333333364, 1214.283333333336, 1214.983333333336, 1214.2833333333363, 1213.4833333333363, 1213.8833333333364, 1213.933333333336, 1214.4833333333368, 1214.6833333333368, 1213.1833333333363, 1214.9333333333357, 1213.8333333333358, 1213.9333333333368, 1214.0833333333362, 1214.2833333333358, 1215.333333333336, 1213.7333333333358, 1214.7833333333358, 1214.3833333333364, 1214.0333333333363, 1214.1833333333363, 1214.0333333333363, 1214.1833333333366, 1212.983333333336, 1214.6833333333363, 1213.7333333333365, 1213.6333333333366, 1214.783333333336, 1214.4333333333368, 1214.533333333336, 1215.4333333333366, 1214.6333333333366, 1214.233333333336, 1213.4333333333361, 1214.4333333333366, 1213.3333333333364, 1213.2333333333356, 1214.0333333333363, 1215.0833333333362, 1214.033333333336, 1214.3333333333364, 1212.4333333333363, 1214.3833333333366, 1214.2333333333363, 1213.0833333333362, 1213.1333333333366, 1213.9333333333363, 1213.1833333333368, 1213.5333333333367, 1213.233333333336, 1214.4333333333363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24306729471688315, "mean_inference_ms": 2.071270884478206, "mean_action_processing_ms": 0.09112087376406133, "mean_env_wait_ms": 1.5424915650373296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006247758865356445, "StateBufferConnector_ms": 0.0032639503479003906, "ViewRequirementAgentConnector_ms": 0.08405852317810059}, "num_episodes": 27, "episode_return_max": 1215.7333333333365, "episode_return_min": 1212.4333333333363, "episode_return_mean": 1214.103750000003, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444600, "num_agent_steps_trained": 444300, "num_env_steps_sampled": 444600, "num_env_steps_trained": 444300, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 240.78435073465343, "num_env_steps_trained_throughput_per_sec": 226.6205653973209, "timesteps_total": 444600, "num_env_steps_sampled_lifetime": 444600, "num_agent_steps_sampled_lifetime": 444600, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 444600, "timers": {"training_iteration_time_ms": 10393.675, "restore_workers_time_ms": 0.014, "training_step_time_ms": 620.715, "sample_time_ms": 606.098, "synch_weights_time_ms": 13.08}, "counters": {"num_env_steps_sampled": 444600, "num_env_steps_trained": 444300, "num_agent_steps_sampled": 444600, "num_agent_steps_trained": 444300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2964, "num_samples_added_to_queue": 444600}, "done": false, "training_iteration": 177, "trial_id": "27800_00000", "date": "2024-10-12_15-58-27", "timestamp": 1728745107, "time_this_iter_s": 10.601626873016357, "time_total_s": 1832.058490037918, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9489512a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1832.058490037918, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 16.686666666666664, "ram_util_percent": 65.39333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2325.4658203125, "policy_loss": -1889.52685546875, "entropy": 4.82719612121582, "entropy_coeff": 0.01, "var_gnorm": 18.087404251098633, "vf_loss": 422947.4375, "vf_explained_var": 0.6120063066482544}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1490.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 447150, "num_env_steps_trained": 447000, "num_agent_steps_sampled": 447150, "num_agent_steps_trained": 447000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2981, "num_samples_added_to_queue": 447000, "learner_queue": {"size_count": 1490, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.963, "learner_load_time_ms": 0.25, "learner_load_wait_time_ms": 1170.239, "learner_dequeue_time_ms": 10008.015}}, "env_runners": {"episode_reward_max": 1215.6333333333362, "episode_reward_min": 1212.4333333333363, "episode_reward_mean": 1214.109750000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.4333333333363}, "policy_reward_max": {"default_policy": 1215.6333333333362}, "policy_reward_mean": {"default_policy": 1214.109750000003}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.42669999999999997, "num_moves_min": 0.27, "num_moves_max": 0.61, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0008, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16281016666666667, "num_slav_min": 0.1615833333333333, "num_slav_max": 0.16393333333333335, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5448448078690936, "mean_cluster_cpu_util_min": 0.5425449416252988, "mean_cluster_cpu_util_max": 0.5474095996506709, "mean_cluster_mem_util_mean": 0.34164735759493675, "mean_cluster_mem_util_min": 0.3413554852320675, "mean_cluster_mem_util_max": 0.3420664556962025, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4421524999999993, "reward_sla_mean_min": -2.459, "reward_sla_mean_max": -2.42375, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.21525000000003, "reward_sla_sum_min": -245.9, "reward_sla_sum_max": -242.375, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5111.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.7333333333363, 1214.7333333333356, 1213.633333333336, 1213.0333333333365, 1214.533333333336, 1215.125000000003, 1213.8333333333362, 1214.3833333333362, 1215.1833333333361, 1214.3833333333357, 1214.2833333333363, 1214.9333333333361, 1214.0833333333367, 1213.2833333333358, 1213.833333333336, 1213.9333333333357, 1213.0833333333367, 1213.0333333333363, 1214.0833333333364, 1214.7833333333363, 1213.9833333333354, 1214.8333333333362, 1213.9333333333361, 1214.0833333333362, 1215.2333333333365, 1215.1333333333364, 1214.283333333336, 1214.983333333336, 1214.2833333333363, 1213.4833333333363, 1213.8833333333364, 1213.933333333336, 1214.4833333333368, 1214.6833333333368, 1213.1833333333363, 1214.9333333333357, 1213.8333333333358, 1213.9333333333368, 1214.0833333333362, 1214.2833333333358, 1215.333333333336, 1213.7333333333358, 1214.7833333333358, 1214.3833333333364, 1214.0333333333363, 1214.1833333333363, 1214.0333333333363, 1214.1833333333366, 1212.983333333336, 1214.6833333333363, 1213.7333333333365, 1213.6333333333366, 1214.783333333336, 1214.4333333333368, 1214.533333333336, 1215.4333333333366, 1214.6333333333366, 1214.233333333336, 1213.4333333333361, 1214.4333333333366, 1213.3333333333364, 1213.2333333333356, 1214.0333333333363, 1215.0833333333362, 1214.033333333336, 1214.3333333333364, 1212.4333333333363, 1214.3833333333366, 1214.2333333333363, 1213.0833333333362, 1213.1333333333366, 1213.9333333333363, 1213.1833333333368, 1213.5333333333367, 1213.233333333336, 1214.4333333333363, 1213.7833333333358, 1214.583333333336, 1214.4833333333358, 1214.783333333336, 1213.3333333333362, 1213.7333333333365, 1214.4333333333357, 1214.8833333333362, 1215.6333333333362, 1214.1333333333364, 1213.933333333336, 1213.9833333333365, 1213.4333333333363, 1214.3333333333364, 1214.2333333333363, 1212.983333333336, 1212.8833333333364, 1214.6333333333366, 1215.4833333333354, 1213.7333333333363, 1213.8333333333364, 1213.833333333337, 1213.6833333333366, 1213.583333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.7333333333363, 1214.7333333333356, 1213.633333333336, 1213.0333333333365, 1214.533333333336, 1215.125000000003, 1213.8333333333362, 1214.3833333333362, 1215.1833333333361, 1214.3833333333357, 1214.2833333333363, 1214.9333333333361, 1214.0833333333367, 1213.2833333333358, 1213.833333333336, 1213.9333333333357, 1213.0833333333367, 1213.0333333333363, 1214.0833333333364, 1214.7833333333363, 1213.9833333333354, 1214.8333333333362, 1213.9333333333361, 1214.0833333333362, 1215.2333333333365, 1215.1333333333364, 1214.283333333336, 1214.983333333336, 1214.2833333333363, 1213.4833333333363, 1213.8833333333364, 1213.933333333336, 1214.4833333333368, 1214.6833333333368, 1213.1833333333363, 1214.9333333333357, 1213.8333333333358, 1213.9333333333368, 1214.0833333333362, 1214.2833333333358, 1215.333333333336, 1213.7333333333358, 1214.7833333333358, 1214.3833333333364, 1214.0333333333363, 1214.1833333333363, 1214.0333333333363, 1214.1833333333366, 1212.983333333336, 1214.6833333333363, 1213.7333333333365, 1213.6333333333366, 1214.783333333336, 1214.4333333333368, 1214.533333333336, 1215.4333333333366, 1214.6333333333366, 1214.233333333336, 1213.4333333333361, 1214.4333333333366, 1213.3333333333364, 1213.2333333333356, 1214.0333333333363, 1215.0833333333362, 1214.033333333336, 1214.3333333333364, 1212.4333333333363, 1214.3833333333366, 1214.2333333333363, 1213.0833333333362, 1213.1333333333366, 1213.9333333333363, 1213.1833333333368, 1213.5333333333367, 1213.233333333336, 1214.4333333333363, 1213.7833333333358, 1214.583333333336, 1214.4833333333358, 1214.783333333336, 1213.3333333333362, 1213.7333333333365, 1214.4333333333357, 1214.8833333333362, 1215.6333333333362, 1214.1333333333364, 1213.933333333336, 1213.9833333333365, 1213.4333333333363, 1214.3333333333364, 1214.2333333333363, 1212.983333333336, 1212.8833333333364, 1214.6333333333366, 1215.4833333333354, 1213.7333333333363, 1213.8333333333364, 1213.833333333337, 1213.6833333333366, 1213.583333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2431189762497653, "mean_inference_ms": 2.072874223198202, "mean_action_processing_ms": 0.09114368666075406, "mean_env_wait_ms": 1.54290498400189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006346702575683594, "StateBufferConnector_ms": 0.003306865692138672, "ViewRequirementAgentConnector_ms": 0.08511972427368164}, "num_episodes": 24, "episode_return_max": 1215.6333333333362, "episode_return_min": 1212.4333333333363, "episode_return_mean": 1214.109750000003, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 447150, "num_agent_steps_trained": 447000, "num_env_steps_sampled": 447150, "num_env_steps_trained": 447000, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 246.4742031787745, "num_env_steps_trained_throughput_per_sec": 260.9726857187024, "timesteps_total": 447150, "num_env_steps_sampled_lifetime": 447150, "num_agent_steps_sampled_lifetime": 447150, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 447150, "timers": {"training_iteration_time_ms": 10400.571, "restore_workers_time_ms": 0.013, "training_step_time_ms": 610.373, "sample_time_ms": 594.444, "synch_weights_time_ms": 14.492}, "counters": {"num_env_steps_sampled": 447150, "num_env_steps_trained": 447000, "num_agent_steps_sampled": 447150, "num_agent_steps_trained": 447000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2981, "num_samples_added_to_queue": 447000}, "done": false, "training_iteration": 178, "trial_id": "27800_00000", "date": "2024-10-12_15-58-38", "timestamp": 1728745118, "time_this_iter_s": 10.356975793838501, "time_total_s": 1842.4154658317566, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d463e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1842.4154658317566, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 16.5, "ram_util_percent": 65.37333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4007.71533203125, "policy_loss": -210.85903930664062, "entropy": 4.6575026512146, "entropy_coeff": 0.01, "var_gnorm": 18.075773239135742, "vf_loss": 423254.71875, "vf_explained_var": 0.6138873100280762}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1498.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 449550, "num_env_steps_trained": 449400, "num_agent_steps_sampled": 449550, "num_agent_steps_trained": 449400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2997, "num_samples_added_to_queue": 449400, "learner_queue": {"size_count": 1498, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.809, "learner_load_time_ms": 0.277, "learner_load_wait_time_ms": 1198.243, "learner_dequeue_time_ms": 9974.269}}, "env_runners": {"episode_reward_max": 1215.6333333333362, "episode_reward_min": 1212.4333333333363, "episode_reward_mean": 1214.0778333333362, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.4333333333363}, "policy_reward_max": {"default_policy": 1215.6333333333362}, "policy_reward_mean": {"default_policy": 1214.0778333333362}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.39019999999999994, "num_moves_min": 0.16, "num_moves_max": 0.61, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0006, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16283700000000004, "num_slav_min": 0.1618, "num_slav_max": 0.16393333333333335, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5449776979913588, "mean_cluster_cpu_util_min": 0.5425449416252988, "mean_cluster_cpu_util_max": 0.5475867232027948, "mean_cluster_mem_util_mean": 0.34166068565400826, "mean_cluster_mem_util_min": 0.3413713080168776, "mean_cluster_mem_util_max": 0.3420664556962025, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4425549999999996, "reward_sla_mean_min": -2.459, "reward_sla_mean_max": -2.427, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.25550000000007, "reward_sla_sum_min": -245.9, "reward_sla_sum_max": -242.70000000000002, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4039.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1215.2333333333365, 1215.1333333333364, 1214.283333333336, 1214.983333333336, 1214.2833333333363, 1213.4833333333363, 1213.8833333333364, 1213.933333333336, 1214.4833333333368, 1214.6833333333368, 1213.1833333333363, 1214.9333333333357, 1213.8333333333358, 1213.9333333333368, 1214.0833333333362, 1214.2833333333358, 1215.333333333336, 1213.7333333333358, 1214.7833333333358, 1214.3833333333364, 1214.0333333333363, 1214.1833333333363, 1214.0333333333363, 1214.1833333333366, 1212.983333333336, 1214.6833333333363, 1213.7333333333365, 1213.6333333333366, 1214.783333333336, 1214.4333333333368, 1214.533333333336, 1215.4333333333366, 1214.6333333333366, 1214.233333333336, 1213.4333333333361, 1214.4333333333366, 1213.3333333333364, 1213.2333333333356, 1214.0333333333363, 1215.0833333333362, 1214.033333333336, 1214.3333333333364, 1212.4333333333363, 1214.3833333333366, 1214.2333333333363, 1213.0833333333362, 1213.1333333333366, 1213.9333333333363, 1213.1833333333368, 1213.5333333333367, 1213.233333333336, 1214.4333333333363, 1213.7833333333358, 1214.583333333336, 1214.4833333333358, 1214.783333333336, 1213.3333333333362, 1213.7333333333365, 1214.4333333333357, 1214.8833333333362, 1215.6333333333362, 1214.1333333333364, 1213.933333333336, 1213.9833333333365, 1213.4333333333363, 1214.3333333333364, 1214.2333333333363, 1212.983333333336, 1212.8833333333364, 1214.6333333333366, 1215.4833333333354, 1213.7333333333363, 1213.8333333333364, 1213.833333333337, 1213.6833333333366, 1213.583333333336, 1213.8333333333371, 1214.1333333333364, 1213.3333333333362, 1214.3333333333358, 1214.3833333333366, 1213.1333333333353, 1212.9333333333366, 1214.383333333336, 1215.033333333336, 1213.5333333333367, 1213.9333333333363, 1214.2833333333363, 1214.2333333333363, 1213.8833333333364, 1213.683333333336, 1214.6333333333362, 1213.133333333336, 1213.7333333333363, 1214.4333333333361, 1213.883333333336, 1213.683333333336, 1214.1833333333357, 1214.8833333333362, 1213.9333333333368], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1215.2333333333365, 1215.1333333333364, 1214.283333333336, 1214.983333333336, 1214.2833333333363, 1213.4833333333363, 1213.8833333333364, 1213.933333333336, 1214.4833333333368, 1214.6833333333368, 1213.1833333333363, 1214.9333333333357, 1213.8333333333358, 1213.9333333333368, 1214.0833333333362, 1214.2833333333358, 1215.333333333336, 1213.7333333333358, 1214.7833333333358, 1214.3833333333364, 1214.0333333333363, 1214.1833333333363, 1214.0333333333363, 1214.1833333333366, 1212.983333333336, 1214.6833333333363, 1213.7333333333365, 1213.6333333333366, 1214.783333333336, 1214.4333333333368, 1214.533333333336, 1215.4333333333366, 1214.6333333333366, 1214.233333333336, 1213.4333333333361, 1214.4333333333366, 1213.3333333333364, 1213.2333333333356, 1214.0333333333363, 1215.0833333333362, 1214.033333333336, 1214.3333333333364, 1212.4333333333363, 1214.3833333333366, 1214.2333333333363, 1213.0833333333362, 1213.1333333333366, 1213.9333333333363, 1213.1833333333368, 1213.5333333333367, 1213.233333333336, 1214.4333333333363, 1213.7833333333358, 1214.583333333336, 1214.4833333333358, 1214.783333333336, 1213.3333333333362, 1213.7333333333365, 1214.4333333333357, 1214.8833333333362, 1215.6333333333362, 1214.1333333333364, 1213.933333333336, 1213.9833333333365, 1213.4333333333363, 1214.3333333333364, 1214.2333333333363, 1212.983333333336, 1212.8833333333364, 1214.6333333333366, 1215.4833333333354, 1213.7333333333363, 1213.8333333333364, 1213.833333333337, 1213.6833333333366, 1213.583333333336, 1213.8333333333371, 1214.1333333333364, 1213.3333333333362, 1214.3333333333358, 1214.3833333333366, 1213.1333333333353, 1212.9333333333366, 1214.383333333336, 1215.033333333336, 1213.5333333333367, 1213.9333333333363, 1214.2833333333363, 1214.2333333333363, 1213.8833333333364, 1213.683333333336, 1214.6333333333362, 1213.133333333336, 1213.7333333333363, 1214.4333333333361, 1213.883333333336, 1213.683333333336, 1214.1833333333357, 1214.8833333333362, 1213.9333333333368]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2431443404180832, "mean_inference_ms": 2.0730423917893006, "mean_action_processing_ms": 0.09115260338732442, "mean_env_wait_ms": 1.5430093128369708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006323575973510742, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.08488631248474121}, "num_episodes": 24, "episode_return_max": 1215.6333333333362, "episode_return_min": 1212.4333333333363, "episode_return_mean": 1214.0778333333362, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 449550, "num_agent_steps_trained": 449400, "num_env_steps_sampled": 449550, "num_env_steps_trained": 449400, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 237.1182497034411, "num_env_steps_trained_throughput_per_sec": 237.1182497034411, "timesteps_total": 449550, "num_env_steps_sampled_lifetime": 449550, "num_agent_steps_sampled_lifetime": 449550, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 449550, "timers": {"training_iteration_time_ms": 10338.058, "restore_workers_time_ms": 0.013, "training_step_time_ms": 637.947, "sample_time_ms": 621.994, "synch_weights_time_ms": 14.376}, "counters": {"num_env_steps_sampled": 449550, "num_env_steps_trained": 449400, "num_agent_steps_sampled": 449550, "num_agent_steps_trained": 449400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2997, "num_samples_added_to_queue": 449400}, "done": false, "training_iteration": 179, "trial_id": "27800_00000", "date": "2024-10-12_15-58-48", "timestamp": 1728745128, "time_this_iter_s": 10.131680727005005, "time_total_s": 1852.5471465587616, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f3a00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1852.5471465587616, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 16.45714285714286, "ram_util_percent": 65.48571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4103.919921875, "policy_loss": 147.6640625, "entropy": 4.647590160369873, "entropy_coeff": 0.01, "var_gnorm": 18.065515518188477, "vf_loss": 397019.875, "vf_explained_var": 0.6318366527557373}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1506.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 451950, "num_env_steps_trained": 451800, "num_agent_steps_sampled": 451950, "num_agent_steps_trained": 451800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3013, "num_samples_added_to_queue": 451800, "learner_queue": {"size_count": 1506, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.836, "learner_load_time_ms": 0.276, "learner_load_wait_time_ms": 1231.668, "learner_dequeue_time_ms": 10036.484}}, "env_runners": {"episode_reward_max": 1215.6333333333362, "episode_reward_min": 1212.4333333333363, "episode_reward_mean": 1213.9533333333363, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.4333333333363}, "policy_reward_max": {"default_policy": 1215.6333333333362}, "policy_reward_mean": {"default_policy": 1213.9533333333363}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.33059999999999995, "num_moves_min": 0.1, "num_moves_max": 0.61, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0006, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16292, "num_slav_min": 0.1618, "num_slav_max": 0.16393333333333335, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5453386292287186, "mean_cluster_cpu_util_min": 0.5425449416252988, "mean_cluster_cpu_util_max": 0.5486251608751609, "mean_cluster_mem_util_mean": 0.3416555801687764, "mean_cluster_mem_util_min": 0.3412932489451476, "mean_cluster_mem_util_max": 0.3420664556962025, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4437999999999995, "reward_sla_mean_min": -2.459, "reward_sla_mean_max": -2.427, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.38, "reward_sla_sum_min": -245.9, "reward_sla_sum_max": -242.70000000000002, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2967.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1212.983333333336, 1214.6833333333363, 1213.7333333333365, 1213.6333333333366, 1214.783333333336, 1214.4333333333368, 1214.533333333336, 1215.4333333333366, 1214.6333333333366, 1214.233333333336, 1213.4333333333361, 1214.4333333333366, 1213.3333333333364, 1213.2333333333356, 1214.0333333333363, 1215.0833333333362, 1214.033333333336, 1214.3333333333364, 1212.4333333333363, 1214.3833333333366, 1214.2333333333363, 1213.0833333333362, 1213.1333333333366, 1213.9333333333363, 1213.1833333333368, 1213.5333333333367, 1213.233333333336, 1214.4333333333363, 1213.7833333333358, 1214.583333333336, 1214.4833333333358, 1214.783333333336, 1213.3333333333362, 1213.7333333333365, 1214.4333333333357, 1214.8833333333362, 1215.6333333333362, 1214.1333333333364, 1213.933333333336, 1213.9833333333365, 1213.4333333333363, 1214.3333333333364, 1214.2333333333363, 1212.983333333336, 1212.8833333333364, 1214.6333333333366, 1215.4833333333354, 1213.7333333333363, 1213.8333333333364, 1213.833333333337, 1213.6833333333366, 1213.583333333336, 1213.8333333333371, 1214.1333333333364, 1213.3333333333362, 1214.3333333333358, 1214.3833333333366, 1213.1333333333353, 1212.9333333333366, 1214.383333333336, 1215.033333333336, 1213.5333333333367, 1213.9333333333363, 1214.2833333333363, 1214.2333333333363, 1213.8833333333364, 1213.683333333336, 1214.6333333333362, 1213.133333333336, 1213.7333333333363, 1214.4333333333361, 1213.883333333336, 1213.683333333336, 1214.1833333333357, 1214.8833333333362, 1213.9333333333368, 1214.3833333333364, 1213.783333333336, 1213.5333333333365, 1213.6333333333364, 1214.3833333333362, 1213.583333333336, 1213.8333333333362, 1213.4333333333368, 1213.8333333333364, 1213.9333333333366, 1213.6833333333366, 1213.233333333336, 1213.8833333333364, 1213.833333333336, 1214.1833333333363, 1212.5833333333364, 1213.1833333333361, 1214.633333333336, 1213.4833333333363, 1213.2333333333358, 1213.7333333333363, 1214.1833333333361, 1214.6833333333361, 1213.9833333333363], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1212.983333333336, 1214.6833333333363, 1213.7333333333365, 1213.6333333333366, 1214.783333333336, 1214.4333333333368, 1214.533333333336, 1215.4333333333366, 1214.6333333333366, 1214.233333333336, 1213.4333333333361, 1214.4333333333366, 1213.3333333333364, 1213.2333333333356, 1214.0333333333363, 1215.0833333333362, 1214.033333333336, 1214.3333333333364, 1212.4333333333363, 1214.3833333333366, 1214.2333333333363, 1213.0833333333362, 1213.1333333333366, 1213.9333333333363, 1213.1833333333368, 1213.5333333333367, 1213.233333333336, 1214.4333333333363, 1213.7833333333358, 1214.583333333336, 1214.4833333333358, 1214.783333333336, 1213.3333333333362, 1213.7333333333365, 1214.4333333333357, 1214.8833333333362, 1215.6333333333362, 1214.1333333333364, 1213.933333333336, 1213.9833333333365, 1213.4333333333363, 1214.3333333333364, 1214.2333333333363, 1212.983333333336, 1212.8833333333364, 1214.6333333333366, 1215.4833333333354, 1213.7333333333363, 1213.8333333333364, 1213.833333333337, 1213.6833333333366, 1213.583333333336, 1213.8333333333371, 1214.1333333333364, 1213.3333333333362, 1214.3333333333358, 1214.3833333333366, 1213.1333333333353, 1212.9333333333366, 1214.383333333336, 1215.033333333336, 1213.5333333333367, 1213.9333333333363, 1214.2833333333363, 1214.2333333333363, 1213.8833333333364, 1213.683333333336, 1214.6333333333362, 1213.133333333336, 1213.7333333333363, 1214.4333333333361, 1213.883333333336, 1213.683333333336, 1214.1833333333357, 1214.8833333333362, 1213.9333333333368, 1214.3833333333364, 1213.783333333336, 1213.5333333333365, 1213.6333333333364, 1214.3833333333362, 1213.583333333336, 1213.8333333333362, 1213.4333333333368, 1213.8333333333364, 1213.9333333333366, 1213.6833333333366, 1213.233333333336, 1213.8833333333364, 1213.833333333336, 1214.1833333333363, 1212.5833333333364, 1213.1833333333361, 1214.633333333336, 1213.4833333333363, 1213.2333333333358, 1213.7333333333363, 1214.1833333333361, 1214.6833333333361, 1213.9833333333363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24316406916729164, "mean_inference_ms": 2.073223620647046, "mean_action_processing_ms": 0.09116142719655315, "mean_env_wait_ms": 1.5431054055774218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667613983154297, "StateBufferConnector_ms": 0.0033087730407714844, "ViewRequirementAgentConnector_ms": 0.08492851257324219}, "num_episodes": 24, "episode_return_max": 1215.6333333333362, "episode_return_min": 1212.4333333333363, "episode_return_mean": 1213.9533333333363, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 451950, "num_agent_steps_trained": 451800, "num_env_steps_sampled": 451950, "num_env_steps_trained": 451800, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 233.79335884630726, "num_env_steps_trained_throughput_per_sec": 233.79335884630726, "timesteps_total": 451950, "num_env_steps_sampled_lifetime": 451950, "num_agent_steps_sampled_lifetime": 451950, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 451950, "timers": {"training_iteration_time_ms": 10352.745, "restore_workers_time_ms": 0.013, "training_step_time_ms": 646.306, "sample_time_ms": 630.496, "synch_weights_time_ms": 14.264}, "counters": {"num_env_steps_sampled": 451950, "num_env_steps_trained": 451800, "num_agent_steps_sampled": 451950, "num_agent_steps_trained": 451800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3013, "num_samples_added_to_queue": 451800}, "done": false, "training_iteration": 180, "trial_id": "27800_00000", "date": "2024-10-12_15-58-58", "timestamp": 1728745138, "time_this_iter_s": 10.27476978302002, "time_total_s": 1862.8219163417816, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f0400>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1862.8219163417816, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 16.53333333333333, "ram_util_percent": 65.62666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3951.243408203125, "policy_loss": 98.9439697265625, "entropy": 4.6011810302734375, "entropy_coeff": 0.01, "var_gnorm": 18.07108497619629, "vf_loss": 386610.3125, "vf_explained_var": 0.6362828612327576}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1514.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 454500, "num_env_steps_trained": 454200, "num_agent_steps_sampled": 454500, "num_agent_steps_trained": 454200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3030, "num_samples_added_to_queue": 454500, "learner_queue": {"size_count": 1514, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.636, "learner_load_time_ms": 0.255, "learner_load_wait_time_ms": 1181.907, "learner_dequeue_time_ms": 10049.199}}, "env_runners": {"episode_reward_max": 1215.6333333333362, "episode_reward_min": 1212.5833333333364, "episode_reward_mean": 1213.9543333333363, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.5833333333364}, "policy_reward_max": {"default_policy": 1215.6333333333362}, "policy_reward_mean": {"default_policy": 1213.9543333333363}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2543, "num_moves_min": 0.06, "num_moves_max": 0.61, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0006, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16291933333333336, "num_slav_min": 0.1618, "num_slav_max": 0.16383333333333333, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5459543493748851, "mean_cluster_cpu_util_min": 0.5430005056076485, "mean_cluster_cpu_util_max": 0.5486251608751609, "mean_cluster_mem_util_mean": 0.34166554852320674, "mean_cluster_mem_util_min": 0.3411814345991562, "mean_cluster_mem_util_max": 0.3420664556962025, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.44379, "reward_sla_mean_min": -2.4575, "reward_sla_mean_max": -2.427, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.379, "reward_sla_sum_min": -245.75, "reward_sla_sum_max": -242.70000000000002, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1761.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.4333333333363, 1213.7833333333358, 1214.583333333336, 1214.4833333333358, 1214.783333333336, 1213.3333333333362, 1213.7333333333365, 1214.4333333333357, 1214.8833333333362, 1215.6333333333362, 1214.1333333333364, 1213.933333333336, 1213.9833333333365, 1213.4333333333363, 1214.3333333333364, 1214.2333333333363, 1212.983333333336, 1212.8833333333364, 1214.6333333333366, 1215.4833333333354, 1213.7333333333363, 1213.8333333333364, 1213.833333333337, 1213.6833333333366, 1213.583333333336, 1213.8333333333371, 1214.1333333333364, 1213.3333333333362, 1214.3333333333358, 1214.3833333333366, 1213.1333333333353, 1212.9333333333366, 1214.383333333336, 1215.033333333336, 1213.5333333333367, 1213.9333333333363, 1214.2833333333363, 1214.2333333333363, 1213.8833333333364, 1213.683333333336, 1214.6333333333362, 1213.133333333336, 1213.7333333333363, 1214.4333333333361, 1213.883333333336, 1213.683333333336, 1214.1833333333357, 1214.8833333333362, 1213.9333333333368, 1214.3833333333364, 1213.783333333336, 1213.5333333333365, 1213.6333333333364, 1214.3833333333362, 1213.583333333336, 1213.8333333333362, 1213.4333333333368, 1213.8333333333364, 1213.9333333333366, 1213.6833333333366, 1213.233333333336, 1213.8833333333364, 1213.833333333336, 1214.1833333333363, 1212.5833333333364, 1213.1833333333361, 1214.633333333336, 1213.4833333333363, 1213.2333333333358, 1213.7333333333363, 1214.1833333333361, 1214.6833333333361, 1213.9833333333363, 1213.2833333333367, 1213.2833333333363, 1214.8333333333367, 1213.3833333333362, 1214.7333333333358, 1213.5833333333364, 1213.333333333336, 1214.2333333333363, 1213.1333333333364, 1215.0333333333365, 1214.1833333333363, 1213.833333333336, 1213.2833333333358, 1213.5833333333358, 1214.7333333333363, 1213.783333333336, 1214.4833333333365, 1213.8333333333364, 1214.1833333333363, 1213.6333333333355, 1214.7333333333354, 1212.8833333333355, 1214.1333333333369, 1214.3333333333371, 1214.9333333333357, 1212.8333333333364, 1214.0333333333365], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.4333333333363, 1213.7833333333358, 1214.583333333336, 1214.4833333333358, 1214.783333333336, 1213.3333333333362, 1213.7333333333365, 1214.4333333333357, 1214.8833333333362, 1215.6333333333362, 1214.1333333333364, 1213.933333333336, 1213.9833333333365, 1213.4333333333363, 1214.3333333333364, 1214.2333333333363, 1212.983333333336, 1212.8833333333364, 1214.6333333333366, 1215.4833333333354, 1213.7333333333363, 1213.8333333333364, 1213.833333333337, 1213.6833333333366, 1213.583333333336, 1213.8333333333371, 1214.1333333333364, 1213.3333333333362, 1214.3333333333358, 1214.3833333333366, 1213.1333333333353, 1212.9333333333366, 1214.383333333336, 1215.033333333336, 1213.5333333333367, 1213.9333333333363, 1214.2833333333363, 1214.2333333333363, 1213.8833333333364, 1213.683333333336, 1214.6333333333362, 1213.133333333336, 1213.7333333333363, 1214.4333333333361, 1213.883333333336, 1213.683333333336, 1214.1833333333357, 1214.8833333333362, 1213.9333333333368, 1214.3833333333364, 1213.783333333336, 1213.5333333333365, 1213.6333333333364, 1214.3833333333362, 1213.583333333336, 1213.8333333333362, 1213.4333333333368, 1213.8333333333364, 1213.9333333333366, 1213.6833333333366, 1213.233333333336, 1213.8833333333364, 1213.833333333336, 1214.1833333333363, 1212.5833333333364, 1213.1833333333361, 1214.633333333336, 1213.4833333333363, 1213.2333333333358, 1213.7333333333363, 1214.1833333333361, 1214.6833333333361, 1213.9833333333363, 1213.2833333333367, 1213.2833333333363, 1214.8333333333367, 1213.3833333333362, 1214.7333333333358, 1213.5833333333364, 1213.333333333336, 1214.2333333333363, 1213.1333333333364, 1215.0333333333365, 1214.1833333333363, 1213.833333333336, 1213.2833333333358, 1213.5833333333358, 1214.7333333333363, 1213.783333333336, 1214.4833333333365, 1213.8333333333364, 1214.1833333333363, 1213.6333333333355, 1214.7333333333354, 1212.8833333333355, 1214.1333333333369, 1214.3333333333371, 1214.9333333333357, 1212.8333333333364, 1214.0333333333365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2431764957331398, "mean_inference_ms": 2.073390593749406, "mean_action_processing_ms": 0.09117147378722686, "mean_env_wait_ms": 1.543191191251733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006833314895629883, "StateBufferConnector_ms": 0.0033020973205566406, "ViewRequirementAgentConnector_ms": 0.08502340316772461}, "num_episodes": 27, "episode_return_max": 1215.6333333333362, "episode_return_min": 1212.5833333333364, "episode_return_mean": 1213.9543333333363, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 454500, "num_agent_steps_trained": 454200, "num_env_steps_sampled": 454500, "num_env_steps_trained": 454200, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 242.71313589548046, "num_env_steps_trained_throughput_per_sec": 228.43589260751102, "timesteps_total": 454500, "num_env_steps_sampled_lifetime": 454500, "num_agent_steps_sampled_lifetime": 454500, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 454500, "timers": {"training_iteration_time_ms": 10368.4, "restore_workers_time_ms": 0.012, "training_step_time_ms": 618.777, "sample_time_ms": 602.806, "synch_weights_time_ms": 14.375}, "counters": {"num_env_steps_sampled": 454500, "num_env_steps_trained": 454200, "num_agent_steps_sampled": 454500, "num_agent_steps_trained": 454200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3030, "num_samples_added_to_queue": 454500}, "done": false, "training_iteration": 181, "trial_id": "27800_00000", "date": "2024-10-12_15-59-09", "timestamp": 1728745149, "time_this_iter_s": 10.517796993255615, "time_total_s": 1873.3397133350372, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948950ac0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1873.3397133350372, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 16.686666666666667, "ram_util_percent": 65.76666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3262.469482421875, "policy_loss": -491.4888610839844, "entropy": 4.60479211807251, "entropy_coeff": 0.01, "var_gnorm": 18.089609146118164, "vf_loss": 376777.28125, "vf_explained_var": 0.6391887068748474}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1523.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 457050, "num_env_steps_trained": 456900, "num_agent_steps_sampled": 457050, "num_agent_steps_trained": 456900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3047, "num_samples_added_to_queue": 456900, "learner_queue": {"size_count": 1523, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.321, "learner_load_time_ms": 0.251, "learner_load_wait_time_ms": 1175.021, "learner_dequeue_time_ms": 10106.917}}, "env_runners": {"episode_reward_max": 1215.3833333333366, "episode_reward_min": 1212.5833333333364, "episode_reward_mean": 1213.9588333333363, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.5833333333364}, "policy_reward_max": {"default_policy": 1215.3833333333366}, "policy_reward_mean": {"default_policy": 1213.9588333333363}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.1748, "num_moves_min": 0.02, "num_moves_max": 0.45, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.16291633333333336, "num_slav_min": 0.16196666666666665, "num_slav_max": 0.16383333333333333, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5465757931145431, "mean_cluster_cpu_util_min": 0.5444880262915975, "mean_cluster_cpu_util_max": 0.5486251608751609, "mean_cluster_mem_util_mean": 0.34166856540084395, "mean_cluster_mem_util_min": 0.3411814345991562, "mean_cluster_mem_util_max": 0.34205696202531644, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4437450000000003, "reward_sla_mean_min": -2.4575, "reward_sla_mean_max": -2.4295, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.3745, "reward_sla_sum_min": -245.75, "reward_sla_sum_max": -242.95000000000002, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2483.0, "global_timestep_min": 800, "global_timestep_max": 4100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.583333333336, 1213.8333333333371, 1214.1333333333364, 1213.3333333333362, 1214.3333333333358, 1214.3833333333366, 1213.1333333333353, 1212.9333333333366, 1214.383333333336, 1215.033333333336, 1213.5333333333367, 1213.9333333333363, 1214.2833333333363, 1214.2333333333363, 1213.8833333333364, 1213.683333333336, 1214.6333333333362, 1213.133333333336, 1213.7333333333363, 1214.4333333333361, 1213.883333333336, 1213.683333333336, 1214.1833333333357, 1214.8833333333362, 1213.9333333333368, 1214.3833333333364, 1213.783333333336, 1213.5333333333365, 1213.6333333333364, 1214.3833333333362, 1213.583333333336, 1213.8333333333362, 1213.4333333333368, 1213.8333333333364, 1213.9333333333366, 1213.6833333333366, 1213.233333333336, 1213.8833333333364, 1213.833333333336, 1214.1833333333363, 1212.5833333333364, 1213.1833333333361, 1214.633333333336, 1213.4833333333363, 1213.2333333333358, 1213.7333333333363, 1214.1833333333361, 1214.6833333333361, 1213.9833333333363, 1213.2833333333367, 1213.2833333333363, 1214.8333333333367, 1213.3833333333362, 1214.7333333333358, 1213.5833333333364, 1213.333333333336, 1214.2333333333363, 1213.1333333333364, 1215.0333333333365, 1214.1833333333363, 1213.833333333336, 1213.2833333333358, 1213.5833333333358, 1214.7333333333363, 1213.783333333336, 1214.4833333333365, 1213.8333333333364, 1214.1833333333363, 1213.6333333333355, 1214.7333333333354, 1212.8833333333355, 1214.1333333333369, 1214.3333333333371, 1214.9333333333357, 1212.8333333333364, 1214.0333333333365, 1214.5333333333358, 1214.983333333336, 1213.9833333333365, 1214.7833333333363, 1214.6833333333361, 1213.983333333336, 1213.0333333333367, 1214.783333333336, 1213.5833333333358, 1213.9333333333368, 1214.283333333336, 1213.9833333333363, 1214.4333333333363, 1214.4333333333366, 1214.1833333333361, 1213.3833333333362, 1215.3833333333366, 1213.233333333336, 1214.0333333333353, 1214.783333333336, 1213.5333333333363, 1213.3833333333366, 1214.3833333333364, 1213.9333333333368], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.583333333336, 1213.8333333333371, 1214.1333333333364, 1213.3333333333362, 1214.3333333333358, 1214.3833333333366, 1213.1333333333353, 1212.9333333333366, 1214.383333333336, 1215.033333333336, 1213.5333333333367, 1213.9333333333363, 1214.2833333333363, 1214.2333333333363, 1213.8833333333364, 1213.683333333336, 1214.6333333333362, 1213.133333333336, 1213.7333333333363, 1214.4333333333361, 1213.883333333336, 1213.683333333336, 1214.1833333333357, 1214.8833333333362, 1213.9333333333368, 1214.3833333333364, 1213.783333333336, 1213.5333333333365, 1213.6333333333364, 1214.3833333333362, 1213.583333333336, 1213.8333333333362, 1213.4333333333368, 1213.8333333333364, 1213.9333333333366, 1213.6833333333366, 1213.233333333336, 1213.8833333333364, 1213.833333333336, 1214.1833333333363, 1212.5833333333364, 1213.1833333333361, 1214.633333333336, 1213.4833333333363, 1213.2333333333358, 1213.7333333333363, 1214.1833333333361, 1214.6833333333361, 1213.9833333333363, 1213.2833333333367, 1213.2833333333363, 1214.8333333333367, 1213.3833333333362, 1214.7333333333358, 1213.5833333333364, 1213.333333333336, 1214.2333333333363, 1213.1333333333364, 1215.0333333333365, 1214.1833333333363, 1213.833333333336, 1213.2833333333358, 1213.5833333333358, 1214.7333333333363, 1213.783333333336, 1214.4833333333365, 1213.8333333333364, 1214.1833333333363, 1213.6333333333355, 1214.7333333333354, 1212.8833333333355, 1214.1333333333369, 1214.3333333333371, 1214.9333333333357, 1212.8333333333364, 1214.0333333333365, 1214.5333333333358, 1214.983333333336, 1213.9833333333365, 1214.7833333333363, 1214.6833333333361, 1213.983333333336, 1213.0333333333367, 1214.783333333336, 1213.5833333333358, 1213.9333333333368, 1214.283333333336, 1213.9833333333363, 1214.4333333333363, 1214.4333333333366, 1214.1833333333361, 1213.3833333333362, 1215.3833333333366, 1213.233333333336, 1214.0333333333353, 1214.783333333336, 1213.5333333333363, 1213.3833333333366, 1214.3833333333364, 1213.9333333333368]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24318774049863748, "mean_inference_ms": 2.0736255895438642, "mean_action_processing_ms": 0.09118052275427367, "mean_env_wait_ms": 1.543270809363233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006853580474853516, "StateBufferConnector_ms": 0.0033028125762939453, "ViewRequirementAgentConnector_ms": 0.0854496955871582}, "num_episodes": 24, "episode_return_max": 1215.3833333333366, "episode_return_min": 1212.5833333333364, "episode_return_mean": 1213.9588333333363, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 457050, "num_agent_steps_trained": 456900, "num_env_steps_sampled": 457050, "num_env_steps_trained": 456900, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 242.00950879750897, "num_env_steps_trained_throughput_per_sec": 256.24536225618596, "timesteps_total": 457050, "num_env_steps_sampled_lifetime": 457050, "num_agent_steps_sampled_lifetime": 457050, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 457050, "timers": {"training_iteration_time_ms": 10371.664, "restore_workers_time_ms": 0.012, "training_step_time_ms": 624.28, "sample_time_ms": 608.009, "synch_weights_time_ms": 14.719}, "counters": {"num_env_steps_sampled": 457050, "num_env_steps_trained": 456900, "num_agent_steps_sampled": 457050, "num_agent_steps_trained": 456900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3047, "num_samples_added_to_queue": 456900}, "done": false, "training_iteration": 182, "trial_id": "27800_00000", "date": "2024-10-12_15-59-19", "timestamp": 1728745159, "time_this_iter_s": 10.550273418426514, "time_total_s": 1883.8899867534637, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f6be50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1883.8899867534637, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 16.72666666666667, "ram_util_percent": 66.00666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3813.674072265625, "policy_loss": 15.40903091430664, "entropy": 4.7446818351745605, "entropy_coeff": 0.01, "var_gnorm": 18.099079132080078, "vf_loss": 381249.90625, "vf_explained_var": 0.6388345956802368}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1530.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 459300, "num_env_steps_trained": 459000, "num_agent_steps_sampled": 459300, "num_agent_steps_trained": 459000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3062, "num_samples_added_to_queue": 459300, "learner_queue": {"size_count": 1530, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.946, "learner_load_time_ms": 0.263, "learner_load_wait_time_ms": 1256.514, "learner_dequeue_time_ms": 10050.504}}, "env_runners": {"episode_reward_max": 1215.6333333333366, "episode_reward_min": 1212.5833333333364, "episode_reward_mean": 1214.014250000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.5833333333364}, "policy_reward_max": {"default_policy": 1215.6333333333366}, "policy_reward_mean": {"default_policy": 1214.014250000003}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.1604, "num_moves_min": 0.02, "num_moves_max": 0.4, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16287383333333336, "num_slav_min": 0.16180000000000003, "num_slav_max": 0.16383333333333333, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5466734894971502, "mean_cluster_cpu_util_min": 0.5444880262915975, "mean_cluster_cpu_util_max": 0.5487839216767788, "mean_cluster_mem_util_mean": 0.34164469409282705, "mean_cluster_mem_util_min": 0.34112447257383977, "mean_cluster_mem_util_max": 0.34205696202531644, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4431075, "reward_sla_mean_min": -2.4575, "reward_sla_mean_max": -2.427, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.31074999999998, "reward_sla_sum_min": -245.75, "reward_sla_sum_max": -242.7, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3283.0, "global_timestep_min": 1600, "global_timestep_max": 4900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.9333333333368, 1214.3833333333364, 1213.783333333336, 1213.5333333333365, 1213.6333333333364, 1214.3833333333362, 1213.583333333336, 1213.8333333333362, 1213.4333333333368, 1213.8333333333364, 1213.9333333333366, 1213.6833333333366, 1213.233333333336, 1213.8833333333364, 1213.833333333336, 1214.1833333333363, 1212.5833333333364, 1213.1833333333361, 1214.633333333336, 1213.4833333333363, 1213.2333333333358, 1213.7333333333363, 1214.1833333333361, 1214.6833333333361, 1213.9833333333363, 1213.2833333333367, 1213.2833333333363, 1214.8333333333367, 1213.3833333333362, 1214.7333333333358, 1213.5833333333364, 1213.333333333336, 1214.2333333333363, 1213.1333333333364, 1215.0333333333365, 1214.1833333333363, 1213.833333333336, 1213.2833333333358, 1213.5833333333358, 1214.7333333333363, 1213.783333333336, 1214.4833333333365, 1213.8333333333364, 1214.1833333333363, 1213.6333333333355, 1214.7333333333354, 1212.8833333333355, 1214.1333333333369, 1214.3333333333371, 1214.9333333333357, 1212.8333333333364, 1214.0333333333365, 1214.5333333333358, 1214.983333333336, 1213.9833333333365, 1214.7833333333363, 1214.6833333333361, 1213.983333333336, 1213.0333333333367, 1214.783333333336, 1213.5833333333358, 1213.9333333333368, 1214.283333333336, 1213.9833333333363, 1214.4333333333363, 1214.4333333333366, 1214.1833333333361, 1213.3833333333362, 1215.3833333333366, 1213.233333333336, 1214.0333333333353, 1214.783333333336, 1213.5333333333363, 1213.3833333333366, 1214.3833333333364, 1213.9333333333368, 1214.3833333333362, 1214.1333333333362, 1214.5833333333362, 1214.083333333336, 1214.6750000000027, 1213.333333333336, 1214.7333333333368, 1213.8833333333357, 1215.6333333333366, 1213.4333333333357, 1214.3833333333369, 1214.6333333333364, 1215.083333333336, 1214.4333333333361, 1214.0333333333365, 1213.483333333336, 1214.4333333333363, 1214.4333333333357, 1213.1333333333364, 1213.4833333333363, 1213.8333333333358, 1214.3333333333367, 1213.8833333333364, 1214.283333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.9333333333368, 1214.3833333333364, 1213.783333333336, 1213.5333333333365, 1213.6333333333364, 1214.3833333333362, 1213.583333333336, 1213.8333333333362, 1213.4333333333368, 1213.8333333333364, 1213.9333333333366, 1213.6833333333366, 1213.233333333336, 1213.8833333333364, 1213.833333333336, 1214.1833333333363, 1212.5833333333364, 1213.1833333333361, 1214.633333333336, 1213.4833333333363, 1213.2333333333358, 1213.7333333333363, 1214.1833333333361, 1214.6833333333361, 1213.9833333333363, 1213.2833333333367, 1213.2833333333363, 1214.8333333333367, 1213.3833333333362, 1214.7333333333358, 1213.5833333333364, 1213.333333333336, 1214.2333333333363, 1213.1333333333364, 1215.0333333333365, 1214.1833333333363, 1213.833333333336, 1213.2833333333358, 1213.5833333333358, 1214.7333333333363, 1213.783333333336, 1214.4833333333365, 1213.8333333333364, 1214.1833333333363, 1213.6333333333355, 1214.7333333333354, 1212.8833333333355, 1214.1333333333369, 1214.3333333333371, 1214.9333333333357, 1212.8333333333364, 1214.0333333333365, 1214.5333333333358, 1214.983333333336, 1213.9833333333365, 1214.7833333333363, 1214.6833333333361, 1213.983333333336, 1213.0333333333367, 1214.783333333336, 1213.5833333333358, 1213.9333333333368, 1214.283333333336, 1213.9833333333363, 1214.4333333333363, 1214.4333333333366, 1214.1833333333361, 1213.3833333333362, 1215.3833333333366, 1213.233333333336, 1214.0333333333353, 1214.783333333336, 1213.5333333333363, 1213.3833333333366, 1214.3833333333364, 1213.9333333333368, 1214.3833333333362, 1214.1333333333362, 1214.5833333333362, 1214.083333333336, 1214.6750000000027, 1213.333333333336, 1214.7333333333368, 1213.8833333333357, 1215.6333333333366, 1213.4333333333357, 1214.3833333333369, 1214.6333333333364, 1215.083333333336, 1214.4333333333361, 1214.0333333333365, 1213.483333333336, 1214.4333333333363, 1214.4333333333357, 1213.1333333333364, 1213.4833333333363, 1213.8333333333358, 1214.3333333333367, 1213.8833333333364, 1214.283333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24321558153111136, "mean_inference_ms": 2.074031886630099, "mean_action_processing_ms": 0.09119422728059728, "mean_env_wait_ms": 1.5434358274985618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007008075714111328, "StateBufferConnector_ms": 0.003368854522705078, "ViewRequirementAgentConnector_ms": 0.08723807334899902}, "num_episodes": 24, "episode_return_max": 1215.6333333333366, "episode_return_min": 1212.5833333333364, "episode_return_mean": 1214.014250000003, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 459300, "num_agent_steps_trained": 459000, "num_env_steps_sampled": 459300, "num_env_steps_trained": 459000, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 224.27570187574437, "num_env_steps_trained_throughput_per_sec": 209.32398841736142, "timesteps_total": 459300, "num_env_steps_sampled_lifetime": 459300, "num_agent_steps_sampled_lifetime": 459300, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 459300, "timers": {"training_iteration_time_ms": 10323.068, "restore_workers_time_ms": 0.017, "training_step_time_ms": 647.641, "sample_time_ms": 631.866, "synch_weights_time_ms": 14.209}, "counters": {"num_env_steps_sampled": 459300, "num_env_steps_trained": 459000, "num_agent_steps_sampled": 459300, "num_agent_steps_trained": 459000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3062, "num_samples_added_to_queue": 459300}, "done": false, "training_iteration": 183, "trial_id": "27800_00000", "date": "2024-10-12_15-59-29", "timestamp": 1728745169, "time_this_iter_s": 10.043678283691406, "time_total_s": 1893.9336650371552, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f687c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1893.9336650371552, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 19.89333333333333, "ram_util_percent": 67.09333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3830.683837890625, "policy_loss": 93.5927734375, "entropy": 4.9447174072265625, "entropy_coeff": 0.01, "var_gnorm": 18.100418090820312, "vf_loss": 375192.53125, "vf_explained_var": 0.6406999826431274}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1539.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 461850, "num_env_steps_trained": 461700, "num_agent_steps_sampled": 461850, "num_agent_steps_trained": 461700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3079, "num_samples_added_to_queue": 461700, "learner_queue": {"size_count": 1539, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 72.483, "learner_load_time_ms": 0.262, "learner_load_wait_time_ms": 1184.727, "learner_dequeue_time_ms": 10092.608}}, "env_runners": {"episode_reward_max": 1215.6333333333366, "episode_reward_min": 1212.383333333336, "episode_reward_mean": 1214.0827500000028, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.383333333336}, "policy_reward_max": {"default_policy": 1215.6333333333366}, "policy_reward_mean": {"default_policy": 1214.0827500000028}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.22219999999999998, "num_moves_min": 0.02, "num_moves_max": 0.52, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16282816666666666, "num_slav_min": 0.16180000000000003, "num_slav_max": 0.16396666666666668, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5462249080713366, "mean_cluster_cpu_util_min": 0.5428672205368634, "mean_cluster_cpu_util_max": 0.5491841790770363, "mean_cluster_mem_util_mean": 0.34163969409282685, "mean_cluster_mem_util_min": 0.34112447257383977, "mean_cluster_mem_util_max": 0.3420400843881856, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4424224999999997, "reward_sla_mean_min": -2.4595, "reward_sla_mean_max": -2.427, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.24225, "reward_sla_sum_min": -245.95, "reward_sla_sum_max": -242.7, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4083.0, "global_timestep_min": 2400, "global_timestep_max": 5700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.9833333333363, 1213.2833333333367, 1213.2833333333363, 1214.8333333333367, 1213.3833333333362, 1214.7333333333358, 1213.5833333333364, 1213.333333333336, 1214.2333333333363, 1213.1333333333364, 1215.0333333333365, 1214.1833333333363, 1213.833333333336, 1213.2833333333358, 1213.5833333333358, 1214.7333333333363, 1213.783333333336, 1214.4833333333365, 1213.8333333333364, 1214.1833333333363, 1213.6333333333355, 1214.7333333333354, 1212.8833333333355, 1214.1333333333369, 1214.3333333333371, 1214.9333333333357, 1212.8333333333364, 1214.0333333333365, 1214.5333333333358, 1214.983333333336, 1213.9833333333365, 1214.7833333333363, 1214.6833333333361, 1213.983333333336, 1213.0333333333367, 1214.783333333336, 1213.5833333333358, 1213.9333333333368, 1214.283333333336, 1213.9833333333363, 1214.4333333333363, 1214.4333333333366, 1214.1833333333361, 1213.3833333333362, 1215.3833333333366, 1213.233333333336, 1214.0333333333353, 1214.783333333336, 1213.5333333333363, 1213.3833333333366, 1214.3833333333364, 1213.9333333333368, 1214.3833333333362, 1214.1333333333362, 1214.5833333333362, 1214.083333333336, 1214.6750000000027, 1213.333333333336, 1214.7333333333368, 1213.8833333333357, 1215.6333333333366, 1213.4333333333357, 1214.3833333333369, 1214.6333333333364, 1215.083333333336, 1214.4333333333361, 1214.0333333333365, 1213.483333333336, 1214.4333333333363, 1214.4333333333357, 1213.1333333333364, 1213.4833333333363, 1213.8333333333358, 1214.3333333333367, 1213.8833333333364, 1214.283333333336, 1213.2833333333363, 1213.7333333333365, 1214.3333333333371, 1212.383333333336, 1213.8833333333364, 1214.0833333333362, 1214.733333333336, 1213.3833333333366, 1215.4333333333357, 1212.833333333336, 1213.9333333333363, 1213.5833333333362, 1215.2833333333363, 1214.1833333333361, 1213.1833333333363, 1214.3333333333362, 1213.333333333337, 1214.7833333333356, 1214.533333333336, 1215.283333333336, 1213.3833333333364, 1214.7333333333363, 1215.1833333333368, 1213.833333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.9833333333363, 1213.2833333333367, 1213.2833333333363, 1214.8333333333367, 1213.3833333333362, 1214.7333333333358, 1213.5833333333364, 1213.333333333336, 1214.2333333333363, 1213.1333333333364, 1215.0333333333365, 1214.1833333333363, 1213.833333333336, 1213.2833333333358, 1213.5833333333358, 1214.7333333333363, 1213.783333333336, 1214.4833333333365, 1213.8333333333364, 1214.1833333333363, 1213.6333333333355, 1214.7333333333354, 1212.8833333333355, 1214.1333333333369, 1214.3333333333371, 1214.9333333333357, 1212.8333333333364, 1214.0333333333365, 1214.5333333333358, 1214.983333333336, 1213.9833333333365, 1214.7833333333363, 1214.6833333333361, 1213.983333333336, 1213.0333333333367, 1214.783333333336, 1213.5833333333358, 1213.9333333333368, 1214.283333333336, 1213.9833333333363, 1214.4333333333363, 1214.4333333333366, 1214.1833333333361, 1213.3833333333362, 1215.3833333333366, 1213.233333333336, 1214.0333333333353, 1214.783333333336, 1213.5333333333363, 1213.3833333333366, 1214.3833333333364, 1213.9333333333368, 1214.3833333333362, 1214.1333333333362, 1214.5833333333362, 1214.083333333336, 1214.6750000000027, 1213.333333333336, 1214.7333333333368, 1213.8833333333357, 1215.6333333333366, 1213.4333333333357, 1214.3833333333369, 1214.6333333333364, 1215.083333333336, 1214.4333333333361, 1214.0333333333365, 1213.483333333336, 1214.4333333333363, 1214.4333333333357, 1213.1333333333364, 1213.4833333333363, 1213.8333333333358, 1214.3333333333367, 1213.8833333333364, 1214.283333333336, 1213.2833333333363, 1213.7333333333365, 1214.3333333333371, 1212.383333333336, 1213.8833333333364, 1214.0833333333362, 1214.733333333336, 1213.3833333333366, 1215.4333333333357, 1212.833333333336, 1213.9333333333363, 1213.5833333333362, 1215.2833333333363, 1214.1833333333361, 1213.1833333333363, 1214.3333333333362, 1213.333333333337, 1214.7833333333356, 1214.533333333336, 1215.283333333336, 1213.3833333333364, 1214.7333333333363, 1215.1833333333368, 1213.833333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2432428426267983, "mean_inference_ms": 2.074353141080606, "mean_action_processing_ms": 0.0912048509946748, "mean_env_wait_ms": 1.5435481019473405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067272186279296875, "StateBufferConnector_ms": 0.0033888816833496094, "ViewRequirementAgentConnector_ms": 0.08760476112365723}, "num_episodes": 24, "episode_return_max": 1215.6333333333366, "episode_return_min": 1212.383333333336, "episode_return_mean": 1214.0827500000028, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 461850, "num_agent_steps_trained": 461700, "num_env_steps_sampled": 461850, "num_env_steps_trained": 461700, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 240.00215958687264, "num_env_steps_trained_throughput_per_sec": 254.1199336802181, "timesteps_total": 461850, "num_env_steps_sampled_lifetime": 461850, "num_agent_steps_sampled_lifetime": 461850, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 461850, "timers": {"training_iteration_time_ms": 10358.278, "restore_workers_time_ms": 0.013, "training_step_time_ms": 625.979, "sample_time_ms": 610.994, "synch_weights_time_ms": 13.469}, "counters": {"num_env_steps_sampled": 461850, "num_env_steps_trained": 461700, "num_agent_steps_sampled": 461850, "num_agent_steps_trained": 461700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3079, "num_samples_added_to_queue": 461700}, "done": false, "training_iteration": 184, "trial_id": "27800_00000", "date": "2024-10-12_15-59-40", "timestamp": 1728745180, "time_this_iter_s": 10.634299278259277, "time_total_s": 1904.5679643154144, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d259c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1904.5679643154144, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 16.48, "ram_util_percent": 67.18666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4339.14697265625, "policy_loss": 516.779052734375, "entropy": 4.977550983428955, "entropy_coeff": 0.01, "var_gnorm": 18.0975284576416, "vf_loss": 383730.0625, "vf_explained_var": 0.6373432874679565}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1547.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 464250, "num_env_steps_trained": 464100, "num_agent_steps_sampled": 464250, "num_agent_steps_trained": 464100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3095, "num_samples_added_to_queue": 464100, "learner_queue": {"size_count": 1547, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.51, "learner_load_time_ms": 0.301, "learner_load_wait_time_ms": 1218.379, "learner_dequeue_time_ms": 10146.741}}, "env_runners": {"episode_reward_max": 1216.1833333333363, "episode_reward_min": 1212.383333333336, "episode_reward_mean": 1214.1818333333363, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.383333333336}, "policy_reward_max": {"default_policy": 1216.1833333333363}, "policy_reward_mean": {"default_policy": 1214.1818333333363}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.3042, "num_moves_min": 0.02, "num_moves_max": 0.63, "mean_accuracy_mean": 43.63314333333333, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63966666666667, "num_model_switches_mean": 0.001, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16275100000000006, "num_slav_min": 0.16118333333333332, "num_slav_max": 0.16396666666666668, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5453781972789116, "mean_cluster_cpu_util_min": 0.5415251654715941, "mean_cluster_cpu_util_max": 0.5491841790770363, "mean_cluster_mem_util_mean": 0.34164055379746844, "mean_cluster_mem_util_min": 0.34112447257383977, "mean_cluster_mem_util_max": 0.3420400843881856, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.33308333333336, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.341666666666695, "reward_sla_mean_mean": -2.4412649999999996, "reward_sla_mean_min": -2.4595, "reward_sla_mean_max": -2.41775, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3083333333362, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 834.1666666666695, "reward_sla_sum_mean": -244.12649999999996, "reward_sla_sum_min": -245.95, "reward_sla_sum_max": -241.775, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4878.0, "global_timestep_min": 3000, "global_timestep_max": 6500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.3333333333371, 1214.9333333333357, 1212.8333333333364, 1214.0333333333365, 1214.5333333333358, 1214.983333333336, 1213.9833333333365, 1214.7833333333363, 1214.6833333333361, 1213.983333333336, 1213.0333333333367, 1214.783333333336, 1213.5833333333358, 1213.9333333333368, 1214.283333333336, 1213.9833333333363, 1214.4333333333363, 1214.4333333333366, 1214.1833333333361, 1213.3833333333362, 1215.3833333333366, 1213.233333333336, 1214.0333333333353, 1214.783333333336, 1213.5333333333363, 1213.3833333333366, 1214.3833333333364, 1213.9333333333368, 1214.3833333333362, 1214.1333333333362, 1214.5833333333362, 1214.083333333336, 1214.6750000000027, 1213.333333333336, 1214.7333333333368, 1213.8833333333357, 1215.6333333333366, 1213.4333333333357, 1214.3833333333369, 1214.6333333333364, 1215.083333333336, 1214.4333333333361, 1214.0333333333365, 1213.483333333336, 1214.4333333333363, 1214.4333333333357, 1213.1333333333364, 1213.4833333333363, 1213.8333333333358, 1214.3333333333367, 1213.8833333333364, 1214.283333333336, 1213.2833333333363, 1213.7333333333365, 1214.3333333333371, 1212.383333333336, 1213.8833333333364, 1214.0833333333362, 1214.733333333336, 1213.3833333333366, 1215.4333333333357, 1212.833333333336, 1213.9333333333363, 1213.5833333333362, 1215.2833333333363, 1214.1833333333361, 1213.1833333333363, 1214.3333333333362, 1213.333333333337, 1214.7833333333356, 1214.533333333336, 1215.283333333336, 1213.3833333333364, 1214.7333333333363, 1215.1833333333368, 1213.833333333336, 1213.5333333333365, 1214.4833333333363, 1213.2833333333367, 1214.133333333336, 1216.1833333333363, 1213.7333333333365, 1212.7833333333365, 1215.7250000000026, 1214.1333333333362, 1214.0333333333365, 1214.2333333333358, 1214.8500000000029, 1213.783333333336, 1215.0500000000027, 1214.7833333333365, 1214.9833333333365, 1213.0333333333363, 1214.5833333333367, 1214.633333333336, 1215.3333333333362, 1213.816666666669, 1214.5333333333358, 1213.6333333333362, 1214.7333333333363], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.3333333333371, 1214.9333333333357, 1212.8333333333364, 1214.0333333333365, 1214.5333333333358, 1214.983333333336, 1213.9833333333365, 1214.7833333333363, 1214.6833333333361, 1213.983333333336, 1213.0333333333367, 1214.783333333336, 1213.5833333333358, 1213.9333333333368, 1214.283333333336, 1213.9833333333363, 1214.4333333333363, 1214.4333333333366, 1214.1833333333361, 1213.3833333333362, 1215.3833333333366, 1213.233333333336, 1214.0333333333353, 1214.783333333336, 1213.5333333333363, 1213.3833333333366, 1214.3833333333364, 1213.9333333333368, 1214.3833333333362, 1214.1333333333362, 1214.5833333333362, 1214.083333333336, 1214.6750000000027, 1213.333333333336, 1214.7333333333368, 1213.8833333333357, 1215.6333333333366, 1213.4333333333357, 1214.3833333333369, 1214.6333333333364, 1215.083333333336, 1214.4333333333361, 1214.0333333333365, 1213.483333333336, 1214.4333333333363, 1214.4333333333357, 1213.1333333333364, 1213.4833333333363, 1213.8333333333358, 1214.3333333333367, 1213.8833333333364, 1214.283333333336, 1213.2833333333363, 1213.7333333333365, 1214.3333333333371, 1212.383333333336, 1213.8833333333364, 1214.0833333333362, 1214.733333333336, 1213.3833333333366, 1215.4333333333357, 1212.833333333336, 1213.9333333333363, 1213.5833333333362, 1215.2833333333363, 1214.1833333333361, 1213.1833333333363, 1214.3333333333362, 1213.333333333337, 1214.7833333333356, 1214.533333333336, 1215.283333333336, 1213.3833333333364, 1214.7333333333363, 1215.1833333333368, 1213.833333333336, 1213.5333333333365, 1214.4833333333363, 1213.2833333333367, 1214.133333333336, 1216.1833333333363, 1213.7333333333365, 1212.7833333333365, 1215.7250000000026, 1214.1333333333362, 1214.0333333333365, 1214.2333333333358, 1214.8500000000029, 1213.783333333336, 1215.0500000000027, 1214.7833333333365, 1214.9833333333365, 1213.0333333333363, 1214.5833333333367, 1214.633333333336, 1215.3333333333362, 1213.816666666669, 1214.5333333333358, 1213.6333333333362, 1214.7333333333363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24323699440692081, "mean_inference_ms": 2.0727778492002793, "mean_action_processing_ms": 0.09119479308660892, "mean_env_wait_ms": 1.5431947375247848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00659632682800293, "StateBufferConnector_ms": 0.0034258365631103516, "ViewRequirementAgentConnector_ms": 0.08788108825683594}, "num_episodes": 24, "episode_return_max": 1216.1833333333363, "episode_return_min": 1212.383333333336, "episode_return_mean": 1214.1818333333363, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464250, "num_agent_steps_trained": 464100, "num_env_steps_sampled": 464250, "num_env_steps_trained": 464100, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 236.57472078117019, "num_env_steps_trained_throughput_per_sec": 236.57472078117019, "timesteps_total": 464250, "num_env_steps_sampled_lifetime": 464250, "num_agent_steps_sampled_lifetime": 464250, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 464250, "timers": {"training_iteration_time_ms": 10348.311, "restore_workers_time_ms": 0.014, "training_step_time_ms": 644.293, "sample_time_ms": 628.483, "synch_weights_time_ms": 14.317}, "counters": {"num_env_steps_sampled": 464250, "num_env_steps_trained": 464100, "num_agent_steps_sampled": 464250, "num_agent_steps_trained": 464100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3095, "num_samples_added_to_queue": 464100}, "done": false, "training_iteration": 185, "trial_id": "27800_00000", "date": "2024-10-12_15-59-50", "timestamp": 1728745190, "time_this_iter_s": 10.156036376953125, "time_total_s": 1914.7240006923676, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f6a140>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1914.7240006923676, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 16.435714285714287, "ram_util_percent": 67.24999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4093.2177734375, "policy_loss": 176.0562286376953, "entropy": 5.004627704620361, "entropy_coeff": 0.01, "var_gnorm": 18.0956974029541, "vf_loss": 393217.5625, "vf_explained_var": 0.6349691152572632}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1555.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 466800, "num_env_steps_trained": 466500, "num_agent_steps_sampled": 466800, "num_agent_steps_trained": 466500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3112, "num_samples_added_to_queue": 466800, "learner_queue": {"size_count": 1555, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.487, "learner_load_time_ms": 0.282, "learner_load_wait_time_ms": 1163.179, "learner_dequeue_time_ms": 10106.307}}, "env_runners": {"episode_reward_max": 1216.1833333333363, "episode_reward_min": 1212.383333333336, "episode_reward_mean": 1214.1869166666695, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.383333333336}, "policy_reward_max": {"default_policy": 1216.1833333333363}, "policy_reward_mean": {"default_policy": 1214.1869166666695}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.4132, "num_moves_min": 0.1, "num_moves_max": 0.66, "mean_accuracy_mean": 43.63263666666668, "mean_accuracy_min": 43.62066666666667, "mean_accuracy_max": 43.63966666666667, "num_model_switches_mean": 0.0026, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.1627031666666667, "num_slav_min": 0.16118333333333332, "num_slav_max": 0.16396666666666668, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5441592226282405, "mean_cluster_cpu_util_min": 0.5403710930318073, "mean_cluster_cpu_util_max": 0.5491841790770363, "mean_cluster_mem_util_mean": 0.34161119198312234, "mean_cluster_mem_util_min": 0.34112447257383977, "mean_cluster_mem_util_max": 0.3420390295358649, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.332416666666694, "reward_accuracy_mean_min": 8.316666666666695, "reward_accuracy_mean_max": 8.341666666666695, "reward_sla_mean_mean": -2.4405474999999996, "reward_sla_mean_min": -2.4595, "reward_sla_mean_max": -2.41775, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.2416666666695, "reward_accuracy_sum_min": 831.6666666666695, "reward_accuracy_sum_max": 834.1666666666695, "reward_sla_sum_mean": -244.05474999999998, "reward_sla_sum_min": -245.95, "reward_sla_sum_max": -241.775, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5783.0, "global_timestep_min": 4100, "global_timestep_max": 7400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.9333333333368, 1214.3833333333362, 1214.1333333333362, 1214.5833333333362, 1214.083333333336, 1214.6750000000027, 1213.333333333336, 1214.7333333333368, 1213.8833333333357, 1215.6333333333366, 1213.4333333333357, 1214.3833333333369, 1214.6333333333364, 1215.083333333336, 1214.4333333333361, 1214.0333333333365, 1213.483333333336, 1214.4333333333363, 1214.4333333333357, 1213.1333333333364, 1213.4833333333363, 1213.8333333333358, 1214.3333333333367, 1213.8833333333364, 1214.283333333336, 1213.2833333333363, 1213.7333333333365, 1214.3333333333371, 1212.383333333336, 1213.8833333333364, 1214.0833333333362, 1214.733333333336, 1213.3833333333366, 1215.4333333333357, 1212.833333333336, 1213.9333333333363, 1213.5833333333362, 1215.2833333333363, 1214.1833333333361, 1213.1833333333363, 1214.3333333333362, 1213.333333333337, 1214.7833333333356, 1214.533333333336, 1215.283333333336, 1213.3833333333364, 1214.7333333333363, 1215.1833333333368, 1213.833333333336, 1213.5333333333365, 1214.4833333333363, 1213.2833333333367, 1214.133333333336, 1216.1833333333363, 1213.7333333333365, 1212.7833333333365, 1215.7250000000026, 1214.1333333333362, 1214.0333333333365, 1214.2333333333358, 1214.8500000000029, 1213.783333333336, 1215.0500000000027, 1214.7833333333365, 1214.9833333333365, 1213.0333333333363, 1214.5833333333367, 1214.633333333336, 1215.3333333333362, 1213.816666666669, 1214.5333333333358, 1213.6333333333362, 1214.7333333333363, 1213.183333333336, 1213.8333333333364, 1213.8833333333364, 1215.3333333333364, 1214.3916666666703, 1214.2333333333358, 1214.2250000000026, 1213.633333333336, 1213.8333333333362, 1214.7333333333363, 1214.6333333333369, 1213.7333333333358, 1213.5333333333365, 1213.683333333336, 1214.5250000000028, 1212.7500000000032, 1214.9333333333363, 1214.6750000000022, 1214.783333333337, 1214.4833333333368, 1213.983333333336, 1214.1833333333366, 1214.333333333336, 1214.233333333336, 1214.3000000000031, 1213.5333333333358, 1214.7750000000026], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.9333333333368, 1214.3833333333362, 1214.1333333333362, 1214.5833333333362, 1214.083333333336, 1214.6750000000027, 1213.333333333336, 1214.7333333333368, 1213.8833333333357, 1215.6333333333366, 1213.4333333333357, 1214.3833333333369, 1214.6333333333364, 1215.083333333336, 1214.4333333333361, 1214.0333333333365, 1213.483333333336, 1214.4333333333363, 1214.4333333333357, 1213.1333333333364, 1213.4833333333363, 1213.8333333333358, 1214.3333333333367, 1213.8833333333364, 1214.283333333336, 1213.2833333333363, 1213.7333333333365, 1214.3333333333371, 1212.383333333336, 1213.8833333333364, 1214.0833333333362, 1214.733333333336, 1213.3833333333366, 1215.4333333333357, 1212.833333333336, 1213.9333333333363, 1213.5833333333362, 1215.2833333333363, 1214.1833333333361, 1213.1833333333363, 1214.3333333333362, 1213.333333333337, 1214.7833333333356, 1214.533333333336, 1215.283333333336, 1213.3833333333364, 1214.7333333333363, 1215.1833333333368, 1213.833333333336, 1213.5333333333365, 1214.4833333333363, 1213.2833333333367, 1214.133333333336, 1216.1833333333363, 1213.7333333333365, 1212.7833333333365, 1215.7250000000026, 1214.1333333333362, 1214.0333333333365, 1214.2333333333358, 1214.8500000000029, 1213.783333333336, 1215.0500000000027, 1214.7833333333365, 1214.9833333333365, 1213.0333333333363, 1214.5833333333367, 1214.633333333336, 1215.3333333333362, 1213.816666666669, 1214.5333333333358, 1213.6333333333362, 1214.7333333333363, 1213.183333333336, 1213.8333333333364, 1213.8833333333364, 1215.3333333333364, 1214.3916666666703, 1214.2333333333358, 1214.2250000000026, 1213.633333333336, 1213.8333333333362, 1214.7333333333363, 1214.6333333333369, 1213.7333333333358, 1213.5333333333365, 1213.683333333336, 1214.5250000000028, 1212.7500000000032, 1214.9333333333363, 1214.6750000000022, 1214.783333333337, 1214.4833333333368, 1213.983333333336, 1214.1833333333366, 1214.333333333336, 1214.233333333336, 1214.3000000000031, 1213.5333333333358, 1214.7750000000026]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24331256343384083, "mean_inference_ms": 2.0751205551405825, "mean_action_processing_ms": 0.091227104070225, "mean_env_wait_ms": 1.5438687284379728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066449642181396484, "StateBufferConnector_ms": 0.003481149673461914, "ViewRequirementAgentConnector_ms": 0.08820486068725586}, "num_episodes": 27, "episode_return_max": 1216.1833333333363, "episode_return_min": 1212.383333333336, "episode_return_mean": 1214.1869166666695, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 466800, "num_agent_steps_trained": 466500, "num_env_steps_sampled": 466800, "num_env_steps_trained": 466500, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 245.28211694173964, "num_env_steps_trained_throughput_per_sec": 230.85375712163733, "timesteps_total": 466800, "num_env_steps_sampled_lifetime": 466800, "num_agent_steps_sampled_lifetime": 466800, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 466800, "timers": {"training_iteration_time_ms": 10356.458, "restore_workers_time_ms": 0.012, "training_step_time_ms": 602.759, "sample_time_ms": 587.308, "synch_weights_time_ms": 13.997}, "counters": {"num_env_steps_sampled": 466800, "num_env_steps_trained": 466500, "num_agent_steps_sampled": 466800, "num_agent_steps_trained": 466500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3112, "num_samples_added_to_queue": 466800}, "done": false, "training_iteration": 186, "trial_id": "27800_00000", "date": "2024-10-12_16-00-01", "timestamp": 1728745201, "time_this_iter_s": 10.406888484954834, "time_total_s": 1925.1308891773224, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f0fa0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1925.1308891773224, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 16.966666666666665, "ram_util_percent": 66.78666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3175.9111328125, "policy_loss": -514.0963745117188, "entropy": 5.003147602081299, "entropy_coeff": 0.01, "var_gnorm": 18.09661865234375, "vf_loss": 370501.6875, "vf_explained_var": 0.6617246866226196}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1563.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 469200, "num_env_steps_trained": 468900, "num_agent_steps_sampled": 469200, "num_agent_steps_trained": 468900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3128, "num_samples_added_to_queue": 469200, "learner_queue": {"size_count": 1563, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 74.486, "learner_load_time_ms": 0.277, "learner_load_wait_time_ms": 1176.956, "learner_dequeue_time_ms": 10115.699}}, "env_runners": {"episode_reward_max": 1216.1833333333363, "episode_reward_min": 1212.383333333336, "episode_reward_mean": 1214.222000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.383333333336}, "policy_reward_max": {"default_policy": 1216.1833333333363}, "policy_reward_mean": {"default_policy": 1214.222000000003}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.4918, "num_moves_min": 0.21, "num_moves_max": 0.66, "mean_accuracy_mean": 43.63232000000001, "mean_accuracy_min": 43.62066666666667, "mean_accuracy_max": 43.63966666666667, "num_model_switches_mean": 0.004600000000000001, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.16265200000000005, "num_slav_min": 0.16118333333333332, "num_slav_max": 0.16396666666666668, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5431384377872771, "mean_cluster_cpu_util_min": 0.5400048377459092, "mean_cluster_cpu_util_max": 0.5491841790770363, "mean_cluster_mem_util_mean": 0.3416266455696202, "mean_cluster_mem_util_min": 0.34125369198312233, "mean_cluster_mem_util_max": 0.3420516877637131, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.332000000000027, "reward_accuracy_mean_min": 8.316666666666695, "reward_accuracy_mean_max": 8.341666666666695, "reward_sla_mean_mean": -2.4397799999999994, "reward_sla_mean_min": -2.4595, "reward_sla_mean_max": -2.41775, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.2000000000027, "reward_accuracy_sum_min": 831.6666666666695, "reward_accuracy_sum_max": 834.1666666666695, "reward_sla_sum_mean": -243.97799999999992, "reward_sla_sum_min": -245.95, "reward_sla_sum_max": -241.775, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5647.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.283333333336, 1213.2833333333363, 1213.7333333333365, 1214.3333333333371, 1212.383333333336, 1213.8833333333364, 1214.0833333333362, 1214.733333333336, 1213.3833333333366, 1215.4333333333357, 1212.833333333336, 1213.9333333333363, 1213.5833333333362, 1215.2833333333363, 1214.1833333333361, 1213.1833333333363, 1214.3333333333362, 1213.333333333337, 1214.7833333333356, 1214.533333333336, 1215.283333333336, 1213.3833333333364, 1214.7333333333363, 1215.1833333333368, 1213.833333333336, 1213.5333333333365, 1214.4833333333363, 1213.2833333333367, 1214.133333333336, 1216.1833333333363, 1213.7333333333365, 1212.7833333333365, 1215.7250000000026, 1214.1333333333362, 1214.0333333333365, 1214.2333333333358, 1214.8500000000029, 1213.783333333336, 1215.0500000000027, 1214.7833333333365, 1214.9833333333365, 1213.0333333333363, 1214.5833333333367, 1214.633333333336, 1215.3333333333362, 1213.816666666669, 1214.5333333333358, 1213.6333333333362, 1214.7333333333363, 1213.183333333336, 1213.8333333333364, 1213.8833333333364, 1215.3333333333364, 1214.3916666666703, 1214.2333333333358, 1214.2250000000026, 1213.633333333336, 1213.8333333333362, 1214.7333333333363, 1214.6333333333369, 1213.7333333333358, 1213.5333333333365, 1213.683333333336, 1214.5250000000028, 1212.7500000000032, 1214.9333333333363, 1214.6750000000022, 1214.783333333337, 1214.4833333333368, 1213.983333333336, 1214.1833333333366, 1214.333333333336, 1214.233333333336, 1214.3000000000031, 1213.5333333333358, 1214.7750000000026, 1214.0083333333364, 1214.4250000000027, 1214.3333333333358, 1213.7333333333363, 1214.1333333333357, 1214.1333333333369, 1214.1333333333364, 1215.0250000000035, 1213.6333333333355, 1213.6833333333361, 1215.0333333333365, 1214.0333333333363, 1215.5333333333367, 1213.3833333333362, 1214.2750000000026, 1214.1333333333362, 1214.283333333336, 1213.225000000003, 1214.283333333336, 1214.483333333336, 1214.783333333336, 1215.283333333336, 1215.0250000000026, 1214.900000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.283333333336, 1213.2833333333363, 1213.7333333333365, 1214.3333333333371, 1212.383333333336, 1213.8833333333364, 1214.0833333333362, 1214.733333333336, 1213.3833333333366, 1215.4333333333357, 1212.833333333336, 1213.9333333333363, 1213.5833333333362, 1215.2833333333363, 1214.1833333333361, 1213.1833333333363, 1214.3333333333362, 1213.333333333337, 1214.7833333333356, 1214.533333333336, 1215.283333333336, 1213.3833333333364, 1214.7333333333363, 1215.1833333333368, 1213.833333333336, 1213.5333333333365, 1214.4833333333363, 1213.2833333333367, 1214.133333333336, 1216.1833333333363, 1213.7333333333365, 1212.7833333333365, 1215.7250000000026, 1214.1333333333362, 1214.0333333333365, 1214.2333333333358, 1214.8500000000029, 1213.783333333336, 1215.0500000000027, 1214.7833333333365, 1214.9833333333365, 1213.0333333333363, 1214.5833333333367, 1214.633333333336, 1215.3333333333362, 1213.816666666669, 1214.5333333333358, 1213.6333333333362, 1214.7333333333363, 1213.183333333336, 1213.8333333333364, 1213.8833333333364, 1215.3333333333364, 1214.3916666666703, 1214.2333333333358, 1214.2250000000026, 1213.633333333336, 1213.8333333333362, 1214.7333333333363, 1214.6333333333369, 1213.7333333333358, 1213.5333333333365, 1213.683333333336, 1214.5250000000028, 1212.7500000000032, 1214.9333333333363, 1214.6750000000022, 1214.783333333337, 1214.4833333333368, 1213.983333333336, 1214.1833333333366, 1214.333333333336, 1214.233333333336, 1214.3000000000031, 1213.5333333333358, 1214.7750000000026, 1214.0083333333364, 1214.4250000000027, 1214.3333333333358, 1213.7333333333363, 1214.1333333333357, 1214.1333333333369, 1214.1333333333364, 1215.0250000000035, 1213.6333333333355, 1213.6833333333361, 1215.0333333333365, 1214.0333333333363, 1215.5333333333367, 1213.3833333333362, 1214.2750000000026, 1214.1333333333362, 1214.283333333336, 1213.225000000003, 1214.283333333336, 1214.483333333336, 1214.783333333336, 1215.283333333336, 1215.0250000000026, 1214.900000000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24334090852117365, "mean_inference_ms": 2.0752435235812046, "mean_action_processing_ms": 0.09123209693197304, "mean_env_wait_ms": 1.543939834184016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006588935852050781, "StateBufferConnector_ms": 0.0034515857696533203, "ViewRequirementAgentConnector_ms": 0.08740711212158203}, "num_episodes": 24, "episode_return_max": 1216.1833333333363, "episode_return_min": 1212.383333333336, "episode_return_mean": 1214.222000000003, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 469200, "num_agent_steps_trained": 468900, "num_env_steps_sampled": 469200, "num_env_steps_trained": 468900, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 238.38284817444526, "num_env_steps_trained_throughput_per_sec": 238.38284817444526, "timesteps_total": 469200, "num_env_steps_sampled_lifetime": 469200, "num_agent_steps_sampled_lifetime": 469200, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 469200, "timers": {"training_iteration_time_ms": 10304.203, "restore_workers_time_ms": 0.014, "training_step_time_ms": 621.868, "sample_time_ms": 605.801, "synch_weights_time_ms": 14.414}, "counters": {"num_env_steps_sampled": 469200, "num_env_steps_trained": 468900, "num_agent_steps_sampled": 469200, "num_agent_steps_trained": 468900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3128, "num_samples_added_to_queue": 469200}, "done": false, "training_iteration": 187, "trial_id": "27800_00000", "date": "2024-10-12_16-00-11", "timestamp": 1728745211, "time_this_iter_s": 10.077460050582886, "time_total_s": 1935.2083492279053, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f0970>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1935.2083492279053, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 16.60666666666667, "ram_util_percent": 66.75999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4157.41796875, "policy_loss": -279.4843444824219, "entropy": 5.018219470977783, "entropy_coeff": 0.01, "var_gnorm": 18.086471557617188, "vf_loss": 445195.71875, "vf_explained_var": 0.5967368483543396}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1571.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 471600, "num_env_steps_trained": 471300, "num_agent_steps_sampled": 471600, "num_agent_steps_trained": 471300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3144, "num_samples_added_to_queue": 471600, "learner_queue": {"size_count": 1571, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 73.28, "learner_load_time_ms": 0.303, "learner_load_wait_time_ms": 1209.613, "learner_dequeue_time_ms": 10144.294}}, "env_runners": {"episode_reward_max": 1216.1833333333363, "episode_reward_min": 1212.633333333336, "episode_reward_mean": 1214.1866666666695, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.633333333336}, "policy_reward_max": {"default_policy": 1216.1833333333363}, "policy_reward_mean": {"default_policy": 1214.1866666666695}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.5187, "num_moves_min": 0.41, "num_moves_max": 0.66, "mean_accuracy_mean": 43.63187666666667, "mean_accuracy_min": 43.62066666666667, "mean_accuracy_max": 43.63966666666667, "num_model_switches_mean": 0.006000000000000001, "num_model_switches_min": 0.0, "num_model_switches_max": 0.04, "num_slav_mean": 0.16263666666666665, "num_slav_min": 0.16118333333333332, "num_slav_max": 0.16380000000000003, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5427797242140098, "mean_cluster_cpu_util_min": 0.5400048377459092, "mean_cluster_cpu_util_max": 0.5450859188269902, "mean_cluster_mem_util_mean": 0.34161427742616035, "mean_cluster_mem_util_min": 0.34125369198312233, "mean_cluster_mem_util_max": 0.3420516877637131, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.331416666666692, "reward_accuracy_mean_min": 8.316666666666695, "reward_accuracy_mean_max": 8.341666666666695, "reward_sla_mean_mean": -2.4395499999999997, "reward_sla_mean_min": -2.457, "reward_sla_mean_max": -2.41775, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.1416666666695, "reward_accuracy_sum_min": 831.6666666666695, "reward_accuracy_sum_max": 834.1666666666695, "reward_sla_sum_mean": -243.95500000000004, "reward_sla_sum_min": -245.7, "reward_sla_sum_max": -241.775, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4575.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.833333333336, 1213.5333333333365, 1214.4833333333363, 1213.2833333333367, 1214.133333333336, 1216.1833333333363, 1213.7333333333365, 1212.7833333333365, 1215.7250000000026, 1214.1333333333362, 1214.0333333333365, 1214.2333333333358, 1214.8500000000029, 1213.783333333336, 1215.0500000000027, 1214.7833333333365, 1214.9833333333365, 1213.0333333333363, 1214.5833333333367, 1214.633333333336, 1215.3333333333362, 1213.816666666669, 1214.5333333333358, 1213.6333333333362, 1214.7333333333363, 1213.183333333336, 1213.8333333333364, 1213.8833333333364, 1215.3333333333364, 1214.3916666666703, 1214.2333333333358, 1214.2250000000026, 1213.633333333336, 1213.8333333333362, 1214.7333333333363, 1214.6333333333369, 1213.7333333333358, 1213.5333333333365, 1213.683333333336, 1214.5250000000028, 1212.7500000000032, 1214.9333333333363, 1214.6750000000022, 1214.783333333337, 1214.4833333333368, 1213.983333333336, 1214.1833333333366, 1214.333333333336, 1214.233333333336, 1214.3000000000031, 1213.5333333333358, 1214.7750000000026, 1214.0083333333364, 1214.4250000000027, 1214.3333333333358, 1213.7333333333363, 1214.1333333333357, 1214.1333333333369, 1214.1333333333364, 1215.0250000000035, 1213.6333333333355, 1213.6833333333361, 1215.0333333333365, 1214.0333333333363, 1215.5333333333367, 1213.3833333333362, 1214.2750000000026, 1214.1333333333362, 1214.283333333336, 1213.225000000003, 1214.283333333336, 1214.483333333336, 1214.783333333336, 1215.283333333336, 1215.0250000000026, 1214.900000000003, 1213.8333333333355, 1213.0833333333364, 1214.5916666666699, 1213.3333333333358, 1214.383333333336, 1212.633333333336, 1214.5166666666694, 1215.1500000000024, 1213.6833333333366, 1213.983333333337, 1215.0333333333363, 1213.4333333333366, 1214.0333333333356, 1214.483333333336, 1213.3833333333362, 1214.783333333336, 1212.8250000000028, 1213.733333333336, 1214.183333333336, 1213.7333333333363, 1212.6333333333364, 1214.3000000000022, 1213.9333333333363, 1214.883333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.833333333336, 1213.5333333333365, 1214.4833333333363, 1213.2833333333367, 1214.133333333336, 1216.1833333333363, 1213.7333333333365, 1212.7833333333365, 1215.7250000000026, 1214.1333333333362, 1214.0333333333365, 1214.2333333333358, 1214.8500000000029, 1213.783333333336, 1215.0500000000027, 1214.7833333333365, 1214.9833333333365, 1213.0333333333363, 1214.5833333333367, 1214.633333333336, 1215.3333333333362, 1213.816666666669, 1214.5333333333358, 1213.6333333333362, 1214.7333333333363, 1213.183333333336, 1213.8333333333364, 1213.8833333333364, 1215.3333333333364, 1214.3916666666703, 1214.2333333333358, 1214.2250000000026, 1213.633333333336, 1213.8333333333362, 1214.7333333333363, 1214.6333333333369, 1213.7333333333358, 1213.5333333333365, 1213.683333333336, 1214.5250000000028, 1212.7500000000032, 1214.9333333333363, 1214.6750000000022, 1214.783333333337, 1214.4833333333368, 1213.983333333336, 1214.1833333333366, 1214.333333333336, 1214.233333333336, 1214.3000000000031, 1213.5333333333358, 1214.7750000000026, 1214.0083333333364, 1214.4250000000027, 1214.3333333333358, 1213.7333333333363, 1214.1333333333357, 1214.1333333333369, 1214.1333333333364, 1215.0250000000035, 1213.6333333333355, 1213.6833333333361, 1215.0333333333365, 1214.0333333333363, 1215.5333333333367, 1213.3833333333362, 1214.2750000000026, 1214.1333333333362, 1214.283333333336, 1213.225000000003, 1214.283333333336, 1214.483333333336, 1214.783333333336, 1215.283333333336, 1215.0250000000026, 1214.900000000003, 1213.8333333333355, 1213.0833333333364, 1214.5916666666699, 1213.3333333333358, 1214.383333333336, 1212.633333333336, 1214.5166666666694, 1215.1500000000024, 1213.6833333333366, 1213.983333333337, 1215.0333333333363, 1213.4333333333366, 1214.0333333333356, 1214.483333333336, 1213.3833333333362, 1214.783333333336, 1212.8250000000028, 1213.733333333336, 1214.183333333336, 1213.7333333333363, 1212.6333333333364, 1214.3000000000022, 1213.9333333333363, 1214.883333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24336555002977986, "mean_inference_ms": 2.0754721836044894, "mean_action_processing_ms": 0.09123963411754826, "mean_env_wait_ms": 1.544063594474202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065381526947021484, "StateBufferConnector_ms": 0.003408670425415039, "ViewRequirementAgentConnector_ms": 0.08599638938903809}, "num_episodes": 24, "episode_return_max": 1216.1833333333363, "episode_return_min": 1212.633333333336, "episode_return_mean": 1214.1866666666695, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 471600, "num_agent_steps_trained": 471300, "num_env_steps_sampled": 471600, "num_env_steps_trained": 471300, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 232.30861648432523, "num_env_steps_trained_throughput_per_sec": 232.30861648432523, "timesteps_total": 471600, "num_env_steps_sampled_lifetime": 471600, "num_agent_steps_sampled_lifetime": 471600, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 471600, "timers": {"training_iteration_time_ms": 10302.72, "restore_workers_time_ms": 0.013, "training_step_time_ms": 641.5, "sample_time_ms": 625.741, "synch_weights_time_ms": 14.204}, "counters": {"num_env_steps_sampled": 471600, "num_env_steps_trained": 471300, "num_agent_steps_sampled": 471600, "num_agent_steps_trained": 471300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3144, "num_samples_added_to_queue": 471600}, "done": false, "training_iteration": 188, "trial_id": "27800_00000", "date": "2024-10-12_16-00-21", "timestamp": 1728745221, "time_this_iter_s": 10.341318130493164, "time_total_s": 1945.5496673583984, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f68bb0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1945.5496673583984, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 16.414285714285715, "ram_util_percent": 66.84285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4245.953125, "policy_loss": 206.38998413085938, "entropy": 5.177795886993408, "entropy_coeff": 0.01, "var_gnorm": 18.069835662841797, "vf_loss": 405509.6875, "vf_explained_var": 0.6108177900314331}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1579.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 473850, "num_env_steps_trained": 473700, "num_agent_steps_sampled": 473850, "num_agent_steps_trained": 473700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3159, "num_samples_added_to_queue": 473700, "learner_queue": {"size_count": 1579, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 77.088, "learner_load_time_ms": 0.29, "learner_load_wait_time_ms": 1273.879, "learner_dequeue_time_ms": 10158.466}}, "env_runners": {"episode_reward_max": 1215.7666666666698, "episode_reward_min": 1212.4833333333363, "episode_reward_mean": 1214.1624166666695, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.4833333333363}, "policy_reward_max": {"default_policy": 1215.7666666666698}, "policy_reward_mean": {"default_policy": 1214.1624166666695}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.5276000000000001, "num_moves_min": 0.42, "num_moves_max": 0.72, "mean_accuracy_mean": 43.630926666666674, "mean_accuracy_min": 43.61433333333334, "mean_accuracy_max": 43.63966666666667, "num_model_switches_mean": 0.009000000000000001, "num_model_switches_min": 0.0, "num_model_switches_max": 0.06, "num_slav_mean": 0.16256950000000003, "num_slav_min": 0.16058333333333333, "num_slav_max": 0.16390000000000002, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.542766404669976, "mean_cluster_cpu_util_min": 0.5400048377459092, "mean_cluster_cpu_util_max": 0.5456745150763008, "mean_cluster_mem_util_mean": 0.34160895569620253, "mean_cluster_mem_util_min": 0.34112974683544295, "mean_cluster_mem_util_max": 0.3420516877637131, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.330166666666694, "reward_accuracy_mean_min": 8.30833333333336, "reward_accuracy_mean_max": 8.341666666666695, "reward_sla_mean_mean": -2.4385424999999996, "reward_sla_mean_min": -2.4585, "reward_sla_mean_max": -2.4087499999999995, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.0166666666695, "reward_accuracy_sum_min": 830.8333333333361, "reward_accuracy_sum_max": 834.1666666666695, "reward_sla_sum_mean": -243.85424999999995, "reward_sla_sum_min": -245.85, "reward_sla_sum_max": -240.87499999999997, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3632.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.816666666669, 1214.5333333333358, 1213.6333333333362, 1214.7333333333363, 1213.183333333336, 1213.8333333333364, 1213.8833333333364, 1215.3333333333364, 1214.3916666666703, 1214.2333333333358, 1214.2250000000026, 1213.633333333336, 1213.8333333333362, 1214.7333333333363, 1214.6333333333369, 1213.7333333333358, 1213.5333333333365, 1213.683333333336, 1214.5250000000028, 1212.7500000000032, 1214.9333333333363, 1214.6750000000022, 1214.783333333337, 1214.4833333333368, 1213.983333333336, 1214.1833333333366, 1214.333333333336, 1214.233333333336, 1214.3000000000031, 1213.5333333333358, 1214.7750000000026, 1214.0083333333364, 1214.4250000000027, 1214.3333333333358, 1213.7333333333363, 1214.1333333333357, 1214.1333333333369, 1214.1333333333364, 1215.0250000000035, 1213.6333333333355, 1213.6833333333361, 1215.0333333333365, 1214.0333333333363, 1215.5333333333367, 1213.3833333333362, 1214.2750000000026, 1214.1333333333362, 1214.283333333336, 1213.225000000003, 1214.283333333336, 1214.483333333336, 1214.783333333336, 1215.283333333336, 1215.0250000000026, 1214.900000000003, 1213.8333333333355, 1213.0833333333364, 1214.5916666666699, 1213.3333333333358, 1214.383333333336, 1212.633333333336, 1214.5166666666694, 1215.1500000000024, 1213.6833333333366, 1213.983333333337, 1215.0333333333363, 1213.4333333333366, 1214.0333333333356, 1214.483333333336, 1213.3833333333362, 1214.783333333336, 1212.8250000000028, 1213.733333333336, 1214.183333333336, 1213.7333333333363, 1212.6333333333364, 1214.3000000000022, 1213.9333333333363, 1214.883333333336, 1213.833333333336, 1213.483333333338, 1214.9583333333362, 1215.7666666666698, 1214.200000000003, 1214.2333333333365, 1214.6416666666696, 1213.9833333333368, 1214.6416666666698, 1215.2166666666694, 1214.4250000000027, 1213.7500000000032, 1214.5416666666695, 1213.2333333333368, 1213.733333333336, 1214.4333333333361, 1212.4833333333363, 1213.333333333336, 1215.4000000000028, 1213.6750000000031, 1214.733333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.816666666669, 1214.5333333333358, 1213.6333333333362, 1214.7333333333363, 1213.183333333336, 1213.8333333333364, 1213.8833333333364, 1215.3333333333364, 1214.3916666666703, 1214.2333333333358, 1214.2250000000026, 1213.633333333336, 1213.8333333333362, 1214.7333333333363, 1214.6333333333369, 1213.7333333333358, 1213.5333333333365, 1213.683333333336, 1214.5250000000028, 1212.7500000000032, 1214.9333333333363, 1214.6750000000022, 1214.783333333337, 1214.4833333333368, 1213.983333333336, 1214.1833333333366, 1214.333333333336, 1214.233333333336, 1214.3000000000031, 1213.5333333333358, 1214.7750000000026, 1214.0083333333364, 1214.4250000000027, 1214.3333333333358, 1213.7333333333363, 1214.1333333333357, 1214.1333333333369, 1214.1333333333364, 1215.0250000000035, 1213.6333333333355, 1213.6833333333361, 1215.0333333333365, 1214.0333333333363, 1215.5333333333367, 1213.3833333333362, 1214.2750000000026, 1214.1333333333362, 1214.283333333336, 1213.225000000003, 1214.283333333336, 1214.483333333336, 1214.783333333336, 1215.283333333336, 1215.0250000000026, 1214.900000000003, 1213.8333333333355, 1213.0833333333364, 1214.5916666666699, 1213.3333333333358, 1214.383333333336, 1212.633333333336, 1214.5166666666694, 1215.1500000000024, 1213.6833333333366, 1213.983333333337, 1215.0333333333363, 1213.4333333333366, 1214.0333333333356, 1214.483333333336, 1213.3833333333362, 1214.783333333336, 1212.8250000000028, 1213.733333333336, 1214.183333333336, 1213.7333333333363, 1212.6333333333364, 1214.3000000000022, 1213.9333333333363, 1214.883333333336, 1213.833333333336, 1213.483333333338, 1214.9583333333362, 1215.7666666666698, 1214.200000000003, 1214.2333333333365, 1214.6416666666696, 1213.9833333333368, 1214.6416666666698, 1215.2166666666694, 1214.4250000000027, 1213.7500000000032, 1214.5416666666695, 1213.2333333333368, 1213.733333333336, 1214.4333333333361, 1212.4833333333363, 1213.333333333336, 1215.4000000000028, 1213.6750000000031, 1214.733333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2433702398149836, "mean_inference_ms": 2.0739664936351754, "mean_action_processing_ms": 0.09123331729288232, "mean_env_wait_ms": 1.5438076611493403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006623506546020508, "StateBufferConnector_ms": 0.0034546852111816406, "ViewRequirementAgentConnector_ms": 0.08858442306518555}, "num_episodes": 21, "episode_return_max": 1215.7666666666698, "episode_return_min": 1212.4833333333363, "episode_return_mean": 1214.1624166666695, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 473850, "num_agent_steps_trained": 473700, "num_env_steps_sampled": 473850, "num_env_steps_trained": 473700, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 212.70203284589974, "num_env_steps_trained_throughput_per_sec": 226.88216836895973, "timesteps_total": 473850, "num_env_steps_sampled_lifetime": 473850, "num_agent_steps_sampled_lifetime": 473850, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 473850, "timers": {"training_iteration_time_ms": 10348.385, "restore_workers_time_ms": 0.016, "training_step_time_ms": 748.974, "sample_time_ms": 731.763, "synch_weights_time_ms": 15.566}, "counters": {"num_env_steps_sampled": 473850, "num_env_steps_trained": 473700, "num_agent_steps_sampled": 473850, "num_agent_steps_trained": 473700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3159, "num_samples_added_to_queue": 473700}, "done": false, "training_iteration": 189, "trial_id": "27800_00000", "date": "2024-10-12_16-00-32", "timestamp": 1728745232, "time_this_iter_s": 10.591150760650635, "time_total_s": 1956.140818119049, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b45450>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1956.140818119049, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 23.275, "ram_util_percent": 67.64375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4549.77734375, "policy_loss": 1090.7880859375, "entropy": 5.360164165496826, "entropy_coeff": 0.01, "var_gnorm": 18.0565185546875, "vf_loss": 347507.0, "vf_explained_var": 0.653971791267395}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1587.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 476400, "num_env_steps_trained": 476100, "num_agent_steps_sampled": 476400, "num_agent_steps_trained": 476100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3176, "num_samples_added_to_queue": 476400, "learner_queue": {"size_count": 1587, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.07, "learner_load_time_ms": 0.265, "learner_load_wait_time_ms": 1271.938, "learner_dequeue_time_ms": 10216.9}}, "env_runners": {"episode_reward_max": 1220.3750000000032, "episode_reward_min": 1212.4833333333363, "episode_reward_mean": 1215.0884166666697, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.4833333333363}, "policy_reward_max": {"default_policy": 1220.3750000000032}, "policy_reward_mean": {"default_policy": 1215.0884166666697}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.5852999999999999, "num_moves_min": 0.43, "num_moves_max": 0.94, "mean_accuracy_mean": 43.615156666666664, "mean_accuracy_min": 43.53200000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.05229999999999999, "num_model_switches_min": 0.0, "num_model_switches_max": 0.28, "num_slav_mean": 0.16056883333333336, "num_slav_min": 0.14975, "num_slav_max": 0.16390000000000002, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5431600250505608, "mean_cluster_cpu_util_min": 0.5400048377459092, "mean_cluster_cpu_util_max": 0.5467784519213091, "mean_cluster_mem_util_mean": 0.34154911919831216, "mean_cluster_mem_util_min": 0.3410010548523207, "mean_cluster_mem_util_max": 0.3420516877637131, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.309416666666692, "reward_accuracy_mean_min": 8.200000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4085325, "reward_sla_mean_min": -2.4585, "reward_sla_mean_max": -2.24625, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 830.9416666666693, "reward_accuracy_sum_min": 820.0000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -240.85325000000003, "reward_sla_sum_min": -245.85, "reward_sla_sum_max": -224.625, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2426.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.233333333336, 1214.3000000000031, 1213.5333333333358, 1214.7750000000026, 1214.0083333333364, 1214.4250000000027, 1214.3333333333358, 1213.7333333333363, 1214.1333333333357, 1214.1333333333369, 1214.1333333333364, 1215.0250000000035, 1213.6333333333355, 1213.6833333333361, 1215.0333333333365, 1214.0333333333363, 1215.5333333333367, 1213.3833333333362, 1214.2750000000026, 1214.1333333333362, 1214.283333333336, 1213.225000000003, 1214.283333333336, 1214.483333333336, 1214.783333333336, 1215.283333333336, 1215.0250000000026, 1214.900000000003, 1213.8333333333355, 1213.0833333333364, 1214.5916666666699, 1213.3333333333358, 1214.383333333336, 1212.633333333336, 1214.5166666666694, 1215.1500000000024, 1213.6833333333366, 1213.983333333337, 1215.0333333333363, 1213.4333333333366, 1214.0333333333356, 1214.483333333336, 1213.3833333333362, 1214.783333333336, 1212.8250000000028, 1213.733333333336, 1214.183333333336, 1213.7333333333363, 1212.6333333333364, 1214.3000000000022, 1213.9333333333363, 1214.883333333336, 1213.833333333336, 1213.483333333338, 1214.9583333333362, 1215.7666666666698, 1214.200000000003, 1214.2333333333365, 1214.6416666666696, 1213.9833333333368, 1214.6416666666698, 1215.2166666666694, 1214.4250000000027, 1213.7500000000032, 1214.5416666666695, 1213.2333333333368, 1213.733333333336, 1214.4333333333361, 1212.4833333333363, 1213.333333333336, 1215.4000000000028, 1213.6750000000031, 1214.733333333336, 1214.1166666666697, 1217.74166666667, 1217.991666666669, 1216.3416666666697, 1218.4666666666694, 1217.3166666666696, 1219.2166666666699, 1218.6750000000025, 1217.0250000000033, 1214.9166666666695, 1216.250000000003, 1216.5666666666689, 1217.0916666666697, 1220.3750000000032, 1219.6583333333358, 1218.8166666666693, 1217.508333333336, 1218.2333333333363, 1213.6833333333366, 1217.6583333333358, 1214.3250000000032, 1218.2000000000028, 1219.1000000000033, 1218.308333333336, 1218.8000000000031, 1218.6500000000026, 1219.8000000000025], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.233333333336, 1214.3000000000031, 1213.5333333333358, 1214.7750000000026, 1214.0083333333364, 1214.4250000000027, 1214.3333333333358, 1213.7333333333363, 1214.1333333333357, 1214.1333333333369, 1214.1333333333364, 1215.0250000000035, 1213.6333333333355, 1213.6833333333361, 1215.0333333333365, 1214.0333333333363, 1215.5333333333367, 1213.3833333333362, 1214.2750000000026, 1214.1333333333362, 1214.283333333336, 1213.225000000003, 1214.283333333336, 1214.483333333336, 1214.783333333336, 1215.283333333336, 1215.0250000000026, 1214.900000000003, 1213.8333333333355, 1213.0833333333364, 1214.5916666666699, 1213.3333333333358, 1214.383333333336, 1212.633333333336, 1214.5166666666694, 1215.1500000000024, 1213.6833333333366, 1213.983333333337, 1215.0333333333363, 1213.4333333333366, 1214.0333333333356, 1214.483333333336, 1213.3833333333362, 1214.783333333336, 1212.8250000000028, 1213.733333333336, 1214.183333333336, 1213.7333333333363, 1212.6333333333364, 1214.3000000000022, 1213.9333333333363, 1214.883333333336, 1213.833333333336, 1213.483333333338, 1214.9583333333362, 1215.7666666666698, 1214.200000000003, 1214.2333333333365, 1214.6416666666696, 1213.9833333333368, 1214.6416666666698, 1215.2166666666694, 1214.4250000000027, 1213.7500000000032, 1214.5416666666695, 1213.2333333333368, 1213.733333333336, 1214.4333333333361, 1212.4833333333363, 1213.333333333336, 1215.4000000000028, 1213.6750000000031, 1214.733333333336, 1214.1166666666697, 1217.74166666667, 1217.991666666669, 1216.3416666666697, 1218.4666666666694, 1217.3166666666696, 1219.2166666666699, 1218.6750000000025, 1217.0250000000033, 1214.9166666666695, 1216.250000000003, 1216.5666666666689, 1217.0916666666697, 1220.3750000000032, 1219.6583333333358, 1218.8166666666693, 1217.508333333336, 1218.2333333333363, 1213.6833333333366, 1217.6583333333358, 1214.3250000000032, 1218.2000000000028, 1219.1000000000033, 1218.308333333336, 1218.8000000000031, 1218.6500000000026, 1219.8000000000025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24341893756720073, "mean_inference_ms": 2.0745229678681727, "mean_action_processing_ms": 0.09124808223073488, "mean_env_wait_ms": 1.5440920283922654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006473541259765625, "StateBufferConnector_ms": 0.003383159637451172, "ViewRequirementAgentConnector_ms": 0.08724761009216309}, "num_episodes": 27, "episode_return_max": 1220.3750000000032, "episode_return_min": 1212.4833333333363, "episode_return_mean": 1215.0884166666697, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 476400, "num_agent_steps_trained": 476100, "num_env_steps_sampled": 476400, "num_env_steps_trained": 476100, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 248.20246164595315, "num_env_steps_trained_throughput_per_sec": 233.60231684325, "timesteps_total": 476400, "num_env_steps_sampled_lifetime": 476400, "num_agent_steps_sampled_lifetime": 476400, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 476400, "timers": {"training_iteration_time_ms": 10349.225, "restore_workers_time_ms": 0.012, "training_step_time_ms": 606.112, "sample_time_ms": 590.442, "synch_weights_time_ms": 14.207}, "counters": {"num_env_steps_sampled": 476400, "num_env_steps_trained": 476100, "num_agent_steps_sampled": 476400, "num_agent_steps_trained": 476100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3176, "num_samples_added_to_queue": 476400}, "done": false, "training_iteration": 190, "trial_id": "27800_00000", "date": "2024-10-12_16-00-42", "timestamp": 1728745242, "time_this_iter_s": 10.28959035873413, "time_total_s": 1966.4304084777832, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9489526b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1966.4304084777832, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 17.264285714285712, "ram_util_percent": 69.46428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 6537.96630859375, "policy_loss": 2961.19287109375, "entropy": 5.2527174949646, "entropy_coeff": 0.01, "var_gnorm": 18.052167892456055, "vf_loss": 359253.15625, "vf_explained_var": 0.6470438241958618}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1596.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 478950, "num_env_steps_trained": 478800, "num_agent_steps_sampled": 478950, "num_agent_steps_trained": 478800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3193, "num_samples_added_to_queue": 478800, "learner_queue": {"size_count": 1596, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.747, "learner_load_time_ms": 0.274, "learner_load_wait_time_ms": 1152.104, "learner_dequeue_time_ms": 10209.16}}, "env_runners": {"episode_reward_max": 1222.8666666666702, "episode_reward_min": 1212.4833333333363, "episode_reward_mean": 1216.3465000000026, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.4833333333363}, "policy_reward_max": {"default_policy": 1222.8666666666702}, "policy_reward_mean": {"default_policy": 1216.3465000000026}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.6269, "num_moves_min": 0.43, "num_moves_max": 0.94, "mean_accuracy_mean": 43.59451, "mean_accuracy_min": 43.50666666666668, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.1072, "num_model_switches_min": 0.0, "num_model_switches_max": 0.35, "num_slav_mean": 0.15791899999999998, "num_slav_min": 0.14586666666666667, "num_slav_max": 0.16390000000000002, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5440221328599006, "mean_cluster_cpu_util_min": 0.5400048377459092, "mean_cluster_cpu_util_max": 0.5475095146166574, "mean_cluster_mem_util_mean": 0.3414706065400843, "mean_cluster_mem_util_min": 0.3407289029535865, "mean_cluster_mem_util_max": 0.3419303797468353, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.282250000000026, "reward_accuracy_mean_min": 8.166666666666694, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.368785, "reward_sla_mean_min": -2.4585, "reward_sla_mean_max": -2.1880000000000006, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 828.2250000000029, "reward_accuracy_sum_min": 816.6666666666695, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -236.87849999999995, "reward_sla_sum_min": -245.85, "reward_sla_sum_max": -218.80000000000004, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1978.0, "global_timestep_min": 100, "global_timestep_max": 3600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.783333333336, 1215.283333333336, 1215.0250000000026, 1214.900000000003, 1213.8333333333355, 1213.0833333333364, 1214.5916666666699, 1213.3333333333358, 1214.383333333336, 1212.633333333336, 1214.5166666666694, 1215.1500000000024, 1213.6833333333366, 1213.983333333337, 1215.0333333333363, 1213.4333333333366, 1214.0333333333356, 1214.483333333336, 1213.3833333333362, 1214.783333333336, 1212.8250000000028, 1213.733333333336, 1214.183333333336, 1213.7333333333363, 1212.6333333333364, 1214.3000000000022, 1213.9333333333363, 1214.883333333336, 1213.833333333336, 1213.483333333338, 1214.9583333333362, 1215.7666666666698, 1214.200000000003, 1214.2333333333365, 1214.6416666666696, 1213.9833333333368, 1214.6416666666698, 1215.2166666666694, 1214.4250000000027, 1213.7500000000032, 1214.5416666666695, 1213.2333333333368, 1213.733333333336, 1214.4333333333361, 1212.4833333333363, 1213.333333333336, 1215.4000000000028, 1213.6750000000031, 1214.733333333336, 1214.1166666666697, 1217.74166666667, 1217.991666666669, 1216.3416666666697, 1218.4666666666694, 1217.3166666666696, 1219.2166666666699, 1218.6750000000025, 1217.0250000000033, 1214.9166666666695, 1216.250000000003, 1216.5666666666689, 1217.0916666666697, 1220.3750000000032, 1219.6583333333358, 1218.8166666666693, 1217.508333333336, 1218.2333333333363, 1213.6833333333366, 1217.6583333333358, 1214.3250000000032, 1218.2000000000028, 1219.1000000000033, 1218.308333333336, 1218.8000000000031, 1218.6500000000026, 1219.8000000000025, 1218.8083333333354, 1217.79166666667, 1219.0916666666697, 1221.2666666666698, 1216.7250000000026, 1220.2083333333364, 1218.441666666669, 1220.8250000000025, 1219.9416666666698, 1219.0166666666694, 1222.6166666666695, 1219.3916666666696, 1220.5166666666698, 1218.6666666666697, 1219.7250000000029, 1218.6333333333364, 1218.8000000000027, 1222.8666666666702, 1218.6000000000029, 1219.858333333336, 1219.61666666667, 1220.5666666666698, 1216.700000000003, 1217.8833333333355], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.783333333336, 1215.283333333336, 1215.0250000000026, 1214.900000000003, 1213.8333333333355, 1213.0833333333364, 1214.5916666666699, 1213.3333333333358, 1214.383333333336, 1212.633333333336, 1214.5166666666694, 1215.1500000000024, 1213.6833333333366, 1213.983333333337, 1215.0333333333363, 1213.4333333333366, 1214.0333333333356, 1214.483333333336, 1213.3833333333362, 1214.783333333336, 1212.8250000000028, 1213.733333333336, 1214.183333333336, 1213.7333333333363, 1212.6333333333364, 1214.3000000000022, 1213.9333333333363, 1214.883333333336, 1213.833333333336, 1213.483333333338, 1214.9583333333362, 1215.7666666666698, 1214.200000000003, 1214.2333333333365, 1214.6416666666696, 1213.9833333333368, 1214.6416666666698, 1215.2166666666694, 1214.4250000000027, 1213.7500000000032, 1214.5416666666695, 1213.2333333333368, 1213.733333333336, 1214.4333333333361, 1212.4833333333363, 1213.333333333336, 1215.4000000000028, 1213.6750000000031, 1214.733333333336, 1214.1166666666697, 1217.74166666667, 1217.991666666669, 1216.3416666666697, 1218.4666666666694, 1217.3166666666696, 1219.2166666666699, 1218.6750000000025, 1217.0250000000033, 1214.9166666666695, 1216.250000000003, 1216.5666666666689, 1217.0916666666697, 1220.3750000000032, 1219.6583333333358, 1218.8166666666693, 1217.508333333336, 1218.2333333333363, 1213.6833333333366, 1217.6583333333358, 1214.3250000000032, 1218.2000000000028, 1219.1000000000033, 1218.308333333336, 1218.8000000000031, 1218.6500000000026, 1219.8000000000025, 1218.8083333333354, 1217.79166666667, 1219.0916666666697, 1221.2666666666698, 1216.7250000000026, 1220.2083333333364, 1218.441666666669, 1220.8250000000025, 1219.9416666666698, 1219.0166666666694, 1222.6166666666695, 1219.3916666666696, 1220.5166666666698, 1218.6666666666697, 1219.7250000000029, 1218.6333333333364, 1218.8000000000027, 1222.8666666666702, 1218.6000000000029, 1219.858333333336, 1219.61666666667, 1220.5666666666698, 1216.700000000003, 1217.8833333333355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2434436241763347, "mean_inference_ms": 2.074925646157377, "mean_action_processing_ms": 0.09125760026594612, "mean_env_wait_ms": 1.5442914297147508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006319522857666016, "StateBufferConnector_ms": 0.0032956600189208984, "ViewRequirementAgentConnector_ms": 0.08565330505371094}, "num_episodes": 24, "episode_return_max": 1222.8666666666702, "episode_return_min": 1212.4833333333363, "episode_return_mean": 1216.3465000000026, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 478950, "num_agent_steps_trained": 478800, "num_env_steps_sampled": 478950, "num_env_steps_trained": 478800, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 248.34275322068478, "num_env_steps_trained_throughput_per_sec": 262.95115046896035, "timesteps_total": 478950, "num_env_steps_sampled_lifetime": 478950, "num_agent_steps_sampled_lifetime": 478950, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 478950, "timers": {"training_iteration_time_ms": 10325.408, "restore_workers_time_ms": 0.013, "training_step_time_ms": 607.606, "sample_time_ms": 591.515, "synch_weights_time_ms": 14.552}, "counters": {"num_env_steps_sampled": 478950, "num_env_steps_trained": 478800, "num_agent_steps_sampled": 478950, "num_agent_steps_trained": 478800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3193, "num_samples_added_to_queue": 478800}, "done": false, "training_iteration": 191, "trial_id": "27800_00000", "date": "2024-10-12_16-00-52", "timestamp": 1728745252, "time_this_iter_s": 10.28663158416748, "time_total_s": 1976.7170400619507, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d27d30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1976.7170400619507, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 15.766666666666671, "ram_util_percent": 69.14666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3390.1982421875, "policy_loss": -398.59674072265625, "entropy": 4.976284980773926, "entropy_coeff": 0.01, "var_gnorm": 18.05347442626953, "vf_loss": 380372.40625, "vf_explained_var": 0.63857102394104}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1604.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 481500, "num_env_steps_trained": 481200, "num_agent_steps_sampled": 481500, "num_agent_steps_trained": 481200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3210, "num_samples_added_to_queue": 481500, "learner_queue": {"size_count": 1604, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.686, "learner_load_time_ms": 0.285, "learner_load_wait_time_ms": 1136.274, "learner_dequeue_time_ms": 10163.31}}, "env_runners": {"episode_reward_max": 1222.8666666666702, "episode_reward_min": 1212.4833333333363, "episode_reward_mean": 1217.0409166666695, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.4833333333363}, "policy_reward_max": {"default_policy": 1222.8666666666702}, "policy_reward_mean": {"default_policy": 1217.0409166666695}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.6039, "num_moves_min": 0.25, "num_moves_max": 0.94, "mean_accuracy_mean": 43.584440000000015, "mean_accuracy_min": 43.50666666666668, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.13479999999999998, "num_model_switches_min": 0.0, "num_model_switches_max": 0.35, "num_slav_mean": 0.15655883333333334, "num_slav_min": 0.14586666666666667, "num_slav_max": 0.16390000000000002, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5448377482073912, "mean_cluster_cpu_util_min": 0.540357993197279, "mean_cluster_cpu_util_max": 0.5476873965802537, "mean_cluster_mem_util_mean": 0.34140690928270045, "mean_cluster_mem_util_min": 0.3407289029535865, "mean_cluster_mem_util_max": 0.3419303797468353, "reward_consolidation_mean_mean": 6.249791666666666, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.269000000000029, "reward_accuracy_mean_min": 8.166666666666694, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.3483824999999996, "reward_sla_mean_min": -2.4585, "reward_sla_mean_max": -2.1880000000000006, "reward_consolidation_sum_mean": 624.9791666666666, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 826.9000000000028, "reward_accuracy_sum_min": 816.6666666666695, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -234.83825000000002, "reward_sla_sum_min": -245.85, "reward_sla_sum_max": -218.80000000000004, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2883.0, "global_timestep_min": 1200, "global_timestep_max": 4500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.883333333336, 1213.833333333336, 1213.483333333338, 1214.9583333333362, 1215.7666666666698, 1214.200000000003, 1214.2333333333365, 1214.6416666666696, 1213.9833333333368, 1214.6416666666698, 1215.2166666666694, 1214.4250000000027, 1213.7500000000032, 1214.5416666666695, 1213.2333333333368, 1213.733333333336, 1214.4333333333361, 1212.4833333333363, 1213.333333333336, 1215.4000000000028, 1213.6750000000031, 1214.733333333336, 1214.1166666666697, 1217.74166666667, 1217.991666666669, 1216.3416666666697, 1218.4666666666694, 1217.3166666666696, 1219.2166666666699, 1218.6750000000025, 1217.0250000000033, 1214.9166666666695, 1216.250000000003, 1216.5666666666689, 1217.0916666666697, 1220.3750000000032, 1219.6583333333358, 1218.8166666666693, 1217.508333333336, 1218.2333333333363, 1213.6833333333366, 1217.6583333333358, 1214.3250000000032, 1218.2000000000028, 1219.1000000000033, 1218.308333333336, 1218.8000000000031, 1218.6500000000026, 1219.8000000000025, 1218.8083333333354, 1217.79166666667, 1219.0916666666697, 1221.2666666666698, 1216.7250000000026, 1220.2083333333364, 1218.441666666669, 1220.8250000000025, 1219.9416666666698, 1219.0166666666694, 1222.6166666666695, 1219.3916666666696, 1220.5166666666698, 1218.6666666666697, 1219.7250000000029, 1218.6333333333364, 1218.8000000000027, 1222.8666666666702, 1218.6000000000029, 1219.858333333336, 1219.61666666667, 1220.5666666666698, 1216.700000000003, 1217.8833333333355, 1218.0333333333363, 1220.1083333333365, 1220.0833333333358, 1216.8666666666688, 1216.0416666666695, 1215.1333333333362, 1216.416666666669, 1215.9916666666695, 1215.050000000003, 1218.2500000000034, 1219.1000000000029, 1218.4250000000036, 1217.8666666666697, 1216.6500000000033, 1214.5000000000025, 1214.000000000003, 1215.4333333333366, 1215.0833333333367, 1219.7333333333368, 1220.0416666666695, 1218.3833333333362, 1216.5166666666696, 1215.0250000000024, 1213.8250000000023, 1212.5416666666692, 1214.750000000002, 1215.2666666666694], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.883333333336, 1213.833333333336, 1213.483333333338, 1214.9583333333362, 1215.7666666666698, 1214.200000000003, 1214.2333333333365, 1214.6416666666696, 1213.9833333333368, 1214.6416666666698, 1215.2166666666694, 1214.4250000000027, 1213.7500000000032, 1214.5416666666695, 1213.2333333333368, 1213.733333333336, 1214.4333333333361, 1212.4833333333363, 1213.333333333336, 1215.4000000000028, 1213.6750000000031, 1214.733333333336, 1214.1166666666697, 1217.74166666667, 1217.991666666669, 1216.3416666666697, 1218.4666666666694, 1217.3166666666696, 1219.2166666666699, 1218.6750000000025, 1217.0250000000033, 1214.9166666666695, 1216.250000000003, 1216.5666666666689, 1217.0916666666697, 1220.3750000000032, 1219.6583333333358, 1218.8166666666693, 1217.508333333336, 1218.2333333333363, 1213.6833333333366, 1217.6583333333358, 1214.3250000000032, 1218.2000000000028, 1219.1000000000033, 1218.308333333336, 1218.8000000000031, 1218.6500000000026, 1219.8000000000025, 1218.8083333333354, 1217.79166666667, 1219.0916666666697, 1221.2666666666698, 1216.7250000000026, 1220.2083333333364, 1218.441666666669, 1220.8250000000025, 1219.9416666666698, 1219.0166666666694, 1222.6166666666695, 1219.3916666666696, 1220.5166666666698, 1218.6666666666697, 1219.7250000000029, 1218.6333333333364, 1218.8000000000027, 1222.8666666666702, 1218.6000000000029, 1219.858333333336, 1219.61666666667, 1220.5666666666698, 1216.700000000003, 1217.8833333333355, 1218.0333333333363, 1220.1083333333365, 1220.0833333333358, 1216.8666666666688, 1216.0416666666695, 1215.1333333333362, 1216.416666666669, 1215.9916666666695, 1215.050000000003, 1218.2500000000034, 1219.1000000000029, 1218.4250000000036, 1217.8666666666697, 1216.6500000000033, 1214.5000000000025, 1214.000000000003, 1215.4333333333366, 1215.0833333333367, 1219.7333333333368, 1220.0416666666695, 1218.3833333333362, 1216.5166666666696, 1215.0250000000024, 1213.8250000000023, 1212.5416666666692, 1214.750000000002, 1215.2666666666694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24349337217412148, "mean_inference_ms": 2.077065269351249, "mean_action_processing_ms": 0.09128043452673641, "mean_env_wait_ms": 1.5448685295166922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006446123123168945, "StateBufferConnector_ms": 0.003247499465942383, "ViewRequirementAgentConnector_ms": 0.08466434478759766}, "num_episodes": 27, "episode_return_max": 1222.8666666666702, "episode_return_min": 1212.4833333333363, "episode_return_mean": 1217.0409166666695, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 481500, "num_agent_steps_trained": 481200, "num_env_steps_sampled": 481500, "num_env_steps_trained": 481200, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 254.52867061333973, "num_env_steps_trained_throughput_per_sec": 239.55639587137856, "timesteps_total": 481500, "num_env_steps_sampled_lifetime": 481500, "num_agent_steps_sampled_lifetime": 481500, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 481500, "timers": {"training_iteration_time_ms": 10273.582, "restore_workers_time_ms": 0.012, "training_step_time_ms": 592.605, "sample_time_ms": 578.196, "synch_weights_time_ms": 12.982}, "counters": {"num_env_steps_sampled": 481500, "num_env_steps_trained": 481200, "num_agent_steps_sampled": 481500, "num_agent_steps_trained": 481200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3210, "num_samples_added_to_queue": 481500}, "done": false, "training_iteration": 192, "trial_id": "27800_00000", "date": "2024-10-12_16-01-02", "timestamp": 1728745262, "time_this_iter_s": 10.028659105300903, "time_total_s": 1986.7456991672516, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486c3520>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1986.7456991672516, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 15.835714285714285, "ram_util_percent": 68.97142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3130.388671875, "policy_loss": -268.34063720703125, "entropy": 5.09271240234375, "entropy_coeff": 0.01, "var_gnorm": 18.060529708862305, "vf_loss": 341400.75, "vf_explained_var": 0.6519277095794678}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1612.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 483900, "num_env_steps_trained": 483600, "num_agent_steps_sampled": 483900, "num_agent_steps_trained": 483600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3226, "num_samples_added_to_queue": 483900, "learner_queue": {"size_count": 1612, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.993, "learner_load_time_ms": 0.274, "learner_load_wait_time_ms": 1194.576, "learner_dequeue_time_ms": 10064.947}}, "env_runners": {"episode_reward_max": 1222.8666666666702, "episode_reward_min": 1212.5416666666692, "episode_reward_mean": 1216.968750000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.5416666666692}, "policy_reward_max": {"default_policy": 1222.8666666666702}, "policy_reward_mean": {"default_policy": 1216.968750000003}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.5741, "num_moves_min": 0.22, "num_moves_max": 0.94, "mean_accuracy_mean": 43.58583333333333, "mean_accuracy_min": 43.50666666666668, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.13040000000000002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.35, "num_slav_mean": 0.15672916666666667, "num_slav_min": 0.14586666666666667, "num_slav_max": 0.16353333333333336, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5456176389271924, "mean_cluster_cpu_util_min": 0.5406443969479683, "mean_cluster_cpu_util_max": 0.5479475546975546, "mean_cluster_mem_util_mean": 0.34141672468354434, "mean_cluster_mem_util_min": 0.3407289029535865, "mean_cluster_mem_util_max": 0.3421603375527426, "reward_consolidation_mean_mean": 6.249791666666666, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.27083333333336, "reward_accuracy_mean_min": 8.166666666666694, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.3509375, "reward_sla_mean_min": -2.4530000000000003, "reward_sla_mean_max": -2.1880000000000006, "reward_consolidation_sum_mean": 624.9791666666667, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 827.0833333333363, "reward_accuracy_sum_min": 816.6666666666695, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -235.09374999999997, "reward_sla_sum_min": -245.3, "reward_sla_sum_max": -218.80000000000004, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3682.0, "global_timestep_min": 2000, "global_timestep_max": 5300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1217.991666666669, 1216.3416666666697, 1218.4666666666694, 1217.3166666666696, 1219.2166666666699, 1218.6750000000025, 1217.0250000000033, 1214.9166666666695, 1216.250000000003, 1216.5666666666689, 1217.0916666666697, 1220.3750000000032, 1219.6583333333358, 1218.8166666666693, 1217.508333333336, 1218.2333333333363, 1213.6833333333366, 1217.6583333333358, 1214.3250000000032, 1218.2000000000028, 1219.1000000000033, 1218.308333333336, 1218.8000000000031, 1218.6500000000026, 1219.8000000000025, 1218.8083333333354, 1217.79166666667, 1219.0916666666697, 1221.2666666666698, 1216.7250000000026, 1220.2083333333364, 1218.441666666669, 1220.8250000000025, 1219.9416666666698, 1219.0166666666694, 1222.6166666666695, 1219.3916666666696, 1220.5166666666698, 1218.6666666666697, 1219.7250000000029, 1218.6333333333364, 1218.8000000000027, 1222.8666666666702, 1218.6000000000029, 1219.858333333336, 1219.61666666667, 1220.5666666666698, 1216.700000000003, 1217.8833333333355, 1218.0333333333363, 1220.1083333333365, 1220.0833333333358, 1216.8666666666688, 1216.0416666666695, 1215.1333333333362, 1216.416666666669, 1215.9916666666695, 1215.050000000003, 1218.2500000000034, 1219.1000000000029, 1218.4250000000036, 1217.8666666666697, 1216.6500000000033, 1214.5000000000025, 1214.000000000003, 1215.4333333333366, 1215.0833333333367, 1219.7333333333368, 1220.0416666666695, 1218.3833333333362, 1216.5166666666696, 1215.0250000000024, 1213.8250000000023, 1212.5416666666692, 1214.750000000002, 1215.2666666666694, 1213.933333333336, 1215.5166666666694, 1214.5833333333362, 1214.3833333333366, 1214.4000000000028, 1213.4833333333365, 1214.383333333336, 1214.1833333333361, 1214.0333333333367, 1214.5333333333363, 1215.0333333333363, 1213.7333333333365, 1213.2333333333363, 1213.3833333333364, 1213.3333333333355, 1213.433333333336, 1214.8333333333358, 1214.9583333333362, 1213.4833333333365, 1214.1333333333364, 1213.0333333333363, 1214.3333333333364, 1214.3833333333357, 1213.4833333333363], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1217.991666666669, 1216.3416666666697, 1218.4666666666694, 1217.3166666666696, 1219.2166666666699, 1218.6750000000025, 1217.0250000000033, 1214.9166666666695, 1216.250000000003, 1216.5666666666689, 1217.0916666666697, 1220.3750000000032, 1219.6583333333358, 1218.8166666666693, 1217.508333333336, 1218.2333333333363, 1213.6833333333366, 1217.6583333333358, 1214.3250000000032, 1218.2000000000028, 1219.1000000000033, 1218.308333333336, 1218.8000000000031, 1218.6500000000026, 1219.8000000000025, 1218.8083333333354, 1217.79166666667, 1219.0916666666697, 1221.2666666666698, 1216.7250000000026, 1220.2083333333364, 1218.441666666669, 1220.8250000000025, 1219.9416666666698, 1219.0166666666694, 1222.6166666666695, 1219.3916666666696, 1220.5166666666698, 1218.6666666666697, 1219.7250000000029, 1218.6333333333364, 1218.8000000000027, 1222.8666666666702, 1218.6000000000029, 1219.858333333336, 1219.61666666667, 1220.5666666666698, 1216.700000000003, 1217.8833333333355, 1218.0333333333363, 1220.1083333333365, 1220.0833333333358, 1216.8666666666688, 1216.0416666666695, 1215.1333333333362, 1216.416666666669, 1215.9916666666695, 1215.050000000003, 1218.2500000000034, 1219.1000000000029, 1218.4250000000036, 1217.8666666666697, 1216.6500000000033, 1214.5000000000025, 1214.000000000003, 1215.4333333333366, 1215.0833333333367, 1219.7333333333368, 1220.0416666666695, 1218.3833333333362, 1216.5166666666696, 1215.0250000000024, 1213.8250000000023, 1212.5416666666692, 1214.750000000002, 1215.2666666666694, 1213.933333333336, 1215.5166666666694, 1214.5833333333362, 1214.3833333333366, 1214.4000000000028, 1213.4833333333365, 1214.383333333336, 1214.1833333333361, 1214.0333333333367, 1214.5333333333363, 1215.0333333333363, 1213.7333333333365, 1213.2333333333363, 1213.3833333333364, 1213.3333333333355, 1213.433333333336, 1214.8333333333358, 1214.9583333333362, 1213.4833333333365, 1214.1333333333364, 1213.0333333333363, 1214.3333333333364, 1214.3833333333357, 1213.4833333333363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24343792410521434, "mean_inference_ms": 2.0752438745374233, "mean_action_processing_ms": 0.09125502245784128, "mean_env_wait_ms": 1.544378920275462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006711006164550781, "StateBufferConnector_ms": 0.0032014846801757812, "ViewRequirementAgentConnector_ms": 0.08215165138244629}, "num_episodes": 24, "episode_return_max": 1222.8666666666702, "episode_return_min": 1212.5416666666692, "episode_return_mean": 1216.968750000003, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 483900, "num_agent_steps_trained": 483600, "num_env_steps_sampled": 483900, "num_env_steps_trained": 483600, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 236.773074481205, "num_env_steps_trained_throughput_per_sec": 236.773074481205, "timesteps_total": 483900, "num_env_steps_sampled_lifetime": 483900, "num_agent_steps_sampled_lifetime": 483900, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 483900, "timers": {"training_iteration_time_ms": 10283.981, "restore_workers_time_ms": 0.012, "training_step_time_ms": 649.722, "sample_time_ms": 632.955, "synch_weights_time_ms": 15.043}, "counters": {"num_env_steps_sampled": 483900, "num_env_steps_trained": 483600, "num_agent_steps_sampled": 483900, "num_agent_steps_trained": 483600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3226, "num_samples_added_to_queue": 483900}, "done": false, "training_iteration": 193, "trial_id": "27800_00000", "date": "2024-10-12_16-01-13", "timestamp": 1728745273, "time_this_iter_s": 10.150991916656494, "time_total_s": 1996.896691083908, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f69390>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1996.896691083908, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 17.36, "ram_util_percent": 68.19333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4272.48486328125, "policy_loss": 863.8302001953125, "entropy": 5.138674736022949, "entropy_coeff": 0.01, "var_gnorm": 18.065126419067383, "vf_loss": 342407.0625, "vf_explained_var": 0.6516635417938232}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1620.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 486300, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486300, "num_agent_steps_trained": 486000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3242, "num_samples_added_to_queue": 486300, "learner_queue": {"size_count": 1620, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.385, "learner_load_time_ms": 0.286, "learner_load_wait_time_ms": 1244.543, "learner_dequeue_time_ms": 10119.182}}, "env_runners": {"episode_reward_max": 1222.8666666666702, "episode_reward_min": 1212.5416666666692, "episode_reward_mean": 1216.107000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.5416666666692}, "policy_reward_max": {"default_policy": 1222.8666666666702}, "policy_reward_mean": {"default_policy": 1216.107000000003}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.548, "num_moves_min": 0.22, "num_moves_max": 0.94, "mean_accuracy_mean": 43.600273333333334, "mean_accuracy_min": 43.50666666666668, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0902, "num_model_switches_min": 0.0, "num_model_switches_max": 0.35, "num_slav_mean": 0.15857033333333337, "num_slav_min": 0.14586666666666667, "num_slav_max": 0.1637666666666667, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5462879973340687, "mean_cluster_cpu_util_min": 0.5439389708586138, "mean_cluster_cpu_util_max": 0.5479801663908807, "mean_cluster_mem_util_mean": 0.3414905063291139, "mean_cluster_mem_util_min": 0.3407289029535865, "mean_cluster_mem_util_max": 0.3421603375527426, "reward_consolidation_mean_mean": 6.249791666666666, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.28983333333336, "reward_accuracy_mean_min": 8.166666666666694, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.3785549999999995, "reward_sla_mean_min": -2.4564999999999997, "reward_sla_mean_max": -2.1880000000000006, "reward_consolidation_sum_mean": 624.9791666666667, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 828.9833333333363, "reward_accuracy_sum_min": 816.6666666666695, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -237.85549999999995, "reward_sla_sum_min": -245.64999999999998, "reward_sla_sum_max": -218.80000000000004, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4483.0, "global_timestep_min": 2800, "global_timestep_max": 6100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1219.8000000000025, 1218.8083333333354, 1217.79166666667, 1219.0916666666697, 1221.2666666666698, 1216.7250000000026, 1220.2083333333364, 1218.441666666669, 1220.8250000000025, 1219.9416666666698, 1219.0166666666694, 1222.6166666666695, 1219.3916666666696, 1220.5166666666698, 1218.6666666666697, 1219.7250000000029, 1218.6333333333364, 1218.8000000000027, 1222.8666666666702, 1218.6000000000029, 1219.858333333336, 1219.61666666667, 1220.5666666666698, 1216.700000000003, 1217.8833333333355, 1218.0333333333363, 1220.1083333333365, 1220.0833333333358, 1216.8666666666688, 1216.0416666666695, 1215.1333333333362, 1216.416666666669, 1215.9916666666695, 1215.050000000003, 1218.2500000000034, 1219.1000000000029, 1218.4250000000036, 1217.8666666666697, 1216.6500000000033, 1214.5000000000025, 1214.000000000003, 1215.4333333333366, 1215.0833333333367, 1219.7333333333368, 1220.0416666666695, 1218.3833333333362, 1216.5166666666696, 1215.0250000000024, 1213.8250000000023, 1212.5416666666692, 1214.750000000002, 1215.2666666666694, 1213.933333333336, 1215.5166666666694, 1214.5833333333362, 1214.3833333333366, 1214.4000000000028, 1213.4833333333365, 1214.383333333336, 1214.1833333333361, 1214.0333333333367, 1214.5333333333363, 1215.0333333333363, 1213.7333333333365, 1213.2333333333363, 1213.3833333333364, 1213.3333333333355, 1213.433333333336, 1214.8333333333358, 1214.9583333333362, 1213.4833333333365, 1214.1333333333364, 1213.0333333333363, 1214.3333333333364, 1214.3833333333357, 1213.4833333333363, 1214.133333333336, 1213.383333333336, 1213.233333333336, 1214.6833333333363, 1214.233333333337, 1213.0833333333362, 1215.0333333333363, 1214.7833333333365, 1214.783333333336, 1214.4333333333363, 1214.383333333336, 1214.283333333336, 1212.6833333333361, 1214.8333333333358, 1214.1333333333362, 1213.3333333333362, 1213.3833333333357, 1213.4333333333363, 1214.7333333333356, 1213.4333333333361, 1213.2333333333358, 1214.4833333333363, 1214.0833333333367, 1214.7833333333365], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1219.8000000000025, 1218.8083333333354, 1217.79166666667, 1219.0916666666697, 1221.2666666666698, 1216.7250000000026, 1220.2083333333364, 1218.441666666669, 1220.8250000000025, 1219.9416666666698, 1219.0166666666694, 1222.6166666666695, 1219.3916666666696, 1220.5166666666698, 1218.6666666666697, 1219.7250000000029, 1218.6333333333364, 1218.8000000000027, 1222.8666666666702, 1218.6000000000029, 1219.858333333336, 1219.61666666667, 1220.5666666666698, 1216.700000000003, 1217.8833333333355, 1218.0333333333363, 1220.1083333333365, 1220.0833333333358, 1216.8666666666688, 1216.0416666666695, 1215.1333333333362, 1216.416666666669, 1215.9916666666695, 1215.050000000003, 1218.2500000000034, 1219.1000000000029, 1218.4250000000036, 1217.8666666666697, 1216.6500000000033, 1214.5000000000025, 1214.000000000003, 1215.4333333333366, 1215.0833333333367, 1219.7333333333368, 1220.0416666666695, 1218.3833333333362, 1216.5166666666696, 1215.0250000000024, 1213.8250000000023, 1212.5416666666692, 1214.750000000002, 1215.2666666666694, 1213.933333333336, 1215.5166666666694, 1214.5833333333362, 1214.3833333333366, 1214.4000000000028, 1213.4833333333365, 1214.383333333336, 1214.1833333333361, 1214.0333333333367, 1214.5333333333363, 1215.0333333333363, 1213.7333333333365, 1213.2333333333363, 1213.3833333333364, 1213.3333333333355, 1213.433333333336, 1214.8333333333358, 1214.9583333333362, 1213.4833333333365, 1214.1333333333364, 1213.0333333333363, 1214.3333333333364, 1214.3833333333357, 1213.4833333333363, 1214.133333333336, 1213.383333333336, 1213.233333333336, 1214.6833333333363, 1214.233333333337, 1213.0833333333362, 1215.0333333333363, 1214.7833333333365, 1214.783333333336, 1214.4333333333363, 1214.383333333336, 1214.283333333336, 1212.6833333333361, 1214.8333333333358, 1214.1333333333362, 1213.3333333333362, 1213.3833333333357, 1213.4333333333363, 1214.7333333333356, 1213.4333333333361, 1213.2333333333358, 1214.4833333333363, 1214.0833333333367, 1214.7833333333365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24347845233585236, "mean_inference_ms": 2.076864139935113, "mean_action_processing_ms": 0.09127523191680251, "mean_env_wait_ms": 1.5447811381191092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00685572624206543, "StateBufferConnector_ms": 0.0032410621643066406, "ViewRequirementAgentConnector_ms": 0.08382272720336914}, "num_episodes": 24, "episode_return_max": 1222.8666666666702, "episode_return_min": 1212.5416666666692, "episode_return_mean": 1216.107000000003, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 486300, "num_agent_steps_trained": 486000, "num_env_steps_sampled": 486300, "num_env_steps_trained": 486000, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 228.16991551461555, "num_env_steps_trained_throughput_per_sec": 228.16991551461555, "timesteps_total": 486300, "num_env_steps_sampled_lifetime": 486300, "num_agent_steps_sampled_lifetime": 486300, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 486300, "timers": {"training_iteration_time_ms": 10273.339, "restore_workers_time_ms": 0.015, "training_step_time_ms": 659.804, "sample_time_ms": 644.358, "synch_weights_time_ms": 13.907}, "counters": {"num_env_steps_sampled": 486300, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486300, "num_agent_steps_trained": 486000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3242, "num_samples_added_to_queue": 486300}, "done": false, "training_iteration": 194, "trial_id": "27800_00000", "date": "2024-10-12_16-01-23", "timestamp": 1728745283, "time_this_iter_s": 10.537720203399658, "time_total_s": 2007.4344112873077, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948952e00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2007.4344112873077, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 19.62666666666667, "ram_util_percent": 68.37333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 6042.8818359375, "policy_loss": 2325.25390625, "entropy": 4.983006000518799, "entropy_coeff": 0.01, "var_gnorm": 18.065998077392578, "vf_loss": 373257.6875, "vf_explained_var": 0.6409159898757935}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1628.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 488700, "num_env_steps_trained": 488400, "num_agent_steps_sampled": 488700, "num_agent_steps_trained": 488400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3258, "num_samples_added_to_queue": 488700, "learner_queue": {"size_count": 1628, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.771, "learner_load_time_ms": 0.277, "learner_load_wait_time_ms": 1212.019, "learner_dequeue_time_ms": 10115.152}}, "env_runners": {"episode_reward_max": 1220.1083333333365, "episode_reward_min": 1212.5416666666692, "episode_reward_mean": 1214.7794166666695, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.5416666666692}, "policy_reward_max": {"default_policy": 1220.1083333333365}, "policy_reward_mean": {"default_policy": 1214.7794166666695}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.49570000000000003, "num_moves_min": 0.22, "num_moves_max": 0.73, "mean_accuracy_mean": 43.62168, "mean_accuracy_min": 43.52566666666667, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.032799999999999996, "num_model_switches_min": 0.0, "num_model_switches_max": 0.31, "num_slav_mean": 0.1613331666666667, "num_slav_min": 0.1494166666666667, "num_slav_max": 0.1637666666666667, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5465811916252988, "mean_cluster_cpu_util_min": 0.5442901498437213, "mean_cluster_cpu_util_max": 0.5491961642765214, "mean_cluster_mem_util_mean": 0.3415702953586497, "mean_cluster_mem_util_min": 0.34089926160337547, "mean_cluster_mem_util_max": 0.3421603375527426, "reward_consolidation_mean_mean": 6.249791666666666, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.318000000000026, "reward_accuracy_mean_min": 8.191666666666695, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4199975, "reward_sla_mean_min": -2.4564999999999997, "reward_sla_mean_max": -2.24125, "reward_consolidation_sum_mean": 624.9791666666666, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 831.8000000000029, "reward_accuracy_sum_min": 819.1666666666695, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -241.99974999999998, "reward_sla_sum_min": -245.64999999999998, "reward_sla_sum_max": -224.125, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5283.0, "global_timestep_min": 3600, "global_timestep_max": 6900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1217.8833333333355, 1218.0333333333363, 1220.1083333333365, 1220.0833333333358, 1216.8666666666688, 1216.0416666666695, 1215.1333333333362, 1216.416666666669, 1215.9916666666695, 1215.050000000003, 1218.2500000000034, 1219.1000000000029, 1218.4250000000036, 1217.8666666666697, 1216.6500000000033, 1214.5000000000025, 1214.000000000003, 1215.4333333333366, 1215.0833333333367, 1219.7333333333368, 1220.0416666666695, 1218.3833333333362, 1216.5166666666696, 1215.0250000000024, 1213.8250000000023, 1212.5416666666692, 1214.750000000002, 1215.2666666666694, 1213.933333333336, 1215.5166666666694, 1214.5833333333362, 1214.3833333333366, 1214.4000000000028, 1213.4833333333365, 1214.383333333336, 1214.1833333333361, 1214.0333333333367, 1214.5333333333363, 1215.0333333333363, 1213.7333333333365, 1213.2333333333363, 1213.3833333333364, 1213.3333333333355, 1213.433333333336, 1214.8333333333358, 1214.9583333333362, 1213.4833333333365, 1214.1333333333364, 1213.0333333333363, 1214.3333333333364, 1214.3833333333357, 1213.4833333333363, 1214.133333333336, 1213.383333333336, 1213.233333333336, 1214.6833333333363, 1214.233333333337, 1213.0833333333362, 1215.0333333333363, 1214.7833333333365, 1214.783333333336, 1214.4333333333363, 1214.383333333336, 1214.283333333336, 1212.6833333333361, 1214.8333333333358, 1214.1333333333362, 1213.3333333333362, 1213.3833333333357, 1213.4333333333363, 1214.7333333333356, 1213.4333333333361, 1213.2333333333358, 1214.4833333333363, 1214.0833333333367, 1214.7833333333365, 1214.1333333333357, 1214.5833333333364, 1213.7333333333363, 1214.083333333336, 1214.5333333333367, 1214.2833333333365, 1213.7833333333365, 1213.8333333333364, 1213.4833333333354, 1214.083333333336, 1213.733333333336, 1213.733333333336, 1214.483333333336, 1214.1833333333368, 1213.150000000003, 1213.333333333336, 1213.7333333333356, 1214.0333333333365, 1214.983333333336, 1213.6833333333363, 1214.1333333333373, 1213.5333333333363, 1214.183333333336, 1214.2833333333363], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1217.8833333333355, 1218.0333333333363, 1220.1083333333365, 1220.0833333333358, 1216.8666666666688, 1216.0416666666695, 1215.1333333333362, 1216.416666666669, 1215.9916666666695, 1215.050000000003, 1218.2500000000034, 1219.1000000000029, 1218.4250000000036, 1217.8666666666697, 1216.6500000000033, 1214.5000000000025, 1214.000000000003, 1215.4333333333366, 1215.0833333333367, 1219.7333333333368, 1220.0416666666695, 1218.3833333333362, 1216.5166666666696, 1215.0250000000024, 1213.8250000000023, 1212.5416666666692, 1214.750000000002, 1215.2666666666694, 1213.933333333336, 1215.5166666666694, 1214.5833333333362, 1214.3833333333366, 1214.4000000000028, 1213.4833333333365, 1214.383333333336, 1214.1833333333361, 1214.0333333333367, 1214.5333333333363, 1215.0333333333363, 1213.7333333333365, 1213.2333333333363, 1213.3833333333364, 1213.3333333333355, 1213.433333333336, 1214.8333333333358, 1214.9583333333362, 1213.4833333333365, 1214.1333333333364, 1213.0333333333363, 1214.3333333333364, 1214.3833333333357, 1213.4833333333363, 1214.133333333336, 1213.383333333336, 1213.233333333336, 1214.6833333333363, 1214.233333333337, 1213.0833333333362, 1215.0333333333363, 1214.7833333333365, 1214.783333333336, 1214.4333333333363, 1214.383333333336, 1214.283333333336, 1212.6833333333361, 1214.8333333333358, 1214.1333333333362, 1213.3333333333362, 1213.3833333333357, 1213.4333333333363, 1214.7333333333356, 1213.4333333333361, 1213.2333333333358, 1214.4833333333363, 1214.0833333333367, 1214.7833333333365, 1214.1333333333357, 1214.5833333333364, 1213.7333333333363, 1214.083333333336, 1214.5333333333367, 1214.2833333333365, 1213.7833333333365, 1213.8333333333364, 1213.4833333333354, 1214.083333333336, 1213.733333333336, 1213.733333333336, 1214.483333333336, 1214.1833333333368, 1213.150000000003, 1213.333333333336, 1213.7333333333356, 1214.0333333333365, 1214.983333333336, 1213.6833333333363, 1214.1333333333373, 1213.5333333333363, 1214.183333333336, 1214.2833333333363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2435047586225101, "mean_inference_ms": 2.0770009729888, "mean_action_processing_ms": 0.09128209946695932, "mean_env_wait_ms": 1.5448678668511946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006987571716308594, "StateBufferConnector_ms": 0.0033044815063476562, "ViewRequirementAgentConnector_ms": 0.08535909652709961}, "num_episodes": 24, "episode_return_max": 1220.1083333333365, "episode_return_min": 1212.5416666666692, "episode_return_mean": 1214.7794166666695, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 488700, "num_agent_steps_trained": 488400, "num_env_steps_sampled": 488700, "num_env_steps_trained": 488400, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 237.5516228957246, "num_env_steps_trained_throughput_per_sec": 237.5516228957246, "timesteps_total": 488700, "num_env_steps_sampled_lifetime": 488700, "num_agent_steps_sampled_lifetime": 488700, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 488700, "timers": {"training_iteration_time_ms": 10269.167, "restore_workers_time_ms": 0.015, "training_step_time_ms": 648.239, "sample_time_ms": 632.413, "synch_weights_time_ms": 14.068}, "counters": {"num_env_steps_sampled": 488700, "num_env_steps_trained": 488400, "num_agent_steps_sampled": 488700, "num_agent_steps_trained": 488400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3258, "num_samples_added_to_queue": 488700}, "done": false, "training_iteration": 195, "trial_id": "27800_00000", "date": "2024-10-12_16-01-33", "timestamp": 1728745293, "time_this_iter_s": 10.112783193588257, "time_total_s": 2017.547194480896, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d47430>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2017.547194480896, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 17.150000000000002, "ram_util_percent": 68.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3441.03515625, "policy_loss": -274.6964111328125, "entropy": 5.107560634613037, "entropy_coeff": 0.01, "var_gnorm": 18.069265365600586, "vf_loss": 373105.4375, "vf_explained_var": 0.6395094394683838}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1636.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 491100, "num_env_steps_trained": 490800, "num_agent_steps_sampled": 491100, "num_agent_steps_trained": 490800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3274, "num_samples_added_to_queue": 491100, "learner_queue": {"size_count": 1636, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 84.586, "learner_load_time_ms": 0.273, "learner_load_wait_time_ms": 1222.162, "learner_dequeue_time_ms": 10167.179}}, "env_runners": {"episode_reward_max": 1215.633333333336, "episode_reward_min": 1211.4666666666697, "episode_reward_mean": 1214.0600833333363, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.4666666666697}, "policy_reward_max": {"default_policy": 1215.633333333336}, "policy_reward_mean": {"default_policy": 1214.0600833333363}, "custom_metrics": {"num_consolidated_mean": 2.9998, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.5022, "num_moves_min": 0.22, "num_moves_max": 0.73, "mean_accuracy_mean": 43.63232, "mean_accuracy_min": 43.60800000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.003, "num_model_switches_min": 0.0, "num_model_switches_max": 0.06, "num_slav_mean": 0.1627321666666667, "num_slav_min": 0.16024999999999998, "num_slav_max": 0.1637666666666667, "cpu_conserved_cost_mean": 7.999200000000001, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5466075076415701, "mean_cluster_cpu_util_min": 0.5443178088803089, "mean_cluster_cpu_util_max": 0.5491961642765214, "mean_cluster_mem_util_mean": 0.34162386998945155, "mean_cluster_mem_util_min": 0.3411027162447258, "mean_cluster_mem_util_max": 0.3421603375527426, "reward_consolidation_mean_mean": 6.249583333333333, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.332000000000026, "reward_accuracy_mean_min": 8.300000000000027, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4409824999999996, "reward_sla_mean_min": -2.4564999999999997, "reward_sla_mean_max": -2.40375, "reward_consolidation_sum_mean": 624.9583333333333, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.2000000000029, "reward_accuracy_sum_min": 830.0000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.09825000000004, "reward_sla_sum_min": -245.64999999999998, "reward_sla_sum_max": -240.375, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6078.0, "global_timestep_min": 4200, "global_timestep_max": 7700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.8250000000023, 1212.5416666666692, 1214.750000000002, 1215.2666666666694, 1213.933333333336, 1215.5166666666694, 1214.5833333333362, 1214.3833333333366, 1214.4000000000028, 1213.4833333333365, 1214.383333333336, 1214.1833333333361, 1214.0333333333367, 1214.5333333333363, 1215.0333333333363, 1213.7333333333365, 1213.2333333333363, 1213.3833333333364, 1213.3333333333355, 1213.433333333336, 1214.8333333333358, 1214.9583333333362, 1213.4833333333365, 1214.1333333333364, 1213.0333333333363, 1214.3333333333364, 1214.3833333333357, 1213.4833333333363, 1214.133333333336, 1213.383333333336, 1213.233333333336, 1214.6833333333363, 1214.233333333337, 1213.0833333333362, 1215.0333333333363, 1214.7833333333365, 1214.783333333336, 1214.4333333333363, 1214.383333333336, 1214.283333333336, 1212.6833333333361, 1214.8333333333358, 1214.1333333333362, 1213.3333333333362, 1213.3833333333357, 1213.4333333333363, 1214.7333333333356, 1213.4333333333361, 1213.2333333333358, 1214.4833333333363, 1214.0833333333367, 1214.7833333333365, 1214.1333333333357, 1214.5833333333364, 1213.7333333333363, 1214.083333333336, 1214.5333333333367, 1214.2833333333365, 1213.7833333333365, 1213.8333333333364, 1213.4833333333354, 1214.083333333336, 1213.733333333336, 1213.733333333336, 1214.483333333336, 1214.1833333333368, 1213.150000000003, 1213.333333333336, 1213.7333333333356, 1214.0333333333365, 1214.983333333336, 1213.6833333333363, 1214.1333333333373, 1213.5333333333363, 1214.183333333336, 1214.2833333333363, 1214.6833333333368, 1213.5833333333355, 1213.7833333333363, 1214.2833333333363, 1215.633333333336, 1214.133333333336, 1215.1833333333361, 1214.5333333333365, 1213.9333333333368, 1211.4666666666697, 1213.4833333333356, 1214.7333333333354, 1213.7333333333358, 1213.9833333333363, 1214.5833333333362, 1214.7333333333365, 1214.5333333333358, 1214.083333333337, 1213.1333333333364, 1214.2833333333358, 1214.083333333336, 1214.6333333333362, 1213.6833333333368, 1213.783333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.8250000000023, 1212.5416666666692, 1214.750000000002, 1215.2666666666694, 1213.933333333336, 1215.5166666666694, 1214.5833333333362, 1214.3833333333366, 1214.4000000000028, 1213.4833333333365, 1214.383333333336, 1214.1833333333361, 1214.0333333333367, 1214.5333333333363, 1215.0333333333363, 1213.7333333333365, 1213.2333333333363, 1213.3833333333364, 1213.3333333333355, 1213.433333333336, 1214.8333333333358, 1214.9583333333362, 1213.4833333333365, 1214.1333333333364, 1213.0333333333363, 1214.3333333333364, 1214.3833333333357, 1213.4833333333363, 1214.133333333336, 1213.383333333336, 1213.233333333336, 1214.6833333333363, 1214.233333333337, 1213.0833333333362, 1215.0333333333363, 1214.7833333333365, 1214.783333333336, 1214.4333333333363, 1214.383333333336, 1214.283333333336, 1212.6833333333361, 1214.8333333333358, 1214.1333333333362, 1213.3333333333362, 1213.3833333333357, 1213.4333333333363, 1214.7333333333356, 1213.4333333333361, 1213.2333333333358, 1214.4833333333363, 1214.0833333333367, 1214.7833333333365, 1214.1333333333357, 1214.5833333333364, 1213.7333333333363, 1214.083333333336, 1214.5333333333367, 1214.2833333333365, 1213.7833333333365, 1213.8333333333364, 1213.4833333333354, 1214.083333333336, 1213.733333333336, 1213.733333333336, 1214.483333333336, 1214.1833333333368, 1213.150000000003, 1213.333333333336, 1213.7333333333356, 1214.0333333333365, 1214.983333333336, 1213.6833333333363, 1214.1333333333373, 1213.5333333333363, 1214.183333333336, 1214.2833333333363, 1214.6833333333368, 1213.5833333333355, 1213.7833333333363, 1214.2833333333363, 1215.633333333336, 1214.133333333336, 1215.1833333333361, 1214.5333333333365, 1213.9333333333368, 1211.4666666666697, 1213.4833333333356, 1214.7333333333354, 1213.7333333333358, 1213.9833333333363, 1214.5833333333362, 1214.7333333333365, 1214.5333333333358, 1214.083333333337, 1213.1333333333364, 1214.2833333333358, 1214.083333333336, 1214.6333333333362, 1213.6833333333368, 1213.783333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2435088911228675, "mean_inference_ms": 2.0753275274089957, "mean_action_processing_ms": 0.0912753033654598, "mean_env_wait_ms": 1.5445616167318479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006989002227783203, "StateBufferConnector_ms": 0.0033721923828125, "ViewRequirementAgentConnector_ms": 0.08727788925170898}, "num_episodes": 24, "episode_return_max": 1215.633333333336, "episode_return_min": 1211.4666666666697, "episode_return_mean": 1214.0600833333363, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 491100, "num_agent_steps_trained": 490800, "num_env_steps_sampled": 491100, "num_env_steps_trained": 490800, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 232.23435051616698, "num_env_steps_trained_throughput_per_sec": 232.23435051616698, "timesteps_total": 491100, "num_env_steps_sampled_lifetime": 491100, "num_agent_steps_sampled_lifetime": 491100, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 491100, "timers": {"training_iteration_time_ms": 10262.987, "restore_workers_time_ms": 0.013, "training_step_time_ms": 648.37, "sample_time_ms": 631.519, "synch_weights_time_ms": 15.413}, "counters": {"num_env_steps_sampled": 491100, "num_env_steps_trained": 490800, "num_agent_steps_sampled": 491100, "num_agent_steps_trained": 490800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3274, "num_samples_added_to_queue": 491100}, "done": false, "training_iteration": 196, "trial_id": "27800_00000", "date": "2024-10-12_16-01-44", "timestamp": 1728745304, "time_this_iter_s": 10.344631910324097, "time_total_s": 2027.89182639122, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d470a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2027.89182639122, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 16.786666666666665, "ram_util_percent": 68.14}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4093.724853515625, "policy_loss": 161.16024780273438, "entropy": 4.858647346496582, "entropy_coeff": 0.01, "var_gnorm": 18.072710037231445, "vf_loss": 394714.0625, "vf_explained_var": 0.629338800907135}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1644.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 493500, "num_env_steps_trained": 493200, "num_agent_steps_sampled": 493500, "num_agent_steps_trained": 493200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3290, "num_samples_added_to_queue": 493500, "learner_queue": {"size_count": 1644, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.542, "learner_load_time_ms": 0.276, "learner_load_wait_time_ms": 1223.096, "learner_dequeue_time_ms": 10192.581}}, "env_runners": {"episode_reward_max": 1216.333333333337, "episode_reward_min": 1211.4666666666697, "episode_reward_mean": 1214.0608333333362, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.4666666666697}, "policy_reward_max": {"default_policy": 1216.333333333337}, "policy_reward_mean": {"default_policy": 1214.0608333333362}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.4965, "num_moves_min": 0.16, "num_moves_max": 0.73, "mean_accuracy_mean": 43.633206666666666, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.001, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16282333333333338, "num_slav_min": 0.16133333333333333, "num_slav_max": 0.1637666666666667, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5466151627711896, "mean_cluster_cpu_util_min": 0.5443178088803089, "mean_cluster_cpu_util_max": 0.5491961642765214, "mean_cluster_mem_util_mean": 0.3416220345464135, "mean_cluster_mem_util_min": 0.3411027162447258, "mean_cluster_mem_util_max": 0.34200632911392403, "reward_consolidation_mean_mean": 6.249791666666666, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333166666666692, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.44235, "reward_sla_mean_min": -2.4564999999999997, "reward_sla_mean_max": -2.42, "reward_consolidation_sum_mean": 624.9791666666667, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3166666666694, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.23500000000004, "reward_sla_sum_min": -245.64999999999998, "reward_sla_sum_max": -241.99999999999997, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5240.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.0333333333363, 1214.3333333333364, 1214.3833333333357, 1213.4833333333363, 1214.133333333336, 1213.383333333336, 1213.233333333336, 1214.6833333333363, 1214.233333333337, 1213.0833333333362, 1215.0333333333363, 1214.7833333333365, 1214.783333333336, 1214.4333333333363, 1214.383333333336, 1214.283333333336, 1212.6833333333361, 1214.8333333333358, 1214.1333333333362, 1213.3333333333362, 1213.3833333333357, 1213.4333333333363, 1214.7333333333356, 1213.4333333333361, 1213.2333333333358, 1214.4833333333363, 1214.0833333333367, 1214.7833333333365, 1214.1333333333357, 1214.5833333333364, 1213.7333333333363, 1214.083333333336, 1214.5333333333367, 1214.2833333333365, 1213.7833333333365, 1213.8333333333364, 1213.4833333333354, 1214.083333333336, 1213.733333333336, 1213.733333333336, 1214.483333333336, 1214.1833333333368, 1213.150000000003, 1213.333333333336, 1213.7333333333356, 1214.0333333333365, 1214.983333333336, 1213.6833333333363, 1214.1333333333373, 1213.5333333333363, 1214.183333333336, 1214.2833333333363, 1214.6833333333368, 1213.5833333333355, 1213.7833333333363, 1214.2833333333363, 1215.633333333336, 1214.133333333336, 1215.1833333333361, 1214.5333333333365, 1213.9333333333368, 1211.4666666666697, 1213.4833333333356, 1214.7333333333354, 1213.7333333333358, 1213.9833333333363, 1214.5833333333362, 1214.7333333333365, 1214.5333333333358, 1214.083333333337, 1213.1333333333364, 1214.2833333333358, 1214.083333333336, 1214.6333333333362, 1213.6833333333368, 1213.783333333336, 1216.333333333337, 1213.6833333333363, 1213.8333333333362, 1214.6333333333366, 1213.583333333336, 1213.8333333333362, 1214.3333333333364, 1214.7333333333365, 1213.7833333333363, 1214.7833333333363, 1213.9833333333358, 1214.2333333333365, 1213.2333333333365, 1213.9333333333363, 1213.8833333333364, 1213.083333333336, 1213.783333333337, 1213.5833333333364, 1214.2833333333363, 1214.4333333333361, 1213.6333333333357, 1214.8333333333364, 1214.4333333333361, 1214.5833333333362], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.0333333333363, 1214.3333333333364, 1214.3833333333357, 1213.4833333333363, 1214.133333333336, 1213.383333333336, 1213.233333333336, 1214.6833333333363, 1214.233333333337, 1213.0833333333362, 1215.0333333333363, 1214.7833333333365, 1214.783333333336, 1214.4333333333363, 1214.383333333336, 1214.283333333336, 1212.6833333333361, 1214.8333333333358, 1214.1333333333362, 1213.3333333333362, 1213.3833333333357, 1213.4333333333363, 1214.7333333333356, 1213.4333333333361, 1213.2333333333358, 1214.4833333333363, 1214.0833333333367, 1214.7833333333365, 1214.1333333333357, 1214.5833333333364, 1213.7333333333363, 1214.083333333336, 1214.5333333333367, 1214.2833333333365, 1213.7833333333365, 1213.8333333333364, 1213.4833333333354, 1214.083333333336, 1213.733333333336, 1213.733333333336, 1214.483333333336, 1214.1833333333368, 1213.150000000003, 1213.333333333336, 1213.7333333333356, 1214.0333333333365, 1214.983333333336, 1213.6833333333363, 1214.1333333333373, 1213.5333333333363, 1214.183333333336, 1214.2833333333363, 1214.6833333333368, 1213.5833333333355, 1213.7833333333363, 1214.2833333333363, 1215.633333333336, 1214.133333333336, 1215.1833333333361, 1214.5333333333365, 1213.9333333333368, 1211.4666666666697, 1213.4833333333356, 1214.7333333333354, 1213.7333333333358, 1213.9833333333363, 1214.5833333333362, 1214.7333333333365, 1214.5333333333358, 1214.083333333337, 1213.1333333333364, 1214.2833333333358, 1214.083333333336, 1214.6333333333362, 1213.6833333333368, 1213.783333333336, 1216.333333333337, 1213.6833333333363, 1213.8333333333362, 1214.6333333333366, 1213.583333333336, 1213.8333333333362, 1214.3333333333364, 1214.7333333333365, 1213.7833333333363, 1214.7833333333363, 1213.9833333333358, 1214.2333333333365, 1213.2333333333365, 1213.9333333333363, 1213.8833333333364, 1213.083333333336, 1213.783333333337, 1213.5833333333364, 1214.2833333333363, 1214.4333333333361, 1213.6333333333357, 1214.8333333333364, 1214.4333333333361, 1214.5833333333362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24356214597008496, "mean_inference_ms": 2.0757290981997873, "mean_action_processing_ms": 0.09129210605891405, "mean_env_wait_ms": 1.5448082531405887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006665945053100586, "StateBufferConnector_ms": 0.0033855438232421875, "ViewRequirementAgentConnector_ms": 0.08813023567199707}, "num_episodes": 24, "episode_return_max": 1216.333333333337, "episode_return_min": 1211.4666666666697, "episode_return_mean": 1214.0608333333362, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 493500, "num_agent_steps_trained": 493200, "num_env_steps_sampled": 493500, "num_env_steps_trained": 493200, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 233.66599354679576, "num_env_steps_trained_throughput_per_sec": 233.66599354679576, "timesteps_total": 493500, "num_env_steps_sampled_lifetime": 493500, "num_agent_steps_sampled_lifetime": 493500, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 493500, "timers": {"training_iteration_time_ms": 10283.31, "restore_workers_time_ms": 0.013, "training_step_time_ms": 641.326, "sample_time_ms": 625.849, "synch_weights_time_ms": 14.063}, "counters": {"num_env_steps_sampled": 493500, "num_env_steps_trained": 493200, "num_agent_steps_sampled": 493500, "num_agent_steps_trained": 493200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3290, "num_samples_added_to_queue": 493500}, "done": false, "training_iteration": 197, "trial_id": "27800_00000", "date": "2024-10-12_16-01-54", "timestamp": 1728745314, "time_this_iter_s": 10.284256935119629, "time_total_s": 2038.1760833263397, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486c3790>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2038.1760833263397, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 17.08, "ram_util_percent": 68.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2217.84130859375, "policy_loss": -1586.843017578125, "entropy": 4.889596939086914, "entropy_coeff": 0.01, "var_gnorm": 18.069076538085938, "vf_loss": 381935.3125, "vf_explained_var": 0.6395571827888489}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1652.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 495900, "num_env_steps_trained": 495600, "num_agent_steps_sampled": 495900, "num_agent_steps_trained": 495600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3306, "num_samples_added_to_queue": 495900, "learner_queue": {"size_count": 1652, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.399, "learner_load_time_ms": 0.247, "learner_load_wait_time_ms": 1190.908, "learner_dequeue_time_ms": 10202.627}}, "env_runners": {"episode_reward_max": 1216.333333333337, "episode_reward_min": 1211.4666666666697, "episode_reward_mean": 1214.0556666666698, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.4666666666697}, "policy_reward_max": {"default_policy": 1216.333333333337}, "policy_reward_mean": {"default_policy": 1214.0556666666698}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.43270000000000003, "num_moves_min": 0.16, "num_moves_max": 0.7, "mean_accuracy_mean": 43.63307999999999, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0014000000000000002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16281566666666666, "num_slav_min": 0.16133333333333333, "num_slav_max": 0.1636666666666667, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5463410990646259, "mean_cluster_cpu_util_min": 0.5440061017650304, "mean_cluster_cpu_util_max": 0.5491961642765214, "mean_cluster_mem_util_mean": 0.3416254258966244, "mean_cluster_mem_util_min": 0.3411027162447258, "mean_cluster_mem_util_max": 0.34212447257383954, "reward_consolidation_mean_mean": 6.249791666666666, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333000000000025, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4422349999999997, "reward_sla_mean_min": -2.455, "reward_sla_mean_max": -2.42, "reward_consolidation_sum_mean": 624.9791666666666, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3000000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.22349999999997, "reward_sla_sum_min": -245.50000000000003, "reward_sla_sum_max": -241.99999999999997, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4168.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.2333333333358, 1214.4833333333363, 1214.0833333333367, 1214.7833333333365, 1214.1333333333357, 1214.5833333333364, 1213.7333333333363, 1214.083333333336, 1214.5333333333367, 1214.2833333333365, 1213.7833333333365, 1213.8333333333364, 1213.4833333333354, 1214.083333333336, 1213.733333333336, 1213.733333333336, 1214.483333333336, 1214.1833333333368, 1213.150000000003, 1213.333333333336, 1213.7333333333356, 1214.0333333333365, 1214.983333333336, 1213.6833333333363, 1214.1333333333373, 1213.5333333333363, 1214.183333333336, 1214.2833333333363, 1214.6833333333368, 1213.5833333333355, 1213.7833333333363, 1214.2833333333363, 1215.633333333336, 1214.133333333336, 1215.1833333333361, 1214.5333333333365, 1213.9333333333368, 1211.4666666666697, 1213.4833333333356, 1214.7333333333354, 1213.7333333333358, 1213.9833333333363, 1214.5833333333362, 1214.7333333333365, 1214.5333333333358, 1214.083333333337, 1213.1333333333364, 1214.2833333333358, 1214.083333333336, 1214.6333333333362, 1213.6833333333368, 1213.783333333336, 1216.333333333337, 1213.6833333333363, 1213.8333333333362, 1214.6333333333366, 1213.583333333336, 1213.8333333333362, 1214.3333333333364, 1214.7333333333365, 1213.7833333333363, 1214.7833333333363, 1213.9833333333358, 1214.2333333333365, 1213.2333333333365, 1213.9333333333363, 1213.8833333333364, 1213.083333333336, 1213.783333333337, 1213.5833333333364, 1214.2833333333363, 1214.4333333333361, 1213.6333333333357, 1214.8333333333364, 1214.4333333333361, 1214.5833333333362, 1214.833333333337, 1214.6333333333362, 1213.4833333333363, 1212.0000000000027, 1214.600000000003, 1213.733333333336, 1214.0833333333367, 1213.8833333333364, 1213.8333333333358, 1215.833333333336, 1215.333333333336, 1213.7833333333358, 1214.333333333336, 1212.8333333333364, 1214.7333333333368, 1214.2333333333363, 1213.9833333333372, 1213.0833333333355, 1213.1833333333357, 1213.9333333333361, 1214.033333333336, 1213.6833333333366, 1213.583333333336, 1213.4833333333358], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.2333333333358, 1214.4833333333363, 1214.0833333333367, 1214.7833333333365, 1214.1333333333357, 1214.5833333333364, 1213.7333333333363, 1214.083333333336, 1214.5333333333367, 1214.2833333333365, 1213.7833333333365, 1213.8333333333364, 1213.4833333333354, 1214.083333333336, 1213.733333333336, 1213.733333333336, 1214.483333333336, 1214.1833333333368, 1213.150000000003, 1213.333333333336, 1213.7333333333356, 1214.0333333333365, 1214.983333333336, 1213.6833333333363, 1214.1333333333373, 1213.5333333333363, 1214.183333333336, 1214.2833333333363, 1214.6833333333368, 1213.5833333333355, 1213.7833333333363, 1214.2833333333363, 1215.633333333336, 1214.133333333336, 1215.1833333333361, 1214.5333333333365, 1213.9333333333368, 1211.4666666666697, 1213.4833333333356, 1214.7333333333354, 1213.7333333333358, 1213.9833333333363, 1214.5833333333362, 1214.7333333333365, 1214.5333333333358, 1214.083333333337, 1213.1333333333364, 1214.2833333333358, 1214.083333333336, 1214.6333333333362, 1213.6833333333368, 1213.783333333336, 1216.333333333337, 1213.6833333333363, 1213.8333333333362, 1214.6333333333366, 1213.583333333336, 1213.8333333333362, 1214.3333333333364, 1214.7333333333365, 1213.7833333333363, 1214.7833333333363, 1213.9833333333358, 1214.2333333333365, 1213.2333333333365, 1213.9333333333363, 1213.8833333333364, 1213.083333333336, 1213.783333333337, 1213.5833333333364, 1214.2833333333363, 1214.4333333333361, 1213.6333333333357, 1214.8333333333364, 1214.4333333333361, 1214.5833333333362, 1214.833333333337, 1214.6333333333362, 1213.4833333333363, 1212.0000000000027, 1214.600000000003, 1213.733333333336, 1214.0833333333367, 1213.8833333333364, 1213.8333333333358, 1215.833333333336, 1215.333333333336, 1213.7833333333358, 1214.333333333336, 1212.8333333333364, 1214.7333333333368, 1214.2333333333363, 1213.9833333333372, 1213.0833333333355, 1213.1833333333357, 1213.9333333333361, 1214.033333333336, 1213.6833333333366, 1213.583333333336, 1213.4833333333358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2436116541576461, "mean_inference_ms": 2.076024462208722, "mean_action_processing_ms": 0.09130544285701692, "mean_env_wait_ms": 1.5449917718476467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065708160400390625, "StateBufferConnector_ms": 0.0033757686614990234, "ViewRequirementAgentConnector_ms": 0.08757591247558594}, "num_episodes": 24, "episode_return_max": 1216.333333333337, "episode_return_min": 1211.4666666666697, "episode_return_mean": 1214.0556666666698, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 495900, "num_agent_steps_trained": 495600, "num_env_steps_sampled": 495900, "num_env_steps_trained": 495600, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 239.6241076430708, "num_env_steps_trained_throughput_per_sec": 239.6241076430708, "timesteps_total": 495900, "num_env_steps_sampled_lifetime": 495900, "num_agent_steps_sampled_lifetime": 495900, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 495900, "timers": {"training_iteration_time_ms": 10251.77, "restore_workers_time_ms": 0.018, "training_step_time_ms": 617.273, "sample_time_ms": 602.037, "synch_weights_time_ms": 13.681}, "counters": {"num_env_steps_sampled": 495900, "num_env_steps_trained": 495600, "num_agent_steps_sampled": 495900, "num_agent_steps_trained": 495600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3306, "num_samples_added_to_queue": 495900}, "done": false, "training_iteration": 198, "trial_id": "27800_00000", "date": "2024-10-12_16-02-04", "timestamp": 1728745324, "time_this_iter_s": 10.026126861572266, "time_total_s": 2048.202210187912, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d45ea0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2048.202210187912, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 16.571428571428573, "ram_util_percent": 68.25714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4492.88525390625, "policy_loss": 743.1181030273438, "entropy": 4.983637809753418, "entropy_coeff": 0.01, "var_gnorm": 18.06044578552246, "vf_loss": 376471.8125, "vf_explained_var": 0.6411378383636475}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1661.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 498450, "num_env_steps_trained": 498300, "num_agent_steps_sampled": 498450, "num_agent_steps_trained": 498300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3323, "num_samples_added_to_queue": 498300, "learner_queue": {"size_count": 1661, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.471, "learner_load_time_ms": 0.255, "learner_load_wait_time_ms": 1184.707, "learner_dequeue_time_ms": 10176.396}}, "env_runners": {"episode_reward_max": 1216.333333333337, "episode_reward_min": 1211.4666666666697, "episode_reward_mean": 1214.083500000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1211.4666666666697}, "policy_reward_max": {"default_policy": 1216.333333333337}, "policy_reward_mean": {"default_policy": 1214.083500000003}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.42090000000000005, "num_moves_min": 0.16, "num_moves_max": 0.66, "mean_accuracy_mean": 43.63314333333333, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0012000000000000001, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.1628026666666667, "num_slav_min": 0.16133333333333333, "num_slav_max": 0.1636666666666667, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5456050125827359, "mean_cluster_cpu_util_min": 0.5416729867622725, "mean_cluster_cpu_util_max": 0.5491961642765214, "mean_cluster_mem_util_mean": 0.34162288897679316, "mean_cluster_mem_util_min": 0.3411027162447258, "mean_cluster_mem_util_max": 0.34212447257383954, "reward_consolidation_mean_mean": 6.249791666666666, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.33308333333336, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.44204, "reward_sla_mean_min": -2.455, "reward_sla_mean_max": -2.42, "reward_consolidation_sum_mean": 624.9791666666666, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3083333333362, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.20399999999995, "reward_sla_sum_min": -245.50000000000003, "reward_sla_sum_max": -241.99999999999997, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3096.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.1333333333373, 1213.5333333333363, 1214.183333333336, 1214.2833333333363, 1214.6833333333368, 1213.5833333333355, 1213.7833333333363, 1214.2833333333363, 1215.633333333336, 1214.133333333336, 1215.1833333333361, 1214.5333333333365, 1213.9333333333368, 1211.4666666666697, 1213.4833333333356, 1214.7333333333354, 1213.7333333333358, 1213.9833333333363, 1214.5833333333362, 1214.7333333333365, 1214.5333333333358, 1214.083333333337, 1213.1333333333364, 1214.2833333333358, 1214.083333333336, 1214.6333333333362, 1213.6833333333368, 1213.783333333336, 1216.333333333337, 1213.6833333333363, 1213.8333333333362, 1214.6333333333366, 1213.583333333336, 1213.8333333333362, 1214.3333333333364, 1214.7333333333365, 1213.7833333333363, 1214.7833333333363, 1213.9833333333358, 1214.2333333333365, 1213.2333333333365, 1213.9333333333363, 1213.8833333333364, 1213.083333333336, 1213.783333333337, 1213.5833333333364, 1214.2833333333363, 1214.4333333333361, 1213.6333333333357, 1214.8333333333364, 1214.4333333333361, 1214.5833333333362, 1214.833333333337, 1214.6333333333362, 1213.4833333333363, 1212.0000000000027, 1214.600000000003, 1213.733333333336, 1214.0833333333367, 1213.8833333333364, 1213.8333333333358, 1215.833333333336, 1215.333333333336, 1213.7833333333358, 1214.333333333336, 1212.8333333333364, 1214.7333333333368, 1214.2333333333363, 1213.9833333333372, 1213.0833333333355, 1213.1833333333357, 1213.9333333333361, 1214.033333333336, 1213.6833333333366, 1213.583333333336, 1213.4833333333358, 1215.1833333333363, 1213.8833333333369, 1213.283333333336, 1214.6333333333366, 1214.6833333333366, 1213.583333333336, 1213.8333333333355, 1213.5833333333364, 1214.133333333336, 1214.7833333333358, 1213.6333333333366, 1213.6833333333366, 1214.2333333333365, 1215.0833333333367, 1213.083333333337, 1213.3333333333362, 1213.7833333333365, 1214.3333333333362, 1214.2333333333368, 1214.3333333333358, 1214.0833333333362, 1214.5333333333358, 1214.2333333333363, 1214.783333333337], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.1333333333373, 1213.5333333333363, 1214.183333333336, 1214.2833333333363, 1214.6833333333368, 1213.5833333333355, 1213.7833333333363, 1214.2833333333363, 1215.633333333336, 1214.133333333336, 1215.1833333333361, 1214.5333333333365, 1213.9333333333368, 1211.4666666666697, 1213.4833333333356, 1214.7333333333354, 1213.7333333333358, 1213.9833333333363, 1214.5833333333362, 1214.7333333333365, 1214.5333333333358, 1214.083333333337, 1213.1333333333364, 1214.2833333333358, 1214.083333333336, 1214.6333333333362, 1213.6833333333368, 1213.783333333336, 1216.333333333337, 1213.6833333333363, 1213.8333333333362, 1214.6333333333366, 1213.583333333336, 1213.8333333333362, 1214.3333333333364, 1214.7333333333365, 1213.7833333333363, 1214.7833333333363, 1213.9833333333358, 1214.2333333333365, 1213.2333333333365, 1213.9333333333363, 1213.8833333333364, 1213.083333333336, 1213.783333333337, 1213.5833333333364, 1214.2833333333363, 1214.4333333333361, 1213.6333333333357, 1214.8333333333364, 1214.4333333333361, 1214.5833333333362, 1214.833333333337, 1214.6333333333362, 1213.4833333333363, 1212.0000000000027, 1214.600000000003, 1213.733333333336, 1214.0833333333367, 1213.8833333333364, 1213.8333333333358, 1215.833333333336, 1215.333333333336, 1213.7833333333358, 1214.333333333336, 1212.8333333333364, 1214.7333333333368, 1214.2333333333363, 1213.9833333333372, 1213.0833333333355, 1213.1833333333357, 1213.9333333333361, 1214.033333333336, 1213.6833333333366, 1213.583333333336, 1213.4833333333358, 1215.1833333333363, 1213.8833333333369, 1213.283333333336, 1214.6333333333366, 1214.6833333333366, 1213.583333333336, 1213.8333333333355, 1213.5833333333364, 1214.133333333336, 1214.7833333333358, 1213.6333333333366, 1213.6833333333366, 1214.2333333333365, 1215.0833333333367, 1213.083333333337, 1213.3333333333362, 1213.7833333333365, 1214.3333333333362, 1214.2333333333368, 1214.3333333333358, 1214.0833333333362, 1214.5333333333358, 1214.2333333333363, 1214.783333333337]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2436515481589996, "mean_inference_ms": 2.076264562095538, "mean_action_processing_ms": 0.09131641219759773, "mean_env_wait_ms": 1.545144829016348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006597995758056641, "StateBufferConnector_ms": 0.003398895263671875, "ViewRequirementAgentConnector_ms": 0.08775448799133301}, "num_episodes": 24, "episode_return_max": 1216.333333333337, "episode_return_min": 1211.4666666666697, "episode_return_mean": 1214.083500000003, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 498450, "num_agent_steps_trained": 498300, "num_env_steps_sampled": 498450, "num_env_steps_trained": 498300, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 239.79724211120623, "num_env_steps_trained_throughput_per_sec": 253.90296223539482, "timesteps_total": 498450, "num_env_steps_sampled_lifetime": 498450, "num_agent_steps_sampled_lifetime": 498450, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 498450, "timers": {"training_iteration_time_ms": 10257.351, "restore_workers_time_ms": 0.014, "training_step_time_ms": 631.783, "sample_time_ms": 615.993, "synch_weights_time_ms": 14.238}, "counters": {"num_env_steps_sampled": 498450, "num_env_steps_trained": 498300, "num_agent_steps_sampled": 498450, "num_agent_steps_trained": 498300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3323, "num_samples_added_to_queue": 498300}, "done": false, "training_iteration": 199, "trial_id": "27800_00000", "date": "2024-10-12_16-02-15", "timestamp": 1728745335, "time_this_iter_s": 10.653009414672852, "time_total_s": 2058.855219602585, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9489534f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2058.855219602585, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 16.50625, "ram_util_percent": 68.35625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4306.10693359375, "policy_loss": 594.0048217773438, "entropy": 4.963497638702393, "entropy_coeff": 0.01, "var_gnorm": 18.056119918823242, "vf_loss": 372699.25, "vf_explained_var": 0.6407118439674377}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1669.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 501000, "num_env_steps_trained": 500700, "num_agent_steps_sampled": 501000, "num_agent_steps_trained": 500700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3340, "num_samples_added_to_queue": 501000, "learner_queue": {"size_count": 1669, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.256, "learner_load_time_ms": 0.271, "learner_load_wait_time_ms": 1177.278, "learner_dequeue_time_ms": 10093.339}}, "env_runners": {"episode_reward_max": 1216.333333333337, "episode_reward_min": 1212.0000000000027, "episode_reward_mean": 1214.0966666666695, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.0000000000027}, "policy_reward_max": {"default_policy": 1216.333333333337}, "policy_reward_mean": {"default_policy": 1214.0966666666695}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.42410000000000003, "num_moves_min": 0.16, "num_moves_max": 0.66, "mean_accuracy_mean": 43.633206666666666, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.001, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16281333333333337, "num_slav_min": 0.16133333333333333, "num_slav_max": 0.16386666666666672, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5443552615370472, "mean_cluster_cpu_util_min": 0.5395053433535576, "mean_cluster_cpu_util_max": 0.5475780819084392, "mean_cluster_mem_util_mean": 0.3416231170886075, "mean_cluster_mem_util_min": 0.3411888185654008, "mean_cluster_mem_util_max": 0.34212447257383954, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333166666666692, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4421999999999997, "reward_sla_mean_min": -2.4579999999999997, "reward_sla_mean_max": -2.42, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3166666666694, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.22, "reward_sla_sum_min": -245.79999999999998, "reward_sla_sum_max": -241.99999999999997, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1895.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.783333333336, 1216.333333333337, 1213.6833333333363, 1213.8333333333362, 1214.6333333333366, 1213.583333333336, 1213.8333333333362, 1214.3333333333364, 1214.7333333333365, 1213.7833333333363, 1214.7833333333363, 1213.9833333333358, 1214.2333333333365, 1213.2333333333365, 1213.9333333333363, 1213.8833333333364, 1213.083333333336, 1213.783333333337, 1213.5833333333364, 1214.2833333333363, 1214.4333333333361, 1213.6333333333357, 1214.8333333333364, 1214.4333333333361, 1214.5833333333362, 1214.833333333337, 1214.6333333333362, 1213.4833333333363, 1212.0000000000027, 1214.600000000003, 1213.733333333336, 1214.0833333333367, 1213.8833333333364, 1213.8333333333358, 1215.833333333336, 1215.333333333336, 1213.7833333333358, 1214.333333333336, 1212.8333333333364, 1214.7333333333368, 1214.2333333333363, 1213.9833333333372, 1213.0833333333355, 1213.1833333333357, 1213.9333333333361, 1214.033333333336, 1213.6833333333366, 1213.583333333336, 1213.4833333333358, 1215.1833333333363, 1213.8833333333369, 1213.283333333336, 1214.6333333333366, 1214.6833333333366, 1213.583333333336, 1213.8333333333355, 1213.5833333333364, 1214.133333333336, 1214.7833333333358, 1213.6333333333366, 1213.6833333333366, 1214.2333333333365, 1215.0833333333367, 1213.083333333337, 1213.3333333333362, 1213.7833333333365, 1214.3333333333362, 1214.2333333333368, 1214.3333333333358, 1214.0833333333362, 1214.5333333333358, 1214.2333333333363, 1214.783333333337, 1214.3833333333357, 1213.7833333333365, 1214.0833333333367, 1214.3333333333362, 1215.033333333336, 1214.9833333333358, 1213.6833333333354, 1213.5833333333364, 1214.1833333333366, 1213.8833333333362, 1214.883333333336, 1215.4333333333361, 1213.283333333336, 1214.1833333333361, 1214.1333333333364, 1212.5333333333363, 1213.1333333333357, 1214.733333333336, 1213.9833333333365, 1214.133333333335, 1214.3333333333362, 1214.5333333333365, 1213.8333333333358, 1215.1333333333357, 1213.8833333333366, 1213.6833333333361, 1214.5833333333367], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.783333333336, 1216.333333333337, 1213.6833333333363, 1213.8333333333362, 1214.6333333333366, 1213.583333333336, 1213.8333333333362, 1214.3333333333364, 1214.7333333333365, 1213.7833333333363, 1214.7833333333363, 1213.9833333333358, 1214.2333333333365, 1213.2333333333365, 1213.9333333333363, 1213.8833333333364, 1213.083333333336, 1213.783333333337, 1213.5833333333364, 1214.2833333333363, 1214.4333333333361, 1213.6333333333357, 1214.8333333333364, 1214.4333333333361, 1214.5833333333362, 1214.833333333337, 1214.6333333333362, 1213.4833333333363, 1212.0000000000027, 1214.600000000003, 1213.733333333336, 1214.0833333333367, 1213.8833333333364, 1213.8333333333358, 1215.833333333336, 1215.333333333336, 1213.7833333333358, 1214.333333333336, 1212.8333333333364, 1214.7333333333368, 1214.2333333333363, 1213.9833333333372, 1213.0833333333355, 1213.1833333333357, 1213.9333333333361, 1214.033333333336, 1213.6833333333366, 1213.583333333336, 1213.4833333333358, 1215.1833333333363, 1213.8833333333369, 1213.283333333336, 1214.6333333333366, 1214.6833333333366, 1213.583333333336, 1213.8333333333355, 1213.5833333333364, 1214.133333333336, 1214.7833333333358, 1213.6333333333366, 1213.6833333333366, 1214.2333333333365, 1215.0833333333367, 1213.083333333337, 1213.3333333333362, 1213.7833333333365, 1214.3333333333362, 1214.2333333333368, 1214.3333333333358, 1214.0833333333362, 1214.5333333333358, 1214.2333333333363, 1214.783333333337, 1214.3833333333357, 1213.7833333333365, 1214.0833333333367, 1214.3333333333362, 1215.033333333336, 1214.9833333333358, 1213.6833333333354, 1213.5833333333364, 1214.1833333333366, 1213.8833333333362, 1214.883333333336, 1215.4333333333361, 1213.283333333336, 1214.1833333333361, 1214.1333333333364, 1212.5333333333363, 1213.1333333333357, 1214.733333333336, 1213.9833333333365, 1214.133333333335, 1214.3333333333362, 1214.5333333333365, 1213.8333333333358, 1215.1333333333357, 1213.8833333333366, 1213.6833333333361, 1214.5833333333367]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24373173236543025, "mean_inference_ms": 2.078446743518886, "mean_action_processing_ms": 0.09134675810825289, "mean_env_wait_ms": 1.5457704294895565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006474733352661133, "StateBufferConnector_ms": 0.003385305404663086, "ViewRequirementAgentConnector_ms": 0.08695745468139648}, "num_episodes": 27, "episode_return_max": 1216.333333333337, "episode_return_min": 1212.0000000000027, "episode_return_mean": 1214.0966666666695, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 501000, "num_agent_steps_trained": 500700, "num_env_steps_sampled": 501000, "num_env_steps_trained": 500700, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 243.50640196446636, "num_env_steps_trained_throughput_per_sec": 229.18249596655656, "timesteps_total": 501000, "num_env_steps_sampled_lifetime": 501000, "num_agent_steps_sampled_lifetime": 501000, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 501000, "timers": {"training_iteration_time_ms": 10277.165, "restore_workers_time_ms": 0.013, "training_step_time_ms": 605.804, "sample_time_ms": 589.997, "synch_weights_time_ms": 14.388}, "counters": {"num_env_steps_sampled": 501000, "num_env_steps_trained": 500700, "num_agent_steps_sampled": 501000, "num_agent_steps_trained": 500700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3340, "num_samples_added_to_queue": 501000}, "done": false, "training_iteration": 200, "trial_id": "27800_00000", "date": "2024-10-12_16-02-25", "timestamp": 1728745345, "time_this_iter_s": 10.484384298324585, "time_total_s": 2069.3396039009094, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f69db0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2069.3396039009094, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 16.653333333333332, "ram_util_percent": 68.56666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 4087.30029296875, "policy_loss": 542.0762939453125, "entropy": 5.033054828643799, "entropy_coeff": 0.01, "var_gnorm": 18.059429168701172, "vf_loss": 356032.34375, "vf_explained_var": 0.6466180086135864}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1677.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 503400, "num_env_steps_trained": 503100, "num_agent_steps_sampled": 503400, "num_agent_steps_trained": 503100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3356, "num_samples_added_to_queue": 503400, "learner_queue": {"size_count": 1677, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.01, "learner_load_time_ms": 0.288, "learner_load_wait_time_ms": 1182.862, "learner_dequeue_time_ms": 10090.524}}, "env_runners": {"episode_reward_max": 1215.833333333336, "episode_reward_min": 1212.0000000000027, "episode_reward_mean": 1214.0721666666695, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.0000000000027}, "policy_reward_max": {"default_policy": 1215.833333333336}, "policy_reward_mean": {"default_policy": 1214.0721666666695}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.45439999999999997, "num_moves_min": 0.18, "num_moves_max": 0.62, "mean_accuracy_mean": 43.633206666666666, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0004, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.1628296666666667, "num_slav_min": 0.16166666666666665, "num_slav_max": 0.16386666666666672, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5433602871621621, "mean_cluster_cpu_util_min": 0.5395053433535576, "mean_cluster_cpu_util_max": 0.5474771787093216, "mean_cluster_mem_util_mean": 0.3416225896624473, "mean_cluster_mem_util_min": 0.3411888185654008, "mean_cluster_mem_util_max": 0.34212447257383954, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333166666666692, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4424449999999998, "reward_sla_mean_min": -2.4579999999999997, "reward_sla_mean_max": -2.425, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3166666666694, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.24449999999996, "reward_sla_sum_min": -245.79999999999998, "reward_sla_sum_max": -242.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2383.0, "global_timestep_min": 700, "global_timestep_max": 4000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.5833333333362, 1214.833333333337, 1214.6333333333362, 1213.4833333333363, 1212.0000000000027, 1214.600000000003, 1213.733333333336, 1214.0833333333367, 1213.8833333333364, 1213.8333333333358, 1215.833333333336, 1215.333333333336, 1213.7833333333358, 1214.333333333336, 1212.8333333333364, 1214.7333333333368, 1214.2333333333363, 1213.9833333333372, 1213.0833333333355, 1213.1833333333357, 1213.9333333333361, 1214.033333333336, 1213.6833333333366, 1213.583333333336, 1213.4833333333358, 1215.1833333333363, 1213.8833333333369, 1213.283333333336, 1214.6333333333366, 1214.6833333333366, 1213.583333333336, 1213.8333333333355, 1213.5833333333364, 1214.133333333336, 1214.7833333333358, 1213.6333333333366, 1213.6833333333366, 1214.2333333333365, 1215.0833333333367, 1213.083333333337, 1213.3333333333362, 1213.7833333333365, 1214.3333333333362, 1214.2333333333368, 1214.3333333333358, 1214.0833333333362, 1214.5333333333358, 1214.2333333333363, 1214.783333333337, 1214.3833333333357, 1213.7833333333365, 1214.0833333333367, 1214.3333333333362, 1215.033333333336, 1214.9833333333358, 1213.6833333333354, 1213.5833333333364, 1214.1833333333366, 1213.8833333333362, 1214.883333333336, 1215.4333333333361, 1213.283333333336, 1214.1833333333361, 1214.1333333333364, 1212.5333333333363, 1213.1333333333357, 1214.733333333336, 1213.9833333333365, 1214.133333333335, 1214.3333333333362, 1214.5333333333365, 1213.8333333333358, 1215.1333333333357, 1213.8833333333366, 1213.6833333333361, 1214.5833333333367, 1213.883333333336, 1213.6333333333364, 1214.8833333333353, 1214.2333333333368, 1213.5333333333367, 1214.4833333333365, 1213.983333333336, 1213.1833333333361, 1214.733333333336, 1213.5333333333358, 1214.1833333333363, 1214.383333333336, 1213.433333333336, 1213.6833333333366, 1213.8333333333364, 1213.3833333333362, 1214.533333333336, 1213.1333333333364, 1213.8833333333362, 1214.7333333333365, 1213.6833333333361, 1214.4833333333365, 1213.383333333336, 1215.3833333333362], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.5833333333362, 1214.833333333337, 1214.6333333333362, 1213.4833333333363, 1212.0000000000027, 1214.600000000003, 1213.733333333336, 1214.0833333333367, 1213.8833333333364, 1213.8333333333358, 1215.833333333336, 1215.333333333336, 1213.7833333333358, 1214.333333333336, 1212.8333333333364, 1214.7333333333368, 1214.2333333333363, 1213.9833333333372, 1213.0833333333355, 1213.1833333333357, 1213.9333333333361, 1214.033333333336, 1213.6833333333366, 1213.583333333336, 1213.4833333333358, 1215.1833333333363, 1213.8833333333369, 1213.283333333336, 1214.6333333333366, 1214.6833333333366, 1213.583333333336, 1213.8333333333355, 1213.5833333333364, 1214.133333333336, 1214.7833333333358, 1213.6333333333366, 1213.6833333333366, 1214.2333333333365, 1215.0833333333367, 1213.083333333337, 1213.3333333333362, 1213.7833333333365, 1214.3333333333362, 1214.2333333333368, 1214.3333333333358, 1214.0833333333362, 1214.5333333333358, 1214.2333333333363, 1214.783333333337, 1214.3833333333357, 1213.7833333333365, 1214.0833333333367, 1214.3333333333362, 1215.033333333336, 1214.9833333333358, 1213.6833333333354, 1213.5833333333364, 1214.1833333333366, 1213.8833333333362, 1214.883333333336, 1215.4333333333361, 1213.283333333336, 1214.1833333333361, 1214.1333333333364, 1212.5333333333363, 1213.1333333333357, 1214.733333333336, 1213.9833333333365, 1214.133333333335, 1214.3333333333362, 1214.5333333333365, 1213.8333333333358, 1215.1333333333357, 1213.8833333333366, 1213.6833333333361, 1214.5833333333367, 1213.883333333336, 1213.6333333333364, 1214.8833333333353, 1214.2333333333368, 1213.5333333333367, 1214.4833333333365, 1213.983333333336, 1213.1833333333361, 1214.733333333336, 1213.5333333333358, 1214.1833333333363, 1214.383333333336, 1213.433333333336, 1213.6833333333366, 1213.8333333333364, 1213.3833333333362, 1214.533333333336, 1213.1333333333364, 1213.8833333333362, 1214.7333333333365, 1213.6833333333361, 1214.4833333333365, 1213.383333333336, 1215.3833333333362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24375754218103807, "mean_inference_ms": 2.078538846482124, "mean_action_processing_ms": 0.09135081732076566, "mean_env_wait_ms": 1.5458236114966426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006463766098022461, "StateBufferConnector_ms": 0.0033648014068603516, "ViewRequirementAgentConnector_ms": 0.08640861511230469}, "num_episodes": 24, "episode_return_max": 1215.833333333336, "episode_return_min": 1212.0000000000027, "episode_return_mean": 1214.0721666666695, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 503400, "num_agent_steps_trained": 503100, "num_env_steps_sampled": 503400, "num_env_steps_trained": 503100, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 238.01739749478932, "num_env_steps_trained_throughput_per_sec": 238.01739749478932, "timesteps_total": 503400, "num_env_steps_sampled_lifetime": 503400, "num_agent_steps_sampled_lifetime": 503400, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 503400, "timers": {"training_iteration_time_ms": 10258.687, "restore_workers_time_ms": 0.013, "training_step_time_ms": 636.777, "sample_time_ms": 620.349, "synch_weights_time_ms": 14.782}, "counters": {"num_env_steps_sampled": 503400, "num_env_steps_trained": 503100, "num_agent_steps_sampled": 503400, "num_agent_steps_trained": 503100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3356, "num_samples_added_to_queue": 503400}, "done": false, "training_iteration": 201, "trial_id": "27800_00000", "date": "2024-10-12_16-02-35", "timestamp": 1728745355, "time_this_iter_s": 10.09521484375, "time_total_s": 2079.4348187446594, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d26f20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2079.4348187446594, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 17.07857142857143, "ram_util_percent": 68.73571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3924.18359375, "policy_loss": 197.779296875, "entropy": 5.034609794616699, "entropy_coeff": 0.01, "var_gnorm": 18.06340789794922, "vf_loss": 374150.8125, "vf_explained_var": 0.6398748159408569}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1685.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 505800, "num_env_steps_trained": 505500, "num_agent_steps_sampled": 505800, "num_agent_steps_trained": 505500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3372, "num_samples_added_to_queue": 505800, "learner_queue": {"size_count": 1685, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 64.643, "learner_load_time_ms": 0.326, "learner_load_wait_time_ms": 1261.466, "learner_dequeue_time_ms": 10183.163}}, "env_runners": {"episode_reward_max": 1215.4333333333361, "episode_reward_min": 1212.5333333333363, "episode_reward_mean": 1214.0508333333364, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.5333333333363}, "policy_reward_max": {"default_policy": 1215.4333333333361}, "policy_reward_mean": {"default_policy": 1214.0508333333364}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.5074, "num_moves_min": 0.36, "num_moves_max": 0.68, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.162855, "num_slav_min": 0.16193333333333332, "num_slav_max": 0.16386666666666672, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5428658526383525, "mean_cluster_cpu_util_min": 0.5395053433535576, "mean_cluster_cpu_util_max": 0.5468441694245266, "mean_cluster_mem_util_mean": 0.3416164556962025, "mean_cluster_mem_util_min": 0.3411888185654008, "mean_cluster_mem_util_max": 0.34192088607594934, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.442825, "reward_sla_mean_min": -2.4579999999999997, "reward_sla_mean_max": -2.4290000000000003, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.28249999999997, "reward_sla_sum_min": -245.79999999999998, "reward_sla_sum_max": -242.9, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3183.0, "global_timestep_min": 1500, "global_timestep_max": 4800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.4833333333358, 1215.1833333333363, 1213.8833333333369, 1213.283333333336, 1214.6333333333366, 1214.6833333333366, 1213.583333333336, 1213.8333333333355, 1213.5833333333364, 1214.133333333336, 1214.7833333333358, 1213.6333333333366, 1213.6833333333366, 1214.2333333333365, 1215.0833333333367, 1213.083333333337, 1213.3333333333362, 1213.7833333333365, 1214.3333333333362, 1214.2333333333368, 1214.3333333333358, 1214.0833333333362, 1214.5333333333358, 1214.2333333333363, 1214.783333333337, 1214.3833333333357, 1213.7833333333365, 1214.0833333333367, 1214.3333333333362, 1215.033333333336, 1214.9833333333358, 1213.6833333333354, 1213.5833333333364, 1214.1833333333366, 1213.8833333333362, 1214.883333333336, 1215.4333333333361, 1213.283333333336, 1214.1833333333361, 1214.1333333333364, 1212.5333333333363, 1213.1333333333357, 1214.733333333336, 1213.9833333333365, 1214.133333333335, 1214.3333333333362, 1214.5333333333365, 1213.8333333333358, 1215.1333333333357, 1213.8833333333366, 1213.6833333333361, 1214.5833333333367, 1213.883333333336, 1213.6333333333364, 1214.8833333333353, 1214.2333333333368, 1213.5333333333367, 1214.4833333333365, 1213.983333333336, 1213.1833333333361, 1214.733333333336, 1213.5333333333358, 1214.1833333333363, 1214.383333333336, 1213.433333333336, 1213.6833333333366, 1213.8333333333364, 1213.3833333333362, 1214.533333333336, 1213.1333333333364, 1213.8833333333362, 1214.7333333333365, 1213.6833333333361, 1214.4833333333365, 1213.383333333336, 1215.3833333333362, 1213.733333333336, 1213.7833333333367, 1213.8333333333355, 1215.1833333333366, 1213.8333333333367, 1213.0333333333372, 1214.183333333336, 1214.2833333333365, 1213.1833333333363, 1214.1833333333363, 1212.9333333333361, 1214.1333333333364, 1215.3333333333364, 1213.7333333333368, 1212.9333333333366, 1214.5333333333365, 1214.383333333336, 1213.3833333333355, 1213.733333333336, 1213.833333333336, 1213.883333333336, 1212.9833333333365, 1214.7333333333368, 1214.3333333333362], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.4833333333358, 1215.1833333333363, 1213.8833333333369, 1213.283333333336, 1214.6333333333366, 1214.6833333333366, 1213.583333333336, 1213.8333333333355, 1213.5833333333364, 1214.133333333336, 1214.7833333333358, 1213.6333333333366, 1213.6833333333366, 1214.2333333333365, 1215.0833333333367, 1213.083333333337, 1213.3333333333362, 1213.7833333333365, 1214.3333333333362, 1214.2333333333368, 1214.3333333333358, 1214.0833333333362, 1214.5333333333358, 1214.2333333333363, 1214.783333333337, 1214.3833333333357, 1213.7833333333365, 1214.0833333333367, 1214.3333333333362, 1215.033333333336, 1214.9833333333358, 1213.6833333333354, 1213.5833333333364, 1214.1833333333366, 1213.8833333333362, 1214.883333333336, 1215.4333333333361, 1213.283333333336, 1214.1833333333361, 1214.1333333333364, 1212.5333333333363, 1213.1333333333357, 1214.733333333336, 1213.9833333333365, 1214.133333333335, 1214.3333333333362, 1214.5333333333365, 1213.8333333333358, 1215.1333333333357, 1213.8833333333366, 1213.6833333333361, 1214.5833333333367, 1213.883333333336, 1213.6333333333364, 1214.8833333333353, 1214.2333333333368, 1213.5333333333367, 1214.4833333333365, 1213.983333333336, 1213.1833333333361, 1214.733333333336, 1213.5333333333358, 1214.1833333333363, 1214.383333333336, 1213.433333333336, 1213.6833333333366, 1213.8333333333364, 1213.3833333333362, 1214.533333333336, 1213.1333333333364, 1213.8833333333362, 1214.7333333333365, 1213.6833333333361, 1214.4833333333365, 1213.383333333336, 1215.3833333333362, 1213.733333333336, 1213.7833333333367, 1213.8333333333355, 1215.1833333333366, 1213.8333333333367, 1213.0333333333372, 1214.183333333336, 1214.2833333333365, 1213.1833333333363, 1214.1833333333363, 1212.9333333333361, 1214.1333333333364, 1215.3333333333364, 1213.7333333333368, 1212.9333333333366, 1214.5333333333365, 1214.383333333336, 1213.3833333333355, 1213.733333333336, 1213.833333333336, 1213.883333333336, 1212.9833333333365, 1214.7333333333368, 1214.3333333333362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24379332883823335, "mean_inference_ms": 2.078781268165652, "mean_action_processing_ms": 0.09135893816628599, "mean_env_wait_ms": 1.5459503827626286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006492137908935547, "StateBufferConnector_ms": 0.003408670425415039, "ViewRequirementAgentConnector_ms": 0.08720588684082031}, "num_episodes": 24, "episode_return_max": 1215.4333333333361, "episode_return_min": 1212.5333333333363, "episode_return_mean": 1214.0508333333364, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 505800, "num_agent_steps_trained": 505500, "num_env_steps_sampled": 505800, "num_env_steps_trained": 505500, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 227.19760100189373, "num_env_steps_trained_throughput_per_sec": 227.19760100189373, "timesteps_total": 505800, "num_env_steps_sampled_lifetime": 505800, "num_agent_steps_sampled_lifetime": 505800, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 505800, "timers": {"training_iteration_time_ms": 10313.185, "restore_workers_time_ms": 0.016, "training_step_time_ms": 659.001, "sample_time_ms": 642.28, "synch_weights_time_ms": 15.193}, "counters": {"num_env_steps_sampled": 505800, "num_env_steps_trained": 505500, "num_agent_steps_sampled": 505800, "num_agent_steps_trained": 505500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3372, "num_samples_added_to_queue": 505800}, "done": false, "training_iteration": 202, "trial_id": "27800_00000", "date": "2024-10-12_16-02-46", "timestamp": 1728745366, "time_this_iter_s": 10.57439637184143, "time_total_s": 2090.009215116501, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d27dc0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2090.009215116501, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 18.306666666666665, "ram_util_percent": 69.04666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2886.287841796875, "policy_loss": -630.15771484375, "entropy": 4.90406608581543, "entropy_coeff": 0.01, "var_gnorm": 18.073028564453125, "vf_loss": 353115.78125, "vf_explained_var": 0.646766185760498}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1693.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 508200, "num_env_steps_trained": 507900, "num_agent_steps_sampled": 508200, "num_agent_steps_trained": 507900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3388, "num_samples_added_to_queue": 508200, "learner_queue": {"size_count": 1693, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.133, "learner_load_time_ms": 0.328, "learner_load_wait_time_ms": 1225.443, "learner_dequeue_time_ms": 10267.923}}, "env_runners": {"episode_reward_max": 1215.4333333333361, "episode_reward_min": 1212.5333333333363, "episode_reward_mean": 1214.0078333333363, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.5333333333363}, "policy_reward_max": {"default_policy": 1215.4333333333361}, "policy_reward_mean": {"default_policy": 1214.0078333333363}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.49989999999999996, "num_moves_min": 0.29, "num_moves_max": 0.68, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.16288366666666668, "num_slav_min": 0.16193333333333332, "num_slav_max": 0.16386666666666672, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5431417417034382, "mean_cluster_cpu_util_min": 0.5395053433535576, "mean_cluster_cpu_util_max": 0.547367117117117, "mean_cluster_mem_util_mean": 0.3416256751054852, "mean_cluster_mem_util_min": 0.3411888185654008, "mean_cluster_mem_util_max": 0.3419419831223628, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4432549999999993, "reward_sla_mean_min": -2.4579999999999997, "reward_sla_mean_max": -2.4290000000000003, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.3255, "reward_sla_sum_min": -245.79999999999998, "reward_sla_sum_max": -242.9, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3983.0, "global_timestep_min": 2300, "global_timestep_max": 5600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.783333333337, 1214.3833333333357, 1213.7833333333365, 1214.0833333333367, 1214.3333333333362, 1215.033333333336, 1214.9833333333358, 1213.6833333333354, 1213.5833333333364, 1214.1833333333366, 1213.8833333333362, 1214.883333333336, 1215.4333333333361, 1213.283333333336, 1214.1833333333361, 1214.1333333333364, 1212.5333333333363, 1213.1333333333357, 1214.733333333336, 1213.9833333333365, 1214.133333333335, 1214.3333333333362, 1214.5333333333365, 1213.8333333333358, 1215.1333333333357, 1213.8833333333366, 1213.6833333333361, 1214.5833333333367, 1213.883333333336, 1213.6333333333364, 1214.8833333333353, 1214.2333333333368, 1213.5333333333367, 1214.4833333333365, 1213.983333333336, 1213.1833333333361, 1214.733333333336, 1213.5333333333358, 1214.1833333333363, 1214.383333333336, 1213.433333333336, 1213.6833333333366, 1213.8333333333364, 1213.3833333333362, 1214.533333333336, 1213.1333333333364, 1213.8833333333362, 1214.7333333333365, 1213.6833333333361, 1214.4833333333365, 1213.383333333336, 1215.3833333333362, 1213.733333333336, 1213.7833333333367, 1213.8333333333355, 1215.1833333333366, 1213.8333333333367, 1213.0333333333372, 1214.183333333336, 1214.2833333333365, 1213.1833333333363, 1214.1833333333363, 1212.9333333333361, 1214.1333333333364, 1215.3333333333364, 1213.7333333333368, 1212.9333333333366, 1214.5333333333365, 1214.383333333336, 1213.3833333333355, 1213.733333333336, 1213.833333333336, 1213.883333333336, 1212.9833333333365, 1214.7333333333368, 1214.3333333333362, 1213.833333333336, 1214.1333333333364, 1214.5333333333363, 1214.1833333333361, 1215.433333333336, 1215.1333333333364, 1213.0833333333362, 1213.6333333333369, 1213.9833333333363, 1212.8333333333358, 1213.4333333333363, 1214.2833333333367, 1213.2333333333363, 1214.1833333333361, 1212.7833333333365, 1214.3333333333353, 1213.8333333333362, 1213.3833333333366, 1212.7333333333363, 1213.9833333333368, 1213.7333333333363, 1214.2833333333367, 1214.4333333333361, 1213.9333333333366], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.783333333337, 1214.3833333333357, 1213.7833333333365, 1214.0833333333367, 1214.3333333333362, 1215.033333333336, 1214.9833333333358, 1213.6833333333354, 1213.5833333333364, 1214.1833333333366, 1213.8833333333362, 1214.883333333336, 1215.4333333333361, 1213.283333333336, 1214.1833333333361, 1214.1333333333364, 1212.5333333333363, 1213.1333333333357, 1214.733333333336, 1213.9833333333365, 1214.133333333335, 1214.3333333333362, 1214.5333333333365, 1213.8333333333358, 1215.1333333333357, 1213.8833333333366, 1213.6833333333361, 1214.5833333333367, 1213.883333333336, 1213.6333333333364, 1214.8833333333353, 1214.2333333333368, 1213.5333333333367, 1214.4833333333365, 1213.983333333336, 1213.1833333333361, 1214.733333333336, 1213.5333333333358, 1214.1833333333363, 1214.383333333336, 1213.433333333336, 1213.6833333333366, 1213.8333333333364, 1213.3833333333362, 1214.533333333336, 1213.1333333333364, 1213.8833333333362, 1214.7333333333365, 1213.6833333333361, 1214.4833333333365, 1213.383333333336, 1215.3833333333362, 1213.733333333336, 1213.7833333333367, 1213.8333333333355, 1215.1833333333366, 1213.8333333333367, 1213.0333333333372, 1214.183333333336, 1214.2833333333365, 1213.1833333333363, 1214.1833333333363, 1212.9333333333361, 1214.1333333333364, 1215.3333333333364, 1213.7333333333368, 1212.9333333333366, 1214.5333333333365, 1214.383333333336, 1213.3833333333355, 1213.733333333336, 1213.833333333336, 1213.883333333336, 1212.9833333333365, 1214.7333333333368, 1214.3333333333362, 1213.833333333336, 1214.1333333333364, 1214.5333333333363, 1214.1833333333361, 1215.433333333336, 1215.1333333333364, 1213.0833333333362, 1213.6333333333369, 1213.9833333333363, 1212.8333333333358, 1213.4333333333363, 1214.2833333333367, 1213.2333333333363, 1214.1833333333361, 1212.7833333333365, 1214.3333333333353, 1213.8333333333362, 1213.3833333333366, 1212.7333333333363, 1213.9833333333368, 1213.7333333333363, 1214.2833333333367, 1214.4333333333361, 1213.9333333333366]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24382710332308202, "mean_inference_ms": 2.079084539489236, "mean_action_processing_ms": 0.09136878692611766, "mean_env_wait_ms": 1.5461080216942202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006539106369018555, "StateBufferConnector_ms": 0.0033807754516601562, "ViewRequirementAgentConnector_ms": 0.08699774742126465}, "num_episodes": 24, "episode_return_max": 1215.4333333333361, "episode_return_min": 1212.5333333333363, "episode_return_mean": 1214.0078333333363, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 508200, "num_agent_steps_trained": 507900, "num_env_steps_sampled": 508200, "num_env_steps_trained": 507900, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 235.17847302911775, "num_env_steps_trained_throughput_per_sec": 235.17847302911775, "timesteps_total": 508200, "num_env_steps_sampled_lifetime": 508200, "num_agent_steps_sampled_lifetime": 508200, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 508200, "timers": {"training_iteration_time_ms": 10320.058, "restore_workers_time_ms": 0.013, "training_step_time_ms": 630.37, "sample_time_ms": 613.845, "synch_weights_time_ms": 14.976}, "counters": {"num_env_steps_sampled": 508200, "num_env_steps_trained": 507900, "num_agent_steps_sampled": 508200, "num_agent_steps_trained": 507900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3388, "num_samples_added_to_queue": 508200}, "done": false, "training_iteration": 203, "trial_id": "27800_00000", "date": "2024-10-12_16-02-56", "timestamp": 1728745376, "time_this_iter_s": 10.217445611953735, "time_total_s": 2100.2266607284546, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f3d30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2100.2266607284546, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 17.326666666666664, "ram_util_percent": 69.11999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 5697.2919921875, "policy_loss": 1800.94384765625, "entropy": 4.743345737457275, "entropy_coeff": 0.01, "var_gnorm": 18.080724716186523, "vf_loss": 391057.84375, "vf_explained_var": 0.6357138156890869}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1701.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 510600, "num_env_steps_trained": 510300, "num_agent_steps_sampled": 510600, "num_agent_steps_trained": 510300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3404, "num_samples_added_to_queue": 510600, "learner_queue": {"size_count": 1701, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.521, "learner_load_time_ms": 0.352, "learner_load_wait_time_ms": 1200.971, "learner_dequeue_time_ms": 10208.36}}, "env_runners": {"episode_reward_max": 1215.5333333333365, "episode_reward_min": 1212.7333333333363, "episode_reward_mean": 1213.9848333333364, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.7333333333363}, "policy_reward_max": {"default_policy": 1215.5333333333365}, "policy_reward_mean": {"default_policy": 1213.9848333333364}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.4469000000000001, "num_moves_min": 0.16, "num_moves_max": 0.68, "mean_accuracy_mean": 43.63333333333333, "mean_accuracy_min": 43.63333333333334, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0, "num_model_switches_min": 0.0, "num_model_switches_max": 0.0, "num_slav_mean": 0.16289900000000002, "num_slav_min": 0.1618666666666667, "num_slav_max": 0.16373333333333334, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5441327961252069, "mean_cluster_cpu_util_min": 0.5403619806030521, "mean_cluster_cpu_util_max": 0.5474511858797573, "mean_cluster_mem_util_mean": 0.3416240928270042, "mean_cluster_mem_util_min": 0.34120991561181424, "mean_cluster_mem_util_max": 0.3419419831223628, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333333333333359, "reward_accuracy_mean_min": 8.33333333333336, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.443485, "reward_sla_mean_min": -2.456, "reward_sla_mean_max": -2.4279999999999995, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3333333333362, "reward_accuracy_sum_min": 833.3333333333361, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.34849999999994, "reward_sla_sum_min": -245.6, "reward_sla_sum_max": -242.79999999999995, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4778.0, "global_timestep_min": 2900, "global_timestep_max": 6400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1215.1333333333357, 1213.8833333333366, 1213.6833333333361, 1214.5833333333367, 1213.883333333336, 1213.6333333333364, 1214.8833333333353, 1214.2333333333368, 1213.5333333333367, 1214.4833333333365, 1213.983333333336, 1213.1833333333361, 1214.733333333336, 1213.5333333333358, 1214.1833333333363, 1214.383333333336, 1213.433333333336, 1213.6833333333366, 1213.8333333333364, 1213.3833333333362, 1214.533333333336, 1213.1333333333364, 1213.8833333333362, 1214.7333333333365, 1213.6833333333361, 1214.4833333333365, 1213.383333333336, 1215.3833333333362, 1213.733333333336, 1213.7833333333367, 1213.8333333333355, 1215.1833333333366, 1213.8333333333367, 1213.0333333333372, 1214.183333333336, 1214.2833333333365, 1213.1833333333363, 1214.1833333333363, 1212.9333333333361, 1214.1333333333364, 1215.3333333333364, 1213.7333333333368, 1212.9333333333366, 1214.5333333333365, 1214.383333333336, 1213.3833333333355, 1213.733333333336, 1213.833333333336, 1213.883333333336, 1212.9833333333365, 1214.7333333333368, 1214.3333333333362, 1213.833333333336, 1214.1333333333364, 1214.5333333333363, 1214.1833333333361, 1215.433333333336, 1215.1333333333364, 1213.0833333333362, 1213.6333333333369, 1213.9833333333363, 1212.8333333333358, 1213.4333333333363, 1214.2833333333367, 1213.2333333333363, 1214.1833333333361, 1212.7833333333365, 1214.3333333333353, 1213.8333333333362, 1213.3833333333366, 1212.7333333333363, 1213.9833333333368, 1213.7333333333363, 1214.2833333333367, 1214.4333333333361, 1213.9333333333366, 1214.5333333333358, 1214.8833333333362, 1213.4833333333363, 1214.5833333333362, 1213.8333333333364, 1212.8833333333353, 1214.033333333336, 1213.0833333333364, 1214.0833333333362, 1213.9833333333363, 1214.483333333337, 1214.433333333336, 1214.3833333333364, 1213.533333333336, 1214.2833333333365, 1213.0333333333353, 1215.5333333333365, 1213.9333333333361, 1214.4333333333361, 1213.8333333333362, 1214.0333333333363, 1215.5333333333363, 1213.7333333333358, 1212.9833333333365], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1215.1333333333357, 1213.8833333333366, 1213.6833333333361, 1214.5833333333367, 1213.883333333336, 1213.6333333333364, 1214.8833333333353, 1214.2333333333368, 1213.5333333333367, 1214.4833333333365, 1213.983333333336, 1213.1833333333361, 1214.733333333336, 1213.5333333333358, 1214.1833333333363, 1214.383333333336, 1213.433333333336, 1213.6833333333366, 1213.8333333333364, 1213.3833333333362, 1214.533333333336, 1213.1333333333364, 1213.8833333333362, 1214.7333333333365, 1213.6833333333361, 1214.4833333333365, 1213.383333333336, 1215.3833333333362, 1213.733333333336, 1213.7833333333367, 1213.8333333333355, 1215.1833333333366, 1213.8333333333367, 1213.0333333333372, 1214.183333333336, 1214.2833333333365, 1213.1833333333363, 1214.1833333333363, 1212.9333333333361, 1214.1333333333364, 1215.3333333333364, 1213.7333333333368, 1212.9333333333366, 1214.5333333333365, 1214.383333333336, 1213.3833333333355, 1213.733333333336, 1213.833333333336, 1213.883333333336, 1212.9833333333365, 1214.7333333333368, 1214.3333333333362, 1213.833333333336, 1214.1333333333364, 1214.5333333333363, 1214.1833333333361, 1215.433333333336, 1215.1333333333364, 1213.0833333333362, 1213.6333333333369, 1213.9833333333363, 1212.8333333333358, 1213.4333333333363, 1214.2833333333367, 1213.2333333333363, 1214.1833333333361, 1212.7833333333365, 1214.3333333333353, 1213.8333333333362, 1213.3833333333366, 1212.7333333333363, 1213.9833333333368, 1213.7333333333363, 1214.2833333333367, 1214.4333333333361, 1213.9333333333366, 1214.5333333333358, 1214.8833333333362, 1213.4833333333363, 1214.5833333333362, 1213.8333333333364, 1212.8833333333353, 1214.033333333336, 1213.0833333333364, 1214.0833333333362, 1213.9833333333363, 1214.483333333337, 1214.433333333336, 1214.3833333333364, 1213.533333333336, 1214.2833333333365, 1213.0333333333353, 1215.5333333333365, 1213.9333333333361, 1214.4333333333361, 1213.8333333333362, 1214.0333333333363, 1215.5333333333363, 1213.7333333333358, 1212.9833333333365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2438129043459859, "mean_inference_ms": 2.0774482204777884, "mean_action_processing_ms": 0.09135861972196349, "mean_env_wait_ms": 1.5457657731462158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006739139556884766, "StateBufferConnector_ms": 0.0034530162811279297, "ViewRequirementAgentConnector_ms": 0.08831357955932617}, "num_episodes": 24, "episode_return_max": 1215.5333333333365, "episode_return_min": 1212.7333333333363, "episode_return_mean": 1213.9848333333364, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 510600, "num_agent_steps_trained": 510300, "num_env_steps_sampled": 510600, "num_env_steps_trained": 510300, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 239.77339797681802, "num_env_steps_trained_throughput_per_sec": 239.77339797681802, "timesteps_total": 510600, "num_env_steps_sampled_lifetime": 510600, "num_agent_steps_sampled_lifetime": 510600, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 510600, "timers": {"training_iteration_time_ms": 10269.155, "restore_workers_time_ms": 0.014, "training_step_time_ms": 633.827, "sample_time_ms": 618.379, "synch_weights_time_ms": 13.781}, "counters": {"num_env_steps_sampled": 510600, "num_env_steps_trained": 510300, "num_agent_steps_sampled": 510600, "num_agent_steps_trained": 510300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3404, "num_samples_added_to_queue": 510600}, "done": false, "training_iteration": 204, "trial_id": "27800_00000", "date": "2024-10-12_16-03-06", "timestamp": 1728745386, "time_this_iter_s": 10.019809246063232, "time_total_s": 2110.246469974518, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d27fd0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2110.246469974518, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 16.87142857142857, "ram_util_percent": 69.27142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3696.850341796875, "policy_loss": -191.51766967773438, "entropy": 4.710787773132324, "entropy_coeff": 0.01, "var_gnorm": 18.089618682861328, "vf_loss": 390250.0625, "vf_explained_var": 0.6352630853652954}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1709.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 513000, "num_env_steps_trained": 512700, "num_agent_steps_sampled": 513000, "num_agent_steps_trained": 512700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3420, "num_samples_added_to_queue": 513000, "learner_queue": {"size_count": 1709, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 64.613, "learner_load_time_ms": 0.35, "learner_load_wait_time_ms": 1200.258, "learner_dequeue_time_ms": 10196.224}}, "env_runners": {"episode_reward_max": 1216.0333333333365, "episode_reward_min": 1212.7333333333358, "episode_reward_mean": 1213.986000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.7333333333358}, "policy_reward_max": {"default_policy": 1216.0333333333365}, "policy_reward_mean": {"default_policy": 1213.986000000003}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.37890000000000007, "num_moves_min": 0.14, "num_moves_max": 0.68, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16289266666666669, "num_slav_min": 0.16153333333333333, "num_slav_max": 0.16373333333333334, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5451029308006986, "mean_cluster_cpu_util_min": 0.5412862773487773, "mean_cluster_cpu_util_max": 0.5479066349512778, "mean_cluster_mem_util_mean": 0.34161731540084384, "mean_cluster_mem_util_min": 0.341223628691983, "mean_cluster_mem_util_max": 0.3419419831223628, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4433899999999995, "reward_sla_mean_min": -2.456, "reward_sla_mean_max": -2.423, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.33900000000003, "reward_sla_sum_min": -245.6, "reward_sla_sum_max": -242.29999999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5578.0, "global_timestep_min": 3700, "global_timestep_max": 7200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.6833333333361, 1214.4833333333365, 1213.383333333336, 1215.3833333333362, 1213.733333333336, 1213.7833333333367, 1213.8333333333355, 1215.1833333333366, 1213.8333333333367, 1213.0333333333372, 1214.183333333336, 1214.2833333333365, 1213.1833333333363, 1214.1833333333363, 1212.9333333333361, 1214.1333333333364, 1215.3333333333364, 1213.7333333333368, 1212.9333333333366, 1214.5333333333365, 1214.383333333336, 1213.3833333333355, 1213.733333333336, 1213.833333333336, 1213.883333333336, 1212.9833333333365, 1214.7333333333368, 1214.3333333333362, 1213.833333333336, 1214.1333333333364, 1214.5333333333363, 1214.1833333333361, 1215.433333333336, 1215.1333333333364, 1213.0833333333362, 1213.6333333333369, 1213.9833333333363, 1212.8333333333358, 1213.4333333333363, 1214.2833333333367, 1213.2333333333363, 1214.1833333333361, 1212.7833333333365, 1214.3333333333353, 1213.8333333333362, 1213.3833333333366, 1212.7333333333363, 1213.9833333333368, 1213.7333333333363, 1214.2833333333367, 1214.4333333333361, 1213.9333333333366, 1214.5333333333358, 1214.8833333333362, 1213.4833333333363, 1214.5833333333362, 1213.8333333333364, 1212.8833333333353, 1214.033333333336, 1213.0833333333364, 1214.0833333333362, 1213.9833333333363, 1214.483333333337, 1214.433333333336, 1214.3833333333364, 1213.533333333336, 1214.2833333333365, 1213.0333333333353, 1215.5333333333365, 1213.9333333333361, 1214.4333333333361, 1213.8333333333362, 1214.0333333333363, 1215.5333333333363, 1213.7333333333358, 1212.9833333333365, 1213.8833333333362, 1213.0333333333358, 1213.9333333333361, 1216.0333333333365, 1213.533333333336, 1214.6833333333363, 1213.5333333333358, 1213.6833333333366, 1213.9833333333363, 1214.3333333333362, 1214.4333333333361, 1215.683333333336, 1213.033333333336, 1215.1333333333364, 1212.983333333336, 1214.333333333336, 1214.383333333336, 1213.5333333333356, 1213.1333333333369, 1213.4000000000033, 1212.7333333333358, 1213.8333333333364, 1214.7333333333365, 1214.683333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.6833333333361, 1214.4833333333365, 1213.383333333336, 1215.3833333333362, 1213.733333333336, 1213.7833333333367, 1213.8333333333355, 1215.1833333333366, 1213.8333333333367, 1213.0333333333372, 1214.183333333336, 1214.2833333333365, 1213.1833333333363, 1214.1833333333363, 1212.9333333333361, 1214.1333333333364, 1215.3333333333364, 1213.7333333333368, 1212.9333333333366, 1214.5333333333365, 1214.383333333336, 1213.3833333333355, 1213.733333333336, 1213.833333333336, 1213.883333333336, 1212.9833333333365, 1214.7333333333368, 1214.3333333333362, 1213.833333333336, 1214.1333333333364, 1214.5333333333363, 1214.1833333333361, 1215.433333333336, 1215.1333333333364, 1213.0833333333362, 1213.6333333333369, 1213.9833333333363, 1212.8333333333358, 1213.4333333333363, 1214.2833333333367, 1213.2333333333363, 1214.1833333333361, 1212.7833333333365, 1214.3333333333353, 1213.8333333333362, 1213.3833333333366, 1212.7333333333363, 1213.9833333333368, 1213.7333333333363, 1214.2833333333367, 1214.4333333333361, 1213.9333333333366, 1214.5333333333358, 1214.8833333333362, 1213.4833333333363, 1214.5833333333362, 1213.8333333333364, 1212.8833333333353, 1214.033333333336, 1213.0833333333364, 1214.0833333333362, 1213.9833333333363, 1214.483333333337, 1214.433333333336, 1214.3833333333364, 1213.533333333336, 1214.2833333333365, 1213.0333333333353, 1215.5333333333365, 1213.9333333333361, 1214.4333333333361, 1213.8333333333362, 1214.0333333333363, 1215.5333333333363, 1213.7333333333358, 1212.9833333333365, 1213.8833333333362, 1213.0333333333358, 1213.9333333333361, 1216.0333333333365, 1213.533333333336, 1214.6833333333363, 1213.5333333333358, 1213.6833333333366, 1213.9833333333363, 1214.3333333333362, 1214.4333333333361, 1215.683333333336, 1213.033333333336, 1215.1333333333364, 1212.983333333336, 1214.333333333336, 1214.383333333336, 1213.5333333333356, 1213.1333333333369, 1213.4000000000033, 1212.7333333333358, 1213.8333333333364, 1214.7333333333365, 1214.683333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24384780030826864, "mean_inference_ms": 2.0778407388015414, "mean_action_processing_ms": 0.09137110280210123, "mean_env_wait_ms": 1.545945481851495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007105350494384766, "StateBufferConnector_ms": 0.0034346580505371094, "ViewRequirementAgentConnector_ms": 0.0881047248840332}, "num_episodes": 24, "episode_return_max": 1216.0333333333365, "episode_return_min": 1212.7333333333358, "episode_return_mean": 1213.986000000003, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 513000, "num_agent_steps_trained": 512700, "num_env_steps_sampled": 513000, "num_env_steps_trained": 512700, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 236.4840571949422, "num_env_steps_trained_throughput_per_sec": 236.4840571949422, "timesteps_total": 513000, "num_env_steps_sampled_lifetime": 513000, "num_agent_steps_sampled_lifetime": 513000, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 513000, "timers": {"training_iteration_time_ms": 10273.716, "restore_workers_time_ms": 0.013, "training_step_time_ms": 647.872, "sample_time_ms": 631.084, "synch_weights_time_ms": 15.154}, "counters": {"num_env_steps_sampled": 513000, "num_env_steps_trained": 512700, "num_agent_steps_sampled": 513000, "num_agent_steps_trained": 512700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3420, "num_samples_added_to_queue": 513000}, "done": false, "training_iteration": 205, "trial_id": "27800_00000", "date": "2024-10-12_16-03-17", "timestamp": 1728745397, "time_this_iter_s": 10.160356044769287, "time_total_s": 2120.406826019287, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d45630>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2120.406826019287, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 17.326666666666664, "ram_util_percent": 69.56666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 5188.384765625, "policy_loss": 1131.7083740234375, "entropy": 4.703805446624756, "entropy_coeff": 0.01, "var_gnorm": 18.09613037109375, "vf_loss": 407078.78125, "vf_explained_var": 0.6290196180343628}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1717.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 515400, "num_env_steps_trained": 515100, "num_agent_steps_sampled": 515400, "num_agent_steps_trained": 515100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3436, "num_samples_added_to_queue": 515400, "learner_queue": {"size_count": 1717, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 68.025, "learner_load_time_ms": 0.347, "learner_load_wait_time_ms": 1205.513, "learner_dequeue_time_ms": 10187.924}}, "env_runners": {"episode_reward_max": 1216.0333333333365, "episode_reward_min": 1212.7333333333358, "episode_reward_mean": 1214.034500000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.7333333333358}, "policy_reward_max": {"default_policy": 1216.0333333333365}, "policy_reward_mean": {"default_policy": 1214.034500000003}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.3032, "num_moves_min": 0.14, "num_moves_max": 0.61, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0008, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16286033333333336, "num_slav_min": 0.16153333333333333, "num_slav_max": 0.16373333333333334, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5459587558604523, "mean_cluster_cpu_util_min": 0.5436175997425997, "mean_cluster_cpu_util_max": 0.5487201691487406, "mean_cluster_mem_util_mean": 0.34161497362869186, "mean_cluster_mem_util_min": 0.3411371308016878, "mean_cluster_mem_util_max": 0.3420748945147678, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4429049999999997, "reward_sla_mean_min": -2.456, "reward_sla_mean_max": -2.423, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.29049999999998, "reward_sla_sum_min": -245.6, "reward_sla_sum_max": -242.29999999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5910.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.883333333336, 1212.9833333333365, 1214.7333333333368, 1214.3333333333362, 1213.833333333336, 1214.1333333333364, 1214.5333333333363, 1214.1833333333361, 1215.433333333336, 1215.1333333333364, 1213.0833333333362, 1213.6333333333369, 1213.9833333333363, 1212.8333333333358, 1213.4333333333363, 1214.2833333333367, 1213.2333333333363, 1214.1833333333361, 1212.7833333333365, 1214.3333333333353, 1213.8333333333362, 1213.3833333333366, 1212.7333333333363, 1213.9833333333368, 1213.7333333333363, 1214.2833333333367, 1214.4333333333361, 1213.9333333333366, 1214.5333333333358, 1214.8833333333362, 1213.4833333333363, 1214.5833333333362, 1213.8333333333364, 1212.8833333333353, 1214.033333333336, 1213.0833333333364, 1214.0833333333362, 1213.9833333333363, 1214.483333333337, 1214.433333333336, 1214.3833333333364, 1213.533333333336, 1214.2833333333365, 1213.0333333333353, 1215.5333333333365, 1213.9333333333361, 1214.4333333333361, 1213.8333333333362, 1214.0333333333363, 1215.5333333333363, 1213.7333333333358, 1212.9833333333365, 1213.8833333333362, 1213.0333333333358, 1213.9333333333361, 1216.0333333333365, 1213.533333333336, 1214.6833333333363, 1213.5333333333358, 1213.6833333333366, 1213.9833333333363, 1214.3333333333362, 1214.4333333333361, 1215.683333333336, 1213.033333333336, 1215.1333333333364, 1212.983333333336, 1214.333333333336, 1214.383333333336, 1213.5333333333356, 1213.1333333333369, 1213.4000000000033, 1212.7333333333358, 1213.8333333333364, 1214.7333333333365, 1214.683333333336, 1214.5333333333365, 1214.8833333333362, 1214.5833333333367, 1215.0333333333363, 1214.1833333333361, 1212.9833333333358, 1214.5333333333363, 1213.9833333333356, 1213.6833333333354, 1214.283333333336, 1213.5833333333367, 1214.2333333333365, 1214.1833333333366, 1214.2333333333363, 1214.2833333333363, 1214.4833333333356, 1213.7333333333363, 1213.5833333333362, 1214.2333333333365, 1215.0833333333364, 1213.9333333333361, 1214.1333333333366, 1213.783333333336, 1213.783333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.883333333336, 1212.9833333333365, 1214.7333333333368, 1214.3333333333362, 1213.833333333336, 1214.1333333333364, 1214.5333333333363, 1214.1833333333361, 1215.433333333336, 1215.1333333333364, 1213.0833333333362, 1213.6333333333369, 1213.9833333333363, 1212.8333333333358, 1213.4333333333363, 1214.2833333333367, 1213.2333333333363, 1214.1833333333361, 1212.7833333333365, 1214.3333333333353, 1213.8333333333362, 1213.3833333333366, 1212.7333333333363, 1213.9833333333368, 1213.7333333333363, 1214.2833333333367, 1214.4333333333361, 1213.9333333333366, 1214.5333333333358, 1214.8833333333362, 1213.4833333333363, 1214.5833333333362, 1213.8333333333364, 1212.8833333333353, 1214.033333333336, 1213.0833333333364, 1214.0833333333362, 1213.9833333333363, 1214.483333333337, 1214.433333333336, 1214.3833333333364, 1213.533333333336, 1214.2833333333365, 1213.0333333333353, 1215.5333333333365, 1213.9333333333361, 1214.4333333333361, 1213.8333333333362, 1214.0333333333363, 1215.5333333333363, 1213.7333333333358, 1212.9833333333365, 1213.8833333333362, 1213.0333333333358, 1213.9333333333361, 1216.0333333333365, 1213.533333333336, 1214.6833333333363, 1213.5333333333358, 1213.6833333333366, 1213.9833333333363, 1214.3333333333362, 1214.4333333333361, 1215.683333333336, 1213.033333333336, 1215.1333333333364, 1212.983333333336, 1214.333333333336, 1214.383333333336, 1213.5333333333356, 1213.1333333333369, 1213.4000000000033, 1212.7333333333358, 1213.8333333333364, 1214.7333333333365, 1214.683333333336, 1214.5333333333365, 1214.8833333333362, 1214.5833333333367, 1215.0333333333363, 1214.1833333333361, 1212.9833333333358, 1214.5333333333363, 1213.9833333333356, 1213.6833333333354, 1214.283333333336, 1213.5833333333367, 1214.2333333333365, 1214.1833333333366, 1214.2333333333363, 1214.2833333333363, 1214.4833333333356, 1213.7333333333363, 1213.5833333333362, 1214.2333333333365, 1215.0833333333364, 1213.9333333333361, 1214.1333333333366, 1213.783333333336, 1213.783333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2438768045259723, "mean_inference_ms": 2.0780856000917036, "mean_action_processing_ms": 0.09137993250501203, "mean_env_wait_ms": 1.546063032445866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007050752639770508, "StateBufferConnector_ms": 0.003360748291015625, "ViewRequirementAgentConnector_ms": 0.08719325065612793}, "num_episodes": 24, "episode_return_max": 1216.0333333333365, "episode_return_min": 1212.7333333333358, "episode_return_mean": 1214.034500000003, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 515400, "num_agent_steps_trained": 515100, "num_env_steps_sampled": 515400, "num_env_steps_trained": 515100, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 238.91616026216215, "num_env_steps_trained_throughput_per_sec": 238.91616026216215, "timesteps_total": 515400, "num_env_steps_sampled_lifetime": 515400, "num_agent_steps_sampled_lifetime": 515400, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 515400, "timers": {"training_iteration_time_ms": 10244.813, "restore_workers_time_ms": 0.013, "training_step_time_ms": 620.566, "sample_time_ms": 604.775, "synch_weights_time_ms": 14.295}, "counters": {"num_env_steps_sampled": 515400, "num_env_steps_trained": 515100, "num_agent_steps_sampled": 515400, "num_agent_steps_trained": 515100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3436, "num_samples_added_to_queue": 515400}, "done": false, "training_iteration": 206, "trial_id": "27800_00000", "date": "2024-10-12_16-03-27", "timestamp": 1728745407, "time_this_iter_s": 10.054802894592285, "time_total_s": 2130.4616289138794, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a946f69e70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2130.4616289138794, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 16.785714285714285, "ram_util_percent": 69.72142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2701.42578125, "policy_loss": -1584.840087890625, "entropy": 4.800890922546387, "entropy_coeff": 0.01, "var_gnorm": 18.095626831054688, "vf_loss": 430066.875, "vf_explained_var": 0.6110013127326965}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1724.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 517350, "num_env_steps_trained": 517200, "num_agent_steps_sampled": 517350, "num_agent_steps_trained": 517200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3449, "num_samples_added_to_queue": 517200, "learner_queue": {"size_count": 1724, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 76.315, "learner_load_time_ms": 0.422, "learner_load_wait_time_ms": 1412.384, "learner_dequeue_time_ms": 10237.484}}, "env_runners": {"episode_reward_max": 1216.0333333333365, "episode_reward_min": 1212.5833333333362, "episode_reward_mean": 1214.0295000000028, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.5833333333362}, "policy_reward_max": {"default_policy": 1216.0333333333365}, "policy_reward_mean": {"default_policy": 1214.0295000000028}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2551, "num_moves_min": 0.14, "num_moves_max": 0.54, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0008, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16286366666666666, "num_slav_min": 0.16153333333333333, "num_slav_max": 0.16383333333333333, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5464048349880494, "mean_cluster_cpu_util_min": 0.5436210815407244, "mean_cluster_cpu_util_max": 0.5488480304283877, "mean_cluster_mem_util_mean": 0.3416074419831224, "mean_cluster_mem_util_min": 0.3411371308016878, "mean_cluster_mem_util_max": 0.3420748945147678, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4429549999999995, "reward_sla_mean_min": -2.4574999999999996, "reward_sla_mean_max": -2.423, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.29550000000003, "reward_sla_sum_min": -245.74999999999997, "reward_sla_sum_max": -242.29999999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5094.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1212.7833333333365, 1214.3333333333353, 1213.8333333333362, 1213.3833333333366, 1212.7333333333363, 1213.9833333333368, 1213.7333333333363, 1214.2833333333367, 1214.4333333333361, 1213.9333333333366, 1214.5333333333358, 1214.8833333333362, 1213.4833333333363, 1214.5833333333362, 1213.8333333333364, 1212.8833333333353, 1214.033333333336, 1213.0833333333364, 1214.0833333333362, 1213.9833333333363, 1214.483333333337, 1214.433333333336, 1214.3833333333364, 1213.533333333336, 1214.2833333333365, 1213.0333333333353, 1215.5333333333365, 1213.9333333333361, 1214.4333333333361, 1213.8333333333362, 1214.0333333333363, 1215.5333333333363, 1213.7333333333358, 1212.9833333333365, 1213.8833333333362, 1213.0333333333358, 1213.9333333333361, 1216.0333333333365, 1213.533333333336, 1214.6833333333363, 1213.5333333333358, 1213.6833333333366, 1213.9833333333363, 1214.3333333333362, 1214.4333333333361, 1215.683333333336, 1213.033333333336, 1215.1333333333364, 1212.983333333336, 1214.333333333336, 1214.383333333336, 1213.5333333333356, 1213.1333333333369, 1213.4000000000033, 1212.7333333333358, 1213.8333333333364, 1214.7333333333365, 1214.683333333336, 1214.5333333333365, 1214.8833333333362, 1214.5833333333367, 1215.0333333333363, 1214.1833333333361, 1212.9833333333358, 1214.5333333333363, 1213.9833333333356, 1213.6833333333354, 1214.283333333336, 1213.5833333333367, 1214.2333333333365, 1214.1833333333366, 1214.2333333333363, 1214.2833333333363, 1214.4833333333356, 1213.7333333333363, 1213.5833333333362, 1214.2333333333365, 1215.0833333333364, 1213.9333333333361, 1214.1333333333366, 1213.783333333336, 1213.783333333336, 1214.1333333333362, 1214.0333333333356, 1215.183333333336, 1214.2833333333358, 1214.2833333333356, 1215.1333333333364, 1214.2333333333363, 1213.8333333333364, 1212.9333333333363, 1212.6833333333361, 1212.5833333333362, 1213.0333333333363, 1214.5833333333362, 1214.2333333333358, 1213.2833333333363, 1214.3833333333362, 1214.0833333333367, 1214.4333333333363], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1212.7833333333365, 1214.3333333333353, 1213.8333333333362, 1213.3833333333366, 1212.7333333333363, 1213.9833333333368, 1213.7333333333363, 1214.2833333333367, 1214.4333333333361, 1213.9333333333366, 1214.5333333333358, 1214.8833333333362, 1213.4833333333363, 1214.5833333333362, 1213.8333333333364, 1212.8833333333353, 1214.033333333336, 1213.0833333333364, 1214.0833333333362, 1213.9833333333363, 1214.483333333337, 1214.433333333336, 1214.3833333333364, 1213.533333333336, 1214.2833333333365, 1213.0333333333353, 1215.5333333333365, 1213.9333333333361, 1214.4333333333361, 1213.8333333333362, 1214.0333333333363, 1215.5333333333363, 1213.7333333333358, 1212.9833333333365, 1213.8833333333362, 1213.0333333333358, 1213.9333333333361, 1216.0333333333365, 1213.533333333336, 1214.6833333333363, 1213.5333333333358, 1213.6833333333366, 1213.9833333333363, 1214.3333333333362, 1214.4333333333361, 1215.683333333336, 1213.033333333336, 1215.1333333333364, 1212.983333333336, 1214.333333333336, 1214.383333333336, 1213.5333333333356, 1213.1333333333369, 1213.4000000000033, 1212.7333333333358, 1213.8333333333364, 1214.7333333333365, 1214.683333333336, 1214.5333333333365, 1214.8833333333362, 1214.5833333333367, 1215.0333333333363, 1214.1833333333361, 1212.9833333333358, 1214.5333333333363, 1213.9833333333356, 1213.6833333333354, 1214.283333333336, 1213.5833333333367, 1214.2333333333365, 1214.1833333333366, 1214.2333333333363, 1214.2833333333363, 1214.4833333333356, 1213.7333333333363, 1213.5833333333362, 1214.2333333333365, 1215.0833333333364, 1213.9333333333361, 1214.1333333333366, 1213.783333333336, 1213.783333333336, 1214.1333333333362, 1214.0333333333356, 1215.183333333336, 1214.2833333333358, 1214.2833333333356, 1215.1333333333364, 1214.2333333333363, 1213.8333333333364, 1212.9333333333363, 1212.6833333333361, 1212.5833333333362, 1213.0333333333363, 1214.5833333333362, 1214.2333333333358, 1213.2833333333363, 1214.3833333333362, 1214.0833333333367, 1214.4333333333363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24384256867015885, "mean_inference_ms": 2.0751631189805964, "mean_action_processing_ms": 0.09135866439007341, "mean_env_wait_ms": 1.5455082490911798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007306575775146484, "StateBufferConnector_ms": 0.003538370132446289, "ViewRequirementAgentConnector_ms": 0.09163951873779297}, "num_episodes": 18, "episode_return_max": 1216.0333333333365, "episode_return_min": 1212.5833333333362, "episode_return_mean": 1214.0295000000028, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 517350, "num_agent_steps_trained": 517200, "num_env_steps_sampled": 517350, "num_env_steps_trained": 517200, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 185.46777131530868, "num_env_steps_trained_throughput_per_sec": 199.7345229549478, "timesteps_total": 517350, "num_env_steps_sampled_lifetime": 517350, "num_agent_steps_sampled_lifetime": 517350, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 517350, "timers": {"training_iteration_time_ms": 10269.102, "restore_workers_time_ms": 0.016, "training_step_time_ms": 850.123, "sample_time_ms": 832.162, "synch_weights_time_ms": 15.964}, "counters": {"num_env_steps_sampled": 517350, "num_env_steps_trained": 517200, "num_agent_steps_sampled": 517350, "num_agent_steps_trained": 517200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3449, "num_samples_added_to_queue": 517200}, "done": false, "training_iteration": 207, "trial_id": "27800_00000", "date": "2024-10-12_16-03-37", "timestamp": 1728745417, "time_this_iter_s": 10.523961067199707, "time_total_s": 2140.985589981079, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486f1300>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2140.985589981079, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 27.93333333333333, "ram_util_percent": 70.52666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2587.087890625, "policy_loss": -1421.5611572265625, "entropy": 4.860473155975342, "entropy_coeff": 0.01, "var_gnorm": 18.088348388671875, "vf_loss": 402323.0625, "vf_explained_var": 0.6282858848571777}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1731.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 519450, "num_env_steps_trained": 519300, "num_agent_steps_sampled": 519450, "num_agent_steps_trained": 519300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3463, "num_samples_added_to_queue": 519300, "learner_queue": {"size_count": 1731, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.551, "learner_load_time_ms": 0.502, "learner_load_wait_time_ms": 1464.052, "learner_dequeue_time_ms": 10431.592}}, "env_runners": {"episode_reward_max": 1216.0333333333365, "episode_reward_min": 1212.5833333333362, "episode_reward_mean": 1214.0625000000027, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.5833333333362}, "policy_reward_max": {"default_policy": 1216.0333333333365}, "policy_reward_mean": {"default_policy": 1214.0625000000027}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.25680000000000003, "num_moves_min": 0.14, "num_moves_max": 0.42, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0008, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16284166666666666, "num_slav_min": 0.16153333333333333, "num_slav_max": 0.16383333333333333, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5467447501838574, "mean_cluster_cpu_util_min": 0.5443081563706564, "mean_cluster_cpu_util_max": 0.5488480304283877, "mean_cluster_mem_util_mean": 0.3416164293248945, "mean_cluster_mem_util_min": 0.3411371308016878, "mean_cluster_mem_util_max": 0.3420748945147678, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4426249999999996, "reward_sla_mean_min": -2.4574999999999996, "reward_sla_mean_max": -2.423, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.26250000000005, "reward_sla_sum_min": -245.74999999999997, "reward_sla_sum_max": -242.29999999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4157.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1214.433333333336, 1214.3833333333364, 1213.533333333336, 1214.2833333333365, 1213.0333333333353, 1215.5333333333365, 1213.9333333333361, 1214.4333333333361, 1213.8333333333362, 1214.0333333333363, 1215.5333333333363, 1213.7333333333358, 1212.9833333333365, 1213.8833333333362, 1213.0333333333358, 1213.9333333333361, 1216.0333333333365, 1213.533333333336, 1214.6833333333363, 1213.5333333333358, 1213.6833333333366, 1213.9833333333363, 1214.3333333333362, 1214.4333333333361, 1215.683333333336, 1213.033333333336, 1215.1333333333364, 1212.983333333336, 1214.333333333336, 1214.383333333336, 1213.5333333333356, 1213.1333333333369, 1213.4000000000033, 1212.7333333333358, 1213.8333333333364, 1214.7333333333365, 1214.683333333336, 1214.5333333333365, 1214.8833333333362, 1214.5833333333367, 1215.0333333333363, 1214.1833333333361, 1212.9833333333358, 1214.5333333333363, 1213.9833333333356, 1213.6833333333354, 1214.283333333336, 1213.5833333333367, 1214.2333333333365, 1214.1833333333366, 1214.2333333333363, 1214.2833333333363, 1214.4833333333356, 1213.7333333333363, 1213.5833333333362, 1214.2333333333365, 1215.0833333333364, 1213.9333333333361, 1214.1333333333366, 1213.783333333336, 1213.783333333336, 1214.1333333333362, 1214.0333333333356, 1215.183333333336, 1214.2833333333358, 1214.2833333333356, 1215.1333333333364, 1214.2333333333363, 1213.8333333333364, 1212.9333333333363, 1212.6833333333361, 1212.5833333333362, 1213.0333333333363, 1214.5833333333362, 1214.2333333333358, 1213.2833333333363, 1214.3833333333362, 1214.0833333333367, 1214.4333333333363, 1214.2833333333363, 1213.783333333336, 1213.583333333336, 1213.9833333333363, 1213.7833333333367, 1215.8833333333362, 1213.1333333333355, 1213.633333333336, 1214.9833333333363, 1214.2333333333365, 1213.2833333333358, 1214.783333333336, 1213.333333333336, 1214.7333333333363, 1212.833333333336, 1214.1833333333363, 1213.8333333333364, 1213.6833333333361, 1215.1333333333366, 1213.6833333333368, 1213.8333333333355], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1214.433333333336, 1214.3833333333364, 1213.533333333336, 1214.2833333333365, 1213.0333333333353, 1215.5333333333365, 1213.9333333333361, 1214.4333333333361, 1213.8333333333362, 1214.0333333333363, 1215.5333333333363, 1213.7333333333358, 1212.9833333333365, 1213.8833333333362, 1213.0333333333358, 1213.9333333333361, 1216.0333333333365, 1213.533333333336, 1214.6833333333363, 1213.5333333333358, 1213.6833333333366, 1213.9833333333363, 1214.3333333333362, 1214.4333333333361, 1215.683333333336, 1213.033333333336, 1215.1333333333364, 1212.983333333336, 1214.333333333336, 1214.383333333336, 1213.5333333333356, 1213.1333333333369, 1213.4000000000033, 1212.7333333333358, 1213.8333333333364, 1214.7333333333365, 1214.683333333336, 1214.5333333333365, 1214.8833333333362, 1214.5833333333367, 1215.0333333333363, 1214.1833333333361, 1212.9833333333358, 1214.5333333333363, 1213.9833333333356, 1213.6833333333354, 1214.283333333336, 1213.5833333333367, 1214.2333333333365, 1214.1833333333366, 1214.2333333333363, 1214.2833333333363, 1214.4833333333356, 1213.7333333333363, 1213.5833333333362, 1214.2333333333365, 1215.0833333333364, 1213.9333333333361, 1214.1333333333366, 1213.783333333336, 1213.783333333336, 1214.1333333333362, 1214.0333333333356, 1215.183333333336, 1214.2833333333358, 1214.2833333333356, 1215.1333333333364, 1214.2333333333363, 1213.8333333333364, 1212.9333333333363, 1212.6833333333361, 1212.5833333333362, 1213.0333333333363, 1214.5833333333362, 1214.2333333333358, 1213.2833333333363, 1214.3833333333362, 1214.0833333333367, 1214.4333333333363, 1214.2833333333363, 1213.783333333336, 1213.583333333336, 1213.9833333333363, 1213.7833333333367, 1215.8833333333362, 1213.1333333333355, 1213.633333333336, 1214.9833333333363, 1214.2333333333365, 1213.2833333333358, 1214.783333333336, 1213.333333333336, 1214.7333333333363, 1212.833333333336, 1214.1833333333363, 1213.8333333333364, 1213.6833333333361, 1215.1333333333366, 1213.6833333333368, 1213.8333333333355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24388894721678456, "mean_inference_ms": 2.074921088621624, "mean_action_processing_ms": 0.0913724375942512, "mean_env_wait_ms": 1.5457761488198338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007308483123779297, "StateBufferConnector_ms": 0.0035462379455566406, "ViewRequirementAgentConnector_ms": 0.09244894981384277}, "num_episodes": 21, "episode_return_max": 1216.0333333333365, "episode_return_min": 1212.5833333333362, "episode_return_mean": 1214.0625000000027, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 519450, "num_agent_steps_trained": 519300, "num_env_steps_sampled": 519450, "num_env_steps_trained": 519300, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 201.2998639792033, "num_env_steps_trained_throughput_per_sec": 201.2998639792033, "timesteps_total": 519450, "num_env_steps_sampled_lifetime": 519450, "num_agent_steps_sampled_lifetime": 519450, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 519450, "timers": {"training_iteration_time_ms": 10310.753, "restore_workers_time_ms": 0.017, "training_step_time_ms": 786.232, "sample_time_ms": 765.47, "synch_weights_time_ms": 18.898}, "counters": {"num_env_steps_sampled": 519450, "num_env_steps_trained": 519300, "num_agent_steps_sampled": 519450, "num_agent_steps_trained": 519300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3463, "num_samples_added_to_queue": 519300}, "done": false, "training_iteration": 208, "trial_id": "27800_00000", "date": "2024-10-12_16-03-48", "timestamp": 1728745428, "time_this_iter_s": 10.450751304626465, "time_total_s": 2151.4363412857056, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486c00d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2151.4363412857056, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 24.186666666666664, "ram_util_percent": 72.01333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3255.3701171875, "policy_loss": -411.46453857421875, "entropy": 4.7748517990112305, "entropy_coeff": 0.01, "var_gnorm": 18.080350875854492, "vf_loss": 368115.9375, "vf_explained_var": 0.6519689559936523}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1738.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 521700, "num_env_steps_trained": 521400, "num_agent_steps_sampled": 521700, "num_agent_steps_trained": 521400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3478, "num_samples_added_to_queue": 521700, "learner_queue": {"size_count": 1738, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 84.165, "learner_load_time_ms": 0.554, "learner_load_wait_time_ms": 1371.197, "learner_dequeue_time_ms": 10536.345}}, "env_runners": {"episode_reward_max": 1215.8833333333362, "episode_reward_min": 1212.5833333333362, "episode_reward_mean": 1213.9941666666696, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.5833333333362}, "policy_reward_max": {"default_policy": 1215.8833333333362}, "policy_reward_mean": {"default_policy": 1213.9941666666696}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2655, "num_moves_min": 0.14, "num_moves_max": 0.42, "mean_accuracy_mean": 43.633206666666666, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.001, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.1628816666666667, "num_slav_min": 0.16163333333333335, "num_slav_max": 0.16383333333333333, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5470386195762089, "mean_cluster_cpu_util_min": 0.5449877619966906, "mean_cluster_cpu_util_max": 0.5488480304283877, "mean_cluster_mem_util_mean": 0.3416165981012657, "mean_cluster_mem_util_min": 0.3411371308016878, "mean_cluster_mem_util_max": 0.3420748945147678, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333166666666692, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.443225, "reward_sla_mean_min": -2.4575000000000005, "reward_sla_mean_max": -2.4245, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3166666666694, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.32249999999996, "reward_sla_sum_min": -245.75000000000003, "reward_sla_sum_max": -242.45000000000002, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3085.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1215.683333333336, 1213.033333333336, 1215.1333333333364, 1212.983333333336, 1214.333333333336, 1214.383333333336, 1213.5333333333356, 1213.1333333333369, 1213.4000000000033, 1212.7333333333358, 1213.8333333333364, 1214.7333333333365, 1214.683333333336, 1214.5333333333365, 1214.8833333333362, 1214.5833333333367, 1215.0333333333363, 1214.1833333333361, 1212.9833333333358, 1214.5333333333363, 1213.9833333333356, 1213.6833333333354, 1214.283333333336, 1213.5833333333367, 1214.2333333333365, 1214.1833333333366, 1214.2333333333363, 1214.2833333333363, 1214.4833333333356, 1213.7333333333363, 1213.5833333333362, 1214.2333333333365, 1215.0833333333364, 1213.9333333333361, 1214.1333333333366, 1213.783333333336, 1213.783333333336, 1214.1333333333362, 1214.0333333333356, 1215.183333333336, 1214.2833333333358, 1214.2833333333356, 1215.1333333333364, 1214.2333333333363, 1213.8333333333364, 1212.9333333333363, 1212.6833333333361, 1212.5833333333362, 1213.0333333333363, 1214.5833333333362, 1214.2333333333358, 1213.2833333333363, 1214.3833333333362, 1214.0833333333367, 1214.4333333333363, 1214.2833333333363, 1213.783333333336, 1213.583333333336, 1213.9833333333363, 1213.7833333333367, 1215.8833333333362, 1213.1333333333355, 1213.633333333336, 1214.9833333333363, 1214.2333333333365, 1213.2833333333358, 1214.783333333336, 1213.333333333336, 1214.7333333333363, 1212.833333333336, 1214.1833333333363, 1213.8333333333364, 1213.6833333333361, 1215.1333333333366, 1213.6833333333368, 1213.8333333333355, 1215.4333333333363, 1214.0833333333362, 1214.4833333333365, 1213.8333333333364, 1214.6333333333357, 1213.3833333333369, 1213.6333333333366, 1214.4333333333357, 1214.533333333336, 1214.0333333333358, 1213.6833333333354, 1212.5833333333367, 1214.1333333333357, 1214.633333333336, 1212.9333333333368, 1213.1333333333364, 1214.333333333336, 1212.7333333333358, 1213.050000000003, 1214.3833333333364, 1214.0333333333356, 1213.3333333333364, 1213.1333333333369, 1213.333333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1215.683333333336, 1213.033333333336, 1215.1333333333364, 1212.983333333336, 1214.333333333336, 1214.383333333336, 1213.5333333333356, 1213.1333333333369, 1213.4000000000033, 1212.7333333333358, 1213.8333333333364, 1214.7333333333365, 1214.683333333336, 1214.5333333333365, 1214.8833333333362, 1214.5833333333367, 1215.0333333333363, 1214.1833333333361, 1212.9833333333358, 1214.5333333333363, 1213.9833333333356, 1213.6833333333354, 1214.283333333336, 1213.5833333333367, 1214.2333333333365, 1214.1833333333366, 1214.2333333333363, 1214.2833333333363, 1214.4833333333356, 1213.7333333333363, 1213.5833333333362, 1214.2333333333365, 1215.0833333333364, 1213.9333333333361, 1214.1333333333366, 1213.783333333336, 1213.783333333336, 1214.1333333333362, 1214.0333333333356, 1215.183333333336, 1214.2833333333358, 1214.2833333333356, 1215.1333333333364, 1214.2333333333363, 1213.8333333333364, 1212.9333333333363, 1212.6833333333361, 1212.5833333333362, 1213.0333333333363, 1214.5833333333362, 1214.2333333333358, 1213.2833333333363, 1214.3833333333362, 1214.0833333333367, 1214.4333333333363, 1214.2833333333363, 1213.783333333336, 1213.583333333336, 1213.9833333333363, 1213.7833333333367, 1215.8833333333362, 1213.1333333333355, 1213.633333333336, 1214.9833333333363, 1214.2333333333365, 1213.2833333333358, 1214.783333333336, 1213.333333333336, 1214.7333333333363, 1212.833333333336, 1214.1833333333363, 1213.8333333333364, 1213.6833333333361, 1215.1333333333366, 1213.6833333333368, 1213.8333333333355, 1215.4333333333363, 1214.0833333333362, 1214.4833333333365, 1213.8333333333364, 1214.6333333333357, 1213.3833333333369, 1213.6333333333366, 1214.4333333333357, 1214.533333333336, 1214.0333333333358, 1213.6833333333354, 1212.5833333333367, 1214.1333333333357, 1214.633333333336, 1212.9333333333368, 1213.1333333333364, 1214.333333333336, 1212.7333333333358, 1213.050000000003, 1214.3833333333364, 1214.0333333333356, 1213.3333333333364, 1213.1333333333369, 1213.333333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2440029213872974, "mean_inference_ms": 2.0764291053401145, "mean_action_processing_ms": 0.09141307864681124, "mean_env_wait_ms": 1.546563971768706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007226705551147461, "StateBufferConnector_ms": 0.003640413284301758, "ViewRequirementAgentConnector_ms": 0.09475374221801758}, "num_episodes": 24, "episode_return_max": 1215.8833333333362, "episode_return_min": 1212.5833333333362, "episode_return_mean": 1213.9941666666696, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 521700, "num_agent_steps_trained": 521400, "num_env_steps_sampled": 521700, "num_env_steps_trained": 521400, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 219.7641501821734, "num_env_steps_trained_throughput_per_sec": 205.11320683669518, "timesteps_total": 521700, "num_env_steps_sampled_lifetime": 521700, "num_agent_steps_sampled_lifetime": 521700, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 521700, "timers": {"training_iteration_time_ms": 10271.179, "restore_workers_time_ms": 0.014, "training_step_time_ms": 722.175, "sample_time_ms": 703.31, "synch_weights_time_ms": 17.019}, "counters": {"num_env_steps_sampled": 521700, "num_env_steps_trained": 521400, "num_agent_steps_sampled": 521700, "num_agent_steps_trained": 521400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3478, "num_samples_added_to_queue": 521700}, "done": false, "training_iteration": 209, "trial_id": "27800_00000", "date": "2024-10-12_16-03-58", "timestamp": 1728745438, "time_this_iter_s": 10.251473426818848, "time_total_s": 2161.6878147125244, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d46bc0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2161.6878147125244, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 24.146666666666665, "ram_util_percent": 73.87999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3925.193603515625, "policy_loss": 61.059814453125, "entropy": 4.654130935668945, "entropy_coeff": 0.01, "var_gnorm": 18.07355308532715, "vf_loss": 387809.625, "vf_explained_var": 0.6365948915481567}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1746.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 523950, "num_env_steps_trained": 523800, "num_agent_steps_sampled": 523950, "num_agent_steps_trained": 523800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3493, "num_samples_added_to_queue": 523800, "learner_queue": {"size_count": 1746, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 79.704, "learner_load_time_ms": 0.575, "learner_load_wait_time_ms": 1368.293, "learner_dequeue_time_ms": 10702.525}}, "env_runners": {"episode_reward_max": 1215.8833333333362, "episode_reward_min": 1212.5833333333362, "episode_reward_mean": 1213.9325000000028, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1212.5833333333362}, "policy_reward_max": {"default_policy": 1215.8833333333362}, "policy_reward_mean": {"default_policy": 1213.9325000000028}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2582000000000001, "num_moves_min": 0.12, "num_moves_max": 0.42, "mean_accuracy_mean": 43.633269999999996, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0006, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16292833333333334, "num_slav_min": 0.16163333333333335, "num_slav_max": 0.16383333333333333, "cpu_conserved_cost_mean": 8.0, "cpu_conserved_cost_min": 8.0, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5471901038793896, "mean_cluster_cpu_util_min": 0.5449877619966906, "mean_cluster_cpu_util_max": 0.5488480304283877, "mean_cluster_mem_util_mean": 0.34162913502109704, "mean_cluster_mem_util_min": 0.3411983122362869, "mean_cluster_mem_util_max": 0.3420748945147678, "reward_consolidation_mean_mean": 6.25, "reward_consolidation_mean_min": 6.25, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333250000000026, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4439249999999992, "reward_sla_mean_min": -2.4575000000000005, "reward_sla_mean_max": -2.4245, "reward_consolidation_sum_mean": 625.0, "reward_consolidation_sum_min": 625.0, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3250000000029, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.39250000000007, "reward_sla_sum_min": -245.75000000000003, "reward_sla_sum_max": -242.45000000000002, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2298.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.6833333333354, 1214.283333333336, 1213.5833333333367, 1214.2333333333365, 1214.1833333333366, 1214.2333333333363, 1214.2833333333363, 1214.4833333333356, 1213.7333333333363, 1213.5833333333362, 1214.2333333333365, 1215.0833333333364, 1213.9333333333361, 1214.1333333333366, 1213.783333333336, 1213.783333333336, 1214.1333333333362, 1214.0333333333356, 1215.183333333336, 1214.2833333333358, 1214.2833333333356, 1215.1333333333364, 1214.2333333333363, 1213.8333333333364, 1212.9333333333363, 1212.6833333333361, 1212.5833333333362, 1213.0333333333363, 1214.5833333333362, 1214.2333333333358, 1213.2833333333363, 1214.3833333333362, 1214.0833333333367, 1214.4333333333363, 1214.2833333333363, 1213.783333333336, 1213.583333333336, 1213.9833333333363, 1213.7833333333367, 1215.8833333333362, 1213.1333333333355, 1213.633333333336, 1214.9833333333363, 1214.2333333333365, 1213.2833333333358, 1214.783333333336, 1213.333333333336, 1214.7333333333363, 1212.833333333336, 1214.1833333333363, 1213.8333333333364, 1213.6833333333361, 1215.1333333333366, 1213.6833333333368, 1213.8333333333355, 1215.4333333333363, 1214.0833333333362, 1214.4833333333365, 1213.8333333333364, 1214.6333333333357, 1213.3833333333369, 1213.6333333333366, 1214.4333333333357, 1214.533333333336, 1214.0333333333358, 1213.6833333333354, 1212.5833333333367, 1214.1333333333357, 1214.633333333336, 1212.9333333333368, 1213.1333333333364, 1214.333333333336, 1212.7333333333358, 1213.050000000003, 1214.3833333333364, 1214.0333333333356, 1213.3333333333364, 1213.1333333333369, 1213.333333333336, 1214.533333333336, 1213.5833333333358, 1212.9333333333366, 1214.4833333333363, 1214.2333333333365, 1213.533333333336, 1213.2833333333365, 1214.2333333333365, 1213.8833333333362, 1213.2333333333358, 1213.6333333333366, 1214.783333333336, 1213.3333333333358, 1213.833333333337, 1214.1833333333361, 1212.9333333333354, 1214.2833333333365, 1213.9333333333363, 1213.9333333333357, 1213.683333333336, 1213.683333333336], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.6833333333354, 1214.283333333336, 1213.5833333333367, 1214.2333333333365, 1214.1833333333366, 1214.2333333333363, 1214.2833333333363, 1214.4833333333356, 1213.7333333333363, 1213.5833333333362, 1214.2333333333365, 1215.0833333333364, 1213.9333333333361, 1214.1333333333366, 1213.783333333336, 1213.783333333336, 1214.1333333333362, 1214.0333333333356, 1215.183333333336, 1214.2833333333358, 1214.2833333333356, 1215.1333333333364, 1214.2333333333363, 1213.8333333333364, 1212.9333333333363, 1212.6833333333361, 1212.5833333333362, 1213.0333333333363, 1214.5833333333362, 1214.2333333333358, 1213.2833333333363, 1214.3833333333362, 1214.0833333333367, 1214.4333333333363, 1214.2833333333363, 1213.783333333336, 1213.583333333336, 1213.9833333333363, 1213.7833333333367, 1215.8833333333362, 1213.1333333333355, 1213.633333333336, 1214.9833333333363, 1214.2333333333365, 1213.2833333333358, 1214.783333333336, 1213.333333333336, 1214.7333333333363, 1212.833333333336, 1214.1833333333363, 1213.8333333333364, 1213.6833333333361, 1215.1333333333366, 1213.6833333333368, 1213.8333333333355, 1215.4333333333363, 1214.0833333333362, 1214.4833333333365, 1213.8333333333364, 1214.6333333333357, 1213.3833333333369, 1213.6333333333366, 1214.4333333333357, 1214.533333333336, 1214.0333333333358, 1213.6833333333354, 1212.5833333333367, 1214.1333333333357, 1214.633333333336, 1212.9333333333368, 1213.1333333333364, 1214.333333333336, 1212.7333333333358, 1213.050000000003, 1214.3833333333364, 1214.0333333333356, 1213.3333333333364, 1213.1333333333369, 1213.333333333336, 1214.533333333336, 1213.5833333333358, 1212.9333333333366, 1214.4833333333363, 1214.2333333333365, 1213.533333333336, 1213.2833333333365, 1214.2333333333365, 1213.8833333333362, 1213.2333333333358, 1213.6333333333366, 1214.783333333336, 1213.3333333333358, 1213.833333333337, 1214.1833333333361, 1212.9333333333354, 1214.2833333333365, 1213.9333333333363, 1213.9333333333357, 1213.683333333336, 1213.683333333336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24408463377392714, "mean_inference_ms": 2.0765223255688583, "mean_action_processing_ms": 0.09143621658427285, "mean_env_wait_ms": 1.5470397693859943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007260560989379883, "StateBufferConnector_ms": 0.003821849822998047, "ViewRequirementAgentConnector_ms": 0.09788107872009277}, "num_episodes": 21, "episode_return_max": 1215.8833333333362, "episode_return_min": 1212.5833333333362, "episode_return_mean": 1213.9325000000028, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 523950, "num_agent_steps_trained": 523800, "num_env_steps_sampled": 523950, "num_env_steps_trained": 523800, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 219.99672237617006, "num_env_steps_trained_throughput_per_sec": 234.66317053458138, "timesteps_total": 523950, "num_env_steps_sampled_lifetime": 523950, "num_agent_steps_sampled_lifetime": 523950, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 523950, "timers": {"training_iteration_time_ms": 10246.721, "restore_workers_time_ms": 0.014, "training_step_time_ms": 659.433, "sample_time_ms": 641.646, "synch_weights_time_ms": 15.917}, "counters": {"num_env_steps_sampled": 523950, "num_env_steps_trained": 523800, "num_agent_steps_sampled": 523950, "num_agent_steps_trained": 523800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3493, "num_samples_added_to_queue": 523800}, "done": false, "training_iteration": 210, "trial_id": "27800_00000", "date": "2024-10-12_16-04-08", "timestamp": 1728745448, "time_this_iter_s": 10.251715421676636, "time_total_s": 2171.939530134201, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a9486c2620>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2171.939530134201, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 22.32857142857143, "ram_util_percent": 73.88571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3814.61572265625, "policy_loss": -80.53079223632812, "entropy": 4.625728607177734, "entropy_coeff": 0.01, "var_gnorm": 18.082618713378906, "vf_loss": 390902.375, "vf_explained_var": 0.6349055171012878}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1754.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 526500, "num_env_steps_trained": 526200, "num_agent_steps_sampled": 526500, "num_agent_steps_trained": 526200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3510, "num_samples_added_to_queue": 526500, "learner_queue": {"size_count": 1754, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.158, "learner_load_time_ms": 0.563, "learner_load_wait_time_ms": 1204.114, "learner_dequeue_time_ms": 10750.687}}, "env_runners": {"episode_reward_max": 1215.8833333333362, "episode_reward_min": 1210.4666666666694, "episode_reward_mean": 1213.9068333333364, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1210.4666666666694}, "policy_reward_max": {"default_policy": 1215.8833333333362}, "policy_reward_mean": {"default_policy": 1213.9068333333364}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.23690000000000008, "num_moves_min": 0.04, "num_moves_max": 0.42, "mean_accuracy_mean": 43.633206666666666, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0004, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.16292600000000002, "num_slav_min": 0.16163333333333335, "num_slav_max": 0.16383333333333333, "cpu_conserved_cost_mean": 7.9996, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5472422011169333, "mean_cluster_cpu_util_min": 0.5449877619966906, "mean_cluster_cpu_util_max": 0.5488480304283877, "mean_cluster_mem_util_mean": 0.34163904931434597, "mean_cluster_mem_util_min": 0.3409038765822785, "mean_cluster_mem_util_max": 0.3421128691983121, "reward_consolidation_mean_mean": 6.249791666666668, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.333166666666692, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4438899999999997, "reward_sla_mean_min": -2.4575000000000005, "reward_sla_mean_max": -2.4245, "reward_consolidation_sum_mean": 624.9791666666667, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.3166666666694, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.38899999999998, "reward_sla_sum_min": -245.75000000000003, "reward_sla_sum_max": -242.45000000000002, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2273.0, "global_timestep_min": 300, "global_timestep_max": 3900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.0333333333363, 1214.5833333333362, 1214.2333333333358, 1213.2833333333363, 1214.3833333333362, 1214.0833333333367, 1214.4333333333363, 1214.2833333333363, 1213.783333333336, 1213.583333333336, 1213.9833333333363, 1213.7833333333367, 1215.8833333333362, 1213.1333333333355, 1213.633333333336, 1214.9833333333363, 1214.2333333333365, 1213.2833333333358, 1214.783333333336, 1213.333333333336, 1214.7333333333363, 1212.833333333336, 1214.1833333333363, 1213.8333333333364, 1213.6833333333361, 1215.1333333333366, 1213.6833333333368, 1213.8333333333355, 1215.4333333333363, 1214.0833333333362, 1214.4833333333365, 1213.8333333333364, 1214.6333333333357, 1213.3833333333369, 1213.6333333333366, 1214.4333333333357, 1214.533333333336, 1214.0333333333358, 1213.6833333333354, 1212.5833333333367, 1214.1333333333357, 1214.633333333336, 1212.9333333333368, 1213.1333333333364, 1214.333333333336, 1212.7333333333358, 1213.050000000003, 1214.3833333333364, 1214.0333333333356, 1213.3333333333364, 1213.1333333333369, 1213.333333333336, 1214.533333333336, 1213.5833333333358, 1212.9333333333366, 1214.4833333333363, 1214.2333333333365, 1213.533333333336, 1213.2833333333365, 1214.2333333333365, 1213.8833333333362, 1213.2333333333358, 1213.6333333333366, 1214.783333333336, 1213.3333333333358, 1213.833333333337, 1214.1833333333361, 1212.9333333333354, 1214.2833333333365, 1213.9333333333363, 1213.9333333333357, 1213.683333333336, 1213.683333333336, 1214.133333333336, 1215.1333333333362, 1214.2833333333365, 1213.7333333333358, 1213.4833333333368, 1213.9333333333366, 1212.7833333333365, 1214.0833333333367, 1214.733333333336, 1213.433333333336, 1215.3333333333362, 1213.6833333333368, 1215.0833333333358, 1210.4666666666694, 1215.1833333333361, 1212.9333333333363, 1213.4833333333358, 1213.3333333333358, 1213.8333333333364, 1214.2333333333365, 1214.0333333333358, 1214.183333333336, 1214.183333333336, 1214.7833333333363, 1214.5833333333367, 1213.2833333333365, 1213.6333333333364], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.0333333333363, 1214.5833333333362, 1214.2333333333358, 1213.2833333333363, 1214.3833333333362, 1214.0833333333367, 1214.4333333333363, 1214.2833333333363, 1213.783333333336, 1213.583333333336, 1213.9833333333363, 1213.7833333333367, 1215.8833333333362, 1213.1333333333355, 1213.633333333336, 1214.9833333333363, 1214.2333333333365, 1213.2833333333358, 1214.783333333336, 1213.333333333336, 1214.7333333333363, 1212.833333333336, 1214.1833333333363, 1213.8333333333364, 1213.6833333333361, 1215.1333333333366, 1213.6833333333368, 1213.8333333333355, 1215.4333333333363, 1214.0833333333362, 1214.4833333333365, 1213.8333333333364, 1214.6333333333357, 1213.3833333333369, 1213.6333333333366, 1214.4333333333357, 1214.533333333336, 1214.0333333333358, 1213.6833333333354, 1212.5833333333367, 1214.1333333333357, 1214.633333333336, 1212.9333333333368, 1213.1333333333364, 1214.333333333336, 1212.7333333333358, 1213.050000000003, 1214.3833333333364, 1214.0333333333356, 1213.3333333333364, 1213.1333333333369, 1213.333333333336, 1214.533333333336, 1213.5833333333358, 1212.9333333333366, 1214.4833333333363, 1214.2333333333365, 1213.533333333336, 1213.2833333333365, 1214.2333333333365, 1213.8833333333362, 1213.2333333333358, 1213.6333333333366, 1214.783333333336, 1213.3333333333358, 1213.833333333337, 1214.1833333333361, 1212.9333333333354, 1214.2833333333365, 1213.9333333333363, 1213.9333333333357, 1213.683333333336, 1213.683333333336, 1214.133333333336, 1215.1333333333362, 1214.2833333333365, 1213.7333333333358, 1213.4833333333368, 1213.9333333333366, 1212.7833333333365, 1214.0833333333367, 1214.733333333336, 1213.433333333336, 1215.3333333333362, 1213.6833333333368, 1215.0833333333358, 1210.4666666666694, 1215.1833333333361, 1212.9333333333363, 1213.4833333333358, 1213.3333333333358, 1213.8333333333364, 1214.2333333333365, 1214.0333333333358, 1214.183333333336, 1214.183333333336, 1214.7833333333363, 1214.5833333333367, 1213.2833333333365, 1213.6333333333364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24431998798600715, "mean_inference_ms": 2.082582981495891, "mean_action_processing_ms": 0.09153101192532478, "mean_env_wait_ms": 1.5488979870374942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007116079330444336, "StateBufferConnector_ms": 0.0037603378295898438, "ViewRequirementAgentConnector_ms": 0.09558963775634766}, "num_episodes": 27, "episode_return_max": 1215.8833333333362, "episode_return_min": 1210.4666666666694, "episode_return_mean": 1213.9068333333364, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 526500, "num_agent_steps_trained": 526200, "num_env_steps_sampled": 526500, "num_env_steps_trained": 526200, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 241.43234736397386, "num_env_steps_trained_throughput_per_sec": 227.23044457785775, "timesteps_total": 526500, "num_env_steps_sampled_lifetime": 526500, "num_agent_steps_sampled_lifetime": 526500, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 526500, "timers": {"training_iteration_time_ms": 10294.588, "restore_workers_time_ms": 0.011, "training_step_time_ms": 602.837, "sample_time_ms": 587.654, "synch_weights_time_ms": 13.651}, "counters": {"num_env_steps_sampled": 526500, "num_env_steps_trained": 526200, "num_agent_steps_sampled": 526500, "num_agent_steps_trained": 526200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3510, "num_samples_added_to_queue": 526500}, "done": false, "training_iteration": 211, "trial_id": "27800_00000", "date": "2024-10-12_16-04-19", "timestamp": 1728745459, "time_this_iter_s": 10.581622838973999, "time_total_s": 2182.521152973175, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948b473d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2182.521152973175, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 16.975, "ram_util_percent": 72.91874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1846.4361572265625, "policy_loss": -1847.329345703125, "entropy": 4.819718837738037, "entropy_coeff": 0.01, "var_gnorm": 18.092615127563477, "vf_loss": 370822.46875, "vf_explained_var": 0.6416760683059692}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1763.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 529050, "num_env_steps_trained": 528900, "num_agent_steps_sampled": 529050, "num_agent_steps_trained": 528900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3527, "num_samples_added_to_queue": 528900, "learner_queue": {"size_count": 1763, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.458, "learner_load_time_ms": 0.526, "learner_load_wait_time_ms": 1152.237, "learner_dequeue_time_ms": 10678.516}}, "env_runners": {"episode_reward_max": 1215.4333333333363, "episode_reward_min": 1210.4666666666694, "episode_reward_mean": 1213.8986666666694, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 1210.4666666666694}, "policy_reward_max": {"default_policy": 1215.4333333333363}, "policy_reward_mean": {"default_policy": 1213.8986666666694}, "custom_metrics": {"num_consolidated_mean": 2.9998, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.21940000000000004, "num_moves_min": 0.04, "num_moves_max": 0.42, "mean_accuracy_mean": 43.63314333333334, "mean_accuracy_min": 43.62700000000001, "mean_accuracy_max": 43.63333333333334, "num_model_switches_mean": 0.0006, "num_model_switches_min": 0.0, "num_model_switches_max": 0.02, "num_slav_mean": 0.162912, "num_slav_min": 0.16193333333333332, "num_slav_max": 0.16383333333333333, "cpu_conserved_cost_mean": 7.999200000000001, "cpu_conserved_cost_min": 7.96, "cpu_conserved_cost_max": 8.0, "mean_cluster_cpu_util_mean": 0.5472371474535761, "mean_cluster_cpu_util_min": 0.5454688821474535, "mean_cluster_cpu_util_max": 0.548836366979224, "mean_cluster_mem_util_mean": 0.3416285825421941, "mean_cluster_mem_util_min": 0.3409038765822785, "mean_cluster_mem_util_max": 0.3421128691983121, "reward_consolidation_mean_mean": 6.249583333333333, "reward_consolidation_mean_min": 6.229166666666666, "reward_consolidation_mean_max": 6.25, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 8.33308333333336, "reward_accuracy_mean_min": 8.325000000000028, "reward_accuracy_mean_max": 8.33333333333336, "reward_sla_mean_mean": -2.4436799999999996, "reward_sla_mean_min": -2.4575000000000005, "reward_sla_mean_max": -2.4290000000000003, "reward_consolidation_sum_mean": 624.9583333333334, "reward_consolidation_sum_min": 622.9166666666666, "reward_consolidation_sum_max": 625.0, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 833.308333333336, "reward_accuracy_sum_min": 832.5000000000027, "reward_accuracy_sum_max": 833.3333333333361, "reward_sla_sum_mean": -244.368, "reward_sla_sum_min": -245.75000000000003, "reward_sla_sum_max": -242.9, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3078.0, "global_timestep_min": 1200, "global_timestep_max": 4700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [1213.6833333333361, 1215.1333333333366, 1213.6833333333368, 1213.8333333333355, 1215.4333333333363, 1214.0833333333362, 1214.4833333333365, 1213.8333333333364, 1214.6333333333357, 1213.3833333333369, 1213.6333333333366, 1214.4333333333357, 1214.533333333336, 1214.0333333333358, 1213.6833333333354, 1212.5833333333367, 1214.1333333333357, 1214.633333333336, 1212.9333333333368, 1213.1333333333364, 1214.333333333336, 1212.7333333333358, 1213.050000000003, 1214.3833333333364, 1214.0333333333356, 1213.3333333333364, 1213.1333333333369, 1213.333333333336, 1214.533333333336, 1213.5833333333358, 1212.9333333333366, 1214.4833333333363, 1214.2333333333365, 1213.533333333336, 1213.2833333333365, 1214.2333333333365, 1213.8833333333362, 1213.2333333333358, 1213.6333333333366, 1214.783333333336, 1213.3333333333358, 1213.833333333337, 1214.1833333333361, 1212.9333333333354, 1214.2833333333365, 1213.9333333333363, 1213.9333333333357, 1213.683333333336, 1213.683333333336, 1214.133333333336, 1215.1333333333362, 1214.2833333333365, 1213.7333333333358, 1213.4833333333368, 1213.9333333333366, 1212.7833333333365, 1214.0833333333367, 1214.733333333336, 1213.433333333336, 1215.3333333333362, 1213.6833333333368, 1215.0833333333358, 1210.4666666666694, 1215.1833333333361, 1212.9333333333363, 1213.4833333333358, 1213.3333333333358, 1213.8333333333364, 1214.2333333333365, 1214.0333333333358, 1214.183333333336, 1214.183333333336, 1214.7833333333363, 1214.5833333333367, 1213.2833333333365, 1213.6333333333364, 1214.2333333333363, 1214.4333333333361, 1213.5833333333362, 1213.4333333333363, 1214.933333333336, 1214.5333333333358, 1214.5833333333362, 1213.9333333333366, 1214.833333333336, 1213.8833333333357, 1213.9833333333358, 1214.1833333333366, 1214.7333333333368, 1214.3333333333364, 1214.2833333333358, 1213.4833333333356, 1212.683333333336, 1213.4833333333365, 1213.333333333336, 1214.2833333333358, 1212.1166666666693, 1214.4333333333366, 1213.8833333333369, 1213.8833333333366], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [1213.6833333333361, 1215.1333333333366, 1213.6833333333368, 1213.8333333333355, 1215.4333333333363, 1214.0833333333362, 1214.4833333333365, 1213.8333333333364, 1214.6333333333357, 1213.3833333333369, 1213.6333333333366, 1214.4333333333357, 1214.533333333336, 1214.0333333333358, 1213.6833333333354, 1212.5833333333367, 1214.1333333333357, 1214.633333333336, 1212.9333333333368, 1213.1333333333364, 1214.333333333336, 1212.7333333333358, 1213.050000000003, 1214.3833333333364, 1214.0333333333356, 1213.3333333333364, 1213.1333333333369, 1213.333333333336, 1214.533333333336, 1213.5833333333358, 1212.9333333333366, 1214.4833333333363, 1214.2333333333365, 1213.533333333336, 1213.2833333333365, 1214.2333333333365, 1213.8833333333362, 1213.2333333333358, 1213.6333333333366, 1214.783333333336, 1213.3333333333358, 1213.833333333337, 1214.1833333333361, 1212.9333333333354, 1214.2833333333365, 1213.9333333333363, 1213.9333333333357, 1213.683333333336, 1213.683333333336, 1214.133333333336, 1215.1333333333362, 1214.2833333333365, 1213.7333333333358, 1213.4833333333368, 1213.9333333333366, 1212.7833333333365, 1214.0833333333367, 1214.733333333336, 1213.433333333336, 1215.3333333333362, 1213.6833333333368, 1215.0833333333358, 1210.4666666666694, 1215.1833333333361, 1212.9333333333363, 1213.4833333333358, 1213.3333333333358, 1213.8333333333364, 1214.2333333333365, 1214.0333333333358, 1214.183333333336, 1214.183333333336, 1214.7833333333363, 1214.5833333333367, 1213.2833333333365, 1213.6333333333364, 1214.2333333333363, 1214.4333333333361, 1213.5833333333362, 1213.4333333333363, 1214.933333333336, 1214.5333333333358, 1214.5833333333362, 1213.9333333333366, 1214.833333333336, 1213.8833333333357, 1213.9833333333358, 1214.1833333333366, 1214.7333333333368, 1214.3333333333364, 1214.2833333333358, 1213.4833333333356, 1212.683333333336, 1213.4833333333365, 1213.333333333336, 1214.2833333333358, 1212.1166666666693, 1214.4333333333366, 1213.8833333333369, 1213.8833333333366]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24441916070996028, "mean_inference_ms": 2.084948916875035, "mean_action_processing_ms": 0.09156904789715468, "mean_env_wait_ms": 1.549701245451468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067882537841796875, "StateBufferConnector_ms": 0.0036046504974365234, "ViewRequirementAgentConnector_ms": 0.09158921241760254}, "num_episodes": 24, "episode_return_max": 1215.4333333333363, "episode_return_min": 1210.4666666666694, "episode_return_mean": 1213.8986666666694, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 529050, "num_agent_steps_trained": 528900, "num_env_steps_sampled": 529050, "num_env_steps_trained": 528900, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 245.62362583476457, "num_env_steps_trained_throughput_per_sec": 260.0720744132801, "timesteps_total": 529050, "num_env_steps_sampled_lifetime": 529050, "num_agent_steps_sampled_lifetime": 529050, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 529050, "timers": {"training_iteration_time_ms": 10276.412, "restore_workers_time_ms": 0.015, "training_step_time_ms": 601.188, "sample_time_ms": 585.561, "synch_weights_time_ms": 14.118}, "counters": {"num_env_steps_sampled": 529050, "num_env_steps_trained": 528900, "num_agent_steps_sampled": 529050, "num_agent_steps_trained": 528900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3527, "num_samples_added_to_queue": 528900}, "done": false, "training_iteration": 212, "trial_id": "27800_00000", "date": "2024-10-12_16-04-29", "timestamp": 1728745469, "time_this_iter_s": 10.400053262710571, "time_total_s": 2192.9212062358856, "pid": 10850, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -1.5, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x74a948d45a20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x74a942149c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2192.9212062358856, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 16.478571428571424, "ram_util_percent": 72.11428571428573}}
