{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -221382.890625, "policy_loss": -221418.453125, "entropy": 29.818687438964844, "entropy_coeff": 0.01, "var_gnorm": 16.000770568847656, "vf_loss": 125020.890625, "vf_explained_var": 0.000522315502166748}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 3000, "num_env_steps_trained": 2700, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 2700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 20, "num_samples_added_to_queue": 3000, "learner_queue": {"size_count": 9, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 43.671, "learner_load_time_ms": 0.135, "learner_load_wait_time_ms": 967.639, "learner_dequeue_time_ms": 4496.485}}, "env_runners": {"episode_reward_max": -203.9294444444443, "episode_reward_min": -252.51666666666662, "episode_reward_mean": -225.91453703703695, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 3000, "policy_reward_min": {"default_policy": -252.51666666666662}, "policy_reward_max": {"default_policy": -203.9294444444443}, "policy_reward_mean": {"default_policy": -225.91453703703695}, "custom_metrics": {"num_consolidated_mean": 0.6853333333333332, "num_consolidated_min": 0.54, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0610000000000002, "num_overloaded_min": 0.93, "num_overloaded_max": 1.19, "num_moves_mean": 9.975999999999999, "num_moves_min": 9.7, "num_moves_max": 10.25, "mean_accuracy_mean": 41.0772, "mean_accuracy_min": 40.84033333333333, "mean_accuracy_max": 41.30266666666667, "num_model_switches_mean": 6.040333333333335, "num_model_switches_min": 5.65, "num_model_switches_max": 6.38, "num_slav_mean": 0.16037166666666666, "num_slav_min": 0.14303333333333332, "num_slav_max": 0.18338333333333331, "mean_cluster_cpu_util_mean": 0.5722163743763855, "mean_cluster_cpu_util_min": 0.5537982262292958, "mean_cluster_cpu_util_max": 0.5972056518623412, "mean_cluster_mem_util_mean": 0.3669973756422401, "mean_cluster_mem_util_min": 0.3573650623223973, "mean_cluster_mem_util_max": 0.3771277889003703, "reward_consolidation_mean_mean": 0.15185185185185182, "reward_consolidation_mean_min": 0.05555555555555555, "reward_consolidation_mean_max": 0.24999999999999997, "reward_illegal_mean_mean": -1.768333333333333, "reward_illegal_mean_min": -1.9833333333333334, "reward_illegal_mean_max": -1.5499999999999998, "reward_accuracy_mean_mean": 0.38594722222222216, "reward_accuracy_mean_min": 0.24375, "reward_accuracy_mean_max": 0.5415833333333334, "reward_sla_mean_mean": -1.0286111111111111, "reward_sla_mean_min": -1.58, "reward_sla_mean_max": -0.6238888888888888, "reward_consolidation_sum_mean": 15.185185185185183, "reward_consolidation_sum_min": 5.555555555555555, "reward_consolidation_sum_max": 24.999999999999996, "reward_illegal_sum_mean": -176.83333333333334, "reward_illegal_sum_min": -198.33333333333334, "reward_illegal_sum_max": -154.99999999999997, "reward_accuracy_sum_mean": 38.59472222222223, "reward_accuracy_sum_min": 24.375, "reward_accuracy_sum_max": 54.158333333333346, "reward_sla_sum_mean": -102.86111111111111, "reward_sla_sum_min": -158.0, "reward_sla_sum_max": -62.388888888888886, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 550.0, "global_timestep_min": 100, "global_timestep_max": 1000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-234.92666666666653, -208.25722222222217, -229.90500000000003, -227.0972222222221, -252.51666666666662, -205.97888888888872, -221.82722222222222, -206.52777777777771, -224.6055555555555, -203.9294444444443, -233.16277777777762, -223.00833333333327, -222.9027777777776, -251.89722222222213, -228.57888888888874, -233.03055555555554, -214.95555555555552, -230.85944444444428, -227.8272222222222, -225.75833333333327, -243.4599999999998, -220.87944444444437, -237.66222222222223, -229.11222222222213, -212.01499999999993, -231.13055555555547, -223.39166666666665, -223.086111111111, -227.27833333333328, -221.86777777777758], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-234.92666666666653, -208.25722222222217, -229.90500000000003, -227.0972222222221, -252.51666666666662, -205.97888888888872, -221.82722222222222, -206.52777777777771, -224.6055555555555, -203.9294444444443, -233.16277777777762, -223.00833333333327, -222.9027777777776, -251.89722222222213, -228.57888888888874, -233.03055555555554, -214.95555555555552, -230.85944444444428, -227.8272222222222, -225.75833333333327, -243.4599999999998, -220.87944444444437, -237.66222222222223, -229.11222222222213, -212.01499999999993, -231.13055555555547, -223.39166666666665, -223.086111111111, -227.27833333333328, -221.86777777777758]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18854995509048242, "mean_inference_ms": 1.8008102228988467, "mean_action_processing_ms": 0.0723507100250417, "mean_env_wait_ms": 1.1731804191292106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005921522776285808, "StateBufferConnector_ms": 0.002693335215250651, "ViewRequirementAgentConnector_ms": 0.05892594655354818}, "num_episodes": 30, "episode_return_max": -203.9294444444443, "episode_return_min": -252.51666666666662, "episode_return_mean": -225.91453703703695, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 2700, "num_env_steps_sampled": 3000, "num_env_steps_trained": 2700, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 297.70135705497177, "num_env_steps_trained_throughput_per_sec": 267.9312213494746, "timesteps_total": 3000, "num_env_steps_sampled_lifetime": 3000, "num_agent_steps_sampled_lifetime": 3000, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 3000, "timers": {"training_iteration_time_ms": 10077.22, "restore_workers_time_ms": 0.012, "training_step_time_ms": 536.014, "sample_time_ms": 522.007, "synch_weights_time_ms": 12.695}, "counters": {"num_env_steps_sampled": 3000, "num_env_steps_trained": 2700, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 2700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 20, "num_samples_added_to_queue": 3000}, "done": false, "training_iteration": 1, "trial_id": "0313d_00000", "date": "2024-10-10_21-41-34", "timestamp": 1728592894, "time_this_iter_s": 10.083399057388306, "time_total_s": 10.083399057388306, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42fa36d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10.083399057388306, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 12.973333333333333, "ram_util_percent": 50.22666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -225754.453125, "policy_loss": -225796.453125, "entropy": 29.81850242614746, "entropy_coeff": 0.01, "var_gnorm": 16.000701904296875, "vf_loss": 131458.890625, "vf_explained_var": 0.00109177827835083}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 6150, "num_env_steps_trained": 6000, "num_agent_steps_sampled": 6150, "num_agent_steps_trained": 6000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 41, "num_samples_added_to_queue": 6000, "learner_queue": {"size_count": 20, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 52.217, "learner_load_time_ms": 0.23, "learner_load_wait_time_ms": 905.786, "learner_dequeue_time_ms": 5642.42}}, "env_runners": {"episode_reward_max": -186.82166666666663, "episode_reward_min": -253.46055555555552, "episode_reward_mean": -220.72661111111103, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 6000, "policy_reward_min": {"default_policy": -253.46055555555552}, "policy_reward_max": {"default_policy": -186.82166666666663}, "policy_reward_mean": {"default_policy": -220.72661111111103}, "custom_metrics": {"num_consolidated_mean": 0.6845000000000001, "num_consolidated_min": 0.54, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.051, "num_overloaded_min": 0.92, "num_overloaded_max": 1.2, "num_moves_mean": 9.989166666666668, "num_moves_min": 9.7, "num_moves_max": 10.32, "mean_accuracy_mean": 41.087650000000004, "mean_accuracy_min": 40.79599999999999, "mean_accuracy_max": 41.37233333333334, "num_model_switches_mean": 6.023, "num_model_switches_min": 5.65, "num_model_switches_max": 6.38, "num_slav_mean": 0.16034361111111112, "num_slav_min": 0.13853333333333334, "num_slav_max": 0.18338333333333331, "mean_cluster_cpu_util_mean": 0.5712141964560586, "mean_cluster_cpu_util_min": 0.5537982262292958, "mean_cluster_cpu_util_max": 0.5972056518623412, "mean_cluster_mem_util_mean": 0.36614686238841526, "mean_cluster_mem_util_min": 0.3573650623223973, "mean_cluster_mem_util_max": 0.3771277889003703, "reward_consolidation_mean_mean": 0.16365740740740742, "reward_consolidation_mean_min": 0.05555555555555555, "reward_consolidation_mean_max": 0.3055555555555555, "reward_illegal_mean_mean": -1.751666666666666, "reward_illegal_mean_min": -1.9999999999999998, "reward_illegal_mean_max": -1.5333333333333332, "reward_accuracy_mean_mean": 0.3921227777777778, "reward_accuracy_mean_min": 0.24375, "reward_accuracy_mean_max": 0.5475666666666666, "reward_sla_mean_mean": -1.0113796296296296, "reward_sla_mean_min": -1.58, "reward_sla_mean_max": -0.6238888888888888, "reward_consolidation_sum_mean": 16.36574074074074, "reward_consolidation_sum_min": 5.555555555555555, "reward_consolidation_sum_max": 30.555555555555554, "reward_illegal_sum_mean": -175.16666666666663, "reward_illegal_sum_min": -199.99999999999997, "reward_illegal_sum_max": -153.33333333333331, "reward_accuracy_sum_mean": 39.21227777777779, "reward_accuracy_sum_min": 24.375, "reward_accuracy_sum_max": 54.75666666666666, "reward_sla_sum_mean": -101.13796296296297, "reward_sla_sum_min": -158.0, "reward_sla_sum_max": -62.388888888888886, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1050.0, "global_timestep_min": 100, "global_timestep_max": 2000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-234.92666666666653, -208.25722222222217, -229.90500000000003, -227.0972222222221, -252.51666666666662, -205.97888888888872, -221.82722222222222, -206.52777777777771, -224.6055555555555, -203.9294444444443, -233.16277777777762, -223.00833333333327, -222.9027777777776, -251.89722222222213, -228.57888888888874, -233.03055555555554, -214.95555555555552, -230.85944444444428, -227.8272222222222, -225.75833333333327, -243.4599999999998, -220.87944444444437, -237.66222222222223, -229.11222222222213, -212.01499999999993, -231.13055555555547, -223.39166666666665, -223.086111111111, -227.27833333333328, -221.86777777777758, -186.82166666666663, -193.57722222222208, -210.63777777777767, -218.96777777777777, -228.5133333333332, -234.45111111111112, -242.6966666666666, -209.09666666666647, -218.4688888888888, -232.1588888888888, -220.08722222222212, -200.89333333333335, -215.44999999999996, -196.04277777777773, -211.0344444444444, -232.46444444444433, -203.53277777777754, -239.3255555555555, -218.94722222222222, -241.1222222222222, -253.46055555555552, -212.62888888888872, -215.10666666666657, -204.1033333333333, -196.3266666666667, -193.6444444444444, -208.6999999999999, -208.29055555555541, -200.9655555555554, -218.6438888888887], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-234.92666666666653, -208.25722222222217, -229.90500000000003, -227.0972222222221, -252.51666666666662, -205.97888888888872, -221.82722222222222, -206.52777777777771, -224.6055555555555, -203.9294444444443, -233.16277777777762, -223.00833333333327, -222.9027777777776, -251.89722222222213, -228.57888888888874, -233.03055555555554, -214.95555555555552, -230.85944444444428, -227.8272222222222, -225.75833333333327, -243.4599999999998, -220.87944444444437, -237.66222222222223, -229.11222222222213, -212.01499999999993, -231.13055555555547, -223.39166666666665, -223.086111111111, -227.27833333333328, -221.86777777777758, -186.82166666666663, -193.57722222222208, -210.63777777777767, -218.96777777777777, -228.5133333333332, -234.45111111111112, -242.6966666666666, -209.09666666666647, -218.4688888888888, -232.1588888888888, -220.08722222222212, -200.89333333333335, -215.44999999999996, -196.04277777777773, -211.0344444444444, -232.46444444444433, -203.53277777777754, -239.3255555555555, -218.94722222222222, -241.1222222222222, -253.46055555555552, -212.62888888888872, -215.10666666666657, -204.1033333333333, -196.3266666666667, -193.6444444444444, -208.6999999999999, -208.29055555555541, -200.9655555555554, -218.6438888888887]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18599456230243064, "mean_inference_ms": 1.7803519986810055, "mean_action_processing_ms": 0.0714255012469225, "mean_env_wait_ms": 1.1599829399724688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048796335856119795, "StateBufferConnector_ms": 0.002668301264444987, "ViewRequirementAgentConnector_ms": 0.059631665547688804}, "num_episodes": 30, "episode_return_max": -186.82166666666663, "episode_return_min": -253.46055555555552, "episode_return_mean": -220.72661111111103, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6150, "num_agent_steps_trained": 6000, "num_env_steps_sampled": 6150, "num_env_steps_trained": 6000, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 310.8216854912307, "num_env_steps_trained_throughput_per_sec": 325.6227181336702, "timesteps_total": 6150, "num_env_steps_sampled_lifetime": 6150, "num_agent_steps_sampled_lifetime": 6150, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 6150, "timers": {"training_iteration_time_ms": 10105.844, "restore_workers_time_ms": 0.011, "training_step_time_ms": 477.172, "sample_time_ms": 464.532, "synch_weights_time_ms": 11.459}, "counters": {"num_env_steps_sampled": 6150, "num_env_steps_trained": 6000, "num_agent_steps_sampled": 6150, "num_agent_steps_trained": 6000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 41, "num_samples_added_to_queue": 6000}, "done": false, "training_iteration": 2, "trial_id": "0313d_00000", "date": "2024-10-10_21-41-44", "timestamp": 1728592904, "time_this_iter_s": 10.152762174606323, "time_total_s": 20.23616123199463, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d8bd60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20.23616123199463, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 11.607142857142856, "ram_util_percent": 51.65714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -201269.140625, "policy_loss": -201286.5625, "entropy": 29.818307876586914, "entropy_coeff": 0.01, "var_gnorm": 16.00141143798828, "vf_loss": 106869.765625, "vf_explained_var": 0.00173109769821167}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 9450, "num_env_steps_trained": 9300, "num_agent_steps_sampled": 9450, "num_agent_steps_trained": 9300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 63, "num_samples_added_to_queue": 9300, "learner_queue": {"size_count": 31, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.251, "learner_load_time_ms": 0.262, "learner_load_wait_time_ms": 897.716, "learner_dequeue_time_ms": 6146.819}}, "env_runners": {"episode_reward_max": -186.82166666666663, "episode_reward_min": -269.15611111111093, "episode_reward_mean": -222.5492951015531, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 9300, "policy_reward_min": {"default_policy": -269.15611111111093}, "policy_reward_max": {"default_policy": -186.82166666666663}, "policy_reward_mean": {"default_policy": -222.5492951015531}, "custom_metrics": {"num_consolidated_mean": 0.678709677419355, "num_consolidated_min": 0.53, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.050215053763441, "num_overloaded_min": 0.92, "num_overloaded_max": 1.2, "num_moves_mean": 9.986881720430105, "num_moves_min": 9.7, "num_moves_max": 10.33, "mean_accuracy_mean": 41.09148745519713, "mean_accuracy_min": 40.79599999999999, "mean_accuracy_max": 41.37233333333334, "num_model_switches_mean": 5.9970967741935475, "num_model_switches_min": 5.62, "num_model_switches_max": 6.38, "num_slav_mean": 0.1607105734767025, "num_slav_min": 0.13853333333333334, "num_slav_max": 0.18338333333333331, "mean_cluster_cpu_util_mean": 0.5712486163402611, "mean_cluster_cpu_util_min": 0.5537982262292958, "mean_cluster_cpu_util_max": 0.5972056518623412, "mean_cluster_mem_util_mean": 0.3661776494011469, "mean_cluster_mem_util_min": 0.3573650623223973, "mean_cluster_mem_util_max": 0.3771277889003703, "reward_consolidation_mean_mean": 0.1651732377538829, "reward_consolidation_mean_min": 0.05555555555555555, "reward_consolidation_mean_max": 0.3055555555555555, "reward_illegal_mean_mean": -1.750358422939068, "reward_illegal_mean_min": -1.9999999999999998, "reward_illegal_mean_max": -1.5333333333333332, "reward_accuracy_mean_mean": 0.3951283154121864, "reward_accuracy_mean_min": 0.24375, "reward_accuracy_mean_max": 0.5709666666666666, "reward_sla_mean_mean": -1.0354360812425327, "reward_sla_mean_min": -1.6727777777777777, "reward_sla_mean_max": -0.6233333333333333, "reward_consolidation_sum_mean": 16.51732377538829, "reward_consolidation_sum_min": 5.555555555555555, "reward_consolidation_sum_max": 30.555555555555554, "reward_illegal_sum_mean": -175.03584229390677, "reward_illegal_sum_min": -199.99999999999997, "reward_illegal_sum_max": -153.33333333333331, "reward_accuracy_sum_mean": 39.51283154121864, "reward_accuracy_sum_min": 24.375, "reward_accuracy_sum_max": 57.096666666666664, "reward_sla_sum_mean": -103.54360812425325, "reward_sla_sum_min": -167.27777777777777, "reward_sla_sum_max": -62.33333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1600.0, "global_timestep_min": 100, "global_timestep_max": 3100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-234.92666666666653, -208.25722222222217, -229.90500000000003, -227.0972222222221, -252.51666666666662, -205.97888888888872, -221.82722222222222, -206.52777777777771, -224.6055555555555, -203.9294444444443, -233.16277777777762, -223.00833333333327, -222.9027777777776, -251.89722222222213, -228.57888888888874, -233.03055555555554, -214.95555555555552, -230.85944444444428, -227.8272222222222, -225.75833333333327, -243.4599999999998, -220.87944444444437, -237.66222222222223, -229.11222222222213, -212.01499999999993, -231.13055555555547, -223.39166666666665, -223.086111111111, -227.27833333333328, -221.86777777777758, -186.82166666666663, -193.57722222222208, -210.63777777777767, -218.96777777777777, -228.5133333333332, -234.45111111111112, -242.6966666666666, -209.09666666666647, -218.4688888888888, -232.1588888888888, -220.08722222222212, -200.89333333333335, -215.44999999999996, -196.04277777777773, -211.0344444444444, -232.46444444444433, -203.53277777777754, -239.3255555555555, -218.94722222222222, -241.1222222222222, -253.46055555555552, -212.62888888888872, -215.10666666666657, -204.1033333333333, -196.3266666666667, -193.6444444444444, -208.6999999999999, -208.29055555555541, -200.9655555555554, -218.6438888888887, -209.14499999999998, -221.68388888888884, -234.04499999999993, -230.5433333333333, -231.0272222222221, -205.24055555555546, -231.2016666666666, -233.0516666666665, -231.10333333333315, -215.921111111111, -208.93888888888875, -212.4494444444443, -235.2194444444444, -220.68722222222212, -220.23833333333323, -241.87499999999997, -206.48388888888888, -244.03555555555562, -260.6705555555555, -202.42722222222204, -231.29277777777762, -208.5805555555554, -227.09555555555548, -200.69944444444445, -218.98499999999996, -235.00222222222217, -227.557222222222, -221.68111111111102, -269.15611111111093, -244.76444444444428, -209.27944444444435, -224.22499999999988, -239.18055555555551], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-234.92666666666653, -208.25722222222217, -229.90500000000003, -227.0972222222221, -252.51666666666662, -205.97888888888872, -221.82722222222222, -206.52777777777771, -224.6055555555555, -203.9294444444443, -233.16277777777762, -223.00833333333327, -222.9027777777776, -251.89722222222213, -228.57888888888874, -233.03055555555554, -214.95555555555552, -230.85944444444428, -227.8272222222222, -225.75833333333327, -243.4599999999998, -220.87944444444437, -237.66222222222223, -229.11222222222213, -212.01499999999993, -231.13055555555547, -223.39166666666665, -223.086111111111, -227.27833333333328, -221.86777777777758, -186.82166666666663, -193.57722222222208, -210.63777777777767, -218.96777777777777, -228.5133333333332, -234.45111111111112, -242.6966666666666, -209.09666666666647, -218.4688888888888, -232.1588888888888, -220.08722222222212, -200.89333333333335, -215.44999999999996, -196.04277777777773, -211.0344444444444, -232.46444444444433, -203.53277777777754, -239.3255555555555, -218.94722222222222, -241.1222222222222, -253.46055555555552, -212.62888888888872, -215.10666666666657, -204.1033333333333, -196.3266666666667, -193.6444444444444, -208.6999999999999, -208.29055555555541, -200.9655555555554, -218.6438888888887, -209.14499999999998, -221.68388888888884, -234.04499999999993, -230.5433333333333, -231.0272222222221, -205.24055555555546, -231.2016666666666, -233.0516666666665, -231.10333333333315, -215.921111111111, -208.93888888888875, -212.4494444444443, -235.2194444444444, -220.68722222222212, -220.23833333333323, -241.87499999999997, -206.48388888888888, -244.03555555555562, -260.6705555555555, -202.42722222222204, -231.29277777777762, -208.5805555555554, -227.09555555555548, -200.69944444444445, -218.98499999999996, -235.00222222222217, -227.557222222222, -221.68111111111102, -269.15611111111093, -244.76444444444428, -209.27944444444435, -224.22499999999988, -239.18055555555551]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18459342032990314, "mean_inference_ms": 1.7623635952207222, "mean_action_processing_ms": 0.07090398160119175, "mean_env_wait_ms": 1.1531309351809436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004534823920137139, "StateBufferConnector_ms": 0.002693360851657006, "ViewRequirementAgentConnector_ms": 0.06005328188660324}, "num_episodes": 33, "episode_return_max": -186.82166666666663, "episode_return_min": -269.15611111111093, "episode_return_mean": -222.5492951015531, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9450, "num_agent_steps_trained": 9300, "num_env_steps_sampled": 9450, "num_env_steps_trained": 9300, "num_env_steps_sampled_this_iter": 3300, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 314.4680249716799, "num_env_steps_trained_throughput_per_sec": 314.4680249716799, "timesteps_total": 9450, "num_env_steps_sampled_lifetime": 9450, "num_agent_steps_sampled_lifetime": 9450, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 9450, "timers": {"training_iteration_time_ms": 10235.203, "restore_workers_time_ms": 0.025, "training_step_time_ms": 477.079, "sample_time_ms": 463.972, "synch_weights_time_ms": 11.834}, "counters": {"num_env_steps_sampled": 9450, "num_env_steps_trained": 9300, "num_agent_steps_sampled": 9450, "num_agent_steps_trained": 9300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 63, "num_samples_added_to_queue": 9300}, "done": false, "training_iteration": 3, "trial_id": "0313d_00000", "date": "2024-10-10_21-41-54", "timestamp": 1728592914, "time_this_iter_s": 10.504904508590698, "time_total_s": 30.741065740585327, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c2a1d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 30.741065740585327, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 10.733333333333333, "ram_util_percent": 51.01999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -200301.15625, "policy_loss": -200317.75, "entropy": 29.818065643310547, "entropy_coeff": 0.01, "var_gnorm": 16.002145767211914, "vf_loss": 106042.734375, "vf_explained_var": 0.0023586153984069824}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 12600, "num_env_steps_trained": 12300, "num_agent_steps_sampled": 12600, "num_agent_steps_trained": 12300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 84, "num_samples_added_to_queue": 12600, "learner_queue": {"size_count": 41, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.906, "learner_load_time_ms": 0.213, "learner_load_wait_time_ms": 943.125, "learner_dequeue_time_ms": 6704.399}}, "env_runners": {"episode_reward_max": -186.82166666666663, "episode_reward_min": -269.15611111111093, "episode_reward_mean": -220.5326444444444, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -269.15611111111093}, "policy_reward_max": {"default_policy": -186.82166666666663}, "policy_reward_mean": {"default_policy": -220.5326444444444}, "custom_metrics": {"num_consolidated_mean": 0.6763000000000001, "num_consolidated_min": 0.53, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0457, "num_overloaded_min": 0.92, "num_overloaded_max": 1.2, "num_moves_mean": 9.979099999999999, "num_moves_min": 9.6, "num_moves_max": 10.33, "mean_accuracy_mean": 41.09822666666666, "mean_accuracy_min": 40.79599999999999, "mean_accuracy_max": 41.37233333333334, "num_model_switches_mean": 5.987799999999998, "num_model_switches_min": 5.62, "num_model_switches_max": 6.41, "num_slav_mean": 0.16201249999999998, "num_slav_min": 0.13853333333333334, "num_slav_max": 0.18098333333333333, "mean_cluster_cpu_util_mean": 0.5704101020924964, "mean_cluster_cpu_util_min": 0.5523047903228648, "mean_cluster_cpu_util_max": 0.5989262506793434, "mean_cluster_mem_util_mean": 0.3657570051002469, "mean_cluster_mem_util_min": 0.3564852150248285, "mean_cluster_mem_util_max": 0.38094564299348443, "reward_consolidation_mean_mean": 0.16680555555555554, "reward_consolidation_mean_min": 0.05555555555555555, "reward_consolidation_mean_max": 0.3055555555555555, "reward_illegal_mean_mean": -1.742833333333333, "reward_illegal_mean_min": -1.9999999999999998, "reward_illegal_mean_max": -1.5333333333333328, "reward_accuracy_mean_mean": 0.3973013333333333, "reward_accuracy_mean_min": 0.24628333333333333, "reward_accuracy_mean_max": 0.5709666666666666, "reward_sla_mean_mean": -1.0266, "reward_sla_mean_min": -1.6727777777777777, "reward_sla_mean_max": -0.6233333333333333, "reward_consolidation_sum_mean": 16.680555555555554, "reward_consolidation_sum_min": 5.555555555555555, "reward_consolidation_sum_max": 30.555555555555554, "reward_illegal_sum_mean": -174.28333333333333, "reward_illegal_sum_min": -199.99999999999997, "reward_illegal_sum_max": -153.3333333333333, "reward_accuracy_sum_mean": 39.73013333333334, "reward_accuracy_sum_min": 24.628333333333334, "reward_accuracy_sum_max": 57.096666666666664, "reward_sla_sum_mean": -102.66, "reward_sla_sum_min": -167.27777777777777, "reward_sla_sum_max": -62.33333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2578.0, "global_timestep_min": 700, "global_timestep_max": 4200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-223.39166666666665, -223.086111111111, -227.27833333333328, -221.86777777777758, -186.82166666666663, -193.57722222222208, -210.63777777777767, -218.96777777777777, -228.5133333333332, -234.45111111111112, -242.6966666666666, -209.09666666666647, -218.4688888888888, -232.1588888888888, -220.08722222222212, -200.89333333333335, -215.44999999999996, -196.04277777777773, -211.0344444444444, -232.46444444444433, -203.53277777777754, -239.3255555555555, -218.94722222222222, -241.1222222222222, -253.46055555555552, -212.62888888888872, -215.10666666666657, -204.1033333333333, -196.3266666666667, -193.6444444444444, -208.6999999999999, -208.29055555555541, -200.9655555555554, -218.6438888888887, -209.14499999999998, -221.68388888888884, -234.04499999999993, -230.5433333333333, -231.0272222222221, -205.24055555555546, -231.2016666666666, -233.0516666666665, -231.10333333333315, -215.921111111111, -208.93888888888875, -212.4494444444443, -235.2194444444444, -220.68722222222212, -220.23833333333323, -241.87499999999997, -206.48388888888888, -244.03555555555562, -260.6705555555555, -202.42722222222204, -231.29277777777762, -208.5805555555554, -227.09555555555548, -200.69944444444445, -218.98499999999996, -235.00222222222217, -227.557222222222, -221.68111111111102, -269.15611111111093, -244.76444444444428, -209.27944444444435, -224.22499999999988, -239.18055555555551, -202.52388888888885, -202.7322222222221, -212.9633333333333, -238.89500000000004, -234.19888888888875, -243.48222222222208, -229.97777777777776, -228.57222222222205, -202.12222222222212, -208.40611111111104, -235.01222222222208, -231.69999999999982, -211.10555555555547, -219.84222222222223, -227.46055555555546, -218.7405555555555, -233.52555555555546, -207.90944444444443, -246.21722222222215, -226.0966666666666, -213.91777777777781, -214.40444444444435, -220.11999999999983, -211.31666666666655, -203.9694444444444, -217.90166666666659, -214.13611111111106, -222.36000000000004, -199.22611111111095, -209.71666666666664, -209.00222222222217, -224.0088888888888, -216.42833333333317], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-223.39166666666665, -223.086111111111, -227.27833333333328, -221.86777777777758, -186.82166666666663, -193.57722222222208, -210.63777777777767, -218.96777777777777, -228.5133333333332, -234.45111111111112, -242.6966666666666, -209.09666666666647, -218.4688888888888, -232.1588888888888, -220.08722222222212, -200.89333333333335, -215.44999999999996, -196.04277777777773, -211.0344444444444, -232.46444444444433, -203.53277777777754, -239.3255555555555, -218.94722222222222, -241.1222222222222, -253.46055555555552, -212.62888888888872, -215.10666666666657, -204.1033333333333, -196.3266666666667, -193.6444444444444, -208.6999999999999, -208.29055555555541, -200.9655555555554, -218.6438888888887, -209.14499999999998, -221.68388888888884, -234.04499999999993, -230.5433333333333, -231.0272222222221, -205.24055555555546, -231.2016666666666, -233.0516666666665, -231.10333333333315, -215.921111111111, -208.93888888888875, -212.4494444444443, -235.2194444444444, -220.68722222222212, -220.23833333333323, -241.87499999999997, -206.48388888888888, -244.03555555555562, -260.6705555555555, -202.42722222222204, -231.29277777777762, -208.5805555555554, -227.09555555555548, -200.69944444444445, -218.98499999999996, -235.00222222222217, -227.557222222222, -221.68111111111102, -269.15611111111093, -244.76444444444428, -209.27944444444435, -224.22499999999988, -239.18055555555551, -202.52388888888885, -202.7322222222221, -212.9633333333333, -238.89500000000004, -234.19888888888875, -243.48222222222208, -229.97777777777776, -228.57222222222205, -202.12222222222212, -208.40611111111104, -235.01222222222208, -231.69999999999982, -211.10555555555547, -219.84222222222223, -227.46055555555546, -218.7405555555555, -233.52555555555546, -207.90944444444443, -246.21722222222215, -226.0966666666666, -213.91777777777781, -214.40444444444435, -220.11999999999983, -211.31666666666655, -203.9694444444444, -217.90166666666659, -214.13611111111106, -222.36000000000004, -199.22611111111095, -209.71666666666664, -209.00222222222217, -224.0088888888888, -216.42833333333317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1833392772221354, "mean_inference_ms": 1.744111266511505, "mean_action_processing_ms": 0.07044070548703972, "mean_env_wait_ms": 1.1459598571665905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004288673400878906, "StateBufferConnector_ms": 0.0027663707733154297, "ViewRequirementAgentConnector_ms": 0.06301426887512207}, "num_episodes": 33, "episode_return_max": -186.82166666666663, "episode_return_min": -269.15611111111093, "episode_return_mean": -220.5326444444444, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12600, "num_agent_steps_trained": 12300, "num_env_steps_sampled": 12600, "num_env_steps_trained": 12300, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 300.4744596571927, "num_env_steps_trained_throughput_per_sec": 286.16615205446925, "timesteps_total": 12600, "num_env_steps_sampled_lifetime": 12600, "num_agent_steps_sampled_lifetime": 12600, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 12600, "timers": {"training_iteration_time_ms": 10297.26, "restore_workers_time_ms": 0.012, "training_step_time_ms": 527.158, "sample_time_ms": 513.847, "synch_weights_time_ms": 11.886}, "counters": {"num_env_steps_sampled": 12600, "num_env_steps_trained": 12300, "num_agent_steps_sampled": 12600, "num_agent_steps_trained": 12300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 84, "num_samples_added_to_queue": 12600}, "done": false, "training_iteration": 4, "trial_id": "0313d_00000", "date": "2024-10-10_21-42-05", "timestamp": 1728592925, "time_this_iter_s": 10.493256092071533, "time_total_s": 41.23432183265686, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a42b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 41.23432183265686, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.506666666666668, "ram_util_percent": 50.74}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -228981.03125, "policy_loss": -229027.640625, "entropy": 29.817829132080078, "entropy_coeff": 0.01, "var_gnorm": 16.00286865234375, "vf_loss": 136059.015625, "vf_explained_var": 0.0027056336402893066}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 15300, "num_env_steps_trained": 15000, "num_agent_steps_sampled": 15300, "num_agent_steps_trained": 15000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 102, "num_samples_added_to_queue": 15300, "learner_queue": {"size_count": 50, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.277, "learner_load_time_ms": 0.236, "learner_load_wait_time_ms": 1059.132, "learner_dequeue_time_ms": 7072.643}}, "env_runners": {"episode_reward_max": -193.6444444444444, "episode_reward_min": -269.15611111111093, "episode_reward_mean": -221.62490555555542, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -269.15611111111093}, "policy_reward_max": {"default_policy": -193.6444444444444}, "policy_reward_mean": {"default_policy": -221.62490555555542}, "custom_metrics": {"num_consolidated_mean": 0.6688, "num_consolidated_min": 0.53, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0411000000000001, "num_overloaded_min": 0.89, "num_overloaded_max": 1.17, "num_moves_mean": 9.980499999999997, "num_moves_min": 9.6, "num_moves_max": 10.33, "mean_accuracy_mean": 41.10715666666667, "mean_accuracy_min": 40.852999999999994, "mean_accuracy_max": 41.37233333333334, "num_model_switches_mean": 5.9897, "num_model_switches_min": 5.62, "num_model_switches_max": 6.41, "num_slav_mean": 0.1634115, "num_slav_min": 0.14343333333333336, "num_slav_max": 0.19108333333333338, "mean_cluster_cpu_util_mean": 0.569617895257916, "mean_cluster_cpu_util_min": 0.5490603267534082, "mean_cluster_cpu_util_max": 0.5989262506793434, "mean_cluster_mem_util_mean": 0.36546185712491747, "mean_cluster_mem_util_min": 0.3564852150248285, "mean_cluster_mem_util_max": 0.38094564299348443, "reward_consolidation_mean_mean": 0.16583333333333333, "reward_consolidation_mean_min": 0.05555555555555555, "reward_consolidation_mean_max": 0.33333333333333326, "reward_illegal_mean_mean": -1.7351666666666663, "reward_illegal_mean_min": -1.9499999999999997, "reward_illegal_mean_max": -1.483333333333333, "reward_accuracy_mean_mean": 0.4018065, "reward_accuracy_mean_min": 0.24628333333333333, "reward_accuracy_mean_max": 0.5709666666666666, "reward_sla_mean_mean": -1.0487222222222221, "reward_sla_mean_min": -1.6783333333333332, "reward_sla_mean_max": -0.6233333333333333, "reward_consolidation_sum_mean": 16.583333333333332, "reward_consolidation_sum_min": 5.555555555555555, "reward_consolidation_sum_max": 33.33333333333333, "reward_illegal_sum_mean": -173.5166666666666, "reward_illegal_sum_min": -194.99999999999997, "reward_illegal_sum_max": -148.3333333333333, "reward_accuracy_sum_mean": 40.18064999999999, "reward_accuracy_sum_min": 24.628333333333334, "reward_accuracy_sum_max": 57.096666666666664, "reward_sla_sum_mean": -104.8722222222222, "reward_sla_sum_min": -167.83333333333331, "reward_sla_sum_max": -62.33333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3467.0, "global_timestep_min": 1400, "global_timestep_max": 5100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-204.1033333333333, -196.3266666666667, -193.6444444444444, -208.6999999999999, -208.29055555555541, -200.9655555555554, -218.6438888888887, -209.14499999999998, -221.68388888888884, -234.04499999999993, -230.5433333333333, -231.0272222222221, -205.24055555555546, -231.2016666666666, -233.0516666666665, -231.10333333333315, -215.921111111111, -208.93888888888875, -212.4494444444443, -235.2194444444444, -220.68722222222212, -220.23833333333323, -241.87499999999997, -206.48388888888888, -244.03555555555562, -260.6705555555555, -202.42722222222204, -231.29277777777762, -208.5805555555554, -227.09555555555548, -200.69944444444445, -218.98499999999996, -235.00222222222217, -227.557222222222, -221.68111111111102, -269.15611111111093, -244.76444444444428, -209.27944444444435, -224.22499999999988, -239.18055555555551, -202.52388888888885, -202.7322222222221, -212.9633333333333, -238.89500000000004, -234.19888888888875, -243.48222222222208, -229.97777777777776, -228.57222222222205, -202.12222222222212, -208.40611111111104, -235.01222222222208, -231.69999999999982, -211.10555555555547, -219.84222222222223, -227.46055555555546, -218.7405555555555, -233.52555555555546, -207.90944444444443, -246.21722222222215, -226.0966666666666, -213.91777777777781, -214.40444444444435, -220.11999999999983, -211.31666666666655, -203.9694444444444, -217.90166666666659, -214.13611111111106, -222.36000000000004, -199.22611111111095, -209.71666666666664, -209.00222222222217, -224.0088888888888, -216.42833333333317, -215.80333333333317, -209.31333333333325, -222.8999999999999, -226.0738888888888, -238.53055555555548, -210.73333333333323, -223.90055555555563, -225.00888888888878, -215.18555555555554, -239.59611111111101, -228.77888888888882, -248.73499999999993, -210.63111111111104, -218.64388888888874, -206.98000000000002, -231.80944444444435, -242.47166666666652, -238.25999999999993, -217.31277777777765, -210.4299999999999, -211.61277777777767, -237.99444444444433, -205.82888888888886, -251.4355555555554, -201.98611111111094, -238.18611111111096, -212.19388888888884], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-204.1033333333333, -196.3266666666667, -193.6444444444444, -208.6999999999999, -208.29055555555541, -200.9655555555554, -218.6438888888887, -209.14499999999998, -221.68388888888884, -234.04499999999993, -230.5433333333333, -231.0272222222221, -205.24055555555546, -231.2016666666666, -233.0516666666665, -231.10333333333315, -215.921111111111, -208.93888888888875, -212.4494444444443, -235.2194444444444, -220.68722222222212, -220.23833333333323, -241.87499999999997, -206.48388888888888, -244.03555555555562, -260.6705555555555, -202.42722222222204, -231.29277777777762, -208.5805555555554, -227.09555555555548, -200.69944444444445, -218.98499999999996, -235.00222222222217, -227.557222222222, -221.68111111111102, -269.15611111111093, -244.76444444444428, -209.27944444444435, -224.22499999999988, -239.18055555555551, -202.52388888888885, -202.7322222222221, -212.9633333333333, -238.89500000000004, -234.19888888888875, -243.48222222222208, -229.97777777777776, -228.57222222222205, -202.12222222222212, -208.40611111111104, -235.01222222222208, -231.69999999999982, -211.10555555555547, -219.84222222222223, -227.46055555555546, -218.7405555555555, -233.52555555555546, -207.90944444444443, -246.21722222222215, -226.0966666666666, -213.91777777777781, -214.40444444444435, -220.11999999999983, -211.31666666666655, -203.9694444444444, -217.90166666666659, -214.13611111111106, -222.36000000000004, -199.22611111111095, -209.71666666666664, -209.00222222222217, -224.0088888888888, -216.42833333333317, -215.80333333333317, -209.31333333333325, -222.8999999999999, -226.0738888888888, -238.53055555555548, -210.73333333333323, -223.90055555555563, -225.00888888888878, -215.18555555555554, -239.59611111111101, -228.77888888888882, -248.73499999999993, -210.63111111111104, -218.64388888888874, -206.98000000000002, -231.80944444444435, -242.47166666666652, -238.25999999999993, -217.31277777777765, -210.4299999999999, -211.61277777777767, -237.99444444444433, -205.82888888888886, -251.4355555555554, -201.98611111111094, -238.18611111111096, -212.19388888888884]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18516480112216724, "mean_inference_ms": 1.7438719339896367, "mean_action_processing_ms": 0.07093322464981705, "mean_env_wait_ms": 1.1515338733961262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043027400970458984, "StateBufferConnector_ms": 0.0028600692749023438, "ViewRequirementAgentConnector_ms": 0.06565141677856445}, "num_episodes": 27, "episode_return_max": -193.6444444444444, "episode_return_min": -269.15611111111093, "episode_return_mean": -221.62490555555542, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15300, "num_agent_steps_trained": 15000, "num_env_steps_sampled": 15300, "num_env_steps_trained": 15000, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 269.10451920390585, "num_env_steps_trained_throughput_per_sec": 269.10451920390585, "timesteps_total": 15300, "num_env_steps_sampled_lifetime": 15300, "num_agent_steps_sampled_lifetime": 15300, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 15300, "timers": {"training_iteration_time_ms": 10244.465, "restore_workers_time_ms": 0.014, "training_step_time_ms": 544.783, "sample_time_ms": 530.035, "synch_weights_time_ms": 13.385}, "counters": {"num_env_steps_sampled": 15300, "num_env_steps_trained": 15000, "num_agent_steps_sampled": 15300, "num_agent_steps_trained": 15000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 102, "num_samples_added_to_queue": 15300}, "done": false, "training_iteration": 5, "trial_id": "0313d_00000", "date": "2024-10-10_21-42-15", "timestamp": 1728592935, "time_this_iter_s": 10.04435133934021, "time_total_s": 51.27867317199707, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a5e10>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 51.27867317199707, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 16.386666666666667, "ram_util_percent": 50.21333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -215710.4375, "policy_loss": -215743.9375, "entropy": 29.817441940307617, "entropy_coeff": 0.01, "var_gnorm": 16.004152297973633, "vf_loss": 122950.21875, "vf_explained_var": 0.003568708896636963}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 18450, "num_env_steps_trained": 18300, "num_agent_steps_sampled": 18450, "num_agent_steps_trained": 18300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 123, "num_samples_added_to_queue": 18300, "learner_queue": {"size_count": 61, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 51.002, "learner_load_time_ms": 0.247, "learner_load_wait_time_ms": 924.964, "learner_dequeue_time_ms": 7149.374}}, "env_runners": {"episode_reward_max": -196.25222222222206, "episode_reward_min": -269.15611111111093, "episode_reward_mean": -222.59416111111105, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -269.15611111111093}, "policy_reward_max": {"default_policy": -196.25222222222206}, "policy_reward_mean": {"default_policy": -222.59416111111105}, "custom_metrics": {"num_consolidated_mean": 0.6775000000000001, "num_consolidated_min": 0.54, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.048, "num_overloaded_min": 0.89, "num_overloaded_max": 1.2, "num_moves_mean": 9.989700000000001, "num_moves_min": 9.6, "num_moves_max": 10.4, "mean_accuracy_mean": 41.11228666666667, "mean_accuracy_min": 40.852999999999994, "mean_accuracy_max": 41.35333333333333, "num_model_switches_mean": 6.000699999999999, "num_model_switches_min": 5.63, "num_model_switches_max": 6.43, "num_slav_mean": 0.16380816666666673, "num_slav_min": 0.14639999999999997, "num_slav_max": 0.19108333333333338, "mean_cluster_cpu_util_mean": 0.5701952712940781, "mean_cluster_cpu_util_min": 0.5490603267534082, "mean_cluster_cpu_util_max": 0.5989262506793434, "mean_cluster_mem_util_mean": 0.36570383161112546, "mean_cluster_mem_util_min": 0.3564852150248285, "mean_cluster_mem_util_max": 0.38094564299348443, "reward_consolidation_mean_mean": 0.16416666666666668, "reward_consolidation_mean_min": 0.05555555555555555, "reward_consolidation_mean_max": 0.33333333333333326, "reward_illegal_mean_mean": -1.7466666666666666, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.483333333333333, "reward_accuracy_mean_mean": 0.3956861666666666, "reward_accuracy_mean_min": 0.22763333333333335, "reward_accuracy_mean_max": 0.5880333333333333, "reward_sla_mean_mean": -1.0391277777777779, "reward_sla_mean_min": -1.6783333333333332, "reward_sla_mean_max": -0.5672222222222223, "reward_consolidation_sum_mean": 16.416666666666668, "reward_consolidation_sum_min": 5.555555555555555, "reward_consolidation_sum_max": 33.33333333333333, "reward_illegal_sum_mean": -174.66666666666663, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -148.3333333333333, "reward_accuracy_sum_mean": 39.568616666666664, "reward_accuracy_sum_min": 22.763333333333335, "reward_accuracy_sum_max": 58.80333333333333, "reward_sla_sum_mean": -103.91277777777778, "reward_sla_sum_min": -167.83333333333331, "reward_sla_sum_max": -56.72222222222223, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4450.0, "global_timestep_min": 2200, "global_timestep_max": 6100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-200.69944444444445, -218.98499999999996, -235.00222222222217, -227.557222222222, -221.68111111111102, -269.15611111111093, -244.76444444444428, -209.27944444444435, -224.22499999999988, -239.18055555555551, -202.52388888888885, -202.7322222222221, -212.9633333333333, -238.89500000000004, -234.19888888888875, -243.48222222222208, -229.97777777777776, -228.57222222222205, -202.12222222222212, -208.40611111111104, -235.01222222222208, -231.69999999999982, -211.10555555555547, -219.84222222222223, -227.46055555555546, -218.7405555555555, -233.52555555555546, -207.90944444444443, -246.21722222222215, -226.0966666666666, -213.91777777777781, -214.40444444444435, -220.11999999999983, -211.31666666666655, -203.9694444444444, -217.90166666666659, -214.13611111111106, -222.36000000000004, -199.22611111111095, -209.71666666666664, -209.00222222222217, -224.0088888888888, -216.42833333333317, -215.80333333333317, -209.31333333333325, -222.8999999999999, -226.0738888888888, -238.53055555555548, -210.73333333333323, -223.90055555555563, -225.00888888888878, -215.18555555555554, -239.59611111111101, -228.77888888888882, -248.73499999999993, -210.63111111111104, -218.64388888888874, -206.98000000000002, -231.80944444444435, -242.47166666666652, -238.25999999999993, -217.31277777777765, -210.4299999999999, -211.61277777777767, -237.99444444444433, -205.82888888888886, -251.4355555555554, -201.98611111111094, -238.18611111111096, -212.19388888888884, -229.90944444444435, -214.56666666666658, -223.4899999999998, -217.931111111111, -241.73666666666654, -232.50277777777774, -212.41388888888898, -227.17666666666653, -241.63777777777773, -256.46388888888873, -207.25388888888884, -220.38222222222237, -255.66055555555556, -232.53611111111096, -201.5733333333333, -231.5877777777777, -225.55166666666656, -228.92999999999986, -248.61333333333332, -212.1749999999998, -216.88277777777768, -227.58777777777766, -222.4699999999999, -217.8538888888889, -199.92777777777766, -215.44555555555544, -196.25222222222206, -206.2722222222221, -220.7366666666666, -205.0355555555556], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-200.69944444444445, -218.98499999999996, -235.00222222222217, -227.557222222222, -221.68111111111102, -269.15611111111093, -244.76444444444428, -209.27944444444435, -224.22499999999988, -239.18055555555551, -202.52388888888885, -202.7322222222221, -212.9633333333333, -238.89500000000004, -234.19888888888875, -243.48222222222208, -229.97777777777776, -228.57222222222205, -202.12222222222212, -208.40611111111104, -235.01222222222208, -231.69999999999982, -211.10555555555547, -219.84222222222223, -227.46055555555546, -218.7405555555555, -233.52555555555546, -207.90944444444443, -246.21722222222215, -226.0966666666666, -213.91777777777781, -214.40444444444435, -220.11999999999983, -211.31666666666655, -203.9694444444444, -217.90166666666659, -214.13611111111106, -222.36000000000004, -199.22611111111095, -209.71666666666664, -209.00222222222217, -224.0088888888888, -216.42833333333317, -215.80333333333317, -209.31333333333325, -222.8999999999999, -226.0738888888888, -238.53055555555548, -210.73333333333323, -223.90055555555563, -225.00888888888878, -215.18555555555554, -239.59611111111101, -228.77888888888882, -248.73499999999993, -210.63111111111104, -218.64388888888874, -206.98000000000002, -231.80944444444435, -242.47166666666652, -238.25999999999993, -217.31277777777765, -210.4299999999999, -211.61277777777767, -237.99444444444433, -205.82888888888886, -251.4355555555554, -201.98611111111094, -238.18611111111096, -212.19388888888884, -229.90944444444435, -214.56666666666658, -223.4899999999998, -217.931111111111, -241.73666666666654, -232.50277777777774, -212.41388888888898, -227.17666666666653, -241.63777777777773, -256.46388888888873, -207.25388888888884, -220.38222222222237, -255.66055555555556, -232.53611111111096, -201.5733333333333, -231.5877777777777, -225.55166666666656, -228.92999999999986, -248.61333333333332, -212.1749999999998, -216.88277777777768, -227.58777777777766, -222.4699999999999, -217.8538888888889, -199.92777777777766, -215.44555555555544, -196.25222222222206, -206.2722222222221, -220.7366666666666, -205.0355555555556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18734827891760716, "mean_inference_ms": 1.7521440952125635, "mean_action_processing_ms": 0.0715787161130339, "mean_env_wait_ms": 1.1596148089977019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004330873489379883, "StateBufferConnector_ms": 0.002878427505493164, "ViewRequirementAgentConnector_ms": 0.0664663314819336}, "num_episodes": 30, "episode_return_max": -196.25222222222206, "episode_return_min": -269.15611111111093, "episode_return_mean": -222.59416111111105, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18450, "num_agent_steps_trained": 18300, "num_env_steps_sampled": 18450, "num_env_steps_trained": 18300, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 305.1025899522202, "num_env_steps_trained_throughput_per_sec": 319.63128471184973, "timesteps_total": 18450, "num_env_steps_sampled_lifetime": 18450, "num_agent_steps_sampled_lifetime": 18450, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 18450, "timers": {"training_iteration_time_ms": 10257.788, "restore_workers_time_ms": 0.012, "training_step_time_ms": 504.954, "sample_time_ms": 491.251, "synch_weights_time_ms": 12.426}, "counters": {"num_env_steps_sampled": 18450, "num_env_steps_trained": 18300, "num_agent_steps_sampled": 18450, "num_agent_steps_trained": 18300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 123, "num_samples_added_to_queue": 18300}, "done": false, "training_iteration": 6, "trial_id": "0313d_00000", "date": "2024-10-10_21-42-25", "timestamp": 1728592945, "time_this_iter_s": 10.332957983016968, "time_total_s": 61.61163115501404, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a5540>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 61.61163115501404, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 10.486666666666668, "ram_util_percent": 49.48666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -235987.4375, "policy_loss": -236038.78125, "entropy": 29.817119598388672, "entropy_coeff": 0.01, "var_gnorm": 16.00473403930664, "vf_loss": 140790.140625, "vf_explained_var": 0.004545629024505615}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 21450, "num_env_steps_trained": 21300, "num_agent_steps_sampled": 21450, "num_agent_steps_trained": 21300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 143, "num_samples_added_to_queue": 21300, "learner_queue": {"size_count": 71, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 44.991, "learner_load_time_ms": 0.233, "learner_load_wait_time_ms": 990.37, "learner_dequeue_time_ms": 7252.797}}, "env_runners": {"episode_reward_max": -193.68222222222215, "episode_reward_min": -256.46388888888873, "episode_reward_mean": -221.9147277777777, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -256.46388888888873}, "policy_reward_max": {"default_policy": -193.68222222222215}, "policy_reward_mean": {"default_policy": -221.9147277777777}, "custom_metrics": {"num_consolidated_mean": 0.6740999999999999, "num_consolidated_min": 0.54, "num_consolidated_max": 0.82, "num_overloaded_mean": 1.0404, "num_overloaded_min": 0.89, "num_overloaded_max": 1.2, "num_moves_mean": 10.0111, "num_moves_min": 9.7, "num_moves_max": 10.4, "mean_accuracy_mean": 41.102533333333334, "mean_accuracy_min": 40.88466666666666, "mean_accuracy_max": 41.309, "num_model_switches_mean": 6.032, "num_model_switches_min": 5.63, "num_model_switches_max": 6.43, "num_slav_mean": 0.16291866666666663, "num_slav_min": 0.14300000000000002, "num_slav_max": 0.19108333333333338, "mean_cluster_cpu_util_mean": 0.5691044792908359, "mean_cluster_cpu_util_min": 0.545550970889336, "mean_cluster_cpu_util_max": 0.5878349994034162, "mean_cluster_mem_util_mean": 0.36516549677265425, "mean_cluster_mem_util_min": 0.35495474540026983, "mean_cluster_mem_util_max": 0.37509293320703807, "reward_consolidation_mean_mean": 0.16819444444444442, "reward_consolidation_mean_min": 0.05555555555555555, "reward_consolidation_mean_max": 0.33333333333333326, "reward_illegal_mean_mean": -1.7339999999999998, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.483333333333333, "reward_accuracy_mean_mean": 0.40369716666666666, "reward_accuracy_mean_min": 0.22763333333333335, "reward_accuracy_mean_max": 0.5880333333333333, "reward_sla_mean_mean": -1.057038888888889, "reward_sla_mean_min": -1.6783333333333332, "reward_sla_mean_max": -0.5672222222222223, "reward_consolidation_sum_mean": 16.819444444444443, "reward_consolidation_sum_min": 5.555555555555555, "reward_consolidation_sum_max": 33.33333333333333, "reward_illegal_sum_mean": -173.39999999999998, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -148.3333333333333, "reward_accuracy_sum_mean": 40.36971666666666, "reward_accuracy_sum_min": 22.763333333333335, "reward_accuracy_sum_max": 58.80333333333333, "reward_sla_sum_mean": -105.70388888888891, "reward_sla_sum_min": -167.83333333333331, "reward_sla_sum_max": -56.72222222222223, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5449.0, "global_timestep_min": 3200, "global_timestep_max": 7100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-213.91777777777781, -214.40444444444435, -220.11999999999983, -211.31666666666655, -203.9694444444444, -217.90166666666659, -214.13611111111106, -222.36000000000004, -199.22611111111095, -209.71666666666664, -209.00222222222217, -224.0088888888888, -216.42833333333317, -215.80333333333317, -209.31333333333325, -222.8999999999999, -226.0738888888888, -238.53055555555548, -210.73333333333323, -223.90055555555563, -225.00888888888878, -215.18555555555554, -239.59611111111101, -228.77888888888882, -248.73499999999993, -210.63111111111104, -218.64388888888874, -206.98000000000002, -231.80944444444435, -242.47166666666652, -238.25999999999993, -217.31277777777765, -210.4299999999999, -211.61277777777767, -237.99444444444433, -205.82888888888886, -251.4355555555554, -201.98611111111094, -238.18611111111096, -212.19388888888884, -229.90944444444435, -214.56666666666658, -223.4899999999998, -217.931111111111, -241.73666666666654, -232.50277777777774, -212.41388888888898, -227.17666666666653, -241.63777777777773, -256.46388888888873, -207.25388888888884, -220.38222222222237, -255.66055555555556, -232.53611111111096, -201.5733333333333, -231.5877777777777, -225.55166666666656, -228.92999999999986, -248.61333333333332, -212.1749999999998, -216.88277777777768, -227.58777777777766, -222.4699999999999, -217.8538888888889, -199.92777777777766, -215.44555555555544, -196.25222222222206, -206.2722222222221, -220.7366666666666, -205.0355555555556, -223.8272222222222, -205.5566666666665, -227.1544444444443, -207.62777777777777, -236.22333333333313, -241.11722222222198, -243.74944444444435, -214.90499999999992, -221.41388888888883, -251.0816666666665, -219.29666666666662, -221.4022222222222, -234.8222222222221, -219.66111111111104, -206.5672222222221, -227.37944444444435, -224.5038888888889, -193.68222222222215, -239.4905555555554, -227.81388888888873, -239.41722222222205, -215.48833333333326, -209.8355555555554, -236.18166666666662, -238.04777777777772, -212.77222222222213, -204.755, -202.68777777777765, -213.5599999999998, -224.04944444444422], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-213.91777777777781, -214.40444444444435, -220.11999999999983, -211.31666666666655, -203.9694444444444, -217.90166666666659, -214.13611111111106, -222.36000000000004, -199.22611111111095, -209.71666666666664, -209.00222222222217, -224.0088888888888, -216.42833333333317, -215.80333333333317, -209.31333333333325, -222.8999999999999, -226.0738888888888, -238.53055555555548, -210.73333333333323, -223.90055555555563, -225.00888888888878, -215.18555555555554, -239.59611111111101, -228.77888888888882, -248.73499999999993, -210.63111111111104, -218.64388888888874, -206.98000000000002, -231.80944444444435, -242.47166666666652, -238.25999999999993, -217.31277777777765, -210.4299999999999, -211.61277777777767, -237.99444444444433, -205.82888888888886, -251.4355555555554, -201.98611111111094, -238.18611111111096, -212.19388888888884, -229.90944444444435, -214.56666666666658, -223.4899999999998, -217.931111111111, -241.73666666666654, -232.50277777777774, -212.41388888888898, -227.17666666666653, -241.63777777777773, -256.46388888888873, -207.25388888888884, -220.38222222222237, -255.66055555555556, -232.53611111111096, -201.5733333333333, -231.5877777777777, -225.55166666666656, -228.92999999999986, -248.61333333333332, -212.1749999999998, -216.88277777777768, -227.58777777777766, -222.4699999999999, -217.8538888888889, -199.92777777777766, -215.44555555555544, -196.25222222222206, -206.2722222222221, -220.7366666666666, -205.0355555555556, -223.8272222222222, -205.5566666666665, -227.1544444444443, -207.62777777777777, -236.22333333333313, -241.11722222222198, -243.74944444444435, -214.90499999999992, -221.41388888888883, -251.0816666666665, -219.29666666666662, -221.4022222222222, -234.8222222222221, -219.66111111111104, -206.5672222222221, -227.37944444444435, -224.5038888888889, -193.68222222222215, -239.4905555555554, -227.81388888888873, -239.41722222222205, -215.48833333333326, -209.8355555555554, -236.18166666666662, -238.04777777777772, -212.77222222222213, -204.755, -202.68777777777765, -213.5599999999998, -224.04944444444422]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18908393534931447, "mean_inference_ms": 1.7623033843936764, "mean_action_processing_ms": 0.0721229427949438, "mean_env_wait_ms": 1.1675173607142346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004220485687255859, "StateBufferConnector_ms": 0.0028324127197265625, "ViewRequirementAgentConnector_ms": 0.06537032127380371}, "num_episodes": 30, "episode_return_max": -193.68222222222215, "episode_return_min": -256.46388888888873, "episode_return_mean": -221.9147277777777, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21450, "num_agent_steps_trained": 21300, "num_env_steps_sampled": 21450, "num_env_steps_trained": 21300, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 293.563577629725, "num_env_steps_trained_throughput_per_sec": 293.563577629725, "timesteps_total": 21450, "num_env_steps_sampled_lifetime": 21450, "num_agent_steps_sampled_lifetime": 21450, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 21450, "timers": {"training_iteration_time_ms": 10252.284, "restore_workers_time_ms": 0.012, "training_step_time_ms": 513.542, "sample_time_ms": 499.417, "synch_weights_time_ms": 12.712}, "counters": {"num_env_steps_sampled": 21450, "num_env_steps_trained": 21300, "num_agent_steps_sampled": 21450, "num_agent_steps_trained": 21300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 143, "num_samples_added_to_queue": 21300}, "done": false, "training_iteration": 7, "trial_id": "0313d_00000", "date": "2024-10-10_21-42-36", "timestamp": 1728592956, "time_this_iter_s": 10.229102849960327, "time_total_s": 71.84073400497437, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c2a5c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 71.84073400497437, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 11.200000000000001, "ram_util_percent": 49.32142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -236489.546875, "policy_loss": -236544.0625, "entropy": 29.81682586669922, "entropy_coeff": 0.01, "var_gnorm": 16.004974365234375, "vf_loss": 143965.84375, "vf_explained_var": 0.004996359348297119}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 24600, "num_env_steps_trained": 24300, "num_agent_steps_sampled": 24600, "num_agent_steps_trained": 24300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 164, "num_samples_added_to_queue": 24600, "learner_queue": {"size_count": 81, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.381, "learner_load_time_ms": 0.234, "learner_load_wait_time_ms": 930.827, "learner_dequeue_time_ms": 8044.2}}, "env_runners": {"episode_reward_max": -193.68222222222215, "episode_reward_min": -261.9722222222222, "episode_reward_mean": -224.78624999999994, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -261.9722222222222}, "policy_reward_max": {"default_policy": -193.68222222222215}, "policy_reward_mean": {"default_policy": -224.78624999999994}, "custom_metrics": {"num_consolidated_mean": 0.677, "num_consolidated_min": 0.53, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0353, "num_overloaded_min": 0.88, "num_overloaded_max": 1.2, "num_moves_mean": 9.999, "num_moves_min": 9.55, "num_moves_max": 10.4, "mean_accuracy_mean": 41.1171, "mean_accuracy_min": 40.82766666666666, "mean_accuracy_max": 41.35333333333333, "num_model_switches_mean": 6.002599999999998, "num_model_switches_min": 5.41, "num_model_switches_max": 6.43, "num_slav_mean": 0.16326999999999997, "num_slav_min": 0.14300000000000002, "num_slav_max": 0.19108333333333338, "mean_cluster_cpu_util_mean": 0.5703899574549204, "mean_cluster_cpu_util_min": 0.545550970889336, "mean_cluster_cpu_util_max": 0.5943715671669871, "mean_cluster_mem_util_mean": 0.3658472962358995, "mean_cluster_mem_util_min": 0.35495474540026983, "mean_cluster_mem_util_max": 0.3754539436766268, "reward_consolidation_mean_mean": 0.16569444444444442, "reward_consolidation_mean_min": 0.05555555555555555, "reward_consolidation_mean_max": 0.29166666666666663, "reward_illegal_mean_mean": -1.7254999999999996, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.466666666666666, "reward_accuracy_mean_mean": 0.41382083333333325, "reward_accuracy_mean_min": 0.22763333333333335, "reward_accuracy_mean_max": 0.6923666666666667, "reward_sla_mean_mean": -1.1018777777777777, "reward_sla_mean_min": -1.8427777777777774, "reward_sla_mean_max": -0.5672222222222223, "reward_consolidation_sum_mean": 16.569444444444443, "reward_consolidation_sum_min": 5.555555555555555, "reward_consolidation_sum_max": 29.166666666666664, "reward_illegal_sum_mean": -172.55, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -146.6666666666666, "reward_accuracy_sum_mean": 41.38208333333334, "reward_accuracy_sum_min": 22.763333333333335, "reward_accuracy_sum_max": 69.23666666666666, "reward_sla_sum_mean": -110.18777777777777, "reward_sla_sum_min": -184.27777777777774, "reward_sla_sum_max": -56.72222222222223, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5631.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-211.61277777777767, -237.99444444444433, -205.82888888888886, -251.4355555555554, -201.98611111111094, -238.18611111111096, -212.19388888888884, -229.90944444444435, -214.56666666666658, -223.4899999999998, -217.931111111111, -241.73666666666654, -232.50277777777774, -212.41388888888898, -227.17666666666653, -241.63777777777773, -256.46388888888873, -207.25388888888884, -220.38222222222237, -255.66055555555556, -232.53611111111096, -201.5733333333333, -231.5877777777777, -225.55166666666656, -228.92999999999986, -248.61333333333332, -212.1749999999998, -216.88277777777768, -227.58777777777766, -222.4699999999999, -217.8538888888889, -199.92777777777766, -215.44555555555544, -196.25222222222206, -206.2722222222221, -220.7366666666666, -205.0355555555556, -223.8272222222222, -205.5566666666665, -227.1544444444443, -207.62777777777777, -236.22333333333313, -241.11722222222198, -243.74944444444435, -214.90499999999992, -221.41388888888883, -251.0816666666665, -219.29666666666662, -221.4022222222222, -234.8222222222221, -219.66111111111104, -206.5672222222221, -227.37944444444435, -224.5038888888889, -193.68222222222215, -239.4905555555554, -227.81388888888873, -239.41722222222205, -215.48833333333326, -209.8355555555554, -236.18166666666662, -238.04777777777772, -212.77222222222213, -204.755, -202.68777777777765, -213.5599999999998, -224.04944444444422, -237.70833333333331, -225.02388888888882, -235.92388888888874, -214.4149999999999, -218.15999999999994, -224.60333333333313, -225.1466666666666, -216.2333333333332, -223.45888888888885, -261.9722222222222, -228.25611111111107, -238.6694444444443, -210.30666666666656, -254.1461111111111, -211.23222222222213, -207.96277777777763, -232.46888888888876, -242.86333333333323, -242.24111111111094, -225.31499999999988, -248.95333333333323, -212.15222222222224, -222.70944444444436, -210.77111111111097, -256.0522222222221, -236.9844444444443, -224.31499999999983, -228.79555555555555, -208.8333333333333, -232.6205555555554, -232.29833333333323, -221.27277777777775, -232.89333333333317], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-211.61277777777767, -237.99444444444433, -205.82888888888886, -251.4355555555554, -201.98611111111094, -238.18611111111096, -212.19388888888884, -229.90944444444435, -214.56666666666658, -223.4899999999998, -217.931111111111, -241.73666666666654, -232.50277777777774, -212.41388888888898, -227.17666666666653, -241.63777777777773, -256.46388888888873, -207.25388888888884, -220.38222222222237, -255.66055555555556, -232.53611111111096, -201.5733333333333, -231.5877777777777, -225.55166666666656, -228.92999999999986, -248.61333333333332, -212.1749999999998, -216.88277777777768, -227.58777777777766, -222.4699999999999, -217.8538888888889, -199.92777777777766, -215.44555555555544, -196.25222222222206, -206.2722222222221, -220.7366666666666, -205.0355555555556, -223.8272222222222, -205.5566666666665, -227.1544444444443, -207.62777777777777, -236.22333333333313, -241.11722222222198, -243.74944444444435, -214.90499999999992, -221.41388888888883, -251.0816666666665, -219.29666666666662, -221.4022222222222, -234.8222222222221, -219.66111111111104, -206.5672222222221, -227.37944444444435, -224.5038888888889, -193.68222222222215, -239.4905555555554, -227.81388888888873, -239.41722222222205, -215.48833333333326, -209.8355555555554, -236.18166666666662, -238.04777777777772, -212.77222222222213, -204.755, -202.68777777777765, -213.5599999999998, -224.04944444444422, -237.70833333333331, -225.02388888888882, -235.92388888888874, -214.4149999999999, -218.15999999999994, -224.60333333333313, -225.1466666666666, -216.2333333333332, -223.45888888888885, -261.9722222222222, -228.25611111111107, -238.6694444444443, -210.30666666666656, -254.1461111111111, -211.23222222222213, -207.96277777777763, -232.46888888888876, -242.86333333333323, -242.24111111111094, -225.31499999999988, -248.95333333333323, -212.15222222222224, -222.70944444444436, -210.77111111111097, -256.0522222222221, -236.9844444444443, -224.31499999999983, -228.79555555555555, -208.8333333333333, -232.6205555555554, -232.29833333333323, -221.27277777777775, -232.89333333333317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1896230661345132, "mean_inference_ms": 1.7694379418543977, "mean_action_processing_ms": 0.07226704587767602, "mean_env_wait_ms": 1.1715642911358868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003974199295043945, "StateBufferConnector_ms": 0.0027780532836914062, "ViewRequirementAgentConnector_ms": 0.06310009956359863}, "num_episodes": 33, "episode_return_max": -193.68222222222215, "episode_return_min": -261.9722222222222, "episode_return_mean": -224.78624999999994, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24600, "num_agent_steps_trained": 24300, "num_env_steps_sampled": 24600, "num_env_steps_trained": 24300, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 305.4226359768034, "num_env_steps_trained_throughput_per_sec": 290.87870093028897, "timesteps_total": 24600, "num_env_steps_sampled_lifetime": 24600, "num_agent_steps_sampled_lifetime": 24600, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 24600, "timers": {"training_iteration_time_ms": 10259.946, "restore_workers_time_ms": 0.013, "training_step_time_ms": 492.257, "sample_time_ms": 477.473, "synch_weights_time_ms": 13.466}, "counters": {"num_env_steps_sampled": 24600, "num_env_steps_trained": 24300, "num_agent_steps_sampled": 24600, "num_agent_steps_trained": 24300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 164, "num_samples_added_to_queue": 24600}, "done": false, "training_iteration": 8, "trial_id": "0313d_00000", "date": "2024-10-10_21-42-46", "timestamp": 1728592966, "time_this_iter_s": 10.324678182601929, "time_total_s": 82.1654121875763, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a5f30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 82.1654121875763, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 10.846666666666668, "ram_util_percent": 48.88666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -207200.359375, "policy_loss": -207222.234375, "entropy": 29.816360473632812, "entropy_coeff": 0.01, "var_gnorm": 16.00596809387207, "vf_loss": 111333.828125, "vf_explained_var": 0.006662487983703613}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 92.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 27750, "num_env_steps_trained": 27600, "num_agent_steps_sampled": 27750, "num_agent_steps_trained": 27600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 185, "num_samples_added_to_queue": 27600, "learner_queue": {"size_count": 92, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 47.198, "learner_load_time_ms": 0.229, "learner_load_wait_time_ms": 931.198, "learner_dequeue_time_ms": 8024.803}}, "env_runners": {"episode_reward_max": -184.72666666666652, "episode_reward_min": -261.9722222222222, "episode_reward_mean": -223.90751666666662, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -261.9722222222222}, "policy_reward_max": {"default_policy": -184.72666666666652}, "policy_reward_mean": {"default_policy": -223.90751666666662}, "custom_metrics": {"num_consolidated_mean": 0.6761, "num_consolidated_min": 0.51, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0262, "num_overloaded_min": 0.88, "num_overloaded_max": 1.15, "num_moves_mean": 9.985899999999999, "num_moves_min": 9.55, "num_moves_max": 10.35, "mean_accuracy_mean": 41.105509999999995, "mean_accuracy_min": 40.82766666666666, "mean_accuracy_max": 41.35333333333333, "num_model_switches_mean": 6.0153, "num_model_switches_min": 5.41, "num_model_switches_max": 6.39, "num_slav_mean": 0.16337616666666666, "num_slav_min": 0.13568333333333332, "num_slav_max": 0.19096666666666667, "mean_cluster_cpu_util_mean": 0.5687798069869296, "mean_cluster_cpu_util_min": 0.545550970889336, "mean_cluster_cpu_util_max": 0.5943715671669871, "mean_cluster_mem_util_mean": 0.36532315695413176, "mean_cluster_mem_util_min": 0.35495474540026983, "mean_cluster_mem_util_max": 0.3754539436766268, "reward_consolidation_mean_mean": 0.17069444444444443, "reward_consolidation_mean_min": 0.06944444444444443, "reward_consolidation_mean_max": 0.3194444444444444, "reward_illegal_mean_mean": -1.710333333333333, "reward_illegal_mean_min": -1.9166666666666663, "reward_illegal_mean_max": -1.466666666666666, "reward_accuracy_mean_mean": 0.42227483333333327, "reward_accuracy_mean_min": 0.20423333333333332, "reward_accuracy_mean_max": 0.6923666666666667, "reward_sla_mean_mean": -1.121711111111111, "reward_sla_mean_min": -1.8427777777777774, "reward_sla_mean_max": -0.5172222222222221, "reward_consolidation_sum_mean": 17.069444444444443, "reward_consolidation_sum_min": 6.944444444444444, "reward_consolidation_sum_max": 31.944444444444443, "reward_illegal_sum_mean": -171.03333333333325, "reward_illegal_sum_min": -191.66666666666663, "reward_illegal_sum_max": -146.6666666666666, "reward_accuracy_sum_mean": 42.22748333333334, "reward_accuracy_sum_min": 20.423333333333332, "reward_accuracy_sum_max": 69.23666666666666, "reward_sla_sum_mean": -112.17111111111109, "reward_sla_sum_min": -184.27777777777774, "reward_sla_sum_max": -51.722222222222214, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4291.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-217.8538888888889, -199.92777777777766, -215.44555555555544, -196.25222222222206, -206.2722222222221, -220.7366666666666, -205.0355555555556, -223.8272222222222, -205.5566666666665, -227.1544444444443, -207.62777777777777, -236.22333333333313, -241.11722222222198, -243.74944444444435, -214.90499999999992, -221.41388888888883, -251.0816666666665, -219.29666666666662, -221.4022222222222, -234.8222222222221, -219.66111111111104, -206.5672222222221, -227.37944444444435, -224.5038888888889, -193.68222222222215, -239.4905555555554, -227.81388888888873, -239.41722222222205, -215.48833333333326, -209.8355555555554, -236.18166666666662, -238.04777777777772, -212.77222222222213, -204.755, -202.68777777777765, -213.5599999999998, -224.04944444444422, -237.70833333333331, -225.02388888888882, -235.92388888888874, -214.4149999999999, -218.15999999999994, -224.60333333333313, -225.1466666666666, -216.2333333333332, -223.45888888888885, -261.9722222222222, -228.25611111111107, -238.6694444444443, -210.30666666666656, -254.1461111111111, -211.23222222222213, -207.96277777777763, -232.46888888888876, -242.86333333333323, -242.24111111111094, -225.31499999999988, -248.95333333333323, -212.15222222222224, -222.70944444444436, -210.77111111111097, -256.0522222222221, -236.9844444444443, -224.31499999999983, -228.79555555555555, -208.8333333333333, -232.6205555555554, -232.29833333333323, -221.27277777777775, -232.89333333333317, -226.2805555555555, -217.53166666666655, -220.86277777777767, -241.02611111111094, -228.49499999999972, -250.9072222222221, -209.64055555555558, -229.28999999999988, -208.5211111111109, -225.9477777777776, -218.8983333333333, -215.4255555555553, -247.2866666666667, -184.72666666666652, -240.27444444444438, -211.26388888888874, -237.11833333333325, -202.54888888888888, -210.31666666666672, -207.97777777777762, -222.37888888888884, -218.37555555555537, -217.24722222222204, -229.44055555555542, -232.98833333333326, -229.3272222222221, -244.14777777777763, -211.98999999999987, -233.07444444444448, -227.0877777777776], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-217.8538888888889, -199.92777777777766, -215.44555555555544, -196.25222222222206, -206.2722222222221, -220.7366666666666, -205.0355555555556, -223.8272222222222, -205.5566666666665, -227.1544444444443, -207.62777777777777, -236.22333333333313, -241.11722222222198, -243.74944444444435, -214.90499999999992, -221.41388888888883, -251.0816666666665, -219.29666666666662, -221.4022222222222, -234.8222222222221, -219.66111111111104, -206.5672222222221, -227.37944444444435, -224.5038888888889, -193.68222222222215, -239.4905555555554, -227.81388888888873, -239.41722222222205, -215.48833333333326, -209.8355555555554, -236.18166666666662, -238.04777777777772, -212.77222222222213, -204.755, -202.68777777777765, -213.5599999999998, -224.04944444444422, -237.70833333333331, -225.02388888888882, -235.92388888888874, -214.4149999999999, -218.15999999999994, -224.60333333333313, -225.1466666666666, -216.2333333333332, -223.45888888888885, -261.9722222222222, -228.25611111111107, -238.6694444444443, -210.30666666666656, -254.1461111111111, -211.23222222222213, -207.96277777777763, -232.46888888888876, -242.86333333333323, -242.24111111111094, -225.31499999999988, -248.95333333333323, -212.15222222222224, -222.70944444444436, -210.77111111111097, -256.0522222222221, -236.9844444444443, -224.31499999999983, -228.79555555555555, -208.8333333333333, -232.6205555555554, -232.29833333333323, -221.27277777777775, -232.89333333333317, -226.2805555555555, -217.53166666666655, -220.86277777777767, -241.02611111111094, -228.49499999999972, -250.9072222222221, -209.64055555555558, -229.28999999999988, -208.5211111111109, -225.9477777777776, -218.8983333333333, -215.4255555555553, -247.2866666666667, -184.72666666666652, -240.27444444444438, -211.26388888888874, -237.11833333333325, -202.54888888888888, -210.31666666666672, -207.97777777777762, -222.37888888888884, -218.37555555555537, -217.24722222222204, -229.44055555555542, -232.98833333333326, -229.3272222222221, -244.14777777777763, -211.98999999999987, -233.07444444444448, -227.0877777777776]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18918326209707467, "mean_inference_ms": 1.7671235006495516, "mean_action_processing_ms": 0.07213190398303441, "mean_env_wait_ms": 1.1714199839226922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003898143768310547, "StateBufferConnector_ms": 0.002743244171142578, "ViewRequirementAgentConnector_ms": 0.06192803382873535}, "num_episodes": 30, "episode_return_max": -184.72666666666652, "episode_return_min": -261.9722222222222, "episode_return_mean": -223.90751666666662, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27750, "num_agent_steps_trained": 27600, "num_env_steps_sampled": 27750, "num_env_steps_trained": 27600, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 305.8416613787371, "num_env_steps_trained_throughput_per_sec": 320.4055500158198, "timesteps_total": 27750, "num_env_steps_sampled_lifetime": 27750, "num_agent_steps_sampled_lifetime": 27750, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 27750, "timers": {"training_iteration_time_ms": 10264.336, "restore_workers_time_ms": 0.014, "training_step_time_ms": 496.496, "sample_time_ms": 482.14, "synch_weights_time_ms": 13.115}, "counters": {"num_env_steps_sampled": 27750, "num_env_steps_trained": 27600, "num_agent_steps_sampled": 27750, "num_agent_steps_trained": 27600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 185, "num_samples_added_to_queue": 27600}, "done": false, "training_iteration": 9, "trial_id": "0313d_00000", "date": "2024-10-10_21-42-56", "timestamp": 1728592976, "time_this_iter_s": 10.316980838775635, "time_total_s": 92.48239302635193, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a4730>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 92.48239302635193, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 10.413333333333334, "ram_util_percent": 48.70666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -209991.6875, "policy_loss": -210016.390625, "entropy": 29.816301345825195, "entropy_coeff": 0.01, "var_gnorm": 16.006128311157227, "vf_loss": 114158.46875, "vf_explained_var": 0.0069751739501953125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 102.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 30750, "num_env_steps_trained": 30600, "num_agent_steps_sampled": 30750, "num_agent_steps_trained": 30600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 205, "num_samples_added_to_queue": 30600, "learner_queue": {"size_count": 102, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 49.171, "learner_load_time_ms": 0.223, "learner_load_wait_time_ms": 977.112, "learner_dequeue_time_ms": 8034.57}}, "env_runners": {"episode_reward_max": -184.72666666666652, "episode_reward_min": -263.42611111111097, "episode_reward_mean": -225.46153888888878, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -263.42611111111097}, "policy_reward_max": {"default_policy": -184.72666666666652}, "policy_reward_mean": {"default_policy": -225.46153888888878}, "custom_metrics": {"num_consolidated_mean": 0.6753000000000001, "num_consolidated_min": 0.51, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0323, "num_overloaded_min": 0.88, "num_overloaded_max": 1.16, "num_moves_mean": 10.0025, "num_moves_min": 9.55, "num_moves_max": 10.35, "mean_accuracy_mean": 41.109183333333334, "mean_accuracy_min": 40.82766666666666, "mean_accuracy_max": 41.35333333333333, "num_model_switches_mean": 6.0108000000000015, "num_model_switches_min": 5.41, "num_model_switches_max": 6.39, "num_slav_mean": 0.16290766666666667, "num_slav_min": 0.13568333333333332, "num_slav_max": 0.19096666666666667, "mean_cluster_cpu_util_mean": 0.5694694084602175, "mean_cluster_cpu_util_min": 0.5514215076902137, "mean_cluster_cpu_util_max": 0.5943715671669871, "mean_cluster_mem_util_mean": 0.3656559032334452, "mean_cluster_mem_util_min": 0.3563396317704296, "mean_cluster_mem_util_max": 0.3754539436766268, "reward_consolidation_mean_mean": 0.17027777777777778, "reward_consolidation_mean_min": 0.06944444444444443, "reward_consolidation_mean_max": 0.3194444444444444, "reward_illegal_mean_mean": -1.7205, "reward_illegal_mean_min": -1.9333333333333327, "reward_illegal_mean_max": -1.466666666666666, "reward_accuracy_mean_mean": 0.4186901666666667, "reward_accuracy_mean_min": 0.20423333333333332, "reward_accuracy_mean_max": 0.6923666666666667, "reward_sla_mean_mean": -1.1230833333333332, "reward_sla_mean_min": -1.8427777777777774, "reward_sla_mean_max": -0.5172222222222221, "reward_consolidation_sum_mean": 17.02777777777778, "reward_consolidation_sum_min": 6.944444444444444, "reward_consolidation_sum_max": 31.944444444444443, "reward_illegal_sum_mean": -172.04999999999993, "reward_illegal_sum_min": -193.33333333333326, "reward_illegal_sum_max": -146.6666666666666, "reward_accuracy_sum_mean": 41.86901666666667, "reward_accuracy_sum_min": 20.423333333333332, "reward_accuracy_sum_max": 69.23666666666666, "reward_sla_sum_mean": -112.30833333333335, "reward_sla_sum_min": -184.27777777777774, "reward_sla_sum_max": -51.722222222222214, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2951.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-236.18166666666662, -238.04777777777772, -212.77222222222213, -204.755, -202.68777777777765, -213.5599999999998, -224.04944444444422, -237.70833333333331, -225.02388888888882, -235.92388888888874, -214.4149999999999, -218.15999999999994, -224.60333333333313, -225.1466666666666, -216.2333333333332, -223.45888888888885, -261.9722222222222, -228.25611111111107, -238.6694444444443, -210.30666666666656, -254.1461111111111, -211.23222222222213, -207.96277777777763, -232.46888888888876, -242.86333333333323, -242.24111111111094, -225.31499999999988, -248.95333333333323, -212.15222222222224, -222.70944444444436, -210.77111111111097, -256.0522222222221, -236.9844444444443, -224.31499999999983, -228.79555555555555, -208.8333333333333, -232.6205555555554, -232.29833333333323, -221.27277777777775, -232.89333333333317, -226.2805555555555, -217.53166666666655, -220.86277777777767, -241.02611111111094, -228.49499999999972, -250.9072222222221, -209.64055555555558, -229.28999999999988, -208.5211111111109, -225.9477777777776, -218.8983333333333, -215.4255555555553, -247.2866666666667, -184.72666666666652, -240.27444444444438, -211.26388888888874, -237.11833333333325, -202.54888888888888, -210.31666666666672, -207.97777777777762, -222.37888888888884, -218.37555555555537, -217.24722222222204, -229.44055555555542, -232.98833333333326, -229.3272222222221, -244.14777777777763, -211.98999999999987, -233.07444444444448, -227.0877777777776, -238.2177777777778, -202.54111111111115, -211.65999999999994, -238.25277777777765, -204.15999999999985, -197.50166666666652, -223.2733333333332, -227.69999999999982, -219.98055555555553, -208.356111111111, -231.2972222222222, -220.67611111111103, -218.47888888888883, -234.27111111111103, -231.02555555555537, -228.28833333333324, -231.476111111111, -244.81222222222218, -238.5572222222221, -232.3238888888888, -232.76611111111097, -236.23444444444442, -224.63611111111115, -217.15222222222218, -219.3755555555554, -217.36888888888876, -263.42611111111097, -211.81, -220.47333333333324, -242.85055555555553], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-236.18166666666662, -238.04777777777772, -212.77222222222213, -204.755, -202.68777777777765, -213.5599999999998, -224.04944444444422, -237.70833333333331, -225.02388888888882, -235.92388888888874, -214.4149999999999, -218.15999999999994, -224.60333333333313, -225.1466666666666, -216.2333333333332, -223.45888888888885, -261.9722222222222, -228.25611111111107, -238.6694444444443, -210.30666666666656, -254.1461111111111, -211.23222222222213, -207.96277777777763, -232.46888888888876, -242.86333333333323, -242.24111111111094, -225.31499999999988, -248.95333333333323, -212.15222222222224, -222.70944444444436, -210.77111111111097, -256.0522222222221, -236.9844444444443, -224.31499999999983, -228.79555555555555, -208.8333333333333, -232.6205555555554, -232.29833333333323, -221.27277777777775, -232.89333333333317, -226.2805555555555, -217.53166666666655, -220.86277777777767, -241.02611111111094, -228.49499999999972, -250.9072222222221, -209.64055555555558, -229.28999999999988, -208.5211111111109, -225.9477777777776, -218.8983333333333, -215.4255555555553, -247.2866666666667, -184.72666666666652, -240.27444444444438, -211.26388888888874, -237.11833333333325, -202.54888888888888, -210.31666666666672, -207.97777777777762, -222.37888888888884, -218.37555555555537, -217.24722222222204, -229.44055555555542, -232.98833333333326, -229.3272222222221, -244.14777777777763, -211.98999999999987, -233.07444444444448, -227.0877777777776, -238.2177777777778, -202.54111111111115, -211.65999999999994, -238.25277777777765, -204.15999999999985, -197.50166666666652, -223.2733333333332, -227.69999999999982, -219.98055555555553, -208.356111111111, -231.2972222222222, -220.67611111111103, -218.47888888888883, -234.27111111111103, -231.02555555555537, -228.28833333333324, -231.476111111111, -244.81222222222218, -238.5572222222221, -232.3238888888888, -232.76611111111097, -236.23444444444442, -224.63611111111115, -217.15222222222218, -219.3755555555554, -217.36888888888876, -263.42611111111097, -211.81, -220.47333333333324, -242.85055555555553]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18902193136602757, "mean_inference_ms": 1.7652469005766642, "mean_action_processing_ms": 0.07206416639948232, "mean_env_wait_ms": 1.1717083297976805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004014253616333008, "StateBufferConnector_ms": 0.0027801990509033203, "ViewRequirementAgentConnector_ms": 0.06236839294433594}, "num_episodes": 30, "episode_return_max": -184.72666666666652, "episode_return_min": -263.42611111111097, "episode_return_mean": -225.46153888888878, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30750, "num_agent_steps_trained": 30600, "num_env_steps_sampled": 30750, "num_env_steps_trained": 30600, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 291.9767892724058, "num_env_steps_trained_throughput_per_sec": 291.9767892724058, "timesteps_total": 30750, "num_env_steps_sampled_lifetime": 30750, "num_agent_steps_sampled_lifetime": 30750, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 30750, "timers": {"training_iteration_time_ms": 10265.382, "restore_workers_time_ms": 0.013, "training_step_time_ms": 531.607, "sample_time_ms": 517.493, "synch_weights_time_ms": 12.877}, "counters": {"num_env_steps_sampled": 30750, "num_env_steps_trained": 30600, "num_agent_steps_sampled": 30750, "num_agent_steps_trained": 30600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 205, "num_samples_added_to_queue": 30600}, "done": false, "training_iteration": 10, "trial_id": "0313d_00000", "date": "2024-10-10_21-43-07", "timestamp": 1728592987, "time_this_iter_s": 10.287841558456421, "time_total_s": 102.77023458480835, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d88730>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 102.77023458480835, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 10.9, "ram_util_percent": 48.92142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -214005.234375, "policy_loss": -214034.375, "entropy": 29.816057205200195, "entropy_coeff": 0.01, "var_gnorm": 16.00670051574707, "vf_loss": 118598.375, "vf_explained_var": 0.007499337196350098}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 111.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 33450, "num_env_steps_trained": 33300, "num_agent_steps_sampled": 33450, "num_agent_steps_trained": 33300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 223, "num_samples_added_to_queue": 33300, "learner_queue": {"size_count": 111, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.692, "learner_load_time_ms": 0.202, "learner_load_wait_time_ms": 1077.132, "learner_dequeue_time_ms": 8129.036}}, "env_runners": {"episode_reward_max": -184.72666666666652, "episode_reward_min": -263.42611111111097, "episode_reward_mean": -223.69826666666654, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -263.42611111111097}, "policy_reward_max": {"default_policy": -184.72666666666652}, "policy_reward_mean": {"default_policy": -223.69826666666654}, "custom_metrics": {"num_consolidated_mean": 0.6644, "num_consolidated_min": 0.51, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0348, "num_overloaded_min": 0.88, "num_overloaded_max": 1.16, "num_moves_mean": 9.996499999999997, "num_moves_min": 9.67, "num_moves_max": 10.35, "mean_accuracy_mean": 41.10018999999999, "mean_accuracy_min": 40.82766666666666, "mean_accuracy_max": 41.35333333333333, "num_model_switches_mean": 6.014000000000002, "num_model_switches_min": 5.41, "num_model_switches_max": 6.34, "num_slav_mean": 0.16154783333333333, "num_slav_min": 0.13568333333333332, "num_slav_max": 0.19096666666666667, "mean_cluster_cpu_util_mean": 0.568198983477103, "mean_cluster_cpu_util_min": 0.5514215076902137, "mean_cluster_cpu_util_max": 0.5887977100504465, "mean_cluster_mem_util_mean": 0.36496232602830164, "mean_cluster_mem_util_min": 0.3563396317704296, "mean_cluster_mem_util_max": 0.37448467234995264, "reward_consolidation_mean_mean": 0.16902777777777778, "reward_consolidation_mean_min": 0.013888888888888888, "reward_consolidation_mean_max": 0.3194444444444444, "reward_illegal_mean_mean": -1.7246666666666663, "reward_illegal_mean_min": -1.9333333333333327, "reward_illegal_mean_max": -1.466666666666666, "reward_accuracy_mean_mean": 0.41285066666666664, "reward_accuracy_mean_min": 0.20423333333333332, "reward_accuracy_mean_max": 0.6923666666666667, "reward_sla_mean_mean": -1.0941944444444445, "reward_sla_mean_min": -1.8427777777777774, "reward_sla_mean_max": -0.5172222222222221, "reward_consolidation_sum_mean": 16.90277777777778, "reward_consolidation_sum_min": 1.3888888888888888, "reward_consolidation_sum_max": 31.944444444444443, "reward_illegal_sum_mean": -172.4666666666666, "reward_illegal_sum_min": -193.33333333333326, "reward_illegal_sum_max": -146.6666666666666, "reward_accuracy_sum_mean": 41.28506666666667, "reward_accuracy_sum_min": 20.423333333333332, "reward_accuracy_sum_max": 69.23666666666666, "reward_sla_sum_mean": -109.41944444444445, "reward_sla_sum_min": -184.27777777777774, "reward_sla_sum_max": -51.722222222222214, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2195.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-248.95333333333323, -212.15222222222224, -222.70944444444436, -210.77111111111097, -256.0522222222221, -236.9844444444443, -224.31499999999983, -228.79555555555555, -208.8333333333333, -232.6205555555554, -232.29833333333323, -221.27277777777775, -232.89333333333317, -226.2805555555555, -217.53166666666655, -220.86277777777767, -241.02611111111094, -228.49499999999972, -250.9072222222221, -209.64055555555558, -229.28999999999988, -208.5211111111109, -225.9477777777776, -218.8983333333333, -215.4255555555553, -247.2866666666667, -184.72666666666652, -240.27444444444438, -211.26388888888874, -237.11833333333325, -202.54888888888888, -210.31666666666672, -207.97777777777762, -222.37888888888884, -218.37555555555537, -217.24722222222204, -229.44055555555542, -232.98833333333326, -229.3272222222221, -244.14777777777763, -211.98999999999987, -233.07444444444448, -227.0877777777776, -238.2177777777778, -202.54111111111115, -211.65999999999994, -238.25277777777765, -204.15999999999985, -197.50166666666652, -223.2733333333332, -227.69999999999982, -219.98055555555553, -208.356111111111, -231.2972222222222, -220.67611111111103, -218.47888888888883, -234.27111111111103, -231.02555555555537, -228.28833333333324, -231.476111111111, -244.81222222222218, -238.5572222222221, -232.3238888888888, -232.76611111111097, -236.23444444444442, -224.63611111111115, -217.15222222222218, -219.3755555555554, -217.36888888888876, -263.42611111111097, -211.81, -220.47333333333324, -242.85055555555553, -214.92111111111103, -221.59944444444432, -239.1622222222221, -218.15611111111113, -239.60666666666648, -215.51611111111097, -205.0022222222221, -230.11166666666654, -231.3266666666666, -227.64277777777764, -215.7755555555554, -201.541111111111, -199.95277777777773, -215.7188888888888, -229.97222222222206, -225.94333333333316, -218.8394444444444, -218.37333333333328, -210.1938888888888, -222.81388888888878, -234.47777777777767, -226.2999999999999, -219.4222222222222, -209.51777777777764, -209.056111111111, -204.85277777777776, -226.0377777777776], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-248.95333333333323, -212.15222222222224, -222.70944444444436, -210.77111111111097, -256.0522222222221, -236.9844444444443, -224.31499999999983, -228.79555555555555, -208.8333333333333, -232.6205555555554, -232.29833333333323, -221.27277777777775, -232.89333333333317, -226.2805555555555, -217.53166666666655, -220.86277777777767, -241.02611111111094, -228.49499999999972, -250.9072222222221, -209.64055555555558, -229.28999999999988, -208.5211111111109, -225.9477777777776, -218.8983333333333, -215.4255555555553, -247.2866666666667, -184.72666666666652, -240.27444444444438, -211.26388888888874, -237.11833333333325, -202.54888888888888, -210.31666666666672, -207.97777777777762, -222.37888888888884, -218.37555555555537, -217.24722222222204, -229.44055555555542, -232.98833333333326, -229.3272222222221, -244.14777777777763, -211.98999999999987, -233.07444444444448, -227.0877777777776, -238.2177777777778, -202.54111111111115, -211.65999999999994, -238.25277777777765, -204.15999999999985, -197.50166666666652, -223.2733333333332, -227.69999999999982, -219.98055555555553, -208.356111111111, -231.2972222222222, -220.67611111111103, -218.47888888888883, -234.27111111111103, -231.02555555555537, -228.28833333333324, -231.476111111111, -244.81222222222218, -238.5572222222221, -232.3238888888888, -232.76611111111097, -236.23444444444442, -224.63611111111115, -217.15222222222218, -219.3755555555554, -217.36888888888876, -263.42611111111097, -211.81, -220.47333333333324, -242.85055555555553, -214.92111111111103, -221.59944444444432, -239.1622222222221, -218.15611111111113, -239.60666666666648, -215.51611111111097, -205.0022222222221, -230.11166666666654, -231.3266666666666, -227.64277777777764, -215.7755555555554, -201.541111111111, -199.95277777777773, -215.7188888888888, -229.97222222222206, -225.94333333333316, -218.8394444444444, -218.37333333333328, -210.1938888888888, -222.81388888888878, -234.47777777777767, -226.2999999999999, -219.4222222222222, -209.51777777777764, -209.056111111111, -204.85277777777776, -226.0377777777776]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18944951962359424, "mean_inference_ms": 1.7675616450403233, "mean_action_processing_ms": 0.07223005404492946, "mean_env_wait_ms": 1.1748476306782731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046350955963134766, "StateBufferConnector_ms": 0.0028536319732666016, "ViewRequirementAgentConnector_ms": 0.06470632553100586}, "num_episodes": 27, "episode_return_max": -184.72666666666652, "episode_return_min": -263.42611111111097, "episode_return_mean": -223.69826666666654, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33450, "num_agent_steps_trained": 33300, "num_env_steps_sampled": 33450, "num_env_steps_trained": 33300, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 262.7837994732592, "num_env_steps_trained_throughput_per_sec": 262.7837994732592, "timesteps_total": 33450, "num_env_steps_sampled_lifetime": 33450, "num_agent_steps_sampled_lifetime": 33450, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 33450, "timers": {"training_iteration_time_ms": 10285.122, "restore_workers_time_ms": 0.012, "training_step_time_ms": 548.317, "sample_time_ms": 533.694, "synch_weights_time_ms": 13.177}, "counters": {"num_env_steps_sampled": 33450, "num_env_steps_trained": 33300, "num_agent_steps_sampled": 33450, "num_agent_steps_trained": 33300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 223, "num_samples_added_to_queue": 33300}, "done": false, "training_iteration": 11, "trial_id": "0313d_00000", "date": "2024-10-10_21-43-17", "timestamp": 1728592997, "time_this_iter_s": 10.293863296508789, "time_total_s": 113.06409788131714, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d88a00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 113.06409788131714, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 14.860000000000001, "ram_util_percent": 49.86}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -213852.59375, "policy_loss": -213880.65625, "entropy": 29.815624237060547, "entropy_coeff": 0.01, "var_gnorm": 16.007579803466797, "vf_loss": 117508.671875, "vf_explained_var": 0.008674204349517822}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 120.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 36300, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36300, "num_agent_steps_trained": 36000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 242, "num_samples_added_to_queue": 36300, "learner_queue": {"size_count": 120, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.74, "learner_load_time_ms": 0.232, "learner_load_wait_time_ms": 1030.094, "learner_dequeue_time_ms": 8346.48}}, "env_runners": {"episode_reward_max": -175.76611111111112, "episode_reward_min": -263.42611111111097, "episode_reward_mean": -221.2914944444443, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -263.42611111111097}, "policy_reward_max": {"default_policy": -175.76611111111112}, "policy_reward_mean": {"default_policy": -221.2914944444443}, "custom_metrics": {"num_consolidated_mean": 0.6642, "num_consolidated_min": 0.55, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0393000000000001, "num_overloaded_min": 0.87, "num_overloaded_max": 1.19, "num_moves_mean": 10.0068, "num_moves_min": 9.68, "num_moves_max": 10.35, "mean_accuracy_mean": 41.083596666666665, "mean_accuracy_min": 40.859333333333325, "mean_accuracy_max": 41.25200000000001, "num_model_switches_mean": 6.032300000000001, "num_model_switches_min": 5.62, "num_model_switches_max": 6.39, "num_slav_mean": 0.16064766666666666, "num_slav_min": 0.13875, "num_slav_max": 0.18248333333333328, "mean_cluster_cpu_util_mean": 0.5679733583353695, "mean_cluster_cpu_util_min": 0.5427902653558973, "mean_cluster_cpu_util_max": 0.5887977100504465, "mean_cluster_mem_util_mean": 0.364857196936264, "mean_cluster_mem_util_min": 0.35487744356181294, "mean_cluster_mem_util_max": 0.37482639696173836, "reward_consolidation_mean_mean": 0.16555555555555554, "reward_consolidation_mean_min": 0.013888888888888888, "reward_consolidation_mean_max": 0.3055555555555555, "reward_illegal_mean_mean": -1.7321666666666664, "reward_illegal_mean_min": -1.9833333333333332, "reward_illegal_mean_max": -1.4499999999999995, "reward_accuracy_mean_mean": 0.39997949999999993, "reward_accuracy_mean_min": 0.22351666666666667, "reward_accuracy_mean_max": 0.6184000000000001, "reward_sla_mean_mean": -1.0462833333333335, "reward_sla_mean_min": -1.6861111111111111, "reward_sla_mean_max": -0.52, "reward_consolidation_sum_mean": 16.555555555555554, "reward_consolidation_sum_min": 1.3888888888888888, "reward_consolidation_sum_max": 30.555555555555554, "reward_illegal_sum_mean": -173.2166666666666, "reward_illegal_sum_min": -198.33333333333331, "reward_illegal_sum_max": -144.99999999999994, "reward_accuracy_sum_mean": 39.99795, "reward_accuracy_sum_min": 22.351666666666667, "reward_accuracy_sum_max": 61.84, "reward_sla_sum_mean": -104.62833333333332, "reward_sla_sum_min": -168.61111111111111, "reward_sla_sum_max": -52.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2657.0, "global_timestep_min": 500, "global_timestep_max": 4300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-202.54888888888888, -210.31666666666672, -207.97777777777762, -222.37888888888884, -218.37555555555537, -217.24722222222204, -229.44055555555542, -232.98833333333326, -229.3272222222221, -244.14777777777763, -211.98999999999987, -233.07444444444448, -227.0877777777776, -238.2177777777778, -202.54111111111115, -211.65999999999994, -238.25277777777765, -204.15999999999985, -197.50166666666652, -223.2733333333332, -227.69999999999982, -219.98055555555553, -208.356111111111, -231.2972222222222, -220.67611111111103, -218.47888888888883, -234.27111111111103, -231.02555555555537, -228.28833333333324, -231.476111111111, -244.81222222222218, -238.5572222222221, -232.3238888888888, -232.76611111111097, -236.23444444444442, -224.63611111111115, -217.15222222222218, -219.3755555555554, -217.36888888888876, -263.42611111111097, -211.81, -220.47333333333324, -242.85055555555553, -214.92111111111103, -221.59944444444432, -239.1622222222221, -218.15611111111113, -239.60666666666648, -215.51611111111097, -205.0022222222221, -230.11166666666654, -231.3266666666666, -227.64277777777764, -215.7755555555554, -201.541111111111, -199.95277777777773, -215.7188888888888, -229.97222222222206, -225.94333333333316, -218.8394444444444, -218.37333333333328, -210.1938888888888, -222.81388888888878, -234.47777777777767, -226.2999999999999, -219.4222222222222, -209.51777777777764, -209.056111111111, -204.85277777777776, -226.0377777777776, -221.6977777777777, -235.24999999999994, -226.6288888888887, -205.89944444444433, -175.76611111111112, -204.95722222222219, -222.69888888888886, -222.69444444444443, -227.89333333333323, -235.16666666666663, -228.1505555555554, -223.04722222222213, -199.2116666666665, -212.06388888888884, -221.0372222222221, -201.5927777777777, -214.35222222222217, -213.95611111111103, -217.2883333333333, -210.0283333333332, -251.79222222222205, -223.9155555555555, -223.7949999999999, -240.83833333333334, -197.4511111111109, -248.69222222222194, -222.40888888888884, -221.74722222222212, -199.2599999999999, -192.1894444444444], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-202.54888888888888, -210.31666666666672, -207.97777777777762, -222.37888888888884, -218.37555555555537, -217.24722222222204, -229.44055555555542, -232.98833333333326, -229.3272222222221, -244.14777777777763, -211.98999999999987, -233.07444444444448, -227.0877777777776, -238.2177777777778, -202.54111111111115, -211.65999999999994, -238.25277777777765, -204.15999999999985, -197.50166666666652, -223.2733333333332, -227.69999999999982, -219.98055555555553, -208.356111111111, -231.2972222222222, -220.67611111111103, -218.47888888888883, -234.27111111111103, -231.02555555555537, -228.28833333333324, -231.476111111111, -244.81222222222218, -238.5572222222221, -232.3238888888888, -232.76611111111097, -236.23444444444442, -224.63611111111115, -217.15222222222218, -219.3755555555554, -217.36888888888876, -263.42611111111097, -211.81, -220.47333333333324, -242.85055555555553, -214.92111111111103, -221.59944444444432, -239.1622222222221, -218.15611111111113, -239.60666666666648, -215.51611111111097, -205.0022222222221, -230.11166666666654, -231.3266666666666, -227.64277777777764, -215.7755555555554, -201.541111111111, -199.95277777777773, -215.7188888888888, -229.97222222222206, -225.94333333333316, -218.8394444444444, -218.37333333333328, -210.1938888888888, -222.81388888888878, -234.47777777777767, -226.2999999999999, -219.4222222222222, -209.51777777777764, -209.056111111111, -204.85277777777776, -226.0377777777776, -221.6977777777777, -235.24999999999994, -226.6288888888887, -205.89944444444433, -175.76611111111112, -204.95722222222219, -222.69888888888886, -222.69444444444443, -227.89333333333323, -235.16666666666663, -228.1505555555554, -223.04722222222213, -199.2116666666665, -212.06388888888884, -221.0372222222221, -201.5927777777777, -214.35222222222217, -213.95611111111103, -217.2883333333333, -210.0283333333332, -251.79222222222205, -223.9155555555555, -223.7949999999999, -240.83833333333334, -197.4511111111109, -248.69222222222194, -222.40888888888884, -221.74722222222212, -199.2599999999999, -192.1894444444444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19047373675339074, "mean_inference_ms": 1.7783050615914624, "mean_action_processing_ms": 0.07262224302325486, "mean_env_wait_ms": 1.1810878443776787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048980712890625, "StateBufferConnector_ms": 0.002987384796142578, "ViewRequirementAgentConnector_ms": 0.06803750991821289}, "num_episodes": 30, "episode_return_max": -175.76611111111112, "episode_return_min": -263.42611111111097, "episode_return_mean": -221.2914944444443, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36300, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36300, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 277.14754653203255, "num_env_steps_trained_throughput_per_sec": 262.56083355666243, "timesteps_total": 36300, "num_env_steps_sampled_lifetime": 36300, "num_agent_steps_sampled_lifetime": 36300, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 36300, "timers": {"training_iteration_time_ms": 10300.009, "restore_workers_time_ms": 0.012, "training_step_time_ms": 522.168, "sample_time_ms": 507.338, "synch_weights_time_ms": 13.51}, "counters": {"num_env_steps_sampled": 36300, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36300, "num_agent_steps_trained": 36000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 242, "num_samples_added_to_queue": 36300}, "done": false, "training_iteration": 12, "trial_id": "0313d_00000", "date": "2024-10-10_21-43-27", "timestamp": 1728593007, "time_this_iter_s": 10.292796850204468, "time_total_s": 123.3568947315216, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d8a3b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 123.3568947315216, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 13.673333333333334, "ram_util_percent": 50.58666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -210095.0625, "policy_loss": -210121.75, "entropy": 29.815513610839844, "entropy_coeff": 0.01, "var_gnorm": 16.008197784423828, "vf_loss": 116135.1171875, "vf_explained_var": 0.008917629718780518}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 131.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 39450, "num_env_steps_trained": 39300, "num_agent_steps_sampled": 39450, "num_agent_steps_trained": 39300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 263, "num_samples_added_to_queue": 39300, "learner_queue": {"size_count": 131, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.973, "learner_load_time_ms": 0.207, "learner_load_wait_time_ms": 934.105, "learner_dequeue_time_ms": 8224.426}}, "env_runners": {"episode_reward_max": -175.76611111111112, "episode_reward_min": -263.42611111111097, "episode_reward_mean": -220.85802222222216, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -263.42611111111097}, "policy_reward_max": {"default_policy": -175.76611111111112}, "policy_reward_mean": {"default_policy": -220.85802222222216}, "custom_metrics": {"num_consolidated_mean": 0.6556000000000001, "num_consolidated_min": 0.53, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0399, "num_overloaded_min": 0.87, "num_overloaded_max": 1.19, "num_moves_mean": 9.998000000000001, "num_moves_min": 9.68, "num_moves_max": 10.32, "mean_accuracy_mean": 41.08765, "mean_accuracy_min": 40.89099999999999, "mean_accuracy_max": 41.385, "num_model_switches_mean": 6.030100000000001, "num_model_switches_min": 5.52, "num_model_switches_max": 6.39, "num_slav_mean": 0.16026066666666666, "num_slav_min": 0.13875, "num_slav_max": 0.18248333333333328, "mean_cluster_cpu_util_mean": 0.5679138847187769, "mean_cluster_cpu_util_min": 0.5427902653558973, "mean_cluster_cpu_util_max": 0.5887977100504465, "mean_cluster_mem_util_mean": 0.3647079195962142, "mean_cluster_mem_util_min": 0.35487744356181294, "mean_cluster_mem_util_max": 0.37482639696173836, "reward_consolidation_mean_mean": 0.16444444444444442, "reward_consolidation_mean_min": 0.013888888888888888, "reward_consolidation_mean_max": 0.3055555555555555, "reward_illegal_mean_mean": -1.7331666666666665, "reward_illegal_mean_min": -1.9833333333333332, "reward_illegal_mean_max": -1.4499999999999995, "reward_accuracy_mean_mean": 0.4017086666666666, "reward_accuracy_mean_min": 0.22351666666666667, "reward_accuracy_mean_max": 0.5545333333333333, "reward_sla_mean_mean": -1.0415666666666668, "reward_sla_mean_min": -1.643333333333333, "reward_sla_mean_max": -0.52, "reward_consolidation_sum_mean": 16.444444444444443, "reward_consolidation_sum_min": 1.3888888888888888, "reward_consolidation_sum_max": 30.555555555555554, "reward_illegal_sum_mean": -173.3166666666667, "reward_illegal_sum_min": -198.33333333333331, "reward_illegal_sum_max": -144.99999999999994, "reward_accuracy_sum_mean": 40.17086666666667, "reward_accuracy_sum_min": 22.351666666666667, "reward_accuracy_sum_max": 55.45333333333333, "reward_sla_sum_mean": -104.15666666666667, "reward_sla_sum_min": -164.33333333333331, "reward_sla_sum_max": -52.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3657.0, "global_timestep_min": 1500, "global_timestep_max": 5300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-244.81222222222218, -238.5572222222221, -232.3238888888888, -232.76611111111097, -236.23444444444442, -224.63611111111115, -217.15222222222218, -219.3755555555554, -217.36888888888876, -263.42611111111097, -211.81, -220.47333333333324, -242.85055555555553, -214.92111111111103, -221.59944444444432, -239.1622222222221, -218.15611111111113, -239.60666666666648, -215.51611111111097, -205.0022222222221, -230.11166666666654, -231.3266666666666, -227.64277777777764, -215.7755555555554, -201.541111111111, -199.95277777777773, -215.7188888888888, -229.97222222222206, -225.94333333333316, -218.8394444444444, -218.37333333333328, -210.1938888888888, -222.81388888888878, -234.47777777777767, -226.2999999999999, -219.4222222222222, -209.51777777777764, -209.056111111111, -204.85277777777776, -226.0377777777776, -221.6977777777777, -235.24999999999994, -226.6288888888887, -205.89944444444433, -175.76611111111112, -204.95722222222219, -222.69888888888886, -222.69444444444443, -227.89333333333323, -235.16666666666663, -228.1505555555554, -223.04722222222213, -199.2116666666665, -212.06388888888884, -221.0372222222221, -201.5927777777777, -214.35222222222217, -213.95611111111103, -217.2883333333333, -210.0283333333332, -251.79222222222205, -223.9155555555555, -223.7949999999999, -240.83833333333334, -197.4511111111109, -248.69222222222194, -222.40888888888884, -221.74722222222212, -199.2599999999999, -192.1894444444444, -200.0099999999999, -225.8922222222221, -205.30611111111102, -236.16722222222202, -198.92833333333328, -220.16999999999993, -220.2305555555555, -239.22777777777773, -222.7744444444443, -201.93722222222215, -236.00333333333325, -209.01666666666657, -189.30777777777774, -227.77166666666648, -226.2094444444444, -202.68611111111107, -243.55111111111094, -229.3244444444443, -225.82777777777764, -234.4505555555555, -199.09277777777768, -207.78833333333324, -218.0477777777777, -241.8227777777776, -215.34666666666666, -240.98888888888882, -228.3116666666666, -225.98277777777764, -218.46111111111097, -220.07499999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-244.81222222222218, -238.5572222222221, -232.3238888888888, -232.76611111111097, -236.23444444444442, -224.63611111111115, -217.15222222222218, -219.3755555555554, -217.36888888888876, -263.42611111111097, -211.81, -220.47333333333324, -242.85055555555553, -214.92111111111103, -221.59944444444432, -239.1622222222221, -218.15611111111113, -239.60666666666648, -215.51611111111097, -205.0022222222221, -230.11166666666654, -231.3266666666666, -227.64277777777764, -215.7755555555554, -201.541111111111, -199.95277777777773, -215.7188888888888, -229.97222222222206, -225.94333333333316, -218.8394444444444, -218.37333333333328, -210.1938888888888, -222.81388888888878, -234.47777777777767, -226.2999999999999, -219.4222222222222, -209.51777777777764, -209.056111111111, -204.85277777777776, -226.0377777777776, -221.6977777777777, -235.24999999999994, -226.6288888888887, -205.89944444444433, -175.76611111111112, -204.95722222222219, -222.69888888888886, -222.69444444444443, -227.89333333333323, -235.16666666666663, -228.1505555555554, -223.04722222222213, -199.2116666666665, -212.06388888888884, -221.0372222222221, -201.5927777777777, -214.35222222222217, -213.95611111111103, -217.2883333333333, -210.0283333333332, -251.79222222222205, -223.9155555555555, -223.7949999999999, -240.83833333333334, -197.4511111111109, -248.69222222222194, -222.40888888888884, -221.74722222222212, -199.2599999999999, -192.1894444444444, -200.0099999999999, -225.8922222222221, -205.30611111111102, -236.16722222222202, -198.92833333333328, -220.16999999999993, -220.2305555555555, -239.22777777777773, -222.7744444444443, -201.93722222222215, -236.00333333333325, -209.01666666666657, -189.30777777777774, -227.77166666666648, -226.2094444444444, -202.68611111111107, -243.55111111111094, -229.3244444444443, -225.82777777777764, -234.4505555555555, -199.09277777777768, -207.78833333333324, -218.0477777777777, -241.8227777777776, -215.34666666666666, -240.98888888888882, -228.3116666666666, -225.98277777777764, -218.46111111111097, -220.07499999999996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1913163738332287, "mean_inference_ms": 1.7866783917231732, "mean_action_processing_ms": 0.0729589336131139, "mean_env_wait_ms": 1.1862258908902914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004839420318603516, "StateBufferConnector_ms": 0.0029723644256591797, "ViewRequirementAgentConnector_ms": 0.0677182674407959}, "num_episodes": 30, "episode_return_max": -175.76611111111112, "episode_return_min": -263.42611111111097, "episode_return_mean": -220.85802222222216, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39450, "num_agent_steps_trained": 39300, "num_env_steps_sampled": 39450, "num_env_steps_trained": 39300, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 302.8736351919474, "num_env_steps_trained_throughput_per_sec": 317.2961892487068, "timesteps_total": 39450, "num_env_steps_sampled_lifetime": 39450, "num_agent_steps_sampled_lifetime": 39450, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 39450, "timers": {"training_iteration_time_ms": 10290.655, "restore_workers_time_ms": 0.011, "training_step_time_ms": 495.038, "sample_time_ms": 480.21, "synch_weights_time_ms": 13.573}, "counters": {"num_env_steps_sampled": 39450, "num_env_steps_trained": 39300, "num_agent_steps_sampled": 39450, "num_agent_steps_trained": 39300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 263, "num_samples_added_to_queue": 39300}, "done": false, "training_iteration": 13, "trial_id": "0313d_00000", "date": "2024-10-10_21-43-38", "timestamp": 1728593018, "time_this_iter_s": 10.410089015960693, "time_total_s": 133.7669837474823, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42dca980>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 133.7669837474823, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 10.726666666666665, "ram_util_percent": 50.98}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -203454.4375, "policy_loss": -203471.96875, "entropy": 29.814964294433594, "entropy_coeff": 0.01, "var_gnorm": 16.009653091430664, "vf_loss": 106974.296875, "vf_explained_var": 0.010596394538879395}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 141.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 42450, "num_env_steps_trained": 42300, "num_agent_steps_sampled": 42450, "num_agent_steps_trained": 42300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 283, "num_samples_added_to_queue": 42300, "learner_queue": {"size_count": 141, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 46.381, "learner_load_time_ms": 0.202, "learner_load_wait_time_ms": 976.386, "learner_dequeue_time_ms": 8262.896}}, "env_runners": {"episode_reward_max": -175.76611111111112, "episode_reward_min": -251.79222222222205, "episode_reward_mean": -218.9510555555555, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -251.79222222222205}, "policy_reward_max": {"default_policy": -175.76611111111112}, "policy_reward_mean": {"default_policy": -218.9510555555555}, "custom_metrics": {"num_consolidated_mean": 0.6576, "num_consolidated_min": 0.51, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0329000000000002, "num_overloaded_min": 0.87, "num_overloaded_max": 1.19, "num_moves_mean": 9.9949, "num_moves_min": 9.68, "num_moves_max": 10.32, "mean_accuracy_mean": 41.07606, "mean_accuracy_min": 40.87199999999999, "mean_accuracy_max": 41.385, "num_model_switches_mean": 6.0182, "num_model_switches_min": 5.52, "num_model_switches_max": 6.39, "num_slav_mean": 0.15933350000000002, "num_slav_min": 0.13875, "num_slav_max": 0.18248333333333328, "mean_cluster_cpu_util_mean": 0.5676456919100752, "mean_cluster_cpu_util_min": 0.5427902653558973, "mean_cluster_cpu_util_max": 0.5884079666755023, "mean_cluster_mem_util_mean": 0.3646839132814517, "mean_cluster_mem_util_min": 0.35487744356181294, "mean_cluster_mem_util_max": 0.37482639696173836, "reward_consolidation_mean_mean": 0.16555555555555557, "reward_consolidation_mean_min": 0.06944444444444443, "reward_consolidation_mean_max": 0.3055555555555555, "reward_illegal_mean_mean": -1.7214999999999998, "reward_illegal_mean_min": -1.9833333333333334, "reward_illegal_mean_max": -1.4499999999999995, "reward_accuracy_mean_mean": 0.4052616666666667, "reward_accuracy_mean_min": 0.22351666666666667, "reward_accuracy_mean_max": 0.5545333333333333, "reward_sla_mean_mean": -1.0388277777777777, "reward_sla_mean_min": -1.643333333333333, "reward_sla_mean_max": -0.52, "reward_consolidation_sum_mean": 16.555555555555557, "reward_consolidation_sum_min": 6.944444444444444, "reward_consolidation_sum_max": 30.555555555555554, "reward_illegal_sum_mean": -172.14999999999998, "reward_illegal_sum_min": -198.33333333333334, "reward_illegal_sum_max": -144.99999999999994, "reward_accuracy_sum_mean": 40.52616666666667, "reward_accuracy_sum_min": 22.351666666666667, "reward_accuracy_sum_max": 55.45333333333333, "reward_sla_sum_mean": -103.88277777777778, "reward_sla_sum_min": -164.33333333333331, "reward_sla_sum_max": -52.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4659.0, "global_timestep_min": 2500, "global_timestep_max": 6300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-218.37333333333328, -210.1938888888888, -222.81388888888878, -234.47777777777767, -226.2999999999999, -219.4222222222222, -209.51777777777764, -209.056111111111, -204.85277777777776, -226.0377777777776, -221.6977777777777, -235.24999999999994, -226.6288888888887, -205.89944444444433, -175.76611111111112, -204.95722222222219, -222.69888888888886, -222.69444444444443, -227.89333333333323, -235.16666666666663, -228.1505555555554, -223.04722222222213, -199.2116666666665, -212.06388888888884, -221.0372222222221, -201.5927777777777, -214.35222222222217, -213.95611111111103, -217.2883333333333, -210.0283333333332, -251.79222222222205, -223.9155555555555, -223.7949999999999, -240.83833333333334, -197.4511111111109, -248.69222222222194, -222.40888888888884, -221.74722222222212, -199.2599999999999, -192.1894444444444, -200.0099999999999, -225.8922222222221, -205.30611111111102, -236.16722222222202, -198.92833333333328, -220.16999999999993, -220.2305555555555, -239.22777777777773, -222.7744444444443, -201.93722222222215, -236.00333333333325, -209.01666666666657, -189.30777777777774, -227.77166666666648, -226.2094444444444, -202.68611111111107, -243.55111111111094, -229.3244444444443, -225.82777777777764, -234.4505555555555, -199.09277777777768, -207.78833333333324, -218.0477777777777, -241.8227777777776, -215.34666666666666, -240.98888888888882, -228.3116666666666, -225.98277777777764, -218.46111111111097, -220.07499999999996, -218.04611111111103, -232.23499999999981, -218.5499999999999, -224.77444444444444, -214.62111111111102, -217.57166666666657, -238.87888888888878, -225.80333333333323, -219.85999999999993, -210.44444444444443, -212.78666666666666, -225.54999999999987, -244.19333333333327, -242.46555555555548, -209.59888888888875, -198.89666666666656, -207.89111111111106, -214.23333333333323, -233.1183333333332, -191.29833333333318, -241.42166666666654, -189.10222222222214, -224.07499999999987, -225.1144444444444, -220.3527777777777, -214.05111111111117, -196.75722222222225, -196.21499999999997, -222.7877777777777, -231.18388888888884], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-218.37333333333328, -210.1938888888888, -222.81388888888878, -234.47777777777767, -226.2999999999999, -219.4222222222222, -209.51777777777764, -209.056111111111, -204.85277777777776, -226.0377777777776, -221.6977777777777, -235.24999999999994, -226.6288888888887, -205.89944444444433, -175.76611111111112, -204.95722222222219, -222.69888888888886, -222.69444444444443, -227.89333333333323, -235.16666666666663, -228.1505555555554, -223.04722222222213, -199.2116666666665, -212.06388888888884, -221.0372222222221, -201.5927777777777, -214.35222222222217, -213.95611111111103, -217.2883333333333, -210.0283333333332, -251.79222222222205, -223.9155555555555, -223.7949999999999, -240.83833333333334, -197.4511111111109, -248.69222222222194, -222.40888888888884, -221.74722222222212, -199.2599999999999, -192.1894444444444, -200.0099999999999, -225.8922222222221, -205.30611111111102, -236.16722222222202, -198.92833333333328, -220.16999999999993, -220.2305555555555, -239.22777777777773, -222.7744444444443, -201.93722222222215, -236.00333333333325, -209.01666666666657, -189.30777777777774, -227.77166666666648, -226.2094444444444, -202.68611111111107, -243.55111111111094, -229.3244444444443, -225.82777777777764, -234.4505555555555, -199.09277777777768, -207.78833333333324, -218.0477777777777, -241.8227777777776, -215.34666666666666, -240.98888888888882, -228.3116666666666, -225.98277777777764, -218.46111111111097, -220.07499999999996, -218.04611111111103, -232.23499999999981, -218.5499999999999, -224.77444444444444, -214.62111111111102, -217.57166666666657, -238.87888888888878, -225.80333333333323, -219.85999999999993, -210.44444444444443, -212.78666666666666, -225.54999999999987, -244.19333333333327, -242.46555555555548, -209.59888888888875, -198.89666666666656, -207.89111111111106, -214.23333333333323, -233.1183333333332, -191.29833333333318, -241.42166666666654, -189.10222222222214, -224.07499999999987, -225.1144444444444, -220.3527777777777, -214.05111111111117, -196.75722222222225, -196.21499999999997, -222.7877777777777, -231.18388888888884]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1917800605746935, "mean_inference_ms": 1.7924877257179872, "mean_action_processing_ms": 0.07313796847863159, "mean_env_wait_ms": 1.1892479473805408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004287004470825195, "StateBufferConnector_ms": 0.002893209457397461, "ViewRequirementAgentConnector_ms": 0.06537532806396484}, "num_episodes": 30, "episode_return_max": -175.76611111111112, "episode_return_min": -251.79222222222205, "episode_return_mean": -218.9510555555555, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42450, "num_agent_steps_trained": 42300, "num_env_steps_sampled": 42450, "num_env_steps_trained": 42300, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 293.25306739773106, "num_env_steps_trained_throughput_per_sec": 293.25306739773106, "timesteps_total": 42450, "num_env_steps_sampled_lifetime": 42450, "num_agent_steps_sampled_lifetime": 42450, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 42450, "timers": {"training_iteration_time_ms": 10265.32, "restore_workers_time_ms": 0.011, "training_step_time_ms": 505.251, "sample_time_ms": 491.251, "synch_weights_time_ms": 12.779}, "counters": {"num_env_steps_sampled": 42450, "num_env_steps_trained": 42300, "num_agent_steps_sampled": 42450, "num_agent_steps_trained": 42300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 283, "num_samples_added_to_queue": 42300}, "done": false, "training_iteration": 14, "trial_id": "0313d_00000", "date": "2024-10-10_21-43-48", "timestamp": 1728593028, "time_this_iter_s": 10.240461826324463, "time_total_s": 144.00744557380676, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c2a650>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 144.00744557380676, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 10.714285714285712, "ram_util_percent": 50.69285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -208386.515625, "policy_loss": -208409.6875, "entropy": 29.813844680786133, "entropy_coeff": 0.01, "var_gnorm": 16.012813568115234, "vf_loss": 112602.7265625, "vf_explained_var": 0.011711537837982178}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 151.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 45600, "num_env_steps_trained": 45300, "num_agent_steps_sampled": 45600, "num_agent_steps_trained": 45300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 304, "num_samples_added_to_queue": 45600, "learner_queue": {"size_count": 151, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.357, "learner_load_time_ms": 0.214, "learner_load_wait_time_ms": 934.766, "learner_dequeue_time_ms": 8264.848}}, "env_runners": {"episode_reward_max": -189.10222222222214, "episode_reward_min": -258.59055555555545, "episode_reward_mean": -220.40213333333327, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -258.59055555555545}, "policy_reward_max": {"default_policy": -189.10222222222214}, "policy_reward_mean": {"default_policy": -220.40213333333327}, "custom_metrics": {"num_consolidated_mean": 0.6588, "num_consolidated_min": 0.51, "num_consolidated_max": 0.78, "num_overloaded_mean": 1.0385, "num_overloaded_min": 0.86, "num_overloaded_max": 1.19, "num_moves_mean": 10.0166, "num_moves_min": 9.64, "num_moves_max": 10.32, "mean_accuracy_mean": 41.07789666666667, "mean_accuracy_min": 40.79600000000001, "mean_accuracy_max": 41.404, "num_model_switches_mean": 6.0029, "num_model_switches_min": 5.52, "num_model_switches_max": 6.33, "num_slav_mean": 0.15968, "num_slav_min": 0.13875, "num_slav_max": 0.1759166666666667, "mean_cluster_cpu_util_mean": 0.568661100739615, "mean_cluster_cpu_util_min": 0.5494411229836423, "mean_cluster_cpu_util_max": 0.5863522556072912, "mean_cluster_mem_util_mean": 0.36498459522374355, "mean_cluster_mem_util_min": 0.3562764825339419, "mean_cluster_mem_util_max": 0.3730054455854072, "reward_consolidation_mean_mean": 0.16388888888888886, "reward_consolidation_mean_min": 0.05555555555555555, "reward_consolidation_mean_max": 0.3055555555555555, "reward_illegal_mean_mean": -1.7308333333333332, "reward_illegal_mean_min": -1.9833333333333334, "reward_illegal_mean_max": -1.4333333333333331, "reward_accuracy_mean_mean": 0.4051286666666667, "reward_accuracy_mean_min": 0.20486666666666667, "reward_accuracy_mean_max": 0.5766666666666667, "reward_sla_mean_mean": -1.0422055555555554, "reward_sla_mean_min": -1.5755555555555558, "reward_sla_mean_max": -0.543888888888889, "reward_consolidation_sum_mean": 16.388888888888886, "reward_consolidation_sum_min": 5.555555555555555, "reward_consolidation_sum_max": 30.555555555555554, "reward_illegal_sum_mean": -173.0833333333333, "reward_illegal_sum_min": -198.33333333333334, "reward_illegal_sum_max": -143.33333333333331, "reward_accuracy_sum_mean": 40.51286666666667, "reward_accuracy_sum_min": 20.486666666666668, "reward_accuracy_sum_max": 57.66666666666667, "reward_sla_sum_mean": -104.22055555555556, "reward_sla_sum_min": -157.55555555555557, "reward_sla_sum_max": -54.38888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5767.0, "global_timestep_min": 3700, "global_timestep_max": 7400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-240.83833333333334, -197.4511111111109, -248.69222222222194, -222.40888888888884, -221.74722222222212, -199.2599999999999, -192.1894444444444, -200.0099999999999, -225.8922222222221, -205.30611111111102, -236.16722222222202, -198.92833333333328, -220.16999999999993, -220.2305555555555, -239.22777777777773, -222.7744444444443, -201.93722222222215, -236.00333333333325, -209.01666666666657, -189.30777777777774, -227.77166666666648, -226.2094444444444, -202.68611111111107, -243.55111111111094, -229.3244444444443, -225.82777777777764, -234.4505555555555, -199.09277777777768, -207.78833333333324, -218.0477777777777, -241.8227777777776, -215.34666666666666, -240.98888888888882, -228.3116666666666, -225.98277777777764, -218.46111111111097, -220.07499999999996, -218.04611111111103, -232.23499999999981, -218.5499999999999, -224.77444444444444, -214.62111111111102, -217.57166666666657, -238.87888888888878, -225.80333333333323, -219.85999999999993, -210.44444444444443, -212.78666666666666, -225.54999999999987, -244.19333333333327, -242.46555555555548, -209.59888888888875, -198.89666666666656, -207.89111111111106, -214.23333333333323, -233.1183333333332, -191.29833333333318, -241.42166666666654, -189.10222222222214, -224.07499999999987, -225.1144444444444, -220.3527777777777, -214.05111111111117, -196.75722222222225, -196.21499999999997, -222.7877777777777, -231.18388888888884, -229.83666666666662, -207.56833333333321, -226.40777777777782, -231.86777777777777, -199.49833333333322, -210.82222222222214, -251.31111111111105, -258.59055555555545, -241.5772222222221, -210.66055555555553, -211.44444444444431, -232.6949999999999, -220.70944444444433, -218.8927777777776, -235.67888888888868, -218.37277777777777, -211.2538888888887, -237.75888888888878, -232.52444444444438, -240.89722222222227, -222.8244444444443, -214.6316666666665, -213.9366666666666, -209.85333333333332, -224.5422222222222, -257.5516666666668, -218.96999999999997, -213.3961111111109, -210.45611111111103, -197.05277777777772, -203.61111111111094, -227.67999999999986, -202.16277777777776], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-240.83833333333334, -197.4511111111109, -248.69222222222194, -222.40888888888884, -221.74722222222212, -199.2599999999999, -192.1894444444444, -200.0099999999999, -225.8922222222221, -205.30611111111102, -236.16722222222202, -198.92833333333328, -220.16999999999993, -220.2305555555555, -239.22777777777773, -222.7744444444443, -201.93722222222215, -236.00333333333325, -209.01666666666657, -189.30777777777774, -227.77166666666648, -226.2094444444444, -202.68611111111107, -243.55111111111094, -229.3244444444443, -225.82777777777764, -234.4505555555555, -199.09277777777768, -207.78833333333324, -218.0477777777777, -241.8227777777776, -215.34666666666666, -240.98888888888882, -228.3116666666666, -225.98277777777764, -218.46111111111097, -220.07499999999996, -218.04611111111103, -232.23499999999981, -218.5499999999999, -224.77444444444444, -214.62111111111102, -217.57166666666657, -238.87888888888878, -225.80333333333323, -219.85999999999993, -210.44444444444443, -212.78666666666666, -225.54999999999987, -244.19333333333327, -242.46555555555548, -209.59888888888875, -198.89666666666656, -207.89111111111106, -214.23333333333323, -233.1183333333332, -191.29833333333318, -241.42166666666654, -189.10222222222214, -224.07499999999987, -225.1144444444444, -220.3527777777777, -214.05111111111117, -196.75722222222225, -196.21499999999997, -222.7877777777777, -231.18388888888884, -229.83666666666662, -207.56833333333321, -226.40777777777782, -231.86777777777777, -199.49833333333322, -210.82222222222214, -251.31111111111105, -258.59055555555545, -241.5772222222221, -210.66055555555553, -211.44444444444431, -232.6949999999999, -220.70944444444433, -218.8927777777776, -235.67888888888868, -218.37277777777777, -211.2538888888887, -237.75888888888878, -232.52444444444438, -240.89722222222227, -222.8244444444443, -214.6316666666665, -213.9366666666666, -209.85333333333332, -224.5422222222222, -257.5516666666668, -218.96999999999997, -213.3961111111109, -210.45611111111103, -197.05277777777772, -203.61111111111094, -227.67999999999986, -202.16277777777776]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1915082754703097, "mean_inference_ms": 1.7922214933361056, "mean_action_processing_ms": 0.07308612496166862, "mean_env_wait_ms": 1.1888514283308311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003938913345336914, "StateBufferConnector_ms": 0.002763986587524414, "ViewRequirementAgentConnector_ms": 0.06232094764709473}, "num_episodes": 33, "episode_return_max": -189.10222222222214, "episode_return_min": -258.59055555555545, "episode_return_mean": -220.40213333333327, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45600, "num_agent_steps_trained": 45300, "num_env_steps_sampled": 45600, "num_env_steps_trained": 45300, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 304.1517219673107, "num_env_steps_trained_throughput_per_sec": 289.668306635534, "timesteps_total": 45600, "num_env_steps_sampled_lifetime": 45600, "num_agent_steps_sampled_lifetime": 45600, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 45600, "timers": {"training_iteration_time_ms": 10297.66, "restore_workers_time_ms": 0.011, "training_step_time_ms": 486.02, "sample_time_ms": 471.735, "synch_weights_time_ms": 13.047}, "counters": {"num_env_steps_sampled": 45600, "num_env_steps_trained": 45300, "num_agent_steps_sampled": 45600, "num_agent_steps_trained": 45300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 304, "num_samples_added_to_queue": 45600}, "done": false, "training_iteration": 15, "trial_id": "0313d_00000", "date": "2024-10-10_21-43-58", "timestamp": 1728593038, "time_this_iter_s": 10.370124101638794, "time_total_s": 154.37756967544556, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d8b7f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 154.37756967544556, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 10.606666666666667, "ram_util_percent": 50.70000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -223072.65625, "policy_loss": -223109.734375, "entropy": 29.8121395111084, "entropy_coeff": 0.01, "var_gnorm": 16.015670776367188, "vf_loss": 126520.7421875, "vf_explained_var": 0.013984441757202148}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 162.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 48750, "num_env_steps_trained": 48600, "num_agent_steps_sampled": 48750, "num_agent_steps_trained": 48600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 325, "num_samples_added_to_queue": 48600, "learner_queue": {"size_count": 162, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 46.303, "learner_load_time_ms": 0.217, "learner_load_wait_time_ms": 946.001, "learner_dequeue_time_ms": 8237.757}}, "env_runners": {"episode_reward_max": -189.10222222222214, "episode_reward_min": -258.59055555555545, "episode_reward_mean": -221.43358333333327, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -258.59055555555545}, "policy_reward_max": {"default_policy": -189.10222222222214}, "policy_reward_mean": {"default_policy": -221.43358333333327}, "custom_metrics": {"num_consolidated_mean": 0.6663000000000001, "num_consolidated_min": 0.51, "num_consolidated_max": 0.82, "num_overloaded_mean": 1.0454999999999999, "num_overloaded_min": 0.86, "num_overloaded_max": 1.19, "num_moves_mean": 10.011499999999998, "num_moves_min": 9.64, "num_moves_max": 10.24, "mean_accuracy_mean": 41.078783333333334, "mean_accuracy_min": 40.79600000000001, "mean_accuracy_max": 41.404, "num_model_switches_mean": 5.985399999999999, "num_model_switches_min": 5.64, "num_model_switches_max": 6.33, "num_slav_mean": 0.16008066666666668, "num_slav_min": 0.14035, "num_slav_max": 0.1792166666666667, "mean_cluster_cpu_util_mean": 0.5699584021670933, "mean_cluster_cpu_util_min": 0.5494411229836423, "mean_cluster_cpu_util_max": 0.5896091020986887, "mean_cluster_mem_util_mean": 0.3656992413387296, "mean_cluster_mem_util_min": 0.3562764825339419, "mean_cluster_mem_util_max": 0.37324477184333643, "reward_consolidation_mean_mean": 0.16458333333333328, "reward_consolidation_mean_min": 0.05555555555555555, "reward_consolidation_mean_max": 0.3055555555555555, "reward_illegal_mean_mean": -1.7425, "reward_illegal_mean_min": -1.9833333333333334, "reward_illegal_mean_max": -1.4333333333333331, "reward_accuracy_mean_mean": 0.4037975000000001, "reward_accuracy_mean_min": 0.20486666666666667, "reward_accuracy_mean_max": 0.5902499999999999, "reward_sla_mean_mean": -1.0402166666666666, "reward_sla_mean_min": -1.7361111111111112, "reward_sla_mean_max": -0.595, "reward_consolidation_sum_mean": 16.458333333333332, "reward_consolidation_sum_min": 5.555555555555555, "reward_consolidation_sum_max": 30.555555555555554, "reward_illegal_sum_mean": -174.24999999999997, "reward_illegal_sum_min": -198.33333333333334, "reward_illegal_sum_max": -143.33333333333331, "reward_accuracy_sum_mean": 40.37975, "reward_accuracy_sum_min": 20.486666666666668, "reward_accuracy_sum_max": 59.02499999999999, "reward_sla_sum_mean": -104.02166666666666, "reward_sla_sum_min": -173.61111111111111, "reward_sla_sum_max": -59.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5363.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-241.8227777777776, -215.34666666666666, -240.98888888888882, -228.3116666666666, -225.98277777777764, -218.46111111111097, -220.07499999999996, -218.04611111111103, -232.23499999999981, -218.5499999999999, -224.77444444444444, -214.62111111111102, -217.57166666666657, -238.87888888888878, -225.80333333333323, -219.85999999999993, -210.44444444444443, -212.78666666666666, -225.54999999999987, -244.19333333333327, -242.46555555555548, -209.59888888888875, -198.89666666666656, -207.89111111111106, -214.23333333333323, -233.1183333333332, -191.29833333333318, -241.42166666666654, -189.10222222222214, -224.07499999999987, -225.1144444444444, -220.3527777777777, -214.05111111111117, -196.75722222222225, -196.21499999999997, -222.7877777777777, -231.18388888888884, -229.83666666666662, -207.56833333333321, -226.40777777777782, -231.86777777777777, -199.49833333333322, -210.82222222222214, -251.31111111111105, -258.59055555555545, -241.5772222222221, -210.66055555555553, -211.44444444444431, -232.6949999999999, -220.70944444444433, -218.8927777777776, -235.67888888888868, -218.37277777777777, -211.2538888888887, -237.75888888888878, -232.52444444444438, -240.89722222222227, -222.8244444444443, -214.6316666666665, -213.9366666666666, -209.85333333333332, -224.5422222222222, -257.5516666666668, -218.96999999999997, -213.3961111111109, -210.45611111111103, -197.05277777777772, -203.61111111111094, -227.67999999999986, -202.16277777777776, -210.9999999999999, -195.4749999999999, -239.1983333333333, -220.95166666666668, -219.80722222222212, -214.99166666666673, -214.70444444444433, -224.7738888888888, -225.10055555555547, -225.29888888888888, -228.26277777777767, -227.63333333333324, -198.50000000000006, -209.71111111111094, -255.5094444444443, -205.8738888888889, -247.7655555555556, -257.0783333333332, -195.58277777777766, -244.74222222222218, -223.61500000000004, -226.09999999999997, -228.8349999999999, -207.0677777777778, -224.16666666666646, -234.11055555555546, -216.09555555555548, -213.27888888888873, -212.4227777777777, -197.80055555555543], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-241.8227777777776, -215.34666666666666, -240.98888888888882, -228.3116666666666, -225.98277777777764, -218.46111111111097, -220.07499999999996, -218.04611111111103, -232.23499999999981, -218.5499999999999, -224.77444444444444, -214.62111111111102, -217.57166666666657, -238.87888888888878, -225.80333333333323, -219.85999999999993, -210.44444444444443, -212.78666666666666, -225.54999999999987, -244.19333333333327, -242.46555555555548, -209.59888888888875, -198.89666666666656, -207.89111111111106, -214.23333333333323, -233.1183333333332, -191.29833333333318, -241.42166666666654, -189.10222222222214, -224.07499999999987, -225.1144444444444, -220.3527777777777, -214.05111111111117, -196.75722222222225, -196.21499999999997, -222.7877777777777, -231.18388888888884, -229.83666666666662, -207.56833333333321, -226.40777777777782, -231.86777777777777, -199.49833333333322, -210.82222222222214, -251.31111111111105, -258.59055555555545, -241.5772222222221, -210.66055555555553, -211.44444444444431, -232.6949999999999, -220.70944444444433, -218.8927777777776, -235.67888888888868, -218.37277777777777, -211.2538888888887, -237.75888888888878, -232.52444444444438, -240.89722222222227, -222.8244444444443, -214.6316666666665, -213.9366666666666, -209.85333333333332, -224.5422222222222, -257.5516666666668, -218.96999999999997, -213.3961111111109, -210.45611111111103, -197.05277777777772, -203.61111111111094, -227.67999999999986, -202.16277777777776, -210.9999999999999, -195.4749999999999, -239.1983333333333, -220.95166666666668, -219.80722222222212, -214.99166666666673, -214.70444444444433, -224.7738888888888, -225.10055555555547, -225.29888888888888, -228.26277777777767, -227.63333333333324, -198.50000000000006, -209.71111111111094, -255.5094444444443, -205.8738888888889, -247.7655555555556, -257.0783333333332, -195.58277777777766, -244.74222222222218, -223.61500000000004, -226.09999999999997, -228.8349999999999, -207.0677777777778, -224.16666666666646, -234.11055555555546, -216.09555555555548, -213.27888888888873, -212.4227777777777, -197.80055555555543]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.191275357622009, "mean_inference_ms": 1.789323798472027, "mean_action_processing_ms": 0.07300038198021541, "mean_env_wait_ms": 1.187979234817828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038633346557617188, "StateBufferConnector_ms": 0.002750396728515625, "ViewRequirementAgentConnector_ms": 0.0616300106048584}, "num_episodes": 30, "episode_return_max": -189.10222222222214, "episode_return_min": -258.59055555555545, "episode_return_mean": -221.43358333333327, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48750, "num_agent_steps_trained": 48600, "num_env_steps_sampled": 48750, "num_env_steps_trained": 48600, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 303.33827690834346, "num_env_steps_trained_throughput_per_sec": 317.78295676112174, "timesteps_total": 48750, "num_env_steps_sampled_lifetime": 48750, "num_agent_steps_sampled_lifetime": 48750, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 48750, "timers": {"training_iteration_time_ms": 10303.665, "restore_workers_time_ms": 0.011, "training_step_time_ms": 498.363, "sample_time_ms": 485.089, "synch_weights_time_ms": 12.037}, "counters": {"num_env_steps_sampled": 48750, "num_env_steps_trained": 48600, "num_agent_steps_sampled": 48750, "num_agent_steps_trained": 48600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 325, "num_samples_added_to_queue": 48600}, "done": false, "training_iteration": 16, "trial_id": "0313d_00000", "date": "2024-10-10_21-44-09", "timestamp": 1728593049, "time_this_iter_s": 10.400263547897339, "time_total_s": 164.7778332233429, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c2a260>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 164.7778332233429, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 10.533333333333333, "ram_util_percent": 50.79333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -208441.8125, "policy_loss": -208465.28125, "entropy": 29.8115291595459, "entropy_coeff": 0.01, "var_gnorm": 16.016721725463867, "vf_loss": 112909.2421875, "vf_explained_var": 0.014659762382507324}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 172.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 51750, "num_env_steps_trained": 51600, "num_agent_steps_sampled": 51750, "num_agent_steps_trained": 51600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 345, "num_samples_added_to_queue": 51600, "learner_queue": {"size_count": 172, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 49.956, "learner_load_time_ms": 0.238, "learner_load_wait_time_ms": 962.082, "learner_dequeue_time_ms": 8243.182}}, "env_runners": {"episode_reward_max": -195.4749999999999, "episode_reward_min": -258.59055555555545, "episode_reward_mean": -221.34979999999985, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -258.59055555555545}, "policy_reward_max": {"default_policy": -195.4749999999999}, "policy_reward_mean": {"default_policy": -221.34979999999985}, "custom_metrics": {"num_consolidated_mean": 0.6709000000000002, "num_consolidated_min": 0.51, "num_consolidated_max": 0.82, "num_overloaded_mean": 1.037, "num_overloaded_min": 0.82, "num_overloaded_max": 1.21, "num_moves_mean": 10.007, "num_moves_min": 9.64, "num_moves_max": 10.24, "mean_accuracy_mean": 41.07365333333333, "mean_accuracy_min": 40.79600000000001, "mean_accuracy_max": 41.404, "num_model_switches_mean": 5.9976, "num_model_switches_min": 5.64, "num_model_switches_max": 6.54, "num_slav_mean": 0.16036766666666666, "num_slav_min": 0.14168333333333333, "num_slav_max": 0.1792166666666667, "mean_cluster_cpu_util_mean": 0.569380808879654, "mean_cluster_cpu_util_min": 0.5487414834464104, "mean_cluster_cpu_util_max": 0.5896091020986887, "mean_cluster_mem_util_mean": 0.3656008880008754, "mean_cluster_mem_util_min": 0.3562764825339419, "mean_cluster_mem_util_max": 0.37324477184333643, "reward_consolidation_mean_mean": 0.17527777777777778, "reward_consolidation_mean_min": 0.05555555555555555, "reward_consolidation_mean_max": 0.3055555555555555, "reward_illegal_mean_mean": -1.728333333333333, "reward_illegal_mean_min": -2.016666666666666, "reward_illegal_mean_max": -1.3666666666666665, "reward_accuracy_mean_mean": 0.416902, "reward_accuracy_mean_min": 0.20486666666666667, "reward_accuracy_mean_max": 0.7106999999999999, "reward_sla_mean_mean": -1.0773444444444444, "reward_sla_mean_min": -1.7466666666666668, "reward_sla_mean_max": -0.46111111111111114, "reward_consolidation_sum_mean": 17.527777777777775, "reward_consolidation_sum_min": 5.555555555555555, "reward_consolidation_sum_max": 30.555555555555554, "reward_illegal_sum_mean": -172.8333333333333, "reward_illegal_sum_min": -201.66666666666663, "reward_illegal_sum_max": -136.66666666666666, "reward_accuracy_sum_mean": 41.690200000000004, "reward_accuracy_sum_min": 20.486666666666668, "reward_accuracy_sum_max": 71.07, "reward_sla_sum_mean": -107.73444444444445, "reward_sla_sum_min": -174.66666666666669, "reward_sla_sum_max": -46.111111111111114, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4023.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-225.1144444444444, -220.3527777777777, -214.05111111111117, -196.75722222222225, -196.21499999999997, -222.7877777777777, -231.18388888888884, -229.83666666666662, -207.56833333333321, -226.40777777777782, -231.86777777777777, -199.49833333333322, -210.82222222222214, -251.31111111111105, -258.59055555555545, -241.5772222222221, -210.66055555555553, -211.44444444444431, -232.6949999999999, -220.70944444444433, -218.8927777777776, -235.67888888888868, -218.37277777777777, -211.2538888888887, -237.75888888888878, -232.52444444444438, -240.89722222222227, -222.8244444444443, -214.6316666666665, -213.9366666666666, -209.85333333333332, -224.5422222222222, -257.5516666666668, -218.96999999999997, -213.3961111111109, -210.45611111111103, -197.05277777777772, -203.61111111111094, -227.67999999999986, -202.16277777777776, -210.9999999999999, -195.4749999999999, -239.1983333333333, -220.95166666666668, -219.80722222222212, -214.99166666666673, -214.70444444444433, -224.7738888888888, -225.10055555555547, -225.29888888888888, -228.26277777777767, -227.63333333333324, -198.50000000000006, -209.71111111111094, -255.5094444444443, -205.8738888888889, -247.7655555555556, -257.0783333333332, -195.58277777777766, -244.74222222222218, -223.61500000000004, -226.09999999999997, -228.8349999999999, -207.0677777777778, -224.16666666666646, -234.11055555555546, -216.09555555555548, -213.27888888888873, -212.4227777777777, -197.80055555555543, -218.6038888888889, -216.71111111111108, -225.62222222222218, -229.2344444444444, -212.4855555555555, -229.69166666666655, -207.66999999999982, -196.18666666666655, -237.78888888888872, -223.17888888888885, -199.52722222222218, -211.45666666666642, -219.16833333333332, -207.35166666666657, -228.07944444444436, -231.28277777777765, -226.93944444444432, -223.80555555555543, -210.46944444444438, -205.66222222222208, -220.2833333333333, -248.74166666666667, -249.86999999999992, -238.4805555555554, -216.29833333333332, -214.43555555555542, -229.93444444444424, -205.59444444444438, -218.97888888888878, -234.49333333333334], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-225.1144444444444, -220.3527777777777, -214.05111111111117, -196.75722222222225, -196.21499999999997, -222.7877777777777, -231.18388888888884, -229.83666666666662, -207.56833333333321, -226.40777777777782, -231.86777777777777, -199.49833333333322, -210.82222222222214, -251.31111111111105, -258.59055555555545, -241.5772222222221, -210.66055555555553, -211.44444444444431, -232.6949999999999, -220.70944444444433, -218.8927777777776, -235.67888888888868, -218.37277777777777, -211.2538888888887, -237.75888888888878, -232.52444444444438, -240.89722222222227, -222.8244444444443, -214.6316666666665, -213.9366666666666, -209.85333333333332, -224.5422222222222, -257.5516666666668, -218.96999999999997, -213.3961111111109, -210.45611111111103, -197.05277777777772, -203.61111111111094, -227.67999999999986, -202.16277777777776, -210.9999999999999, -195.4749999999999, -239.1983333333333, -220.95166666666668, -219.80722222222212, -214.99166666666673, -214.70444444444433, -224.7738888888888, -225.10055555555547, -225.29888888888888, -228.26277777777767, -227.63333333333324, -198.50000000000006, -209.71111111111094, -255.5094444444443, -205.8738888888889, -247.7655555555556, -257.0783333333332, -195.58277777777766, -244.74222222222218, -223.61500000000004, -226.09999999999997, -228.8349999999999, -207.0677777777778, -224.16666666666646, -234.11055555555546, -216.09555555555548, -213.27888888888873, -212.4227777777777, -197.80055555555543, -218.6038888888889, -216.71111111111108, -225.62222222222218, -229.2344444444444, -212.4855555555555, -229.69166666666655, -207.66999999999982, -196.18666666666655, -237.78888888888872, -223.17888888888885, -199.52722222222218, -211.45666666666642, -219.16833333333332, -207.35166666666657, -228.07944444444436, -231.28277777777765, -226.93944444444432, -223.80555555555543, -210.46944444444438, -205.66222222222208, -220.2833333333333, -248.74166666666667, -249.86999999999992, -238.4805555555554, -216.29833333333332, -214.43555555555542, -229.93444444444424, -205.59444444444438, -218.97888888888878, -234.49333333333334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19127930147004918, "mean_inference_ms": 1.7862646284729442, "mean_action_processing_ms": 0.07295800494893331, "mean_env_wait_ms": 1.1874274260408564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004080533981323242, "StateBufferConnector_ms": 0.0028562545776367188, "ViewRequirementAgentConnector_ms": 0.0635981559753418}, "num_episodes": 30, "episode_return_max": -195.4749999999999, "episode_return_min": -258.59055555555545, "episode_return_mean": -221.34979999999985, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51750, "num_agent_steps_trained": 51600, "num_env_steps_sampled": 51750, "num_env_steps_trained": 51600, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 294.8202072678106, "num_env_steps_trained_throughput_per_sec": 294.8202072678106, "timesteps_total": 51750, "num_env_steps_sampled_lifetime": 51750, "num_agent_steps_sampled_lifetime": 51750, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 51750, "timers": {"training_iteration_time_ms": 10299.309, "restore_workers_time_ms": 0.014, "training_step_time_ms": 526.421, "sample_time_ms": 511.411, "synch_weights_time_ms": 13.711}, "counters": {"num_env_steps_sampled": 51750, "num_env_steps_trained": 51600, "num_agent_steps_sampled": 51750, "num_agent_steps_trained": 51600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 345, "num_samples_added_to_queue": 51600}, "done": false, "training_iteration": 17, "trial_id": "0313d_00000", "date": "2024-10-10_21-44-19", "timestamp": 1728593059, "time_this_iter_s": 10.194965600967407, "time_total_s": 174.9727988243103, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42dc9360>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 174.9727988243103, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 12.259999999999998, "ram_util_percent": 51.01333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -209312.03125, "policy_loss": -209336.0, "entropy": 29.81121063232422, "entropy_coeff": 0.01, "var_gnorm": 16.01737403869629, "vf_loss": 113398.5390625, "vf_explained_var": 0.015797853469848633}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 181.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 54600, "num_env_steps_trained": 54300, "num_agent_steps_sampled": 54600, "num_agent_steps_trained": 54300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 364, "num_samples_added_to_queue": 54600, "learner_queue": {"size_count": 181, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.499, "learner_load_time_ms": 0.216, "learner_load_wait_time_ms": 1035.901, "learner_dequeue_time_ms": 8325.311}}, "env_runners": {"episode_reward_max": -182.64388888888882, "episode_reward_min": -257.5516666666668, "episode_reward_mean": -220.49864444444432, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -257.5516666666668}, "policy_reward_max": {"default_policy": -182.64388888888882}, "policy_reward_mean": {"default_policy": -220.49864444444432}, "custom_metrics": {"num_consolidated_mean": 0.6759000000000002, "num_consolidated_min": 0.49, "num_consolidated_max": 0.82, "num_overloaded_mean": 1.0379000000000003, "num_overloaded_min": 0.82, "num_overloaded_max": 1.21, "num_moves_mean": 10.006100000000002, "num_moves_min": 9.64, "num_moves_max": 10.47, "mean_accuracy_mean": 41.065103333333326, "mean_accuracy_min": 40.79600000000001, "mean_accuracy_max": 41.34700000000001, "num_model_switches_mean": 5.9896, "num_model_switches_min": 5.57, "num_model_switches_max": 6.54, "num_slav_mean": 0.15991316666666666, "num_slav_min": 0.14281666666666668, "num_slav_max": 0.1792166666666667, "mean_cluster_cpu_util_mean": 0.569955201922619, "mean_cluster_cpu_util_min": 0.5487414834464104, "mean_cluster_cpu_util_max": 0.5896091020986887, "mean_cluster_mem_util_mean": 0.3659508764333792, "mean_cluster_mem_util_min": 0.356919596752203, "mean_cluster_mem_util_max": 0.37324477184333643, "reward_consolidation_mean_mean": 0.1731944444444444, "reward_consolidation_mean_min": 0.027777777777777776, "reward_consolidation_mean_max": 0.2916666666666667, "reward_illegal_mean_mean": -1.7298333333333331, "reward_illegal_mean_min": -2.016666666666666, "reward_illegal_mean_max": -1.3666666666666665, "reward_accuracy_mean_mean": 0.4127413333333334, "reward_accuracy_mean_min": 0.20486666666666667, "reward_accuracy_mean_max": 0.7106999999999999, "reward_sla_mean_mean": -1.0610888888888887, "reward_sla_mean_min": -1.7466666666666668, "reward_sla_mean_max": -0.46111111111111114, "reward_consolidation_sum_mean": 17.319444444444443, "reward_consolidation_sum_min": 2.7777777777777777, "reward_consolidation_sum_max": 29.166666666666668, "reward_illegal_sum_mean": -172.98333333333332, "reward_illegal_sum_min": -201.66666666666663, "reward_illegal_sum_max": -136.66666666666666, "reward_accuracy_sum_mean": 41.27413333333333, "reward_accuracy_sum_min": 20.486666666666668, "reward_accuracy_sum_max": 71.07, "reward_sla_sum_mean": -106.1088888888889, "reward_sla_sum_min": -174.66666666666669, "reward_sla_sum_max": -46.111111111111114, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2666.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-209.85333333333332, -224.5422222222222, -257.5516666666668, -218.96999999999997, -213.3961111111109, -210.45611111111103, -197.05277777777772, -203.61111111111094, -227.67999999999986, -202.16277777777776, -210.9999999999999, -195.4749999999999, -239.1983333333333, -220.95166666666668, -219.80722222222212, -214.99166666666673, -214.70444444444433, -224.7738888888888, -225.10055555555547, -225.29888888888888, -228.26277777777767, -227.63333333333324, -198.50000000000006, -209.71111111111094, -255.5094444444443, -205.8738888888889, -247.7655555555556, -257.0783333333332, -195.58277777777766, -244.74222222222218, -223.61500000000004, -226.09999999999997, -228.8349999999999, -207.0677777777778, -224.16666666666646, -234.11055555555546, -216.09555555555548, -213.27888888888873, -212.4227777777777, -197.80055555555543, -218.6038888888889, -216.71111111111108, -225.62222222222218, -229.2344444444444, -212.4855555555555, -229.69166666666655, -207.66999999999982, -196.18666666666655, -237.78888888888872, -223.17888888888885, -199.52722222222218, -211.45666666666642, -219.16833333333332, -207.35166666666657, -228.07944444444436, -231.28277777777765, -226.93944444444432, -223.80555555555543, -210.46944444444438, -205.66222222222208, -220.2833333333333, -248.74166666666667, -249.86999999999992, -238.4805555555554, -216.29833333333332, -214.43555555555542, -229.93444444444424, -205.59444444444438, -218.97888888888878, -234.49333333333334, -214.97722222222217, -224.14388888888888, -233.05777777777763, -226.99499999999995, -241.33166666666656, -234.45833333333331, -197.0322222222222, -223.24722222222223, -206.69166666666658, -212.4549999999999, -220.7249999999999, -205.71777777777774, -213.41555555555553, -225.60944444444434, -220.87555555555548, -215.77944444444427, -219.4455555555555, -220.09055555555557, -223.50833333333333, -219.11611111111117, -219.26444444444428, -228.4727777777777, -217.1716666666666, -217.66777777777764, -234.6938888888889, -246.051111111111, -182.64388888888882, -206.5572222222222, -225.17222222222216, -224.7394444444443], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-209.85333333333332, -224.5422222222222, -257.5516666666668, -218.96999999999997, -213.3961111111109, -210.45611111111103, -197.05277777777772, -203.61111111111094, -227.67999999999986, -202.16277777777776, -210.9999999999999, -195.4749999999999, -239.1983333333333, -220.95166666666668, -219.80722222222212, -214.99166666666673, -214.70444444444433, -224.7738888888888, -225.10055555555547, -225.29888888888888, -228.26277777777767, -227.63333333333324, -198.50000000000006, -209.71111111111094, -255.5094444444443, -205.8738888888889, -247.7655555555556, -257.0783333333332, -195.58277777777766, -244.74222222222218, -223.61500000000004, -226.09999999999997, -228.8349999999999, -207.0677777777778, -224.16666666666646, -234.11055555555546, -216.09555555555548, -213.27888888888873, -212.4227777777777, -197.80055555555543, -218.6038888888889, -216.71111111111108, -225.62222222222218, -229.2344444444444, -212.4855555555555, -229.69166666666655, -207.66999999999982, -196.18666666666655, -237.78888888888872, -223.17888888888885, -199.52722222222218, -211.45666666666642, -219.16833333333332, -207.35166666666657, -228.07944444444436, -231.28277777777765, -226.93944444444432, -223.80555555555543, -210.46944444444438, -205.66222222222208, -220.2833333333333, -248.74166666666667, -249.86999999999992, -238.4805555555554, -216.29833333333332, -214.43555555555542, -229.93444444444424, -205.59444444444438, -218.97888888888878, -234.49333333333334, -214.97722222222217, -224.14388888888888, -233.05777777777763, -226.99499999999995, -241.33166666666656, -234.45833333333331, -197.0322222222222, -223.24722222222223, -206.69166666666658, -212.4549999999999, -220.7249999999999, -205.71777777777774, -213.41555555555553, -225.60944444444434, -220.87555555555548, -215.77944444444427, -219.4455555555555, -220.09055555555557, -223.50833333333333, -219.11611111111117, -219.26444444444428, -228.4727777777777, -217.1716666666666, -217.66777777777764, -234.6938888888889, -246.051111111111, -182.64388888888882, -206.5572222222222, -225.17222222222216, -224.7394444444443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1916664195898255, "mean_inference_ms": 1.7838271220438129, "mean_action_processing_ms": 0.07303979569494222, "mean_env_wait_ms": 1.1880950810953634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004330158233642578, "StateBufferConnector_ms": 0.0029578208923339844, "ViewRequirementAgentConnector_ms": 0.06662988662719727}, "num_episodes": 30, "episode_return_max": -182.64388888888882, "episode_return_min": -257.5516666666668, "episode_return_mean": -220.49864444444432, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54600, "num_agent_steps_trained": 54300, "num_env_steps_sampled": 54600, "num_env_steps_trained": 54300, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 277.07359414563626, "num_env_steps_trained_throughput_per_sec": 262.49077340112905, "timesteps_total": 54600, "num_env_steps_sampled_lifetime": 54600, "num_agent_steps_sampled_lifetime": 54600, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 54600, "timers": {"training_iteration_time_ms": 10296.559, "restore_workers_time_ms": 0.011, "training_step_time_ms": 527.842, "sample_time_ms": 513.525, "synch_weights_time_ms": 12.981}, "counters": {"num_env_steps_sampled": 54600, "num_env_steps_trained": 54300, "num_agent_steps_sampled": 54600, "num_agent_steps_trained": 54300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 364, "num_samples_added_to_queue": 54600}, "done": false, "training_iteration": 18, "trial_id": "0313d_00000", "date": "2024-10-10_21-44-29", "timestamp": 1728593069, "time_this_iter_s": 10.295201778411865, "time_total_s": 185.26800060272217, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a7760>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 185.26800060272217, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 14.914285714285713, "ram_util_percent": 51.37142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -205851.203125, "policy_loss": -205872.140625, "entropy": 29.81089210510254, "entropy_coeff": 0.01, "var_gnorm": 16.017953872680664, "vf_loss": 110370.453125, "vf_explained_var": 0.01696956157684326}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 192.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 57750, "num_env_steps_trained": 57600, "num_agent_steps_sampled": 57750, "num_agent_steps_trained": 57600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 385, "num_samples_added_to_queue": 57600, "learner_queue": {"size_count": 192, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 49.475, "learner_load_time_ms": 0.231, "learner_load_wait_time_ms": 931.465, "learner_dequeue_time_ms": 8282.71}}, "env_runners": {"episode_reward_max": -182.64388888888882, "episode_reward_min": -254.50499999999988, "episode_reward_mean": -221.01592222222214, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -254.50499999999988}, "policy_reward_max": {"default_policy": -182.64388888888882}, "policy_reward_mean": {"default_policy": -221.01592222222214}, "custom_metrics": {"num_consolidated_mean": 0.6731, "num_consolidated_min": 0.49, "num_consolidated_max": 0.83, "num_overloaded_mean": 1.0301, "num_overloaded_min": 0.82, "num_overloaded_max": 1.21, "num_moves_mean": 10.0155, "num_moves_min": 9.73, "num_moves_max": 10.47, "mean_accuracy_mean": 41.053133333333335, "mean_accuracy_min": 40.821333333333335, "mean_accuracy_max": 41.34700000000001, "num_model_switches_mean": 6.006100000000001, "num_model_switches_min": 5.57, "num_model_switches_max": 6.54, "num_slav_mean": 0.15867050000000002, "num_slav_min": 0.14281666666666668, "num_slav_max": 0.17908333333333332, "mean_cluster_cpu_util_mean": 0.568947853948098, "mean_cluster_cpu_util_min": 0.5487414834464104, "mean_cluster_cpu_util_max": 0.5896091020986887, "mean_cluster_mem_util_mean": 0.3655089900990987, "mean_cluster_mem_util_min": 0.356919596752203, "mean_cluster_mem_util_max": 0.37344404295473466, "reward_consolidation_mean_mean": 0.17597222222222217, "reward_consolidation_mean_min": 0.027777777777777776, "reward_consolidation_mean_max": 0.3194444444444444, "reward_illegal_mean_mean": -1.716833333333333, "reward_illegal_mean_min": -2.016666666666666, "reward_illegal_mean_max": -1.3666666666666665, "reward_accuracy_mean_mean": 0.42417966666666673, "reward_accuracy_mean_min": 0.20549999999999996, "reward_accuracy_mean_max": 0.7106999999999999, "reward_sla_mean_mean": -1.0934777777777778, "reward_sla_mean_min": -1.7466666666666668, "reward_sla_mean_max": -0.46111111111111114, "reward_consolidation_sum_mean": 17.597222222222218, "reward_consolidation_sum_min": 2.7777777777777777, "reward_consolidation_sum_max": 31.944444444444443, "reward_illegal_sum_mean": -171.6833333333333, "reward_illegal_sum_min": -201.66666666666663, "reward_illegal_sum_max": -136.66666666666666, "reward_accuracy_sum_mean": 42.41796666666667, "reward_accuracy_sum_min": 20.549999999999997, "reward_accuracy_sum_max": 71.07, "reward_sla_sum_mean": -109.34777777777778, "reward_sla_sum_min": -174.66666666666669, "reward_sla_sum_max": -46.111111111111114, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2262.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-223.61500000000004, -226.09999999999997, -228.8349999999999, -207.0677777777778, -224.16666666666646, -234.11055555555546, -216.09555555555548, -213.27888888888873, -212.4227777777777, -197.80055555555543, -218.6038888888889, -216.71111111111108, -225.62222222222218, -229.2344444444444, -212.4855555555555, -229.69166666666655, -207.66999999999982, -196.18666666666655, -237.78888888888872, -223.17888888888885, -199.52722222222218, -211.45666666666642, -219.16833333333332, -207.35166666666657, -228.07944444444436, -231.28277777777765, -226.93944444444432, -223.80555555555543, -210.46944444444438, -205.66222222222208, -220.2833333333333, -248.74166666666667, -249.86999999999992, -238.4805555555554, -216.29833333333332, -214.43555555555542, -229.93444444444424, -205.59444444444438, -218.97888888888878, -234.49333333333334, -214.97722222222217, -224.14388888888888, -233.05777777777763, -226.99499999999995, -241.33166666666656, -234.45833333333331, -197.0322222222222, -223.24722222222223, -206.69166666666658, -212.4549999999999, -220.7249999999999, -205.71777777777774, -213.41555555555553, -225.60944444444434, -220.87555555555548, -215.77944444444427, -219.4455555555555, -220.09055555555557, -223.50833333333333, -219.11611111111117, -219.26444444444428, -228.4727777777777, -217.1716666666666, -217.66777777777764, -234.6938888888889, -246.051111111111, -182.64388888888882, -206.5572222222222, -225.17222222222216, -224.7394444444443, -220.33611111111105, -229.36055555555552, -219.87111111111102, -238.37277777777766, -219.96666666666658, -212.98611111111103, -222.9911111111111, -254.50499999999988, -237.9827777777777, -212.49833333333342, -235.17166666666645, -231.13888888888886, -212.9788888888887, -219.87722222222212, -221.2566666666666, -208.81500000000008, -218.11055555555544, -216.74111111111108, -187.20999999999992, -210.18777777777768, -218.83499999999984, -225.31666666666666, -232.34499999999989, -218.1705555555554, -224.01444444444425, -230.87333333333322, -222.07277777777762, -240.84611111111107, -206.6788888888888, -229.4538888888888], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-223.61500000000004, -226.09999999999997, -228.8349999999999, -207.0677777777778, -224.16666666666646, -234.11055555555546, -216.09555555555548, -213.27888888888873, -212.4227777777777, -197.80055555555543, -218.6038888888889, -216.71111111111108, -225.62222222222218, -229.2344444444444, -212.4855555555555, -229.69166666666655, -207.66999999999982, -196.18666666666655, -237.78888888888872, -223.17888888888885, -199.52722222222218, -211.45666666666642, -219.16833333333332, -207.35166666666657, -228.07944444444436, -231.28277777777765, -226.93944444444432, -223.80555555555543, -210.46944444444438, -205.66222222222208, -220.2833333333333, -248.74166666666667, -249.86999999999992, -238.4805555555554, -216.29833333333332, -214.43555555555542, -229.93444444444424, -205.59444444444438, -218.97888888888878, -234.49333333333334, -214.97722222222217, -224.14388888888888, -233.05777777777763, -226.99499999999995, -241.33166666666656, -234.45833333333331, -197.0322222222222, -223.24722222222223, -206.69166666666658, -212.4549999999999, -220.7249999999999, -205.71777777777774, -213.41555555555553, -225.60944444444434, -220.87555555555548, -215.77944444444427, -219.4455555555555, -220.09055555555557, -223.50833333333333, -219.11611111111117, -219.26444444444428, -228.4727777777777, -217.1716666666666, -217.66777777777764, -234.6938888888889, -246.051111111111, -182.64388888888882, -206.5572222222222, -225.17222222222216, -224.7394444444443, -220.33611111111105, -229.36055555555552, -219.87111111111102, -238.37277777777766, -219.96666666666658, -212.98611111111103, -222.9911111111111, -254.50499999999988, -237.9827777777777, -212.49833333333342, -235.17166666666645, -231.13888888888886, -212.9788888888887, -219.87722222222212, -221.2566666666666, -208.81500000000008, -218.11055555555544, -216.74111111111108, -187.20999999999992, -210.18777777777768, -218.83499999999984, -225.31666666666666, -232.34499999999989, -218.1705555555554, -224.01444444444425, -230.87333333333322, -222.07277777777762, -240.84611111111107, -206.6788888888888, -229.4538888888888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19202570498937838, "mean_inference_ms": 1.783115490390843, "mean_action_processing_ms": 0.073149827889208, "mean_env_wait_ms": 1.189439692827612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004323482513427734, "StateBufferConnector_ms": 0.0029311180114746094, "ViewRequirementAgentConnector_ms": 0.06634950637817383}, "num_episodes": 30, "episode_return_max": -182.64388888888882, "episode_return_min": -254.50499999999988, "episode_return_mean": -221.01592222222214, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57750, "num_agent_steps_trained": 57600, "num_env_steps_sampled": 57750, "num_env_steps_trained": 57600, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 306.8387681243566, "num_env_steps_trained_throughput_per_sec": 321.4501380350402, "timesteps_total": 57750, "num_env_steps_sampled_lifetime": 57750, "num_agent_steps_sampled_lifetime": 57750, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 57750, "timers": {"training_iteration_time_ms": 10293.212, "restore_workers_time_ms": 0.011, "training_step_time_ms": 489.285, "sample_time_ms": 475.168, "synch_weights_time_ms": 12.882}, "counters": {"num_env_steps_sampled": 57750, "num_env_steps_trained": 57600, "num_agent_steps_sampled": 57750, "num_agent_steps_trained": 57600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 385, "num_samples_added_to_queue": 57600}, "done": false, "training_iteration": 19, "trial_id": "0313d_00000", "date": "2024-10-10_21-44-40", "timestamp": 1728593080, "time_this_iter_s": 10.274999856948853, "time_total_s": 195.54300045967102, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d8a2f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 195.54300045967102, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 10.446666666666667, "ram_util_percent": 51.16000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -216503.046875, "policy_loss": -216534.75, "entropy": 29.810585021972656, "entropy_coeff": 0.01, "var_gnorm": 16.018110275268555, "vf_loss": 121147.390625, "vf_explained_var": 0.017490684986114502}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 202.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 60900, "num_env_steps_trained": 60600, "num_agent_steps_sampled": 60900, "num_agent_steps_trained": 60600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 406, "num_samples_added_to_queue": 60900, "learner_queue": {"size_count": 202, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.636, "learner_load_time_ms": 0.24, "learner_load_wait_time_ms": 925.899, "learner_dequeue_time_ms": 8085.267}}, "env_runners": {"episode_reward_max": -182.64388888888882, "episode_reward_min": -254.50499999999988, "episode_reward_mean": -221.49267777777771, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -254.50499999999988}, "policy_reward_max": {"default_policy": -182.64388888888882}, "policy_reward_mean": {"default_policy": -221.49267777777771}, "custom_metrics": {"num_consolidated_mean": 0.6687000000000001, "num_consolidated_min": 0.49, "num_consolidated_max": 0.83, "num_overloaded_mean": 1.0292999999999999, "num_overloaded_min": 0.87, "num_overloaded_max": 1.21, "num_moves_mean": 10.004200000000003, "num_moves_min": 9.69, "num_moves_max": 10.47, "mean_accuracy_mean": 41.04724333333333, "mean_accuracy_min": 40.821333333333335, "mean_accuracy_max": 41.34700000000001, "num_model_switches_mean": 5.9918000000000005, "num_model_switches_min": 5.54, "num_model_switches_max": 6.38, "num_slav_mean": 0.1585551666666667, "num_slav_min": 0.14348333333333332, "num_slav_max": 0.17908333333333332, "mean_cluster_cpu_util_mean": 0.5689637454269361, "mean_cluster_cpu_util_min": 0.5446544690816041, "mean_cluster_cpu_util_max": 0.5940052470755491, "mean_cluster_mem_util_mean": 0.3654815951268693, "mean_cluster_mem_util_min": 0.35315397327707454, "mean_cluster_mem_util_max": 0.37663566064611503, "reward_consolidation_mean_mean": 0.17180555555555554, "reward_consolidation_mean_min": 0.027777777777777776, "reward_consolidation_mean_max": 0.3194444444444444, "reward_illegal_mean_mean": -1.7154999999999996, "reward_illegal_mean_min": -2.016666666666666, "reward_illegal_mean_max": -1.4499999999999997, "reward_accuracy_mean_mean": 0.41931766666666653, "reward_accuracy_mean_min": 0.22161666666666663, "reward_accuracy_mean_max": 0.6376833333333333, "reward_sla_mean_mean": -1.0905500000000001, "reward_sla_mean_min": -1.7322222222222223, "reward_sla_mean_max": -0.5955555555555556, "reward_consolidation_sum_mean": 17.180555555555554, "reward_consolidation_sum_min": 2.7777777777777777, "reward_consolidation_sum_max": 31.944444444444443, "reward_illegal_sum_mean": -171.55, "reward_illegal_sum_min": -201.66666666666663, "reward_illegal_sum_max": -144.99999999999997, "reward_accuracy_sum_mean": 41.931766666666675, "reward_accuracy_sum_min": 22.16166666666666, "reward_accuracy_sum_max": 63.76833333333333, "reward_sla_sum_mean": -109.055, "reward_sla_sum_min": -173.22222222222223, "reward_sla_sum_max": -59.55555555555556, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3067.0, "global_timestep_min": 1000, "global_timestep_max": 4700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-238.4805555555554, -216.29833333333332, -214.43555555555542, -229.93444444444424, -205.59444444444438, -218.97888888888878, -234.49333333333334, -214.97722222222217, -224.14388888888888, -233.05777777777763, -226.99499999999995, -241.33166666666656, -234.45833333333331, -197.0322222222222, -223.24722222222223, -206.69166666666658, -212.4549999999999, -220.7249999999999, -205.71777777777774, -213.41555555555553, -225.60944444444434, -220.87555555555548, -215.77944444444427, -219.4455555555555, -220.09055555555557, -223.50833333333333, -219.11611111111117, -219.26444444444428, -228.4727777777777, -217.1716666666666, -217.66777777777764, -234.6938888888889, -246.051111111111, -182.64388888888882, -206.5572222222222, -225.17222222222216, -224.7394444444443, -220.33611111111105, -229.36055555555552, -219.87111111111102, -238.37277777777766, -219.96666666666658, -212.98611111111103, -222.9911111111111, -254.50499999999988, -237.9827777777777, -212.49833333333342, -235.17166666666645, -231.13888888888886, -212.9788888888887, -219.87722222222212, -221.2566666666666, -208.81500000000008, -218.11055555555544, -216.74111111111108, -187.20999999999992, -210.18777777777768, -218.83499999999984, -225.31666666666666, -232.34499999999989, -218.1705555555554, -224.01444444444425, -230.87333333333322, -222.07277777777762, -240.84611111111107, -206.6788888888888, -229.4538888888888, -242.0244444444442, -241.34944444444434, -217.1816666666666, -233.4877777777777, -214.14722222222207, -216.50888888888866, -222.7816666666666, -223.20944444444433, -236.5688888888888, -217.69388888888878, -226.93888888888873, -228.37666666666647, -229.62555555555548, -216.41333333333316, -220.76499999999996, -190.08277777777784, -216.66166666666655, -207.0949999999999, -227.61333333333323, -213.38055555555542, -218.83611111111102, -211.85166666666666, -213.54555555555558, -210.6905555555555, -233.4805555555555, -209.77222222222193, -235.74888888888887, -216.15111111111102, -243.9627777777776, -212.24666666666653, -213.906111111111, -228.1477777777777, -220.7333333333332], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-238.4805555555554, -216.29833333333332, -214.43555555555542, -229.93444444444424, -205.59444444444438, -218.97888888888878, -234.49333333333334, -214.97722222222217, -224.14388888888888, -233.05777777777763, -226.99499999999995, -241.33166666666656, -234.45833333333331, -197.0322222222222, -223.24722222222223, -206.69166666666658, -212.4549999999999, -220.7249999999999, -205.71777777777774, -213.41555555555553, -225.60944444444434, -220.87555555555548, -215.77944444444427, -219.4455555555555, -220.09055555555557, -223.50833333333333, -219.11611111111117, -219.26444444444428, -228.4727777777777, -217.1716666666666, -217.66777777777764, -234.6938888888889, -246.051111111111, -182.64388888888882, -206.5572222222222, -225.17222222222216, -224.7394444444443, -220.33611111111105, -229.36055555555552, -219.87111111111102, -238.37277777777766, -219.96666666666658, -212.98611111111103, -222.9911111111111, -254.50499999999988, -237.9827777777777, -212.49833333333342, -235.17166666666645, -231.13888888888886, -212.9788888888887, -219.87722222222212, -221.2566666666666, -208.81500000000008, -218.11055555555544, -216.74111111111108, -187.20999999999992, -210.18777777777768, -218.83499999999984, -225.31666666666666, -232.34499999999989, -218.1705555555554, -224.01444444444425, -230.87333333333322, -222.07277777777762, -240.84611111111107, -206.6788888888888, -229.4538888888888, -242.0244444444442, -241.34944444444434, -217.1816666666666, -233.4877777777777, -214.14722222222207, -216.50888888888866, -222.7816666666666, -223.20944444444433, -236.5688888888888, -217.69388888888878, -226.93888888888873, -228.37666666666647, -229.62555555555548, -216.41333333333316, -220.76499999999996, -190.08277777777784, -216.66166666666655, -207.0949999999999, -227.61333333333323, -213.38055555555542, -218.83611111111102, -211.85166666666666, -213.54555555555558, -210.6905555555555, -233.4805555555555, -209.77222222222193, -235.74888888888887, -216.15111111111102, -243.9627777777776, -212.24666666666653, -213.906111111111, -228.1477777777777, -220.7333333333332]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19227106932875906, "mean_inference_ms": 1.7839994760287698, "mean_action_processing_ms": 0.07325474086565303, "mean_env_wait_ms": 1.1909824288281794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00434112548828125, "StateBufferConnector_ms": 0.002917766571044922, "ViewRequirementAgentConnector_ms": 0.06554913520812988}, "num_episodes": 33, "episode_return_max": -182.64388888888882, "episode_return_min": -254.50499999999988, "episode_return_mean": -221.49267777777771, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60900, "num_agent_steps_trained": 60600, "num_env_steps_sampled": 60900, "num_env_steps_trained": 60600, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 305.37092698393855, "num_env_steps_trained_throughput_per_sec": 290.82945427041767, "timesteps_total": 60900, "num_env_steps_sampled_lifetime": 60900, "num_agent_steps_sampled_lifetime": 60900, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 60900, "timers": {"training_iteration_time_ms": 10297.266, "restore_workers_time_ms": 0.012, "training_step_time_ms": 490.061, "sample_time_ms": 476.117, "synch_weights_time_ms": 12.673}, "counters": {"num_env_steps_sampled": 60900, "num_env_steps_trained": 60600, "num_agent_steps_sampled": 60900, "num_agent_steps_trained": 60600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 406, "num_samples_added_to_queue": 60900}, "done": false, "training_iteration": 20, "trial_id": "0313d_00000", "date": "2024-10-10_21-44-50", "timestamp": 1728593090, "time_this_iter_s": 10.325368165969849, "time_total_s": 205.86836862564087, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d8b550>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 205.86836862564087, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 10.799999999999999, "ram_util_percent": 51.42000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -217176.53125, "policy_loss": -217208.3125, "entropy": 29.810400009155273, "entropy_coeff": 0.01, "var_gnorm": 16.01828956604004, "vf_loss": 121225.5625, "vf_explained_var": 0.018466472625732422}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 213.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 64050, "num_env_steps_trained": 63900, "num_agent_steps_sampled": 64050, "num_agent_steps_trained": 63900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 427, "num_samples_added_to_queue": 63900, "learner_queue": {"size_count": 213, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 51.138, "learner_load_time_ms": 0.261, "learner_load_wait_time_ms": 932.89, "learner_dequeue_time_ms": 8073.487}}, "env_runners": {"episode_reward_max": -182.64388888888882, "episode_reward_min": -254.50499999999988, "episode_reward_mean": -221.77073888888881, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -254.50499999999988}, "policy_reward_max": {"default_policy": -182.64388888888882}, "policy_reward_mean": {"default_policy": -221.77073888888881}, "custom_metrics": {"num_consolidated_mean": 0.6812, "num_consolidated_min": 0.5, "num_consolidated_max": 0.83, "num_overloaded_mean": 1.0223, "num_overloaded_min": 0.87, "num_overloaded_max": 1.21, "num_moves_mean": 10.001700000000001, "num_moves_min": 9.69, "num_moves_max": 10.47, "mean_accuracy_mean": 41.04414, "mean_accuracy_min": 40.79599999999999, "mean_accuracy_max": 41.27733333333334, "num_model_switches_mean": 5.9704, "num_model_switches_min": 5.54, "num_model_switches_max": 6.35, "num_slav_mean": 0.15830200000000003, "num_slav_min": 0.14338333333333333, "num_slav_max": 0.17908333333333332, "mean_cluster_cpu_util_mean": 0.569022675303942, "mean_cluster_cpu_util_min": 0.5446544690816041, "mean_cluster_cpu_util_max": 0.5940052470755491, "mean_cluster_mem_util_mean": 0.3654432643355866, "mean_cluster_mem_util_min": 0.35315397327707454, "mean_cluster_mem_util_max": 0.37663566064611503, "reward_consolidation_mean_mean": 0.1775, "reward_consolidation_mean_min": 0.06944444444444445, "reward_consolidation_mean_max": 0.3194444444444444, "reward_illegal_mean_mean": -1.7038333333333333, "reward_illegal_mean_min": -2.016666666666666, "reward_illegal_mean_max": -1.4499999999999997, "reward_accuracy_mean_mean": 0.4290648333333334, "reward_accuracy_mean_min": 0.22763333333333335, "reward_accuracy_mean_max": 0.6376833333333333, "reward_sla_mean_mean": -1.1204388888888888, "reward_sla_mean_min": -1.7322222222222223, "reward_sla_mean_max": -0.5955555555555556, "reward_consolidation_sum_mean": 17.75, "reward_consolidation_sum_min": 6.944444444444445, "reward_consolidation_sum_max": 31.944444444444443, "reward_illegal_sum_mean": -170.38333333333333, "reward_illegal_sum_min": -201.66666666666663, "reward_illegal_sum_max": -144.99999999999997, "reward_accuracy_sum_mean": 42.90648333333333, "reward_accuracy_sum_min": 22.763333333333335, "reward_accuracy_sum_max": 63.76833333333333, "reward_sla_sum_mean": -112.04388888888889, "reward_sla_sum_min": -173.22222222222223, "reward_sla_sum_max": -59.55555555555556, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4067.0, "global_timestep_min": 2000, "global_timestep_max": 5700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-217.66777777777764, -234.6938888888889, -246.051111111111, -182.64388888888882, -206.5572222222222, -225.17222222222216, -224.7394444444443, -220.33611111111105, -229.36055555555552, -219.87111111111102, -238.37277777777766, -219.96666666666658, -212.98611111111103, -222.9911111111111, -254.50499999999988, -237.9827777777777, -212.49833333333342, -235.17166666666645, -231.13888888888886, -212.9788888888887, -219.87722222222212, -221.2566666666666, -208.81500000000008, -218.11055555555544, -216.74111111111108, -187.20999999999992, -210.18777777777768, -218.83499999999984, -225.31666666666666, -232.34499999999989, -218.1705555555554, -224.01444444444425, -230.87333333333322, -222.07277777777762, -240.84611111111107, -206.6788888888888, -229.4538888888888, -242.0244444444442, -241.34944444444434, -217.1816666666666, -233.4877777777777, -214.14722222222207, -216.50888888888866, -222.7816666666666, -223.20944444444433, -236.5688888888888, -217.69388888888878, -226.93888888888873, -228.37666666666647, -229.62555555555548, -216.41333333333316, -220.76499999999996, -190.08277777777784, -216.66166666666655, -207.0949999999999, -227.61333333333323, -213.38055555555542, -218.83611111111102, -211.85166666666666, -213.54555555555558, -210.6905555555555, -233.4805555555555, -209.77222222222193, -235.74888888888887, -216.15111111111102, -243.9627777777776, -212.24666666666653, -213.906111111111, -228.1477777777777, -220.7333333333332, -236.92555555555552, -223.97388888888884, -228.37166666666656, -207.1494444444444, -229.40833333333322, -217.64833333333323, -238.1794444444443, -236.7705555555553, -213.34722222222217, -238.2044444444444, -233.89722222222224, -225.2244444444444, -226.66111111111107, -213.89444444444422, -217.8033333333333, -214.68666666666658, -229.98944444444433, -209.88333333333316, -217.9566666666666, -201.72277777777762, -236.6694444444444, -221.71833333333333, -220.96888888888876, -189.8188888888889, -210.99222222222213, -237.66555555555553, -196.9333333333333, -223.00499999999982, -215.63555555555544, -234.49833333333325], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-217.66777777777764, -234.6938888888889, -246.051111111111, -182.64388888888882, -206.5572222222222, -225.17222222222216, -224.7394444444443, -220.33611111111105, -229.36055555555552, -219.87111111111102, -238.37277777777766, -219.96666666666658, -212.98611111111103, -222.9911111111111, -254.50499999999988, -237.9827777777777, -212.49833333333342, -235.17166666666645, -231.13888888888886, -212.9788888888887, -219.87722222222212, -221.2566666666666, -208.81500000000008, -218.11055555555544, -216.74111111111108, -187.20999999999992, -210.18777777777768, -218.83499999999984, -225.31666666666666, -232.34499999999989, -218.1705555555554, -224.01444444444425, -230.87333333333322, -222.07277777777762, -240.84611111111107, -206.6788888888888, -229.4538888888888, -242.0244444444442, -241.34944444444434, -217.1816666666666, -233.4877777777777, -214.14722222222207, -216.50888888888866, -222.7816666666666, -223.20944444444433, -236.5688888888888, -217.69388888888878, -226.93888888888873, -228.37666666666647, -229.62555555555548, -216.41333333333316, -220.76499999999996, -190.08277777777784, -216.66166666666655, -207.0949999999999, -227.61333333333323, -213.38055555555542, -218.83611111111102, -211.85166666666666, -213.54555555555558, -210.6905555555555, -233.4805555555555, -209.77222222222193, -235.74888888888887, -216.15111111111102, -243.9627777777776, -212.24666666666653, -213.906111111111, -228.1477777777777, -220.7333333333332, -236.92555555555552, -223.97388888888884, -228.37166666666656, -207.1494444444444, -229.40833333333322, -217.64833333333323, -238.1794444444443, -236.7705555555553, -213.34722222222217, -238.2044444444444, -233.89722222222224, -225.2244444444444, -226.66111111111107, -213.89444444444422, -217.8033333333333, -214.68666666666658, -229.98944444444433, -209.88333333333316, -217.9566666666666, -201.72277777777762, -236.6694444444444, -221.71833333333333, -220.96888888888876, -189.8188888888889, -210.99222222222213, -237.66555555555553, -196.9333333333333, -223.00499999999982, -215.63555555555544, -234.49833333333325]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19210384196429314, "mean_inference_ms": 1.780976831734385, "mean_action_processing_ms": 0.07320703779644448, "mean_env_wait_ms": 1.190556700689755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004406929016113281, "StateBufferConnector_ms": 0.0027856826782226562, "ViewRequirementAgentConnector_ms": 0.06236696243286133}, "num_episodes": 30, "episode_return_max": -182.64388888888882, "episode_return_min": -254.50499999999988, "episode_return_mean": -221.77073888888881, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64050, "num_agent_steps_trained": 63900, "num_env_steps_sampled": 64050, "num_env_steps_trained": 63900, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 304.0338012684312, "num_env_steps_trained_throughput_per_sec": 318.5116013288327, "timesteps_total": 64050, "num_env_steps_sampled_lifetime": 64050, "num_agent_steps_sampled_lifetime": 64050, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 64050, "timers": {"training_iteration_time_ms": 10305.874, "restore_workers_time_ms": 0.011, "training_step_time_ms": 487.594, "sample_time_ms": 474.357, "synch_weights_time_ms": 12.008}, "counters": {"num_env_steps_sampled": 64050, "num_env_steps_trained": 63900, "num_agent_steps_sampled": 64050, "num_agent_steps_trained": 63900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 427, "num_samples_added_to_queue": 63900}, "done": false, "training_iteration": 21, "trial_id": "0313d_00000", "date": "2024-10-10_21-45-00", "timestamp": 1728593100, "time_this_iter_s": 10.376197576522827, "time_total_s": 216.2445662021637, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d89690>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 216.2445662021637, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 10.706666666666667, "ram_util_percent": 51.22000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -225154.296875, "policy_loss": -225196.015625, "entropy": 29.80973243713379, "entropy_coeff": 0.01, "var_gnorm": 16.019309997558594, "vf_loss": 131148.34375, "vf_explained_var": 0.01858597993850708}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 223.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 67050, "num_env_steps_trained": 66900, "num_agent_steps_sampled": 67050, "num_agent_steps_trained": 66900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 447, "num_samples_added_to_queue": 66900, "learner_queue": {"size_count": 223, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 42.321, "learner_load_time_ms": 0.246, "learner_load_wait_time_ms": 969.7, "learner_dequeue_time_ms": 8065.687}}, "env_runners": {"episode_reward_max": -187.80111111111106, "episode_reward_min": -245.8555555555554, "episode_reward_mean": -221.63481666666652, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -245.8555555555554}, "policy_reward_max": {"default_policy": -187.80111111111106}, "policy_reward_mean": {"default_policy": -221.63481666666652}, "custom_metrics": {"num_consolidated_mean": 0.6802000000000001, "num_consolidated_min": 0.5, "num_consolidated_max": 0.82, "num_overloaded_mean": 1.0192999999999999, "num_overloaded_min": 0.85, "num_overloaded_max": 1.16, "num_moves_mean": 9.9752, "num_moves_min": 9.69, "num_moves_max": 10.38, "mean_accuracy_mean": 41.05224666666667, "mean_accuracy_min": 40.79599999999999, "mean_accuracy_max": 41.290000000000006, "num_model_switches_mean": 5.969799999999999, "num_model_switches_min": 5.47, "num_model_switches_max": 6.35, "num_slav_mean": 0.15876783333333333, "num_slav_min": 0.14248333333333335, "num_slav_max": 0.17908333333333332, "mean_cluster_cpu_util_mean": 0.5689910872682552, "mean_cluster_cpu_util_min": 0.5446544690816041, "mean_cluster_cpu_util_max": 0.5940052470755491, "mean_cluster_mem_util_mean": 0.36534414254678665, "mean_cluster_mem_util_min": 0.35315397327707454, "mean_cluster_mem_util_max": 0.37663566064611503, "reward_consolidation_mean_mean": 0.1758333333333333, "reward_consolidation_mean_min": 0.04166666666666666, "reward_consolidation_mean_max": 0.29166666666666663, "reward_illegal_mean_mean": -1.6988333333333336, "reward_illegal_mean_min": -1.9333333333333333, "reward_illegal_mean_max": -1.4166666666666663, "reward_accuracy_mean_mean": 0.4268018333333333, "reward_accuracy_mean_min": 0.22763333333333335, "reward_accuracy_mean_max": 0.6376833333333333, "reward_sla_mean_mean": -1.12015, "reward_sla_mean_min": -1.7322222222222223, "reward_sla_mean_max": -0.6177777777777778, "reward_consolidation_sum_mean": 17.583333333333332, "reward_consolidation_sum_min": 4.166666666666666, "reward_consolidation_sum_max": 29.166666666666664, "reward_illegal_sum_mean": -169.88333333333333, "reward_illegal_sum_min": -193.33333333333334, "reward_illegal_sum_max": -141.66666666666663, "reward_accuracy_sum_mean": 42.68018333333333, "reward_accuracy_sum_min": 22.763333333333335, "reward_accuracy_sum_max": 63.76833333333333, "reward_sla_sum_mean": -112.01500000000001, "reward_sla_sum_min": -173.22222222222223, "reward_sla_sum_max": -61.77777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5067.0, "global_timestep_min": 3000, "global_timestep_max": 6700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-218.1705555555554, -224.01444444444425, -230.87333333333322, -222.07277777777762, -240.84611111111107, -206.6788888888888, -229.4538888888888, -242.0244444444442, -241.34944444444434, -217.1816666666666, -233.4877777777777, -214.14722222222207, -216.50888888888866, -222.7816666666666, -223.20944444444433, -236.5688888888888, -217.69388888888878, -226.93888888888873, -228.37666666666647, -229.62555555555548, -216.41333333333316, -220.76499999999996, -190.08277777777784, -216.66166666666655, -207.0949999999999, -227.61333333333323, -213.38055555555542, -218.83611111111102, -211.85166666666666, -213.54555555555558, -210.6905555555555, -233.4805555555555, -209.77222222222193, -235.74888888888887, -216.15111111111102, -243.9627777777776, -212.24666666666653, -213.906111111111, -228.1477777777777, -220.7333333333332, -236.92555555555552, -223.97388888888884, -228.37166666666656, -207.1494444444444, -229.40833333333322, -217.64833333333323, -238.1794444444443, -236.7705555555553, -213.34722222222217, -238.2044444444444, -233.89722222222224, -225.2244444444444, -226.66111111111107, -213.89444444444422, -217.8033333333333, -214.68666666666658, -229.98944444444433, -209.88333333333316, -217.9566666666666, -201.72277777777762, -236.6694444444444, -221.71833333333333, -220.96888888888876, -189.8188888888889, -210.99222222222213, -237.66555555555553, -196.9333333333333, -223.00499999999982, -215.63555555555544, -234.49833333333325, -229.9533333333332, -220.03722222222208, -207.37277777777777, -222.79888888888883, -235.82944444444428, -236.297222222222, -209.61166666666662, -229.44111111111098, -239.9644444444443, -225.40722222222212, -212.12944444444432, -228.14555555555543, -207.01944444444428, -219.62944444444423, -219.3372222222221, -238.02777777777766, -187.80111111111106, -215.965, -229.50499999999997, -245.8555555555554, -208.22777777777762, -236.2022222222222, -195.84611111111113, -229.64388888888877, -225.33055555555558, -193.15277777777763, -212.52611111111105, -240.83555555555537, -209.07388888888886, -219.82055555555544], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-218.1705555555554, -224.01444444444425, -230.87333333333322, -222.07277777777762, -240.84611111111107, -206.6788888888888, -229.4538888888888, -242.0244444444442, -241.34944444444434, -217.1816666666666, -233.4877777777777, -214.14722222222207, -216.50888888888866, -222.7816666666666, -223.20944444444433, -236.5688888888888, -217.69388888888878, -226.93888888888873, -228.37666666666647, -229.62555555555548, -216.41333333333316, -220.76499999999996, -190.08277777777784, -216.66166666666655, -207.0949999999999, -227.61333333333323, -213.38055555555542, -218.83611111111102, -211.85166666666666, -213.54555555555558, -210.6905555555555, -233.4805555555555, -209.77222222222193, -235.74888888888887, -216.15111111111102, -243.9627777777776, -212.24666666666653, -213.906111111111, -228.1477777777777, -220.7333333333332, -236.92555555555552, -223.97388888888884, -228.37166666666656, -207.1494444444444, -229.40833333333322, -217.64833333333323, -238.1794444444443, -236.7705555555553, -213.34722222222217, -238.2044444444444, -233.89722222222224, -225.2244444444444, -226.66111111111107, -213.89444444444422, -217.8033333333333, -214.68666666666658, -229.98944444444433, -209.88333333333316, -217.9566666666666, -201.72277777777762, -236.6694444444444, -221.71833333333333, -220.96888888888876, -189.8188888888889, -210.99222222222213, -237.66555555555553, -196.9333333333333, -223.00499999999982, -215.63555555555544, -234.49833333333325, -229.9533333333332, -220.03722222222208, -207.37277777777777, -222.79888888888883, -235.82944444444428, -236.297222222222, -209.61166666666662, -229.44111111111098, -239.9644444444443, -225.40722222222212, -212.12944444444432, -228.14555555555543, -207.01944444444428, -219.62944444444423, -219.3372222222221, -238.02777777777766, -187.80111111111106, -215.965, -229.50499999999997, -245.8555555555554, -208.22777777777762, -236.2022222222222, -195.84611111111113, -229.64388888888877, -225.33055555555558, -193.15277777777763, -212.52611111111105, -240.83555555555537, -209.07388888888886, -219.82055555555544]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1918645009742718, "mean_inference_ms": 1.7786182222112918, "mean_action_processing_ms": 0.07313733190980608, "mean_env_wait_ms": 1.1898990202312623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004324913024902344, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.061905860900878906}, "num_episodes": 30, "episode_return_max": -187.80111111111106, "episode_return_min": -245.8555555555554, "episode_return_mean": -221.63481666666652, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67050, "num_agent_steps_trained": 66900, "num_env_steps_sampled": 67050, "num_env_steps_trained": 66900, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 297.5893251363373, "num_env_steps_trained_throughput_per_sec": 297.5893251363373, "timesteps_total": 67050, "num_env_steps_sampled_lifetime": 67050, "num_agent_steps_sampled_lifetime": 67050, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 67050, "timers": {"training_iteration_time_ms": 10285.642, "restore_workers_time_ms": 0.011, "training_step_time_ms": 498.179, "sample_time_ms": 483.592, "synch_weights_time_ms": 13.284}, "counters": {"num_env_steps_sampled": 67050, "num_env_steps_trained": 66900, "num_agent_steps_sampled": 67050, "num_agent_steps_trained": 66900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 447, "num_samples_added_to_queue": 66900}, "done": false, "training_iteration": 22, "trial_id": "0313d_00000", "date": "2024-10-10_21-45-11", "timestamp": 1728593111, "time_this_iter_s": 10.09023141860962, "time_total_s": 226.33479762077332, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42dca950>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 226.33479762077332, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 10.4, "ram_util_percent": 51.20714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -198482.375, "policy_loss": -198497.0, "entropy": 29.807714462280273, "entropy_coeff": 0.01, "var_gnorm": 16.021831512451172, "vf_loss": 104040.703125, "vf_explained_var": 0.02183431386947632}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 234.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 70350, "num_env_steps_trained": 70200, "num_agent_steps_sampled": 70350, "num_agent_steps_trained": 70200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 469, "num_samples_added_to_queue": 70200, "learner_queue": {"size_count": 234, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 46.791, "learner_load_time_ms": 0.255, "learner_load_wait_time_ms": 895.555, "learner_dequeue_time_ms": 8018.868}}, "env_runners": {"episode_reward_max": -187.80111111111106, "episode_reward_min": -245.8555555555554, "episode_reward_mean": -221.36964444444436, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -245.8555555555554}, "policy_reward_max": {"default_policy": -187.80111111111106}, "policy_reward_mean": {"default_policy": -221.36964444444436}, "custom_metrics": {"num_consolidated_mean": 0.6804000000000001, "num_consolidated_min": 0.52, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0193, "num_overloaded_min": 0.85, "num_overloaded_max": 1.19, "num_moves_mean": 9.9653, "num_moves_min": 9.66, "num_moves_max": 10.22, "mean_accuracy_mean": 41.04933333333334, "mean_accuracy_min": 40.79599999999999, "mean_accuracy_max": 41.290000000000006, "num_model_switches_mean": 5.9948000000000015, "num_model_switches_min": 5.47, "num_model_switches_max": 6.39, "num_slav_mean": 0.15888583333333334, "num_slav_min": 0.14248333333333335, "num_slav_max": 0.17785, "mean_cluster_cpu_util_mean": 0.567941638149669, "mean_cluster_cpu_util_min": 0.5512104150829216, "mean_cluster_cpu_util_max": 0.5897541227415557, "mean_cluster_mem_util_mean": 0.36493934330061145, "mean_cluster_mem_util_min": 0.3561214527899768, "mean_cluster_mem_util_max": 0.375505377414679, "reward_consolidation_mean_mean": 0.17888888888888893, "reward_consolidation_mean_min": 0.04166666666666666, "reward_consolidation_mean_max": 0.33333333333333326, "reward_illegal_mean_mean": -1.6988333333333332, "reward_illegal_mean_min": -1.9833333333333332, "reward_illegal_mean_max": -1.4166666666666663, "reward_accuracy_mean_mean": 0.43453133333333327, "reward_accuracy_mean_min": 0.2643, "reward_accuracy_mean_max": 0.6145999999999999, "reward_sla_mean_mean": -1.1282833333333333, "reward_sla_mean_min": -1.6133333333333335, "reward_sla_mean_max": -0.5733333333333334, "reward_consolidation_sum_mean": 17.888888888888893, "reward_consolidation_sum_min": 4.166666666666666, "reward_consolidation_sum_max": 33.33333333333333, "reward_illegal_sum_mean": -169.8833333333333, "reward_illegal_sum_min": -198.33333333333331, "reward_illegal_sum_max": -141.66666666666663, "reward_accuracy_sum_mean": 43.45313333333334, "reward_accuracy_sum_min": 26.43, "reward_accuracy_sum_max": 61.459999999999994, "reward_sla_sum_mean": -112.82833333333332, "reward_sla_sum_min": -161.33333333333334, "reward_sla_sum_max": -57.333333333333336, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6167.0, "global_timestep_min": 4100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-235.74888888888887, -216.15111111111102, -243.9627777777776, -212.24666666666653, -213.906111111111, -228.1477777777777, -220.7333333333332, -236.92555555555552, -223.97388888888884, -228.37166666666656, -207.1494444444444, -229.40833333333322, -217.64833333333323, -238.1794444444443, -236.7705555555553, -213.34722222222217, -238.2044444444444, -233.89722222222224, -225.2244444444444, -226.66111111111107, -213.89444444444422, -217.8033333333333, -214.68666666666658, -229.98944444444433, -209.88333333333316, -217.9566666666666, -201.72277777777762, -236.6694444444444, -221.71833333333333, -220.96888888888876, -189.8188888888889, -210.99222222222213, -237.66555555555553, -196.9333333333333, -223.00499999999982, -215.63555555555544, -234.49833333333325, -229.9533333333332, -220.03722222222208, -207.37277777777777, -222.79888888888883, -235.82944444444428, -236.297222222222, -209.61166666666662, -229.44111111111098, -239.9644444444443, -225.40722222222212, -212.12944444444432, -228.14555555555543, -207.01944444444428, -219.62944444444423, -219.3372222222221, -238.02777777777766, -187.80111111111106, -215.965, -229.50499999999997, -245.8555555555554, -208.22777777777762, -236.2022222222222, -195.84611111111113, -229.64388888888877, -225.33055555555558, -193.15277777777763, -212.52611111111105, -240.83555555555537, -209.07388888888886, -219.82055555555544, -213.63555555555536, -212.3477777777778, -210.75833333333327, -230.9072222222222, -226.30499999999995, -216.6688888888888, -231.35111111111107, -201.79999999999993, -215.6322222222221, -214.6755555555555, -201.3599999999999, -239.47055555555542, -215.32888888888888, -212.39722222222215, -225.84500000000003, -214.21222222222212, -221.04111111111106, -236.19277777777768, -210.91833333333335, -230.69722222222214, -242.20999999999995, -218.35611111111092, -219.51444444444442, -218.67277777777772, -225.27888888888882, -215.34611111111104, -229.69999999999993, -231.75666666666666, -220.32888888888877, -232.93999999999997, -218.646111111111, -225.8555555555554, -205.52499999999992], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-235.74888888888887, -216.15111111111102, -243.9627777777776, -212.24666666666653, -213.906111111111, -228.1477777777777, -220.7333333333332, -236.92555555555552, -223.97388888888884, -228.37166666666656, -207.1494444444444, -229.40833333333322, -217.64833333333323, -238.1794444444443, -236.7705555555553, -213.34722222222217, -238.2044444444444, -233.89722222222224, -225.2244444444444, -226.66111111111107, -213.89444444444422, -217.8033333333333, -214.68666666666658, -229.98944444444433, -209.88333333333316, -217.9566666666666, -201.72277777777762, -236.6694444444444, -221.71833333333333, -220.96888888888876, -189.8188888888889, -210.99222222222213, -237.66555555555553, -196.9333333333333, -223.00499999999982, -215.63555555555544, -234.49833333333325, -229.9533333333332, -220.03722222222208, -207.37277777777777, -222.79888888888883, -235.82944444444428, -236.297222222222, -209.61166666666662, -229.44111111111098, -239.9644444444443, -225.40722222222212, -212.12944444444432, -228.14555555555543, -207.01944444444428, -219.62944444444423, -219.3372222222221, -238.02777777777766, -187.80111111111106, -215.965, -229.50499999999997, -245.8555555555554, -208.22777777777762, -236.2022222222222, -195.84611111111113, -229.64388888888877, -225.33055555555558, -193.15277777777763, -212.52611111111105, -240.83555555555537, -209.07388888888886, -219.82055555555544, -213.63555555555536, -212.3477777777778, -210.75833333333327, -230.9072222222222, -226.30499999999995, -216.6688888888888, -231.35111111111107, -201.79999999999993, -215.6322222222221, -214.6755555555555, -201.3599999999999, -239.47055555555542, -215.32888888888888, -212.39722222222215, -225.84500000000003, -214.21222222222212, -221.04111111111106, -236.19277777777768, -210.91833333333335, -230.69722222222214, -242.20999999999995, -218.35611111111092, -219.51444444444442, -218.67277777777772, -225.27888888888882, -215.34611111111104, -229.69999999999993, -231.75666666666666, -220.32888888888877, -232.93999999999997, -218.646111111111, -225.8555555555554, -205.52499999999992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19158720933196738, "mean_inference_ms": 1.7751465151269128, "mean_action_processing_ms": 0.07304570400825644, "mean_env_wait_ms": 1.188775738476683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004181623458862305, "StateBufferConnector_ms": 0.002756834030151367, "ViewRequirementAgentConnector_ms": 0.06145954132080078}, "num_episodes": 33, "episode_return_max": -187.80111111111106, "episode_return_min": -245.8555555555554, "episode_return_mean": -221.36964444444436, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70350, "num_agent_steps_trained": 70200, "num_env_steps_sampled": 70350, "num_env_steps_trained": 70200, "num_env_steps_sampled_this_iter": 3300, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 315.69746504427786, "num_env_steps_trained_throughput_per_sec": 315.69746504427786, "timesteps_total": 70350, "num_env_steps_sampled_lifetime": 70350, "num_agent_steps_sampled_lifetime": 70350, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 70350, "timers": {"training_iteration_time_ms": 10290.908, "restore_workers_time_ms": 0.013, "training_step_time_ms": 477.831, "sample_time_ms": 464.186, "synch_weights_time_ms": 12.286}, "counters": {"num_env_steps_sampled": 70350, "num_env_steps_trained": 70200, "num_agent_steps_sampled": 70350, "num_agent_steps_trained": 70200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 469, "num_samples_added_to_queue": 70200}, "done": false, "training_iteration": 23, "trial_id": "0313d_00000", "date": "2024-10-10_21-45-21", "timestamp": 1728593121, "time_this_iter_s": 10.473435878753662, "time_total_s": 236.80823349952698, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42dcb6d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 236.80823349952698, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 10.526666666666667, "ram_util_percent": 51.359999999999985}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -200961.296875, "policy_loss": -200978.984375, "entropy": 29.8056640625, "entropy_coeff": 0.01, "var_gnorm": 16.023866653442383, "vf_loss": 107113.9765625, "vf_explained_var": 0.02312290668487549}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 244.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 73500, "num_env_steps_trained": 73200, "num_agent_steps_sampled": 73500, "num_agent_steps_trained": 73200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 490, "num_samples_added_to_queue": 73500, "learner_queue": {"size_count": 244, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.417, "learner_load_time_ms": 0.27, "learner_load_wait_time_ms": 933.399, "learner_dequeue_time_ms": 8017.66}}, "env_runners": {"episode_reward_max": -187.80111111111106, "episode_reward_min": -245.8555555555554, "episode_reward_mean": -220.523361111111, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -245.8555555555554}, "policy_reward_max": {"default_policy": -187.80111111111106}, "policy_reward_mean": {"default_policy": -220.523361111111}, "custom_metrics": {"num_consolidated_mean": 0.679, "num_consolidated_min": 0.55, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0275999999999998, "num_overloaded_min": 0.85, "num_overloaded_max": 1.19, "num_moves_mean": 9.970400000000001, "num_moves_min": 9.64, "num_moves_max": 10.22, "mean_accuracy_mean": 41.05066333333333, "mean_accuracy_min": 40.80233333333334, "mean_accuracy_max": 41.290000000000006, "num_model_switches_mean": 6.0124, "num_model_switches_min": 5.47, "num_model_switches_max": 6.39, "num_slav_mean": 0.15927583333333334, "num_slav_min": 0.14248333333333335, "num_slav_max": 0.1758166666666667, "mean_cluster_cpu_util_mean": 0.5684572890617334, "mean_cluster_cpu_util_min": 0.5501471339929335, "mean_cluster_cpu_util_max": 0.5887283388859675, "mean_cluster_mem_util_mean": 0.3651281613780533, "mean_cluster_mem_util_min": 0.3561214527899768, "mean_cluster_mem_util_max": 0.3743535312437211, "reward_consolidation_mean_mean": 0.17805555555555552, "reward_consolidation_mean_min": 0.04166666666666666, "reward_consolidation_mean_max": 0.34722222222222215, "reward_illegal_mean_mean": -1.7126666666666666, "reward_illegal_mean_min": -1.9833333333333332, "reward_illegal_mean_max": -1.4166666666666663, "reward_accuracy_mean_mean": 0.42944416666666657, "reward_accuracy_mean_min": 0.22541666666666665, "reward_accuracy_mean_max": 0.5931000000000001, "reward_sla_mean_mean": -1.1000666666666667, "reward_sla_mean_min": -1.6133333333333335, "reward_sla_mean_max": -0.5733333333333334, "reward_consolidation_sum_mean": 17.805555555555554, "reward_consolidation_sum_min": 4.166666666666666, "reward_consolidation_sum_max": 34.722222222222214, "reward_illegal_sum_mean": -171.2666666666666, "reward_illegal_sum_min": -198.33333333333331, "reward_illegal_sum_max": -141.66666666666663, "reward_accuracy_sum_mean": 42.944416666666676, "reward_accuracy_sum_min": 22.541666666666664, "reward_accuracy_sum_max": 59.31000000000001, "reward_sla_sum_mean": -110.00666666666667, "reward_sla_sum_min": -161.33333333333334, "reward_sla_sum_max": -57.333333333333336, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4704.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-196.9333333333333, -223.00499999999982, -215.63555555555544, -234.49833333333325, -229.9533333333332, -220.03722222222208, -207.37277777777777, -222.79888888888883, -235.82944444444428, -236.297222222222, -209.61166666666662, -229.44111111111098, -239.9644444444443, -225.40722222222212, -212.12944444444432, -228.14555555555543, -207.01944444444428, -219.62944444444423, -219.3372222222221, -238.02777777777766, -187.80111111111106, -215.965, -229.50499999999997, -245.8555555555554, -208.22777777777762, -236.2022222222222, -195.84611111111113, -229.64388888888877, -225.33055555555558, -193.15277777777763, -212.52611111111105, -240.83555555555537, -209.07388888888886, -219.82055555555544, -213.63555555555536, -212.3477777777778, -210.75833333333327, -230.9072222222222, -226.30499999999995, -216.6688888888888, -231.35111111111107, -201.79999999999993, -215.6322222222221, -214.6755555555555, -201.3599999999999, -239.47055555555542, -215.32888888888888, -212.39722222222215, -225.84500000000003, -214.21222222222212, -221.04111111111106, -236.19277777777768, -210.91833333333335, -230.69722222222214, -242.20999999999995, -218.35611111111092, -219.51444444444442, -218.67277777777772, -225.27888888888882, -215.34611111111104, -229.69999999999993, -231.75666666666666, -220.32888888888877, -232.93999999999997, -218.646111111111, -225.8555555555554, -205.52499999999992, -225.8988888888888, -236.3777777777778, -236.25833333333327, -235.64444444444442, -229.89499999999998, -234.8127777777778, -214.94111111111098, -213.43111111111102, -219.9816666666665, -215.1222222222222, -211.9883333333332, -226.01222222222225, -215.6294444444444, -234.20055555555552, -209.09555555555542, -221.85611111111092, -212.2655555555555, -202.01166666666663, -221.90722222222215, -232.05111111111103, -212.15999999999997, -201.571111111111, -228.9061111111111, -199.42833333333328, -209.126111111111, -223.4233333333332, -226.411111111111, -206.08333333333323, -222.32833333333326, -227.98444444444445, -232.80555555555534, -206.78833333333324, -219.40277777777777], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-196.9333333333333, -223.00499999999982, -215.63555555555544, -234.49833333333325, -229.9533333333332, -220.03722222222208, -207.37277777777777, -222.79888888888883, -235.82944444444428, -236.297222222222, -209.61166666666662, -229.44111111111098, -239.9644444444443, -225.40722222222212, -212.12944444444432, -228.14555555555543, -207.01944444444428, -219.62944444444423, -219.3372222222221, -238.02777777777766, -187.80111111111106, -215.965, -229.50499999999997, -245.8555555555554, -208.22777777777762, -236.2022222222222, -195.84611111111113, -229.64388888888877, -225.33055555555558, -193.15277777777763, -212.52611111111105, -240.83555555555537, -209.07388888888886, -219.82055555555544, -213.63555555555536, -212.3477777777778, -210.75833333333327, -230.9072222222222, -226.30499999999995, -216.6688888888888, -231.35111111111107, -201.79999999999993, -215.6322222222221, -214.6755555555555, -201.3599999999999, -239.47055555555542, -215.32888888888888, -212.39722222222215, -225.84500000000003, -214.21222222222212, -221.04111111111106, -236.19277777777768, -210.91833333333335, -230.69722222222214, -242.20999999999995, -218.35611111111092, -219.51444444444442, -218.67277777777772, -225.27888888888882, -215.34611111111104, -229.69999999999993, -231.75666666666666, -220.32888888888877, -232.93999999999997, -218.646111111111, -225.8555555555554, -205.52499999999992, -225.8988888888888, -236.3777777777778, -236.25833333333327, -235.64444444444442, -229.89499999999998, -234.8127777777778, -214.94111111111098, -213.43111111111102, -219.9816666666665, -215.1222222222222, -211.9883333333332, -226.01222222222225, -215.6294444444444, -234.20055555555552, -209.09555555555542, -221.85611111111092, -212.2655555555555, -202.01166666666663, -221.90722222222215, -232.05111111111103, -212.15999999999997, -201.571111111111, -228.9061111111111, -199.42833333333328, -209.126111111111, -223.4233333333332, -226.411111111111, -206.08333333333323, -222.32833333333326, -227.98444444444445, -232.80555555555534, -206.78833333333324, -219.40277777777777]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19134299491747883, "mean_inference_ms": 1.7740058561896372, "mean_action_processing_ms": 0.07297852042294865, "mean_env_wait_ms": 1.1881338406636226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037577152252197266, "StateBufferConnector_ms": 0.002732992172241211, "ViewRequirementAgentConnector_ms": 0.06058216094970703}, "num_episodes": 33, "episode_return_max": -187.80111111111106, "episode_return_min": -245.8555555555554, "episode_return_mean": -220.523361111111, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73500, "num_agent_steps_trained": 73200, "num_env_steps_sampled": 73500, "num_env_steps_trained": 73200, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 302.20541053746695, "num_env_steps_trained_throughput_per_sec": 287.81467670234946, "timesteps_total": 73500, "num_env_steps_sampled_lifetime": 73500, "num_agent_steps_sampled_lifetime": 73500, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 73500, "timers": {"training_iteration_time_ms": 10310.238, "restore_workers_time_ms": 0.011, "training_step_time_ms": 504.826, "sample_time_ms": 491.131, "synch_weights_time_ms": 12.469}, "counters": {"num_env_steps_sampled": 73500, "num_env_steps_trained": 73200, "num_agent_steps_sampled": 73500, "num_agent_steps_trained": 73200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 490, "num_samples_added_to_queue": 73500}, "done": false, "training_iteration": 24, "trial_id": "0313d_00000", "date": "2024-10-10_21-45-32", "timestamp": 1728593132, "time_this_iter_s": 10.442147493362427, "time_total_s": 247.2503809928894, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c29780>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 247.2503809928894, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 10.56, "ram_util_percent": 51.640000000000015}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -210561.1875, "policy_loss": -210587.1875, "entropy": 29.802871704101562, "entropy_coeff": 0.01, "var_gnorm": 16.026643753051758, "vf_loss": 115410.375, "vf_explained_var": 0.026641428470611572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 254.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 76350, "num_env_steps_trained": 76200, "num_agent_steps_sampled": 76350, "num_agent_steps_trained": 76200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 509, "num_samples_added_to_queue": 76200, "learner_queue": {"size_count": 254, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 68.428, "learner_load_time_ms": 0.25, "learner_load_wait_time_ms": 1007.394, "learner_dequeue_time_ms": 8074.544}}, "env_runners": {"episode_reward_max": -193.15277777777763, "episode_reward_min": -242.27722222222226, "episode_reward_mean": -219.4687277777777, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -242.27722222222226}, "policy_reward_max": {"default_policy": -193.15277777777763}, "policy_reward_mean": {"default_policy": -219.4687277777777}, "custom_metrics": {"num_consolidated_mean": 0.6806, "num_consolidated_min": 0.49, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.033, "num_overloaded_min": 0.86, "num_overloaded_max": 1.19, "num_moves_mean": 9.9913, "num_moves_min": 9.64, "num_moves_max": 10.29, "mean_accuracy_mean": 41.04027666666666, "mean_accuracy_min": 40.75166666666666, "mean_accuracy_max": 41.270999999999994, "num_model_switches_mean": 6.0397, "num_model_switches_min": 5.57, "num_model_switches_max": 6.4, "num_slav_mean": 0.15891616666666666, "num_slav_min": 0.1442, "num_slav_max": 0.1758166666666667, "mean_cluster_cpu_util_mean": 0.5683140244683559, "mean_cluster_cpu_util_min": 0.5446415197147687, "mean_cluster_cpu_util_max": 0.5887283388859675, "mean_cluster_mem_util_mean": 0.36505267342095066, "mean_cluster_mem_util_min": 0.3558599026952553, "mean_cluster_mem_util_max": 0.3743535312437211, "reward_consolidation_mean_mean": 0.17944444444444443, "reward_consolidation_mean_min": 0.08333333333333331, "reward_consolidation_mean_max": 0.34722222222222215, "reward_illegal_mean_mean": -1.7216666666666667, "reward_illegal_mean_min": -1.9833333333333332, "reward_illegal_mean_max": -1.4333333333333331, "reward_accuracy_mean_mean": 0.4221404999999999, "reward_accuracy_mean_min": 0.22541666666666665, "reward_accuracy_mean_max": 0.6531666666666667, "reward_sla_mean_mean": -1.0746055555555556, "reward_sla_mean_min": -1.7949999999999997, "reward_sla_mean_max": -0.5733333333333334, "reward_consolidation_sum_mean": 17.944444444444443, "reward_consolidation_sum_min": 8.333333333333332, "reward_consolidation_sum_max": 34.722222222222214, "reward_illegal_sum_mean": -172.16666666666663, "reward_illegal_sum_min": -198.33333333333331, "reward_illegal_sum_max": -143.33333333333331, "reward_accuracy_sum_mean": 42.21405, "reward_accuracy_sum_min": 22.541666666666664, "reward_accuracy_sum_max": 65.31666666666666, "reward_sla_sum_mean": -107.46055555555559, "reward_sla_sum_min": -179.49999999999997, "reward_sla_sum_max": -57.333333333333336, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3487.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-229.64388888888877, -225.33055555555558, -193.15277777777763, -212.52611111111105, -240.83555555555537, -209.07388888888886, -219.82055555555544, -213.63555555555536, -212.3477777777778, -210.75833333333327, -230.9072222222222, -226.30499999999995, -216.6688888888888, -231.35111111111107, -201.79999999999993, -215.6322222222221, -214.6755555555555, -201.3599999999999, -239.47055555555542, -215.32888888888888, -212.39722222222215, -225.84500000000003, -214.21222222222212, -221.04111111111106, -236.19277777777768, -210.91833333333335, -230.69722222222214, -242.20999999999995, -218.35611111111092, -219.51444444444442, -218.67277777777772, -225.27888888888882, -215.34611111111104, -229.69999999999993, -231.75666666666666, -220.32888888888877, -232.93999999999997, -218.646111111111, -225.8555555555554, -205.52499999999992, -225.8988888888888, -236.3777777777778, -236.25833333333327, -235.64444444444442, -229.89499999999998, -234.8127777777778, -214.94111111111098, -213.43111111111102, -219.9816666666665, -215.1222222222222, -211.9883333333332, -226.01222222222225, -215.6294444444444, -234.20055555555552, -209.09555555555542, -221.85611111111092, -212.2655555555555, -202.01166666666663, -221.90722222222215, -232.05111111111103, -212.15999999999997, -201.571111111111, -228.9061111111111, -199.42833333333328, -209.126111111111, -223.4233333333332, -226.411111111111, -206.08333333333323, -222.32833333333326, -227.98444444444445, -232.80555555555534, -206.78833333333324, -219.40277777777777, -207.4372222222221, -231.02666666666656, -222.0877777777777, -219.9149999999999, -196.53055555555554, -208.28666666666655, -209.6238888888888, -210.81111111111105, -204.92333333333326, -242.27722222222226, -216.19888888888872, -204.14388888888868, -225.25111111111113, -228.95500000000004, -216.19333333333327, -222.7577777777779, -197.21888888888873, -214.88611111111098, -241.2172222222221, -209.49999999999991, -203.63333333333324, -238.05999999999997, -218.40611111111104, -232.5166666666665, -202.33444444444436, -202.206111111111, -238.6155555555555], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-229.64388888888877, -225.33055555555558, -193.15277777777763, -212.52611111111105, -240.83555555555537, -209.07388888888886, -219.82055555555544, -213.63555555555536, -212.3477777777778, -210.75833333333327, -230.9072222222222, -226.30499999999995, -216.6688888888888, -231.35111111111107, -201.79999999999993, -215.6322222222221, -214.6755555555555, -201.3599999999999, -239.47055555555542, -215.32888888888888, -212.39722222222215, -225.84500000000003, -214.21222222222212, -221.04111111111106, -236.19277777777768, -210.91833333333335, -230.69722222222214, -242.20999999999995, -218.35611111111092, -219.51444444444442, -218.67277777777772, -225.27888888888882, -215.34611111111104, -229.69999999999993, -231.75666666666666, -220.32888888888877, -232.93999999999997, -218.646111111111, -225.8555555555554, -205.52499999999992, -225.8988888888888, -236.3777777777778, -236.25833333333327, -235.64444444444442, -229.89499999999998, -234.8127777777778, -214.94111111111098, -213.43111111111102, -219.9816666666665, -215.1222222222222, -211.9883333333332, -226.01222222222225, -215.6294444444444, -234.20055555555552, -209.09555555555542, -221.85611111111092, -212.2655555555555, -202.01166666666663, -221.90722222222215, -232.05111111111103, -212.15999999999997, -201.571111111111, -228.9061111111111, -199.42833333333328, -209.126111111111, -223.4233333333332, -226.411111111111, -206.08333333333323, -222.32833333333326, -227.98444444444445, -232.80555555555534, -206.78833333333324, -219.40277777777777, -207.4372222222221, -231.02666666666656, -222.0877777777777, -219.9149999999999, -196.53055555555554, -208.28666666666655, -209.6238888888888, -210.81111111111105, -204.92333333333326, -242.27722222222226, -216.19888888888872, -204.14388888888868, -225.25111111111113, -228.95500000000004, -216.19333333333327, -222.7577777777779, -197.21888888888873, -214.88611111111098, -241.2172222222221, -209.49999999999991, -203.63333333333324, -238.05999999999997, -218.40611111111104, -232.5166666666665, -202.33444444444436, -202.206111111111, -238.6155555555555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19128077165243268, "mean_inference_ms": 1.7716334573423447, "mean_action_processing_ms": 0.07296545516037656, "mean_env_wait_ms": 1.187653065590824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040247440338134766, "StateBufferConnector_ms": 0.002816438674926758, "ViewRequirementAgentConnector_ms": 0.06356430053710938}, "num_episodes": 27, "episode_return_max": -193.15277777777763, "episode_return_min": -242.27722222222226, "episode_return_mean": -219.4687277777777, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76350, "num_agent_steps_trained": 76200, "num_env_steps_sampled": 76350, "num_env_steps_trained": 76200, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 278.47736948593433, "num_env_steps_trained_throughput_per_sec": 293.13407314308876, "timesteps_total": 76350, "num_env_steps_sampled_lifetime": 76350, "num_agent_steps_sampled_lifetime": 76350, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 76350, "timers": {"training_iteration_time_ms": 10297.994, "restore_workers_time_ms": 0.011, "training_step_time_ms": 539.63, "sample_time_ms": 524.662, "synch_weights_time_ms": 13.564}, "counters": {"num_env_steps_sampled": 76350, "num_env_steps_trained": 76200, "num_agent_steps_sampled": 76350, "num_agent_steps_trained": 76200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 509, "num_samples_added_to_queue": 76200}, "done": false, "training_iteration": 25, "trial_id": "0313d_00000", "date": "2024-10-10_21-45-42", "timestamp": 1728593142, "time_this_iter_s": 10.248533725738525, "time_total_s": 257.49891471862793, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42dc9240>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 257.49891471862793, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 13.086666666666668, "ram_util_percent": 51.826666666666675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -206318.609375, "policy_loss": -206345.46875, "entropy": 29.801776885986328, "entropy_coeff": 0.01, "var_gnorm": 16.028913497924805, "vf_loss": 116267.6015625, "vf_explained_var": 0.02479761838912964}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 264.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 79500, "num_env_steps_trained": 79200, "num_agent_steps_sampled": 79500, "num_agent_steps_trained": 79200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 530, "num_samples_added_to_queue": 79500, "learner_queue": {"size_count": 264, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.22, "learner_load_time_ms": 0.253, "learner_load_wait_time_ms": 941.265, "learner_dequeue_time_ms": 8006.032}}, "env_runners": {"episode_reward_max": -189.18222222222207, "episode_reward_min": -262.8383333333333, "episode_reward_mean": -219.5457666666666, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -262.8383333333333}, "policy_reward_max": {"default_policy": -189.18222222222207}, "policy_reward_mean": {"default_policy": -219.5457666666666}, "custom_metrics": {"num_consolidated_mean": 0.6787000000000001, "num_consolidated_min": 0.49, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0313999999999999, "num_overloaded_min": 0.86, "num_overloaded_max": 1.16, "num_moves_mean": 9.9878, "num_moves_min": 9.64, "num_moves_max": 10.29, "mean_accuracy_mean": 41.030903333333335, "mean_accuracy_min": 40.75166666666666, "mean_accuracy_max": 41.270999999999994, "num_model_switches_mean": 6.0151, "num_model_switches_min": 5.65, "num_model_switches_max": 6.4, "num_slav_mean": 0.15702666666666665, "num_slav_min": 0.13898333333333335, "num_slav_max": 0.17325000000000002, "mean_cluster_cpu_util_mean": 0.5681792681024448, "mean_cluster_cpu_util_min": 0.5446415197147687, "mean_cluster_cpu_util_max": 0.5887283388859675, "mean_cluster_mem_util_mean": 0.36483675192492604, "mean_cluster_mem_util_min": 0.3558599026952553, "mean_cluster_mem_util_max": 0.37407907983868655, "reward_consolidation_mean_mean": 0.17513888888888884, "reward_consolidation_mean_min": 0.06944444444444443, "reward_consolidation_mean_max": 0.34722222222222215, "reward_illegal_mean_mean": -1.7189999999999994, "reward_illegal_mean_min": -1.9333333333333331, "reward_illegal_mean_max": -1.4333333333333331, "reward_accuracy_mean_mean": 0.419659, "reward_accuracy_mean_min": 0.22383333333333333, "reward_accuracy_mean_max": 0.6531666666666667, "reward_sla_mean_mean": -1.0712555555555554, "reward_sla_mean_min": -1.7949999999999997, "reward_sla_mean_max": -0.4883333333333333, "reward_consolidation_sum_mean": 17.513888888888886, "reward_consolidation_sum_min": 6.944444444444444, "reward_consolidation_sum_max": 34.722222222222214, "reward_illegal_sum_mean": -171.89999999999998, "reward_illegal_sum_min": -193.33333333333331, "reward_illegal_sum_max": -143.33333333333331, "reward_accuracy_sum_mean": 41.965900000000005, "reward_accuracy_sum_min": 22.383333333333333, "reward_accuracy_sum_max": 65.31666666666666, "reward_sla_sum_mean": -107.12555555555556, "reward_sla_sum_min": -179.49999999999997, "reward_sla_sum_max": -48.83333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2013.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-229.69999999999993, -231.75666666666666, -220.32888888888877, -232.93999999999997, -218.646111111111, -225.8555555555554, -205.52499999999992, -225.8988888888888, -236.3777777777778, -236.25833333333327, -235.64444444444442, -229.89499999999998, -234.8127777777778, -214.94111111111098, -213.43111111111102, -219.9816666666665, -215.1222222222222, -211.9883333333332, -226.01222222222225, -215.6294444444444, -234.20055555555552, -209.09555555555542, -221.85611111111092, -212.2655555555555, -202.01166666666663, -221.90722222222215, -232.05111111111103, -212.15999999999997, -201.571111111111, -228.9061111111111, -199.42833333333328, -209.126111111111, -223.4233333333332, -226.411111111111, -206.08333333333323, -222.32833333333326, -227.98444444444445, -232.80555555555534, -206.78833333333324, -219.40277777777777, -207.4372222222221, -231.02666666666656, -222.0877777777777, -219.9149999999999, -196.53055555555554, -208.28666666666655, -209.6238888888888, -210.81111111111105, -204.92333333333326, -242.27722222222226, -216.19888888888872, -204.14388888888868, -225.25111111111113, -228.95500000000004, -216.19333333333327, -222.7577777777779, -197.21888888888873, -214.88611111111098, -241.2172222222221, -209.49999999999991, -203.63333333333324, -238.05999999999997, -218.40611111111104, -232.5166666666665, -202.33444444444436, -202.206111111111, -238.6155555555555, -244.29999999999998, -224.60444444444445, -216.4377777777778, -262.8383333333333, -221.96833333333322, -198.01111111111112, -241.43333333333322, -206.76333333333335, -227.91111111111087, -228.29833333333323, -202.62777777777782, -227.54277777777781, -230.97666666666666, -228.321111111111, -222.931111111111, -201.7877777777777, -221.79500000000004, -240.6555555555555, -199.10444444444443, -224.4072222222222, -227.27555555555546, -228.2172222222221, -253.13111111111104, -213.99611111111108, -189.18222222222207, -198.09666666666655, -225.35666666666657, -210.15611111111107, -197.02944444444435, -227.58222222222224, -200.89444444444436, -207.0816666666666, -208.29555555555544], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-229.69999999999993, -231.75666666666666, -220.32888888888877, -232.93999999999997, -218.646111111111, -225.8555555555554, -205.52499999999992, -225.8988888888888, -236.3777777777778, -236.25833333333327, -235.64444444444442, -229.89499999999998, -234.8127777777778, -214.94111111111098, -213.43111111111102, -219.9816666666665, -215.1222222222222, -211.9883333333332, -226.01222222222225, -215.6294444444444, -234.20055555555552, -209.09555555555542, -221.85611111111092, -212.2655555555555, -202.01166666666663, -221.90722222222215, -232.05111111111103, -212.15999999999997, -201.571111111111, -228.9061111111111, -199.42833333333328, -209.126111111111, -223.4233333333332, -226.411111111111, -206.08333333333323, -222.32833333333326, -227.98444444444445, -232.80555555555534, -206.78833333333324, -219.40277777777777, -207.4372222222221, -231.02666666666656, -222.0877777777777, -219.9149999999999, -196.53055555555554, -208.28666666666655, -209.6238888888888, -210.81111111111105, -204.92333333333326, -242.27722222222226, -216.19888888888872, -204.14388888888868, -225.25111111111113, -228.95500000000004, -216.19333333333327, -222.7577777777779, -197.21888888888873, -214.88611111111098, -241.2172222222221, -209.49999999999991, -203.63333333333324, -238.05999999999997, -218.40611111111104, -232.5166666666665, -202.33444444444436, -202.206111111111, -238.6155555555555, -244.29999999999998, -224.60444444444445, -216.4377777777778, -262.8383333333333, -221.96833333333322, -198.01111111111112, -241.43333333333322, -206.76333333333335, -227.91111111111087, -228.29833333333323, -202.62777777777782, -227.54277777777781, -230.97666666666666, -228.321111111111, -222.931111111111, -201.7877777777777, -221.79500000000004, -240.6555555555555, -199.10444444444443, -224.4072222222222, -227.27555555555546, -228.2172222222221, -253.13111111111104, -213.99611111111108, -189.18222222222207, -198.09666666666655, -225.35666666666657, -210.15611111111107, -197.02944444444435, -227.58222222222224, -200.89444444444436, -207.0816666666666, -208.29555555555544]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19137737072930655, "mean_inference_ms": 1.771664613284043, "mean_action_processing_ms": 0.07302087337413116, "mean_env_wait_ms": 1.1882739006384944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004115581512451172, "StateBufferConnector_ms": 0.002870321273803711, "ViewRequirementAgentConnector_ms": 0.06485390663146973}, "num_episodes": 33, "episode_return_max": -189.18222222222207, "episode_return_min": -262.8383333333333, "episode_return_mean": -219.5457666666666, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79500, "num_agent_steps_trained": 79200, "num_env_steps_sampled": 79500, "num_env_steps_trained": 79200, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 301.5457851525775, "num_env_steps_trained_throughput_per_sec": 287.18646205007377, "timesteps_total": 79500, "num_env_steps_sampled_lifetime": 79500, "num_agent_steps_sampled_lifetime": 79500, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 79500, "timers": {"training_iteration_time_ms": 10304.167, "restore_workers_time_ms": 0.011, "training_step_time_ms": 490.794, "sample_time_ms": 476.221, "synch_weights_time_ms": 13.315}, "counters": {"num_env_steps_sampled": 79500, "num_env_steps_trained": 79200, "num_agent_steps_sampled": 79500, "num_agent_steps_trained": 79200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 530, "num_samples_added_to_queue": 79500}, "done": false, "training_iteration": 26, "trial_id": "0313d_00000", "date": "2024-10-10_21-45-52", "timestamp": 1728593152, "time_this_iter_s": 10.46290922164917, "time_total_s": 267.9618239402771, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c2b0a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 267.9618239402771, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 10.913333333333334, "ram_util_percent": 51.966666666666654}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -221542.765625, "policy_loss": -221581.171875, "entropy": 29.801240921020508, "entropy_coeff": 0.01, "var_gnorm": 16.029706954956055, "vf_loss": 127806.703125, "vf_explained_var": 0.028145134449005127}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 274.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 82500, "num_env_steps_trained": 82200, "num_agent_steps_sampled": 82500, "num_agent_steps_trained": 82200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 550, "num_samples_added_to_queue": 82500, "learner_queue": {"size_count": 274, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.724, "learner_load_time_ms": 0.239, "learner_load_wait_time_ms": 951.12, "learner_dequeue_time_ms": 8029.325}}, "env_runners": {"episode_reward_max": -189.18222222222207, "episode_reward_min": -262.8383333333333, "episode_reward_mean": -218.26363333333325, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -262.8383333333333}, "policy_reward_max": {"default_policy": -189.18222222222207}, "policy_reward_mean": {"default_policy": -218.26363333333325}, "custom_metrics": {"num_consolidated_mean": 0.6754000000000001, "num_consolidated_min": 0.49, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0288000000000002, "num_overloaded_min": 0.86, "num_overloaded_max": 1.16, "num_moves_mean": 9.986199999999998, "num_moves_min": 9.7, "num_moves_max": 10.3, "mean_accuracy_mean": 41.02026333333333, "mean_accuracy_min": 40.75166666666666, "mean_accuracy_max": 41.270999999999994, "num_model_switches_mean": 6.0292, "num_model_switches_min": 5.69, "num_model_switches_max": 6.42, "num_slav_mean": 0.15568083333333335, "num_slav_min": 0.13898333333333335, "num_slav_max": 0.17325000000000002, "mean_cluster_cpu_util_mean": 0.5675693148209308, "mean_cluster_cpu_util_min": 0.5446415197147687, "mean_cluster_cpu_util_max": 0.5869157488625614, "mean_cluster_mem_util_mean": 0.36464808598840387, "mean_cluster_mem_util_min": 0.3558599026952553, "mean_cluster_mem_util_max": 0.3733105605427825, "reward_consolidation_mean_mean": 0.17694444444444446, "reward_consolidation_mean_min": 0.06944444444444443, "reward_consolidation_mean_max": 0.375, "reward_illegal_mean_mean": -1.7146666666666661, "reward_illegal_mean_min": -1.933333333333333, "reward_illegal_mean_max": -1.4333333333333331, "reward_accuracy_mean_mean": 0.4161303333333333, "reward_accuracy_mean_min": 0.22383333333333333, "reward_accuracy_mean_max": 0.6531666666666667, "reward_sla_mean_mean": -1.0610444444444445, "reward_sla_mean_min": -1.7949999999999997, "reward_sla_mean_max": -0.4883333333333333, "reward_consolidation_sum_mean": 17.694444444444446, "reward_consolidation_sum_min": 6.944444444444444, "reward_consolidation_sum_max": 37.5, "reward_illegal_sum_mean": -171.4666666666666, "reward_illegal_sum_min": -193.3333333333333, "reward_illegal_sum_max": -143.33333333333331, "reward_accuracy_sum_mean": 41.613033333333334, "reward_accuracy_sum_min": 22.383333333333333, "reward_accuracy_sum_max": 65.31666666666666, "reward_sla_sum_mean": -106.10444444444445, "reward_sla_sum_min": -179.49999999999997, "reward_sla_sum_max": -48.83333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2450.0, "global_timestep_min": 200, "global_timestep_max": 4100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-199.42833333333328, -209.126111111111, -223.4233333333332, -226.411111111111, -206.08333333333323, -222.32833333333326, -227.98444444444445, -232.80555555555534, -206.78833333333324, -219.40277777777777, -207.4372222222221, -231.02666666666656, -222.0877777777777, -219.9149999999999, -196.53055555555554, -208.28666666666655, -209.6238888888888, -210.81111111111105, -204.92333333333326, -242.27722222222226, -216.19888888888872, -204.14388888888868, -225.25111111111113, -228.95500000000004, -216.19333333333327, -222.7577777777779, -197.21888888888873, -214.88611111111098, -241.2172222222221, -209.49999999999991, -203.63333333333324, -238.05999999999997, -218.40611111111104, -232.5166666666665, -202.33444444444436, -202.206111111111, -238.6155555555555, -244.29999999999998, -224.60444444444445, -216.4377777777778, -262.8383333333333, -221.96833333333322, -198.01111111111112, -241.43333333333322, -206.76333333333335, -227.91111111111087, -228.29833333333323, -202.62777777777782, -227.54277777777781, -230.97666666666666, -228.321111111111, -222.931111111111, -201.7877777777777, -221.79500000000004, -240.6555555555555, -199.10444444444443, -224.4072222222222, -227.27555555555546, -228.2172222222221, -253.13111111111104, -213.99611111111108, -189.18222222222207, -198.09666666666655, -225.35666666666657, -210.15611111111107, -197.02944444444435, -227.58222222222224, -200.89444444444436, -207.0816666666666, -208.29555555555544, -200.0105555555554, -214.23222222222228, -236.9077777777778, -236.01055555555547, -228.11166666666665, -224.55000000000004, -212.0244444444445, -231.63555555555553, -231.95833333333314, -230.05333333333328, -217.43166666666653, -217.09277777777774, -222.13722222222216, -192.0527777777777, -195.3755555555555, -191.80999999999986, -250.02888888888876, -201.4622222222221, -236.04388888888877, -197.2711111111111, -231.43611111111107, -205.53277777777762, -225.946111111111, -229.1222222222222, -209.77499999999998, -226.73999999999992, -194.00444444444446, -228.11388888888885, -205.83055555555543, -205.85555555555547], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-199.42833333333328, -209.126111111111, -223.4233333333332, -226.411111111111, -206.08333333333323, -222.32833333333326, -227.98444444444445, -232.80555555555534, -206.78833333333324, -219.40277777777777, -207.4372222222221, -231.02666666666656, -222.0877777777777, -219.9149999999999, -196.53055555555554, -208.28666666666655, -209.6238888888888, -210.81111111111105, -204.92333333333326, -242.27722222222226, -216.19888888888872, -204.14388888888868, -225.25111111111113, -228.95500000000004, -216.19333333333327, -222.7577777777779, -197.21888888888873, -214.88611111111098, -241.2172222222221, -209.49999999999991, -203.63333333333324, -238.05999999999997, -218.40611111111104, -232.5166666666665, -202.33444444444436, -202.206111111111, -238.6155555555555, -244.29999999999998, -224.60444444444445, -216.4377777777778, -262.8383333333333, -221.96833333333322, -198.01111111111112, -241.43333333333322, -206.76333333333335, -227.91111111111087, -228.29833333333323, -202.62777777777782, -227.54277777777781, -230.97666666666666, -228.321111111111, -222.931111111111, -201.7877777777777, -221.79500000000004, -240.6555555555555, -199.10444444444443, -224.4072222222222, -227.27555555555546, -228.2172222222221, -253.13111111111104, -213.99611111111108, -189.18222222222207, -198.09666666666655, -225.35666666666657, -210.15611111111107, -197.02944444444435, -227.58222222222224, -200.89444444444436, -207.0816666666666, -208.29555555555544, -200.0105555555554, -214.23222222222228, -236.9077777777778, -236.01055555555547, -228.11166666666665, -224.55000000000004, -212.0244444444445, -231.63555555555553, -231.95833333333314, -230.05333333333328, -217.43166666666653, -217.09277777777774, -222.13722222222216, -192.0527777777777, -195.3755555555555, -191.80999999999986, -250.02888888888876, -201.4622222222221, -236.04388888888877, -197.2711111111111, -231.43611111111107, -205.53277777777762, -225.946111111111, -229.1222222222222, -209.77499999999998, -226.73999999999992, -194.00444444444446, -228.11388888888885, -205.83055555555543, -205.85555555555547]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1915091077371239, "mean_inference_ms": 1.7706810810590867, "mean_action_processing_ms": 0.07306194727531064, "mean_env_wait_ms": 1.1887377682759408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004153728485107422, "StateBufferConnector_ms": 0.0028638839721679688, "ViewRequirementAgentConnector_ms": 0.06512928009033203}, "num_episodes": 30, "episode_return_max": -189.18222222222207, "episode_return_min": -262.8383333333333, "episode_return_mean": -218.26363333333325, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82500, "num_agent_steps_trained": 82200, "num_env_steps_sampled": 82500, "num_env_steps_trained": 82200, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 298.5898241736671, "num_env_steps_trained_throughput_per_sec": 298.5898241736671, "timesteps_total": 82500, "num_env_steps_sampled_lifetime": 82500, "num_agent_steps_sampled_lifetime": 82500, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 82500, "timers": {"training_iteration_time_ms": 10291.32, "restore_workers_time_ms": 0.011, "training_step_time_ms": 502.274, "sample_time_ms": 488.617, "synch_weights_time_ms": 12.34}, "counters": {"num_env_steps_sampled": 82500, "num_env_steps_trained": 82200, "num_agent_steps_sampled": 82500, "num_agent_steps_trained": 82200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 550, "num_samples_added_to_queue": 82500}, "done": false, "training_iteration": 27, "trial_id": "0313d_00000", "date": "2024-10-10_21-46-02", "timestamp": 1728593162, "time_this_iter_s": 10.056788206100464, "time_total_s": 278.01861214637756, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42dcb970>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 278.01861214637756, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 10.542857142857144, "ram_util_percent": 51.91428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -212059.640625, "policy_loss": -212087.890625, "entropy": 29.798723220825195, "entropy_coeff": 0.01, "var_gnorm": 16.032377243041992, "vf_loss": 117634.4609375, "vf_explained_var": 0.031746506690979004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 285.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 85650, "num_env_steps_trained": 85500, "num_agent_steps_sampled": 85650, "num_agent_steps_trained": 85500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 571, "num_samples_added_to_queue": 85500, "learner_queue": {"size_count": 285, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.79, "learner_load_time_ms": 0.238, "learner_load_wait_time_ms": 910.847, "learner_dequeue_time_ms": 8008.092}}, "env_runners": {"episode_reward_max": -189.18222222222207, "episode_reward_min": -262.8383333333333, "episode_reward_mean": -219.50344444444437, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -262.8383333333333}, "policy_reward_max": {"default_policy": -189.18222222222207}, "policy_reward_mean": {"default_policy": -219.50344444444437}, "custom_metrics": {"num_consolidated_mean": 0.6745000000000002, "num_consolidated_min": 0.47, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0222, "num_overloaded_min": 0.85, "num_overloaded_max": 1.16, "num_moves_mean": 9.974599999999999, "num_moves_min": 9.7, "num_moves_max": 10.3, "mean_accuracy_mean": 41.02444333333333, "mean_accuracy_min": 40.75166666666666, "mean_accuracy_max": 41.26466666666667, "num_model_switches_mean": 6.021000000000003, "num_model_switches_min": 5.69, "num_model_switches_max": 6.42, "num_slav_mean": 0.15538983333333334, "num_slav_min": 0.13898333333333335, "num_slav_max": 0.17218333333333333, "mean_cluster_cpu_util_mean": 0.5676235327403577, "mean_cluster_cpu_util_min": 0.5498823151132389, "mean_cluster_cpu_util_max": 0.5880976762559456, "mean_cluster_mem_util_mean": 0.36472948992149606, "mean_cluster_mem_util_min": 0.35586215214988953, "mean_cluster_mem_util_max": 0.37350774491231087, "reward_consolidation_mean_mean": 0.17680555555555555, "reward_consolidation_mean_min": 0.06944444444444443, "reward_consolidation_mean_max": 0.375, "reward_illegal_mean_mean": -1.7036666666666664, "reward_illegal_mean_min": -1.933333333333333, "reward_illegal_mean_max": -1.4166666666666663, "reward_accuracy_mean_mean": 0.42571000000000003, "reward_accuracy_mean_min": 0.22383333333333333, "reward_accuracy_mean_max": 0.6531666666666667, "reward_sla_mean_mean": -1.0938833333333333, "reward_sla_mean_min": -1.7949999999999997, "reward_sla_mean_max": -0.4883333333333333, "reward_consolidation_sum_mean": 17.680555555555554, "reward_consolidation_sum_min": 6.944444444444444, "reward_consolidation_sum_max": 37.5, "reward_illegal_sum_mean": -170.36666666666667, "reward_illegal_sum_min": -193.3333333333333, "reward_illegal_sum_max": -141.66666666666663, "reward_accuracy_sum_mean": 42.571000000000005, "reward_accuracy_sum_min": 22.383333333333333, "reward_accuracy_sum_max": 65.31666666666666, "reward_sla_sum_mean": -109.38833333333332, "reward_sla_sum_min": -179.49999999999997, "reward_sla_sum_max": -48.83333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3467.0, "global_timestep_min": 1400, "global_timestep_max": 5100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-203.63333333333324, -238.05999999999997, -218.40611111111104, -232.5166666666665, -202.33444444444436, -202.206111111111, -238.6155555555555, -244.29999999999998, -224.60444444444445, -216.4377777777778, -262.8383333333333, -221.96833333333322, -198.01111111111112, -241.43333333333322, -206.76333333333335, -227.91111111111087, -228.29833333333323, -202.62777777777782, -227.54277777777781, -230.97666666666666, -228.321111111111, -222.931111111111, -201.7877777777777, -221.79500000000004, -240.6555555555555, -199.10444444444443, -224.4072222222222, -227.27555555555546, -228.2172222222221, -253.13111111111104, -213.99611111111108, -189.18222222222207, -198.09666666666655, -225.35666666666657, -210.15611111111107, -197.02944444444435, -227.58222222222224, -200.89444444444436, -207.0816666666666, -208.29555555555544, -200.0105555555554, -214.23222222222228, -236.9077777777778, -236.01055555555547, -228.11166666666665, -224.55000000000004, -212.0244444444445, -231.63555555555553, -231.95833333333314, -230.05333333333328, -217.43166666666653, -217.09277777777774, -222.13722222222216, -192.0527777777777, -195.3755555555555, -191.80999999999986, -250.02888888888876, -201.4622222222221, -236.04388888888877, -197.2711111111111, -231.43611111111107, -205.53277777777762, -225.946111111111, -229.1222222222222, -209.77499999999998, -226.73999999999992, -194.00444444444446, -228.11388888888885, -205.83055555555543, -205.85555555555547, -212.04999999999993, -234.14722222222207, -225.47222222222206, -206.20999999999995, -223.99499999999995, -229.7638888888888, -216.09833333333322, -191.91999999999985, -210.5911111111111, -223.93999999999988, -209.8127777777777, -230.6827777777777, -224.41722222222208, -247.59722222222223, -201.56166666666664, -223.08944444444433, -239.2516666666666, -226.71666666666655, -221.8922222222221, -226.9138888888888, -227.55499999999986, -220.8955555555556, -224.461111111111, -227.0411111111111, -217.8349999999999, -200.74777777777766, -210.66055555555536, -224.83611111111105, -235.96388888888887, -210.88500000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-203.63333333333324, -238.05999999999997, -218.40611111111104, -232.5166666666665, -202.33444444444436, -202.206111111111, -238.6155555555555, -244.29999999999998, -224.60444444444445, -216.4377777777778, -262.8383333333333, -221.96833333333322, -198.01111111111112, -241.43333333333322, -206.76333333333335, -227.91111111111087, -228.29833333333323, -202.62777777777782, -227.54277777777781, -230.97666666666666, -228.321111111111, -222.931111111111, -201.7877777777777, -221.79500000000004, -240.6555555555555, -199.10444444444443, -224.4072222222222, -227.27555555555546, -228.2172222222221, -253.13111111111104, -213.99611111111108, -189.18222222222207, -198.09666666666655, -225.35666666666657, -210.15611111111107, -197.02944444444435, -227.58222222222224, -200.89444444444436, -207.0816666666666, -208.29555555555544, -200.0105555555554, -214.23222222222228, -236.9077777777778, -236.01055555555547, -228.11166666666665, -224.55000000000004, -212.0244444444445, -231.63555555555553, -231.95833333333314, -230.05333333333328, -217.43166666666653, -217.09277777777774, -222.13722222222216, -192.0527777777777, -195.3755555555555, -191.80999999999986, -250.02888888888876, -201.4622222222221, -236.04388888888877, -197.2711111111111, -231.43611111111107, -205.53277777777762, -225.946111111111, -229.1222222222222, -209.77499999999998, -226.73999999999992, -194.00444444444446, -228.11388888888885, -205.83055555555543, -205.85555555555547, -212.04999999999993, -234.14722222222207, -225.47222222222206, -206.20999999999995, -223.99499999999995, -229.7638888888888, -216.09833333333322, -191.91999999999985, -210.5911111111111, -223.93999999999988, -209.8127777777777, -230.6827777777777, -224.41722222222208, -247.59722222222223, -201.56166666666664, -223.08944444444433, -239.2516666666666, -226.71666666666655, -221.8922222222221, -226.9138888888888, -227.55499999999986, -220.8955555555556, -224.461111111111, -227.0411111111111, -217.8349999999999, -200.74777777777766, -210.66055555555536, -224.83611111111105, -235.96388888888887, -210.88500000000005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1915130484792926, "mean_inference_ms": 1.7707105313307312, "mean_action_processing_ms": 0.07306866762097654, "mean_env_wait_ms": 1.1890660411439873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00394892692565918, "StateBufferConnector_ms": 0.0027883052825927734, "ViewRequirementAgentConnector_ms": 0.06290459632873535}, "num_episodes": 30, "episode_return_max": -189.18222222222207, "episode_return_min": -262.8383333333333, "episode_return_mean": -219.50344444444437, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 85650, "num_agent_steps_trained": 85500, "num_env_steps_sampled": 85650, "num_env_steps_trained": 85500, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 309.4212311876131, "num_env_steps_trained_throughput_per_sec": 324.15557552988037, "timesteps_total": 85650, "num_env_steps_sampled_lifetime": 85650, "num_agent_steps_sampled_lifetime": 85650, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 85650, "timers": {"training_iteration_time_ms": 10280.742, "restore_workers_time_ms": 0.011, "training_step_time_ms": 495.373, "sample_time_ms": 482.327, "synch_weights_time_ms": 11.803}, "counters": {"num_env_steps_sampled": 85650, "num_env_steps_trained": 85500, "num_agent_steps_sampled": 85650, "num_agent_steps_trained": 85500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 571, "num_samples_added_to_queue": 85500}, "done": false, "training_iteration": 28, "trial_id": "0313d_00000", "date": "2024-10-10_21-46-13", "timestamp": 1728593173, "time_this_iter_s": 10.190659523010254, "time_total_s": 288.2092716693878, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c2a230>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 288.2092716693878, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 10.813333333333333, "ram_util_percent": 52.16666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -201917.765625, "policy_loss": -201931.171875, "entropy": 29.794296264648438, "entropy_coeff": 0.01, "var_gnorm": 16.03607177734375, "vf_loss": 102794.1328125, "vf_explained_var": 0.041873276233673096}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 295.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 88650, "num_env_steps_trained": 88500, "num_agent_steps_sampled": 88650, "num_agent_steps_trained": 88500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 591, "num_samples_added_to_queue": 88500, "learner_queue": {"size_count": 295, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 51.416, "learner_load_time_ms": 0.223, "learner_load_wait_time_ms": 953.288, "learner_dequeue_time_ms": 8009.909}}, "env_runners": {"episode_reward_max": -170.35166666666657, "episode_reward_min": -259.4727777777777, "episode_reward_mean": -217.45615555555548, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -259.4727777777777}, "policy_reward_max": {"default_policy": -170.35166666666657}, "policy_reward_mean": {"default_policy": -217.45615555555548}, "custom_metrics": {"num_consolidated_mean": 0.6753000000000001, "num_consolidated_min": 0.47, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0184, "num_overloaded_min": 0.81, "num_overloaded_max": 1.16, "num_moves_mean": 9.982999999999999, "num_moves_min": 9.7, "num_moves_max": 10.3, "mean_accuracy_mean": 41.02102333333333, "mean_accuracy_min": 40.80233333333333, "mean_accuracy_max": 41.26466666666667, "num_model_switches_mean": 6.0198, "num_model_switches_min": 5.59, "num_model_switches_max": 6.42, "num_slav_mean": 0.155135, "num_slav_min": 0.13981666666666664, "num_slav_max": 0.17318333333333333, "mean_cluster_cpu_util_mean": 0.566907455012083, "mean_cluster_cpu_util_min": 0.5488304255951786, "mean_cluster_cpu_util_max": 0.5880976762559456, "mean_cluster_mem_util_mean": 0.36445371412066935, "mean_cluster_mem_util_min": 0.35586215214988953, "mean_cluster_mem_util_max": 0.37350774491231087, "reward_consolidation_mean_mean": 0.18388888888888888, "reward_consolidation_mean_min": 0.06944444444444445, "reward_consolidation_mean_max": 0.375, "reward_illegal_mean_mean": -1.697333333333333, "reward_illegal_mean_min": -1.933333333333333, "reward_illegal_mean_max": -1.3499999999999994, "reward_accuracy_mean_mean": 0.42686066666666667, "reward_accuracy_mean_min": 0.2232, "reward_accuracy_mean_max": 0.6364166666666667, "reward_sla_mean_mean": -1.0879777777777777, "reward_sla_mean_min": -1.7644444444444445, "reward_sla_mean_max": -0.4883333333333333, "reward_consolidation_sum_mean": 18.38888888888889, "reward_consolidation_sum_min": 6.944444444444445, "reward_consolidation_sum_max": 37.5, "reward_illegal_sum_mean": -169.73333333333332, "reward_illegal_sum_min": -193.3333333333333, "reward_illegal_sum_max": -134.99999999999994, "reward_accuracy_sum_mean": 42.68606666666667, "reward_accuracy_sum_min": 22.32, "reward_accuracy_sum_max": 63.64166666666667, "reward_sla_sum_mean": -108.7977777777778, "reward_sla_sum_min": -176.44444444444446, "reward_sla_sum_max": -48.83333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4450.0, "global_timestep_min": 2200, "global_timestep_max": 6100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-213.99611111111108, -189.18222222222207, -198.09666666666655, -225.35666666666657, -210.15611111111107, -197.02944444444435, -227.58222222222224, -200.89444444444436, -207.0816666666666, -208.29555555555544, -200.0105555555554, -214.23222222222228, -236.9077777777778, -236.01055555555547, -228.11166666666665, -224.55000000000004, -212.0244444444445, -231.63555555555553, -231.95833333333314, -230.05333333333328, -217.43166666666653, -217.09277777777774, -222.13722222222216, -192.0527777777777, -195.3755555555555, -191.80999999999986, -250.02888888888876, -201.4622222222221, -236.04388888888877, -197.2711111111111, -231.43611111111107, -205.53277777777762, -225.946111111111, -229.1222222222222, -209.77499999999998, -226.73999999999992, -194.00444444444446, -228.11388888888885, -205.83055555555543, -205.85555555555547, -212.04999999999993, -234.14722222222207, -225.47222222222206, -206.20999999999995, -223.99499999999995, -229.7638888888888, -216.09833333333322, -191.91999999999985, -210.5911111111111, -223.93999999999988, -209.8127777777777, -230.6827777777777, -224.41722222222208, -247.59722222222223, -201.56166666666664, -223.08944444444433, -239.2516666666666, -226.71666666666655, -221.8922222222221, -226.9138888888888, -227.55499999999986, -220.8955555555556, -224.461111111111, -227.0411111111111, -217.8349999999999, -200.74777777777766, -210.66055555555536, -224.83611111111105, -235.96388888888887, -210.88500000000005, -259.4727777777777, -213.97722222222217, -216.05999999999992, -218.32333333333338, -170.35166666666657, -219.66611111111115, -218.25111111111104, -223.2983333333334, -201.3266666666665, -202.73111111111112, -232.1283333333332, -217.75499999999994, -205.43777777777768, -223.401111111111, -209.97499999999994, -236.93111111111108, -217.29833333333323, -223.29000000000005, -207.12166666666667, -216.12388888888887, -192.8455555555554, -222.06666666666655, -226.5383333333333, -226.61111111111092, -208.1444444444443, -215.8844444444443, -230.71055555555532, -216.95333333333323, -210.56888888888884, -229.13888888888883], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-213.99611111111108, -189.18222222222207, -198.09666666666655, -225.35666666666657, -210.15611111111107, -197.02944444444435, -227.58222222222224, -200.89444444444436, -207.0816666666666, -208.29555555555544, -200.0105555555554, -214.23222222222228, -236.9077777777778, -236.01055555555547, -228.11166666666665, -224.55000000000004, -212.0244444444445, -231.63555555555553, -231.95833333333314, -230.05333333333328, -217.43166666666653, -217.09277777777774, -222.13722222222216, -192.0527777777777, -195.3755555555555, -191.80999999999986, -250.02888888888876, -201.4622222222221, -236.04388888888877, -197.2711111111111, -231.43611111111107, -205.53277777777762, -225.946111111111, -229.1222222222222, -209.77499999999998, -226.73999999999992, -194.00444444444446, -228.11388888888885, -205.83055555555543, -205.85555555555547, -212.04999999999993, -234.14722222222207, -225.47222222222206, -206.20999999999995, -223.99499999999995, -229.7638888888888, -216.09833333333322, -191.91999999999985, -210.5911111111111, -223.93999999999988, -209.8127777777777, -230.6827777777777, -224.41722222222208, -247.59722222222223, -201.56166666666664, -223.08944444444433, -239.2516666666666, -226.71666666666655, -221.8922222222221, -226.9138888888888, -227.55499999999986, -220.8955555555556, -224.461111111111, -227.0411111111111, -217.8349999999999, -200.74777777777766, -210.66055555555536, -224.83611111111105, -235.96388888888887, -210.88500000000005, -259.4727777777777, -213.97722222222217, -216.05999999999992, -218.32333333333338, -170.35166666666657, -219.66611111111115, -218.25111111111104, -223.2983333333334, -201.3266666666665, -202.73111111111112, -232.1283333333332, -217.75499999999994, -205.43777777777768, -223.401111111111, -209.97499999999994, -236.93111111111108, -217.29833333333323, -223.29000000000005, -207.12166666666667, -216.12388888888887, -192.8455555555554, -222.06666666666655, -226.5383333333333, -226.61111111111092, -208.1444444444443, -215.8844444444443, -230.71055555555532, -216.95333333333323, -210.56888888888884, -229.13888888888883]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19135731717678742, "mean_inference_ms": 1.7677167475264457, "mean_action_processing_ms": 0.07300150286325234, "mean_env_wait_ms": 1.1883258000042793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038526058197021484, "StateBufferConnector_ms": 0.002747774124145508, "ViewRequirementAgentConnector_ms": 0.06145429611206055}, "num_episodes": 30, "episode_return_max": -170.35166666666657, "episode_return_min": -259.4727777777777, "episode_return_mean": -217.45615555555548, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88650, "num_agent_steps_trained": 88500, "num_env_steps_sampled": 88650, "num_env_steps_trained": 88500, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 298.96085488529167, "num_env_steps_trained_throughput_per_sec": 298.96085488529167, "timesteps_total": 88650, "num_env_steps_sampled_lifetime": 88650, "num_agent_steps_sampled_lifetime": 88650, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 88650, "timers": {"training_iteration_time_ms": 10257.62, "restore_workers_time_ms": 0.012, "training_step_time_ms": 501.002, "sample_time_ms": 486.701, "synch_weights_time_ms": 12.924}, "counters": {"num_env_steps_sampled": 88650, "num_env_steps_trained": 88500, "num_agent_steps_sampled": 88650, "num_agent_steps_trained": 88500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 591, "num_samples_added_to_queue": 88500}, "done": false, "training_iteration": 29, "trial_id": "0313d_00000", "date": "2024-10-10_21-46-23", "timestamp": 1728593183, "time_this_iter_s": 10.047808647155762, "time_total_s": 298.2570803165436, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42dc98a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 298.2570803165436, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 10.67857142857143, "ram_util_percent": 52.22142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -213817.546875, "policy_loss": -213850.265625, "entropy": 29.792333602905273, "entropy_coeff": 0.01, "var_gnorm": 16.03816032409668, "vf_loss": 122093.75, "vf_explained_var": 0.034351348876953125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 305.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 91800, "num_env_steps_trained": 91500, "num_agent_steps_sampled": 91800, "num_agent_steps_trained": 91500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 612, "num_samples_added_to_queue": 91800, "learner_queue": {"size_count": 305, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 46.404, "learner_load_time_ms": 0.254, "learner_load_wait_time_ms": 928.967, "learner_dequeue_time_ms": 8007.097}}, "env_runners": {"episode_reward_max": -170.35166666666657, "episode_reward_min": -259.4727777777777, "episode_reward_mean": -218.05409999999992, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -259.4727777777777}, "policy_reward_max": {"default_policy": -170.35166666666657}, "policy_reward_mean": {"default_policy": -218.05409999999992}, "custom_metrics": {"num_consolidated_mean": 0.6801999999999999, "num_consolidated_min": 0.47, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0141, "num_overloaded_min": 0.81, "num_overloaded_max": 1.16, "num_moves_mean": 9.983200000000004, "num_moves_min": 9.75, "num_moves_max": 10.26, "mean_accuracy_mean": 41.01994666666666, "mean_accuracy_min": 40.80233333333333, "mean_accuracy_max": 41.29, "num_model_switches_mean": 6.023299999999998, "num_model_switches_min": 5.59, "num_model_switches_max": 6.42, "num_slav_mean": 0.15513450000000004, "num_slav_min": 0.13981666666666664, "num_slav_max": 0.17318333333333333, "mean_cluster_cpu_util_mean": 0.5667554494832049, "mean_cluster_cpu_util_min": 0.5488304255951786, "mean_cluster_cpu_util_max": 0.5880976762559456, "mean_cluster_mem_util_mean": 0.364351614605758, "mean_cluster_mem_util_min": 0.35586215214988953, "mean_cluster_mem_util_max": 0.37350774491231087, "reward_consolidation_mean_mean": 0.18736111111111112, "reward_consolidation_mean_min": 0.08333333333333331, "reward_consolidation_mean_max": 0.34722222222222215, "reward_illegal_mean_mean": -1.6901666666666666, "reward_illegal_mean_min": -1.933333333333333, "reward_illegal_mean_max": -1.3499999999999994, "reward_accuracy_mean_mean": 0.438609, "reward_accuracy_mean_min": 0.2232, "reward_accuracy_mean_max": 0.6598166666666667, "reward_sla_mean_mean": -1.1163444444444444, "reward_sla_mean_min": -1.8088888888888888, "reward_sla_mean_max": -0.5344444444444444, "reward_consolidation_sum_mean": 18.736111111111107, "reward_consolidation_sum_min": 8.333333333333332, "reward_consolidation_sum_max": 34.722222222222214, "reward_illegal_sum_mean": -169.0166666666666, "reward_illegal_sum_min": -193.3333333333333, "reward_illegal_sum_max": -134.99999999999994, "reward_accuracy_sum_mean": 43.8609, "reward_accuracy_sum_min": 22.32, "reward_accuracy_sum_max": 65.98166666666667, "reward_sla_sum_mean": -111.63444444444445, "reward_sla_sum_min": -180.88888888888889, "reward_sla_sum_max": -53.44444444444444, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5567.0, "global_timestep_min": 3500, "global_timestep_max": 7200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-229.1222222222222, -209.77499999999998, -226.73999999999992, -194.00444444444446, -228.11388888888885, -205.83055555555543, -205.85555555555547, -212.04999999999993, -234.14722222222207, -225.47222222222206, -206.20999999999995, -223.99499999999995, -229.7638888888888, -216.09833333333322, -191.91999999999985, -210.5911111111111, -223.93999999999988, -209.8127777777777, -230.6827777777777, -224.41722222222208, -247.59722222222223, -201.56166666666664, -223.08944444444433, -239.2516666666666, -226.71666666666655, -221.8922222222221, -226.9138888888888, -227.55499999999986, -220.8955555555556, -224.461111111111, -227.0411111111111, -217.8349999999999, -200.74777777777766, -210.66055555555536, -224.83611111111105, -235.96388888888887, -210.88500000000005, -259.4727777777777, -213.97722222222217, -216.05999999999992, -218.32333333333338, -170.35166666666657, -219.66611111111115, -218.25111111111104, -223.2983333333334, -201.3266666666665, -202.73111111111112, -232.1283333333332, -217.75499999999994, -205.43777777777768, -223.401111111111, -209.97499999999994, -236.93111111111108, -217.29833333333323, -223.29000000000005, -207.12166666666667, -216.12388888888887, -192.8455555555554, -222.06666666666655, -226.5383333333333, -226.61111111111092, -208.1444444444443, -215.8844444444443, -230.71055555555532, -216.95333333333323, -210.56888888888884, -229.13888888888883, -233.51833333333326, -241.1544444444443, -189.39277777777772, -223.40444444444427, -227.66111111111107, -223.0722222222222, -239.201111111111, -220.3283333333333, -209.3588888888888, -229.6072222222223, -241.76611111111106, -212.44611111111107, -222.20277777777767, -206.1344444444443, -207.4544444444445, -205.78222222222226, -201.83722222222198, -211.22555555555542, -214.21388888888873, -210.186111111111, -212.50388888888875, -192.02277777777758, -222.7022222222222, -195.0733333333332, -191.70722222222224, -241.20722222222224, -217.19055555555545, -240.91611111111095, -201.54222222222208, -212.2122222222221, -203.32666666666654, -244.8666666666665, -221.36222222222207], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-229.1222222222222, -209.77499999999998, -226.73999999999992, -194.00444444444446, -228.11388888888885, -205.83055555555543, -205.85555555555547, -212.04999999999993, -234.14722222222207, -225.47222222222206, -206.20999999999995, -223.99499999999995, -229.7638888888888, -216.09833333333322, -191.91999999999985, -210.5911111111111, -223.93999999999988, -209.8127777777777, -230.6827777777777, -224.41722222222208, -247.59722222222223, -201.56166666666664, -223.08944444444433, -239.2516666666666, -226.71666666666655, -221.8922222222221, -226.9138888888888, -227.55499999999986, -220.8955555555556, -224.461111111111, -227.0411111111111, -217.8349999999999, -200.74777777777766, -210.66055555555536, -224.83611111111105, -235.96388888888887, -210.88500000000005, -259.4727777777777, -213.97722222222217, -216.05999999999992, -218.32333333333338, -170.35166666666657, -219.66611111111115, -218.25111111111104, -223.2983333333334, -201.3266666666665, -202.73111111111112, -232.1283333333332, -217.75499999999994, -205.43777777777768, -223.401111111111, -209.97499999999994, -236.93111111111108, -217.29833333333323, -223.29000000000005, -207.12166666666667, -216.12388888888887, -192.8455555555554, -222.06666666666655, -226.5383333333333, -226.61111111111092, -208.1444444444443, -215.8844444444443, -230.71055555555532, -216.95333333333323, -210.56888888888884, -229.13888888888883, -233.51833333333326, -241.1544444444443, -189.39277777777772, -223.40444444444427, -227.66111111111107, -223.0722222222222, -239.201111111111, -220.3283333333333, -209.3588888888888, -229.6072222222223, -241.76611111111106, -212.44611111111107, -222.20277777777767, -206.1344444444443, -207.4544444444445, -205.78222222222226, -201.83722222222198, -211.22555555555542, -214.21388888888873, -210.186111111111, -212.50388888888875, -192.02277777777758, -222.7022222222222, -195.0733333333332, -191.70722222222224, -241.20722222222224, -217.19055555555545, -240.91611111111095, -201.54222222222208, -212.2122222222221, -203.32666666666654, -244.8666666666665, -221.36222222222207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19118945058925405, "mean_inference_ms": 1.7673171656826006, "mean_action_processing_ms": 0.07296123993781203, "mean_env_wait_ms": 1.1880659398947975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004107952117919922, "StateBufferConnector_ms": 0.002717733383178711, "ViewRequirementAgentConnector_ms": 0.06069684028625488}, "num_episodes": 33, "episode_return_max": -170.35166666666657, "episode_return_min": -259.4727777777777, "episode_return_mean": -218.05409999999992, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91800, "num_agent_steps_trained": 91500, "num_env_steps_sampled": 91800, "num_env_steps_trained": 91500, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 307.3552355474926, "num_env_steps_trained_throughput_per_sec": 292.71927194999296, "timesteps_total": 91800, "num_env_steps_sampled_lifetime": 91800, "num_agent_steps_sampled_lifetime": 91800, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 91800, "timers": {"training_iteration_time_ms": 10250.96, "restore_workers_time_ms": 0.011, "training_step_time_ms": 472.892, "sample_time_ms": 459.247, "synch_weights_time_ms": 12.436}, "counters": {"num_env_steps_sampled": 91800, "num_env_steps_trained": 91500, "num_agent_steps_sampled": 91800, "num_agent_steps_trained": 91500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 612, "num_samples_added_to_queue": 91800}, "done": false, "training_iteration": 30, "trial_id": "0313d_00000", "date": "2024-10-10_21-46-33", "timestamp": 1728593193, "time_this_iter_s": 10.257771730422974, "time_total_s": 308.51485204696655, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c2be80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 308.51485204696655, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 10.386666666666668, "ram_util_percent": 52.50000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -205770.75, "policy_loss": -205791.453125, "entropy": 29.783138275146484, "entropy_coeff": 0.01, "var_gnorm": 16.043319702148438, "vf_loss": 110041.3828125, "vf_explained_var": 0.0445745587348938}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 316.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 94950, "num_env_steps_trained": 94800, "num_agent_steps_sampled": 94950, "num_agent_steps_trained": 94800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 633, "num_samples_added_to_queue": 94800, "learner_queue": {"size_count": 316, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.397, "learner_load_time_ms": 0.249, "learner_load_wait_time_ms": 944.099, "learner_dequeue_time_ms": 8042.0}}, "env_runners": {"episode_reward_max": -170.35166666666657, "episode_reward_min": -259.4727777777777, "episode_reward_mean": -217.56541111111102, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -259.4727777777777}, "policy_reward_max": {"default_policy": -170.35166666666657}, "policy_reward_mean": {"default_policy": -217.56541111111102}, "custom_metrics": {"num_consolidated_mean": 0.6750999999999999, "num_consolidated_min": 0.47, "num_consolidated_max": 0.82, "num_overloaded_mean": 1.014, "num_overloaded_min": 0.81, "num_overloaded_max": 1.15, "num_moves_mean": 9.9909, "num_moves_min": 9.73, "num_moves_max": 10.27, "mean_accuracy_mean": 41.01405666666667, "mean_accuracy_min": 40.63133333333333, "mean_accuracy_max": 41.29, "num_model_switches_mean": 6.0193, "num_model_switches_min": 5.59, "num_model_switches_max": 6.37, "num_slav_mean": 0.15460149999999998, "num_slav_min": 0.12871666666666667, "num_slav_max": 0.17318333333333333, "mean_cluster_cpu_util_mean": 0.5662273228116395, "mean_cluster_cpu_util_min": 0.5447850094357866, "mean_cluster_cpu_util_max": 0.585973283538839, "mean_cluster_mem_util_mean": 0.36414399037357553, "mean_cluster_mem_util_min": 0.356636117389994, "mean_cluster_mem_util_max": 0.3721405992565802, "reward_consolidation_mean_mean": 0.18138888888888885, "reward_consolidation_mean_min": 0.05555555555555555, "reward_consolidation_mean_max": 0.34722222222222215, "reward_illegal_mean_mean": -1.69, "reward_illegal_mean_min": -1.9166666666666663, "reward_illegal_mean_max": -1.3499999999999994, "reward_accuracy_mean_mean": 0.439557, "reward_accuracy_mean_min": 0.22034999999999996, "reward_accuracy_mean_max": 0.6598166666666667, "reward_sla_mean_mean": -1.1066, "reward_sla_mean_min": -1.8088888888888888, "reward_sla_mean_max": -0.46611111111111114, "reward_consolidation_sum_mean": 18.138888888888886, "reward_consolidation_sum_min": 5.555555555555555, "reward_consolidation_sum_max": 34.722222222222214, "reward_illegal_sum_mean": -169.0, "reward_illegal_sum_min": -191.66666666666663, "reward_illegal_sum_max": -134.99999999999994, "reward_accuracy_sum_mean": 43.95570000000001, "reward_accuracy_sum_min": 22.034999999999997, "reward_accuracy_sum_max": 65.98166666666667, "reward_sla_sum_mean": -110.66, "reward_sla_sum_min": -180.88888888888889, "reward_sla_sum_max": -46.611111111111114, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5631.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-227.0411111111111, -217.8349999999999, -200.74777777777766, -210.66055555555536, -224.83611111111105, -235.96388888888887, -210.88500000000005, -259.4727777777777, -213.97722222222217, -216.05999999999992, -218.32333333333338, -170.35166666666657, -219.66611111111115, -218.25111111111104, -223.2983333333334, -201.3266666666665, -202.73111111111112, -232.1283333333332, -217.75499999999994, -205.43777777777768, -223.401111111111, -209.97499999999994, -236.93111111111108, -217.29833333333323, -223.29000000000005, -207.12166666666667, -216.12388888888887, -192.8455555555554, -222.06666666666655, -226.5383333333333, -226.61111111111092, -208.1444444444443, -215.8844444444443, -230.71055555555532, -216.95333333333323, -210.56888888888884, -229.13888888888883, -233.51833333333326, -241.1544444444443, -189.39277777777772, -223.40444444444427, -227.66111111111107, -223.0722222222222, -239.201111111111, -220.3283333333333, -209.3588888888888, -229.6072222222223, -241.76611111111106, -212.44611111111107, -222.20277777777767, -206.1344444444443, -207.4544444444445, -205.78222222222226, -201.83722222222198, -211.22555555555542, -214.21388888888873, -210.186111111111, -212.50388888888875, -192.02277777777758, -222.7022222222222, -195.0733333333332, -191.70722222222224, -241.20722222222224, -217.19055555555545, -240.91611111111095, -201.54222222222208, -212.2122222222221, -203.32666666666654, -244.8666666666665, -221.36222222222207, -225.53388888888887, -204.85388888888895, -236.4149999999999, -197.03055555555568, -229.4922222222222, -225.68611111111102, -225.98555555555535, -212.9644444444444, -223.15388888888882, -205.4822222222221, -204.94111111111098, -207.2655555555555, -220.01166666666668, -215.33777777777772, -225.42388888888877, -222.8355555555555, -225.4633333333333, -220.77888888888882, -234.65055555555557, -228.6488888888888, -225.26611111111092, -199.75944444444428, -223.18777777777782, -224.93722222222212, -221.52888888888882, -195.27499999999998, -208.1272222222222, -238.32777777777773, -208.02444444444433, -213.21888888888887], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-227.0411111111111, -217.8349999999999, -200.74777777777766, -210.66055555555536, -224.83611111111105, -235.96388888888887, -210.88500000000005, -259.4727777777777, -213.97722222222217, -216.05999999999992, -218.32333333333338, -170.35166666666657, -219.66611111111115, -218.25111111111104, -223.2983333333334, -201.3266666666665, -202.73111111111112, -232.1283333333332, -217.75499999999994, -205.43777777777768, -223.401111111111, -209.97499999999994, -236.93111111111108, -217.29833333333323, -223.29000000000005, -207.12166666666667, -216.12388888888887, -192.8455555555554, -222.06666666666655, -226.5383333333333, -226.61111111111092, -208.1444444444443, -215.8844444444443, -230.71055555555532, -216.95333333333323, -210.56888888888884, -229.13888888888883, -233.51833333333326, -241.1544444444443, -189.39277777777772, -223.40444444444427, -227.66111111111107, -223.0722222222222, -239.201111111111, -220.3283333333333, -209.3588888888888, -229.6072222222223, -241.76611111111106, -212.44611111111107, -222.20277777777767, -206.1344444444443, -207.4544444444445, -205.78222222222226, -201.83722222222198, -211.22555555555542, -214.21388888888873, -210.186111111111, -212.50388888888875, -192.02277777777758, -222.7022222222222, -195.0733333333332, -191.70722222222224, -241.20722222222224, -217.19055555555545, -240.91611111111095, -201.54222222222208, -212.2122222222221, -203.32666666666654, -244.8666666666665, -221.36222222222207, -225.53388888888887, -204.85388888888895, -236.4149999999999, -197.03055555555568, -229.4922222222222, -225.68611111111102, -225.98555555555535, -212.9644444444444, -223.15388888888882, -205.4822222222221, -204.94111111111098, -207.2655555555555, -220.01166666666668, -215.33777777777772, -225.42388888888877, -222.8355555555555, -225.4633333333333, -220.77888888888882, -234.65055555555557, -228.6488888888888, -225.26611111111092, -199.75944444444428, -223.18777777777782, -224.93722222222212, -221.52888888888882, -195.27499999999998, -208.1272222222222, -238.32777777777773, -208.02444444444433, -213.21888888888887]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19108750890685172, "mean_inference_ms": 1.765808108500764, "mean_action_processing_ms": 0.07291675923180078, "mean_env_wait_ms": 1.1876427882050375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004408121109008789, "StateBufferConnector_ms": 0.002776622772216797, "ViewRequirementAgentConnector_ms": 0.06168246269226074}, "num_episodes": 30, "episode_return_max": -170.35166666666657, "episode_return_min": -259.4727777777777, "episode_return_mean": -217.56541111111102, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94950, "num_agent_steps_trained": 94800, "num_env_steps_sampled": 94950, "num_env_steps_trained": 94800, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 301.2043401960979, "num_env_steps_trained_throughput_per_sec": 315.54740401495974, "timesteps_total": 94950, "num_env_steps_sampled_lifetime": 94950, "num_agent_steps_sampled_lifetime": 94950, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 94950, "timers": {"training_iteration_time_ms": 10260.693, "restore_workers_time_ms": 0.01, "training_step_time_ms": 511.335, "sample_time_ms": 497.439, "synch_weights_time_ms": 12.597}, "counters": {"num_env_steps_sampled": 94950, "num_env_steps_trained": 94800, "num_agent_steps_sampled": 94950, "num_agent_steps_trained": 94800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 633, "num_samples_added_to_queue": 94800}, "done": false, "training_iteration": 31, "trial_id": "0313d_00000", "date": "2024-10-10_21-46-44", "timestamp": 1728593204, "time_this_iter_s": 10.468315362930298, "time_total_s": 318.98316740989685, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c2ac20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 318.98316740989685, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 10.760000000000002, "ram_util_percent": 52.59333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -184784.5, "policy_loss": -184785.515625, "entropy": 29.773876190185547, "entropy_coeff": 0.01, "var_gnorm": 16.04815101623535, "vf_loss": 90338.3203125, "vf_explained_var": 0.05376821756362915}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 326.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 98100, "num_env_steps_trained": 97800, "num_agent_steps_sampled": 98100, "num_agent_steps_trained": 97800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 654, "num_samples_added_to_queue": 98100, "learner_queue": {"size_count": 326, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.251, "learner_load_time_ms": 0.242, "learner_load_wait_time_ms": 932.617, "learner_dequeue_time_ms": 8056.374}}, "env_runners": {"episode_reward_max": -185.0099999999999, "episode_reward_min": -245.56944444444437, "episode_reward_mean": -216.8204388888888, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -245.56944444444437}, "policy_reward_max": {"default_policy": -185.0099999999999}, "policy_reward_mean": {"default_policy": -216.8204388888888}, "custom_metrics": {"num_consolidated_mean": 0.6816, "num_consolidated_min": 0.51, "num_consolidated_max": 0.81, "num_overloaded_mean": 1.0201, "num_overloaded_min": 0.89, "num_overloaded_max": 1.14, "num_moves_mean": 9.9924, "num_moves_min": 9.72, "num_moves_max": 10.37, "mean_accuracy_mean": 41.00037666666667, "mean_accuracy_min": 40.63133333333333, "mean_accuracy_max": 41.29, "num_model_switches_mean": 6.0139, "num_model_switches_min": 5.57, "num_model_switches_max": 6.39, "num_slav_mean": 0.15406416666666664, "num_slav_min": 0.12871666666666667, "num_slav_max": 0.17151666666666665, "mean_cluster_cpu_util_mean": 0.5666836015960578, "mean_cluster_cpu_util_min": 0.5432156368989272, "mean_cluster_cpu_util_max": 0.585973283538839, "mean_cluster_mem_util_mean": 0.36431913281272427, "mean_cluster_mem_util_min": 0.35171959675220293, "mean_cluster_mem_util_max": 0.37230431233674904, "reward_consolidation_mean_mean": 0.18569444444444444, "reward_consolidation_mean_min": 0.05555555555555555, "reward_consolidation_mean_max": 0.34722222222222215, "reward_illegal_mean_mean": -1.7001666666666666, "reward_illegal_mean_min": -1.9, "reward_illegal_mean_max": -1.483333333333333, "reward_accuracy_mean_mean": 0.43990116666666657, "reward_accuracy_mean_min": 0.22034999999999996, "reward_accuracy_mean_max": 0.6598166666666667, "reward_sla_mean_mean": -1.0936333333333332, "reward_sla_mean_min": -1.8088888888888888, "reward_sla_mean_max": -0.46611111111111114, "reward_consolidation_sum_mean": 18.569444444444443, "reward_consolidation_sum_min": 5.555555555555555, "reward_consolidation_sum_max": 34.722222222222214, "reward_illegal_sum_mean": -170.01666666666668, "reward_illegal_sum_min": -190.0, "reward_illegal_sum_max": -148.3333333333333, "reward_accuracy_sum_mean": 43.99011666666667, "reward_accuracy_sum_min": 22.034999999999997, "reward_accuracy_sum_max": 65.98166666666667, "reward_sla_sum_mean": -109.36333333333334, "reward_sla_sum_min": -180.88888888888889, "reward_sla_sum_max": -46.611111111111114, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4168.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-230.71055555555532, -216.95333333333323, -210.56888888888884, -229.13888888888883, -233.51833333333326, -241.1544444444443, -189.39277777777772, -223.40444444444427, -227.66111111111107, -223.0722222222222, -239.201111111111, -220.3283333333333, -209.3588888888888, -229.6072222222223, -241.76611111111106, -212.44611111111107, -222.20277777777767, -206.1344444444443, -207.4544444444445, -205.78222222222226, -201.83722222222198, -211.22555555555542, -214.21388888888873, -210.186111111111, -212.50388888888875, -192.02277777777758, -222.7022222222222, -195.0733333333332, -191.70722222222224, -241.20722222222224, -217.19055555555545, -240.91611111111095, -201.54222222222208, -212.2122222222221, -203.32666666666654, -244.8666666666665, -221.36222222222207, -225.53388888888887, -204.85388888888895, -236.4149999999999, -197.03055555555568, -229.4922222222222, -225.68611111111102, -225.98555555555535, -212.9644444444444, -223.15388888888882, -205.4822222222221, -204.94111111111098, -207.2655555555555, -220.01166666666668, -215.33777777777772, -225.42388888888877, -222.8355555555555, -225.4633333333333, -220.77888888888882, -234.65055555555557, -228.6488888888888, -225.26611111111092, -199.75944444444428, -223.18777777777782, -224.93722222222212, -221.52888888888882, -195.27499999999998, -208.1272222222222, -238.32777777777773, -208.02444444444433, -213.21888888888887, -218.7433333333333, -214.55888888888876, -190.60833333333332, -197.10944444444434, -224.77277777777775, -215.37666666666664, -220.29555555555544, -211.63666666666654, -245.56944444444437, -202.31888888888886, -210.78666666666658, -226.59277777777774, -185.0099999999999, -213.4522222222221, -240.1872222222222, -233.9699999999999, -197.6616666666666, -227.45499999999993, -216.80611111111114, -197.79388888888877, -207.67055555555558, -227.825, -232.7016666666665, -217.86166666666665, -207.15277777777777, -226.6616666666665, -224.21222222222215, -195.32555555555544, -218.13999999999996, -232.36277777777767, -203.19166666666666, -191.8688888888888, -202.80333333333328], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-230.71055555555532, -216.95333333333323, -210.56888888888884, -229.13888888888883, -233.51833333333326, -241.1544444444443, -189.39277777777772, -223.40444444444427, -227.66111111111107, -223.0722222222222, -239.201111111111, -220.3283333333333, -209.3588888888888, -229.6072222222223, -241.76611111111106, -212.44611111111107, -222.20277777777767, -206.1344444444443, -207.4544444444445, -205.78222222222226, -201.83722222222198, -211.22555555555542, -214.21388888888873, -210.186111111111, -212.50388888888875, -192.02277777777758, -222.7022222222222, -195.0733333333332, -191.70722222222224, -241.20722222222224, -217.19055555555545, -240.91611111111095, -201.54222222222208, -212.2122222222221, -203.32666666666654, -244.8666666666665, -221.36222222222207, -225.53388888888887, -204.85388888888895, -236.4149999999999, -197.03055555555568, -229.4922222222222, -225.68611111111102, -225.98555555555535, -212.9644444444444, -223.15388888888882, -205.4822222222221, -204.94111111111098, -207.2655555555555, -220.01166666666668, -215.33777777777772, -225.42388888888877, -222.8355555555555, -225.4633333333333, -220.77888888888882, -234.65055555555557, -228.6488888888888, -225.26611111111092, -199.75944444444428, -223.18777777777782, -224.93722222222212, -221.52888888888882, -195.27499999999998, -208.1272222222222, -238.32777777777773, -208.02444444444433, -213.21888888888887, -218.7433333333333, -214.55888888888876, -190.60833333333332, -197.10944444444434, -224.77277777777775, -215.37666666666664, -220.29555555555544, -211.63666666666654, -245.56944444444437, -202.31888888888886, -210.78666666666658, -226.59277777777774, -185.0099999999999, -213.4522222222221, -240.1872222222222, -233.9699999999999, -197.6616666666666, -227.45499999999993, -216.80611111111114, -197.79388888888877, -207.67055555555558, -227.825, -232.7016666666665, -217.86166666666665, -207.15277777777777, -226.6616666666665, -224.21222222222215, -195.32555555555544, -218.13999999999996, -232.36277777777767, -203.19166666666666, -191.8688888888888, -202.80333333333328]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19100484603065263, "mean_inference_ms": 1.765798051521346, "mean_action_processing_ms": 0.0728926496345528, "mean_env_wait_ms": 1.1875408003917247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004456281661987305, "StateBufferConnector_ms": 0.002801179885864258, "ViewRequirementAgentConnector_ms": 0.06266164779663086}, "num_episodes": 33, "episode_return_max": -185.0099999999999, "episode_return_min": -245.56944444444437, "episode_return_mean": -216.8204388888888, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98100, "num_agent_steps_trained": 97800, "num_env_steps_sampled": 98100, "num_env_steps_trained": 97800, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 303.5808738265761, "num_env_steps_trained_throughput_per_sec": 289.1246417395963, "timesteps_total": 98100, "num_env_steps_sampled_lifetime": 98100, "num_agent_steps_sampled_lifetime": 98100, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 98100, "timers": {"training_iteration_time_ms": 10290.208, "restore_workers_time_ms": 0.011, "training_step_time_ms": 479.872, "sample_time_ms": 466.58, "synch_weights_time_ms": 12.076}, "counters": {"num_env_steps_sampled": 98100, "num_env_steps_trained": 97800, "num_agent_steps_sampled": 98100, "num_agent_steps_trained": 97800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 654, "num_samples_added_to_queue": 98100}, "done": false, "training_iteration": 32, "trial_id": "0313d_00000", "date": "2024-10-10_21-46-54", "timestamp": 1728593214, "time_this_iter_s": 10.386069059371948, "time_total_s": 329.3692364692688, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c1a470>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 329.3692364692688, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 10.813333333333333, "ram_util_percent": 52.906666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -191181.65625, "policy_loss": -191184.515625, "entropy": 29.76837921142578, "entropy_coeff": 0.01, "var_gnorm": 16.05327606201172, "vf_loss": 92174.421875, "vf_explained_var": 0.06461691856384277}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 336.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 101100, "num_env_steps_trained": 100800, "num_agent_steps_sampled": 101100, "num_agent_steps_trained": 100800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 674, "num_samples_added_to_queue": 101100, "learner_queue": {"size_count": 336, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.215, "learner_load_time_ms": 0.257, "learner_load_wait_time_ms": 966.509, "learner_dequeue_time_ms": 7978.523}}, "env_runners": {"episode_reward_max": -182.101111111111, "episode_reward_min": -245.56944444444437, "episode_reward_mean": -215.9452388888888, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -245.56944444444437}, "policy_reward_max": {"default_policy": -182.101111111111}, "policy_reward_mean": {"default_policy": -215.9452388888888}, "custom_metrics": {"num_consolidated_mean": 0.679, "num_consolidated_min": 0.51, "num_consolidated_max": 0.81, "num_overloaded_mean": 1.0128000000000001, "num_overloaded_min": 0.86, "num_overloaded_max": 1.18, "num_moves_mean": 9.9899, "num_moves_min": 9.72, "num_moves_max": 10.37, "mean_accuracy_mean": 40.99543666666666, "mean_accuracy_min": 40.63133333333333, "mean_accuracy_max": 41.22666666666667, "num_model_switches_mean": 6.005699999999999, "num_model_switches_min": 5.55, "num_model_switches_max": 6.39, "num_slav_mean": 0.15316166666666667, "num_slav_min": 0.12871666666666667, "num_slav_max": 0.1717, "mean_cluster_cpu_util_mean": 0.5659467978329425, "mean_cluster_cpu_util_min": 0.5432156368989272, "mean_cluster_cpu_util_max": 0.5847680288601227, "mean_cluster_mem_util_mean": 0.36403764283202733, "mean_cluster_mem_util_min": 0.35171959675220293, "mean_cluster_mem_util_max": 0.37230431233674904, "reward_consolidation_mean_mean": 0.1879166666666667, "reward_consolidation_mean_min": 0.05555555555555555, "reward_consolidation_mean_max": 0.2916666666666667, "reward_illegal_mean_mean": -1.6879999999999997, "reward_illegal_mean_min": -1.9666666666666666, "reward_illegal_mean_max": -1.4333333333333331, "reward_accuracy_mean_mean": 0.44820316666666676, "reward_accuracy_mean_min": 0.22034999999999996, "reward_accuracy_mean_max": 0.6563333333333332, "reward_sla_mean_mean": -1.1075722222222222, "reward_sla_mean_min": -1.791111111111111, "reward_sla_mean_max": -0.46611111111111114, "reward_consolidation_sum_mean": 18.79166666666667, "reward_consolidation_sum_min": 5.555555555555555, "reward_consolidation_sum_max": 29.166666666666668, "reward_illegal_sum_mean": -168.8, "reward_illegal_sum_min": -196.66666666666666, "reward_illegal_sum_max": -143.33333333333331, "reward_accuracy_sum_mean": 44.820316666666656, "reward_accuracy_sum_min": 22.034999999999997, "reward_accuracy_sum_max": 65.63333333333333, "reward_sla_sum_mean": -110.75722222222223, "reward_sla_sum_min": -179.11111111111111, "reward_sla_sum_max": -46.611111111111114, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2817.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-217.19055555555545, -240.91611111111095, -201.54222222222208, -212.2122222222221, -203.32666666666654, -244.8666666666665, -221.36222222222207, -225.53388888888887, -204.85388888888895, -236.4149999999999, -197.03055555555568, -229.4922222222222, -225.68611111111102, -225.98555555555535, -212.9644444444444, -223.15388888888882, -205.4822222222221, -204.94111111111098, -207.2655555555555, -220.01166666666668, -215.33777777777772, -225.42388888888877, -222.8355555555555, -225.4633333333333, -220.77888888888882, -234.65055555555557, -228.6488888888888, -225.26611111111092, -199.75944444444428, -223.18777777777782, -224.93722222222212, -221.52888888888882, -195.27499999999998, -208.1272222222222, -238.32777777777773, -208.02444444444433, -213.21888888888887, -218.7433333333333, -214.55888888888876, -190.60833333333332, -197.10944444444434, -224.77277777777775, -215.37666666666664, -220.29555555555544, -211.63666666666654, -245.56944444444437, -202.31888888888886, -210.78666666666658, -226.59277777777774, -185.0099999999999, -213.4522222222221, -240.1872222222222, -233.9699999999999, -197.6616666666666, -227.45499999999993, -216.80611111111114, -197.79388888888877, -207.67055555555558, -227.825, -232.7016666666665, -217.86166666666665, -207.15277777777777, -226.6616666666665, -224.21222222222215, -195.32555555555544, -218.13999999999996, -232.36277777777767, -203.19166666666666, -191.8688888888888, -202.80333333333328, -201.42888888888888, -220.4322222222221, -223.5244444444444, -205.22722222222222, -216.48555555555544, -207.51166666666654, -225.7105555555556, -204.3933333333334, -210.69500000000005, -222.48722222222213, -225.97888888888886, -232.87777777777774, -213.52555555555566, -206.63388888888886, -211.87555555555556, -213.24444444444435, -212.8833333333333, -226.90555555555548, -210.26555555555547, -213.09166666666647, -182.101111111111, -204.77388888888882, -214.89277777777772, -207.73722222222207, -241.30222222222216, -196.7722222222222, -211.26888888888888, -235.80888888888873, -203.4644444444444, -221.716111111111], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-217.19055555555545, -240.91611111111095, -201.54222222222208, -212.2122222222221, -203.32666666666654, -244.8666666666665, -221.36222222222207, -225.53388888888887, -204.85388888888895, -236.4149999999999, -197.03055555555568, -229.4922222222222, -225.68611111111102, -225.98555555555535, -212.9644444444444, -223.15388888888882, -205.4822222222221, -204.94111111111098, -207.2655555555555, -220.01166666666668, -215.33777777777772, -225.42388888888877, -222.8355555555555, -225.4633333333333, -220.77888888888882, -234.65055555555557, -228.6488888888888, -225.26611111111092, -199.75944444444428, -223.18777777777782, -224.93722222222212, -221.52888888888882, -195.27499999999998, -208.1272222222222, -238.32777777777773, -208.02444444444433, -213.21888888888887, -218.7433333333333, -214.55888888888876, -190.60833333333332, -197.10944444444434, -224.77277777777775, -215.37666666666664, -220.29555555555544, -211.63666666666654, -245.56944444444437, -202.31888888888886, -210.78666666666658, -226.59277777777774, -185.0099999999999, -213.4522222222221, -240.1872222222222, -233.9699999999999, -197.6616666666666, -227.45499999999993, -216.80611111111114, -197.79388888888877, -207.67055555555558, -227.825, -232.7016666666665, -217.86166666666665, -207.15277777777777, -226.6616666666665, -224.21222222222215, -195.32555555555544, -218.13999999999996, -232.36277777777767, -203.19166666666666, -191.8688888888888, -202.80333333333328, -201.42888888888888, -220.4322222222221, -223.5244444444444, -205.22722222222222, -216.48555555555544, -207.51166666666654, -225.7105555555556, -204.3933333333334, -210.69500000000005, -222.48722222222213, -225.97888888888886, -232.87777777777774, -213.52555555555566, -206.63388888888886, -211.87555555555556, -213.24444444444435, -212.8833333333333, -226.90555555555548, -210.26555555555547, -213.09166666666647, -182.101111111111, -204.77388888888882, -214.89277777777772, -207.73722222222207, -241.30222222222216, -196.7722222222222, -211.26888888888888, -235.80888888888873, -203.4644444444444, -221.716111111111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19095395629433803, "mean_inference_ms": 1.7638445019292834, "mean_action_processing_ms": 0.07285688442434664, "mean_env_wait_ms": 1.187188501084074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004275083541870117, "StateBufferConnector_ms": 0.002827167510986328, "ViewRequirementAgentConnector_ms": 0.06325793266296387}, "num_episodes": 30, "episode_return_max": -182.101111111111, "episode_return_min": -245.56944444444437, "episode_return_mean": -215.9452388888888, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 101100, "num_agent_steps_trained": 100800, "num_env_steps_sampled": 101100, "num_env_steps_trained": 100800, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 293.01128614807226, "num_env_steps_trained_throughput_per_sec": 293.01128614807226, "timesteps_total": 101100, "num_env_steps_sampled_lifetime": 101100, "num_agent_steps_sampled_lifetime": 101100, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 101100, "timers": {"training_iteration_time_ms": 10268.754, "restore_workers_time_ms": 0.012, "training_step_time_ms": 514.831, "sample_time_ms": 500.568, "synch_weights_time_ms": 12.97}, "counters": {"num_env_steps_sampled": 101100, "num_env_steps_trained": 100800, "num_agent_steps_sampled": 101100, "num_agent_steps_trained": 100800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 674, "num_samples_added_to_queue": 101100}, "done": false, "training_iteration": 33, "trial_id": "0313d_00000", "date": "2024-10-10_21-47-04", "timestamp": 1728593224, "time_this_iter_s": 10.248395442962646, "time_total_s": 339.61763191223145, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42dcb8b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 339.61763191223145, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 11.328571428571431, "ram_util_percent": 52.91428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -182176.109375, "policy_loss": -182177.21875, "entropy": 29.754467010498047, "entropy_coeff": 0.01, "var_gnorm": 16.060012817382812, "vf_loss": 90375.953125, "vf_explained_var": 0.060180485248565674}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 347.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 104250, "num_env_steps_trained": 104100, "num_agent_steps_sampled": 104250, "num_agent_steps_trained": 104100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 695, "num_samples_added_to_queue": 104100, "learner_queue": {"size_count": 347, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 45.98, "learner_load_time_ms": 0.28, "learner_load_wait_time_ms": 944.435, "learner_dequeue_time_ms": 7983.984}}, "env_runners": {"episode_reward_max": -173.06888888888886, "episode_reward_min": -262.68777777777774, "episode_reward_mean": -214.68041111111106, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -262.68777777777774}, "policy_reward_max": {"default_policy": -173.06888888888886}, "policy_reward_mean": {"default_policy": -214.68041111111106}, "custom_metrics": {"num_consolidated_mean": 0.6839, "num_consolidated_min": 0.51, "num_consolidated_max": 0.87, "num_overloaded_mean": 0.9989999999999999, "num_overloaded_min": 0.82, "num_overloaded_max": 1.18, "num_moves_mean": 9.971300000000001, "num_moves_min": 9.58, "num_moves_max": 10.37, "mean_accuracy_mean": 40.99246, "mean_accuracy_min": 40.758, "mean_accuracy_max": 41.277333333333324, "num_model_switches_mean": 5.980000000000001, "num_model_switches_min": 5.55, "num_model_switches_max": 6.39, "num_slav_mean": 0.152646, "num_slav_min": 0.13548333333333334, "num_slav_max": 0.17303333333333334, "mean_cluster_cpu_util_mean": 0.5647327207512643, "mean_cluster_cpu_util_min": 0.5432156368989272, "mean_cluster_cpu_util_max": 0.5847680288601227, "mean_cluster_mem_util_mean": 0.36336459689033845, "mean_cluster_mem_util_min": 0.35171959675220293, "mean_cluster_mem_util_max": 0.3724948127457734, "reward_consolidation_mean_mean": 0.19736111111111115, "reward_consolidation_mean_min": 0.08333333333333331, "reward_consolidation_mean_max": 0.37499999999999994, "reward_illegal_mean_mean": -1.665, "reward_illegal_mean_min": -1.9666666666666666, "reward_illegal_mean_max": -1.3666666666666663, "reward_accuracy_mean_mean": 0.45924033333333336, "reward_accuracy_mean_min": 0.26366666666666666, "reward_accuracy_mean_max": 0.7761500000000001, "reward_sla_mean_mean": -1.1384055555555554, "reward_sla_mean_min": -1.8222222222222222, "reward_sla_mean_max": -0.6127777777777778, "reward_consolidation_sum_mean": 19.73611111111111, "reward_consolidation_sum_min": 8.333333333333332, "reward_consolidation_sum_max": 37.49999999999999, "reward_illegal_sum_mean": -166.49999999999997, "reward_illegal_sum_min": -196.66666666666666, "reward_illegal_sum_max": -136.66666666666663, "reward_accuracy_sum_mean": 45.92403333333333, "reward_accuracy_sum_min": 26.366666666666664, "reward_accuracy_sum_max": 77.61500000000001, "reward_sla_sum_mean": -113.84055555555555, "reward_sla_sum_min": -182.22222222222223, "reward_sla_sum_max": -61.27777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2101.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-224.93722222222212, -221.52888888888882, -195.27499999999998, -208.1272222222222, -238.32777777777773, -208.02444444444433, -213.21888888888887, -218.7433333333333, -214.55888888888876, -190.60833333333332, -197.10944444444434, -224.77277777777775, -215.37666666666664, -220.29555555555544, -211.63666666666654, -245.56944444444437, -202.31888888888886, -210.78666666666658, -226.59277777777774, -185.0099999999999, -213.4522222222221, -240.1872222222222, -233.9699999999999, -197.6616666666666, -227.45499999999993, -216.80611111111114, -197.79388888888877, -207.67055555555558, -227.825, -232.7016666666665, -217.86166666666665, -207.15277777777777, -226.6616666666665, -224.21222222222215, -195.32555555555544, -218.13999999999996, -232.36277777777767, -203.19166666666666, -191.8688888888888, -202.80333333333328, -201.42888888888888, -220.4322222222221, -223.5244444444444, -205.22722222222222, -216.48555555555544, -207.51166666666654, -225.7105555555556, -204.3933333333334, -210.69500000000005, -222.48722222222213, -225.97888888888886, -232.87777777777774, -213.52555555555566, -206.63388888888886, -211.87555555555556, -213.24444444444435, -212.8833333333333, -226.90555555555548, -210.26555555555547, -213.09166666666647, -182.101111111111, -204.77388888888882, -214.89277777777772, -207.73722222222207, -241.30222222222216, -196.7722222222222, -211.26888888888888, -235.80888888888873, -203.4644444444444, -221.716111111111, -218.20222222222216, -214.5033333333332, -206.09999999999988, -204.25555555555545, -208.39499999999987, -251.37166666666647, -216.16222222222217, -173.06888888888886, -204.28722222222208, -205.74555555555546, -223.83833333333328, -238.00611111111093, -188.32833333333335, -240.02999999999983, -207.09111111111102, -228.46388888888882, -221.41611111111104, -187.05166666666662, -224.65666666666652, -211.70333333333326, -200.3427777777777, -245.73333333333312, -184.75777777777762, -222.78222222222203, -224.445, -210.08333333333317, -200.6083333333332, -262.68777777777774, -227.21055555555543, -203.77388888888888], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-224.93722222222212, -221.52888888888882, -195.27499999999998, -208.1272222222222, -238.32777777777773, -208.02444444444433, -213.21888888888887, -218.7433333333333, -214.55888888888876, -190.60833333333332, -197.10944444444434, -224.77277777777775, -215.37666666666664, -220.29555555555544, -211.63666666666654, -245.56944444444437, -202.31888888888886, -210.78666666666658, -226.59277777777774, -185.0099999999999, -213.4522222222221, -240.1872222222222, -233.9699999999999, -197.6616666666666, -227.45499999999993, -216.80611111111114, -197.79388888888877, -207.67055555555558, -227.825, -232.7016666666665, -217.86166666666665, -207.15277777777777, -226.6616666666665, -224.21222222222215, -195.32555555555544, -218.13999999999996, -232.36277777777767, -203.19166666666666, -191.8688888888888, -202.80333333333328, -201.42888888888888, -220.4322222222221, -223.5244444444444, -205.22722222222222, -216.48555555555544, -207.51166666666654, -225.7105555555556, -204.3933333333334, -210.69500000000005, -222.48722222222213, -225.97888888888886, -232.87777777777774, -213.52555555555566, -206.63388888888886, -211.87555555555556, -213.24444444444435, -212.8833333333333, -226.90555555555548, -210.26555555555547, -213.09166666666647, -182.101111111111, -204.77388888888882, -214.89277777777772, -207.73722222222207, -241.30222222222216, -196.7722222222222, -211.26888888888888, -235.80888888888873, -203.4644444444444, -221.716111111111, -218.20222222222216, -214.5033333333332, -206.09999999999988, -204.25555555555545, -208.39499999999987, -251.37166666666647, -216.16222222222217, -173.06888888888886, -204.28722222222208, -205.74555555555546, -223.83833333333328, -238.00611111111093, -188.32833333333335, -240.02999999999983, -207.09111111111102, -228.46388888888882, -221.41611111111104, -187.05166666666662, -224.65666666666652, -211.70333333333326, -200.3427777777777, -245.73333333333312, -184.75777777777762, -222.78222222222203, -224.445, -210.08333333333317, -200.6083333333332, -262.68777777777774, -227.21055555555543, -203.77388888888888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908795756861977, "mean_inference_ms": 1.763241870317318, "mean_action_processing_ms": 0.07283245104940556, "mean_env_wait_ms": 1.1870984758745653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038650035858154297, "StateBufferConnector_ms": 0.0027511119842529297, "ViewRequirementAgentConnector_ms": 0.061766862869262695}, "num_episodes": 30, "episode_return_max": -173.06888888888886, "episode_return_min": -262.68777777777774, "episode_return_mean": -214.68041111111106, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104250, "num_agent_steps_trained": 104100, "num_env_steps_sampled": 104250, "num_env_steps_trained": 104100, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 302.14391578865906, "num_env_steps_trained_throughput_per_sec": 316.5317213024047, "timesteps_total": 104250, "num_env_steps_sampled_lifetime": 104250, "num_agent_steps_sampled_lifetime": 104250, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 104250, "timers": {"training_iteration_time_ms": 10268.966, "restore_workers_time_ms": 0.011, "training_step_time_ms": 499.526, "sample_time_ms": 486.243, "synch_weights_time_ms": 12.011}, "counters": {"num_env_steps_sampled": 104250, "num_env_steps_trained": 104100, "num_agent_steps_sampled": 104250, "num_agent_steps_trained": 104100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 695, "num_samples_added_to_queue": 104100}, "done": false, "training_iteration": 34, "trial_id": "0313d_00000", "date": "2024-10-10_21-47-15", "timestamp": 1728593235, "time_this_iter_s": 10.435644388198853, "time_total_s": 350.0532763004303, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42dc98d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 350.0532763004303, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 10.333333333333334, "ram_util_percent": 53.70666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -175819.65625, "policy_loss": -175813.0625, "entropy": 29.74910545349121, "entropy_coeff": 0.01, "var_gnorm": 16.06270980834961, "vf_loss": 82652.390625, "vf_explained_var": 0.0703839659690857}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 357.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 107250, "num_env_steps_trained": 107100, "num_agent_steps_sampled": 107250, "num_agent_steps_trained": 107100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 715, "num_samples_added_to_queue": 107100, "learner_queue": {"size_count": 357, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 48.466, "learner_load_time_ms": 0.304, "learner_load_wait_time_ms": 983.986, "learner_dequeue_time_ms": 7998.047}}, "env_runners": {"episode_reward_max": -173.06888888888886, "episode_reward_min": -262.68777777777774, "episode_reward_mean": -212.58955555555545, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -262.68777777777774}, "policy_reward_max": {"default_policy": -173.06888888888886}, "policy_reward_mean": {"default_policy": -212.58955555555545}, "custom_metrics": {"num_consolidated_mean": 0.6808, "num_consolidated_min": 0.51, "num_consolidated_max": 0.87, "num_overloaded_mean": 0.9914000000000001, "num_overloaded_min": 0.82, "num_overloaded_max": 1.18, "num_moves_mean": 9.973000000000003, "num_moves_min": 9.58, "num_moves_max": 10.31, "mean_accuracy_mean": 40.98048999999999, "mean_accuracy_min": 40.758, "mean_accuracy_max": 41.277333333333324, "num_model_switches_mean": 5.980499999999998, "num_model_switches_min": 5.55, "num_model_switches_max": 6.37, "num_slav_mean": 0.15086383333333336, "num_slav_min": 0.12996666666666667, "num_slav_max": 0.17303333333333334, "mean_cluster_cpu_util_mean": 0.5643279684918376, "mean_cluster_cpu_util_min": 0.5432156368989272, "mean_cluster_cpu_util_max": 0.5847680288601227, "mean_cluster_mem_util_mean": 0.3631738433992796, "mean_cluster_mem_util_min": 0.35171959675220293, "mean_cluster_mem_util_max": 0.3724948127457734, "reward_consolidation_mean_mean": 0.20152777777777778, "reward_consolidation_mean_min": 0.08333333333333334, "reward_consolidation_mean_max": 0.37499999999999994, "reward_illegal_mean_mean": -1.6523333333333332, "reward_illegal_mean_min": -1.9666666666666666, "reward_illegal_mean_max": -1.3666666666666663, "reward_accuracy_mean_mean": 0.46581000000000006, "reward_accuracy_mean_min": 0.26366666666666666, "reward_accuracy_mean_max": 0.7761500000000001, "reward_sla_mean_mean": -1.1409000000000002, "reward_sla_mean_min": -1.8222222222222222, "reward_sla_mean_max": -0.6127777777777778, "reward_consolidation_sum_mean": 20.15277777777778, "reward_consolidation_sum_min": 8.333333333333334, "reward_consolidation_sum_max": 37.49999999999999, "reward_illegal_sum_mean": -165.23333333333332, "reward_illegal_sum_min": -196.66666666666666, "reward_illegal_sum_max": -136.66666666666663, "reward_accuracy_sum_mean": 46.580999999999996, "reward_accuracy_sum_min": 26.366666666666664, "reward_accuracy_sum_max": 77.61500000000001, "reward_sla_sum_mean": -114.08999999999997, "reward_sla_sum_min": -182.22222222222223, "reward_sla_sum_max": -61.27777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2850.0, "global_timestep_min": 600, "global_timestep_max": 4500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-217.86166666666665, -207.15277777777777, -226.6616666666665, -224.21222222222215, -195.32555555555544, -218.13999999999996, -232.36277777777767, -203.19166666666666, -191.8688888888888, -202.80333333333328, -201.42888888888888, -220.4322222222221, -223.5244444444444, -205.22722222222222, -216.48555555555544, -207.51166666666654, -225.7105555555556, -204.3933333333334, -210.69500000000005, -222.48722222222213, -225.97888888888886, -232.87777777777774, -213.52555555555566, -206.63388888888886, -211.87555555555556, -213.24444444444435, -212.8833333333333, -226.90555555555548, -210.26555555555547, -213.09166666666647, -182.101111111111, -204.77388888888882, -214.89277777777772, -207.73722222222207, -241.30222222222216, -196.7722222222222, -211.26888888888888, -235.80888888888873, -203.4644444444444, -221.716111111111, -218.20222222222216, -214.5033333333332, -206.09999999999988, -204.25555555555545, -208.39499999999987, -251.37166666666647, -216.16222222222217, -173.06888888888886, -204.28722222222208, -205.74555555555546, -223.83833333333328, -238.00611111111093, -188.32833333333335, -240.02999999999983, -207.09111111111102, -228.46388888888882, -221.41611111111104, -187.05166666666662, -224.65666666666652, -211.70333333333326, -200.3427777777777, -245.73333333333312, -184.75777777777762, -222.78222222222203, -224.445, -210.08333333333317, -200.6083333333332, -262.68777777777774, -227.21055555555543, -203.77388888888888, -212.23166666666654, -202.2427777777778, -221.51333333333318, -200.7972222222222, -201.20444444444445, -197.02666666666656, -193.56555555555556, -197.87833333333325, -216.8188888888889, -200.0533333333333, -214.93166666666667, -210.89333333333332, -221.05111111111103, -221.0366666666666, -208.51944444444442, -225.37888888888887, -204.98833333333332, -217.75055555555545, -215.37722222222217, -176.62277777777777, -192.94499999999994, -207.9983333333332, -190.3222222222222, -236.66, -190.3077777777778, -208.76388888888874, -194.85166666666655, -217.72555555555547, -253.9455555555555, -205.85444444444443], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-217.86166666666665, -207.15277777777777, -226.6616666666665, -224.21222222222215, -195.32555555555544, -218.13999999999996, -232.36277777777767, -203.19166666666666, -191.8688888888888, -202.80333333333328, -201.42888888888888, -220.4322222222221, -223.5244444444444, -205.22722222222222, -216.48555555555544, -207.51166666666654, -225.7105555555556, -204.3933333333334, -210.69500000000005, -222.48722222222213, -225.97888888888886, -232.87777777777774, -213.52555555555566, -206.63388888888886, -211.87555555555556, -213.24444444444435, -212.8833333333333, -226.90555555555548, -210.26555555555547, -213.09166666666647, -182.101111111111, -204.77388888888882, -214.89277777777772, -207.73722222222207, -241.30222222222216, -196.7722222222222, -211.26888888888888, -235.80888888888873, -203.4644444444444, -221.716111111111, -218.20222222222216, -214.5033333333332, -206.09999999999988, -204.25555555555545, -208.39499999999987, -251.37166666666647, -216.16222222222217, -173.06888888888886, -204.28722222222208, -205.74555555555546, -223.83833333333328, -238.00611111111093, -188.32833333333335, -240.02999999999983, -207.09111111111102, -228.46388888888882, -221.41611111111104, -187.05166666666662, -224.65666666666652, -211.70333333333326, -200.3427777777777, -245.73333333333312, -184.75777777777762, -222.78222222222203, -224.445, -210.08333333333317, -200.6083333333332, -262.68777777777774, -227.21055555555543, -203.77388888888888, -212.23166666666654, -202.2427777777778, -221.51333333333318, -200.7972222222222, -201.20444444444445, -197.02666666666656, -193.56555555555556, -197.87833333333325, -216.8188888888889, -200.0533333333333, -214.93166666666667, -210.89333333333332, -221.05111111111103, -221.0366666666666, -208.51944444444442, -225.37888888888887, -204.98833333333332, -217.75055555555545, -215.37722222222217, -176.62277777777777, -192.94499999999994, -207.9983333333332, -190.3222222222222, -236.66, -190.3077777777778, -208.76388888888874, -194.85166666666655, -217.72555555555547, -253.9455555555555, -205.85444444444443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19083962390483414, "mean_inference_ms": 1.7617950171226826, "mean_action_processing_ms": 0.07280812509637516, "mean_env_wait_ms": 1.1870545393434409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003855466842651367, "StateBufferConnector_ms": 0.0027818679809570312, "ViewRequirementAgentConnector_ms": 0.0620272159576416}, "num_episodes": 30, "episode_return_max": -173.06888888888886, "episode_return_min": -262.68777777777774, "episode_return_mean": -212.58955555555545, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107250, "num_agent_steps_trained": 107100, "num_env_steps_sampled": 107250, "num_env_steps_trained": 107100, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 292.7636023357873, "num_env_steps_trained_throughput_per_sec": 292.7636023357873, "timesteps_total": 107250, "num_env_steps_sampled_lifetime": 107250, "num_agent_steps_sampled_lifetime": 107250, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 107250, "timers": {"training_iteration_time_ms": 10270.261, "restore_workers_time_ms": 0.011, "training_step_time_ms": 501.913, "sample_time_ms": 488.107, "synch_weights_time_ms": 12.56}, "counters": {"num_env_steps_sampled": 107250, "num_env_steps_trained": 107100, "num_agent_steps_sampled": 107250, "num_agent_steps_trained": 107100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 715, "num_samples_added_to_queue": 107100}, "done": false, "training_iteration": 35, "trial_id": "0313d_00000", "date": "2024-10-10_21-47-25", "timestamp": 1728593245, "time_this_iter_s": 10.258891582489014, "time_total_s": 360.3121678829193, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42dc93f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 360.3121678829193, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 10.646666666666667, "ram_util_percent": 53.666666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -184822.109375, "policy_loss": -184822.015625, "entropy": 29.74593162536621, "entropy_coeff": 0.01, "var_gnorm": 16.06470489501953, "vf_loss": 89147.28125, "vf_explained_var": 0.07529318332672119}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 367.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 110400, "num_env_steps_trained": 110100, "num_agent_steps_sampled": 110400, "num_agent_steps_trained": 110100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 736, "num_samples_added_to_queue": 110400, "learner_queue": {"size_count": 367, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 48.551, "learner_load_time_ms": 0.303, "learner_load_wait_time_ms": 911.845, "learner_dequeue_time_ms": 8020.878}}, "env_runners": {"episode_reward_max": -173.06888888888886, "episode_reward_min": -262.68777777777774, "episode_reward_mean": -211.4766277777777, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -262.68777777777774}, "policy_reward_max": {"default_policy": -173.06888888888886}, "policy_reward_mean": {"default_policy": -211.4766277777777}, "custom_metrics": {"num_consolidated_mean": 0.6748999999999999, "num_consolidated_min": 0.51, "num_consolidated_max": 0.87, "num_overloaded_mean": 0.9855000000000002, "num_overloaded_min": 0.82, "num_overloaded_max": 1.18, "num_moves_mean": 9.984599999999999, "num_moves_min": 9.58, "num_moves_max": 10.31, "mean_accuracy_mean": 40.965733333333326, "mean_accuracy_min": 40.72, "mean_accuracy_max": 41.277333333333324, "num_model_switches_mean": 5.9812, "num_model_switches_min": 5.62, "num_model_switches_max": 6.46, "num_slav_mean": 0.14919883333333334, "num_slav_min": 0.1267, "num_slav_max": 0.17303333333333334, "mean_cluster_cpu_util_mean": 0.5630921320012251, "mean_cluster_cpu_util_min": 0.5442491932217852, "mean_cluster_cpu_util_max": 0.5835915951599797, "mean_cluster_mem_util_mean": 0.36247893602356557, "mean_cluster_mem_util_min": 0.35482441426992734, "mean_cluster_mem_util_max": 0.3724948127457734, "reward_consolidation_mean_mean": 0.20347222222222217, "reward_consolidation_mean_min": 0.08333333333333331, "reward_consolidation_mean_max": 0.37499999999999994, "reward_illegal_mean_mean": -1.6425, "reward_illegal_mean_min": -1.9666666666666666, "reward_illegal_mean_max": -1.3666666666666663, "reward_accuracy_mean_mean": 0.4701948333333334, "reward_accuracy_mean_min": 0.2835833333333333, "reward_accuracy_mean_max": 0.7761500000000001, "reward_sla_mean_mean": -1.1459333333333332, "reward_sla_mean_min": -1.8588888888888888, "reward_sla_mean_max": -0.5677777777777777, "reward_consolidation_sum_mean": 20.347222222222218, "reward_consolidation_sum_min": 8.333333333333332, "reward_consolidation_sum_max": 37.49999999999999, "reward_illegal_sum_mean": -164.24999999999997, "reward_illegal_sum_min": -196.66666666666666, "reward_illegal_sum_max": -136.66666666666663, "reward_accuracy_sum_mean": 47.019483333333326, "reward_accuracy_sum_min": 28.35833333333333, "reward_accuracy_sum_max": 77.61500000000001, "reward_sla_sum_mean": -114.59333333333332, "reward_sla_sum_min": -185.88888888888889, "reward_sla_sum_max": -56.77777777777777, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3967.0, "global_timestep_min": 1900, "global_timestep_max": 5600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-207.73722222222207, -241.30222222222216, -196.7722222222222, -211.26888888888888, -235.80888888888873, -203.4644444444444, -221.716111111111, -218.20222222222216, -214.5033333333332, -206.09999999999988, -204.25555555555545, -208.39499999999987, -251.37166666666647, -216.16222222222217, -173.06888888888886, -204.28722222222208, -205.74555555555546, -223.83833333333328, -238.00611111111093, -188.32833333333335, -240.02999999999983, -207.09111111111102, -228.46388888888882, -221.41611111111104, -187.05166666666662, -224.65666666666652, -211.70333333333326, -200.3427777777777, -245.73333333333312, -184.75777777777762, -222.78222222222203, -224.445, -210.08333333333317, -200.6083333333332, -262.68777777777774, -227.21055555555543, -203.77388888888888, -212.23166666666654, -202.2427777777778, -221.51333333333318, -200.7972222222222, -201.20444444444445, -197.02666666666656, -193.56555555555556, -197.87833333333325, -216.8188888888889, -200.0533333333333, -214.93166666666667, -210.89333333333332, -221.05111111111103, -221.0366666666666, -208.51944444444442, -225.37888888888887, -204.98833333333332, -217.75055555555545, -215.37722222222217, -176.62277777777777, -192.94499999999994, -207.9983333333332, -190.3222222222222, -236.66, -190.3077777777778, -208.76388888888874, -194.85166666666655, -217.72555555555547, -253.9455555555555, -205.85444444444443, -211.8794444444444, -220.897222222222, -178.2172222222221, -215.21666666666664, -210.11499999999995, -183.35277777777765, -227.16999999999985, -202.08666666666667, -209.7744444444444, -201.99111111111108, -250.51722222222207, -182.2227777777777, -202.03444444444438, -223.52611111111096, -210.02833333333336, -228.62499999999994, -204.82555555555547, -208.8216666666665, -199.4466666666667, -208.56833333333321, -205.4399999999999, -203.5894444444444, -205.08333333333323, -192.65333333333336, -218.8816666666666, -208.53055555555542, -213.75222222222226, -219.94833333333312, -199.42000000000007, -219.39499999999992, -219.68166666666653, -222.65388888888893, -206.88777777777773], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-207.73722222222207, -241.30222222222216, -196.7722222222222, -211.26888888888888, -235.80888888888873, -203.4644444444444, -221.716111111111, -218.20222222222216, -214.5033333333332, -206.09999999999988, -204.25555555555545, -208.39499999999987, -251.37166666666647, -216.16222222222217, -173.06888888888886, -204.28722222222208, -205.74555555555546, -223.83833333333328, -238.00611111111093, -188.32833333333335, -240.02999999999983, -207.09111111111102, -228.46388888888882, -221.41611111111104, -187.05166666666662, -224.65666666666652, -211.70333333333326, -200.3427777777777, -245.73333333333312, -184.75777777777762, -222.78222222222203, -224.445, -210.08333333333317, -200.6083333333332, -262.68777777777774, -227.21055555555543, -203.77388888888888, -212.23166666666654, -202.2427777777778, -221.51333333333318, -200.7972222222222, -201.20444444444445, -197.02666666666656, -193.56555555555556, -197.87833333333325, -216.8188888888889, -200.0533333333333, -214.93166666666667, -210.89333333333332, -221.05111111111103, -221.0366666666666, -208.51944444444442, -225.37888888888887, -204.98833333333332, -217.75055555555545, -215.37722222222217, -176.62277777777777, -192.94499999999994, -207.9983333333332, -190.3222222222222, -236.66, -190.3077777777778, -208.76388888888874, -194.85166666666655, -217.72555555555547, -253.9455555555555, -205.85444444444443, -211.8794444444444, -220.897222222222, -178.2172222222221, -215.21666666666664, -210.11499999999995, -183.35277777777765, -227.16999999999985, -202.08666666666667, -209.7744444444444, -201.99111111111108, -250.51722222222207, -182.2227777777777, -202.03444444444438, -223.52611111111096, -210.02833333333336, -228.62499999999994, -204.82555555555547, -208.8216666666665, -199.4466666666667, -208.56833333333321, -205.4399999999999, -203.5894444444444, -205.08333333333323, -192.65333333333336, -218.8816666666666, -208.53055555555542, -213.75222222222226, -219.94833333333312, -199.42000000000007, -219.39499999999992, -219.68166666666653, -222.65388888888893, -206.88777777777773]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907945476768483, "mean_inference_ms": 1.7624281305967338, "mean_action_processing_ms": 0.07280184666283863, "mean_env_wait_ms": 1.1873073658513105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037713050842285156, "StateBufferConnector_ms": 0.0027551651000976562, "ViewRequirementAgentConnector_ms": 0.061000823974609375}, "num_episodes": 33, "episode_return_max": -173.06888888888886, "episode_return_min": -262.68777777777774, "episode_return_mean": -211.4766277777777, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110400, "num_agent_steps_trained": 110100, "num_env_steps_sampled": 110400, "num_env_steps_trained": 110100, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 312.19205313536617, "num_env_steps_trained_throughput_per_sec": 297.3257648908249, "timesteps_total": 110400, "num_env_steps_sampled_lifetime": 110400, "num_agent_steps_sampled_lifetime": 110400, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 110400, "timers": {"training_iteration_time_ms": 10234.638, "restore_workers_time_ms": 0.011, "training_step_time_ms": 487.722, "sample_time_ms": 474.064, "synch_weights_time_ms": 12.39}, "counters": {"num_env_steps_sampled": 110400, "num_env_steps_trained": 110100, "num_agent_steps_sampled": 110400, "num_agent_steps_trained": 110100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 736, "num_samples_added_to_queue": 110400}, "done": false, "training_iteration": 36, "trial_id": "0313d_00000", "date": "2024-10-10_21-47-35", "timestamp": 1728593255, "time_this_iter_s": 10.100836515426636, "time_total_s": 370.41300439834595, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c17370>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 370.41300439834595, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 10.621428571428572, "ram_util_percent": 53.70714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -199122.21875, "policy_loss": -199136.90625, "entropy": 29.740293502807617, "entropy_coeff": 0.01, "var_gnorm": 16.06743621826172, "vf_loss": 103913.25, "vf_explained_var": 0.071236252784729}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 378.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 113550, "num_env_steps_trained": 113400, "num_agent_steps_sampled": 113550, "num_agent_steps_trained": 113400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 757, "num_samples_added_to_queue": 113400, "learner_queue": {"size_count": 378, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 49.159, "learner_load_time_ms": 0.34, "learner_load_wait_time_ms": 940.968, "learner_dequeue_time_ms": 7971.808}}, "env_runners": {"episode_reward_max": -176.62277777777777, "episode_reward_min": -262.68777777777774, "episode_reward_mean": -210.26082222222212, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -262.68777777777774}, "policy_reward_max": {"default_policy": -176.62277777777777}, "policy_reward_mean": {"default_policy": -210.26082222222212}, "custom_metrics": {"num_consolidated_mean": 0.6692, "num_consolidated_min": 0.51, "num_consolidated_max": 0.83, "num_overloaded_mean": 0.9965999999999999, "num_overloaded_min": 0.82, "num_overloaded_max": 1.17, "num_moves_mean": 9.985700000000001, "num_moves_min": 9.78, "num_moves_max": 10.3, "mean_accuracy_mean": 40.947239999999994, "mean_accuracy_min": 40.63133333333332, "mean_accuracy_max": 41.277333333333324, "num_model_switches_mean": 5.9888, "num_model_switches_min": 5.69, "num_model_switches_max": 6.46, "num_slav_mean": 0.14750116666666668, "num_slav_min": 0.12325000000000001, "num_slav_max": 0.16865, "mean_cluster_cpu_util_mean": 0.5633795741716358, "mean_cluster_cpu_util_min": 0.543036170070885, "mean_cluster_cpu_util_max": 0.5866008608964521, "mean_cluster_mem_util_mean": 0.36257099599766074, "mean_cluster_mem_util_min": 0.35071385103619507, "mean_cluster_mem_util_max": 0.3726592080714143, "reward_consolidation_mean_mean": 0.19597222222222224, "reward_consolidation_mean_min": 0.08333333333333331, "reward_consolidation_mean_max": 0.37499999999999994, "reward_illegal_mean_mean": -1.6609999999999996, "reward_illegal_mean_min": -1.95, "reward_illegal_mean_max": -1.3666666666666663, "reward_accuracy_mean_mean": 0.45614733333333324, "reward_accuracy_mean_min": 0.26335, "reward_accuracy_mean_max": 0.7761500000000001, "reward_sla_mean_mean": -1.093727777777778, "reward_sla_mean_min": -1.8588888888888888, "reward_sla_mean_max": -0.5677777777777777, "reward_consolidation_sum_mean": 19.59722222222222, "reward_consolidation_sum_min": 8.333333333333332, "reward_consolidation_sum_max": 37.49999999999999, "reward_illegal_sum_mean": -166.09999999999997, "reward_illegal_sum_min": -195.0, "reward_illegal_sum_max": -136.66666666666663, "reward_accuracy_sum_mean": 45.614733333333334, "reward_accuracy_sum_min": 26.334999999999997, "reward_accuracy_sum_max": 77.61500000000001, "reward_sla_sum_mean": -109.3727777777778, "reward_sla_sum_min": -185.88888888888889, "reward_sla_sum_max": -56.77777777777777, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4967.0, "global_timestep_min": 2900, "global_timestep_max": 6600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-222.78222222222203, -224.445, -210.08333333333317, -200.6083333333332, -262.68777777777774, -227.21055555555543, -203.77388888888888, -212.23166666666654, -202.2427777777778, -221.51333333333318, -200.7972222222222, -201.20444444444445, -197.02666666666656, -193.56555555555556, -197.87833333333325, -216.8188888888889, -200.0533333333333, -214.93166666666667, -210.89333333333332, -221.05111111111103, -221.0366666666666, -208.51944444444442, -225.37888888888887, -204.98833333333332, -217.75055555555545, -215.37722222222217, -176.62277777777777, -192.94499999999994, -207.9983333333332, -190.3222222222222, -236.66, -190.3077777777778, -208.76388888888874, -194.85166666666655, -217.72555555555547, -253.9455555555555, -205.85444444444443, -211.8794444444444, -220.897222222222, -178.2172222222221, -215.21666666666664, -210.11499999999995, -183.35277777777765, -227.16999999999985, -202.08666666666667, -209.7744444444444, -201.99111111111108, -250.51722222222207, -182.2227777777777, -202.03444444444438, -223.52611111111096, -210.02833333333336, -228.62499999999994, -204.82555555555547, -208.8216666666665, -199.4466666666667, -208.56833333333321, -205.4399999999999, -203.5894444444444, -205.08333333333323, -192.65333333333336, -218.8816666666666, -208.53055555555542, -213.75222222222226, -219.94833333333312, -199.42000000000007, -219.39499999999992, -219.68166666666653, -222.65388888888893, -206.88777777777773, -195.43166666666664, -203.60944444444422, -215.9655555555556, -202.686111111111, -210.7672222222222, -200.1233333333333, -189.74055555555555, -209.46333333333317, -208.1794444444443, -221.81111111111102, -222.35499999999988, -212.58722222222224, -196.66777777777773, -226.2455555555555, -199.26333333333324, -219.0383333333332, -218.4333333333334, -213.38222222222214, -208.3727777777776, -225.1083333333332, -186.11388888888882, -223.3122222222221, -207.63888888888872, -196.76444444444434, -194.7105555555555, -223.41111111111098, -221.03277777777774, -225.45666666666668, -217.19388888888872, -205.13444444444426], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-222.78222222222203, -224.445, -210.08333333333317, -200.6083333333332, -262.68777777777774, -227.21055555555543, -203.77388888888888, -212.23166666666654, -202.2427777777778, -221.51333333333318, -200.7972222222222, -201.20444444444445, -197.02666666666656, -193.56555555555556, -197.87833333333325, -216.8188888888889, -200.0533333333333, -214.93166666666667, -210.89333333333332, -221.05111111111103, -221.0366666666666, -208.51944444444442, -225.37888888888887, -204.98833333333332, -217.75055555555545, -215.37722222222217, -176.62277777777777, -192.94499999999994, -207.9983333333332, -190.3222222222222, -236.66, -190.3077777777778, -208.76388888888874, -194.85166666666655, -217.72555555555547, -253.9455555555555, -205.85444444444443, -211.8794444444444, -220.897222222222, -178.2172222222221, -215.21666666666664, -210.11499999999995, -183.35277777777765, -227.16999999999985, -202.08666666666667, -209.7744444444444, -201.99111111111108, -250.51722222222207, -182.2227777777777, -202.03444444444438, -223.52611111111096, -210.02833333333336, -228.62499999999994, -204.82555555555547, -208.8216666666665, -199.4466666666667, -208.56833333333321, -205.4399999999999, -203.5894444444444, -205.08333333333323, -192.65333333333336, -218.8816666666666, -208.53055555555542, -213.75222222222226, -219.94833333333312, -199.42000000000007, -219.39499999999992, -219.68166666666653, -222.65388888888893, -206.88777777777773, -195.43166666666664, -203.60944444444422, -215.9655555555556, -202.686111111111, -210.7672222222222, -200.1233333333333, -189.74055555555555, -209.46333333333317, -208.1794444444443, -221.81111111111102, -222.35499999999988, -212.58722222222224, -196.66777777777773, -226.2455555555555, -199.26333333333324, -219.0383333333332, -218.4333333333334, -213.38222222222214, -208.3727777777776, -225.1083333333332, -186.11388888888882, -223.3122222222221, -207.63888888888872, -196.76444444444434, -194.7105555555555, -223.41111111111098, -221.03277777777774, -225.45666666666668, -217.19388888888872, -205.13444444444426]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19074909770193543, "mean_inference_ms": 1.7613664344474704, "mean_action_processing_ms": 0.07277625100612121, "mean_env_wait_ms": 1.1871514464673318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003849029541015625, "StateBufferConnector_ms": 0.0028100013732910156, "ViewRequirementAgentConnector_ms": 0.06211495399475098}, "num_episodes": 30, "episode_return_max": -176.62277777777777, "episode_return_min": -262.68777777777774, "episode_return_mean": -210.26082222222212, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 113550, "num_agent_steps_trained": 113400, "num_env_steps_sampled": 113550, "num_env_steps_trained": 113400, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 303.0826829215419, "num_env_steps_trained_throughput_per_sec": 317.5151916320915, "timesteps_total": 113550, "num_env_steps_sampled_lifetime": 113550, "num_agent_steps_sampled_lifetime": 113550, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 113550, "timers": {"training_iteration_time_ms": 10269.236, "restore_workers_time_ms": 0.011, "training_step_time_ms": 501.384, "sample_time_ms": 487.728, "synch_weights_time_ms": 12.406}, "counters": {"num_env_steps_sampled": 113550, "num_env_steps_trained": 113400, "num_agent_steps_sampled": 113550, "num_agent_steps_trained": 113400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 757, "num_samples_added_to_queue": 113400}, "done": false, "training_iteration": 37, "trial_id": "0313d_00000", "date": "2024-10-10_21-47-46", "timestamp": 1728593266, "time_this_iter_s": 10.403056859970093, "time_total_s": 380.81606125831604, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42dc85e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 380.81606125831604, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 10.366666666666667, "ram_util_percent": 53.48666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -185061.953125, "policy_loss": -185063.71875, "entropy": 29.734758377075195, "entropy_coeff": 0.01, "var_gnorm": 16.070005416870117, "vf_loss": 90973.296875, "vf_explained_var": 0.07788878679275513}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 388.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 116550, "num_env_steps_trained": 116400, "num_agent_steps_sampled": 116550, "num_agent_steps_trained": 116400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 777, "num_samples_added_to_queue": 116400, "learner_queue": {"size_count": 388, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 50.305, "learner_load_time_ms": 0.336, "learner_load_wait_time_ms": 954.519, "learner_dequeue_time_ms": 7998.681}}, "env_runners": {"episode_reward_max": -167.85166666666657, "episode_reward_min": -253.9455555555555, "episode_reward_mean": -207.945761111111, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -253.9455555555555}, "policy_reward_max": {"default_policy": -167.85166666666657}, "policy_reward_mean": {"default_policy": -207.945761111111}, "custom_metrics": {"num_consolidated_mean": 0.6777, "num_consolidated_min": 0.51, "num_consolidated_max": 0.83, "num_overloaded_mean": 0.9974000000000001, "num_overloaded_min": 0.87, "num_overloaded_max": 1.17, "num_moves_mean": 9.9777, "num_moves_min": 9.76, "num_moves_max": 10.3, "mean_accuracy_mean": 40.934826666666666, "mean_accuracy_min": 40.63133333333332, "mean_accuracy_max": 41.157, "num_model_switches_mean": 5.9746999999999995, "num_model_switches_min": 5.61, "num_model_switches_max": 6.46, "num_slav_mean": 0.14642149999999998, "num_slav_min": 0.12325000000000001, "num_slav_max": 0.16865, "mean_cluster_cpu_util_mean": 0.5634747479133563, "mean_cluster_cpu_util_min": 0.543036170070885, "mean_cluster_cpu_util_max": 0.5866008608964521, "mean_cluster_mem_util_mean": 0.362592196290436, "mean_cluster_mem_util_min": 0.35071385103619507, "mean_cluster_mem_util_max": 0.3726592080714143, "reward_consolidation_mean_mean": 0.19541666666666666, "reward_consolidation_mean_min": 0.08333333333333331, "reward_consolidation_mean_max": 0.3472222222222222, "reward_illegal_mean_mean": -1.6623333333333332, "reward_illegal_mean_min": -1.95, "reward_illegal_mean_max": -1.45, "reward_accuracy_mean_mean": 0.45197016666666656, "reward_accuracy_mean_min": 0.26335, "reward_accuracy_mean_max": 0.63705, "reward_sla_mean_mean": -1.064511111111111, "reward_sla_mean_min": -1.8588888888888888, "reward_sla_mean_max": -0.5677777777777777, "reward_consolidation_sum_mean": 19.541666666666664, "reward_consolidation_sum_min": 8.333333333333332, "reward_consolidation_sum_max": 34.72222222222222, "reward_illegal_sum_mean": -166.2333333333333, "reward_illegal_sum_min": -195.0, "reward_illegal_sum_max": -145.0, "reward_accuracy_sum_mean": 45.19701666666667, "reward_accuracy_sum_min": 26.334999999999997, "reward_accuracy_sum_max": 63.705, "reward_sla_sum_mean": -106.45111111111109, "reward_sla_sum_min": -185.88888888888889, "reward_sla_sum_max": -56.77777777777777, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5967.0, "global_timestep_min": 3900, "global_timestep_max": 7600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-236.66, -190.3077777777778, -208.76388888888874, -194.85166666666655, -217.72555555555547, -253.9455555555555, -205.85444444444443, -211.8794444444444, -220.897222222222, -178.2172222222221, -215.21666666666664, -210.11499999999995, -183.35277777777765, -227.16999999999985, -202.08666666666667, -209.7744444444444, -201.99111111111108, -250.51722222222207, -182.2227777777777, -202.03444444444438, -223.52611111111096, -210.02833333333336, -228.62499999999994, -204.82555555555547, -208.8216666666665, -199.4466666666667, -208.56833333333321, -205.4399999999999, -203.5894444444444, -205.08333333333323, -192.65333333333336, -218.8816666666666, -208.53055555555542, -213.75222222222226, -219.94833333333312, -199.42000000000007, -219.39499999999992, -219.68166666666653, -222.65388888888893, -206.88777777777773, -195.43166666666664, -203.60944444444422, -215.9655555555556, -202.686111111111, -210.7672222222222, -200.1233333333333, -189.74055555555555, -209.46333333333317, -208.1794444444443, -221.81111111111102, -222.35499999999988, -212.58722222222224, -196.66777777777773, -226.2455555555555, -199.26333333333324, -219.0383333333332, -218.4333333333334, -213.38222222222214, -208.3727777777776, -225.1083333333332, -186.11388888888882, -223.3122222222221, -207.63888888888872, -196.76444444444434, -194.7105555555555, -223.41111111111098, -221.03277777777774, -225.45666666666668, -217.19388888888872, -205.13444444444426, -196.3466666666666, -167.85166666666657, -214.17444444444436, -202.95388888888877, -211.94166666666666, -208.7744444444444, -197.28055555555534, -199.16111111111098, -202.6127777777776, -204.6794444444443, -180.43222222222224, -194.67222222222213, -203.74333333333323, -233.21888888888887, -197.13277777777768, -188.98611111111103, -174.44277777777774, -211.51499999999996, -200.89444444444456, -211.9249999999998, -215.60388888888878, -231.83166666666662, -193.2905555555555, -213.68722222222218, -195.10333333333335, -220.5494444444444, -212.70388888888883, -190.915, -206.11388888888888, -188.6944444444443], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-236.66, -190.3077777777778, -208.76388888888874, -194.85166666666655, -217.72555555555547, -253.9455555555555, -205.85444444444443, -211.8794444444444, -220.897222222222, -178.2172222222221, -215.21666666666664, -210.11499999999995, -183.35277777777765, -227.16999999999985, -202.08666666666667, -209.7744444444444, -201.99111111111108, -250.51722222222207, -182.2227777777777, -202.03444444444438, -223.52611111111096, -210.02833333333336, -228.62499999999994, -204.82555555555547, -208.8216666666665, -199.4466666666667, -208.56833333333321, -205.4399999999999, -203.5894444444444, -205.08333333333323, -192.65333333333336, -218.8816666666666, -208.53055555555542, -213.75222222222226, -219.94833333333312, -199.42000000000007, -219.39499999999992, -219.68166666666653, -222.65388888888893, -206.88777777777773, -195.43166666666664, -203.60944444444422, -215.9655555555556, -202.686111111111, -210.7672222222222, -200.1233333333333, -189.74055555555555, -209.46333333333317, -208.1794444444443, -221.81111111111102, -222.35499999999988, -212.58722222222224, -196.66777777777773, -226.2455555555555, -199.26333333333324, -219.0383333333332, -218.4333333333334, -213.38222222222214, -208.3727777777776, -225.1083333333332, -186.11388888888882, -223.3122222222221, -207.63888888888872, -196.76444444444434, -194.7105555555555, -223.41111111111098, -221.03277777777774, -225.45666666666668, -217.19388888888872, -205.13444444444426, -196.3466666666666, -167.85166666666657, -214.17444444444436, -202.95388888888877, -211.94166666666666, -208.7744444444444, -197.28055555555534, -199.16111111111098, -202.6127777777776, -204.6794444444443, -180.43222222222224, -194.67222222222213, -203.74333333333323, -233.21888888888887, -197.13277777777768, -188.98611111111103, -174.44277777777774, -211.51499999999996, -200.89444444444456, -211.9249999999998, -215.60388888888878, -231.83166666666662, -193.2905555555555, -213.68722222222218, -195.10333333333335, -220.5494444444444, -212.70388888888883, -190.915, -206.11388888888888, -188.6944444444443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19069150146172006, "mean_inference_ms": 1.7599385764119742, "mean_action_processing_ms": 0.07274996248953401, "mean_env_wait_ms": 1.1869039726838928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038187503814697266, "StateBufferConnector_ms": 0.0027930736541748047, "ViewRequirementAgentConnector_ms": 0.06147933006286621}, "num_episodes": 30, "episode_return_max": -167.85166666666657, "episode_return_min": -253.9455555555555, "episode_return_mean": -207.945761111111, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116550, "num_agent_steps_trained": 116400, "num_env_steps_sampled": 116550, "num_env_steps_trained": 116400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 299.38639516653785, "num_env_steps_trained_throughput_per_sec": 299.38639516653785, "timesteps_total": 116550, "num_env_steps_sampled_lifetime": 116550, "num_agent_steps_sampled_lifetime": 116550, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 116550, "timers": {"training_iteration_time_ms": 10253.256, "restore_workers_time_ms": 0.011, "training_step_time_ms": 509.746, "sample_time_ms": 496.98, "synch_weights_time_ms": 11.502}, "counters": {"num_env_steps_sampled": 116550, "num_env_steps_trained": 116400, "num_agent_steps_sampled": 116550, "num_agent_steps_trained": 116400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 777, "num_samples_added_to_queue": 116400}, "done": false, "training_iteration": 38, "trial_id": "0313d_00000", "date": "2024-10-10_21-47-56", "timestamp": 1728593276, "time_this_iter_s": 10.033247232437134, "time_total_s": 390.8493084907532, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c17970>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 390.8493084907532, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 10.733333333333333, "ram_util_percent": 53.746666666666655}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -189342.046875, "policy_loss": -189347.90625, "entropy": 29.729642868041992, "entropy_coeff": 0.01, "var_gnorm": 16.069684982299805, "vf_loss": 95041.9609375, "vf_explained_var": 0.0807608962059021}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 398.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 119550, "num_env_steps_trained": 119400, "num_agent_steps_sampled": 119550, "num_agent_steps_trained": 119400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 797, "num_samples_added_to_queue": 119400, "learner_queue": {"size_count": 398, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 49.291, "learner_load_time_ms": 0.314, "learner_load_wait_time_ms": 985.6, "learner_dequeue_time_ms": 8013.137}}, "env_runners": {"episode_reward_max": -167.85166666666657, "episode_reward_min": -233.21888888888887, "episode_reward_mean": -205.78218333333322, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -233.21888888888887}, "policy_reward_max": {"default_policy": -167.85166666666657}, "policy_reward_mean": {"default_policy": -205.78218333333322}, "custom_metrics": {"num_consolidated_mean": 0.6817, "num_consolidated_min": 0.51, "num_consolidated_max": 0.83, "num_overloaded_mean": 0.9923000000000002, "num_overloaded_min": 0.82, "num_overloaded_max": 1.16, "num_moves_mean": 9.9804, "num_moves_min": 9.76, "num_moves_max": 10.3, "mean_accuracy_mean": 40.92728999999999, "mean_accuracy_min": 40.63133333333332, "mean_accuracy_max": 41.150666666666666, "num_model_switches_mean": 5.987900000000001, "num_model_switches_min": 5.45, "num_model_switches_max": 6.48, "num_slav_mean": 0.14619516666666665, "num_slav_min": 0.12118333333333332, "num_slav_max": 0.16163333333333335, "mean_cluster_cpu_util_mean": 0.5635291624183895, "mean_cluster_cpu_util_min": 0.5385733307177724, "mean_cluster_cpu_util_max": 0.5866008608964521, "mean_cluster_mem_util_mean": 0.3628384282897759, "mean_cluster_mem_util_min": 0.35071385103619507, "mean_cluster_mem_util_max": 0.3726592080714143, "reward_consolidation_mean_mean": 0.19569444444444442, "reward_consolidation_mean_min": 0.08333333333333331, "reward_consolidation_mean_max": 0.3472222222222222, "reward_illegal_mean_mean": -1.653833333333333, "reward_illegal_mean_min": -1.933333333333333, "reward_illegal_mean_max": -1.366666666666666, "reward_accuracy_mean_mean": 0.4530448333333333, "reward_accuracy_mean_min": 0.24248333333333327, "reward_accuracy_mean_max": 0.63515, "reward_sla_mean_mean": -1.0527277777777777, "reward_sla_mean_min": -1.5166666666666668, "reward_sla_mean_max": -0.5127777777777779, "reward_consolidation_sum_mean": 19.569444444444443, "reward_consolidation_sum_min": 8.333333333333332, "reward_consolidation_sum_max": 34.72222222222222, "reward_illegal_sum_mean": -165.38333333333333, "reward_illegal_sum_min": -193.3333333333333, "reward_illegal_sum_max": -136.6666666666666, "reward_accuracy_sum_mean": 45.30448333333333, "reward_accuracy_sum_min": 24.248333333333328, "reward_accuracy_sum_max": 63.515, "reward_sla_sum_mean": -105.27277777777779, "reward_sla_sum_min": -151.66666666666669, "reward_sla_sum_max": -51.277777777777786, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5078.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-192.65333333333336, -218.8816666666666, -208.53055555555542, -213.75222222222226, -219.94833333333312, -199.42000000000007, -219.39499999999992, -219.68166666666653, -222.65388888888893, -206.88777777777773, -195.43166666666664, -203.60944444444422, -215.9655555555556, -202.686111111111, -210.7672222222222, -200.1233333333333, -189.74055555555555, -209.46333333333317, -208.1794444444443, -221.81111111111102, -222.35499999999988, -212.58722222222224, -196.66777777777773, -226.2455555555555, -199.26333333333324, -219.0383333333332, -218.4333333333334, -213.38222222222214, -208.3727777777776, -225.1083333333332, -186.11388888888882, -223.3122222222221, -207.63888888888872, -196.76444444444434, -194.7105555555555, -223.41111111111098, -221.03277777777774, -225.45666666666668, -217.19388888888872, -205.13444444444426, -196.3466666666666, -167.85166666666657, -214.17444444444436, -202.95388888888877, -211.94166666666666, -208.7744444444444, -197.28055555555534, -199.16111111111098, -202.6127777777776, -204.6794444444443, -180.43222222222224, -194.67222222222213, -203.74333333333323, -233.21888888888887, -197.13277777777768, -188.98611111111103, -174.44277777777774, -211.51499999999996, -200.89444444444456, -211.9249999999998, -215.60388888888878, -231.83166666666662, -193.2905555555555, -213.68722222222218, -195.10333333333335, -220.5494444444444, -212.70388888888883, -190.915, -206.11388888888888, -188.6944444444443, -174.92166666666665, -202.81999999999985, -210.09444444444435, -181.27944444444432, -211.29055555555553, -215.9105555555555, -222.32055555555544, -195.4883333333333, -214.4027777777777, -207.40166666666667, -187.95500000000004, -208.69555555555556, -214.0616666666666, -216.31888888888878, -175.2744444444443, -200.3627777777777, -191.67499999999978, -180.93111111111097, -215.19499999999994, -221.6222222222222, -209.70111111111098, -191.81222222222215, -214.60277777777765, -191.82111111111092, -203.37388888888876, -200.47944444444437, -210.79555555555555, -206.42166666666665, -221.71222222222212, -186.43888888888875], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-192.65333333333336, -218.8816666666666, -208.53055555555542, -213.75222222222226, -219.94833333333312, -199.42000000000007, -219.39499999999992, -219.68166666666653, -222.65388888888893, -206.88777777777773, -195.43166666666664, -203.60944444444422, -215.9655555555556, -202.686111111111, -210.7672222222222, -200.1233333333333, -189.74055555555555, -209.46333333333317, -208.1794444444443, -221.81111111111102, -222.35499999999988, -212.58722222222224, -196.66777777777773, -226.2455555555555, -199.26333333333324, -219.0383333333332, -218.4333333333334, -213.38222222222214, -208.3727777777776, -225.1083333333332, -186.11388888888882, -223.3122222222221, -207.63888888888872, -196.76444444444434, -194.7105555555555, -223.41111111111098, -221.03277777777774, -225.45666666666668, -217.19388888888872, -205.13444444444426, -196.3466666666666, -167.85166666666657, -214.17444444444436, -202.95388888888877, -211.94166666666666, -208.7744444444444, -197.28055555555534, -199.16111111111098, -202.6127777777776, -204.6794444444443, -180.43222222222224, -194.67222222222213, -203.74333333333323, -233.21888888888887, -197.13277777777768, -188.98611111111103, -174.44277777777774, -211.51499999999996, -200.89444444444456, -211.9249999999998, -215.60388888888878, -231.83166666666662, -193.2905555555555, -213.68722222222218, -195.10333333333335, -220.5494444444444, -212.70388888888883, -190.915, -206.11388888888888, -188.6944444444443, -174.92166666666665, -202.81999999999985, -210.09444444444435, -181.27944444444432, -211.29055555555553, -215.9105555555555, -222.32055555555544, -195.4883333333333, -214.4027777777777, -207.40166666666667, -187.95500000000004, -208.69555555555556, -214.0616666666666, -216.31888888888878, -175.2744444444443, -200.3627777777777, -191.67499999999978, -180.93111111111097, -215.19499999999994, -221.6222222222222, -209.70111111111098, -191.81222222222215, -214.60277777777765, -191.82111111111092, -203.37388888888876, -200.47944444444437, -210.79555555555555, -206.42166666666665, -221.71222222222212, -186.43888888888875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19066005513407766, "mean_inference_ms": 1.757699916727588, "mean_action_processing_ms": 0.07273720495454736, "mean_env_wait_ms": 1.1867491260958514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039560794830322266, "StateBufferConnector_ms": 0.002829313278198242, "ViewRequirementAgentConnector_ms": 0.0629887580871582}, "num_episodes": 30, "episode_return_max": -167.85166666666657, "episode_return_min": -233.21888888888887, "episode_return_mean": -205.78218333333322, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 119550, "num_agent_steps_trained": 119400, "num_env_steps_sampled": 119550, "num_env_steps_trained": 119400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 291.5401243619749, "num_env_steps_trained_throughput_per_sec": 291.5401243619749, "timesteps_total": 119550, "num_env_steps_sampled_lifetime": 119550, "num_agent_steps_sampled_lifetime": 119550, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 119550, "timers": {"training_iteration_time_ms": 10278.798, "restore_workers_time_ms": 0.012, "training_step_time_ms": 537.095, "sample_time_ms": 523.072, "synch_weights_time_ms": 12.717}, "counters": {"num_env_steps_sampled": 119550, "num_env_steps_trained": 119400, "num_agent_steps_sampled": 119550, "num_agent_steps_trained": 119400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 797, "num_samples_added_to_queue": 119400}, "done": false, "training_iteration": 39, "trial_id": "0313d_00000", "date": "2024-10-10_21-48-06", "timestamp": 1728593286, "time_this_iter_s": 10.309427261352539, "time_total_s": 401.1587357521057, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d89cc0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 401.1587357521057, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 13.821428571428571, "ram_util_percent": 53.74999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -199151.171875, "policy_loss": -199163.9375, "entropy": 29.734691619873047, "entropy_coeff": 0.01, "var_gnorm": 16.070497512817383, "vf_loss": 101965.515625, "vf_explained_var": 0.08544743061065674}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 408.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 122550, "num_env_steps_trained": 122400, "num_agent_steps_sampled": 122550, "num_agent_steps_trained": 122400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 817, "num_samples_added_to_queue": 122400, "learner_queue": {"size_count": 408, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 51.034, "learner_load_time_ms": 0.313, "learner_load_wait_time_ms": 965.698, "learner_dequeue_time_ms": 8056.467}}, "env_runners": {"episode_reward_max": -167.85166666666657, "episode_reward_min": -233.21888888888887, "episode_reward_mean": -204.21521111111102, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -233.21888888888887}, "policy_reward_max": {"default_policy": -167.85166666666657}, "policy_reward_mean": {"default_policy": -204.21521111111102}, "custom_metrics": {"num_consolidated_mean": 0.6856, "num_consolidated_min": 0.53, "num_consolidated_max": 0.83, "num_overloaded_mean": 0.9799, "num_overloaded_min": 0.82, "num_overloaded_max": 1.13, "num_moves_mean": 9.995600000000001, "num_moves_min": 9.74, "num_moves_max": 10.3, "mean_accuracy_mean": 40.92184333333333, "mean_accuracy_min": 40.63133333333332, "mean_accuracy_max": 41.214000000000006, "num_model_switches_mean": 5.981900000000001, "num_model_switches_min": 5.45, "num_model_switches_max": 6.48, "num_slav_mean": 0.14547616666666666, "num_slav_min": 0.12118333333333332, "num_slav_max": 0.16119999999999998, "mean_cluster_cpu_util_mean": 0.5622181335199832, "mean_cluster_cpu_util_min": 0.5385733307177724, "mean_cluster_cpu_util_max": 0.5827263286341354, "mean_cluster_mem_util_mean": 0.3624182359927094, "mean_cluster_mem_util_min": 0.3514550112661099, "mean_cluster_mem_util_max": 0.37114929425356635, "reward_consolidation_mean_mean": 0.2016666666666667, "reward_consolidation_mean_min": 0.08333333333333331, "reward_consolidation_mean_max": 0.3472222222222222, "reward_illegal_mean_mean": -1.633166666666666, "reward_illegal_mean_min": -1.883333333333333, "reward_illegal_mean_max": -1.366666666666666, "reward_accuracy_mean_mean": 0.46284233333333336, "reward_accuracy_mean_min": 0.24248333333333327, "reward_accuracy_mean_max": 0.6496833333333332, "reward_sla_mean_mean": -1.0734944444444445, "reward_sla_mean_min": -1.6611111111111114, "reward_sla_mean_max": -0.5127777777777779, "reward_consolidation_sum_mean": 20.166666666666668, "reward_consolidation_sum_min": 8.333333333333332, "reward_consolidation_sum_max": 34.72222222222222, "reward_illegal_sum_mean": -163.31666666666663, "reward_illegal_sum_min": -188.33333333333331, "reward_illegal_sum_max": -136.6666666666666, "reward_accuracy_sum_mean": 46.28423333333334, "reward_accuracy_sum_min": 24.248333333333328, "reward_accuracy_sum_max": 64.96833333333332, "reward_sla_sum_mean": -107.34944444444443, "reward_sla_sum_min": -166.11111111111114, "reward_sla_sum_max": -51.277777777777786, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3738.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-186.11388888888882, -223.3122222222221, -207.63888888888872, -196.76444444444434, -194.7105555555555, -223.41111111111098, -221.03277777777774, -225.45666666666668, -217.19388888888872, -205.13444444444426, -196.3466666666666, -167.85166666666657, -214.17444444444436, -202.95388888888877, -211.94166666666666, -208.7744444444444, -197.28055555555534, -199.16111111111098, -202.6127777777776, -204.6794444444443, -180.43222222222224, -194.67222222222213, -203.74333333333323, -233.21888888888887, -197.13277777777768, -188.98611111111103, -174.44277777777774, -211.51499999999996, -200.89444444444456, -211.9249999999998, -215.60388888888878, -231.83166666666662, -193.2905555555555, -213.68722222222218, -195.10333333333335, -220.5494444444444, -212.70388888888883, -190.915, -206.11388888888888, -188.6944444444443, -174.92166666666665, -202.81999999999985, -210.09444444444435, -181.27944444444432, -211.29055555555553, -215.9105555555555, -222.32055555555544, -195.4883333333333, -214.4027777777777, -207.40166666666667, -187.95500000000004, -208.69555555555556, -214.0616666666666, -216.31888888888878, -175.2744444444443, -200.3627777777777, -191.67499999999978, -180.93111111111097, -215.19499999999994, -221.6222222222222, -209.70111111111098, -191.81222222222215, -214.60277777777765, -191.82111111111092, -203.37388888888876, -200.47944444444437, -210.79555555555555, -206.42166666666665, -221.71222222222212, -186.43888888888875, -222.55222222222207, -209.29, -224.27333333333326, -197.23222222222202, -204.96388888888885, -180.45388888888877, -170.0683333333333, -186.77999999999992, -198.7572222222222, -207.36166666666676, -216.1405555555554, -177.35777777777776, -208.27333333333323, -207.13055555555536, -200.0183333333331, -221.64611111111086, -215.56499999999983, -218.93888888888893, -220.34722222222223, -223.13666666666654, -214.971111111111, -178.79777777777764, -182.70111111111103, -199.14666666666653, -194.6383333333333, -225.69722222222225, -217.11444444444427, -208.92055555555544, -203.44222222222217, -228.62222222222204], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-186.11388888888882, -223.3122222222221, -207.63888888888872, -196.76444444444434, -194.7105555555555, -223.41111111111098, -221.03277777777774, -225.45666666666668, -217.19388888888872, -205.13444444444426, -196.3466666666666, -167.85166666666657, -214.17444444444436, -202.95388888888877, -211.94166666666666, -208.7744444444444, -197.28055555555534, -199.16111111111098, -202.6127777777776, -204.6794444444443, -180.43222222222224, -194.67222222222213, -203.74333333333323, -233.21888888888887, -197.13277777777768, -188.98611111111103, -174.44277777777774, -211.51499999999996, -200.89444444444456, -211.9249999999998, -215.60388888888878, -231.83166666666662, -193.2905555555555, -213.68722222222218, -195.10333333333335, -220.5494444444444, -212.70388888888883, -190.915, -206.11388888888888, -188.6944444444443, -174.92166666666665, -202.81999999999985, -210.09444444444435, -181.27944444444432, -211.29055555555553, -215.9105555555555, -222.32055555555544, -195.4883333333333, -214.4027777777777, -207.40166666666667, -187.95500000000004, -208.69555555555556, -214.0616666666666, -216.31888888888878, -175.2744444444443, -200.3627777777777, -191.67499999999978, -180.93111111111097, -215.19499999999994, -221.6222222222222, -209.70111111111098, -191.81222222222215, -214.60277777777765, -191.82111111111092, -203.37388888888876, -200.47944444444437, -210.79555555555555, -206.42166666666665, -221.71222222222212, -186.43888888888875, -222.55222222222207, -209.29, -224.27333333333326, -197.23222222222202, -204.96388888888885, -180.45388888888877, -170.0683333333333, -186.77999999999992, -198.7572222222222, -207.36166666666676, -216.1405555555554, -177.35777777777776, -208.27333333333323, -207.13055555555536, -200.0183333333331, -221.64611111111086, -215.56499999999983, -218.93888888888893, -220.34722222222223, -223.13666666666654, -214.971111111111, -178.79777777777764, -182.70111111111103, -199.14666666666653, -194.6383333333333, -225.69722222222225, -217.11444444444427, -208.92055555555544, -203.44222222222217, -228.62222222222204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19072150649263636, "mean_inference_ms": 1.7577825330548418, "mean_action_processing_ms": 0.07276353798864843, "mean_env_wait_ms": 1.1872723943667225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004758596420288086, "StateBufferConnector_ms": 0.002844095230102539, "ViewRequirementAgentConnector_ms": 0.06339859962463379}, "num_episodes": 30, "episode_return_max": -167.85166666666657, "episode_return_min": -233.21888888888887, "episode_return_mean": -204.21521111111102, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122550, "num_agent_steps_trained": 122400, "num_env_steps_sampled": 122550, "num_env_steps_trained": 122400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 295.5057981235779, "num_env_steps_trained_throughput_per_sec": 295.5057981235779, "timesteps_total": 122550, "num_env_steps_sampled_lifetime": 122550, "num_agent_steps_sampled_lifetime": 122550, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 122550, "timers": {"training_iteration_time_ms": 10269.133, "restore_workers_time_ms": 0.011, "training_step_time_ms": 492.229, "sample_time_ms": 478.423, "synch_weights_time_ms": 12.524}, "counters": {"num_env_steps_sampled": 122550, "num_env_steps_trained": 122400, "num_agent_steps_sampled": 122550, "num_agent_steps_trained": 122400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 817, "num_samples_added_to_queue": 122400}, "done": false, "training_iteration": 40, "trial_id": "0313d_00000", "date": "2024-10-10_21-48-16", "timestamp": 1728593296, "time_this_iter_s": 10.166773557662964, "time_total_s": 411.3255093097687, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d8bd90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 411.3255093097687, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 11.246666666666666, "ram_util_percent": 55.93999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -192699.625, "policy_loss": -192711.03125, "entropy": 29.730749130249023, "entropy_coeff": 0.01, "var_gnorm": 16.073339462280273, "vf_loss": 100587.90625, "vf_explained_var": 0.07616883516311646}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 418.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 125550, "num_env_steps_trained": 125400, "num_agent_steps_sampled": 125550, "num_agent_steps_trained": 125400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 837, "num_samples_added_to_queue": 125400, "learner_queue": {"size_count": 418, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.209, "learner_load_time_ms": 0.303, "learner_load_wait_time_ms": 967.619, "learner_dequeue_time_ms": 8061.384}}, "env_runners": {"episode_reward_max": -170.0683333333333, "episode_reward_min": -241.73888888888885, "episode_reward_mean": -206.02504444444435, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -241.73888888888885}, "policy_reward_max": {"default_policy": -170.0683333333333}, "policy_reward_mean": {"default_policy": -206.02504444444435}, "custom_metrics": {"num_consolidated_mean": 0.6853, "num_consolidated_min": 0.53, "num_consolidated_max": 0.82, "num_overloaded_mean": 0.9784, "num_overloaded_min": 0.82, "num_overloaded_max": 1.15, "num_moves_mean": 10.015899999999998, "num_moves_min": 9.74, "num_moves_max": 10.39, "mean_accuracy_mean": 40.91988, "mean_accuracy_min": 40.63766666666666, "mean_accuracy_max": 41.214000000000006, "num_model_switches_mean": 5.997799999999999, "num_model_switches_min": 5.45, "num_model_switches_max": 6.48, "num_slav_mean": 0.14534733333333333, "num_slav_min": 0.12118333333333332, "num_slav_max": 0.16241666666666663, "mean_cluster_cpu_util_mean": 0.5614108668013507, "mean_cluster_cpu_util_min": 0.5385733307177724, "mean_cluster_cpu_util_max": 0.5827263286341354, "mean_cluster_mem_util_mean": 0.36212719052462766, "mean_cluster_mem_util_min": 0.3514550112661099, "mean_cluster_mem_util_max": 0.37114929425356635, "reward_consolidation_mean_mean": 0.20625000000000004, "reward_consolidation_mean_min": 0.08333333333333331, "reward_consolidation_mean_max": 0.375, "reward_illegal_mean_mean": -1.6306666666666663, "reward_illegal_mean_min": -1.916666666666667, "reward_illegal_mean_max": -1.366666666666666, "reward_accuracy_mean_mean": 0.4703606666666667, "reward_accuracy_mean_min": 0.24248333333333327, "reward_accuracy_mean_max": 0.6496833333333332, "reward_sla_mean_mean": -1.1061944444444445, "reward_sla_mean_min": -1.6611111111111114, "reward_sla_mean_max": -0.5127777777777779, "reward_consolidation_sum_mean": 20.625, "reward_consolidation_sum_min": 8.333333333333332, "reward_consolidation_sum_max": 37.5, "reward_illegal_sum_mean": -163.06666666666666, "reward_illegal_sum_min": -191.66666666666669, "reward_illegal_sum_max": -136.6666666666666, "reward_accuracy_sum_mean": 47.03606666666666, "reward_accuracy_sum_min": 24.248333333333328, "reward_accuracy_sum_max": 64.96833333333332, "reward_sla_sum_mean": -110.61944444444444, "reward_sla_sum_min": -166.11111111111114, "reward_sla_sum_max": -51.277777777777786, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2398.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-215.60388888888878, -231.83166666666662, -193.2905555555555, -213.68722222222218, -195.10333333333335, -220.5494444444444, -212.70388888888883, -190.915, -206.11388888888888, -188.6944444444443, -174.92166666666665, -202.81999999999985, -210.09444444444435, -181.27944444444432, -211.29055555555553, -215.9105555555555, -222.32055555555544, -195.4883333333333, -214.4027777777777, -207.40166666666667, -187.95500000000004, -208.69555555555556, -214.0616666666666, -216.31888888888878, -175.2744444444443, -200.3627777777777, -191.67499999999978, -180.93111111111097, -215.19499999999994, -221.6222222222222, -209.70111111111098, -191.81222222222215, -214.60277777777765, -191.82111111111092, -203.37388888888876, -200.47944444444437, -210.79555555555555, -206.42166666666665, -221.71222222222212, -186.43888888888875, -222.55222222222207, -209.29, -224.27333333333326, -197.23222222222202, -204.96388888888885, -180.45388888888877, -170.0683333333333, -186.77999999999992, -198.7572222222222, -207.36166666666676, -216.1405555555554, -177.35777777777776, -208.27333333333323, -207.13055555555536, -200.0183333333331, -221.64611111111086, -215.56499999999983, -218.93888888888893, -220.34722222222223, -223.13666666666654, -214.971111111111, -178.79777777777764, -182.70111111111103, -199.14666666666653, -194.6383333333333, -225.69722222222225, -217.11444444444427, -208.92055555555544, -203.44222222222217, -228.62222222222204, -213.97888888888883, -193.09277777777766, -199.83888888888885, -200.2783333333333, -215.86888888888885, -209.32166666666652, -193.57111111111107, -215.61333333333312, -206.85500000000002, -231.0299999999999, -190.40222222222212, -210.32388888888877, -202.9372222222221, -189.62277777777766, -211.2816666666666, -209.83388888888882, -241.73888888888885, -191.2599999999999, -211.18944444444435, -214.86222222222207, -207.4049999999999, -191.63555555555553, -209.3999999999999, -238.2122222222221, -219.78222222222223, -227.2138888888887, -219.3205555555554, -208.886111111111, -215.55666666666662, -194.17833333333328], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-215.60388888888878, -231.83166666666662, -193.2905555555555, -213.68722222222218, -195.10333333333335, -220.5494444444444, -212.70388888888883, -190.915, -206.11388888888888, -188.6944444444443, -174.92166666666665, -202.81999999999985, -210.09444444444435, -181.27944444444432, -211.29055555555553, -215.9105555555555, -222.32055555555544, -195.4883333333333, -214.4027777777777, -207.40166666666667, -187.95500000000004, -208.69555555555556, -214.0616666666666, -216.31888888888878, -175.2744444444443, -200.3627777777777, -191.67499999999978, -180.93111111111097, -215.19499999999994, -221.6222222222222, -209.70111111111098, -191.81222222222215, -214.60277777777765, -191.82111111111092, -203.37388888888876, -200.47944444444437, -210.79555555555555, -206.42166666666665, -221.71222222222212, -186.43888888888875, -222.55222222222207, -209.29, -224.27333333333326, -197.23222222222202, -204.96388888888885, -180.45388888888877, -170.0683333333333, -186.77999999999992, -198.7572222222222, -207.36166666666676, -216.1405555555554, -177.35777777777776, -208.27333333333323, -207.13055555555536, -200.0183333333331, -221.64611111111086, -215.56499999999983, -218.93888888888893, -220.34722222222223, -223.13666666666654, -214.971111111111, -178.79777777777764, -182.70111111111103, -199.14666666666653, -194.6383333333333, -225.69722222222225, -217.11444444444427, -208.92055555555544, -203.44222222222217, -228.62222222222204, -213.97888888888883, -193.09277777777766, -199.83888888888885, -200.2783333333333, -215.86888888888885, -209.32166666666652, -193.57111111111107, -215.61333333333312, -206.85500000000002, -231.0299999999999, -190.40222222222212, -210.32388888888877, -202.9372222222221, -189.62277777777766, -211.2816666666666, -209.83388888888882, -241.73888888888885, -191.2599999999999, -211.18944444444435, -214.86222222222207, -207.4049999999999, -191.63555555555553, -209.3999999999999, -238.2122222222221, -219.78222222222223, -227.2138888888887, -219.3205555555554, -208.886111111111, -215.55666666666662, -194.17833333333328]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907695027485473, "mean_inference_ms": 1.7581457446529936, "mean_action_processing_ms": 0.07278528850830417, "mean_env_wait_ms": 1.1877182464932405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004836082458496094, "StateBufferConnector_ms": 0.002788543701171875, "ViewRequirementAgentConnector_ms": 0.0629730224609375}, "num_episodes": 30, "episode_return_max": -170.0683333333333, "episode_return_min": -241.73888888888885, "episode_return_mean": -206.02504444444435, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 125550, "num_agent_steps_trained": 125400, "num_env_steps_sampled": 125550, "num_env_steps_trained": 125400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 297.09146297236526, "num_env_steps_trained_throughput_per_sec": 297.09146297236526, "timesteps_total": 125550, "num_env_steps_sampled_lifetime": 125550, "num_agent_steps_sampled_lifetime": 125550, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 125550, "timers": {"training_iteration_time_ms": 10233.122, "restore_workers_time_ms": 0.011, "training_step_time_ms": 499.854, "sample_time_ms": 485.797, "synch_weights_time_ms": 12.807}, "counters": {"num_env_steps_sampled": 125550, "num_env_steps_trained": 125400, "num_agent_steps_sampled": 125550, "num_agent_steps_trained": 125400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 837, "num_samples_added_to_queue": 125400}, "done": false, "training_iteration": 41, "trial_id": "0313d_00000", "date": "2024-10-10_21-48-26", "timestamp": 1728593306, "time_this_iter_s": 10.1065514087677, "time_total_s": 421.4320607185364, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c163e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 421.4320607185364, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 10.828571428571427, "ram_util_percent": 55.05714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -181573.46875, "policy_loss": -181572.5625, "entropy": 29.721647262573242, "entropy_coeff": 0.01, "var_gnorm": 16.077457427978516, "vf_loss": 88258.171875, "vf_explained_var": 0.08910894393920898}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 428.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 128550, "num_env_steps_trained": 128400, "num_agent_steps_sampled": 128550, "num_agent_steps_trained": 128400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 857, "num_samples_added_to_queue": 128400, "learner_queue": {"size_count": 428, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 49.762, "learner_load_time_ms": 0.303, "learner_load_wait_time_ms": 986.418, "learner_dequeue_time_ms": 8100.671}}, "env_runners": {"episode_reward_max": -170.0683333333333, "episode_reward_min": -241.73888888888885, "episode_reward_mean": -208.4645999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -241.73888888888885}, "policy_reward_max": {"default_policy": -170.0683333333333}, "policy_reward_mean": {"default_policy": -208.4645999999999}, "custom_metrics": {"num_consolidated_mean": 0.679, "num_consolidated_min": 0.47, "num_consolidated_max": 0.82, "num_overloaded_mean": 0.982, "num_overloaded_min": 0.83, "num_overloaded_max": 1.15, "num_moves_mean": 9.984500000000002, "num_moves_min": 9.63, "num_moves_max": 10.39, "mean_accuracy_mean": 40.930076666666665, "mean_accuracy_min": 40.70099999999999, "mean_accuracy_max": 41.214000000000006, "num_model_switches_mean": 5.972500000000001, "num_model_switches_min": 5.6, "num_model_switches_max": 6.37, "num_slav_mean": 0.14536916666666666, "num_slav_min": 0.12118333333333332, "num_slav_max": 0.16665, "mean_cluster_cpu_util_mean": 0.560759029953651, "mean_cluster_cpu_util_min": 0.5404702593299258, "mean_cluster_cpu_util_max": 0.5850382046058167, "mean_cluster_mem_util_mean": 0.3616579794734349, "mean_cluster_mem_util_min": 0.35259139757168684, "mean_cluster_mem_util_max": 0.3712702581876631, "reward_consolidation_mean_mean": 0.20305555555555554, "reward_consolidation_mean_min": 0.09722222222222221, "reward_consolidation_mean_max": 0.375, "reward_illegal_mean_mean": -1.6366666666666663, "reward_illegal_mean_min": -1.916666666666667, "reward_illegal_mean_max": -1.3833333333333329, "reward_accuracy_mean_mean": 0.47392066666666666, "reward_accuracy_mean_min": 0.2816833333333333, "reward_accuracy_mean_max": 0.6496833333333332, "reward_sla_mean_mean": -1.1249555555555555, "reward_sla_mean_min": -1.6611111111111114, "reward_sla_mean_max": -0.57, "reward_consolidation_sum_mean": 20.305555555555554, "reward_consolidation_sum_min": 9.722222222222221, "reward_consolidation_sum_max": 37.5, "reward_illegal_sum_mean": -163.66666666666663, "reward_illegal_sum_min": -191.66666666666669, "reward_illegal_sum_max": -138.3333333333333, "reward_accuracy_sum_mean": 47.39206666666666, "reward_accuracy_sum_min": 28.16833333333333, "reward_accuracy_sum_max": 64.96833333333332, "reward_sla_sum_mean": -112.49555555555554, "reward_sla_sum_min": -166.11111111111114, "reward_sla_sum_max": -57.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2306.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-209.70111111111098, -191.81222222222215, -214.60277777777765, -191.82111111111092, -203.37388888888876, -200.47944444444437, -210.79555555555555, -206.42166666666665, -221.71222222222212, -186.43888888888875, -222.55222222222207, -209.29, -224.27333333333326, -197.23222222222202, -204.96388888888885, -180.45388888888877, -170.0683333333333, -186.77999999999992, -198.7572222222222, -207.36166666666676, -216.1405555555554, -177.35777777777776, -208.27333333333323, -207.13055555555536, -200.0183333333331, -221.64611111111086, -215.56499999999983, -218.93888888888893, -220.34722222222223, -223.13666666666654, -214.971111111111, -178.79777777777764, -182.70111111111103, -199.14666666666653, -194.6383333333333, -225.69722222222225, -217.11444444444427, -208.92055555555544, -203.44222222222217, -228.62222222222204, -213.97888888888883, -193.09277777777766, -199.83888888888885, -200.2783333333333, -215.86888888888885, -209.32166666666652, -193.57111111111107, -215.61333333333312, -206.85500000000002, -231.0299999999999, -190.40222222222212, -210.32388888888877, -202.9372222222221, -189.62277777777766, -211.2816666666666, -209.83388888888882, -241.73888888888885, -191.2599999999999, -211.18944444444435, -214.86222222222207, -207.4049999999999, -191.63555555555553, -209.3999999999999, -238.2122222222221, -219.78222222222223, -227.2138888888887, -219.3205555555554, -208.886111111111, -215.55666666666662, -194.17833333333328, -208.18055555555537, -211.0416666666666, -186.47444444444434, -238.54222222222205, -218.91722222222205, -209.72333333333322, -194.34666666666658, -205.9766666666667, -202.3711111111111, -211.66111111111096, -225.90944444444435, -216.4427777777777, -196.0027777777777, -220.17111111111095, -215.46611111111105, -187.18333333333328, -210.20999999999995, -198.28277777777777, -198.78555555555548, -223.39444444444445, -207.32055555555544, -230.13777777777773, -237.1833333333334, -234.23388888888883, -219.37833333333322, -218.4744444444443, -217.09222222222212, -209.46944444444438, -194.59388888888878, -213.5033333333333], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-209.70111111111098, -191.81222222222215, -214.60277777777765, -191.82111111111092, -203.37388888888876, -200.47944444444437, -210.79555555555555, -206.42166666666665, -221.71222222222212, -186.43888888888875, -222.55222222222207, -209.29, -224.27333333333326, -197.23222222222202, -204.96388888888885, -180.45388888888877, -170.0683333333333, -186.77999999999992, -198.7572222222222, -207.36166666666676, -216.1405555555554, -177.35777777777776, -208.27333333333323, -207.13055555555536, -200.0183333333331, -221.64611111111086, -215.56499999999983, -218.93888888888893, -220.34722222222223, -223.13666666666654, -214.971111111111, -178.79777777777764, -182.70111111111103, -199.14666666666653, -194.6383333333333, -225.69722222222225, -217.11444444444427, -208.92055555555544, -203.44222222222217, -228.62222222222204, -213.97888888888883, -193.09277777777766, -199.83888888888885, -200.2783333333333, -215.86888888888885, -209.32166666666652, -193.57111111111107, -215.61333333333312, -206.85500000000002, -231.0299999999999, -190.40222222222212, -210.32388888888877, -202.9372222222221, -189.62277777777766, -211.2816666666666, -209.83388888888882, -241.73888888888885, -191.2599999999999, -211.18944444444435, -214.86222222222207, -207.4049999999999, -191.63555555555553, -209.3999999999999, -238.2122222222221, -219.78222222222223, -227.2138888888887, -219.3205555555554, -208.886111111111, -215.55666666666662, -194.17833333333328, -208.18055555555537, -211.0416666666666, -186.47444444444434, -238.54222222222205, -218.91722222222205, -209.72333333333322, -194.34666666666658, -205.9766666666667, -202.3711111111111, -211.66111111111096, -225.90944444444435, -216.4427777777777, -196.0027777777777, -220.17111111111095, -215.46611111111105, -187.18333333333328, -210.20999999999995, -198.28277777777777, -198.78555555555548, -223.39444444444445, -207.32055555555544, -230.13777777777773, -237.1833333333334, -234.23388888888883, -219.37833333333322, -218.4744444444443, -217.09222222222212, -209.46944444444438, -194.59388888888878, -213.5033333333333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19079854256311995, "mean_inference_ms": 1.7590482394017999, "mean_action_processing_ms": 0.07279576582222175, "mean_env_wait_ms": 1.1882021267460072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048084259033203125, "StateBufferConnector_ms": 0.0027849674224853516, "ViewRequirementAgentConnector_ms": 0.0628061294555664}, "num_episodes": 30, "episode_return_max": -170.0683333333333, "episode_return_min": -241.73888888888885, "episode_return_mean": -208.4645999999999, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128550, "num_agent_steps_trained": 128400, "num_env_steps_sampled": 128550, "num_env_steps_trained": 128400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 287.889522132311, "num_env_steps_trained_throughput_per_sec": 287.889522132311, "timesteps_total": 128550, "num_env_steps_sampled_lifetime": 128550, "num_agent_steps_sampled_lifetime": 128550, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 128550, "timers": {"training_iteration_time_ms": 10237.573, "restore_workers_time_ms": 0.011, "training_step_time_ms": 520.198, "sample_time_ms": 506.597, "synch_weights_time_ms": 12.191}, "counters": {"num_env_steps_sampled": 128550, "num_env_steps_trained": 128400, "num_agent_steps_sampled": 128550, "num_agent_steps_trained": 128400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 857, "num_samples_added_to_queue": 128400}, "done": false, "training_iteration": 42, "trial_id": "0313d_00000", "date": "2024-10-10_21-48-37", "timestamp": 1728593317, "time_this_iter_s": 10.433112859725952, "time_total_s": 431.86517357826233, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42fa0070>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 431.86517357826233, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 11.226666666666668, "ram_util_percent": 54.906666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -174051.359375, "policy_loss": -174046.40625, "entropy": 29.7170467376709, "entropy_coeff": 0.01, "var_gnorm": 16.08024024963379, "vf_loss": 84209.78125, "vf_explained_var": 0.08697676658630371}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 438.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 131700, "num_env_steps_trained": 131400, "num_agent_steps_sampled": 131700, "num_agent_steps_trained": 131400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 878, "num_samples_added_to_queue": 131700, "learner_queue": {"size_count": 438, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.861, "learner_load_time_ms": 0.304, "learner_load_wait_time_ms": 928.709, "learner_dequeue_time_ms": 8080.006}}, "env_runners": {"episode_reward_max": -166.72277777777782, "episode_reward_min": -248.94777777777773, "episode_reward_mean": -207.38206111111106, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -248.94777777777773}, "policy_reward_max": {"default_policy": -166.72277777777782}, "policy_reward_mean": {"default_policy": -207.38206111111106}, "custom_metrics": {"num_consolidated_mean": 0.6742999999999999, "num_consolidated_min": 0.47, "num_consolidated_max": 0.81, "num_overloaded_mean": 0.977, "num_overloaded_min": 0.83, "num_overloaded_max": 1.15, "num_moves_mean": 9.984399999999999, "num_moves_min": 9.63, "num_moves_max": 10.39, "mean_accuracy_mean": 40.929316666666665, "mean_accuracy_min": 40.701, "mean_accuracy_max": 41.16333333333333, "num_model_switches_mean": 5.952199999999998, "num_model_switches_min": 5.57, "num_model_switches_max": 6.38, "num_slav_mean": 0.14360933333333334, "num_slav_min": 0.12513333333333335, "num_slav_max": 0.16665, "mean_cluster_cpu_util_mean": 0.5603791639086877, "mean_cluster_cpu_util_min": 0.5404702593299258, "mean_cluster_cpu_util_max": 0.5850382046058167, "mean_cluster_mem_util_mean": 0.3612048424592411, "mean_cluster_mem_util_min": 0.35259139757168684, "mean_cluster_mem_util_max": 0.3712702581876631, "reward_consolidation_mean_mean": 0.2001388888888889, "reward_consolidation_mean_min": 0.06944444444444445, "reward_consolidation_mean_max": 0.375, "reward_illegal_mean_mean": -1.6283333333333332, "reward_illegal_mean_min": -1.916666666666667, "reward_illegal_mean_max": -1.3833333333333329, "reward_accuracy_mean_mean": 0.4811571666666665, "reward_accuracy_mean_min": 0.2816833333333333, "reward_accuracy_mean_max": 0.6718166666666667, "reward_sla_mean_mean": -1.1267833333333335, "reward_sla_mean_min": -1.6611111111111114, "reward_sla_mean_max": -0.5133333333333333, "reward_consolidation_sum_mean": 20.01388888888889, "reward_consolidation_sum_min": 6.944444444444445, "reward_consolidation_sum_max": 37.5, "reward_illegal_sum_mean": -162.83333333333331, "reward_illegal_sum_min": -191.66666666666669, "reward_illegal_sum_max": -138.3333333333333, "reward_accuracy_sum_mean": 48.115716666666664, "reward_accuracy_sum_min": 28.16833333333333, "reward_accuracy_sum_max": 67.18166666666667, "reward_sla_sum_mean": -112.67833333333334, "reward_sla_sum_min": -166.11111111111114, "reward_sla_sum_max": -51.33333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3267.0, "global_timestep_min": 1200, "global_timestep_max": 4900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-199.14666666666653, -194.6383333333333, -225.69722222222225, -217.11444444444427, -208.92055555555544, -203.44222222222217, -228.62222222222204, -213.97888888888883, -193.09277777777766, -199.83888888888885, -200.2783333333333, -215.86888888888885, -209.32166666666652, -193.57111111111107, -215.61333333333312, -206.85500000000002, -231.0299999999999, -190.40222222222212, -210.32388888888877, -202.9372222222221, -189.62277777777766, -211.2816666666666, -209.83388888888882, -241.73888888888885, -191.2599999999999, -211.18944444444435, -214.86222222222207, -207.4049999999999, -191.63555555555553, -209.3999999999999, -238.2122222222221, -219.78222222222223, -227.2138888888887, -219.3205555555554, -208.886111111111, -215.55666666666662, -194.17833333333328, -208.18055555555537, -211.0416666666666, -186.47444444444434, -238.54222222222205, -218.91722222222205, -209.72333333333322, -194.34666666666658, -205.9766666666667, -202.3711111111111, -211.66111111111096, -225.90944444444435, -216.4427777777777, -196.0027777777777, -220.17111111111095, -215.46611111111105, -187.18333333333328, -210.20999999999995, -198.28277777777777, -198.78555555555548, -223.39444444444445, -207.32055555555544, -230.13777777777773, -237.1833333333334, -234.23388888888883, -219.37833333333322, -218.4744444444443, -217.09222222222212, -209.46944444444438, -194.59388888888878, -213.5033333333333, -190.61611111111105, -187.2499999999998, -200.5788888888888, -177.82777777777775, -188.44888888888877, -192.12111111111105, -187.2038888888888, -197.36111111111106, -202.76722222222216, -217.85888888888886, -223.56888888888884, -206.97722222222214, -212.82222222222205, -185.37388888888887, -248.94777777777773, -213.94055555555553, -205.5122222222222, -187.59777777777782, -194.30722222222224, -212.19777777777776, -182.43499999999995, -218.41055555555548, -200.07555555555552, -215.07555555555555, -189.06111111111102, -187.85555555555553, -210.46888888888884, -193.90611111111107, -195.34999999999985, -207.47222222222211, -201.6622222222222, -213.88722222222214, -166.72277777777782], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-199.14666666666653, -194.6383333333333, -225.69722222222225, -217.11444444444427, -208.92055555555544, -203.44222222222217, -228.62222222222204, -213.97888888888883, -193.09277777777766, -199.83888888888885, -200.2783333333333, -215.86888888888885, -209.32166666666652, -193.57111111111107, -215.61333333333312, -206.85500000000002, -231.0299999999999, -190.40222222222212, -210.32388888888877, -202.9372222222221, -189.62277777777766, -211.2816666666666, -209.83388888888882, -241.73888888888885, -191.2599999999999, -211.18944444444435, -214.86222222222207, -207.4049999999999, -191.63555555555553, -209.3999999999999, -238.2122222222221, -219.78222222222223, -227.2138888888887, -219.3205555555554, -208.886111111111, -215.55666666666662, -194.17833333333328, -208.18055555555537, -211.0416666666666, -186.47444444444434, -238.54222222222205, -218.91722222222205, -209.72333333333322, -194.34666666666658, -205.9766666666667, -202.3711111111111, -211.66111111111096, -225.90944444444435, -216.4427777777777, -196.0027777777777, -220.17111111111095, -215.46611111111105, -187.18333333333328, -210.20999999999995, -198.28277777777777, -198.78555555555548, -223.39444444444445, -207.32055555555544, -230.13777777777773, -237.1833333333334, -234.23388888888883, -219.37833333333322, -218.4744444444443, -217.09222222222212, -209.46944444444438, -194.59388888888878, -213.5033333333333, -190.61611111111105, -187.2499999999998, -200.5788888888888, -177.82777777777775, -188.44888888888877, -192.12111111111105, -187.2038888888888, -197.36111111111106, -202.76722222222216, -217.85888888888886, -223.56888888888884, -206.97722222222214, -212.82222222222205, -185.37388888888887, -248.94777777777773, -213.94055555555553, -205.5122222222222, -187.59777777777782, -194.30722222222224, -212.19777777777776, -182.43499999999995, -218.41055555555548, -200.07555555555552, -215.07555555555555, -189.06111111111102, -187.85555555555553, -210.46888888888884, -193.90611111111107, -195.34999999999985, -207.47222222222211, -201.6622222222222, -213.88722222222214, -166.72277777777782]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19082134265322595, "mean_inference_ms": 1.7609543516706863, "mean_action_processing_ms": 0.07281281511533408, "mean_env_wait_ms": 1.188821741776463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041010379791259766, "StateBufferConnector_ms": 0.002788066864013672, "ViewRequirementAgentConnector_ms": 0.06204557418823242}, "num_episodes": 33, "episode_return_max": -166.72277777777782, "episode_return_min": -248.94777777777773, "episode_return_mean": -207.38206111111106, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131700, "num_agent_steps_trained": 131400, "num_env_steps_sampled": 131700, "num_env_steps_trained": 131400, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 303.47702252300996, "num_env_steps_trained_throughput_per_sec": 289.0257357362, "timesteps_total": 131700, "num_env_steps_sampled_lifetime": 131700, "num_agent_steps_sampled_lifetime": 131700, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 131700, "timers": {"training_iteration_time_ms": 10251.691, "restore_workers_time_ms": 0.011, "training_step_time_ms": 493.242, "sample_time_ms": 478.903, "synch_weights_time_ms": 13.037}, "counters": {"num_env_steps_sampled": 131700, "num_env_steps_trained": 131400, "num_agent_steps_sampled": 131700, "num_agent_steps_trained": 131400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 878, "num_samples_added_to_queue": 131700}, "done": false, "training_iteration": 43, "trial_id": "0313d_00000", "date": "2024-10-10_21-48-47", "timestamp": 1728593327, "time_this_iter_s": 10.391478061676025, "time_total_s": 442.25665163993835, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42dc8880>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 442.25665163993835, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 10.386666666666665, "ram_util_percent": 54.62666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -175519.140625, "policy_loss": -175509.890625, "entropy": 29.715810775756836, "entropy_coeff": 0.01, "var_gnorm": 16.082685470581055, "vf_loss": 79891.1640625, "vf_explained_var": 0.1086803674697876}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 448.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 134700, "num_env_steps_trained": 134400, "num_agent_steps_sampled": 134700, "num_agent_steps_trained": 134400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 898, "num_samples_added_to_queue": 134700, "learner_queue": {"size_count": 448, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.652, "learner_load_time_ms": 0.278, "learner_load_wait_time_ms": 963.562, "learner_dequeue_time_ms": 8122.23}}, "env_runners": {"episode_reward_max": -166.72277777777782, "episode_reward_min": -248.94777777777773, "episode_reward_mean": -206.38607222222214, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -248.94777777777773}, "policy_reward_max": {"default_policy": -166.72277777777782}, "policy_reward_mean": {"default_policy": -206.38607222222214}, "custom_metrics": {"num_consolidated_mean": 0.6724, "num_consolidated_min": 0.46, "num_consolidated_max": 0.85, "num_overloaded_mean": 0.9795999999999999, "num_overloaded_min": 0.85, "num_overloaded_max": 1.15, "num_moves_mean": 9.9765, "num_moves_min": 9.63, "num_moves_max": 10.39, "mean_accuracy_mean": 40.91310333333333, "mean_accuracy_min": 40.701, "mean_accuracy_max": 41.10633333333334, "num_model_switches_mean": 5.941800000000001, "num_model_switches_min": 5.57, "num_model_switches_max": 6.38, "num_slav_mean": 0.14273466666666668, "num_slav_min": 0.12513333333333335, "num_slav_max": 0.16665, "mean_cluster_cpu_util_mean": 0.5610471814747726, "mean_cluster_cpu_util_min": 0.5404702593299258, "mean_cluster_cpu_util_max": 0.5850382046058167, "mean_cluster_mem_util_mean": 0.36150223903707046, "mean_cluster_mem_util_min": 0.35259139757168684, "mean_cluster_mem_util_max": 0.3712702581876631, "reward_consolidation_mean_mean": 0.19388888888888886, "reward_consolidation_mean_min": 0.06944444444444443, "reward_consolidation_mean_max": 0.3194444444444444, "reward_illegal_mean_mean": -1.632666666666666, "reward_illegal_mean_min": -1.916666666666667, "reward_illegal_mean_max": -1.4166666666666665, "reward_accuracy_mean_mean": 0.4741448333333333, "reward_accuracy_mean_min": 0.2816833333333333, "reward_accuracy_mean_max": 0.6718166666666667, "reward_sla_mean_mean": -1.0992277777777777, "reward_sla_mean_min": -1.6522222222222218, "reward_sla_mean_max": -0.5133333333333333, "reward_consolidation_sum_mean": 19.38888888888889, "reward_consolidation_sum_min": 6.944444444444444, "reward_consolidation_sum_max": 31.944444444444443, "reward_illegal_sum_mean": -163.26666666666662, "reward_illegal_sum_min": -191.66666666666669, "reward_illegal_sum_max": -141.66666666666666, "reward_accuracy_sum_mean": 47.41448333333334, "reward_accuracy_sum_min": 28.16833333333333, "reward_accuracy_sum_max": 67.18166666666667, "reward_sla_sum_mean": -109.92277777777777, "reward_sla_sum_min": -165.22222222222217, "reward_sla_sum_max": -51.33333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4267.0, "global_timestep_min": 2200, "global_timestep_max": 5900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-238.2122222222221, -219.78222222222223, -227.2138888888887, -219.3205555555554, -208.886111111111, -215.55666666666662, -194.17833333333328, -208.18055555555537, -211.0416666666666, -186.47444444444434, -238.54222222222205, -218.91722222222205, -209.72333333333322, -194.34666666666658, -205.9766666666667, -202.3711111111111, -211.66111111111096, -225.90944444444435, -216.4427777777777, -196.0027777777777, -220.17111111111095, -215.46611111111105, -187.18333333333328, -210.20999999999995, -198.28277777777777, -198.78555555555548, -223.39444444444445, -207.32055555555544, -230.13777777777773, -237.1833333333334, -234.23388888888883, -219.37833333333322, -218.4744444444443, -217.09222222222212, -209.46944444444438, -194.59388888888878, -213.5033333333333, -190.61611111111105, -187.2499999999998, -200.5788888888888, -177.82777777777775, -188.44888888888877, -192.12111111111105, -187.2038888888888, -197.36111111111106, -202.76722222222216, -217.85888888888886, -223.56888888888884, -206.97722222222214, -212.82222222222205, -185.37388888888887, -248.94777777777773, -213.94055555555553, -205.5122222222222, -187.59777777777782, -194.30722222222224, -212.19777777777776, -182.43499999999995, -218.41055555555548, -200.07555555555552, -215.07555555555555, -189.06111111111102, -187.85555555555553, -210.46888888888884, -193.90611111111107, -195.34999999999985, -207.47222222222211, -201.6622222222222, -213.88722222222214, -166.72277777777782, -194.7261111111111, -226.46555555555545, -206.6655555555555, -179.68000000000004, -199.0338888888888, -204.81388888888884, -213.88944444444428, -211.53722222222203, -201.21666666666658, -225.8188888888888, -191.97999999999988, -206.18777777777774, -192.87388888888876, -201.31166666666653, -210.8538888888889, -207.2177777777778, -200.39999999999986, -206.90944444444443, -185.77333333333328, -211.9938888888888, -212.90055555555546, -203.27333333333314, -187.9422222222221, -213.26555555555552, -212.90222222222218, -217.32833333333318, -187.89222222222213, -199.1694444444444, -213.50055555555562, -211.80111111111103], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-238.2122222222221, -219.78222222222223, -227.2138888888887, -219.3205555555554, -208.886111111111, -215.55666666666662, -194.17833333333328, -208.18055555555537, -211.0416666666666, -186.47444444444434, -238.54222222222205, -218.91722222222205, -209.72333333333322, -194.34666666666658, -205.9766666666667, -202.3711111111111, -211.66111111111096, -225.90944444444435, -216.4427777777777, -196.0027777777777, -220.17111111111095, -215.46611111111105, -187.18333333333328, -210.20999999999995, -198.28277777777777, -198.78555555555548, -223.39444444444445, -207.32055555555544, -230.13777777777773, -237.1833333333334, -234.23388888888883, -219.37833333333322, -218.4744444444443, -217.09222222222212, -209.46944444444438, -194.59388888888878, -213.5033333333333, -190.61611111111105, -187.2499999999998, -200.5788888888888, -177.82777777777775, -188.44888888888877, -192.12111111111105, -187.2038888888888, -197.36111111111106, -202.76722222222216, -217.85888888888886, -223.56888888888884, -206.97722222222214, -212.82222222222205, -185.37388888888887, -248.94777777777773, -213.94055555555553, -205.5122222222222, -187.59777777777782, -194.30722222222224, -212.19777777777776, -182.43499999999995, -218.41055555555548, -200.07555555555552, -215.07555555555555, -189.06111111111102, -187.85555555555553, -210.46888888888884, -193.90611111111107, -195.34999999999985, -207.47222222222211, -201.6622222222222, -213.88722222222214, -166.72277777777782, -194.7261111111111, -226.46555555555545, -206.6655555555555, -179.68000000000004, -199.0338888888888, -204.81388888888884, -213.88944444444428, -211.53722222222203, -201.21666666666658, -225.8188888888888, -191.97999999999988, -206.18777777777774, -192.87388888888876, -201.31166666666653, -210.8538888888889, -207.2177777777778, -200.39999999999986, -206.90944444444443, -185.77333333333328, -211.9938888888888, -212.90055555555546, -203.27333333333314, -187.9422222222221, -213.26555555555552, -212.90222222222218, -217.32833333333318, -187.89222222222213, -199.1694444444444, -213.50055555555562, -211.80111111111103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19078036857169647, "mean_inference_ms": 1.7612199343312012, "mean_action_processing_ms": 0.07281462531939742, "mean_env_wait_ms": 1.1891164514247998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003961324691772461, "StateBufferConnector_ms": 0.0028083324432373047, "ViewRequirementAgentConnector_ms": 0.06274008750915527}, "num_episodes": 30, "episode_return_max": -166.72277777777782, "episode_return_min": -248.94777777777773, "episode_return_mean": -206.38607222222214, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134700, "num_agent_steps_trained": 134400, "num_env_steps_sampled": 134700, "num_env_steps_trained": 134400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 295.7902451441976, "num_env_steps_trained_throughput_per_sec": 295.7902451441976, "timesteps_total": 134700, "num_env_steps_sampled_lifetime": 134700, "num_agent_steps_sampled_lifetime": 134700, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 134700, "timers": {"training_iteration_time_ms": 10223.374, "restore_workers_time_ms": 0.011, "training_step_time_ms": 502.59, "sample_time_ms": 488.339, "synch_weights_time_ms": 12.829}, "counters": {"num_env_steps_sampled": 134700, "num_env_steps_trained": 134400, "num_agent_steps_sampled": 134700, "num_agent_steps_trained": 134400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 898, "num_samples_added_to_queue": 134700}, "done": false, "training_iteration": 44, "trial_id": "0313d_00000", "date": "2024-10-10_21-48-57", "timestamp": 1728593337, "time_this_iter_s": 10.152658224105835, "time_total_s": 452.4093098640442, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42dc9ae0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 452.4093098640442, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 10.679999999999998, "ram_util_percent": 54.786666666666655}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -182982.375, "policy_loss": -182982.671875, "entropy": 29.702701568603516, "entropy_coeff": 0.01, "var_gnorm": 16.08785057067871, "vf_loss": 89413.421875, "vf_explained_var": 0.09984254837036133}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 458.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 137700, "num_env_steps_trained": 137400, "num_agent_steps_sampled": 137700, "num_agent_steps_trained": 137400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 918, "num_samples_added_to_queue": 137700, "learner_queue": {"size_count": 458, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.139, "learner_load_time_ms": 0.283, "learner_load_wait_time_ms": 952.749, "learner_dequeue_time_ms": 8151.106}}, "env_runners": {"episode_reward_max": -166.72277777777782, "episode_reward_min": -248.94777777777773, "episode_reward_mean": -205.02673333333325, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -248.94777777777773}, "policy_reward_max": {"default_policy": -166.72277777777782}, "policy_reward_mean": {"default_policy": -205.02673333333325}, "custom_metrics": {"num_consolidated_mean": 0.6783000000000001, "num_consolidated_min": 0.46, "num_consolidated_max": 0.85, "num_overloaded_mean": 0.9781, "num_overloaded_min": 0.84, "num_overloaded_max": 1.18, "num_moves_mean": 9.982500000000002, "num_moves_min": 9.66, "num_moves_max": 10.29, "mean_accuracy_mean": 40.918549999999996, "mean_accuracy_min": 40.69466666666666, "mean_accuracy_max": 41.22033333333333, "num_model_switches_mean": 5.956000000000001, "num_model_switches_min": 5.57, "num_model_switches_max": 6.38, "num_slav_mean": 0.1425625, "num_slav_min": 0.12513333333333335, "num_slav_max": 0.16916666666666663, "mean_cluster_cpu_util_mean": 0.5623140976383919, "mean_cluster_cpu_util_min": 0.5441832672417447, "mean_cluster_cpu_util_max": 0.5842913469793813, "mean_cluster_mem_util_mean": 0.3620411809914894, "mean_cluster_mem_util_min": 0.35259139757168684, "mean_cluster_mem_util_max": 0.3716003998751398, "reward_consolidation_mean_mean": 0.19319444444444447, "reward_consolidation_mean_min": 0.06944444444444443, "reward_consolidation_mean_max": 0.3055555555555555, "reward_illegal_mean_mean": -1.6301666666666665, "reward_illegal_mean_min": -1.9666666666666666, "reward_illegal_mean_max": -1.3999999999999997, "reward_accuracy_mean_mean": 0.46971599999999986, "reward_accuracy_mean_min": 0.20391666666666666, "reward_accuracy_mean_max": 0.6718166666666667, "reward_sla_mean_mean": -1.083011111111111, "reward_sla_mean_min": -1.6522222222222218, "reward_sla_mean_max": -0.44166666666666665, "reward_consolidation_sum_mean": 19.319444444444446, "reward_consolidation_sum_min": 6.944444444444444, "reward_consolidation_sum_max": 30.555555555555554, "reward_illegal_sum_mean": -163.01666666666662, "reward_illegal_sum_min": -196.66666666666666, "reward_illegal_sum_max": -139.99999999999997, "reward_accuracy_sum_mean": 46.971599999999995, "reward_accuracy_sum_min": 20.391666666666666, "reward_accuracy_sum_max": 67.18166666666667, "reward_sla_sum_mean": -108.3011111111111, "reward_sla_sum_min": -165.22222222222217, "reward_sla_sum_max": -44.166666666666664, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5267.0, "global_timestep_min": 3200, "global_timestep_max": 6900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-234.23388888888883, -219.37833333333322, -218.4744444444443, -217.09222222222212, -209.46944444444438, -194.59388888888878, -213.5033333333333, -190.61611111111105, -187.2499999999998, -200.5788888888888, -177.82777777777775, -188.44888888888877, -192.12111111111105, -187.2038888888888, -197.36111111111106, -202.76722222222216, -217.85888888888886, -223.56888888888884, -206.97722222222214, -212.82222222222205, -185.37388888888887, -248.94777777777773, -213.94055555555553, -205.5122222222222, -187.59777777777782, -194.30722222222224, -212.19777777777776, -182.43499999999995, -218.41055555555548, -200.07555555555552, -215.07555555555555, -189.06111111111102, -187.85555555555553, -210.46888888888884, -193.90611111111107, -195.34999999999985, -207.47222222222211, -201.6622222222222, -213.88722222222214, -166.72277777777782, -194.7261111111111, -226.46555555555545, -206.6655555555555, -179.68000000000004, -199.0338888888888, -204.81388888888884, -213.88944444444428, -211.53722222222203, -201.21666666666658, -225.8188888888888, -191.97999999999988, -206.18777777777774, -192.87388888888876, -201.31166666666653, -210.8538888888889, -207.2177777777778, -200.39999999999986, -206.90944444444443, -185.77333333333328, -211.9938888888888, -212.90055555555546, -203.27333333333314, -187.9422222222221, -213.26555555555552, -212.90222222222218, -217.32833333333318, -187.89222222222213, -199.1694444444444, -213.50055555555562, -211.80111111111103, -201.52722222222212, -221.7416666666666, -205.23055555555544, -196.30444444444436, -197.81888888888878, -215.59999999999994, -204.86888888888885, -206.0922222222222, -193.2872222222222, -205.3949999999998, -224.4705555555555, -226.25999999999985, -217.67055555555558, -208.54277777777764, -206.0038888888888, -199.60000000000002, -225.2816666666667, -197.8205555555555, -228.61833333333325, -205.16388888888878, -196.86388888888888, -174.0894444444444, -219.05999999999983, -213.27277777777772, -218.30777777777766, -217.1149999999999, -191.30055555555552, -193.7455555555554, -226.12111111111108, -203.76666666666662], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-234.23388888888883, -219.37833333333322, -218.4744444444443, -217.09222222222212, -209.46944444444438, -194.59388888888878, -213.5033333333333, -190.61611111111105, -187.2499999999998, -200.5788888888888, -177.82777777777775, -188.44888888888877, -192.12111111111105, -187.2038888888888, -197.36111111111106, -202.76722222222216, -217.85888888888886, -223.56888888888884, -206.97722222222214, -212.82222222222205, -185.37388888888887, -248.94777777777773, -213.94055555555553, -205.5122222222222, -187.59777777777782, -194.30722222222224, -212.19777777777776, -182.43499999999995, -218.41055555555548, -200.07555555555552, -215.07555555555555, -189.06111111111102, -187.85555555555553, -210.46888888888884, -193.90611111111107, -195.34999999999985, -207.47222222222211, -201.6622222222222, -213.88722222222214, -166.72277777777782, -194.7261111111111, -226.46555555555545, -206.6655555555555, -179.68000000000004, -199.0338888888888, -204.81388888888884, -213.88944444444428, -211.53722222222203, -201.21666666666658, -225.8188888888888, -191.97999999999988, -206.18777777777774, -192.87388888888876, -201.31166666666653, -210.8538888888889, -207.2177777777778, -200.39999999999986, -206.90944444444443, -185.77333333333328, -211.9938888888888, -212.90055555555546, -203.27333333333314, -187.9422222222221, -213.26555555555552, -212.90222222222218, -217.32833333333318, -187.89222222222213, -199.1694444444444, -213.50055555555562, -211.80111111111103, -201.52722222222212, -221.7416666666666, -205.23055555555544, -196.30444444444436, -197.81888888888878, -215.59999999999994, -204.86888888888885, -206.0922222222222, -193.2872222222222, -205.3949999999998, -224.4705555555555, -226.25999999999985, -217.67055555555558, -208.54277777777764, -206.0038888888888, -199.60000000000002, -225.2816666666667, -197.8205555555555, -228.61833333333325, -205.16388888888878, -196.86388888888888, -174.0894444444444, -219.05999999999983, -213.27277777777772, -218.30777777777766, -217.1149999999999, -191.30055555555552, -193.7455555555554, -226.12111111111108, -203.76666666666662]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19073829835541914, "mean_inference_ms": 1.7612553211422364, "mean_action_processing_ms": 0.07281256649791246, "mean_env_wait_ms": 1.1893125823189958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038890838623046875, "StateBufferConnector_ms": 0.0027937889099121094, "ViewRequirementAgentConnector_ms": 0.06209731101989746}, "num_episodes": 30, "episode_return_max": -166.72277777777782, "episode_return_min": -248.94777777777773, "episode_return_mean": -205.02673333333325, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 137700, "num_agent_steps_trained": 137400, "num_env_steps_sampled": 137700, "num_env_steps_trained": 137400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 297.38252858926535, "num_env_steps_trained_throughput_per_sec": 297.38252858926535, "timesteps_total": 137700, "num_env_steps_sampled_lifetime": 137700, "num_agent_steps_sampled_lifetime": 137700, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 137700, "timers": {"training_iteration_time_ms": 10207.458, "restore_workers_time_ms": 0.011, "training_step_time_ms": 500.928, "sample_time_ms": 486.375, "synch_weights_time_ms": 13.242}, "counters": {"num_env_steps_sampled": 137700, "num_env_steps_trained": 137400, "num_agent_steps_sampled": 137700, "num_agent_steps_trained": 137400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 918, "num_samples_added_to_queue": 137700}, "done": false, "training_iteration": 45, "trial_id": "0313d_00000", "date": "2024-10-10_21-49-08", "timestamp": 1728593348, "time_this_iter_s": 10.097784280776978, "time_total_s": 462.50709414482117, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c17d00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 462.50709414482117, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 11.085714285714287, "ram_util_percent": 54.935714285714276}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -176501.90625, "policy_loss": -176496.5, "entropy": 29.687408447265625, "entropy_coeff": 0.01, "var_gnorm": 16.093595504760742, "vf_loss": 83659.234375, "vf_explained_var": 0.11194604635238647}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 468.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 140700, "num_env_steps_trained": 140400, "num_agent_steps_sampled": 140700, "num_agent_steps_trained": 140400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 938, "num_samples_added_to_queue": 140700, "learner_queue": {"size_count": 468, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 50.828, "learner_load_time_ms": 0.258, "learner_load_wait_time_ms": 979.559, "learner_dequeue_time_ms": 8168.286}}, "env_runners": {"episode_reward_max": -166.72277777777782, "episode_reward_min": -245.42111111111097, "episode_reward_mean": -204.82676666666654, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -245.42111111111097}, "policy_reward_max": {"default_policy": -166.72277777777782}, "policy_reward_mean": {"default_policy": -204.82676666666654}, "custom_metrics": {"num_consolidated_mean": 0.6733999999999999, "num_consolidated_min": 0.46, "num_consolidated_max": 0.85, "num_overloaded_mean": 0.9718000000000001, "num_overloaded_min": 0.8, "num_overloaded_max": 1.18, "num_moves_mean": 9.9832, "num_moves_min": 9.66, "num_moves_max": 10.24, "mean_accuracy_mean": 40.9043, "mean_accuracy_min": 40.63766666666666, "mean_accuracy_max": 41.22033333333333, "num_model_switches_mean": 5.955199999999999, "num_model_switches_min": 5.61, "num_model_switches_max": 6.33, "num_slav_mean": 0.14191066666666668, "num_slav_min": 0.12138333333333334, "num_slav_max": 0.16916666666666663, "mean_cluster_cpu_util_mean": 0.5612823226163207, "mean_cluster_cpu_util_min": 0.5368847309943443, "mean_cluster_cpu_util_max": 0.5842913469793813, "mean_cluster_mem_util_mean": 0.361587252891874, "mean_cluster_mem_util_min": 0.3515040360659032, "mean_cluster_mem_util_max": 0.3716003998751398, "reward_consolidation_mean_mean": 0.19777777777777777, "reward_consolidation_mean_min": 0.06944444444444443, "reward_consolidation_mean_max": 0.2916666666666667, "reward_illegal_mean_mean": -1.6196666666666666, "reward_illegal_mean_min": -1.9666666666666666, "reward_illegal_mean_max": -1.333333333333333, "reward_accuracy_mean_mean": 0.474749, "reward_accuracy_mean_min": 0.20391666666666666, "reward_accuracy_mean_max": 0.6522166666666667, "reward_sla_mean_mean": -1.1011277777777777, "reward_sla_mean_min": -1.812777777777778, "reward_sla_mean_max": -0.44166666666666665, "reward_consolidation_sum_mean": 19.777777777777775, "reward_consolidation_sum_min": 6.944444444444444, "reward_consolidation_sum_max": 29.166666666666668, "reward_illegal_sum_mean": -161.9666666666666, "reward_illegal_sum_min": -196.66666666666666, "reward_illegal_sum_max": -133.33333333333331, "reward_accuracy_sum_mean": 47.474900000000005, "reward_accuracy_sum_min": 20.391666666666666, "reward_accuracy_sum_max": 65.22166666666666, "reward_sla_sum_mean": -110.11277777777781, "reward_sla_sum_min": -181.2777777777778, "reward_sla_sum_max": -44.166666666666664, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6016.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-215.07555555555555, -189.06111111111102, -187.85555555555553, -210.46888888888884, -193.90611111111107, -195.34999999999985, -207.47222222222211, -201.6622222222222, -213.88722222222214, -166.72277777777782, -194.7261111111111, -226.46555555555545, -206.6655555555555, -179.68000000000004, -199.0338888888888, -204.81388888888884, -213.88944444444428, -211.53722222222203, -201.21666666666658, -225.8188888888888, -191.97999999999988, -206.18777777777774, -192.87388888888876, -201.31166666666653, -210.8538888888889, -207.2177777777778, -200.39999999999986, -206.90944444444443, -185.77333333333328, -211.9938888888888, -212.90055555555546, -203.27333333333314, -187.9422222222221, -213.26555555555552, -212.90222222222218, -217.32833333333318, -187.89222222222213, -199.1694444444444, -213.50055555555562, -211.80111111111103, -201.52722222222212, -221.7416666666666, -205.23055555555544, -196.30444444444436, -197.81888888888878, -215.59999999999994, -204.86888888888885, -206.0922222222222, -193.2872222222222, -205.3949999999998, -224.4705555555555, -226.25999999999985, -217.67055555555558, -208.54277777777764, -206.0038888888888, -199.60000000000002, -225.2816666666667, -197.8205555555555, -228.61833333333325, -205.16388888888878, -196.86388888888888, -174.0894444444444, -219.05999999999983, -213.27277777777772, -218.30777777777766, -217.1149999999999, -191.30055555555552, -193.7455555555554, -226.12111111111108, -203.76666666666662, -245.42111111111097, -188.32722222222213, -220.31999999999994, -194.57777777777756, -227.56222222222215, -217.89999999999998, -176.9116666666667, -192.1361111111111, -215.77888888888864, -218.52999999999994, -216.8494444444445, -198.0683333333333, -218.28833333333327, -189.25055555555554, -180.14833333333328, -173.39277777777784, -210.9344444444444, -193.54444444444448, -209.3933333333332, -218.46722222222212, -179.7511111111111, -214.94333333333313, -205.99055555555563, -207.14777777777763, -195.94833333333324, -206.282222222222, -215.06611111111104, -209.21722222222215, -190.39944444444438, -190.40111111111116], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-215.07555555555555, -189.06111111111102, -187.85555555555553, -210.46888888888884, -193.90611111111107, -195.34999999999985, -207.47222222222211, -201.6622222222222, -213.88722222222214, -166.72277777777782, -194.7261111111111, -226.46555555555545, -206.6655555555555, -179.68000000000004, -199.0338888888888, -204.81388888888884, -213.88944444444428, -211.53722222222203, -201.21666666666658, -225.8188888888888, -191.97999999999988, -206.18777777777774, -192.87388888888876, -201.31166666666653, -210.8538888888889, -207.2177777777778, -200.39999999999986, -206.90944444444443, -185.77333333333328, -211.9938888888888, -212.90055555555546, -203.27333333333314, -187.9422222222221, -213.26555555555552, -212.90222222222218, -217.32833333333318, -187.89222222222213, -199.1694444444444, -213.50055555555562, -211.80111111111103, -201.52722222222212, -221.7416666666666, -205.23055555555544, -196.30444444444436, -197.81888888888878, -215.59999999999994, -204.86888888888885, -206.0922222222222, -193.2872222222222, -205.3949999999998, -224.4705555555555, -226.25999999999985, -217.67055555555558, -208.54277777777764, -206.0038888888888, -199.60000000000002, -225.2816666666667, -197.8205555555555, -228.61833333333325, -205.16388888888878, -196.86388888888888, -174.0894444444444, -219.05999999999983, -213.27277777777772, -218.30777777777766, -217.1149999999999, -191.30055555555552, -193.7455555555554, -226.12111111111108, -203.76666666666662, -245.42111111111097, -188.32722222222213, -220.31999999999994, -194.57777777777756, -227.56222222222215, -217.89999999999998, -176.9116666666667, -192.1361111111111, -215.77888888888864, -218.52999999999994, -216.8494444444445, -198.0683333333333, -218.28833333333327, -189.25055555555554, -180.14833333333328, -173.39277777777784, -210.9344444444444, -193.54444444444448, -209.3933333333332, -218.46722222222212, -179.7511111111111, -214.94333333333313, -205.99055555555563, -207.14777777777763, -195.94833333333324, -206.282222222222, -215.06611111111104, -209.21722222222215, -190.39944444444438, -190.40111111111116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1906930841529131, "mean_inference_ms": 1.759816379118412, "mean_action_processing_ms": 0.07279432528510558, "mean_env_wait_ms": 1.1892352216575228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004095792770385742, "StateBufferConnector_ms": 0.002843141555786133, "ViewRequirementAgentConnector_ms": 0.06369447708129883}, "num_episodes": 30, "episode_return_max": -166.72277777777782, "episode_return_min": -245.42111111111097, "episode_return_mean": -204.82676666666654, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140700, "num_agent_steps_trained": 140400, "num_env_steps_sampled": 140700, "num_env_steps_trained": 140400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 292.6170479284403, "num_env_steps_trained_throughput_per_sec": 292.6170479284403, "timesteps_total": 140700, "num_env_steps_sampled_lifetime": 140700, "num_agent_steps_sampled_lifetime": 140700, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 140700, "timers": {"training_iteration_time_ms": 10223.695, "restore_workers_time_ms": 0.014, "training_step_time_ms": 505.744, "sample_time_ms": 491.723, "synch_weights_time_ms": 12.734}, "counters": {"num_env_steps_sampled": 140700, "num_env_steps_trained": 140400, "num_agent_steps_sampled": 140700, "num_agent_steps_trained": 140400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 938, "num_samples_added_to_queue": 140700}, "done": false, "training_iteration": 46, "trial_id": "0313d_00000", "date": "2024-10-10_21-49-18", "timestamp": 1728593358, "time_this_iter_s": 10.262431383132935, "time_total_s": 472.7695255279541, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42dc8df0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 472.7695255279541, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 10.5, "ram_util_percent": 55.09333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -169439.265625, "policy_loss": -169428.8125, "entropy": 29.66710662841797, "entropy_coeff": 0.01, "var_gnorm": 16.098779678344727, "vf_loss": 78550.265625, "vf_explained_var": 0.12026476860046387}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 478.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 143700, "num_env_steps_trained": 143400, "num_agent_steps_sampled": 143700, "num_agent_steps_trained": 143400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 958, "num_samples_added_to_queue": 143700, "learner_queue": {"size_count": 478, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.091, "learner_load_time_ms": 0.281, "learner_load_wait_time_ms": 965.263, "learner_dequeue_time_ms": 8186.907}}, "env_runners": {"episode_reward_max": -169.32277777777776, "episode_reward_min": -245.42111111111097, "episode_reward_mean": -204.184061111111, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -245.42111111111097}, "policy_reward_max": {"default_policy": -169.32277777777776}, "policy_reward_mean": {"default_policy": -204.184061111111}, "custom_metrics": {"num_consolidated_mean": 0.6737000000000001, "num_consolidated_min": 0.51, "num_consolidated_max": 0.84, "num_overloaded_mean": 0.9707999999999999, "num_overloaded_min": 0.79, "num_overloaded_max": 1.18, "num_moves_mean": 9.985199999999999, "num_moves_min": 9.69, "num_moves_max": 10.29, "mean_accuracy_mean": 40.886693333333334, "mean_accuracy_min": 40.63766666666666, "mean_accuracy_max": 41.22033333333333, "num_model_switches_mean": 5.9453000000000005, "num_model_switches_min": 5.48, "num_model_switches_max": 6.31, "num_slav_mean": 0.14019416666666668, "num_slav_min": 0.12138333333333334, "num_slav_max": 0.16916666666666663, "mean_cluster_cpu_util_mean": 0.5608292163331514, "mean_cluster_cpu_util_min": 0.5365434483263267, "mean_cluster_cpu_util_max": 0.5842913469793813, "mean_cluster_mem_util_mean": 0.3613215032560493, "mean_cluster_mem_util_min": 0.3501681811332127, "mean_cluster_mem_util_max": 0.3716003998751398, "reward_consolidation_mean_mean": 0.19902777777777775, "reward_consolidation_mean_min": 0.08333333333333334, "reward_consolidation_mean_max": 0.33333333333333326, "reward_illegal_mean_mean": -1.6179999999999992, "reward_illegal_mean_min": -1.9666666666666666, "reward_illegal_mean_max": -1.3166666666666667, "reward_accuracy_mean_mean": 0.47508716666666667, "reward_accuracy_mean_min": 0.20391666666666666, "reward_accuracy_mean_max": 0.7110166666666666, "reward_sla_mean_mean": -1.0979555555555556, "reward_sla_mean_min": -1.812777777777778, "reward_sla_mean_max": -0.44166666666666665, "reward_consolidation_sum_mean": 19.902777777777775, "reward_consolidation_sum_min": 8.333333333333334, "reward_consolidation_sum_max": 33.33333333333333, "reward_illegal_sum_mean": -161.79999999999995, "reward_illegal_sum_min": -196.66666666666666, "reward_illegal_sum_max": -131.66666666666666, "reward_accuracy_sum_mean": 47.50871666666666, "reward_accuracy_sum_min": 20.391666666666666, "reward_accuracy_sum_max": 71.10166666666666, "reward_sla_sum_mean": -109.79555555555555, "reward_sla_sum_min": -181.2777777777778, "reward_sla_sum_max": -44.166666666666664, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4676.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-212.90055555555546, -203.27333333333314, -187.9422222222221, -213.26555555555552, -212.90222222222218, -217.32833333333318, -187.89222222222213, -199.1694444444444, -213.50055555555562, -211.80111111111103, -201.52722222222212, -221.7416666666666, -205.23055555555544, -196.30444444444436, -197.81888888888878, -215.59999999999994, -204.86888888888885, -206.0922222222222, -193.2872222222222, -205.3949999999998, -224.4705555555555, -226.25999999999985, -217.67055555555558, -208.54277777777764, -206.0038888888888, -199.60000000000002, -225.2816666666667, -197.8205555555555, -228.61833333333325, -205.16388888888878, -196.86388888888888, -174.0894444444444, -219.05999999999983, -213.27277777777772, -218.30777777777766, -217.1149999999999, -191.30055555555552, -193.7455555555554, -226.12111111111108, -203.76666666666662, -245.42111111111097, -188.32722222222213, -220.31999999999994, -194.57777777777756, -227.56222222222215, -217.89999999999998, -176.9116666666667, -192.1361111111111, -215.77888888888864, -218.52999999999994, -216.8494444444445, -198.0683333333333, -218.28833333333327, -189.25055555555554, -180.14833333333328, -173.39277777777784, -210.9344444444444, -193.54444444444448, -209.3933333333332, -218.46722222222212, -179.7511111111111, -214.94333333333313, -205.99055555555563, -207.14777777777763, -195.94833333333324, -206.282222222222, -215.06611111111104, -209.21722222222215, -190.39944444444438, -190.40111111111116, -195.30222222222207, -214.42499999999993, -219.59833333333336, -211.91555555555544, -200.37611111111113, -179.9538888888889, -176.50111111111096, -220.0672222222221, -200.38499999999993, -211.47222222222211, -198.47111111111116, -169.32277777777776, -212.97277777777785, -201.76555555555538, -202.27277777777778, -203.0788888888888, -182.1055555555555, -205.9411111111111, -195.49666666666653, -182.08611111111114, -187.49166666666665, -185.3155555555555, -207.9483333333332, -215.40055555555537, -199.02722222222206, -195.40722222222223, -212.12333333333328, -216.64611111111105, -205.32777777777764, -188.34222222222206], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-212.90055555555546, -203.27333333333314, -187.9422222222221, -213.26555555555552, -212.90222222222218, -217.32833333333318, -187.89222222222213, -199.1694444444444, -213.50055555555562, -211.80111111111103, -201.52722222222212, -221.7416666666666, -205.23055555555544, -196.30444444444436, -197.81888888888878, -215.59999999999994, -204.86888888888885, -206.0922222222222, -193.2872222222222, -205.3949999999998, -224.4705555555555, -226.25999999999985, -217.67055555555558, -208.54277777777764, -206.0038888888888, -199.60000000000002, -225.2816666666667, -197.8205555555555, -228.61833333333325, -205.16388888888878, -196.86388888888888, -174.0894444444444, -219.05999999999983, -213.27277777777772, -218.30777777777766, -217.1149999999999, -191.30055555555552, -193.7455555555554, -226.12111111111108, -203.76666666666662, -245.42111111111097, -188.32722222222213, -220.31999999999994, -194.57777777777756, -227.56222222222215, -217.89999999999998, -176.9116666666667, -192.1361111111111, -215.77888888888864, -218.52999999999994, -216.8494444444445, -198.0683333333333, -218.28833333333327, -189.25055555555554, -180.14833333333328, -173.39277777777784, -210.9344444444444, -193.54444444444448, -209.3933333333332, -218.46722222222212, -179.7511111111111, -214.94333333333313, -205.99055555555563, -207.14777777777763, -195.94833333333324, -206.282222222222, -215.06611111111104, -209.21722222222215, -190.39944444444438, -190.40111111111116, -195.30222222222207, -214.42499999999993, -219.59833333333336, -211.91555555555544, -200.37611111111113, -179.9538888888889, -176.50111111111096, -220.0672222222221, -200.38499999999993, -211.47222222222211, -198.47111111111116, -169.32277777777776, -212.97277777777785, -201.76555555555538, -202.27277777777778, -203.0788888888888, -182.1055555555555, -205.9411111111111, -195.49666666666653, -182.08611111111114, -187.49166666666665, -185.3155555555555, -207.9483333333332, -215.40055555555537, -199.02722222222206, -195.40722222222223, -212.12333333333328, -216.64611111111105, -205.32777777777764, -188.34222222222206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19071548073986372, "mean_inference_ms": 1.7601714285027352, "mean_action_processing_ms": 0.07279936693582727, "mean_env_wait_ms": 1.1895793553447118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040967464447021484, "StateBufferConnector_ms": 0.002825021743774414, "ViewRequirementAgentConnector_ms": 0.06347107887268066}, "num_episodes": 30, "episode_return_max": -169.32277777777776, "episode_return_min": -245.42111111111097, "episode_return_mean": -204.184061111111, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 143700, "num_agent_steps_trained": 143400, "num_env_steps_sampled": 143700, "num_env_steps_trained": 143400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 294.19515214061613, "num_env_steps_trained_throughput_per_sec": 294.19515214061613, "timesteps_total": 143700, "num_env_steps_sampled_lifetime": 143700, "num_agent_steps_sampled_lifetime": 143700, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 143700, "timers": {"training_iteration_time_ms": 10204.106, "restore_workers_time_ms": 0.011, "training_step_time_ms": 501.26, "sample_time_ms": 486.986, "synch_weights_time_ms": 12.975}, "counters": {"num_env_steps_sampled": 143700, "num_env_steps_trained": 143400, "num_agent_steps_sampled": 143700, "num_agent_steps_trained": 143400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 958, "num_samples_added_to_queue": 143700}, "done": false, "training_iteration": 47, "trial_id": "0313d_00000", "date": "2024-10-10_21-49-28", "timestamp": 1728593368, "time_this_iter_s": 10.20675778388977, "time_total_s": 482.9762833118439, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d8ae00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 482.9762833118439, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 10.785714285714286, "ram_util_percent": 55.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -149212.109375, "policy_loss": -149182.40625, "entropy": 29.650449752807617, "entropy_coeff": 0.01, "var_gnorm": 16.105262756347656, "vf_loss": 59251.5859375, "vf_explained_var": 0.15314364433288574}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 489.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 146850, "num_env_steps_trained": 146700, "num_agent_steps_sampled": 146850, "num_agent_steps_trained": 146700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 979, "num_samples_added_to_queue": 146700, "learner_queue": {"size_count": 489, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.589, "learner_load_time_ms": 0.275, "learner_load_wait_time_ms": 915.459, "learner_dequeue_time_ms": 8105.239}}, "env_runners": {"episode_reward_max": -145.47277777777776, "episode_reward_min": -245.42111111111097, "episode_reward_mean": -200.15501666666657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -245.42111111111097}, "policy_reward_max": {"default_policy": -145.47277777777776}, "policy_reward_mean": {"default_policy": -200.15501666666657}, "custom_metrics": {"num_consolidated_mean": 0.6705000000000001, "num_consolidated_min": 0.51, "num_consolidated_max": 0.84, "num_overloaded_mean": 0.9589, "num_overloaded_min": 0.75, "num_overloaded_max": 1.13, "num_moves_mean": 9.9891, "num_moves_min": 9.69, "num_moves_max": 10.29, "mean_accuracy_mean": 40.85572333333333, "mean_accuracy_min": 40.586999999999996, "mean_accuracy_max": 41.22033333333333, "num_model_switches_mean": 5.934899999999998, "num_model_switches_min": 5.46, "num_model_switches_max": 6.31, "num_slav_mean": 0.13729833333333333, "num_slav_min": 0.11711666666666666, "num_slav_max": 0.15391666666666665, "mean_cluster_cpu_util_mean": 0.5588590240633994, "mean_cluster_cpu_util_min": 0.5365434483263267, "mean_cluster_cpu_util_max": 0.5842913469793813, "mean_cluster_mem_util_mean": 0.3603769938843681, "mean_cluster_mem_util_min": 0.3501681811332127, "mean_cluster_mem_util_max": 0.3716003998751398, "reward_consolidation_mean_mean": 0.2041666666666667, "reward_consolidation_mean_min": 0.06944444444444443, "reward_consolidation_mean_max": 0.36111111111111116, "reward_illegal_mean_mean": -1.5981666666666663, "reward_illegal_mean_min": -1.8833333333333337, "reward_illegal_mean_max": -1.2499999999999998, "reward_accuracy_mean_mean": 0.4847165, "reward_accuracy_mean_min": 0.26366666666666666, "reward_accuracy_mean_max": 0.7151333333333335, "reward_sla_mean_mean": -1.0922666666666667, "reward_sla_mean_min": -1.812777777777778, "reward_sla_mean_max": -0.5677777777777778, "reward_consolidation_sum_mean": 20.416666666666664, "reward_consolidation_sum_min": 6.944444444444444, "reward_consolidation_sum_max": 36.111111111111114, "reward_illegal_sum_mean": -159.81666666666663, "reward_illegal_sum_min": -188.33333333333337, "reward_illegal_sum_max": -124.99999999999999, "reward_accuracy_sum_mean": 48.47164999999999, "reward_accuracy_sum_min": 26.366666666666664, "reward_accuracy_sum_max": 71.51333333333335, "reward_sla_sum_mean": -109.2266666666667, "reward_sla_sum_min": -181.2777777777778, "reward_sla_sum_max": -56.77777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3336.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-196.86388888888888, -174.0894444444444, -219.05999999999983, -213.27277777777772, -218.30777777777766, -217.1149999999999, -191.30055555555552, -193.7455555555554, -226.12111111111108, -203.76666666666662, -245.42111111111097, -188.32722222222213, -220.31999999999994, -194.57777777777756, -227.56222222222215, -217.89999999999998, -176.9116666666667, -192.1361111111111, -215.77888888888864, -218.52999999999994, -216.8494444444445, -198.0683333333333, -218.28833333333327, -189.25055555555554, -180.14833333333328, -173.39277777777784, -210.9344444444444, -193.54444444444448, -209.3933333333332, -218.46722222222212, -179.7511111111111, -214.94333333333313, -205.99055555555563, -207.14777777777763, -195.94833333333324, -206.282222222222, -215.06611111111104, -209.21722222222215, -190.39944444444438, -190.40111111111116, -195.30222222222207, -214.42499999999993, -219.59833333333336, -211.91555555555544, -200.37611111111113, -179.9538888888889, -176.50111111111096, -220.0672222222221, -200.38499999999993, -211.47222222222211, -198.47111111111116, -169.32277777777776, -212.97277777777785, -201.76555555555538, -202.27277777777778, -203.0788888888888, -182.1055555555555, -205.9411111111111, -195.49666666666653, -182.08611111111114, -187.49166666666665, -185.3155555555555, -207.9483333333332, -215.40055555555537, -199.02722222222206, -195.40722222222223, -212.12333333333328, -216.64611111111105, -205.32777777777764, -188.34222222222206, -185.12388888888884, -202.12999999999988, -200.8288888888889, -203.5361111111111, -205.736111111111, -145.47277777777776, -195.99499999999983, -174.7894444444444, -178.9549999999999, -172.42499999999998, -204.57611111111098, -190.92555555555552, -190.40166666666664, -195.4872222222221, -203.98777777777767, -212.09111111111085, -178.66500000000002, -212.50999999999996, -188.84999999999997, -179.6788888888889, -182.63333333333324, -218.74555555555543, -209.3672222222222, -214.445, -219.81444444444443, -196.2183333333334, -175.6533333333333, -224.5644444444444, -202.5849999999999, -178.17722222222224], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-196.86388888888888, -174.0894444444444, -219.05999999999983, -213.27277777777772, -218.30777777777766, -217.1149999999999, -191.30055555555552, -193.7455555555554, -226.12111111111108, -203.76666666666662, -245.42111111111097, -188.32722222222213, -220.31999999999994, -194.57777777777756, -227.56222222222215, -217.89999999999998, -176.9116666666667, -192.1361111111111, -215.77888888888864, -218.52999999999994, -216.8494444444445, -198.0683333333333, -218.28833333333327, -189.25055555555554, -180.14833333333328, -173.39277777777784, -210.9344444444444, -193.54444444444448, -209.3933333333332, -218.46722222222212, -179.7511111111111, -214.94333333333313, -205.99055555555563, -207.14777777777763, -195.94833333333324, -206.282222222222, -215.06611111111104, -209.21722222222215, -190.39944444444438, -190.40111111111116, -195.30222222222207, -214.42499999999993, -219.59833333333336, -211.91555555555544, -200.37611111111113, -179.9538888888889, -176.50111111111096, -220.0672222222221, -200.38499999999993, -211.47222222222211, -198.47111111111116, -169.32277777777776, -212.97277777777785, -201.76555555555538, -202.27277777777778, -203.0788888888888, -182.1055555555555, -205.9411111111111, -195.49666666666653, -182.08611111111114, -187.49166666666665, -185.3155555555555, -207.9483333333332, -215.40055555555537, -199.02722222222206, -195.40722222222223, -212.12333333333328, -216.64611111111105, -205.32777777777764, -188.34222222222206, -185.12388888888884, -202.12999999999988, -200.8288888888889, -203.5361111111111, -205.736111111111, -145.47277777777776, -195.99499999999983, -174.7894444444444, -178.9549999999999, -172.42499999999998, -204.57611111111098, -190.92555555555552, -190.40166666666664, -195.4872222222221, -203.98777777777767, -212.09111111111085, -178.66500000000002, -212.50999999999996, -188.84999999999997, -179.6788888888889, -182.63333333333324, -218.74555555555543, -209.3672222222222, -214.445, -219.81444444444443, -196.2183333333334, -175.6533333333333, -224.5644444444444, -202.5849999999999, -178.17722222222224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19072844694774616, "mean_inference_ms": 1.7600090215014506, "mean_action_processing_ms": 0.07279199600675591, "mean_env_wait_ms": 1.189723104832914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00407719612121582, "StateBufferConnector_ms": 0.0028276443481445312, "ViewRequirementAgentConnector_ms": 0.06331944465637207}, "num_episodes": 30, "episode_return_max": -145.47277777777776, "episode_return_min": -245.42111111111097, "episode_return_mean": -200.15501666666657, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 146850, "num_agent_steps_trained": 146700, "num_env_steps_sampled": 146850, "num_env_steps_trained": 146700, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 310.11692192598764, "num_env_steps_trained_throughput_per_sec": 324.8843943986537, "timesteps_total": 146850, "num_env_steps_sampled_lifetime": 146850, "num_agent_steps_sampled_lifetime": 146850, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 146850, "timers": {"training_iteration_time_ms": 10217.803, "restore_workers_time_ms": 0.011, "training_step_time_ms": 491.958, "sample_time_ms": 476.937, "synch_weights_time_ms": 13.722}, "counters": {"num_env_steps_sampled": 146850, "num_env_steps_trained": 146700, "num_agent_steps_sampled": 146850, "num_agent_steps_trained": 146700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 979, "num_samples_added_to_queue": 146700}, "done": false, "training_iteration": 48, "trial_id": "0313d_00000", "date": "2024-10-10_21-49-38", "timestamp": 1728593378, "time_this_iter_s": 10.175983905792236, "time_total_s": 493.1522672176361, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c1ab90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 493.1522672176361, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 10.433333333333334, "ram_util_percent": 55.43333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -164320.640625, "policy_loss": -164308.3125, "entropy": 29.636178970336914, "entropy_coeff": 0.01, "var_gnorm": 16.112327575683594, "vf_loss": 76584.5, "vf_explained_var": 0.12372326850891113}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 499.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 149850, "num_env_steps_trained": 149700, "num_agent_steps_sampled": 149850, "num_agent_steps_trained": 149700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 999, "num_samples_added_to_queue": 149700, "learner_queue": {"size_count": 499, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 49.951, "learner_load_time_ms": 0.279, "learner_load_wait_time_ms": 967.219, "learner_dequeue_time_ms": 8124.176}}, "env_runners": {"episode_reward_max": -145.47277777777776, "episode_reward_min": -224.5644444444444, "episode_reward_mean": -197.9446611111111, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -224.5644444444444}, "policy_reward_max": {"default_policy": -145.47277777777776}, "policy_reward_mean": {"default_policy": -197.9446611111111}, "custom_metrics": {"num_consolidated_mean": 0.6773, "num_consolidated_min": 0.51, "num_consolidated_max": 0.83, "num_overloaded_mean": 0.959, "num_overloaded_min": 0.75, "num_overloaded_max": 1.13, "num_moves_mean": 9.9895, "num_moves_min": 9.69, "num_moves_max": 10.29, "mean_accuracy_mean": 40.84084, "mean_accuracy_min": 40.586999999999996, "mean_accuracy_max": 41.150666666666666, "num_model_switches_mean": 5.944500000000001, "num_model_switches_min": 5.46, "num_model_switches_max": 6.39, "num_slav_mean": 0.13581349999999998, "num_slav_min": 0.11711666666666666, "num_slav_max": 0.15225000000000002, "mean_cluster_cpu_util_mean": 0.5589594551116028, "mean_cluster_cpu_util_min": 0.5365434483263267, "mean_cluster_cpu_util_max": 0.582969309059046, "mean_cluster_mem_util_mean": 0.3602655435951807, "mean_cluster_mem_util_min": 0.3501681811332127, "mean_cluster_mem_util_max": 0.3711952644665461, "reward_consolidation_mean_mean": 0.20541666666666664, "reward_consolidation_mean_min": 0.05555555555555555, "reward_consolidation_mean_max": 0.36111111111111116, "reward_illegal_mean_mean": -1.5983333333333336, "reward_illegal_mean_min": -1.8833333333333337, "reward_illegal_mean_max": -1.2499999999999998, "reward_accuracy_mean_mean": 0.4824145, "reward_accuracy_mean_min": 0.22415, "reward_accuracy_mean_max": 0.7151333333333335, "reward_sla_mean_mean": -1.0689444444444443, "reward_sla_mean_min": -1.622777777777778, "reward_sla_mean_max": -0.5194444444444444, "reward_consolidation_sum_mean": 20.541666666666664, "reward_consolidation_sum_min": 5.555555555555555, "reward_consolidation_sum_max": 36.111111111111114, "reward_illegal_sum_mean": -159.83333333333331, "reward_illegal_sum_min": -188.33333333333337, "reward_illegal_sum_max": -124.99999999999999, "reward_accuracy_sum_mean": 48.24144999999999, "reward_accuracy_sum_min": 22.415, "reward_accuracy_sum_max": 71.51333333333335, "reward_sla_sum_mean": -106.89444444444445, "reward_sla_sum_min": -162.2777777777778, "reward_sla_sum_max": -51.94444444444444, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2152.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-179.7511111111111, -214.94333333333313, -205.99055555555563, -207.14777777777763, -195.94833333333324, -206.282222222222, -215.06611111111104, -209.21722222222215, -190.39944444444438, -190.40111111111116, -195.30222222222207, -214.42499999999993, -219.59833333333336, -211.91555555555544, -200.37611111111113, -179.9538888888889, -176.50111111111096, -220.0672222222221, -200.38499999999993, -211.47222222222211, -198.47111111111116, -169.32277777777776, -212.97277777777785, -201.76555555555538, -202.27277777777778, -203.0788888888888, -182.1055555555555, -205.9411111111111, -195.49666666666653, -182.08611111111114, -187.49166666666665, -185.3155555555555, -207.9483333333332, -215.40055555555537, -199.02722222222206, -195.40722222222223, -212.12333333333328, -216.64611111111105, -205.32777777777764, -188.34222222222206, -185.12388888888884, -202.12999999999988, -200.8288888888889, -203.5361111111111, -205.736111111111, -145.47277777777776, -195.99499999999983, -174.7894444444444, -178.9549999999999, -172.42499999999998, -204.57611111111098, -190.92555555555552, -190.40166666666664, -195.4872222222221, -203.98777777777767, -212.09111111111085, -178.66500000000002, -212.50999999999996, -188.84999999999997, -179.6788888888889, -182.63333333333324, -218.74555555555543, -209.3672222222222, -214.445, -219.81444444444443, -196.2183333333334, -175.6533333333333, -224.5644444444444, -202.5849999999999, -178.17722222222224, -216.60944444444448, -189.91555555555553, -205.27888888888884, -207.4805555555555, -214.4316666666666, -205.88333333333324, -212.22944444444434, -191.99166666666662, -211.15944444444435, -191.62277777777777, -177.09666666666666, -199.5294444444443, -174.47555555555553, -185.89555555555552, -175.3077777777777, -209.54555555555552, -200.43722222222215, -188.99833333333314, -221.06222222222212, -213.19055555555542, -194.62277777777769, -210.251111111111, -186.93444444444444, -201.37611111111107, -186.78499999999988, -168.37111111111105, -197.735, -192.93666666666658, -204.79333333333327, -202.46222222222212], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-179.7511111111111, -214.94333333333313, -205.99055555555563, -207.14777777777763, -195.94833333333324, -206.282222222222, -215.06611111111104, -209.21722222222215, -190.39944444444438, -190.40111111111116, -195.30222222222207, -214.42499999999993, -219.59833333333336, -211.91555555555544, -200.37611111111113, -179.9538888888889, -176.50111111111096, -220.0672222222221, -200.38499999999993, -211.47222222222211, -198.47111111111116, -169.32277777777776, -212.97277777777785, -201.76555555555538, -202.27277777777778, -203.0788888888888, -182.1055555555555, -205.9411111111111, -195.49666666666653, -182.08611111111114, -187.49166666666665, -185.3155555555555, -207.9483333333332, -215.40055555555537, -199.02722222222206, -195.40722222222223, -212.12333333333328, -216.64611111111105, -205.32777777777764, -188.34222222222206, -185.12388888888884, -202.12999999999988, -200.8288888888889, -203.5361111111111, -205.736111111111, -145.47277777777776, -195.99499999999983, -174.7894444444444, -178.9549999999999, -172.42499999999998, -204.57611111111098, -190.92555555555552, -190.40166666666664, -195.4872222222221, -203.98777777777767, -212.09111111111085, -178.66500000000002, -212.50999999999996, -188.84999999999997, -179.6788888888889, -182.63333333333324, -218.74555555555543, -209.3672222222222, -214.445, -219.81444444444443, -196.2183333333334, -175.6533333333333, -224.5644444444444, -202.5849999999999, -178.17722222222224, -216.60944444444448, -189.91555555555553, -205.27888888888884, -207.4805555555555, -214.4316666666666, -205.88333333333324, -212.22944444444434, -191.99166666666662, -211.15944444444435, -191.62277777777777, -177.09666666666666, -199.5294444444443, -174.47555555555553, -185.89555555555552, -175.3077777777777, -209.54555555555552, -200.43722222222215, -188.99833333333314, -221.06222222222212, -213.19055555555542, -194.62277777777769, -210.251111111111, -186.93444444444444, -201.37611111111107, -186.78499999999988, -168.37111111111105, -197.735, -192.93666666666658, -204.79333333333327, -202.46222222222212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907033804983818, "mean_inference_ms": 1.7598471962736837, "mean_action_processing_ms": 0.07277761620850043, "mean_env_wait_ms": 1.1897684049700792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003858804702758789, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.06180071830749512}, "num_episodes": 30, "episode_return_max": -145.47277777777776, "episode_return_min": -224.5644444444444, "episode_return_mean": -197.9446611111111, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149850, "num_agent_steps_trained": 149700, "num_env_steps_sampled": 149850, "num_env_steps_trained": 149700, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 294.95268042672075, "num_env_steps_trained_throughput_per_sec": 294.95268042672075, "timesteps_total": 149850, "num_env_steps_sampled_lifetime": 149850, "num_agent_steps_sampled_lifetime": 149850, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 149850, "timers": {"training_iteration_time_ms": 10205.897, "restore_workers_time_ms": 0.011, "training_step_time_ms": 491.969, "sample_time_ms": 477.905, "synch_weights_time_ms": 12.696}, "counters": {"num_env_steps_sampled": 149850, "num_env_steps_trained": 149700, "num_agent_steps_sampled": 149850, "num_agent_steps_trained": 149700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 999, "num_samples_added_to_queue": 149700}, "done": false, "training_iteration": 49, "trial_id": "0313d_00000", "date": "2024-10-10_21-49-49", "timestamp": 1728593389, "time_this_iter_s": 10.186024188995361, "time_total_s": 503.33829140663147, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c15510>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 503.33829140663147, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 10.442857142857145, "ram_util_percent": 55.74285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -155472.6875, "policy_loss": -155450.234375, "entropy": 29.59869384765625, "entropy_coeff": 0.01, "var_gnorm": 16.12138557434082, "vf_loss": 66336.328125, "vf_explained_var": 0.1588788628578186}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 509.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 153000, "num_env_steps_trained": 152700, "num_agent_steps_sampled": 153000, "num_agent_steps_trained": 152700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1020, "num_samples_added_to_queue": 153000, "learner_queue": {"size_count": 509, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 52.536, "learner_load_time_ms": 0.252, "learner_load_wait_time_ms": 937.361, "learner_dequeue_time_ms": 8104.604}}, "env_runners": {"episode_reward_max": -145.47277777777776, "episode_reward_min": -232.8622222222221, "episode_reward_mean": -197.35698333333326, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -232.8622222222221}, "policy_reward_max": {"default_policy": -145.47277777777776}, "policy_reward_mean": {"default_policy": -197.35698333333326}, "custom_metrics": {"num_consolidated_mean": 0.6805000000000001, "num_consolidated_min": 0.51, "num_consolidated_max": 0.83, "num_overloaded_mean": 0.9624000000000003, "num_overloaded_min": 0.75, "num_overloaded_max": 1.12, "num_moves_mean": 9.9861, "num_moves_min": 9.7, "num_moves_max": 10.29, "mean_accuracy_mean": 40.824690000000004, "mean_accuracy_min": 40.510999999999996, "mean_accuracy_max": 41.03033333333334, "num_model_switches_mean": 5.9546, "num_model_switches_min": 5.46, "num_model_switches_max": 6.39, "num_slav_mean": 0.1339381666666667, "num_slav_min": 0.11505000000000001, "num_slav_max": 0.15123333333333336, "mean_cluster_cpu_util_mean": 0.5589556854077894, "mean_cluster_cpu_util_min": 0.5400851599243185, "mean_cluster_cpu_util_max": 0.5796125842034405, "mean_cluster_mem_util_mean": 0.3603450343849564, "mean_cluster_mem_util_min": 0.35256883162547714, "mean_cluster_mem_util_max": 0.3695657399035563, "reward_consolidation_mean_mean": 0.2130555555555555, "reward_consolidation_mean_min": 0.05555555555555555, "reward_consolidation_mean_max": 0.36111111111111116, "reward_illegal_mean_mean": -1.6039999999999999, "reward_illegal_mean_min": -1.8666666666666663, "reward_illegal_mean_max": -1.2499999999999998, "reward_accuracy_mean_mean": 0.48579683333333334, "reward_accuracy_mean_min": 0.22351666666666667, "reward_accuracy_mean_max": 0.7151333333333335, "reward_sla_mean_mean": -1.0684222222222222, "reward_sla_mean_min": -1.622777777777778, "reward_sla_mean_max": -0.5194444444444444, "reward_consolidation_sum_mean": 21.305555555555546, "reward_consolidation_sum_min": 5.555555555555555, "reward_consolidation_sum_max": 36.111111111111114, "reward_illegal_sum_mean": -160.39999999999998, "reward_illegal_sum_min": -186.66666666666663, "reward_illegal_sum_max": -124.99999999999999, "reward_accuracy_sum_mean": 48.579683333333335, "reward_accuracy_sum_min": 22.351666666666667, "reward_accuracy_sum_max": 71.51333333333335, "reward_sla_sum_mean": -106.84222222222225, "reward_sla_sum_min": -162.2777777777778, "reward_sla_sum_max": -51.94444444444444, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2567.0, "global_timestep_min": 500, "global_timestep_max": 4200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-215.40055555555537, -199.02722222222206, -195.40722222222223, -212.12333333333328, -216.64611111111105, -205.32777777777764, -188.34222222222206, -185.12388888888884, -202.12999999999988, -200.8288888888889, -203.5361111111111, -205.736111111111, -145.47277777777776, -195.99499999999983, -174.7894444444444, -178.9549999999999, -172.42499999999998, -204.57611111111098, -190.92555555555552, -190.40166666666664, -195.4872222222221, -203.98777777777767, -212.09111111111085, -178.66500000000002, -212.50999999999996, -188.84999999999997, -179.6788888888889, -182.63333333333324, -218.74555555555543, -209.3672222222222, -214.445, -219.81444444444443, -196.2183333333334, -175.6533333333333, -224.5644444444444, -202.5849999999999, -178.17722222222224, -216.60944444444448, -189.91555555555553, -205.27888888888884, -207.4805555555555, -214.4316666666666, -205.88333333333324, -212.22944444444434, -191.99166666666662, -211.15944444444435, -191.62277777777777, -177.09666666666666, -199.5294444444443, -174.47555555555553, -185.89555555555552, -175.3077777777777, -209.54555555555552, -200.43722222222215, -188.99833333333314, -221.06222222222212, -213.19055555555542, -194.62277777777769, -210.251111111111, -186.93444444444444, -201.37611111111107, -186.78499999999988, -168.37111111111105, -197.735, -192.93666666666658, -204.79333333333327, -202.46222222222212, -211.96333333333317, -216.74944444444438, -197.8055555555555, -204.39999999999992, -201.96111111111097, -207.70555555555543, -216.03722222222206, -192.36111111111106, -196.29777777777767, -189.26055555555544, -184.5811111111112, -202.7633333333334, -198.39222222222213, -186.08555555555552, -168.3383333333334, -181.61944444444438, -203.93166666666667, -184.60944444444448, -189.7633333333333, -192.31111111111116, -205.61777777777775, -194.34111111111105, -232.8622222222221, -198.4283333333333, -213.2188888888888, -211.11388888888888, -192.77388888888888, -186.3283333333333, -184.60499999999996, -219.90888888888875, -177.06222222222215, -190.18888888888884, -187.2583333333332], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-215.40055555555537, -199.02722222222206, -195.40722222222223, -212.12333333333328, -216.64611111111105, -205.32777777777764, -188.34222222222206, -185.12388888888884, -202.12999999999988, -200.8288888888889, -203.5361111111111, -205.736111111111, -145.47277777777776, -195.99499999999983, -174.7894444444444, -178.9549999999999, -172.42499999999998, -204.57611111111098, -190.92555555555552, -190.40166666666664, -195.4872222222221, -203.98777777777767, -212.09111111111085, -178.66500000000002, -212.50999999999996, -188.84999999999997, -179.6788888888889, -182.63333333333324, -218.74555555555543, -209.3672222222222, -214.445, -219.81444444444443, -196.2183333333334, -175.6533333333333, -224.5644444444444, -202.5849999999999, -178.17722222222224, -216.60944444444448, -189.91555555555553, -205.27888888888884, -207.4805555555555, -214.4316666666666, -205.88333333333324, -212.22944444444434, -191.99166666666662, -211.15944444444435, -191.62277777777777, -177.09666666666666, -199.5294444444443, -174.47555555555553, -185.89555555555552, -175.3077777777777, -209.54555555555552, -200.43722222222215, -188.99833333333314, -221.06222222222212, -213.19055555555542, -194.62277777777769, -210.251111111111, -186.93444444444444, -201.37611111111107, -186.78499999999988, -168.37111111111105, -197.735, -192.93666666666658, -204.79333333333327, -202.46222222222212, -211.96333333333317, -216.74944444444438, -197.8055555555555, -204.39999999999992, -201.96111111111097, -207.70555555555543, -216.03722222222206, -192.36111111111106, -196.29777777777767, -189.26055555555544, -184.5811111111112, -202.7633333333334, -198.39222222222213, -186.08555555555552, -168.3383333333334, -181.61944444444438, -203.93166666666667, -184.60944444444448, -189.7633333333333, -192.31111111111116, -205.61777777777775, -194.34111111111105, -232.8622222222221, -198.4283333333333, -213.2188888888888, -211.11388888888888, -192.77388888888888, -186.3283333333333, -184.60499999999996, -219.90888888888875, -177.06222222222215, -190.18888888888884, -187.2583333333332]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1906875478577939, "mean_inference_ms": 1.7605227087168043, "mean_action_processing_ms": 0.07277644621879081, "mean_env_wait_ms": 1.1900313369821809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004182577133178711, "StateBufferConnector_ms": 0.0027773380279541016, "ViewRequirementAgentConnector_ms": 0.061011552810668945}, "num_episodes": 33, "episode_return_max": -145.47277777777776, "episode_return_min": -232.8622222222221, "episode_return_mean": -197.35698333333326, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 153000, "num_agent_steps_trained": 152700, "num_env_steps_sampled": 153000, "num_env_steps_trained": 152700, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 304.26335071110424, "num_env_steps_trained_throughput_per_sec": 289.77461972486117, "timesteps_total": 153000, "num_env_steps_sampled_lifetime": 153000, "num_agent_steps_sampled_lifetime": 153000, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 153000, "timers": {"training_iteration_time_ms": 10225.976, "restore_workers_time_ms": 0.011, "training_step_time_ms": 467.51, "sample_time_ms": 454.356, "synch_weights_time_ms": 11.9}, "counters": {"num_env_steps_sampled": 153000, "num_env_steps_trained": 152700, "num_agent_steps_sampled": 153000, "num_agent_steps_trained": 152700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1020, "num_samples_added_to_queue": 153000}, "done": false, "training_iteration": 50, "trial_id": "0313d_00000", "date": "2024-10-10_21-49-59", "timestamp": 1728593399, "time_this_iter_s": 10.373209238052368, "time_total_s": 513.7115006446838, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42dc8b20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 513.7115006446838, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 10.733333333333333, "ram_util_percent": 56.013333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -148084.078125, "policy_loss": -148057.171875, "entropy": 29.53917694091797, "entropy_coeff": 0.01, "var_gnorm": 16.13294219970703, "vf_loss": 61717.90625, "vf_explained_var": 0.17387604713439941}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 519.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 155850, "num_env_steps_trained": 155700, "num_agent_steps_sampled": 155850, "num_agent_steps_trained": 155700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1039, "num_samples_added_to_queue": 155700, "learner_queue": {"size_count": 519, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.966, "learner_load_time_ms": 0.257, "learner_load_wait_time_ms": 1000.029, "learner_dequeue_time_ms": 8060.474}}, "env_runners": {"episode_reward_max": -162.87333333333333, "episode_reward_min": -232.8622222222221, "episode_reward_mean": -197.2941333333333, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -232.8622222222221}, "policy_reward_max": {"default_policy": -162.87333333333333}, "policy_reward_mean": {"default_policy": -197.2941333333333}, "custom_metrics": {"num_consolidated_mean": 0.6755000000000001, "num_consolidated_min": 0.51, "num_consolidated_max": 0.83, "num_overloaded_mean": 0.9615, "num_overloaded_min": 0.75, "num_overloaded_max": 1.12, "num_moves_mean": 9.9691, "num_moves_min": 9.68, "num_moves_max": 10.29, "mean_accuracy_mean": 40.82196666666667, "mean_accuracy_min": 40.510999999999996, "mean_accuracy_max": 41.03033333333334, "num_model_switches_mean": 5.931100000000002, "num_model_switches_min": 5.44, "num_model_switches_max": 6.39, "num_slav_mean": 0.13316633333333333, "num_slav_min": 0.11505000000000001, "num_slav_max": 0.14984999999999998, "mean_cluster_cpu_util_mean": 0.5587891003753833, "mean_cluster_cpu_util_min": 0.5400851599243185, "mean_cluster_cpu_util_max": 0.5796125842034405, "mean_cluster_mem_util_mean": 0.3602163997495622, "mean_cluster_mem_util_min": 0.35256883162547714, "mean_cluster_mem_util_max": 0.3695657399035563, "reward_consolidation_mean_mean": 0.21124999999999997, "reward_consolidation_mean_min": 0.05555555555555555, "reward_consolidation_mean_max": 0.33333333333333326, "reward_illegal_mean_mean": -1.6024999999999998, "reward_illegal_mean_min": -1.8666666666666663, "reward_illegal_mean_max": -1.2499999999999998, "reward_accuracy_mean_mean": 0.4901753333333334, "reward_accuracy_mean_min": 0.22351666666666667, "reward_accuracy_mean_max": 0.7151333333333335, "reward_sla_mean_mean": -1.0718666666666667, "reward_sla_mean_min": -1.622777777777778, "reward_sla_mean_max": -0.5194444444444444, "reward_consolidation_sum_mean": 21.125, "reward_consolidation_sum_min": 5.555555555555555, "reward_consolidation_sum_max": 33.33333333333333, "reward_illegal_sum_mean": -160.24999999999997, "reward_illegal_sum_min": -186.66666666666663, "reward_illegal_sum_max": -124.99999999999999, "reward_accuracy_sum_mean": 49.01753333333333, "reward_accuracy_sum_min": 22.351666666666667, "reward_accuracy_sum_max": 71.51333333333335, "reward_sla_sum_mean": -107.18666666666667, "reward_sla_sum_min": -162.2777777777778, "reward_sla_sum_max": -51.94444444444444, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3450.0, "global_timestep_min": 1200, "global_timestep_max": 5100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-182.63333333333324, -218.74555555555543, -209.3672222222222, -214.445, -219.81444444444443, -196.2183333333334, -175.6533333333333, -224.5644444444444, -202.5849999999999, -178.17722222222224, -216.60944444444448, -189.91555555555553, -205.27888888888884, -207.4805555555555, -214.4316666666666, -205.88333333333324, -212.22944444444434, -191.99166666666662, -211.15944444444435, -191.62277777777777, -177.09666666666666, -199.5294444444443, -174.47555555555553, -185.89555555555552, -175.3077777777777, -209.54555555555552, -200.43722222222215, -188.99833333333314, -221.06222222222212, -213.19055555555542, -194.62277777777769, -210.251111111111, -186.93444444444444, -201.37611111111107, -186.78499999999988, -168.37111111111105, -197.735, -192.93666666666658, -204.79333333333327, -202.46222222222212, -211.96333333333317, -216.74944444444438, -197.8055555555555, -204.39999999999992, -201.96111111111097, -207.70555555555543, -216.03722222222206, -192.36111111111106, -196.29777777777767, -189.26055555555544, -184.5811111111112, -202.7633333333334, -198.39222222222213, -186.08555555555552, -168.3383333333334, -181.61944444444438, -203.93166666666667, -184.60944444444448, -189.7633333333333, -192.31111111111116, -205.61777777777775, -194.34111111111105, -232.8622222222221, -198.4283333333333, -213.2188888888888, -211.11388888888888, -192.77388888888888, -186.3283333333333, -184.60499999999996, -219.90888888888875, -177.06222222222215, -190.18888888888884, -187.2583333333332, -197.65555555555554, -204.2288888888889, -208.46333333333322, -185.25777777777768, -191.6666666666665, -188.52944444444438, -203.4055555555555, -179.34777777777785, -185.26388888888886, -206.7472222222221, -184.62611111111096, -215.50611111111107, -209.46888888888876, -162.87333333333333, -195.2333333333333, -207.116111111111, -188.16944444444434, -191.51444444444448, -185.27388888888885, -216.28166666666655, -190.5222222222222, -179.35944444444436, -182.7749999999999, -211.28222222222215, -186.38722222222202, -205.82166666666663, -185.37777777777774], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-182.63333333333324, -218.74555555555543, -209.3672222222222, -214.445, -219.81444444444443, -196.2183333333334, -175.6533333333333, -224.5644444444444, -202.5849999999999, -178.17722222222224, -216.60944444444448, -189.91555555555553, -205.27888888888884, -207.4805555555555, -214.4316666666666, -205.88333333333324, -212.22944444444434, -191.99166666666662, -211.15944444444435, -191.62277777777777, -177.09666666666666, -199.5294444444443, -174.47555555555553, -185.89555555555552, -175.3077777777777, -209.54555555555552, -200.43722222222215, -188.99833333333314, -221.06222222222212, -213.19055555555542, -194.62277777777769, -210.251111111111, -186.93444444444444, -201.37611111111107, -186.78499999999988, -168.37111111111105, -197.735, -192.93666666666658, -204.79333333333327, -202.46222222222212, -211.96333333333317, -216.74944444444438, -197.8055555555555, -204.39999999999992, -201.96111111111097, -207.70555555555543, -216.03722222222206, -192.36111111111106, -196.29777777777767, -189.26055555555544, -184.5811111111112, -202.7633333333334, -198.39222222222213, -186.08555555555552, -168.3383333333334, -181.61944444444438, -203.93166666666667, -184.60944444444448, -189.7633333333333, -192.31111111111116, -205.61777777777775, -194.34111111111105, -232.8622222222221, -198.4283333333333, -213.2188888888888, -211.11388888888888, -192.77388888888888, -186.3283333333333, -184.60499999999996, -219.90888888888875, -177.06222222222215, -190.18888888888884, -187.2583333333332, -197.65555555555554, -204.2288888888889, -208.46333333333322, -185.25777777777768, -191.6666666666665, -188.52944444444438, -203.4055555555555, -179.34777777777785, -185.26388888888886, -206.7472222222221, -184.62611111111096, -215.50611111111107, -209.46888888888876, -162.87333333333333, -195.2333333333333, -207.116111111111, -188.16944444444434, -191.51444444444448, -185.27388888888885, -216.28166666666655, -190.5222222222222, -179.35944444444436, -182.7749999999999, -211.28222222222215, -186.38722222222202, -205.82166666666663, -185.37777777777774]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19064780903085982, "mean_inference_ms": 1.7591983958164013, "mean_action_processing_ms": 0.07275984545910441, "mean_env_wait_ms": 1.1899397614674883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004353523254394531, "StateBufferConnector_ms": 0.0028219223022460938, "ViewRequirementAgentConnector_ms": 0.06285858154296875}, "num_episodes": 27, "episode_return_max": -162.87333333333333, "episode_return_min": -232.8622222222221, "episode_return_mean": -197.2941333333333, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155850, "num_agent_steps_trained": 155700, "num_env_steps_sampled": 155850, "num_env_steps_trained": 155700, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 282.31068418507107, "num_env_steps_trained_throughput_per_sec": 297.1691412474432, "timesteps_total": 155850, "num_env_steps_sampled_lifetime": 155850, "num_agent_steps_sampled_lifetime": 155850, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 155850, "timers": {"training_iteration_time_ms": 10225.712, "restore_workers_time_ms": 0.011, "training_step_time_ms": 563.878, "sample_time_ms": 549.708, "synch_weights_time_ms": 12.752}, "counters": {"num_env_steps_sampled": 155850, "num_env_steps_trained": 155700, "num_agent_steps_sampled": 155850, "num_agent_steps_trained": 155700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1039, "num_samples_added_to_queue": 155700}, "done": false, "training_iteration": 51, "trial_id": "0313d_00000", "date": "2024-10-10_21-50-09", "timestamp": 1728593409, "time_this_iter_s": 10.104670763015747, "time_total_s": 523.8161714076996, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42dca560>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 523.8161714076996, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 14.059999999999999, "ram_util_percent": 56.06000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -149097.078125, "policy_loss": -149070.234375, "entropy": 29.497600555419922, "entropy_coeff": 0.01, "var_gnorm": 16.141862869262695, "vf_loss": 61660.42578125, "vf_explained_var": 0.18986159563064575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 529.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 159000, "num_env_steps_trained": 158700, "num_agent_steps_sampled": 159000, "num_agent_steps_trained": 158700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1060, "num_samples_added_to_queue": 159000, "learner_queue": {"size_count": 529, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.257, "learner_load_time_ms": 0.271, "learner_load_wait_time_ms": 957.274, "learner_dequeue_time_ms": 8113.68}}, "env_runners": {"episode_reward_max": -162.87333333333333, "episode_reward_min": -232.8622222222221, "episode_reward_mean": -194.33039999999994, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -232.8622222222221}, "policy_reward_max": {"default_policy": -162.87333333333333}, "policy_reward_mean": {"default_policy": -194.33039999999994}, "custom_metrics": {"num_consolidated_mean": 0.6833, "num_consolidated_min": 0.51, "num_consolidated_max": 0.91, "num_overloaded_mean": 0.9603, "num_overloaded_min": 0.78, "num_overloaded_max": 1.1, "num_moves_mean": 9.956999999999999, "num_moves_min": 9.68, "num_moves_max": 10.29, "mean_accuracy_mean": 40.79707666666667, "mean_accuracy_min": 40.510999999999996, "mean_accuracy_max": 41.01766666666666, "num_model_switches_mean": 5.918799999999997, "num_model_switches_min": 5.44, "num_model_switches_max": 6.25, "num_slav_mean": 0.13048783333333333, "num_slav_min": 0.11068333333333336, "num_slav_max": 0.14984999999999998, "mean_cluster_cpu_util_mean": 0.5584175639637438, "mean_cluster_cpu_util_min": 0.5296936862244898, "mean_cluster_cpu_util_max": 0.5796125842034405, "mean_cluster_mem_util_mean": 0.35996105267803324, "mean_cluster_mem_util_min": 0.3481638621587876, "mean_cluster_mem_util_max": 0.3695657399035563, "reward_consolidation_mean_mean": 0.21763888888888885, "reward_consolidation_mean_min": 0.05555555555555555, "reward_consolidation_mean_max": 0.3888888888888888, "reward_illegal_mean_mean": -1.6004999999999998, "reward_illegal_mean_min": -1.8333333333333328, "reward_illegal_mean_max": -1.2999999999999998, "reward_accuracy_mean_mean": 0.49327933333333335, "reward_accuracy_mean_min": 0.22351666666666667, "reward_accuracy_mean_max": 0.6759333333333334, "reward_sla_mean_mean": -1.0537222222222224, "reward_sla_mean_min": -1.622777777777778, "reward_sla_mean_max": -0.5161111111111111, "reward_consolidation_sum_mean": 21.763888888888886, "reward_consolidation_sum_min": 5.555555555555555, "reward_consolidation_sum_max": 38.88888888888888, "reward_illegal_sum_mean": -160.04999999999995, "reward_illegal_sum_min": -183.3333333333333, "reward_illegal_sum_max": -129.99999999999997, "reward_accuracy_sum_mean": 49.327933333333334, "reward_accuracy_sum_min": 22.351666666666667, "reward_accuracy_sum_max": 67.59333333333333, "reward_sla_sum_mean": -105.37222222222225, "reward_sla_sum_min": -162.2777777777778, "reward_sla_sum_max": -51.61111111111111, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4567.0, "global_timestep_min": 2500, "global_timestep_max": 6200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-201.37611111111107, -186.78499999999988, -168.37111111111105, -197.735, -192.93666666666658, -204.79333333333327, -202.46222222222212, -211.96333333333317, -216.74944444444438, -197.8055555555555, -204.39999999999992, -201.96111111111097, -207.70555555555543, -216.03722222222206, -192.36111111111106, -196.29777777777767, -189.26055555555544, -184.5811111111112, -202.7633333333334, -198.39222222222213, -186.08555555555552, -168.3383333333334, -181.61944444444438, -203.93166666666667, -184.60944444444448, -189.7633333333333, -192.31111111111116, -205.61777777777775, -194.34111111111105, -232.8622222222221, -198.4283333333333, -213.2188888888888, -211.11388888888888, -192.77388888888888, -186.3283333333333, -184.60499999999996, -219.90888888888875, -177.06222222222215, -190.18888888888884, -187.2583333333332, -197.65555555555554, -204.2288888888889, -208.46333333333322, -185.25777777777768, -191.6666666666665, -188.52944444444438, -203.4055555555555, -179.34777777777785, -185.26388888888886, -206.7472222222221, -184.62611111111096, -215.50611111111107, -209.46888888888876, -162.87333333333333, -195.2333333333333, -207.116111111111, -188.16944444444434, -191.51444444444448, -185.27388888888885, -216.28166666666655, -190.5222222222222, -179.35944444444436, -182.7749999999999, -211.28222222222215, -186.38722222222202, -205.82166666666663, -185.37777777777774, -187.09888888888878, -217.36444444444436, -178.60333333333338, -162.9, -194.77444444444436, -173.36833333333325, -177.8605555555555, -191.87666666666655, -208.6038888888888, -177.66277777777776, -188.16222222222217, -205.16222222222214, -193.61055555555544, -177.25888888888892, -175.39666666666668, -176.68555555555554, -192.7322222222221, -198.33277777777775, -209.23999999999992, -177.53999999999994, -199.07666666666657, -175.54444444444448, -191.97333333333327, -203.26666666666662, -178.5633333333333, -207.66444444444443, -220.18722222222212, -183.976111111111, -203.0344444444444, -196.97611111111112, -187.06055555555548, -212.2316666666666, -185.9911111111111], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-201.37611111111107, -186.78499999999988, -168.37111111111105, -197.735, -192.93666666666658, -204.79333333333327, -202.46222222222212, -211.96333333333317, -216.74944444444438, -197.8055555555555, -204.39999999999992, -201.96111111111097, -207.70555555555543, -216.03722222222206, -192.36111111111106, -196.29777777777767, -189.26055555555544, -184.5811111111112, -202.7633333333334, -198.39222222222213, -186.08555555555552, -168.3383333333334, -181.61944444444438, -203.93166666666667, -184.60944444444448, -189.7633333333333, -192.31111111111116, -205.61777777777775, -194.34111111111105, -232.8622222222221, -198.4283333333333, -213.2188888888888, -211.11388888888888, -192.77388888888888, -186.3283333333333, -184.60499999999996, -219.90888888888875, -177.06222222222215, -190.18888888888884, -187.2583333333332, -197.65555555555554, -204.2288888888889, -208.46333333333322, -185.25777777777768, -191.6666666666665, -188.52944444444438, -203.4055555555555, -179.34777777777785, -185.26388888888886, -206.7472222222221, -184.62611111111096, -215.50611111111107, -209.46888888888876, -162.87333333333333, -195.2333333333333, -207.116111111111, -188.16944444444434, -191.51444444444448, -185.27388888888885, -216.28166666666655, -190.5222222222222, -179.35944444444436, -182.7749999999999, -211.28222222222215, -186.38722222222202, -205.82166666666663, -185.37777777777774, -187.09888888888878, -217.36444444444436, -178.60333333333338, -162.9, -194.77444444444436, -173.36833333333325, -177.8605555555555, -191.87666666666655, -208.6038888888888, -177.66277777777776, -188.16222222222217, -205.16222222222214, -193.61055555555544, -177.25888888888892, -175.39666666666668, -176.68555555555554, -192.7322222222221, -198.33277777777775, -209.23999999999992, -177.53999999999994, -199.07666666666657, -175.54444444444448, -191.97333333333327, -203.26666666666662, -178.5633333333333, -207.66444444444443, -220.18722222222212, -183.976111111111, -203.0344444444444, -196.97611111111112, -187.06055555555548, -212.2316666666666, -185.9911111111111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19072468270922419, "mean_inference_ms": 1.761255970704928, "mean_action_processing_ms": 0.07278874914734886, "mean_env_wait_ms": 1.1907472551714922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043735504150390625, "StateBufferConnector_ms": 0.0028221607208251953, "ViewRequirementAgentConnector_ms": 0.06330633163452148}, "num_episodes": 33, "episode_return_max": -162.87333333333333, "episode_return_min": -232.8622222222221, "episode_return_mean": -194.33039999999994, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 159000, "num_agent_steps_trained": 158700, "num_env_steps_sampled": 159000, "num_env_steps_trained": 158700, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 296.64462976994156, "num_env_steps_trained_throughput_per_sec": 282.51869501899193, "timesteps_total": 159000, "num_env_steps_sampled_lifetime": 159000, "num_agent_steps_sampled_lifetime": 159000, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 159000, "timers": {"training_iteration_time_ms": 10245.522, "restore_workers_time_ms": 0.012, "training_step_time_ms": 515.232, "sample_time_ms": 501.838, "synch_weights_time_ms": 12.155}, "counters": {"num_env_steps_sampled": 159000, "num_env_steps_trained": 158700, "num_agent_steps_sampled": 159000, "num_agent_steps_trained": 158700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1060, "num_samples_added_to_queue": 159000}, "done": false, "training_iteration": 52, "trial_id": "0313d_00000", "date": "2024-10-10_21-50-20", "timestamp": 1728593420, "time_this_iter_s": 10.628394842147827, "time_total_s": 534.4445662498474, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42dcbc70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 534.4445662498474, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 10.34666666666667, "ram_util_percent": 57.820000000000014}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -127338.2109375, "policy_loss": -127299.75, "entropy": 29.43643569946289, "entropy_coeff": 0.01, "var_gnorm": 16.153806686401367, "vf_loss": 49850.12109375, "vf_explained_var": 0.19228553771972656}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 539.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 162000, "num_env_steps_trained": 161700, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 161700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1080, "num_samples_added_to_queue": 162000, "learner_queue": {"size_count": 539, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.714, "learner_load_time_ms": 0.24, "learner_load_wait_time_ms": 955.929, "learner_dequeue_time_ms": 8132.592}}, "env_runners": {"episode_reward_max": -153.52666666666673, "episode_reward_min": -220.18722222222212, "episode_reward_mean": -190.62287222222213, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -220.18722222222212}, "policy_reward_max": {"default_policy": -153.52666666666673}, "policy_reward_mean": {"default_policy": -190.62287222222213}, "custom_metrics": {"num_consolidated_mean": 0.682, "num_consolidated_min": 0.52, "num_consolidated_max": 0.91, "num_overloaded_mean": 0.9478, "num_overloaded_min": 0.78, "num_overloaded_max": 1.09, "num_moves_mean": 9.9489, "num_moves_min": 9.67, "num_moves_max": 10.26, "mean_accuracy_mean": 40.77744333333333, "mean_accuracy_min": 40.56799999999999, "mean_accuracy_max": 41.01766666666666, "num_model_switches_mean": 5.9047, "num_model_switches_min": 5.44, "num_model_switches_max": 6.23, "num_slav_mean": 0.12834549999999997, "num_slav_min": 0.11053333333333334, "num_slav_max": 0.14736666666666667, "mean_cluster_cpu_util_mean": 0.5564330266595506, "mean_cluster_cpu_util_min": 0.5296936862244898, "mean_cluster_cpu_util_max": 0.5757193597061427, "mean_cluster_mem_util_mean": 0.35883909149049914, "mean_cluster_mem_util_min": 0.3478674778983322, "mean_cluster_mem_util_max": 0.3670134651539941, "reward_consolidation_mean_mean": 0.22347222222222218, "reward_consolidation_mean_min": 0.08333333333333331, "reward_consolidation_mean_max": 0.3888888888888888, "reward_illegal_mean_mean": -1.5796666666666663, "reward_illegal_mean_min": -1.8166666666666669, "reward_illegal_mean_max": -1.3, "reward_accuracy_mean_mean": 0.5045434999999999, "reward_accuracy_mean_min": 0.30444999999999994, "reward_accuracy_mean_max": 0.7562333333333332, "reward_sla_mean_mean": -1.0545777777777778, "reward_sla_mean_min": -1.6816666666666669, "reward_sla_mean_max": -0.5161111111111111, "reward_consolidation_sum_mean": 22.347222222222214, "reward_consolidation_sum_min": 8.333333333333332, "reward_consolidation_sum_max": 38.88888888888888, "reward_illegal_sum_mean": -157.96666666666664, "reward_illegal_sum_min": -181.66666666666669, "reward_illegal_sum_max": -130.0, "reward_accuracy_sum_mean": 50.45435, "reward_accuracy_sum_min": 30.444999999999997, "reward_accuracy_sum_max": 75.62333333333332, "reward_sla_sum_mean": -105.45777777777779, "reward_sla_sum_min": -168.16666666666669, "reward_sla_sum_max": -51.61111111111111, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5550.0, "global_timestep_min": 3300, "global_timestep_max": 7200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-198.4283333333333, -213.2188888888888, -211.11388888888888, -192.77388888888888, -186.3283333333333, -184.60499999999996, -219.90888888888875, -177.06222222222215, -190.18888888888884, -187.2583333333332, -197.65555555555554, -204.2288888888889, -208.46333333333322, -185.25777777777768, -191.6666666666665, -188.52944444444438, -203.4055555555555, -179.34777777777785, -185.26388888888886, -206.7472222222221, -184.62611111111096, -215.50611111111107, -209.46888888888876, -162.87333333333333, -195.2333333333333, -207.116111111111, -188.16944444444434, -191.51444444444448, -185.27388888888885, -216.28166666666655, -190.5222222222222, -179.35944444444436, -182.7749999999999, -211.28222222222215, -186.38722222222202, -205.82166666666663, -185.37777777777774, -187.09888888888878, -217.36444444444436, -178.60333333333338, -162.9, -194.77444444444436, -173.36833333333325, -177.8605555555555, -191.87666666666655, -208.6038888888888, -177.66277777777776, -188.16222222222217, -205.16222222222214, -193.61055555555544, -177.25888888888892, -175.39666666666668, -176.68555555555554, -192.7322222222221, -198.33277777777775, -209.23999999999992, -177.53999999999994, -199.07666666666657, -175.54444444444448, -191.97333333333327, -203.26666666666662, -178.5633333333333, -207.66444444444443, -220.18722222222212, -183.976111111111, -203.0344444444444, -196.97611111111112, -187.06055555555548, -212.2316666666666, -185.9911111111111, -194.33888888888882, -177.37277777777777, -182.92611111111097, -213.46499999999986, -182.76500000000001, -198.04222222222222, -207.65666666666664, -184.00333333333333, -179.60055555555547, -159.8466666666667, -171.68055555555554, -204.0938888888889, -173.726111111111, -155.3477777777778, -199.83999999999992, -192.18611111111102, -195.32111111111098, -197.32777777777784, -179.86166666666657, -178.63166666666663, -179.58388888888894, -153.52666666666673, -208.95333333333323, -158.63555555555558, -176.73611111111103, -193.18944444444443, -212.45611111111106, -179.31333333333316, -167.50222222222226, -185.5344444444445], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-198.4283333333333, -213.2188888888888, -211.11388888888888, -192.77388888888888, -186.3283333333333, -184.60499999999996, -219.90888888888875, -177.06222222222215, -190.18888888888884, -187.2583333333332, -197.65555555555554, -204.2288888888889, -208.46333333333322, -185.25777777777768, -191.6666666666665, -188.52944444444438, -203.4055555555555, -179.34777777777785, -185.26388888888886, -206.7472222222221, -184.62611111111096, -215.50611111111107, -209.46888888888876, -162.87333333333333, -195.2333333333333, -207.116111111111, -188.16944444444434, -191.51444444444448, -185.27388888888885, -216.28166666666655, -190.5222222222222, -179.35944444444436, -182.7749999999999, -211.28222222222215, -186.38722222222202, -205.82166666666663, -185.37777777777774, -187.09888888888878, -217.36444444444436, -178.60333333333338, -162.9, -194.77444444444436, -173.36833333333325, -177.8605555555555, -191.87666666666655, -208.6038888888888, -177.66277777777776, -188.16222222222217, -205.16222222222214, -193.61055555555544, -177.25888888888892, -175.39666666666668, -176.68555555555554, -192.7322222222221, -198.33277777777775, -209.23999999999992, -177.53999999999994, -199.07666666666657, -175.54444444444448, -191.97333333333327, -203.26666666666662, -178.5633333333333, -207.66444444444443, -220.18722222222212, -183.976111111111, -203.0344444444444, -196.97611111111112, -187.06055555555548, -212.2316666666666, -185.9911111111111, -194.33888888888882, -177.37277777777777, -182.92611111111097, -213.46499999999986, -182.76500000000001, -198.04222222222222, -207.65666666666664, -184.00333333333333, -179.60055555555547, -159.8466666666667, -171.68055555555554, -204.0938888888889, -173.726111111111, -155.3477777777778, -199.83999999999992, -192.18611111111102, -195.32111111111098, -197.32777777777784, -179.86166666666657, -178.63166666666663, -179.58388888888894, -153.52666666666673, -208.95333333333323, -158.63555555555558, -176.73611111111103, -193.18944444444443, -212.45611111111106, -179.31333333333316, -167.50222222222226, -185.5344444444445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19070743248961042, "mean_inference_ms": 1.7603967017261777, "mean_action_processing_ms": 0.07277524975249179, "mean_env_wait_ms": 1.1907879204733605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004147768020629883, "StateBufferConnector_ms": 0.002812623977661133, "ViewRequirementAgentConnector_ms": 0.06394147872924805}, "num_episodes": 30, "episode_return_max": -153.52666666666673, "episode_return_min": -220.18722222222212, "episode_return_mean": -190.62287222222213, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 161700, "num_env_steps_sampled": 162000, "num_env_steps_trained": 161700, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 296.2799081330428, "num_env_steps_trained_throughput_per_sec": 296.2799081330428, "timesteps_total": 162000, "num_env_steps_sampled_lifetime": 162000, "num_agent_steps_sampled_lifetime": 162000, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 162000, "timers": {"training_iteration_time_ms": 10220.108, "restore_workers_time_ms": 0.011, "training_step_time_ms": 506.354, "sample_time_ms": 491.601, "synch_weights_time_ms": 13.465}, "counters": {"num_env_steps_sampled": 162000, "num_env_steps_trained": 161700, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 161700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1080, "num_samples_added_to_queue": 162000}, "done": false, "training_iteration": 53, "trial_id": "0313d_00000", "date": "2024-10-10_21-50-30", "timestamp": 1728593430, "time_this_iter_s": 10.134471654891968, "time_total_s": 544.5790379047394, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c17df0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 544.5790379047394, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 10.885714285714286, "ram_util_percent": 57.328571428571415}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -129213.0625, "policy_loss": -129171.4765625, "entropy": 29.345930099487305, "entropy_coeff": 0.01, "var_gnorm": 16.16446304321289, "vf_loss": 46450.69140625, "vf_explained_var": 0.26900410652160645}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 549.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 164850, "num_env_steps_trained": 164700, "num_agent_steps_sampled": 164850, "num_agent_steps_trained": 164700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1099, "num_samples_added_to_queue": 164700, "learner_queue": {"size_count": 549, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 64.643, "learner_load_time_ms": 0.252, "learner_load_wait_time_ms": 1009.223, "learner_dequeue_time_ms": 8132.452}}, "env_runners": {"episode_reward_max": -147.975, "episode_reward_min": -226.58666666666667, "episode_reward_mean": -187.07113333333325, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -226.58666666666667}, "policy_reward_max": {"default_policy": -147.975}, "policy_reward_mean": {"default_policy": -187.07113333333325}, "custom_metrics": {"num_consolidated_mean": 0.6878, "num_consolidated_min": 0.52, "num_consolidated_max": 0.91, "num_overloaded_mean": 0.9338000000000001, "num_overloaded_min": 0.78, "num_overloaded_max": 1.08, "num_moves_mean": 9.9524, "num_moves_min": 9.67, "num_moves_max": 10.26, "mean_accuracy_mean": 40.749069999999996, "mean_accuracy_min": 40.434999999999995, "mean_accuracy_max": 40.97966666666666, "num_model_switches_mean": 5.8872, "num_model_switches_min": 5.44, "num_model_switches_max": 6.23, "num_slav_mean": 0.12555166666666667, "num_slav_min": 0.10713333333333333, "num_slav_max": 0.1424, "mean_cluster_cpu_util_mean": 0.5552084006628033, "mean_cluster_cpu_util_min": 0.5296936862244898, "mean_cluster_cpu_util_max": 0.5757193597061427, "mean_cluster_mem_util_mean": 0.3582279134411149, "mean_cluster_mem_util_min": 0.3478674778983322, "mean_cluster_mem_util_max": 0.36696567119463813, "reward_consolidation_mean_mean": 0.22944444444444442, "reward_consolidation_mean_min": 0.08333333333333331, "reward_consolidation_mean_max": 0.3888888888888888, "reward_illegal_mean_mean": -1.556333333333333, "reward_illegal_mean_min": -1.7999999999999998, "reward_illegal_mean_max": -1.3, "reward_accuracy_mean_mean": 0.5189053333333333, "reward_accuracy_mean_min": 0.30444999999999994, "reward_accuracy_mean_max": 0.7562333333333332, "reward_sla_mean_mean": -1.0627277777777777, "reward_sla_mean_min": -1.6816666666666669, "reward_sla_mean_max": -0.5161111111111111, "reward_consolidation_sum_mean": 22.944444444444443, "reward_consolidation_sum_min": 8.333333333333332, "reward_consolidation_sum_max": 38.88888888888888, "reward_illegal_sum_mean": -155.6333333333333, "reward_illegal_sum_min": -179.99999999999997, "reward_illegal_sum_max": -130.0, "reward_accuracy_sum_mean": 51.89053333333333, "reward_accuracy_sum_min": 30.444999999999997, "reward_accuracy_sum_max": 75.62333333333332, "reward_sla_sum_mean": -106.27277777777776, "reward_sla_sum_min": -168.16666666666669, "reward_sla_sum_max": -51.61111111111111, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5757.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-191.51444444444448, -185.27388888888885, -216.28166666666655, -190.5222222222222, -179.35944444444436, -182.7749999999999, -211.28222222222215, -186.38722222222202, -205.82166666666663, -185.37777777777774, -187.09888888888878, -217.36444444444436, -178.60333333333338, -162.9, -194.77444444444436, -173.36833333333325, -177.8605555555555, -191.87666666666655, -208.6038888888888, -177.66277777777776, -188.16222222222217, -205.16222222222214, -193.61055555555544, -177.25888888888892, -175.39666666666668, -176.68555555555554, -192.7322222222221, -198.33277777777775, -209.23999999999992, -177.53999999999994, -199.07666666666657, -175.54444444444448, -191.97333333333327, -203.26666666666662, -178.5633333333333, -207.66444444444443, -220.18722222222212, -183.976111111111, -203.0344444444444, -196.97611111111112, -187.06055555555548, -212.2316666666666, -185.9911111111111, -194.33888888888882, -177.37277777777777, -182.92611111111097, -213.46499999999986, -182.76500000000001, -198.04222222222222, -207.65666666666664, -184.00333333333333, -179.60055555555547, -159.8466666666667, -171.68055555555554, -204.0938888888889, -173.726111111111, -155.3477777777778, -199.83999999999992, -192.18611111111102, -195.32111111111098, -197.32777777777784, -179.86166666666657, -178.63166666666663, -179.58388888888894, -153.52666666666673, -208.95333333333323, -158.63555555555558, -176.73611111111103, -193.18944444444443, -212.45611111111106, -179.31333333333316, -167.50222222222226, -185.5344444444445, -180.6872222222222, -214.6233333333333, -190.6466666666665, -188.6933333333333, -188.49777777777763, -181.26444444444436, -184.53833333333327, -156.79888888888888, -196.5705555555555, -182.6744444444443, -168.36222222222224, -172.77222222222213, -190.13222222222225, -167.12444444444432, -187.5533333333333, -166.89444444444445, -147.975, -163.55388888888888, -226.58666666666667, -197.20888888888882, -184.63111111111115, -193.3888888888888, -169.86111111111106, -199.0355555555555, -165.4144444444443, -189.94555555555542, -163.83722222222224], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-191.51444444444448, -185.27388888888885, -216.28166666666655, -190.5222222222222, -179.35944444444436, -182.7749999999999, -211.28222222222215, -186.38722222222202, -205.82166666666663, -185.37777777777774, -187.09888888888878, -217.36444444444436, -178.60333333333338, -162.9, -194.77444444444436, -173.36833333333325, -177.8605555555555, -191.87666666666655, -208.6038888888888, -177.66277777777776, -188.16222222222217, -205.16222222222214, -193.61055555555544, -177.25888888888892, -175.39666666666668, -176.68555555555554, -192.7322222222221, -198.33277777777775, -209.23999999999992, -177.53999999999994, -199.07666666666657, -175.54444444444448, -191.97333333333327, -203.26666666666662, -178.5633333333333, -207.66444444444443, -220.18722222222212, -183.976111111111, -203.0344444444444, -196.97611111111112, -187.06055555555548, -212.2316666666666, -185.9911111111111, -194.33888888888882, -177.37277777777777, -182.92611111111097, -213.46499999999986, -182.76500000000001, -198.04222222222222, -207.65666666666664, -184.00333333333333, -179.60055555555547, -159.8466666666667, -171.68055555555554, -204.0938888888889, -173.726111111111, -155.3477777777778, -199.83999999999992, -192.18611111111102, -195.32111111111098, -197.32777777777784, -179.86166666666657, -178.63166666666663, -179.58388888888894, -153.52666666666673, -208.95333333333323, -158.63555555555558, -176.73611111111103, -193.18944444444443, -212.45611111111106, -179.31333333333316, -167.50222222222226, -185.5344444444445, -180.6872222222222, -214.6233333333333, -190.6466666666665, -188.6933333333333, -188.49777777777763, -181.26444444444436, -184.53833333333327, -156.79888888888888, -196.5705555555555, -182.6744444444443, -168.36222222222224, -172.77222222222213, -190.13222222222225, -167.12444444444432, -187.5533333333333, -166.89444444444445, -147.975, -163.55388888888888, -226.58666666666667, -197.20888888888882, -184.63111111111115, -193.3888888888888, -169.86111111111106, -199.0355555555555, -165.4144444444443, -189.94555555555542, -163.83722222222224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19080634554319295, "mean_inference_ms": 1.7613040404663411, "mean_action_processing_ms": 0.07280752167707068, "mean_env_wait_ms": 1.1914697169064281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00416111946105957, "StateBufferConnector_ms": 0.002894878387451172, "ViewRequirementAgentConnector_ms": 0.06619954109191895}, "num_episodes": 27, "episode_return_max": -147.975, "episode_return_min": -226.58666666666667, "episode_return_mean": -187.07113333333325, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164850, "num_agent_steps_trained": 164700, "num_env_steps_sampled": 164850, "num_env_steps_trained": 164700, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 276.565022137665, "num_env_steps_trained_throughput_per_sec": 291.1210759343842, "timesteps_total": 164850, "num_env_steps_sampled_lifetime": 164850, "num_agent_steps_sampled_lifetime": 164850, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 164850, "timers": {"training_iteration_time_ms": 10236.375, "restore_workers_time_ms": 0.012, "training_step_time_ms": 565.172, "sample_time_ms": 548.391, "synch_weights_time_ms": 15.16}, "counters": {"num_env_steps_sampled": 164850, "num_env_steps_trained": 164700, "num_agent_steps_sampled": 164850, "num_agent_steps_trained": 164700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1099, "num_samples_added_to_queue": 164700}, "done": false, "training_iteration": 54, "trial_id": "0313d_00000", "date": "2024-10-10_21-50-40", "timestamp": 1728593440, "time_this_iter_s": 10.316950559616089, "time_total_s": 554.8959884643555, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c15f90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 554.8959884643555, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 13.273333333333333, "ram_util_percent": 57.386666666666656}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -117698.3203125, "policy_loss": -117650.65625, "entropy": 29.33148193359375, "entropy_coeff": 0.01, "var_gnorm": 16.171993255615234, "vf_loss": 40330.21875, "vf_explained_var": 0.2680904269218445}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 559.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 167850, "num_env_steps_trained": 167700, "num_agent_steps_sampled": 167850, "num_agent_steps_trained": 167700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1119, "num_samples_added_to_queue": 167700, "learner_queue": {"size_count": 559, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.76, "learner_load_time_ms": 0.251, "learner_load_wait_time_ms": 1000.701, "learner_dequeue_time_ms": 8174.054}}, "env_runners": {"episode_reward_max": -147.975, "episode_reward_min": -226.58666666666667, "episode_reward_mean": -182.99432222222214, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -226.58666666666667}, "policy_reward_max": {"default_policy": -147.975}, "policy_reward_mean": {"default_policy": -182.99432222222214}, "custom_metrics": {"num_consolidated_mean": 0.6925, "num_consolidated_min": 0.52, "num_consolidated_max": 0.91, "num_overloaded_mean": 0.9138999999999998, "num_overloaded_min": 0.76, "num_overloaded_max": 1.08, "num_moves_mean": 9.9353, "num_moves_min": 9.58, "num_moves_max": 10.26, "mean_accuracy_mean": 40.70283666666666, "mean_accuracy_min": 40.352666666666664, "mean_accuracy_max": 40.960666666666654, "num_model_switches_mean": 5.889999999999998, "num_model_switches_min": 5.56, "num_model_switches_max": 6.23, "num_slav_mean": 0.12294350000000001, "num_slav_min": 0.10078333333333335, "num_slav_max": 0.14148333333333335, "mean_cluster_cpu_util_mean": 0.5528124860306834, "mean_cluster_cpu_util_min": 0.535548799497393, "mean_cluster_cpu_util_max": 0.5757193597061427, "mean_cluster_mem_util_mean": 0.35717277231873756, "mean_cluster_mem_util_min": 0.3478674778983322, "mean_cluster_mem_util_max": 0.36696567119463813, "reward_consolidation_mean_mean": 0.24374999999999997, "reward_consolidation_mean_min": 0.09722222222222221, "reward_consolidation_mean_max": 0.3888888888888888, "reward_illegal_mean_mean": -1.5231666666666666, "reward_illegal_mean_min": -1.7999999999999998, "reward_illegal_mean_max": -1.2666666666666664, "reward_accuracy_mean_mean": 0.5364123333333333, "reward_accuracy_mean_min": 0.3246833333333333, "reward_accuracy_mean_max": 0.7669666666666666, "reward_sla_mean_mean": -1.0869388888888891, "reward_sla_mean_min": -1.7094444444444445, "reward_sla_mean_max": -0.5638888888888889, "reward_consolidation_sum_mean": 24.375, "reward_consolidation_sum_min": 9.722222222222221, "reward_consolidation_sum_max": 38.88888888888888, "reward_illegal_sum_mean": -152.31666666666663, "reward_illegal_sum_min": -179.99999999999997, "reward_illegal_sum_max": -126.66666666666664, "reward_accuracy_sum_mean": 53.64123333333334, "reward_accuracy_sum_min": 32.468333333333334, "reward_accuracy_sum_max": 76.69666666666666, "reward_sla_sum_mean": -108.69388888888889, "reward_sla_sum_min": -170.94444444444446, "reward_sla_sum_max": -56.388888888888886, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4407.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-199.07666666666657, -175.54444444444448, -191.97333333333327, -203.26666666666662, -178.5633333333333, -207.66444444444443, -220.18722222222212, -183.976111111111, -203.0344444444444, -196.97611111111112, -187.06055555555548, -212.2316666666666, -185.9911111111111, -194.33888888888882, -177.37277777777777, -182.92611111111097, -213.46499999999986, -182.76500000000001, -198.04222222222222, -207.65666666666664, -184.00333333333333, -179.60055555555547, -159.8466666666667, -171.68055555555554, -204.0938888888889, -173.726111111111, -155.3477777777778, -199.83999999999992, -192.18611111111102, -195.32111111111098, -197.32777777777784, -179.86166666666657, -178.63166666666663, -179.58388888888894, -153.52666666666673, -208.95333333333323, -158.63555555555558, -176.73611111111103, -193.18944444444443, -212.45611111111106, -179.31333333333316, -167.50222222222226, -185.5344444444445, -180.6872222222222, -214.6233333333333, -190.6466666666665, -188.6933333333333, -188.49777777777763, -181.26444444444436, -184.53833333333327, -156.79888888888888, -196.5705555555555, -182.6744444444443, -168.36222222222224, -172.77222222222213, -190.13222222222225, -167.12444444444432, -187.5533333333333, -166.89444444444445, -147.975, -163.55388888888888, -226.58666666666667, -197.20888888888882, -184.63111111111115, -193.3888888888888, -169.86111111111106, -199.0355555555555, -165.4144444444443, -189.94555555555542, -163.83722222222224, -183.66555555555553, -179.3827777777777, -171.2922222222223, -207.192222222222, -166.47444444444437, -170.45055555555555, -191.0894444444444, -182.99833333333333, -169.43111111111108, -180.5694444444444, -189.05111111111108, -149.24777777777777, -186.14944444444438, -179.5672222222222, -159.1633333333334, -157.76722222222224, -196.4055555555555, -168.601111111111, -175.88055555555542, -158.0822222222221, -184.00944444444437, -150.94111111111118, -168.4016666666666, -201.97499999999997, -198.67444444444453, -168.1711111111112, -187.9255555555555, -179.385, -159.75888888888895, -169.44499999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-199.07666666666657, -175.54444444444448, -191.97333333333327, -203.26666666666662, -178.5633333333333, -207.66444444444443, -220.18722222222212, -183.976111111111, -203.0344444444444, -196.97611111111112, -187.06055555555548, -212.2316666666666, -185.9911111111111, -194.33888888888882, -177.37277777777777, -182.92611111111097, -213.46499999999986, -182.76500000000001, -198.04222222222222, -207.65666666666664, -184.00333333333333, -179.60055555555547, -159.8466666666667, -171.68055555555554, -204.0938888888889, -173.726111111111, -155.3477777777778, -199.83999999999992, -192.18611111111102, -195.32111111111098, -197.32777777777784, -179.86166666666657, -178.63166666666663, -179.58388888888894, -153.52666666666673, -208.95333333333323, -158.63555555555558, -176.73611111111103, -193.18944444444443, -212.45611111111106, -179.31333333333316, -167.50222222222226, -185.5344444444445, -180.6872222222222, -214.6233333333333, -190.6466666666665, -188.6933333333333, -188.49777777777763, -181.26444444444436, -184.53833333333327, -156.79888888888888, -196.5705555555555, -182.6744444444443, -168.36222222222224, -172.77222222222213, -190.13222222222225, -167.12444444444432, -187.5533333333333, -166.89444444444445, -147.975, -163.55388888888888, -226.58666666666667, -197.20888888888882, -184.63111111111115, -193.3888888888888, -169.86111111111106, -199.0355555555555, -165.4144444444443, -189.94555555555542, -163.83722222222224, -183.66555555555553, -179.3827777777777, -171.2922222222223, -207.192222222222, -166.47444444444437, -170.45055555555555, -191.0894444444444, -182.99833333333333, -169.43111111111108, -180.5694444444444, -189.05111111111108, -149.24777777777777, -186.14944444444438, -179.5672222222222, -159.1633333333334, -157.76722222222224, -196.4055555555555, -168.601111111111, -175.88055555555542, -158.0822222222221, -184.00944444444437, -150.94111111111118, -168.4016666666666, -201.97499999999997, -198.67444444444453, -168.1711111111112, -187.9255555555555, -179.385, -159.75888888888895, -169.44499999999996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19091769395292474, "mean_inference_ms": 1.7606766356811232, "mean_action_processing_ms": 0.07283620286741303, "mean_env_wait_ms": 1.1919789120015891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004401206970214844, "StateBufferConnector_ms": 0.0030138492584228516, "ViewRequirementAgentConnector_ms": 0.0688941478729248}, "num_episodes": 30, "episode_return_max": -147.975, "episode_return_min": -226.58666666666667, "episode_return_mean": -182.99432222222214, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 167850, "num_agent_steps_trained": 167700, "num_env_steps_sampled": 167850, "num_env_steps_trained": 167700, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 285.986660196106, "num_env_steps_trained_throughput_per_sec": 285.986660196106, "timesteps_total": 167850, "num_env_steps_sampled_lifetime": 167850, "num_agent_steps_sampled_lifetime": 167850, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 167850, "timers": {"training_iteration_time_ms": 10276.574, "restore_workers_time_ms": 0.012, "training_step_time_ms": 546.013, "sample_time_ms": 530.743, "synch_weights_time_ms": 13.885}, "counters": {"num_env_steps_sampled": 167850, "num_env_steps_trained": 167700, "num_agent_steps_sampled": 167850, "num_agent_steps_trained": 167700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1119, "num_samples_added_to_queue": 167700}, "done": false, "training_iteration": 55, "trial_id": "0313d_00000", "date": "2024-10-10_21-50-51", "timestamp": 1728593451, "time_this_iter_s": 10.504141330718994, "time_total_s": 565.4001297950745, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d8a230>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 565.4001297950745, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 13.226666666666668, "ram_util_percent": 57.46}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -108824.890625, "policy_loss": -108774.0546875, "entropy": 29.271635055541992, "entropy_coeff": 0.01, "var_gnorm": 16.18349838256836, "vf_loss": 36977.1796875, "vf_explained_var": 0.2578158378601074}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 568.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 170700, "num_env_steps_trained": 170400, "num_agent_steps_sampled": 170700, "num_agent_steps_trained": 170400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1138, "num_samples_added_to_queue": 170700, "learner_queue": {"size_count": 568, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.67, "learner_load_time_ms": 0.25, "learner_load_wait_time_ms": 1002.115, "learner_dequeue_time_ms": 8308.988}}, "env_runners": {"episode_reward_max": -143.76111111111118, "episode_reward_min": -226.58666666666667, "episode_reward_mean": -179.55217777777776, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -226.58666666666667}, "policy_reward_max": {"default_policy": -143.76111111111118}, "policy_reward_mean": {"default_policy": -179.55217777777776}, "custom_metrics": {"num_consolidated_mean": 0.6875000000000001, "num_consolidated_min": 0.52, "num_consolidated_max": 0.86, "num_overloaded_mean": 0.9048000000000002, "num_overloaded_min": 0.64, "num_overloaded_max": 1.08, "num_moves_mean": 9.916800000000002, "num_moves_min": 9.56, "num_moves_max": 10.26, "mean_accuracy_mean": 40.66040333333333, "mean_accuracy_min": 40.352666666666664, "mean_accuracy_max": 40.88466666666667, "num_model_switches_mean": 5.8631, "num_model_switches_min": 5.33, "num_model_switches_max": 6.23, "num_slav_mean": 0.11931083333333331, "num_slav_min": 0.10078333333333335, "num_slav_max": 0.13735, "mean_cluster_cpu_util_mean": 0.5505114288294123, "mean_cluster_cpu_util_min": 0.5330574796738818, "mean_cluster_cpu_util_max": 0.5757193597061427, "mean_cluster_mem_util_mean": 0.3562177022804902, "mean_cluster_mem_util_min": 0.34610768427624206, "mean_cluster_mem_util_max": 0.36696567119463813, "reward_consolidation_mean_mean": 0.24569444444444444, "reward_consolidation_mean_min": 0.08333333333333331, "reward_consolidation_mean_max": 0.5, "reward_illegal_mean_mean": -1.5079999999999998, "reward_illegal_mean_min": -1.7999999999999998, "reward_illegal_mean_max": -1.0666666666666667, "reward_accuracy_mean_mean": 0.5489559999999999, "reward_accuracy_mean_min": 0.34269999999999995, "reward_accuracy_mean_max": 0.9149333333333332, "reward_sla_mean_mean": -1.082172222222222, "reward_sla_mean_min": -2.0216666666666665, "reward_sla_mean_max": -0.5444444444444444, "reward_consolidation_sum_mean": 24.569444444444443, "reward_consolidation_sum_min": 8.333333333333332, "reward_consolidation_sum_max": 50.0, "reward_illegal_sum_mean": -150.79999999999998, "reward_illegal_sum_min": -179.99999999999997, "reward_illegal_sum_max": -106.66666666666666, "reward_accuracy_sum_mean": 54.89559999999999, "reward_accuracy_sum_min": 34.269999999999996, "reward_accuracy_sum_max": 91.49333333333331, "reward_sla_sum_mean": -108.2172222222222, "reward_sla_sum_min": -202.16666666666666, "reward_sla_sum_max": -54.44444444444444, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3075.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-197.32777777777784, -179.86166666666657, -178.63166666666663, -179.58388888888894, -153.52666666666673, -208.95333333333323, -158.63555555555558, -176.73611111111103, -193.18944444444443, -212.45611111111106, -179.31333333333316, -167.50222222222226, -185.5344444444445, -180.6872222222222, -214.6233333333333, -190.6466666666665, -188.6933333333333, -188.49777777777763, -181.26444444444436, -184.53833333333327, -156.79888888888888, -196.5705555555555, -182.6744444444443, -168.36222222222224, -172.77222222222213, -190.13222222222225, -167.12444444444432, -187.5533333333333, -166.89444444444445, -147.975, -163.55388888888888, -226.58666666666667, -197.20888888888882, -184.63111111111115, -193.3888888888888, -169.86111111111106, -199.0355555555555, -165.4144444444443, -189.94555555555542, -163.83722222222224, -183.66555555555553, -179.3827777777777, -171.2922222222223, -207.192222222222, -166.47444444444437, -170.45055555555555, -191.0894444444444, -182.99833333333333, -169.43111111111108, -180.5694444444444, -189.05111111111108, -149.24777777777777, -186.14944444444438, -179.5672222222222, -159.1633333333334, -157.76722222222224, -196.4055555555555, -168.601111111111, -175.88055555555542, -158.0822222222221, -184.00944444444437, -150.94111111111118, -168.4016666666666, -201.97499999999997, -198.67444444444453, -168.1711111111112, -187.9255555555555, -179.385, -159.75888888888895, -169.44499999999996, -181.22499999999994, -187.34166666666667, -179.62388888888884, -167.96222222222218, -181.9255555555555, -194.78166666666655, -191.22499999999982, -189.88611111111103, -170.51666666666665, -173.21999999999997, -167.93555555555554, -143.76111111111118, -170.99499999999998, -169.911111111111, -213.07555555555555, -168.36222222222207, -210.23333333333332, -184.83499999999992, -186.51277777777764, -156.8716666666667, -190.35333333333344, -195.25722222222208, -198.62999999999994, -160.9755555555555, -162.8222222222222, -181.18833333333328, -178.08777777777772, -167.33999999999997, -162.8983333333333, -185.7905555555556], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-197.32777777777784, -179.86166666666657, -178.63166666666663, -179.58388888888894, -153.52666666666673, -208.95333333333323, -158.63555555555558, -176.73611111111103, -193.18944444444443, -212.45611111111106, -179.31333333333316, -167.50222222222226, -185.5344444444445, -180.6872222222222, -214.6233333333333, -190.6466666666665, -188.6933333333333, -188.49777777777763, -181.26444444444436, -184.53833333333327, -156.79888888888888, -196.5705555555555, -182.6744444444443, -168.36222222222224, -172.77222222222213, -190.13222222222225, -167.12444444444432, -187.5533333333333, -166.89444444444445, -147.975, -163.55388888888888, -226.58666666666667, -197.20888888888882, -184.63111111111115, -193.3888888888888, -169.86111111111106, -199.0355555555555, -165.4144444444443, -189.94555555555542, -163.83722222222224, -183.66555555555553, -179.3827777777777, -171.2922222222223, -207.192222222222, -166.47444444444437, -170.45055555555555, -191.0894444444444, -182.99833333333333, -169.43111111111108, -180.5694444444444, -189.05111111111108, -149.24777777777777, -186.14944444444438, -179.5672222222222, -159.1633333333334, -157.76722222222224, -196.4055555555555, -168.601111111111, -175.88055555555542, -158.0822222222221, -184.00944444444437, -150.94111111111118, -168.4016666666666, -201.97499999999997, -198.67444444444453, -168.1711111111112, -187.9255555555555, -179.385, -159.75888888888895, -169.44499999999996, -181.22499999999994, -187.34166666666667, -179.62388888888884, -167.96222222222218, -181.9255555555555, -194.78166666666655, -191.22499999999982, -189.88611111111103, -170.51666666666665, -173.21999999999997, -167.93555555555554, -143.76111111111118, -170.99499999999998, -169.911111111111, -213.07555555555555, -168.36222222222207, -210.23333333333332, -184.83499999999992, -186.51277777777764, -156.8716666666667, -190.35333333333344, -195.25722222222208, -198.62999999999994, -160.9755555555555, -162.8222222222222, -181.18833333333328, -178.08777777777772, -167.33999999999997, -162.8983333333333, -185.7905555555556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19118226602650645, "mean_inference_ms": 1.761801377944745, "mean_action_processing_ms": 0.0729194823625736, "mean_env_wait_ms": 1.1931523012787792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004649639129638672, "StateBufferConnector_ms": 0.0030870437622070312, "ViewRequirementAgentConnector_ms": 0.07110285758972168}, "num_episodes": 30, "episode_return_max": -143.76111111111118, "episode_return_min": -226.58666666666667, "episode_return_mean": -179.55217777777776, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 170700, "num_agent_steps_trained": 170400, "num_env_steps_sampled": 170700, "num_env_steps_trained": 170400, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 283.358161831014, "num_env_steps_trained_throughput_per_sec": 268.44457436622383, "timesteps_total": 170700, "num_env_steps_sampled_lifetime": 170700, "num_agent_steps_sampled_lifetime": 170700, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 170700, "timers": {"training_iteration_time_ms": 10257.137, "restore_workers_time_ms": 0.012, "training_step_time_ms": 526.411, "sample_time_ms": 511.435, "synch_weights_time_ms": 13.573}, "counters": {"num_env_steps_sampled": 170700, "num_env_steps_trained": 170400, "num_agent_steps_sampled": 170700, "num_agent_steps_trained": 170400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1138, "num_samples_added_to_queue": 170700}, "done": false, "training_iteration": 56, "trial_id": "0313d_00000", "date": "2024-10-10_21-51-01", "timestamp": 1728593461, "time_this_iter_s": 10.072941541671753, "time_total_s": 575.4730713367462, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42dc8d30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 575.4730713367462, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 13.16, "ram_util_percent": 58.053333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -98715.453125, "policy_loss": -98657.0625, "entropy": 29.213916778564453, "entropy_coeff": 0.01, "var_gnorm": 16.19703483581543, "vf_loss": 29252.544921875, "vf_explained_var": 0.32367104291915894}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 578.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 173550, "num_env_steps_trained": 173400, "num_agent_steps_sampled": 173550, "num_agent_steps_trained": 173400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1157, "num_samples_added_to_queue": 173400, "learner_queue": {"size_count": 578, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.459, "learner_load_time_ms": 0.257, "learner_load_wait_time_ms": 989.457, "learner_dequeue_time_ms": 8336.723}}, "env_runners": {"episode_reward_max": -140.65388888888893, "episode_reward_min": -226.58666666666667, "episode_reward_mean": -177.16856111111113, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -226.58666666666667}, "policy_reward_max": {"default_policy": -140.65388888888893}, "policy_reward_mean": {"default_policy": -177.16856111111113}, "custom_metrics": {"num_consolidated_mean": 0.6914999999999999, "num_consolidated_min": 0.56, "num_consolidated_max": 0.87, "num_overloaded_mean": 0.8987999999999999, "num_overloaded_min": 0.64, "num_overloaded_max": 1.03, "num_moves_mean": 9.8992, "num_moves_min": 9.56, "num_moves_max": 10.23, "mean_accuracy_mean": 40.63202999999999, "mean_accuracy_min": 40.352666666666664, "mean_accuracy_max": 40.916333333333334, "num_model_switches_mean": 5.8355, "num_model_switches_min": 5.31, "num_model_switches_max": 6.23, "num_slav_mean": 0.11627349999999997, "num_slav_min": 0.09830000000000001, "num_slav_max": 0.13455, "mean_cluster_cpu_util_mean": 0.5501241527451601, "mean_cluster_cpu_util_min": 0.5330574796738818, "mean_cluster_cpu_util_max": 0.5731552049812714, "mean_cluster_mem_util_mean": 0.35603016667563653, "mean_cluster_mem_util_min": 0.34610768427624206, "mean_cluster_mem_util_max": 0.36520779711673707, "reward_consolidation_mean_mean": 0.2483333333333333, "reward_consolidation_mean_min": 0.08333333333333331, "reward_consolidation_mean_max": 0.5, "reward_illegal_mean_mean": -1.4979999999999998, "reward_illegal_mean_min": -1.7166666666666668, "reward_illegal_mean_max": -1.0666666666666667, "reward_accuracy_mean_mean": 0.5574255, "reward_accuracy_mean_min": 0.3635666666666666, "reward_accuracy_mean_max": 0.9149333333333332, "reward_sla_mean_mean": -1.0794444444444447, "reward_sla_mean_min": -2.0216666666666665, "reward_sla_mean_max": -0.5444444444444444, "reward_consolidation_sum_mean": 24.83333333333334, "reward_consolidation_sum_min": 8.333333333333332, "reward_consolidation_sum_max": 50.0, "reward_illegal_sum_mean": -149.79999999999998, "reward_illegal_sum_min": -171.66666666666669, "reward_illegal_sum_max": -106.66666666666666, "reward_accuracy_sum_mean": 55.742549999999994, "reward_accuracy_sum_min": 36.35666666666666, "reward_accuracy_sum_max": 91.49333333333331, "reward_sla_sum_mean": -107.94444444444447, "reward_sla_sum_min": -202.16666666666666, "reward_sla_sum_max": -54.44444444444444, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2109.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-187.5533333333333, -166.89444444444445, -147.975, -163.55388888888888, -226.58666666666667, -197.20888888888882, -184.63111111111115, -193.3888888888888, -169.86111111111106, -199.0355555555555, -165.4144444444443, -189.94555555555542, -163.83722222222224, -183.66555555555553, -179.3827777777777, -171.2922222222223, -207.192222222222, -166.47444444444437, -170.45055555555555, -191.0894444444444, -182.99833333333333, -169.43111111111108, -180.5694444444444, -189.05111111111108, -149.24777777777777, -186.14944444444438, -179.5672222222222, -159.1633333333334, -157.76722222222224, -196.4055555555555, -168.601111111111, -175.88055555555542, -158.0822222222221, -184.00944444444437, -150.94111111111118, -168.4016666666666, -201.97499999999997, -198.67444444444453, -168.1711111111112, -187.9255555555555, -179.385, -159.75888888888895, -169.44499999999996, -181.22499999999994, -187.34166666666667, -179.62388888888884, -167.96222222222218, -181.9255555555555, -194.78166666666655, -191.22499999999982, -189.88611111111103, -170.51666666666665, -173.21999999999997, -167.93555555555554, -143.76111111111118, -170.99499999999998, -169.911111111111, -213.07555555555555, -168.36222222222207, -210.23333333333332, -184.83499999999992, -186.51277777777764, -156.8716666666667, -190.35333333333344, -195.25722222222208, -198.62999999999994, -160.9755555555555, -162.8222222222222, -181.18833333333328, -178.08777777777772, -167.33999999999997, -162.8983333333333, -185.7905555555556, -197.25888888888883, -140.65388888888893, -185.65333333333322, -173.3383333333333, -174.83833333333328, -183.2511111111111, -170.58555555555543, -151.25999999999996, -151.66388888888892, -155.41222222222223, -188.1105555555556, -173.94999999999996, -173.48111111111106, -165.42611111111094, -194.3927777777776, -154.98277777777778, -182.40111111111108, -149.40055555555554, -199.97166666666664, -185.7683333333333, -172.77611111111113, -202.6372222222222, -177.92166666666654, -192.185, -156.32277777777767, -178.23444444444442, -164.39888888888885], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-187.5533333333333, -166.89444444444445, -147.975, -163.55388888888888, -226.58666666666667, -197.20888888888882, -184.63111111111115, -193.3888888888888, -169.86111111111106, -199.0355555555555, -165.4144444444443, -189.94555555555542, -163.83722222222224, -183.66555555555553, -179.3827777777777, -171.2922222222223, -207.192222222222, -166.47444444444437, -170.45055555555555, -191.0894444444444, -182.99833333333333, -169.43111111111108, -180.5694444444444, -189.05111111111108, -149.24777777777777, -186.14944444444438, -179.5672222222222, -159.1633333333334, -157.76722222222224, -196.4055555555555, -168.601111111111, -175.88055555555542, -158.0822222222221, -184.00944444444437, -150.94111111111118, -168.4016666666666, -201.97499999999997, -198.67444444444453, -168.1711111111112, -187.9255555555555, -179.385, -159.75888888888895, -169.44499999999996, -181.22499999999994, -187.34166666666667, -179.62388888888884, -167.96222222222218, -181.9255555555555, -194.78166666666655, -191.22499999999982, -189.88611111111103, -170.51666666666665, -173.21999999999997, -167.93555555555554, -143.76111111111118, -170.99499999999998, -169.911111111111, -213.07555555555555, -168.36222222222207, -210.23333333333332, -184.83499999999992, -186.51277777777764, -156.8716666666667, -190.35333333333344, -195.25722222222208, -198.62999999999994, -160.9755555555555, -162.8222222222222, -181.18833333333328, -178.08777777777772, -167.33999999999997, -162.8983333333333, -185.7905555555556, -197.25888888888883, -140.65388888888893, -185.65333333333322, -173.3383333333333, -174.83833333333328, -183.2511111111111, -170.58555555555543, -151.25999999999996, -151.66388888888892, -155.41222222222223, -188.1105555555556, -173.94999999999996, -173.48111111111106, -165.42611111111094, -194.3927777777776, -154.98277777777778, -182.40111111111108, -149.40055555555554, -199.97166666666664, -185.7683333333333, -172.77611111111113, -202.6372222222222, -177.92166666666654, -192.185, -156.32277777777767, -178.23444444444442, -164.39888888888885]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19140961569263212, "mean_inference_ms": 1.7628726088966522, "mean_action_processing_ms": 0.0729923055065135, "mean_env_wait_ms": 1.1942070945364034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004706859588623047, "StateBufferConnector_ms": 0.003082752227783203, "ViewRequirementAgentConnector_ms": 0.07146811485290527}, "num_episodes": 27, "episode_return_max": -140.65388888888893, "episode_return_min": -226.58666666666667, "episode_return_mean": -177.16856111111113, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 173550, "num_agent_steps_trained": 173400, "num_env_steps_sampled": 173550, "num_env_steps_trained": 173400, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 284.711887565712, "num_env_steps_trained_throughput_per_sec": 299.69672375338104, "timesteps_total": 173550, "num_env_steps_sampled_lifetime": 173550, "num_agent_steps_sampled_lifetime": 173550, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 173550, "timers": {"training_iteration_time_ms": 10238.418, "restore_workers_time_ms": 0.012, "training_step_time_ms": 535.353, "sample_time_ms": 520.531, "synch_weights_time_ms": 13.513}, "counters": {"num_env_steps_sampled": 173550, "num_env_steps_trained": 173400, "num_agent_steps_sampled": 173550, "num_agent_steps_trained": 173400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1157, "num_samples_added_to_queue": 173400}, "done": false, "training_iteration": 57, "trial_id": "0313d_00000", "date": "2024-10-10_21-51-11", "timestamp": 1728593471, "time_this_iter_s": 10.029214143753052, "time_total_s": 585.5022854804993, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c19180>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 585.5022854804993, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 12.392857142857142, "ram_util_percent": 58.12857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -96951.421875, "policy_loss": -96893.3671875, "entropy": 29.12653923034668, "entropy_coeff": 0.01, "var_gnorm": 16.21074867248535, "vf_loss": 29325.853515625, "vf_explained_var": 0.3266811966896057}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 588.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 176550, "num_env_steps_trained": 176400, "num_agent_steps_sampled": 176550, "num_agent_steps_trained": 176400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1177, "num_samples_added_to_queue": 176400, "learner_queue": {"size_count": 588, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 43.082, "learner_load_time_ms": 0.257, "learner_load_wait_time_ms": 1000.619, "learner_dequeue_time_ms": 8383.609}}, "env_runners": {"episode_reward_max": -130.56555555555562, "episode_reward_min": -213.07555555555555, "episode_reward_mean": -173.83623888888883, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -213.07555555555555}, "policy_reward_max": {"default_policy": -130.56555555555562}, "policy_reward_mean": {"default_policy": -173.83623888888883}, "custom_metrics": {"num_consolidated_mean": 0.6942000000000002, "num_consolidated_min": 0.56, "num_consolidated_max": 0.87, "num_overloaded_mean": 0.8994, "num_overloaded_min": 0.64, "num_overloaded_max": 1.03, "num_moves_mean": 9.8764, "num_moves_min": 9.49, "num_moves_max": 10.23, "mean_accuracy_mean": 40.60910333333333, "mean_accuracy_min": 40.358999999999995, "mean_accuracy_max": 40.916333333333334, "num_model_switches_mean": 5.7982000000000005, "num_model_switches_min": 5.31, "num_model_switches_max": 6.28, "num_slav_mean": 0.11350583333333335, "num_slav_min": 0.08675000000000001, "num_slav_max": 0.12894999999999998, "mean_cluster_cpu_util_mean": 0.549860039906834, "mean_cluster_cpu_util_min": 0.5330574796738818, "mean_cluster_cpu_util_max": 0.5731552049812714, "mean_cluster_mem_util_mean": 0.3558651411367289, "mean_cluster_mem_util_min": 0.34610768427624206, "mean_cluster_mem_util_max": 0.36520779711673707, "reward_consolidation_mean_mean": 0.2538888888888889, "reward_consolidation_mean_min": 0.08333333333333331, "reward_consolidation_mean_max": 0.5, "reward_illegal_mean_mean": -1.4989999999999994, "reward_illegal_mean_min": -1.7166666666666663, "reward_illegal_mean_max": -1.0666666666666667, "reward_accuracy_mean_mean": 0.5579431666666665, "reward_accuracy_mean_min": 0.3635666666666666, "reward_accuracy_mean_max": 0.9149333333333332, "reward_sla_mean_mean": -1.0511944444444443, "reward_sla_mean_min": -2.0216666666666665, "reward_sla_mean_max": -0.5444444444444444, "reward_consolidation_sum_mean": 25.388888888888886, "reward_consolidation_sum_min": 8.333333333333332, "reward_consolidation_sum_max": 50.0, "reward_illegal_sum_mean": -149.89999999999998, "reward_illegal_sum_min": -171.66666666666663, "reward_illegal_sum_max": -106.66666666666666, "reward_accuracy_sum_mean": 55.794316666666646, "reward_accuracy_sum_min": 36.35666666666666, "reward_accuracy_sum_max": 91.49333333333331, "reward_sla_sum_mean": -105.11944444444445, "reward_sla_sum_min": -202.16666666666666, "reward_sla_sum_max": -54.44444444444444, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2557.0, "global_timestep_min": 400, "global_timestep_max": 4200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-168.601111111111, -175.88055555555542, -158.0822222222221, -184.00944444444437, -150.94111111111118, -168.4016666666666, -201.97499999999997, -198.67444444444453, -168.1711111111112, -187.9255555555555, -179.385, -159.75888888888895, -169.44499999999996, -181.22499999999994, -187.34166666666667, -179.62388888888884, -167.96222222222218, -181.9255555555555, -194.78166666666655, -191.22499999999982, -189.88611111111103, -170.51666666666665, -173.21999999999997, -167.93555555555554, -143.76111111111118, -170.99499999999998, -169.911111111111, -213.07555555555555, -168.36222222222207, -210.23333333333332, -184.83499999999992, -186.51277777777764, -156.8716666666667, -190.35333333333344, -195.25722222222208, -198.62999999999994, -160.9755555555555, -162.8222222222222, -181.18833333333328, -178.08777777777772, -167.33999999999997, -162.8983333333333, -185.7905555555556, -197.25888888888883, -140.65388888888893, -185.65333333333322, -173.3383333333333, -174.83833333333328, -183.2511111111111, -170.58555555555543, -151.25999999999996, -151.66388888888892, -155.41222222222223, -188.1105555555556, -173.94999999999996, -173.48111111111106, -165.42611111111094, -194.3927777777776, -154.98277777777778, -182.40111111111108, -149.40055555555554, -199.97166666666664, -185.7683333333333, -172.77611111111113, -202.6372222222222, -177.92166666666654, -192.185, -156.32277777777767, -178.23444444444442, -164.39888888888885, -188.7727777777777, -176.3849999999999, -160.64611111111117, -168.77999999999997, -176.04499999999996, -174.32499999999987, -180.5594444444444, -137.48333333333335, -193.81444444444443, -140.52611111111113, -183.83555555555554, -130.56555555555562, -155.6566666666667, -179.19499999999985, -155.11777777777775, -171.55722222222215, -163.75611111111104, -162.76388888888877, -156.92555555555558, -175.2427777777778, -157.3038888888889, -152.5855555555556, -187.32888888888894, -162.83944444444435, -185.39499999999987, -190.48722222222216, -191.0905555555555, -153.15666666666675, -171.275, -159.13611111111115], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-168.601111111111, -175.88055555555542, -158.0822222222221, -184.00944444444437, -150.94111111111118, -168.4016666666666, -201.97499999999997, -198.67444444444453, -168.1711111111112, -187.9255555555555, -179.385, -159.75888888888895, -169.44499999999996, -181.22499999999994, -187.34166666666667, -179.62388888888884, -167.96222222222218, -181.9255555555555, -194.78166666666655, -191.22499999999982, -189.88611111111103, -170.51666666666665, -173.21999999999997, -167.93555555555554, -143.76111111111118, -170.99499999999998, -169.911111111111, -213.07555555555555, -168.36222222222207, -210.23333333333332, -184.83499999999992, -186.51277777777764, -156.8716666666667, -190.35333333333344, -195.25722222222208, -198.62999999999994, -160.9755555555555, -162.8222222222222, -181.18833333333328, -178.08777777777772, -167.33999999999997, -162.8983333333333, -185.7905555555556, -197.25888888888883, -140.65388888888893, -185.65333333333322, -173.3383333333333, -174.83833333333328, -183.2511111111111, -170.58555555555543, -151.25999999999996, -151.66388888888892, -155.41222222222223, -188.1105555555556, -173.94999999999996, -173.48111111111106, -165.42611111111094, -194.3927777777776, -154.98277777777778, -182.40111111111108, -149.40055555555554, -199.97166666666664, -185.7683333333333, -172.77611111111113, -202.6372222222222, -177.92166666666654, -192.185, -156.32277777777767, -178.23444444444442, -164.39888888888885, -188.7727777777777, -176.3849999999999, -160.64611111111117, -168.77999999999997, -176.04499999999996, -174.32499999999987, -180.5594444444444, -137.48333333333335, -193.81444444444443, -140.52611111111113, -183.83555555555554, -130.56555555555562, -155.6566666666667, -179.19499999999985, -155.11777777777775, -171.55722222222215, -163.75611111111104, -162.76388888888877, -156.92555555555558, -175.2427777777778, -157.3038888888889, -152.5855555555556, -187.32888888888894, -162.83944444444435, -185.39499999999987, -190.48722222222216, -191.0905555555555, -153.15666666666675, -171.275, -159.13611111111115]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19159300723046527, "mean_inference_ms": 1.7638641914473785, "mean_action_processing_ms": 0.07305603983199287, "mean_env_wait_ms": 1.1951248430019377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004476308822631836, "StateBufferConnector_ms": 0.0029528141021728516, "ViewRequirementAgentConnector_ms": 0.06788206100463867}, "num_episodes": 30, "episode_return_max": -130.56555555555562, "episode_return_min": -213.07555555555555, "episode_return_mean": -173.83623888888883, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176550, "num_agent_steps_trained": 176400, "num_env_steps_sampled": 176550, "num_env_steps_trained": 176400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 288.26888410364336, "num_env_steps_trained_throughput_per_sec": 288.26888410364336, "timesteps_total": 176550, "num_env_steps_sampled_lifetime": 176550, "num_agent_steps_sampled_lifetime": 176550, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 176550, "timers": {"training_iteration_time_ms": 10263.367, "restore_workers_time_ms": 0.011, "training_step_time_ms": 495.211, "sample_time_ms": 481.035, "synch_weights_time_ms": 12.857}, "counters": {"num_env_steps_sampled": 176550, "num_env_steps_trained": 176400, "num_agent_steps_sampled": 176550, "num_agent_steps_trained": 176400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1177, "num_samples_added_to_queue": 176400}, "done": false, "training_iteration": 58, "trial_id": "0313d_00000", "date": "2024-10-10_21-51-21", "timestamp": 1728593481, "time_this_iter_s": 10.41567063331604, "time_total_s": 595.9179561138153, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42dc94e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 595.9179561138153, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 12.226666666666667, "ram_util_percent": 58.126666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -73535.1796875, "policy_loss": -73468.8671875, "entropy": 28.996864318847656, "entropy_coeff": 0.01, "var_gnorm": 16.22698402404785, "vf_loss": 20682.109375, "vf_explained_var": 0.320406973361969}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 597.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 179400, "num_env_steps_trained": 179100, "num_agent_steps_sampled": 179400, "num_agent_steps_trained": 179100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1196, "num_samples_added_to_queue": 179400, "learner_queue": {"size_count": 597, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 49.593, "learner_load_time_ms": 0.238, "learner_load_wait_time_ms": 1028.993, "learner_dequeue_time_ms": 8437.68}}, "env_runners": {"episode_reward_max": -115.02166666666673, "episode_reward_min": -202.6372222222222, "episode_reward_mean": -168.5656722222222, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -202.6372222222222}, "policy_reward_max": {"default_policy": -115.02166666666673}, "policy_reward_mean": {"default_policy": -168.5656722222222}, "custom_metrics": {"num_consolidated_mean": 0.698, "num_consolidated_min": 0.55, "num_consolidated_max": 0.87, "num_overloaded_mean": 0.8936999999999999, "num_overloaded_min": 0.64, "num_overloaded_max": 1.03, "num_moves_mean": 9.8865, "num_moves_min": 9.49, "num_moves_max": 10.21, "mean_accuracy_mean": 40.578829999999996, "mean_accuracy_min": 40.25766666666665, "mean_accuracy_max": 40.916333333333334, "num_model_switches_mean": 5.7401, "num_model_switches_min": 5.3, "num_model_switches_max": 6.28, "num_slav_mean": 0.10959383333333333, "num_slav_min": 0.08048333333333332, "num_slav_max": 0.12894999999999998, "mean_cluster_cpu_util_mean": 0.5487860245257815, "mean_cluster_cpu_util_min": 0.5330574796738818, "mean_cluster_cpu_util_max": 0.5731552049812714, "mean_cluster_mem_util_mean": 0.35523182345575366, "mean_cluster_mem_util_min": 0.34610768427624206, "mean_cluster_mem_util_max": 0.36520779711673707, "reward_consolidation_mean_mean": 0.25916666666666666, "reward_consolidation_mean_min": 0.08333333333333331, "reward_consolidation_mean_max": 0.5, "reward_illegal_mean_mean": -1.4894999999999996, "reward_illegal_mean_min": -1.7166666666666663, "reward_illegal_mean_max": -1.0666666666666667, "reward_accuracy_mean_mean": 0.5622488333333332, "reward_accuracy_mean_min": 0.3635666666666666, "reward_accuracy_mean_max": 0.9149333333333332, "reward_sla_mean_mean": -1.017572222222222, "reward_sla_mean_min": -2.0216666666666665, "reward_sla_mean_max": -0.5444444444444444, "reward_consolidation_sum_mean": 25.91666666666666, "reward_consolidation_sum_min": 8.333333333333332, "reward_consolidation_sum_max": 50.0, "reward_illegal_sum_mean": -148.94999999999993, "reward_illegal_sum_min": -171.66666666666663, "reward_illegal_sum_max": -106.66666666666666, "reward_accuracy_sum_mean": 56.22488333333333, "reward_accuracy_sum_min": 36.35666666666666, "reward_accuracy_sum_max": 91.49333333333331, "reward_sla_sum_mean": -101.75722222222221, "reward_sla_sum_min": -202.16666666666666, "reward_sla_sum_max": -54.44444444444444, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3557.0, "global_timestep_min": 1400, "global_timestep_max": 5200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-184.83499999999992, -186.51277777777764, -156.8716666666667, -190.35333333333344, -195.25722222222208, -198.62999999999994, -160.9755555555555, -162.8222222222222, -181.18833333333328, -178.08777777777772, -167.33999999999997, -162.8983333333333, -185.7905555555556, -197.25888888888883, -140.65388888888893, -185.65333333333322, -173.3383333333333, -174.83833333333328, -183.2511111111111, -170.58555555555543, -151.25999999999996, -151.66388888888892, -155.41222222222223, -188.1105555555556, -173.94999999999996, -173.48111111111106, -165.42611111111094, -194.3927777777776, -154.98277777777778, -182.40111111111108, -149.40055555555554, -199.97166666666664, -185.7683333333333, -172.77611111111113, -202.6372222222222, -177.92166666666654, -192.185, -156.32277777777767, -178.23444444444442, -164.39888888888885, -188.7727777777777, -176.3849999999999, -160.64611111111117, -168.77999999999997, -176.04499999999996, -174.32499999999987, -180.5594444444444, -137.48333333333335, -193.81444444444443, -140.52611111111113, -183.83555555555554, -130.56555555555562, -155.6566666666667, -179.19499999999985, -155.11777777777775, -171.55722222222215, -163.75611111111104, -162.76388888888877, -156.92555555555558, -175.2427777777778, -157.3038888888889, -152.5855555555556, -187.32888888888894, -162.83944444444435, -185.39499999999987, -190.48722222222216, -191.0905555555555, -153.15666666666675, -171.275, -159.13611111111115, -175.39888888888896, -175.87222222222223, -151.12555555555554, -166.94055555555556, -153.87055555555543, -149.25444444444446, -183.42555555555546, -136.19500000000008, -149.58777777777786, -147.35555555555555, -175.8194444444444, -147.48944444444433, -143.64888888888885, -177.62444444444444, -195.93222222222215, -160.63388888888892, -170.34611111111096, -176.75777777777773, -133.18888888888893, -152.79944444444442, -177.78111111111116, -179.95722222222227, -173.89499999999998, -194.7494444444443, -160.64555555555557, -155.64722222222218, -139.4027777777778, -165.6305555555555, -120.17888888888899, -115.02166666666673], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-184.83499999999992, -186.51277777777764, -156.8716666666667, -190.35333333333344, -195.25722222222208, -198.62999999999994, -160.9755555555555, -162.8222222222222, -181.18833333333328, -178.08777777777772, -167.33999999999997, -162.8983333333333, -185.7905555555556, -197.25888888888883, -140.65388888888893, -185.65333333333322, -173.3383333333333, -174.83833333333328, -183.2511111111111, -170.58555555555543, -151.25999999999996, -151.66388888888892, -155.41222222222223, -188.1105555555556, -173.94999999999996, -173.48111111111106, -165.42611111111094, -194.3927777777776, -154.98277777777778, -182.40111111111108, -149.40055555555554, -199.97166666666664, -185.7683333333333, -172.77611111111113, -202.6372222222222, -177.92166666666654, -192.185, -156.32277777777767, -178.23444444444442, -164.39888888888885, -188.7727777777777, -176.3849999999999, -160.64611111111117, -168.77999999999997, -176.04499999999996, -174.32499999999987, -180.5594444444444, -137.48333333333335, -193.81444444444443, -140.52611111111113, -183.83555555555554, -130.56555555555562, -155.6566666666667, -179.19499999999985, -155.11777777777775, -171.55722222222215, -163.75611111111104, -162.76388888888877, -156.92555555555558, -175.2427777777778, -157.3038888888889, -152.5855555555556, -187.32888888888894, -162.83944444444435, -185.39499999999987, -190.48722222222216, -191.0905555555555, -153.15666666666675, -171.275, -159.13611111111115, -175.39888888888896, -175.87222222222223, -151.12555555555554, -166.94055555555556, -153.87055555555543, -149.25444444444446, -183.42555555555546, -136.19500000000008, -149.58777777777786, -147.35555555555555, -175.8194444444444, -147.48944444444433, -143.64888888888885, -177.62444444444444, -195.93222222222215, -160.63388888888892, -170.34611111111096, -176.75777777777773, -133.18888888888893, -152.79944444444442, -177.78111111111116, -179.95722222222227, -173.89499999999998, -194.7494444444443, -160.64555555555557, -155.64722222222218, -139.4027777777778, -165.6305555555555, -120.17888888888899, -115.02166666666673]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19179882905243806, "mean_inference_ms": 1.765049474699071, "mean_action_processing_ms": 0.0731269048012739, "mean_env_wait_ms": 1.1961513791947056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004494667053222656, "StateBufferConnector_ms": 0.002991914749145508, "ViewRequirementAgentConnector_ms": 0.0685887336730957}, "num_episodes": 30, "episode_return_max": -115.02166666666673, "episode_return_min": -202.6372222222222, "episode_return_mean": -168.5656722222222, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 179400, "num_agent_steps_trained": 179100, "num_env_steps_sampled": 179400, "num_env_steps_trained": 179100, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 278.47688292688326, "num_env_steps_trained_throughput_per_sec": 263.8202048780999, "timesteps_total": 179400, "num_env_steps_sampled_lifetime": 179400, "num_agent_steps_sampled_lifetime": 179400, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 179400, "timers": {"training_iteration_time_ms": 10269.679, "restore_workers_time_ms": 0.015, "training_step_time_ms": 542.232, "sample_time_ms": 527.682, "synch_weights_time_ms": 13.161}, "counters": {"num_env_steps_sampled": 179400, "num_env_steps_trained": 179100, "num_agent_steps_sampled": 179400, "num_agent_steps_trained": 179100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1196, "num_samples_added_to_queue": 179400}, "done": false, "training_iteration": 59, "trial_id": "0313d_00000", "date": "2024-10-10_21-51-32", "timestamp": 1728593492, "time_this_iter_s": 10.244797945022583, "time_total_s": 606.1627540588379, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c160e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 606.1627540588379, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 13.273333333333332, "ram_util_percent": 57.773333333333326}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -72048.6953125, "policy_loss": -71981.6015625, "entropy": 28.832557678222656, "entropy_coeff": 0.01, "var_gnorm": 16.245145797729492, "vf_loss": 19406.001953125, "vf_explained_var": 0.36594802141189575}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 606.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 182100, "num_env_steps_trained": 181800, "num_agent_steps_sampled": 182100, "num_agent_steps_trained": 181800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1214, "num_samples_added_to_queue": 182100, "learner_queue": {"size_count": 606, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.189, "learner_load_time_ms": 0.243, "learner_load_wait_time_ms": 1097.636, "learner_dequeue_time_ms": 8465.23}}, "env_runners": {"episode_reward_max": -98.95111111111122, "episode_reward_min": -202.6372222222222, "episode_reward_mean": -159.26073333333335, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -202.6372222222222}, "policy_reward_max": {"default_policy": -98.95111111111122}, "policy_reward_mean": {"default_policy": -159.26073333333335}, "custom_metrics": {"num_consolidated_mean": 0.7024999999999999, "num_consolidated_min": 0.55, "num_consolidated_max": 0.87, "num_overloaded_mean": 0.8675999999999999, "num_overloaded_min": 0.68, "num_overloaded_max": 1.03, "num_moves_mean": 9.8718, "num_moves_min": 9.49, "num_moves_max": 10.21, "mean_accuracy_mean": 40.52759333333333, "mean_accuracy_min": 40.22599999999999, "mean_accuracy_max": 40.859333333333325, "num_model_switches_mean": 5.712700000000001, "num_model_switches_min": 5.3, "num_model_switches_max": 6.28, "num_slav_mean": 0.10549833333333332, "num_slav_min": 0.08048333333333332, "num_slav_max": 0.12801666666666667, "mean_cluster_cpu_util_mean": 0.5453628399615745, "mean_cluster_cpu_util_min": 0.5160294932158551, "mean_cluster_cpu_util_max": 0.5731552049812714, "mean_cluster_mem_util_mean": 0.35364508831517844, "mean_cluster_mem_util_min": 0.340815699718706, "mean_cluster_mem_util_max": 0.3641898038118201, "reward_consolidation_mean_mean": 0.2788888888888889, "reward_consolidation_mean_min": 0.1388888888888889, "reward_consolidation_mean_max": 0.5277777777777777, "reward_illegal_mean_mean": -1.4459999999999997, "reward_illegal_mean_min": -1.7166666666666663, "reward_illegal_mean_max": -1.1333333333333333, "reward_accuracy_mean_mean": 0.585576, "reward_accuracy_mean_min": 0.3841166666666666, "reward_accuracy_mean_max": 0.8858333333333331, "reward_sla_mean_mean": -1.0110722222222224, "reward_sla_mean_min": -1.6516666666666668, "reward_sla_mean_max": -0.5922222222222223, "reward_consolidation_sum_mean": 27.888888888888886, "reward_consolidation_sum_min": 13.88888888888889, "reward_consolidation_sum_max": 52.77777777777777, "reward_illegal_sum_mean": -144.6, "reward_illegal_sum_min": -171.66666666666663, "reward_illegal_sum_max": -113.33333333333333, "reward_accuracy_sum_mean": 58.557599999999994, "reward_accuracy_sum_min": 38.41166666666666, "reward_accuracy_sum_max": 88.58333333333331, "reward_sla_sum_mean": -101.10722222222225, "reward_sla_sum_min": -165.16666666666669, "reward_sla_sum_max": -59.22222222222223, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4463.0, "global_timestep_min": 2400, "global_timestep_max": 6100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-194.3927777777776, -154.98277777777778, -182.40111111111108, -149.40055555555554, -199.97166666666664, -185.7683333333333, -172.77611111111113, -202.6372222222222, -177.92166666666654, -192.185, -156.32277777777767, -178.23444444444442, -164.39888888888885, -188.7727777777777, -176.3849999999999, -160.64611111111117, -168.77999999999997, -176.04499999999996, -174.32499999999987, -180.5594444444444, -137.48333333333335, -193.81444444444443, -140.52611111111113, -183.83555555555554, -130.56555555555562, -155.6566666666667, -179.19499999999985, -155.11777777777775, -171.55722222222215, -163.75611111111104, -162.76388888888877, -156.92555555555558, -175.2427777777778, -157.3038888888889, -152.5855555555556, -187.32888888888894, -162.83944444444435, -185.39499999999987, -190.48722222222216, -191.0905555555555, -153.15666666666675, -171.275, -159.13611111111115, -175.39888888888896, -175.87222222222223, -151.12555555555554, -166.94055555555556, -153.87055555555543, -149.25444444444446, -183.42555555555546, -136.19500000000008, -149.58777777777786, -147.35555555555555, -175.8194444444444, -147.48944444444433, -143.64888888888885, -177.62444444444444, -195.93222222222215, -160.63388888888892, -170.34611111111096, -176.75777777777773, -133.18888888888893, -152.79944444444442, -177.78111111111116, -179.95722222222227, -173.89499999999998, -194.7494444444443, -160.64555555555557, -155.64722222222218, -139.4027777777778, -165.6305555555555, -120.17888888888899, -115.02166666666673, -153.41611111111123, -143.01944444444453, -124.03666666666672, -158.08611111111105, -122.2194444444446, -154.68055555555557, -116.3711111111112, -121.40555555555571, -145.13444444444443, -145.0505555555556, -134.4194444444445, -115.77944444444448, -153.42888888888893, -157.76944444444453, -132.63777777777784, -146.70333333333335, -135.80555555555557, -98.95111111111122, -165.41722222222225, -130.88111111111124, -176.95611111111114, -146.90611111111113, -139.88888888888894, -130.5361111111112, -143.57111111111112, -141.49777777777788, -131.38277777777787], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-194.3927777777776, -154.98277777777778, -182.40111111111108, -149.40055555555554, -199.97166666666664, -185.7683333333333, -172.77611111111113, -202.6372222222222, -177.92166666666654, -192.185, -156.32277777777767, -178.23444444444442, -164.39888888888885, -188.7727777777777, -176.3849999999999, -160.64611111111117, -168.77999999999997, -176.04499999999996, -174.32499999999987, -180.5594444444444, -137.48333333333335, -193.81444444444443, -140.52611111111113, -183.83555555555554, -130.56555555555562, -155.6566666666667, -179.19499999999985, -155.11777777777775, -171.55722222222215, -163.75611111111104, -162.76388888888877, -156.92555555555558, -175.2427777777778, -157.3038888888889, -152.5855555555556, -187.32888888888894, -162.83944444444435, -185.39499999999987, -190.48722222222216, -191.0905555555555, -153.15666666666675, -171.275, -159.13611111111115, -175.39888888888896, -175.87222222222223, -151.12555555555554, -166.94055555555556, -153.87055555555543, -149.25444444444446, -183.42555555555546, -136.19500000000008, -149.58777777777786, -147.35555555555555, -175.8194444444444, -147.48944444444433, -143.64888888888885, -177.62444444444444, -195.93222222222215, -160.63388888888892, -170.34611111111096, -176.75777777777773, -133.18888888888893, -152.79944444444442, -177.78111111111116, -179.95722222222227, -173.89499999999998, -194.7494444444443, -160.64555555555557, -155.64722222222218, -139.4027777777778, -165.6305555555555, -120.17888888888899, -115.02166666666673, -153.41611111111123, -143.01944444444453, -124.03666666666672, -158.08611111111105, -122.2194444444446, -154.68055555555557, -116.3711111111112, -121.40555555555571, -145.13444444444443, -145.0505555555556, -134.4194444444445, -115.77944444444448, -153.42888888888893, -157.76944444444453, -132.63777777777784, -146.70333333333335, -135.80555555555557, -98.95111111111122, -165.41722222222225, -130.88111111111124, -176.95611111111114, -146.90611111111113, -139.88888888888894, -130.5361111111112, -143.57111111111112, -141.49777777777788, -131.38277777777787]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1920621880822356, "mean_inference_ms": 1.766786167948442, "mean_action_processing_ms": 0.0732150732379042, "mean_env_wait_ms": 1.197460769305255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005078792572021484, "StateBufferConnector_ms": 0.003137826919555664, "ViewRequirementAgentConnector_ms": 0.07145380973815918}, "num_episodes": 27, "episode_return_max": -98.95111111111122, "episode_return_min": -202.6372222222222, "episode_return_mean": -159.26073333333335, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 182100, "num_agent_steps_trained": 181800, "num_env_steps_sampled": 182100, "num_env_steps_trained": 181800, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 259.1368903451789, "num_env_steps_trained_throughput_per_sec": 259.1368903451789, "timesteps_total": 182100, "num_env_steps_sampled_lifetime": 182100, "num_agent_steps_sampled_lifetime": 182100, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 182100, "timers": {"training_iteration_time_ms": 10276.312, "restore_workers_time_ms": 0.013, "training_step_time_ms": 576.126, "sample_time_ms": 559.145, "synch_weights_time_ms": 15.285}, "counters": {"num_env_steps_sampled": 182100, "num_env_steps_trained": 181800, "num_agent_steps_sampled": 182100, "num_agent_steps_trained": 181800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1214, "num_samples_added_to_queue": 182100}, "done": false, "training_iteration": 60, "trial_id": "0313d_00000", "date": "2024-10-10_21-51-42", "timestamp": 1728593502, "time_this_iter_s": 10.428627729415894, "time_total_s": 616.5913817882538, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c16bf0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 616.5913817882538, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 15.853333333333332, "ram_util_percent": 59.053333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -65819.2578125, "policy_loss": -65753.7734375, "entropy": 28.63556671142578, "entropy_coeff": 0.01, "var_gnorm": 16.26401710510254, "vf_loss": 20418.99609375, "vf_explained_var": 0.3218611478805542}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 616.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 185100, "num_env_steps_trained": 184800, "num_agent_steps_sampled": 185100, "num_agent_steps_trained": 184800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1234, "num_samples_added_to_queue": 185100, "learner_queue": {"size_count": 616, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.473, "learner_load_time_ms": 0.277, "learner_load_wait_time_ms": 999.134, "learner_dequeue_time_ms": 8587.21}}, "env_runners": {"episode_reward_max": -62.503888888888916, "episode_reward_min": -195.93222222222215, "episode_reward_mean": -144.7937666666667, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -195.93222222222215}, "policy_reward_max": {"default_policy": -62.503888888888916}, "policy_reward_mean": {"default_policy": -144.7937666666667}, "custom_metrics": {"num_consolidated_mean": 0.7160000000000001, "num_consolidated_min": 0.55, "num_consolidated_max": 0.87, "num_overloaded_mean": 0.8252000000000002, "num_overloaded_min": 0.63, "num_overloaded_max": 1.0, "num_moves_mean": 9.846, "num_moves_min": 9.49, "num_moves_max": 10.21, "mean_accuracy_mean": 40.45355666666666, "mean_accuracy_min": 40.16266666666666, "mean_accuracy_max": 40.859333333333325, "num_model_switches_mean": 5.626499999999998, "num_model_switches_min": 5.29, "num_model_switches_max": 6.15, "num_slav_mean": 0.09849716666666668, "num_slav_min": 0.07318333333333332, "num_slav_max": 0.12205, "mean_cluster_cpu_util_mean": 0.5401375767294436, "mean_cluster_cpu_util_min": 0.5160294932158551, "mean_cluster_cpu_util_max": 0.5651962742336817, "mean_cluster_mem_util_mean": 0.3512676289251987, "mean_cluster_mem_util_min": 0.340815699718706, "mean_cluster_mem_util_max": 0.36219247718074565, "reward_consolidation_mean_mean": 0.32041666666666657, "reward_consolidation_mean_min": 0.1388888888888889, "reward_consolidation_mean_max": 0.5972222222222221, "reward_illegal_mean_mean": -1.375333333333333, "reward_illegal_mean_min": -1.6666666666666663, "reward_illegal_mean_max": -1.05, "reward_accuracy_mean_mean": 0.6488789999999999, "reward_accuracy_mean_min": 0.4065666666666667, "reward_accuracy_mean_max": 0.9405166666666663, "reward_sla_mean_mean": -1.0419, "reward_sla_mean_min": -1.6516666666666668, "reward_sla_mean_max": -0.5922222222222223, "reward_consolidation_sum_mean": 32.04166666666666, "reward_consolidation_sum_min": 13.88888888888889, "reward_consolidation_sum_max": 59.722222222222214, "reward_illegal_sum_mean": -137.53333333333327, "reward_illegal_sum_min": -166.66666666666663, "reward_illegal_sum_max": -105.0, "reward_accuracy_sum_mean": 64.88789999999999, "reward_accuracy_sum_min": 40.656666666666666, "reward_accuracy_sum_max": 94.05166666666663, "reward_sla_sum_mean": -104.19, "reward_sla_sum_min": -165.16666666666669, "reward_sla_sum_max": -59.22222222222223, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5457.0, "global_timestep_min": 3300, "global_timestep_max": 7100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-162.76388888888877, -156.92555555555558, -175.2427777777778, -157.3038888888889, -152.5855555555556, -187.32888888888894, -162.83944444444435, -185.39499999999987, -190.48722222222216, -191.0905555555555, -153.15666666666675, -171.275, -159.13611111111115, -175.39888888888896, -175.87222222222223, -151.12555555555554, -166.94055555555556, -153.87055555555543, -149.25444444444446, -183.42555555555546, -136.19500000000008, -149.58777777777786, -147.35555555555555, -175.8194444444444, -147.48944444444433, -143.64888888888885, -177.62444444444444, -195.93222222222215, -160.63388888888892, -170.34611111111096, -176.75777777777773, -133.18888888888893, -152.79944444444442, -177.78111111111116, -179.95722222222227, -173.89499999999998, -194.7494444444443, -160.64555555555557, -155.64722222222218, -139.4027777777778, -165.6305555555555, -120.17888888888899, -115.02166666666673, -153.41611111111123, -143.01944444444453, -124.03666666666672, -158.08611111111105, -122.2194444444446, -154.68055555555557, -116.3711111111112, -121.40555555555571, -145.13444444444443, -145.0505555555556, -134.4194444444445, -115.77944444444448, -153.42888888888893, -157.76944444444453, -132.63777777777784, -146.70333333333335, -135.80555555555557, -98.95111111111122, -165.41722222222225, -130.88111111111124, -176.95611111111114, -146.90611111111113, -139.88888888888894, -130.5361111111112, -143.57111111111112, -141.49777777777788, -131.38277777777787, -146.00444444444446, -144.23833333333343, -151.58777777777777, -110.31944444444443, -127.52388888888895, -126.48444444444448, -144.54333333333335, -106.77222222222233, -161.00611111111115, -91.1944444444445, -111.89722222222228, -86.3333333333334, -62.503888888888916, -130.96166666666673, -124.72166666666675, -113.8016666666668, -120.11944444444457, -111.87444444444448, -124.30166666666676, -139.63166666666672, -142.00222222222226, -140.37833333333336, -117.75666666666677, -116.93722222222227, -119.66555555555563, -127.17055555555562, -132.96111111111117, -127.57444444444454, -98.51055555555564, -142.94], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-162.76388888888877, -156.92555555555558, -175.2427777777778, -157.3038888888889, -152.5855555555556, -187.32888888888894, -162.83944444444435, -185.39499999999987, -190.48722222222216, -191.0905555555555, -153.15666666666675, -171.275, -159.13611111111115, -175.39888888888896, -175.87222222222223, -151.12555555555554, -166.94055555555556, -153.87055555555543, -149.25444444444446, -183.42555555555546, -136.19500000000008, -149.58777777777786, -147.35555555555555, -175.8194444444444, -147.48944444444433, -143.64888888888885, -177.62444444444444, -195.93222222222215, -160.63388888888892, -170.34611111111096, -176.75777777777773, -133.18888888888893, -152.79944444444442, -177.78111111111116, -179.95722222222227, -173.89499999999998, -194.7494444444443, -160.64555555555557, -155.64722222222218, -139.4027777777778, -165.6305555555555, -120.17888888888899, -115.02166666666673, -153.41611111111123, -143.01944444444453, -124.03666666666672, -158.08611111111105, -122.2194444444446, -154.68055555555557, -116.3711111111112, -121.40555555555571, -145.13444444444443, -145.0505555555556, -134.4194444444445, -115.77944444444448, -153.42888888888893, -157.76944444444453, -132.63777777777784, -146.70333333333335, -135.80555555555557, -98.95111111111122, -165.41722222222225, -130.88111111111124, -176.95611111111114, -146.90611111111113, -139.88888888888894, -130.5361111111112, -143.57111111111112, -141.49777777777788, -131.38277777777787, -146.00444444444446, -144.23833333333343, -151.58777777777777, -110.31944444444443, -127.52388888888895, -126.48444444444448, -144.54333333333335, -106.77222222222233, -161.00611111111115, -91.1944444444445, -111.89722222222228, -86.3333333333334, -62.503888888888916, -130.96166666666673, -124.72166666666675, -113.8016666666668, -120.11944444444457, -111.87444444444448, -124.30166666666676, -139.63166666666672, -142.00222222222226, -140.37833333333336, -117.75666666666677, -116.93722222222227, -119.66555555555563, -127.17055555555562, -132.96111111111117, -127.57444444444454, -98.51055555555564, -142.94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19235973851250499, "mean_inference_ms": 1.7688636707666712, "mean_action_processing_ms": 0.07331427137780885, "mean_env_wait_ms": 1.1989115281386937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005105733871459961, "StateBufferConnector_ms": 0.0031156539916992188, "ViewRequirementAgentConnector_ms": 0.06997323036193848}, "num_episodes": 30, "episode_return_max": -62.503888888888916, "episode_return_min": -195.93222222222215, "episode_return_mean": -144.7937666666667, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 185100, "num_agent_steps_trained": 184800, "num_env_steps_sampled": 185100, "num_env_steps_trained": 184800, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 285.4155015748091, "num_env_steps_trained_throughput_per_sec": 285.4155015748091, "timesteps_total": 185100, "num_env_steps_sampled_lifetime": 185100, "num_agent_steps_sampled_lifetime": 185100, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 185100, "timers": {"training_iteration_time_ms": 10317.885, "restore_workers_time_ms": 0.011, "training_step_time_ms": 515.748, "sample_time_ms": 500.909, "synch_weights_time_ms": 13.52}, "counters": {"num_env_steps_sampled": 185100, "num_env_steps_trained": 184800, "num_agent_steps_sampled": 185100, "num_agent_steps_trained": 184800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1234, "num_samples_added_to_queue": 185100}, "done": false, "training_iteration": 61, "trial_id": "0313d_00000", "date": "2024-10-10_21-51-53", "timestamp": 1728593513, "time_this_iter_s": 10.521108865737915, "time_total_s": 627.1124906539917, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42dca4a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 627.1124906539917, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 11.746666666666666, "ram_util_percent": 59.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -12290.830078125, "policy_loss": -12211.802734375, "entropy": 28.166797637939453, "entropy_coeff": 0.01, "var_gnorm": 16.291580200195312, "vf_loss": 5472.21630859375, "vf_explained_var": 0.4027625322341919}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 626.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 187950, "num_env_steps_trained": 187800, "num_agent_steps_sampled": 187950, "num_agent_steps_trained": 187800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1253, "num_samples_added_to_queue": 187800, "learner_queue": {"size_count": 626, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.812, "learner_load_time_ms": 0.307, "learner_load_wait_time_ms": 1054.012, "learner_dequeue_time_ms": 8635.262}}, "env_runners": {"episode_reward_max": -51.356666666666655, "episode_reward_min": -195.93222222222215, "episode_reward_mean": -128.92068333333336, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -195.93222222222215}, "policy_reward_max": {"default_policy": -51.356666666666655}, "policy_reward_mean": {"default_policy": -128.92068333333336}, "custom_metrics": {"num_consolidated_mean": 0.7335999999999998, "num_consolidated_min": 0.55, "num_consolidated_max": 0.87, "num_overloaded_mean": 0.7791999999999999, "num_overloaded_min": 0.59, "num_overloaded_max": 0.98, "num_moves_mean": 9.8138, "num_moves_min": 9.51, "num_moves_max": 10.21, "mean_accuracy_mean": 40.38186333333333, "mean_accuracy_min": 40.13099999999999, "mean_accuracy_max": 40.63133333333333, "num_model_switches_mean": 5.555600000000001, "num_model_switches_min": 5.07, "num_model_switches_max": 6.04, "num_slav_mean": 0.09102833333333335, "num_slav_min": 0.0579, "num_slav_max": 0.11903333333333332, "mean_cluster_cpu_util_mean": 0.5354336137924134, "mean_cluster_cpu_util_min": 0.5160294932158551, "mean_cluster_cpu_util_max": 0.5651962742336817, "mean_cluster_mem_util_mean": 0.3490565281921842, "mean_cluster_mem_util_min": 0.3406401828769483, "mean_cluster_mem_util_max": 0.36219247718074565, "reward_consolidation_mean_mean": 0.36083333333333334, "reward_consolidation_mean_min": 0.16666666666666663, "reward_consolidation_mean_max": 0.5972222222222221, "reward_illegal_mean_mean": -1.2986666666666664, "reward_illegal_mean_min": -1.633333333333333, "reward_illegal_mean_max": -0.9833333333333332, "reward_accuracy_mean_mean": 0.7038264999999998, "reward_accuracy_mean_min": 0.48528333333333323, "reward_accuracy_mean_max": 1.0271499999999998, "reward_sla_mean_mean": -1.0552, "reward_sla_mean_min": -1.6516666666666668, "reward_sla_mean_max": -0.5966666666666667, "reward_consolidation_sum_mean": 36.08333333333333, "reward_consolidation_sum_min": 16.666666666666664, "reward_consolidation_sum_max": 59.722222222222214, "reward_illegal_sum_mean": -129.86666666666667, "reward_illegal_sum_min": -163.33333333333331, "reward_illegal_sum_max": -98.33333333333331, "reward_accuracy_sum_mean": 70.38264999999998, "reward_accuracy_sum_min": 48.52833333333332, "reward_accuracy_sum_max": 102.71499999999997, "reward_sla_sum_mean": -105.52000000000002, "reward_sla_sum_min": -165.16666666666669, "reward_sla_sum_max": -59.666666666666664, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5890.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-195.93222222222215, -160.63388888888892, -170.34611111111096, -176.75777777777773, -133.18888888888893, -152.79944444444442, -177.78111111111116, -179.95722222222227, -173.89499999999998, -194.7494444444443, -160.64555555555557, -155.64722222222218, -139.4027777777778, -165.6305555555555, -120.17888888888899, -115.02166666666673, -153.41611111111123, -143.01944444444453, -124.03666666666672, -158.08611111111105, -122.2194444444446, -154.68055555555557, -116.3711111111112, -121.40555555555571, -145.13444444444443, -145.0505555555556, -134.4194444444445, -115.77944444444448, -153.42888888888893, -157.76944444444453, -132.63777777777784, -146.70333333333335, -135.80555555555557, -98.95111111111122, -165.41722222222225, -130.88111111111124, -176.95611111111114, -146.90611111111113, -139.88888888888894, -130.5361111111112, -143.57111111111112, -141.49777777777788, -131.38277777777787, -146.00444444444446, -144.23833333333343, -151.58777777777777, -110.31944444444443, -127.52388888888895, -126.48444444444448, -144.54333333333335, -106.77222222222233, -161.00611111111115, -91.1944444444445, -111.89722222222228, -86.3333333333334, -62.503888888888916, -130.96166666666673, -124.72166666666675, -113.8016666666668, -120.11944444444457, -111.87444444444448, -124.30166666666676, -139.63166666666672, -142.00222222222226, -140.37833333333336, -117.75666666666677, -116.93722222222227, -119.66555555555563, -127.17055555555562, -132.96111111111117, -127.57444444444454, -98.51055555555564, -142.94, -106.78388888888895, -110.00944444444457, -134.18333333333345, -98.26277777777786, -95.67111111111114, -117.21611111111122, -99.43222222222228, -91.53444444444447, -84.41500000000008, -101.25555555555563, -118.96222222222225, -149.77888888888896, -51.356666666666655, -102.92055555555562, -113.51666666666677, -90.87777777777784, -97.06388888888894, -87.96222222222225, -135.7450000000001, -103.47611111111124, -100.56277777777777, -125.04055555555566, -133.20611111111117, -81.23944444444446, -142.1088888888889, -110.55555555555561, -68.69333333333334], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-195.93222222222215, -160.63388888888892, -170.34611111111096, -176.75777777777773, -133.18888888888893, -152.79944444444442, -177.78111111111116, -179.95722222222227, -173.89499999999998, -194.7494444444443, -160.64555555555557, -155.64722222222218, -139.4027777777778, -165.6305555555555, -120.17888888888899, -115.02166666666673, -153.41611111111123, -143.01944444444453, -124.03666666666672, -158.08611111111105, -122.2194444444446, -154.68055555555557, -116.3711111111112, -121.40555555555571, -145.13444444444443, -145.0505555555556, -134.4194444444445, -115.77944444444448, -153.42888888888893, -157.76944444444453, -132.63777777777784, -146.70333333333335, -135.80555555555557, -98.95111111111122, -165.41722222222225, -130.88111111111124, -176.95611111111114, -146.90611111111113, -139.88888888888894, -130.5361111111112, -143.57111111111112, -141.49777777777788, -131.38277777777787, -146.00444444444446, -144.23833333333343, -151.58777777777777, -110.31944444444443, -127.52388888888895, -126.48444444444448, -144.54333333333335, -106.77222222222233, -161.00611111111115, -91.1944444444445, -111.89722222222228, -86.3333333333334, -62.503888888888916, -130.96166666666673, -124.72166666666675, -113.8016666666668, -120.11944444444457, -111.87444444444448, -124.30166666666676, -139.63166666666672, -142.00222222222226, -140.37833333333336, -117.75666666666677, -116.93722222222227, -119.66555555555563, -127.17055555555562, -132.96111111111117, -127.57444444444454, -98.51055555555564, -142.94, -106.78388888888895, -110.00944444444457, -134.18333333333345, -98.26277777777786, -95.67111111111114, -117.21611111111122, -99.43222222222228, -91.53444444444447, -84.41500000000008, -101.25555555555563, -118.96222222222225, -149.77888888888896, -51.356666666666655, -102.92055555555562, -113.51666666666677, -90.87777777777784, -97.06388888888894, -87.96222222222225, -135.7450000000001, -103.47611111111124, -100.56277777777777, -125.04055555555566, -133.20611111111117, -81.23944444444446, -142.1088888888889, -110.55555555555561, -68.69333333333334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.192616807068432, "mean_inference_ms": 1.7694960459539244, "mean_action_processing_ms": 0.07339507330824767, "mean_env_wait_ms": 1.1999759841769058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052335262298583984, "StateBufferConnector_ms": 0.003122568130493164, "ViewRequirementAgentConnector_ms": 0.07140684127807617}, "num_episodes": 27, "episode_return_max": -51.356666666666655, "episode_return_min": -195.93222222222215, "episode_return_mean": -128.92068333333336, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 187950, "num_agent_steps_trained": 187800, "num_env_steps_sampled": 187950, "num_env_steps_trained": 187800, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 272.7446390849839, "num_env_steps_trained_throughput_per_sec": 287.0996200894567, "timesteps_total": 187950, "num_env_steps_sampled_lifetime": 187950, "num_agent_steps_sampled_lifetime": 187950, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 187950, "timers": {"training_iteration_time_ms": 10300.942, "restore_workers_time_ms": 0.013, "training_step_time_ms": 558.256, "sample_time_ms": 542.78, "synch_weights_time_ms": 14.024}, "counters": {"num_env_steps_sampled": 187950, "num_env_steps_trained": 187800, "num_agent_steps_sampled": 187950, "num_agent_steps_trained": 187800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1253, "num_samples_added_to_queue": 187800}, "done": false, "training_iteration": 62, "trial_id": "0313d_00000", "date": "2024-10-10_21-52-03", "timestamp": 1728593523, "time_this_iter_s": 10.458216667175293, "time_total_s": 637.570707321167, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae4022d360>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 637.570707321167, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 13.346666666666668, "ram_util_percent": 59.33999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 58155.96875, "policy_loss": 58223.5234375, "entropy": 27.498470306396484, "entropy_coeff": 0.01, "var_gnorm": 16.32718849182129, "vf_loss": 14940.681640625, "vf_explained_var": -0.09162116050720215}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 635.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 190800, "num_env_steps_trained": 190500, "num_agent_steps_sampled": 190800, "num_agent_steps_trained": 190500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1272, "num_samples_added_to_queue": 190800, "learner_queue": {"size_count": 635, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.181, "learner_load_time_ms": 0.316, "learner_load_wait_time_ms": 1001.448, "learner_dequeue_time_ms": 8650.872}}, "env_runners": {"episode_reward_max": -11.11888888888891, "episode_reward_min": -176.95611111111114, "episode_reward_mean": -102.98446666666672, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -176.95611111111114}, "policy_reward_max": {"default_policy": -11.11888888888891}, "policy_reward_mean": {"default_policy": -102.98446666666672}, "custom_metrics": {"num_consolidated_mean": 0.7613, "num_consolidated_min": 0.6, "num_consolidated_max": 0.94, "num_overloaded_mean": 0.7166999999999999, "num_overloaded_min": 0.49, "num_overloaded_max": 0.91, "num_moves_mean": 9.744700000000002, "num_moves_min": 9.45, "num_moves_max": 10.07, "mean_accuracy_mean": 40.301746666666666, "mean_accuracy_min": 39.99166666666665, "mean_accuracy_max": 40.593333333333334, "num_model_switches_mean": 5.435100000000001, "num_model_switches_min": 4.81, "num_model_switches_max": 6.04, "num_slav_mean": 0.080753, "num_slav_min": 0.05161666666666665, "num_slav_max": 0.11903333333333332, "mean_cluster_cpu_util_mean": 0.5286124064691046, "mean_cluster_cpu_util_min": 0.5056475640035457, "mean_cluster_cpu_util_max": 0.551306923395321, "mean_cluster_mem_util_mean": 0.3457017181158327, "mean_cluster_mem_util_min": 0.3354540514940153, "mean_cluster_mem_util_max": 0.3571695872441804, "reward_consolidation_mean_mean": 0.4259722222222221, "reward_consolidation_mean_min": 0.19444444444444442, "reward_consolidation_mean_max": 0.7222222222222223, "reward_illegal_mean_mean": -1.1945, "reward_illegal_mean_min": -1.5166666666666664, "reward_illegal_mean_max": -0.8166666666666665, "reward_accuracy_mean_mean": 0.7868719999999996, "reward_accuracy_mean_min": 0.50805, "reward_accuracy_mean_max": 1.1026999999999996, "reward_sla_mean_mean": -1.0481888888888888, "reward_sla_mean_min": -1.6516666666666668, "reward_sla_mean_max": -0.5966666666666667, "reward_consolidation_sum_mean": 42.597222222222214, "reward_consolidation_sum_min": 19.444444444444443, "reward_consolidation_sum_max": 72.22222222222223, "reward_illegal_sum_mean": -119.45, "reward_illegal_sum_min": -151.66666666666663, "reward_illegal_sum_max": -81.66666666666666, "reward_accuracy_sum_mean": 78.68719999999999, "reward_accuracy_sum_min": 50.805, "reward_accuracy_sum_max": 110.26999999999997, "reward_sla_sum_mean": -104.8188888888889, "reward_sla_sum_min": -165.16666666666669, "reward_sla_sum_max": -59.666666666666664, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4555.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-132.63777777777784, -146.70333333333335, -135.80555555555557, -98.95111111111122, -165.41722222222225, -130.88111111111124, -176.95611111111114, -146.90611111111113, -139.88888888888894, -130.5361111111112, -143.57111111111112, -141.49777777777788, -131.38277777777787, -146.00444444444446, -144.23833333333343, -151.58777777777777, -110.31944444444443, -127.52388888888895, -126.48444444444448, -144.54333333333335, -106.77222222222233, -161.00611111111115, -91.1944444444445, -111.89722222222228, -86.3333333333334, -62.503888888888916, -130.96166666666673, -124.72166666666675, -113.8016666666668, -120.11944444444457, -111.87444444444448, -124.30166666666676, -139.63166666666672, -142.00222222222226, -140.37833333333336, -117.75666666666677, -116.93722222222227, -119.66555555555563, -127.17055555555562, -132.96111111111117, -127.57444444444454, -98.51055555555564, -142.94, -106.78388888888895, -110.00944444444457, -134.18333333333345, -98.26277777777786, -95.67111111111114, -117.21611111111122, -99.43222222222228, -91.53444444444447, -84.41500000000008, -101.25555555555563, -118.96222222222225, -149.77888888888896, -51.356666666666655, -102.92055555555562, -113.51666666666677, -90.87777777777784, -97.06388888888894, -87.96222222222225, -135.7450000000001, -103.47611111111124, -100.56277777777777, -125.04055555555566, -133.20611111111117, -81.23944444444446, -142.1088888888889, -110.55555555555561, -68.69333333333334, -74.82444444444445, -77.07499999999999, -98.14333333333336, -105.73111111111122, -72.70166666666667, -70.68611111111107, -48.4061111111111, -25.481111111111115, -28.957222222222242, -56.61166666666665, -71.65499999999997, -89.68333333333338, -87.51, -82.13444444444451, -82.57333333333332, -22.99000000000002, -107.80666666666673, -83.3166666666667, -11.11888888888891, -69.35999999999999, -92.8666666666667, -97.20277777777783, -66.51722222222219, -35.62388888888889, -60.86611111111109, -29.577777777777797, -52.482777777777734, -59.392777777777745, -31.80222222222224, -30.665000000000045], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-132.63777777777784, -146.70333333333335, -135.80555555555557, -98.95111111111122, -165.41722222222225, -130.88111111111124, -176.95611111111114, -146.90611111111113, -139.88888888888894, -130.5361111111112, -143.57111111111112, -141.49777777777788, -131.38277777777787, -146.00444444444446, -144.23833333333343, -151.58777777777777, -110.31944444444443, -127.52388888888895, -126.48444444444448, -144.54333333333335, -106.77222222222233, -161.00611111111115, -91.1944444444445, -111.89722222222228, -86.3333333333334, -62.503888888888916, -130.96166666666673, -124.72166666666675, -113.8016666666668, -120.11944444444457, -111.87444444444448, -124.30166666666676, -139.63166666666672, -142.00222222222226, -140.37833333333336, -117.75666666666677, -116.93722222222227, -119.66555555555563, -127.17055555555562, -132.96111111111117, -127.57444444444454, -98.51055555555564, -142.94, -106.78388888888895, -110.00944444444457, -134.18333333333345, -98.26277777777786, -95.67111111111114, -117.21611111111122, -99.43222222222228, -91.53444444444447, -84.41500000000008, -101.25555555555563, -118.96222222222225, -149.77888888888896, -51.356666666666655, -102.92055555555562, -113.51666666666677, -90.87777777777784, -97.06388888888894, -87.96222222222225, -135.7450000000001, -103.47611111111124, -100.56277777777777, -125.04055555555566, -133.20611111111117, -81.23944444444446, -142.1088888888889, -110.55555555555561, -68.69333333333334, -74.82444444444445, -77.07499999999999, -98.14333333333336, -105.73111111111122, -72.70166666666667, -70.68611111111107, -48.4061111111111, -25.481111111111115, -28.957222222222242, -56.61166666666665, -71.65499999999997, -89.68333333333338, -87.51, -82.13444444444451, -82.57333333333332, -22.99000000000002, -107.80666666666673, -83.3166666666667, -11.11888888888891, -69.35999999999999, -92.8666666666667, -97.20277777777783, -66.51722222222219, -35.62388888888889, -60.86611111111109, -29.577777777777797, -52.482777777777734, -59.392777777777745, -31.80222222222224, -30.665000000000045]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1929288288180182, "mean_inference_ms": 1.7728779292923003, "mean_action_processing_ms": 0.07350766418987537, "mean_env_wait_ms": 1.2015556079696446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004876613616943359, "StateBufferConnector_ms": 0.0030164718627929688, "ViewRequirementAgentConnector_ms": 0.06901168823242188}, "num_episodes": 30, "episode_return_max": -11.11888888888891, "episode_return_min": -176.95611111111114, "episode_return_mean": -102.98446666666672, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 190800, "num_agent_steps_trained": 190500, "num_env_steps_sampled": 190800, "num_env_steps_trained": 190500, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 284.94404115517153, "num_env_steps_trained_throughput_per_sec": 269.94698635753093, "timesteps_total": 190800, "num_env_steps_sampled_lifetime": 190800, "num_agent_steps_sampled_lifetime": 190800, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 190800, "timers": {"training_iteration_time_ms": 10288.582, "restore_workers_time_ms": 0.012, "training_step_time_ms": 505.714, "sample_time_ms": 491.059, "synch_weights_time_ms": 13.274}, "counters": {"num_env_steps_sampled": 190800, "num_env_steps_trained": 190500, "num_agent_steps_sampled": 190800, "num_agent_steps_trained": 190500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1272, "num_samples_added_to_queue": 190800}, "done": false, "training_iteration": 63, "trial_id": "0313d_00000", "date": "2024-10-10_21-52-13", "timestamp": 1728593533, "time_this_iter_s": 10.011924266815186, "time_total_s": 647.5826315879822, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c182b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 647.5826315879822, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 13.214285714285717, "ram_util_percent": 59.62142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 92048.2890625, "policy_loss": 92099.0, "entropy": 26.54378890991211, "entropy_coeff": 0.01, "var_gnorm": 16.368444442749023, "vf_loss": 28920.8515625, "vf_explained_var": -0.592389702796936}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 645.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 193650, "num_env_steps_trained": 193500, "num_agent_steps_sampled": 193650, "num_agent_steps_trained": 193500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1291, "num_samples_added_to_queue": 193500, "learner_queue": {"size_count": 645, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.449, "learner_load_time_ms": 0.317, "learner_load_wait_time_ms": 1012.91, "learner_dequeue_time_ms": 8614.133}}, "env_runners": {"episode_reward_max": 62.46555555555554, "episode_reward_min": -149.77888888888896, "episode_reward_mean": -67.03471666666671, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -149.77888888888896}, "policy_reward_max": {"default_policy": 62.46555555555554}, "policy_reward_mean": {"default_policy": -67.03471666666671}, "custom_metrics": {"num_consolidated_mean": 0.8090999999999999, "num_consolidated_min": 0.66, "num_consolidated_max": 1.03, "num_overloaded_mean": 0.6489999999999999, "num_overloaded_min": 0.39, "num_overloaded_max": 0.91, "num_moves_mean": 9.654499999999999, "num_moves_min": 9.16, "num_moves_max": 10.07, "mean_accuracy_mean": 40.21428333333333, "mean_accuracy_min": 39.84599999999999, "mean_accuracy_max": 40.56166666666666, "num_model_switches_mean": 5.256600000000001, "num_model_switches_min": 4.48, "num_model_switches_max": 6.04, "num_slav_mean": 0.06987916666666667, "num_slav_min": 0.038216666666666656, "num_slav_max": 0.10026666666666667, "mean_cluster_cpu_util_mean": 0.5209414634289439, "mean_cluster_cpu_util_min": 0.4945470913806637, "mean_cluster_cpu_util_max": 0.551306923395321, "mean_cluster_mem_util_mean": 0.34144229140474747, "mean_cluster_mem_util_min": 0.32751921122879535, "mean_cluster_mem_util_max": 0.3571695872441804, "reward_consolidation_mean_mean": 0.5161111111111111, "reward_consolidation_mean_min": 0.19444444444444442, "reward_consolidation_mean_max": 0.9722222222222223, "reward_illegal_mean_mean": -1.0816666666666668, "reward_illegal_mean_min": -1.5166666666666664, "reward_illegal_mean_max": -0.65, "reward_accuracy_mean_mean": 0.881252833333333, "reward_accuracy_mean_min": 0.5222666666666665, "reward_accuracy_mean_max": 1.2790999999999995, "reward_sla_mean_mean": -0.9860444444444444, "reward_sla_mean_min": -1.5688888888888888, "reward_sla_mean_max": -0.5166666666666666, "reward_consolidation_sum_mean": 51.611111111111114, "reward_consolidation_sum_min": 19.444444444444443, "reward_consolidation_sum_max": 97.22222222222223, "reward_illegal_sum_mean": -108.16666666666664, "reward_illegal_sum_min": -151.66666666666663, "reward_illegal_sum_max": -65.0, "reward_accuracy_sum_mean": 88.12528333333334, "reward_accuracy_sum_min": 52.22666666666665, "reward_accuracy_sum_max": 127.90999999999995, "reward_sla_sum_mean": -98.60444444444444, "reward_sla_sum_min": -156.88888888888889, "reward_sla_sum_max": -51.666666666666664, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3344.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-124.72166666666675, -113.8016666666668, -120.11944444444457, -111.87444444444448, -124.30166666666676, -139.63166666666672, -142.00222222222226, -140.37833333333336, -117.75666666666677, -116.93722222222227, -119.66555555555563, -127.17055555555562, -132.96111111111117, -127.57444444444454, -98.51055555555564, -142.94, -106.78388888888895, -110.00944444444457, -134.18333333333345, -98.26277777777786, -95.67111111111114, -117.21611111111122, -99.43222222222228, -91.53444444444447, -84.41500000000008, -101.25555555555563, -118.96222222222225, -149.77888888888896, -51.356666666666655, -102.92055555555562, -113.51666666666677, -90.87777777777784, -97.06388888888894, -87.96222222222225, -135.7450000000001, -103.47611111111124, -100.56277777777777, -125.04055555555566, -133.20611111111117, -81.23944444444446, -142.1088888888889, -110.55555555555561, -68.69333333333334, -74.82444444444445, -77.07499999999999, -98.14333333333336, -105.73111111111122, -72.70166666666667, -70.68611111111107, -48.4061111111111, -25.481111111111115, -28.957222222222242, -56.61166666666665, -71.65499999999997, -89.68333333333338, -87.51, -82.13444444444451, -82.57333333333332, -22.99000000000002, -107.80666666666673, -83.3166666666667, -11.11888888888891, -69.35999999999999, -92.8666666666667, -97.20277777777783, -66.51722222222219, -35.62388888888889, -60.86611111111109, -29.577777777777797, -52.482777777777734, -59.392777777777745, -31.80222222222224, -30.665000000000045, -16.292222222222225, 3.284999999999977, -29.702777777777804, -2.8705555555555717, 62.46555555555554, 24.58666666666661, 15.41277777777777, 30.23888888888887, -9.30611111111112, -32.65000000000001, -32.592777777777805, 22.54555555555553, -20.352777777777803, 22.194444444444414, -8.115000000000013, -0.41055555555557377, 46.237222222222194, 16.958333333333318, -30.146111111111118, -32.05055555555556, -5.8322222222222315, -8.276666666666678, 4.129444444444417, -14.876666666666683, 40.338888888888896, -14.25500000000001, 41.80666666666669], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-124.72166666666675, -113.8016666666668, -120.11944444444457, -111.87444444444448, -124.30166666666676, -139.63166666666672, -142.00222222222226, -140.37833333333336, -117.75666666666677, -116.93722222222227, -119.66555555555563, -127.17055555555562, -132.96111111111117, -127.57444444444454, -98.51055555555564, -142.94, -106.78388888888895, -110.00944444444457, -134.18333333333345, -98.26277777777786, -95.67111111111114, -117.21611111111122, -99.43222222222228, -91.53444444444447, -84.41500000000008, -101.25555555555563, -118.96222222222225, -149.77888888888896, -51.356666666666655, -102.92055555555562, -113.51666666666677, -90.87777777777784, -97.06388888888894, -87.96222222222225, -135.7450000000001, -103.47611111111124, -100.56277777777777, -125.04055555555566, -133.20611111111117, -81.23944444444446, -142.1088888888889, -110.55555555555561, -68.69333333333334, -74.82444444444445, -77.07499999999999, -98.14333333333336, -105.73111111111122, -72.70166666666667, -70.68611111111107, -48.4061111111111, -25.481111111111115, -28.957222222222242, -56.61166666666665, -71.65499999999997, -89.68333333333338, -87.51, -82.13444444444451, -82.57333333333332, -22.99000000000002, -107.80666666666673, -83.3166666666667, -11.11888888888891, -69.35999999999999, -92.8666666666667, -97.20277777777783, -66.51722222222219, -35.62388888888889, -60.86611111111109, -29.577777777777797, -52.482777777777734, -59.392777777777745, -31.80222222222224, -30.665000000000045, -16.292222222222225, 3.284999999999977, -29.702777777777804, -2.8705555555555717, 62.46555555555554, 24.58666666666661, 15.41277777777777, 30.23888888888887, -9.30611111111112, -32.65000000000001, -32.592777777777805, 22.54555555555553, -20.352777777777803, 22.194444444444414, -8.115000000000013, -0.41055555555557377, 46.237222222222194, 16.958333333333318, -30.146111111111118, -32.05055555555556, -5.8322222222222315, -8.276666666666678, 4.129444444444417, -14.876666666666683, 40.338888888888896, -14.25500000000001, 41.80666666666669]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19305890126122038, "mean_inference_ms": 1.7726970460353906, "mean_action_processing_ms": 0.07355491659226329, "mean_env_wait_ms": 1.2021415568411498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045833587646484375, "StateBufferConnector_ms": 0.0030388832092285156, "ViewRequirementAgentConnector_ms": 0.06918001174926758}, "num_episodes": 27, "episode_return_max": 62.46555555555554, "episode_return_min": -149.77888888888896, "episode_return_mean": -67.03471666666671, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 193650, "num_agent_steps_trained": 193500, "num_env_steps_sampled": 193650, "num_env_steps_trained": 193500, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 279.50797311255656, "num_env_steps_trained_throughput_per_sec": 294.218919065849, "timesteps_total": 193650, "num_env_steps_sampled_lifetime": 193650, "num_agent_steps_sampled_lifetime": 193650, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 193650, "timers": {"training_iteration_time_ms": 10277.732, "restore_workers_time_ms": 0.012, "training_step_time_ms": 530.467, "sample_time_ms": 515.094, "synch_weights_time_ms": 14.022}, "counters": {"num_env_steps_sampled": 193650, "num_env_steps_trained": 193500, "num_agent_steps_sampled": 193650, "num_agent_steps_trained": 193500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1291, "num_samples_added_to_queue": 193500}, "done": false, "training_iteration": 64, "trial_id": "0313d_00000", "date": "2024-10-10_21-52-24", "timestamp": 1728593544, "time_this_iter_s": 10.205989122390747, "time_total_s": 657.7886207103729, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c16350>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 657.7886207103729, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 12.9, "ram_util_percent": 59.72857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 148978.0625, "policy_loss": 148970.5625, "entropy": 25.597923278808594, "entropy_coeff": 0.01, "var_gnorm": 16.401975631713867, "vf_loss": 84299.546875, "vf_explained_var": -0.5364015102386475}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 655.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 196650, "num_env_steps_trained": 196500, "num_agent_steps_sampled": 196650, "num_agent_steps_trained": 196500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1311, "num_samples_added_to_queue": 196500, "learner_queue": {"size_count": 655, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.319, "learner_load_time_ms": 0.323, "learner_load_wait_time_ms": 988.97, "learner_dequeue_time_ms": 8630.255}}, "env_runners": {"episode_reward_max": 137.0999999999999, "episode_reward_min": -142.1088888888889, "episode_reward_mean": -13.20590000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -142.1088888888889}, "policy_reward_max": {"default_policy": 137.0999999999999}, "policy_reward_mean": {"default_policy": -13.20590000000002}, "custom_metrics": {"num_consolidated_mean": 0.8801000000000001, "num_consolidated_min": 0.66, "num_consolidated_max": 1.12, "num_overloaded_mean": 0.5456, "num_overloaded_min": 0.28, "num_overloaded_max": 0.84, "num_moves_mean": 9.488199999999999, "num_moves_min": 8.91, "num_moves_max": 10.04, "mean_accuracy_mean": 40.087489999999995, "mean_accuracy_min": 39.59899999999998, "mean_accuracy_max": 40.48566666666666, "num_model_switches_mean": 5.0256, "num_model_switches_min": 4.32, "num_model_switches_max": 5.72, "num_slav_mean": 0.05650583333333334, "num_slav_min": 0.03018333333333333, "num_slav_max": 0.0874, "mean_cluster_cpu_util_mean": 0.5099879188920666, "mean_cluster_cpu_util_min": 0.48025615359695906, "mean_cluster_cpu_util_max": 0.5486784508466248, "mean_cluster_mem_util_mean": 0.3352578859952209, "mean_cluster_mem_util_min": 0.320500172220787, "mean_cluster_mem_util_max": 0.355080189048193, "reward_consolidation_mean_mean": 0.6594444444444444, "reward_consolidation_mean_min": 0.3055555555555555, "reward_consolidation_mean_max": 1.1388888888888888, "reward_illegal_mean_mean": -0.9093333333333332, "reward_illegal_mean_min": -1.3999999999999997, "reward_illegal_mean_max": -0.4666666666666666, "reward_accuracy_mean_mean": 1.0251076666666663, "reward_accuracy_mean_min": 0.6202666666666665, "reward_accuracy_mean_max": 1.4523333333333333, "reward_sla_mean_mean": -0.9072777777777776, "reward_sla_mean_min": -1.5688888888888888, "reward_sla_mean_max": -0.5166666666666666, "reward_consolidation_sum_mean": 65.94444444444443, "reward_consolidation_sum_min": 30.55555555555555, "reward_consolidation_sum_max": 113.88888888888889, "reward_illegal_sum_mean": -90.93333333333331, "reward_illegal_sum_min": -139.99999999999997, "reward_illegal_sum_max": -46.666666666666664, "reward_accuracy_sum_mean": 102.51076666666664, "reward_accuracy_sum_min": 62.02666666666666, "reward_accuracy_sum_max": 145.23333333333332, "reward_sla_sum_mean": -90.72777777777779, "reward_sla_sum_min": -156.88888888888889, "reward_sla_sum_max": -51.666666666666664, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2165.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-113.51666666666677, -90.87777777777784, -97.06388888888894, -87.96222222222225, -135.7450000000001, -103.47611111111124, -100.56277777777777, -125.04055555555566, -133.20611111111117, -81.23944444444446, -142.1088888888889, -110.55555555555561, -68.69333333333334, -74.82444444444445, -77.07499999999999, -98.14333333333336, -105.73111111111122, -72.70166666666667, -70.68611111111107, -48.4061111111111, -25.481111111111115, -28.957222222222242, -56.61166666666665, -71.65499999999997, -89.68333333333338, -87.51, -82.13444444444451, -82.57333333333332, -22.99000000000002, -107.80666666666673, -83.3166666666667, -11.11888888888891, -69.35999999999999, -92.8666666666667, -97.20277777777783, -66.51722222222219, -35.62388888888889, -60.86611111111109, -29.577777777777797, -52.482777777777734, -59.392777777777745, -31.80222222222224, -30.665000000000045, -16.292222222222225, 3.284999999999977, -29.702777777777804, -2.8705555555555717, 62.46555555555554, 24.58666666666661, 15.41277777777777, 30.23888888888887, -9.30611111111112, -32.65000000000001, -32.592777777777805, 22.54555555555553, -20.352777777777803, 22.194444444444414, -8.115000000000013, -0.41055555555557377, 46.237222222222194, 16.958333333333318, -30.146111111111118, -32.05055555555556, -5.8322222222222315, -8.276666666666678, 4.129444444444417, -14.876666666666683, 40.338888888888896, -14.25500000000001, 41.80666666666669, 1.1038888888888696, 9.057777777777778, 41.2961111111111, 93.7116666666666, 69.83999999999997, 85.25611111111108, 99.78999999999995, 63.80777777777779, 100.15499999999999, 67.06111111111103, 43.109444444444456, 3.812777777777775, 54.854444444444454, 49.8277777777778, 38.634999999999984, 38.65777777777776, 94.52777777777777, 78.30944444444435, 129.68777777777774, 137.0999999999999, 38.73666666666666, 64.07222222222222, 43.55555555555552, 2.3755555555555348, 115.51111111111109, 32.261666666666656, 70.73666666666662, 83.98944444444439, 84.14388888888885, 85.76777777777774], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-113.51666666666677, -90.87777777777784, -97.06388888888894, -87.96222222222225, -135.7450000000001, -103.47611111111124, -100.56277777777777, -125.04055555555566, -133.20611111111117, -81.23944444444446, -142.1088888888889, -110.55555555555561, -68.69333333333334, -74.82444444444445, -77.07499999999999, -98.14333333333336, -105.73111111111122, -72.70166666666667, -70.68611111111107, -48.4061111111111, -25.481111111111115, -28.957222222222242, -56.61166666666665, -71.65499999999997, -89.68333333333338, -87.51, -82.13444444444451, -82.57333333333332, -22.99000000000002, -107.80666666666673, -83.3166666666667, -11.11888888888891, -69.35999999999999, -92.8666666666667, -97.20277777777783, -66.51722222222219, -35.62388888888889, -60.86611111111109, -29.577777777777797, -52.482777777777734, -59.392777777777745, -31.80222222222224, -30.665000000000045, -16.292222222222225, 3.284999999999977, -29.702777777777804, -2.8705555555555717, 62.46555555555554, 24.58666666666661, 15.41277777777777, 30.23888888888887, -9.30611111111112, -32.65000000000001, -32.592777777777805, 22.54555555555553, -20.352777777777803, 22.194444444444414, -8.115000000000013, -0.41055555555557377, 46.237222222222194, 16.958333333333318, -30.146111111111118, -32.05055555555556, -5.8322222222222315, -8.276666666666678, 4.129444444444417, -14.876666666666683, 40.338888888888896, -14.25500000000001, 41.80666666666669, 1.1038888888888696, 9.057777777777778, 41.2961111111111, 93.7116666666666, 69.83999999999997, 85.25611111111108, 99.78999999999995, 63.80777777777779, 100.15499999999999, 67.06111111111103, 43.109444444444456, 3.812777777777775, 54.854444444444454, 49.8277777777778, 38.634999999999984, 38.65777777777776, 94.52777777777777, 78.30944444444435, 129.68777777777774, 137.0999999999999, 38.73666666666666, 64.07222222222222, 43.55555555555552, 2.3755555555555348, 115.51111111111109, 32.261666666666656, 70.73666666666662, 83.98944444444439, 84.14388888888885, 85.76777777777774]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19325449148340945, "mean_inference_ms": 1.7753879861919524, "mean_action_processing_ms": 0.07363194308221344, "mean_env_wait_ms": 1.203300036483825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004446744918823242, "StateBufferConnector_ms": 0.003001689910888672, "ViewRequirementAgentConnector_ms": 0.06836295127868652}, "num_episodes": 30, "episode_return_max": 137.0999999999999, "episode_return_min": -142.1088888888889, "episode_return_mean": -13.20590000000002, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196650, "num_agent_steps_trained": 196500, "num_env_steps_sampled": 196650, "num_env_steps_trained": 196500, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 290.13257581216305, "num_env_steps_trained_throughput_per_sec": 290.13257581216305, "timesteps_total": 196650, "num_env_steps_sampled_lifetime": 196650, "num_agent_steps_sampled_lifetime": 196650, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 196650, "timers": {"training_iteration_time_ms": 10262.742, "restore_workers_time_ms": 0.011, "training_step_time_ms": 508.624, "sample_time_ms": 493.247, "synch_weights_time_ms": 13.936}, "counters": {"num_env_steps_sampled": 196650, "num_env_steps_trained": 196500, "num_agent_steps_sampled": 196650, "num_agent_steps_trained": 196500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1311, "num_samples_added_to_queue": 196500}, "done": false, "training_iteration": 65, "trial_id": "0313d_00000", "date": "2024-10-10_21-52-34", "timestamp": 1728593554, "time_this_iter_s": 10.359498977661133, "time_total_s": 668.1481196880341, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae4319f4c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 668.1481196880341, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 11.133333333333335, "ram_util_percent": 59.59333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 184899.359375, "policy_loss": 184845.65625, "entropy": 24.764522552490234, "entropy_coeff": 0.01, "var_gnorm": 16.425399780273438, "vf_loss": 128005.2265625, "vf_explained_var": -0.8471742868423462}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 664.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 199350, "num_env_steps_trained": 199200, "num_agent_steps_sampled": 199350, "num_agent_steps_trained": 199200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1329, "num_samples_added_to_queue": 199200, "learner_queue": {"size_count": 664, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.645, "learner_load_time_ms": 0.336, "learner_load_wait_time_ms": 1048.764, "learner_dequeue_time_ms": 8632.983}}, "env_runners": {"episode_reward_max": 171.39055555555555, "episode_reward_min": -107.80666666666673, "episode_reward_mean": 40.51838333333331, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -107.80666666666673}, "policy_reward_max": {"default_policy": 171.39055555555555}, "policy_reward_mean": {"default_policy": 40.51838333333331}, "custom_metrics": {"num_consolidated_mean": 0.9706999999999999, "num_consolidated_min": 0.7, "num_consolidated_max": 1.33, "num_overloaded_mean": 0.4582, "num_overloaded_min": 0.22, "num_overloaded_max": 0.82, "num_moves_mean": 9.2872, "num_moves_min": 8.53, "num_moves_max": 9.86, "mean_accuracy_mean": 39.97836666666666, "mean_accuracy_min": 39.59899999999998, "mean_accuracy_max": 40.321, "num_model_switches_mean": 4.7734, "num_model_switches_min": 3.93, "num_model_switches_max": 5.57, "num_slav_mean": 0.04539883333333333, "num_slav_min": 0.022016666666666667, "num_slav_max": 0.08568333333333333, "mean_cluster_cpu_util_mean": 0.5002651217905048, "mean_cluster_cpu_util_min": 0.48025615359695906, "mean_cluster_cpu_util_max": 0.5284889610078382, "mean_cluster_mem_util_mean": 0.3293066322691524, "mean_cluster_mem_util_min": 0.31444610368408965, "mean_cluster_mem_util_max": 0.3445174750279859, "reward_consolidation_mean_mean": 0.8243055555555554, "reward_consolidation_mean_min": 0.3472222222222222, "reward_consolidation_mean_max": 1.375, "reward_illegal_mean_mean": -0.7636666666666666, "reward_illegal_mean_min": -1.3666666666666665, "reward_illegal_mean_max": -0.3666666666666666, "reward_accuracy_mean_mean": 1.1628671666666661, "reward_accuracy_mean_min": 0.6202666666666665, "reward_accuracy_mean_max": 1.546533333333333, "reward_sla_mean_mean": -0.8183222222222224, "reward_sla_mean_min": -1.2550000000000001, "reward_sla_mean_max": -0.3783333333333333, "reward_consolidation_sum_mean": 82.43055555555557, "reward_consolidation_sum_min": 34.72222222222222, "reward_consolidation_sum_max": 137.5, "reward_illegal_sum_mean": -76.36666666666666, "reward_illegal_sum_min": -136.66666666666666, "reward_illegal_sum_max": -36.66666666666666, "reward_accuracy_sum_mean": 116.28671666666659, "reward_accuracy_sum_min": 62.02666666666666, "reward_accuracy_sum_max": 154.6533333333333, "reward_sla_sum_mean": -81.83222222222223, "reward_sla_sum_min": -125.50000000000001, "reward_sla_sum_max": -37.83333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2358.0, "global_timestep_min": 300, "global_timestep_max": 4000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-82.57333333333332, -22.99000000000002, -107.80666666666673, -83.3166666666667, -11.11888888888891, -69.35999999999999, -92.8666666666667, -97.20277777777783, -66.51722222222219, -35.62388888888889, -60.86611111111109, -29.577777777777797, -52.482777777777734, -59.392777777777745, -31.80222222222224, -30.665000000000045, -16.292222222222225, 3.284999999999977, -29.702777777777804, -2.8705555555555717, 62.46555555555554, 24.58666666666661, 15.41277777777777, 30.23888888888887, -9.30611111111112, -32.65000000000001, -32.592777777777805, 22.54555555555553, -20.352777777777803, 22.194444444444414, -8.115000000000013, -0.41055555555557377, 46.237222222222194, 16.958333333333318, -30.146111111111118, -32.05055555555556, -5.8322222222222315, -8.276666666666678, 4.129444444444417, -14.876666666666683, 40.338888888888896, -14.25500000000001, 41.80666666666669, 1.1038888888888696, 9.057777777777778, 41.2961111111111, 93.7116666666666, 69.83999999999997, 85.25611111111108, 99.78999999999995, 63.80777777777779, 100.15499999999999, 67.06111111111103, 43.109444444444456, 3.812777777777775, 54.854444444444454, 49.8277777777778, 38.634999999999984, 38.65777777777776, 94.52777777777777, 78.30944444444435, 129.68777777777774, 137.0999999999999, 38.73666666666666, 64.07222222222222, 43.55555555555552, 2.3755555555555348, 115.51111111111109, 32.261666666666656, 70.73666666666662, 83.98944444444439, 84.14388888888885, 85.76777777777774, 84.1338888888888, 99.19555555555553, 108.85666666666658, 105.42888888888889, 93.50555555555549, 89.75999999999995, 117.37666666666664, 171.39055555555555, 147.1, 98.28499999999998, 39.778888888888844, 76.38222222222215, 125.54388888888884, 124.59333333333328, 161.78222222222223, 170.8200000000001, 118.03111111111104, 112.14166666666661, 86.11166666666664, 132.85277777777773, 82.9749999999999, 62.460555555555494, 57.05499999999999, 135.65444444444444, 130.38555555555553, 109.4588888888888, 151.71944444444443], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-82.57333333333332, -22.99000000000002, -107.80666666666673, -83.3166666666667, -11.11888888888891, -69.35999999999999, -92.8666666666667, -97.20277777777783, -66.51722222222219, -35.62388888888889, -60.86611111111109, -29.577777777777797, -52.482777777777734, -59.392777777777745, -31.80222222222224, -30.665000000000045, -16.292222222222225, 3.284999999999977, -29.702777777777804, -2.8705555555555717, 62.46555555555554, 24.58666666666661, 15.41277777777777, 30.23888888888887, -9.30611111111112, -32.65000000000001, -32.592777777777805, 22.54555555555553, -20.352777777777803, 22.194444444444414, -8.115000000000013, -0.41055555555557377, 46.237222222222194, 16.958333333333318, -30.146111111111118, -32.05055555555556, -5.8322222222222315, -8.276666666666678, 4.129444444444417, -14.876666666666683, 40.338888888888896, -14.25500000000001, 41.80666666666669, 1.1038888888888696, 9.057777777777778, 41.2961111111111, 93.7116666666666, 69.83999999999997, 85.25611111111108, 99.78999999999995, 63.80777777777779, 100.15499999999999, 67.06111111111103, 43.109444444444456, 3.812777777777775, 54.854444444444454, 49.8277777777778, 38.634999999999984, 38.65777777777776, 94.52777777777777, 78.30944444444435, 129.68777777777774, 137.0999999999999, 38.73666666666666, 64.07222222222222, 43.55555555555552, 2.3755555555555348, 115.51111111111109, 32.261666666666656, 70.73666666666662, 83.98944444444439, 84.14388888888885, 85.76777777777774, 84.1338888888888, 99.19555555555553, 108.85666666666658, 105.42888888888889, 93.50555555555549, 89.75999999999995, 117.37666666666664, 171.39055555555555, 147.1, 98.28499999999998, 39.778888888888844, 76.38222222222215, 125.54388888888884, 124.59333333333328, 161.78222222222223, 170.8200000000001, 118.03111111111104, 112.14166666666661, 86.11166666666664, 132.85277777777773, 82.9749999999999, 62.460555555555494, 57.05499999999999, 135.65444444444444, 130.38555555555553, 109.4588888888888, 151.71944444444443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19335672544825808, "mean_inference_ms": 1.7750627989980519, "mean_action_processing_ms": 0.0736690105080302, "mean_env_wait_ms": 1.2038515118984479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004446506500244141, "StateBufferConnector_ms": 0.0030281543731689453, "ViewRequirementAgentConnector_ms": 0.06814002990722656}, "num_episodes": 27, "episode_return_max": 171.39055555555555, "episode_return_min": -107.80666666666673, "episode_return_mean": 40.51838333333331, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 199350, "num_agent_steps_trained": 199200, "num_env_steps_sampled": 199350, "num_env_steps_trained": 199200, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 268.6805372310216, "num_env_steps_trained_throughput_per_sec": 268.6805372310216, "timesteps_total": 199350, "num_env_steps_sampled_lifetime": 199350, "num_agent_steps_sampled_lifetime": 199350, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 199350, "timers": {"training_iteration_time_ms": 10261.858, "restore_workers_time_ms": 0.013, "training_step_time_ms": 550.825, "sample_time_ms": 535.292, "synch_weights_time_ms": 14.084}, "counters": {"num_env_steps_sampled": 199350, "num_env_steps_trained": 199200, "num_agent_steps_sampled": 199350, "num_agent_steps_trained": 199200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1329, "num_samples_added_to_queue": 199200}, "done": false, "training_iteration": 66, "trial_id": "0313d_00000", "date": "2024-10-10_21-52-44", "timestamp": 1728593564, "time_this_iter_s": 10.05846881866455, "time_total_s": 678.2065885066986, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c1aaa0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 678.2065885066986, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 13.773333333333333, "ram_util_percent": 60.286666666666655}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 194405.90625, "policy_loss": 194313.40625, "entropy": 23.698087692260742, "entropy_coeff": 0.01, "var_gnorm": 16.448955535888672, "vf_loss": 163599.3125, "vf_explained_var": -0.5918166637420654}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 674.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 202350, "num_env_steps_trained": 202200, "num_agent_steps_sampled": 202350, "num_agent_steps_trained": 202200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1349, "num_samples_added_to_queue": 202200, "learner_queue": {"size_count": 674, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 49.512, "learner_load_time_ms": 0.334, "learner_load_wait_time_ms": 1010.415, "learner_dequeue_time_ms": 8674.589}}, "env_runners": {"episode_reward_max": 217.3250000000001, "episode_reward_min": -32.05055555555556, "episode_reward_mean": 97.71602222222224, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -32.05055555555556}, "policy_reward_max": {"default_policy": 217.3250000000001}, "policy_reward_mean": {"default_policy": 97.71602222222224}, "custom_metrics": {"num_consolidated_mean": 1.077, "num_consolidated_min": 0.74, "num_consolidated_max": 1.4, "num_overloaded_mean": 0.3765, "num_overloaded_min": 0.16, "num_overloaded_max": 0.63, "num_moves_mean": 9.017900000000001, "num_moves_min": 8.18, "num_moves_max": 9.69, "mean_accuracy_mean": 39.85518333333332, "mean_accuracy_min": 39.52299999999998, "mean_accuracy_max": 40.20699999999999, "num_model_switches_mean": 4.4868, "num_model_switches_min": 3.89, "num_model_switches_max": 5.28, "num_slav_mean": 0.03464116666666666, "num_slav_min": 0.016566666666666667, "num_slav_max": 0.05908333333333332, "mean_cluster_cpu_util_mean": 0.491262796368276, "mean_cluster_cpu_util_min": 0.47581212529841094, "mean_cluster_cpu_util_max": 0.5199971239129316, "mean_cluster_mem_util_mean": 0.32338989742996355, "mean_cluster_mem_util_min": 0.3127141881225064, "mean_cluster_mem_util_max": 0.33933702298429913, "reward_consolidation_mean_mean": 1.0026388888888889, "reward_consolidation_mean_min": 0.49999999999999994, "reward_consolidation_mean_max": 1.4861111111111112, "reward_illegal_mean_mean": -0.6275, "reward_illegal_mean_min": -1.05, "reward_illegal_mean_max": -0.26666666666666666, "reward_accuracy_mean_mean": 1.2934046666666663, "reward_accuracy_mean_min": 0.8741166666666664, "reward_accuracy_mean_max": 1.6682499999999996, "reward_sla_mean_mean": -0.6913833333333333, "reward_sla_mean_min": -1.0922222222222222, "reward_sla_mean_max": -0.29777777777777775, "reward_consolidation_sum_mean": 100.26388888888887, "reward_consolidation_sum_min": 49.99999999999999, "reward_consolidation_sum_max": 148.61111111111111, "reward_illegal_sum_mean": -62.74999999999999, "reward_illegal_sum_min": -105.0, "reward_illegal_sum_max": -26.666666666666668, "reward_accuracy_sum_mean": 129.34046666666663, "reward_accuracy_sum_min": 87.41166666666665, "reward_accuracy_sum_max": 166.82499999999996, "reward_sla_sum_mean": -69.13833333333334, "reward_sla_sum_min": -109.22222222222223, "reward_sla_sum_max": -29.777777777777775, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3363.0, "global_timestep_min": 1300, "global_timestep_max": 5000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-8.115000000000013, -0.41055555555557377, 46.237222222222194, 16.958333333333318, -30.146111111111118, -32.05055555555556, -5.8322222222222315, -8.276666666666678, 4.129444444444417, -14.876666666666683, 40.338888888888896, -14.25500000000001, 41.80666666666669, 1.1038888888888696, 9.057777777777778, 41.2961111111111, 93.7116666666666, 69.83999999999997, 85.25611111111108, 99.78999999999995, 63.80777777777779, 100.15499999999999, 67.06111111111103, 43.109444444444456, 3.812777777777775, 54.854444444444454, 49.8277777777778, 38.634999999999984, 38.65777777777776, 94.52777777777777, 78.30944444444435, 129.68777777777774, 137.0999999999999, 38.73666666666666, 64.07222222222222, 43.55555555555552, 2.3755555555555348, 115.51111111111109, 32.261666666666656, 70.73666666666662, 83.98944444444439, 84.14388888888885, 85.76777777777774, 84.1338888888888, 99.19555555555553, 108.85666666666658, 105.42888888888889, 93.50555555555549, 89.75999999999995, 117.37666666666664, 171.39055555555555, 147.1, 98.28499999999998, 39.778888888888844, 76.38222222222215, 125.54388888888884, 124.59333333333328, 161.78222222222223, 170.8200000000001, 118.03111111111104, 112.14166666666661, 86.11166666666664, 132.85277777777773, 82.9749999999999, 62.460555555555494, 57.05499999999999, 135.65444444444444, 130.38555555555553, 109.4588888888888, 151.71944444444443, 145.50555555555556, 137.88611111111106, 188.40500000000014, 163.38777777777776, 183.10666666666668, 134.64388888888894, 186.273888888889, 152.2294444444444, 172.80000000000013, 168.68722222222232, 114.4083333333332, 123.07777777777775, 135.84722222222223, 162.2722222222222, 162.64611111111114, 180.56111111111116, 176.48000000000008, 194.98444444444453, 217.3250000000001, 170.81500000000003, 152.78222222222226, 131.71833333333325, 176.89222222222227, 175.3477777777778, 98.78444444444439, 153.7838888888888, 170.75888888888895, 176.4977777777779, 158.66611111111118, 155.9883333333334], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-8.115000000000013, -0.41055555555557377, 46.237222222222194, 16.958333333333318, -30.146111111111118, -32.05055555555556, -5.8322222222222315, -8.276666666666678, 4.129444444444417, -14.876666666666683, 40.338888888888896, -14.25500000000001, 41.80666666666669, 1.1038888888888696, 9.057777777777778, 41.2961111111111, 93.7116666666666, 69.83999999999997, 85.25611111111108, 99.78999999999995, 63.80777777777779, 100.15499999999999, 67.06111111111103, 43.109444444444456, 3.812777777777775, 54.854444444444454, 49.8277777777778, 38.634999999999984, 38.65777777777776, 94.52777777777777, 78.30944444444435, 129.68777777777774, 137.0999999999999, 38.73666666666666, 64.07222222222222, 43.55555555555552, 2.3755555555555348, 115.51111111111109, 32.261666666666656, 70.73666666666662, 83.98944444444439, 84.14388888888885, 85.76777777777774, 84.1338888888888, 99.19555555555553, 108.85666666666658, 105.42888888888889, 93.50555555555549, 89.75999999999995, 117.37666666666664, 171.39055555555555, 147.1, 98.28499999999998, 39.778888888888844, 76.38222222222215, 125.54388888888884, 124.59333333333328, 161.78222222222223, 170.8200000000001, 118.03111111111104, 112.14166666666661, 86.11166666666664, 132.85277777777773, 82.9749999999999, 62.460555555555494, 57.05499999999999, 135.65444444444444, 130.38555555555553, 109.4588888888888, 151.71944444444443, 145.50555555555556, 137.88611111111106, 188.40500000000014, 163.38777777777776, 183.10666666666668, 134.64388888888894, 186.273888888889, 152.2294444444444, 172.80000000000013, 168.68722222222232, 114.4083333333332, 123.07777777777775, 135.84722222222223, 162.2722222222222, 162.64611111111114, 180.56111111111116, 176.48000000000008, 194.98444444444453, 217.3250000000001, 170.81500000000003, 152.78222222222226, 131.71833333333325, 176.89222222222227, 175.3477777777778, 98.78444444444439, 153.7838888888888, 170.75888888888895, 176.4977777777779, 158.66611111111118, 155.9883333333334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19355490161844585, "mean_inference_ms": 1.7778284267192965, "mean_action_processing_ms": 0.07374278291144211, "mean_env_wait_ms": 1.2050545111363082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004422664642333984, "StateBufferConnector_ms": 0.0030198097229003906, "ViewRequirementAgentConnector_ms": 0.06808710098266602}, "num_episodes": 30, "episode_return_max": 217.3250000000001, "episode_return_min": -32.05055555555556, "episode_return_mean": 97.71602222222224, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 202350, "num_agent_steps_trained": 202200, "num_env_steps_sampled": 202350, "num_env_steps_trained": 202200, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 286.60913488444555, "num_env_steps_trained_throughput_per_sec": 286.60913488444555, "timesteps_total": 202350, "num_env_steps_sampled_lifetime": 202350, "num_agent_steps_sampled_lifetime": 202350, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 202350, "timers": {"training_iteration_time_ms": 10307.568, "restore_workers_time_ms": 0.011, "training_step_time_ms": 528.094, "sample_time_ms": 513.069, "synch_weights_time_ms": 13.632}, "counters": {"num_env_steps_sampled": 202350, "num_env_steps_trained": 202200, "num_agent_steps_sampled": 202350, "num_agent_steps_trained": 202200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1349, "num_samples_added_to_queue": 202200}, "done": false, "training_iteration": 67, "trial_id": "0313d_00000", "date": "2024-10-10_21-52-55", "timestamp": 1728593575, "time_this_iter_s": 10.47977328300476, "time_total_s": 688.6863617897034, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c19bd0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 688.6863617897034, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 11.426666666666668, "ram_util_percent": 60.239999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 213171.96875, "policy_loss": 213022.140625, "entropy": 22.891334533691406, "entropy_coeff": 0.01, "var_gnorm": 16.466026306152344, "vf_loss": 218502.921875, "vf_explained_var": -0.5053671598434448}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 683.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 205200, "num_env_steps_trained": 204900, "num_agent_steps_sampled": 205200, "num_agent_steps_trained": 204900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1368, "num_samples_added_to_queue": 205200, "learner_queue": {"size_count": 683, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.01, "learner_load_time_ms": 0.307, "learner_load_wait_time_ms": 1050.078, "learner_dequeue_time_ms": 8638.931}}, "env_runners": {"episode_reward_max": 245.133888888889, "episode_reward_min": 2.3755555555555348, "episode_reward_mean": 146.38948333333335, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 2.3755555555555348}, "policy_reward_max": {"default_policy": 245.133888888889}, "policy_reward_mean": {"default_policy": 146.38948333333335}, "custom_metrics": {"num_consolidated_mean": 1.1838000000000002, "num_consolidated_min": 0.92, "num_consolidated_max": 1.48, "num_overloaded_mean": 0.31489999999999996, "num_overloaded_min": 0.13, "num_overloaded_max": 0.5, "num_moves_mean": 8.704699999999997, "num_moves_min": 7.88, "num_moves_max": 9.51, "mean_accuracy_mean": 39.750873333333324, "mean_accuracy_min": 39.45333333333332, "mean_accuracy_max": 40.09299999999998, "num_model_switches_mean": 4.2477, "num_model_switches_min": 3.58, "num_model_switches_max": 5.1, "num_slav_mean": 0.026610333333333326, "num_slav_min": 0.01215, "num_slav_max": 0.04741666666666666, "mean_cluster_cpu_util_mean": 0.48425950933477824, "mean_cluster_cpu_util_min": 0.46658565160572707, "mean_cluster_cpu_util_max": 0.5102574235253546, "mean_cluster_mem_util_mean": 0.31807380870934876, "mean_cluster_mem_util_min": 0.3076573400140647, "mean_cluster_mem_util_max": 0.33565015751026145, "reward_consolidation_mean_mean": 1.179722222222222, "reward_consolidation_mean_min": 0.6527777777777777, "reward_consolidation_mean_max": 1.611111111111111, "reward_illegal_mean_mean": -0.5248333333333333, "reward_illegal_mean_min": -0.8333333333333333, "reward_illegal_mean_max": -0.21666666666666665, "reward_accuracy_mean_mean": 1.395394833333333, "reward_accuracy_mean_min": 1.0748666666666662, "reward_accuracy_mean_max": 1.7441166666666665, "reward_sla_mean_mean": -0.586388888888889, "reward_sla_mean_min": -0.9544444444444444, "reward_sla_mean_max": -0.1927777777777778, "reward_consolidation_sum_mean": 117.97222222222221, "reward_consolidation_sum_min": 65.27777777777777, "reward_consolidation_sum_max": 161.1111111111111, "reward_illegal_sum_mean": -52.48333333333333, "reward_illegal_sum_min": -83.33333333333333, "reward_illegal_sum_max": -21.666666666666664, "reward_accuracy_sum_mean": 139.5394833333333, "reward_accuracy_sum_min": 107.48666666666662, "reward_accuracy_sum_max": 174.41166666666666, "reward_sla_sum_mean": -58.63888888888889, "reward_sla_sum_min": -95.44444444444444, "reward_sla_sum_max": -19.27777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4357.0, "global_timestep_min": 2200, "global_timestep_max": 6000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [78.30944444444435, 129.68777777777774, 137.0999999999999, 38.73666666666666, 64.07222222222222, 43.55555555555552, 2.3755555555555348, 115.51111111111109, 32.261666666666656, 70.73666666666662, 83.98944444444439, 84.14388888888885, 85.76777777777774, 84.1338888888888, 99.19555555555553, 108.85666666666658, 105.42888888888889, 93.50555555555549, 89.75999999999995, 117.37666666666664, 171.39055555555555, 147.1, 98.28499999999998, 39.778888888888844, 76.38222222222215, 125.54388888888884, 124.59333333333328, 161.78222222222223, 170.8200000000001, 118.03111111111104, 112.14166666666661, 86.11166666666664, 132.85277777777773, 82.9749999999999, 62.460555555555494, 57.05499999999999, 135.65444444444444, 130.38555555555553, 109.4588888888888, 151.71944444444443, 145.50555555555556, 137.88611111111106, 188.40500000000014, 163.38777777777776, 183.10666666666668, 134.64388888888894, 186.273888888889, 152.2294444444444, 172.80000000000013, 168.68722222222232, 114.4083333333332, 123.07777777777775, 135.84722222222223, 162.2722222222222, 162.64611111111114, 180.56111111111116, 176.48000000000008, 194.98444444444453, 217.3250000000001, 170.81500000000003, 152.78222222222226, 131.71833333333325, 176.89222222222227, 175.3477777777778, 98.78444444444439, 153.7838888888888, 170.75888888888895, 176.4977777777779, 158.66611111111118, 155.9883333333334, 172.4816666666668, 171.88666666666668, 172.7966666666669, 186.1977777777778, 235.413888888889, 191.15222222222235, 175.84277777777783, 181.0433333333335, 182.43500000000003, 182.41777777777784, 166.48833333333343, 180.16666666666674, 193.21166666666673, 203.85777777777787, 209.61555555555566, 192.2505555555557, 188.3383333333333, 187.14777777777786, 222.87722222222237, 197.81277777777788, 196.22500000000008, 166.53333333333336, 206.39055555555564, 196.43944444444452, 206.19444444444449, 205.04500000000013, 245.133888888889, 214.97944444444465, 202.74277777777792, 224.2400000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [78.30944444444435, 129.68777777777774, 137.0999999999999, 38.73666666666666, 64.07222222222222, 43.55555555555552, 2.3755555555555348, 115.51111111111109, 32.261666666666656, 70.73666666666662, 83.98944444444439, 84.14388888888885, 85.76777777777774, 84.1338888888888, 99.19555555555553, 108.85666666666658, 105.42888888888889, 93.50555555555549, 89.75999999999995, 117.37666666666664, 171.39055555555555, 147.1, 98.28499999999998, 39.778888888888844, 76.38222222222215, 125.54388888888884, 124.59333333333328, 161.78222222222223, 170.8200000000001, 118.03111111111104, 112.14166666666661, 86.11166666666664, 132.85277777777773, 82.9749999999999, 62.460555555555494, 57.05499999999999, 135.65444444444444, 130.38555555555553, 109.4588888888888, 151.71944444444443, 145.50555555555556, 137.88611111111106, 188.40500000000014, 163.38777777777776, 183.10666666666668, 134.64388888888894, 186.273888888889, 152.2294444444444, 172.80000000000013, 168.68722222222232, 114.4083333333332, 123.07777777777775, 135.84722222222223, 162.2722222222222, 162.64611111111114, 180.56111111111116, 176.48000000000008, 194.98444444444453, 217.3250000000001, 170.81500000000003, 152.78222222222226, 131.71833333333325, 176.89222222222227, 175.3477777777778, 98.78444444444439, 153.7838888888888, 170.75888888888895, 176.4977777777779, 158.66611111111118, 155.9883333333334, 172.4816666666668, 171.88666666666668, 172.7966666666669, 186.1977777777778, 235.413888888889, 191.15222222222235, 175.84277777777783, 181.0433333333335, 182.43500000000003, 182.41777777777784, 166.48833333333343, 180.16666666666674, 193.21166666666673, 203.85777777777787, 209.61555555555566, 192.2505555555557, 188.3383333333333, 187.14777777777786, 222.87722222222237, 197.81277777777788, 196.22500000000008, 166.53333333333336, 206.39055555555564, 196.43944444444452, 206.19444444444449, 205.04500000000013, 245.133888888889, 214.97944444444465, 202.74277777777792, 224.2400000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19375267110919295, "mean_inference_ms": 1.7793618509366786, "mean_action_processing_ms": 0.0738139209772245, "mean_env_wait_ms": 1.2060562038606346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004533290863037109, "StateBufferConnector_ms": 0.0030324459075927734, "ViewRequirementAgentConnector_ms": 0.06836891174316406}, "num_episodes": 30, "episode_return_max": 245.133888888889, "episode_return_min": 2.3755555555555348, "episode_return_mean": 146.38948333333335, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 205200, "num_agent_steps_trained": 204900, "num_env_steps_sampled": 205200, "num_env_steps_trained": 204900, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 269.96310846123237, "num_env_steps_trained_throughput_per_sec": 255.75452380537806, "timesteps_total": 205200, "num_env_steps_sampled_lifetime": 205200, "num_agent_steps_sampled_lifetime": 205200, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 205200, "timers": {"training_iteration_time_ms": 10322.573, "restore_workers_time_ms": 0.011, "training_step_time_ms": 550.316, "sample_time_ms": 535.504, "synch_weights_time_ms": 13.46}, "counters": {"num_env_steps_sampled": 205200, "num_env_steps_trained": 204900, "num_agent_steps_sampled": 205200, "num_agent_steps_trained": 204900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1368, "num_samples_added_to_queue": 205200}, "done": false, "training_iteration": 68, "trial_id": "0313d_00000", "date": "2024-10-10_21-53-05", "timestamp": 1728593585, "time_this_iter_s": 10.566909790039062, "time_total_s": 699.2532715797424, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c17a60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 699.2532715797424, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 13.653333333333334, "ram_util_percent": 60.72666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 235554.34375, "policy_loss": 235366.4375, "entropy": 22.345428466796875, "entropy_coeff": 0.01, "var_gnorm": 16.478065490722656, "vf_loss": 254934.5, "vf_explained_var": -0.6771814823150635}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 693.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 208050, "num_env_steps_trained": 207900, "num_agent_steps_sampled": 208050, "num_agent_steps_trained": 207900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1387, "num_samples_added_to_queue": 207900, "learner_queue": {"size_count": 693, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.849, "learner_load_time_ms": 0.28, "learner_load_wait_time_ms": 1046.511, "learner_dequeue_time_ms": 8634.045}}, "env_runners": {"episode_reward_max": 278.74833333333345, "episode_reward_min": 57.05499999999999, "episode_reward_mean": 182.49501111111115, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 57.05499999999999}, "policy_reward_max": {"default_policy": 278.74833333333345}, "policy_reward_mean": {"default_policy": 182.49501111111115}, "custom_metrics": {"num_consolidated_mean": 1.2643, "num_consolidated_min": 0.92, "num_consolidated_max": 1.53, "num_overloaded_mean": 0.2712, "num_overloaded_min": 0.13, "num_overloaded_max": 0.44, "num_moves_mean": 8.4438, "num_moves_min": 7.74, "num_moves_max": 9.22, "mean_accuracy_mean": 39.67651999999999, "mean_accuracy_min": 39.41533333333332, "mean_accuracy_max": 40.029666666666664, "num_model_switches_mean": 4.0567, "num_model_switches_min": 3.48, "num_model_switches_max": 4.63, "num_slav_mean": 0.021791166666666667, "num_slav_min": 0.009116666666666667, "num_slav_max": 0.0385, "mean_cluster_cpu_util_mean": 0.47929019456972505, "mean_cluster_cpu_util_min": 0.4638784538146584, "mean_cluster_cpu_util_max": 0.49852649429327806, "mean_cluster_mem_util_mean": 0.3141399318543873, "mean_cluster_mem_util_min": 0.30428465512787395, "mean_cluster_mem_util_max": 0.32557459259020066, "reward_consolidation_mean_mean": 1.3156944444444445, "reward_consolidation_mean_min": 0.847222222222222, "reward_consolidation_mean_max": 1.7361111111111114, "reward_illegal_mean_mean": -0.4519999999999999, "reward_illegal_mean_min": -0.7333333333333333, "reward_illegal_mean_max": -0.21666666666666665, "reward_accuracy_mean_mean": 1.4665056666666663, "reward_accuracy_mean_min": 1.1744499999999995, "reward_accuracy_mean_max": 1.7441166666666665, "reward_sla_mean_mean": -0.50525, "reward_sla_mean_min": -0.9272222222222223, "reward_sla_mean_max": -0.1927777777777778, "reward_consolidation_sum_mean": 131.56944444444443, "reward_consolidation_sum_min": 84.7222222222222, "reward_consolidation_sum_max": 173.61111111111114, "reward_illegal_sum_mean": -45.2, "reward_illegal_sum_min": -73.33333333333333, "reward_illegal_sum_max": -21.666666666666664, "reward_accuracy_sum_mean": 146.65056666666666, "reward_accuracy_sum_min": 117.44499999999996, "reward_accuracy_sum_max": 174.41166666666666, "reward_sla_sum_mean": -50.52499999999999, "reward_sla_sum_min": -92.72222222222223, "reward_sla_sum_max": -19.27777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5263.0, "global_timestep_min": 3200, "global_timestep_max": 6900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [161.78222222222223, 170.8200000000001, 118.03111111111104, 112.14166666666661, 86.11166666666664, 132.85277777777773, 82.9749999999999, 62.460555555555494, 57.05499999999999, 135.65444444444444, 130.38555555555553, 109.4588888888888, 151.71944444444443, 145.50555555555556, 137.88611111111106, 188.40500000000014, 163.38777777777776, 183.10666666666668, 134.64388888888894, 186.273888888889, 152.2294444444444, 172.80000000000013, 168.68722222222232, 114.4083333333332, 123.07777777777775, 135.84722222222223, 162.2722222222222, 162.64611111111114, 180.56111111111116, 176.48000000000008, 194.98444444444453, 217.3250000000001, 170.81500000000003, 152.78222222222226, 131.71833333333325, 176.89222222222227, 175.3477777777778, 98.78444444444439, 153.7838888888888, 170.75888888888895, 176.4977777777779, 158.66611111111118, 155.9883333333334, 172.4816666666668, 171.88666666666668, 172.7966666666669, 186.1977777777778, 235.413888888889, 191.15222222222235, 175.84277777777783, 181.0433333333335, 182.43500000000003, 182.41777777777784, 166.48833333333343, 180.16666666666674, 193.21166666666673, 203.85777777777787, 209.61555555555566, 192.2505555555557, 188.3383333333333, 187.14777777777786, 222.87722222222237, 197.81277777777788, 196.22500000000008, 166.53333333333336, 206.39055555555564, 196.43944444444452, 206.19444444444449, 205.04500000000013, 245.133888888889, 214.97944444444465, 202.74277777777792, 224.2400000000001, 257.9711111111112, 149.40222222222224, 251.27166666666685, 215.75000000000014, 229.8416666666669, 204.94777777777793, 257.38944444444456, 227.0183333333335, 224.44111111111133, 248.5327777777779, 251.99555555555568, 212.76500000000013, 201.363888888889, 222.87611111111136, 241.1066666666667, 227.5966666666668, 278.74833333333345, 262.54333333333346, 226.67944444444464, 191.53666666666683, 214.92611111111117, 216.74833333333348, 222.27333333333348, 215.05166666666688, 213.72444444444457, 185.4177777777779, 206.21222222222235], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [161.78222222222223, 170.8200000000001, 118.03111111111104, 112.14166666666661, 86.11166666666664, 132.85277777777773, 82.9749999999999, 62.460555555555494, 57.05499999999999, 135.65444444444444, 130.38555555555553, 109.4588888888888, 151.71944444444443, 145.50555555555556, 137.88611111111106, 188.40500000000014, 163.38777777777776, 183.10666666666668, 134.64388888888894, 186.273888888889, 152.2294444444444, 172.80000000000013, 168.68722222222232, 114.4083333333332, 123.07777777777775, 135.84722222222223, 162.2722222222222, 162.64611111111114, 180.56111111111116, 176.48000000000008, 194.98444444444453, 217.3250000000001, 170.81500000000003, 152.78222222222226, 131.71833333333325, 176.89222222222227, 175.3477777777778, 98.78444444444439, 153.7838888888888, 170.75888888888895, 176.4977777777779, 158.66611111111118, 155.9883333333334, 172.4816666666668, 171.88666666666668, 172.7966666666669, 186.1977777777778, 235.413888888889, 191.15222222222235, 175.84277777777783, 181.0433333333335, 182.43500000000003, 182.41777777777784, 166.48833333333343, 180.16666666666674, 193.21166666666673, 203.85777777777787, 209.61555555555566, 192.2505555555557, 188.3383333333333, 187.14777777777786, 222.87722222222237, 197.81277777777788, 196.22500000000008, 166.53333333333336, 206.39055555555564, 196.43944444444452, 206.19444444444449, 205.04500000000013, 245.133888888889, 214.97944444444465, 202.74277777777792, 224.2400000000001, 257.9711111111112, 149.40222222222224, 251.27166666666685, 215.75000000000014, 229.8416666666669, 204.94777777777793, 257.38944444444456, 227.0183333333335, 224.44111111111133, 248.5327777777779, 251.99555555555568, 212.76500000000013, 201.363888888889, 222.87611111111136, 241.1066666666667, 227.5966666666668, 278.74833333333345, 262.54333333333346, 226.67944444444464, 191.53666666666683, 214.92611111111117, 216.74833333333348, 222.27333333333348, 215.05166666666688, 213.72444444444457, 185.4177777777779, 206.21222222222235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19396733385620776, "mean_inference_ms": 1.7809475291231684, "mean_action_processing_ms": 0.07389544097496337, "mean_env_wait_ms": 1.2071295978957053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046443939208984375, "StateBufferConnector_ms": 0.0030426979064941406, "ViewRequirementAgentConnector_ms": 0.06904149055480957}, "num_episodes": 27, "episode_return_max": 278.74833333333345, "episode_return_min": 57.05499999999999, "episode_return_mean": 182.49501111111115, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208050, "num_agent_steps_trained": 207900, "num_env_steps_sampled": 208050, "num_env_steps_trained": 207900, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 269.2988269051682, "num_env_steps_trained_throughput_per_sec": 283.47244937386125, "timesteps_total": 208050, "num_env_steps_sampled_lifetime": 208050, "num_agent_steps_sampled_lifetime": 208050, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 208050, "timers": {"training_iteration_time_ms": 10357.452, "restore_workers_time_ms": 0.012, "training_step_time_ms": 553.536, "sample_time_ms": 538.002, "synch_weights_time_ms": 14.024}, "counters": {"num_env_steps_sampled": 208050, "num_env_steps_trained": 207900, "num_agent_steps_sampled": 208050, "num_agent_steps_trained": 207900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1387, "num_samples_added_to_queue": 207900}, "done": false, "training_iteration": 69, "trial_id": "0313d_00000", "date": "2024-10-10_21-53-16", "timestamp": 1728593596, "time_this_iter_s": 10.596925497055054, "time_total_s": 709.8501970767975, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae4319e6b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 709.8501970767975, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 14.533333333333333, "ram_util_percent": 61.18666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 241161.5625, "policy_loss": 240926.359375, "entropy": 22.009082794189453, "entropy_coeff": 0.01, "var_gnorm": 16.485973358154297, "vf_loss": 301241.21875, "vf_explained_var": -0.4567922353744507}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 702.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 210900, "num_env_steps_trained": 210600, "num_agent_steps_sampled": 210900, "num_agent_steps_trained": 210600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1406, "num_samples_added_to_queue": 210900, "learner_queue": {"size_count": 702, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 52.257, "learner_load_time_ms": 0.277, "learner_load_wait_time_ms": 1052.924, "learner_dequeue_time_ms": 8704.639}}, "env_runners": {"episode_reward_max": 291.3383333333334, "episode_reward_min": 98.78444444444439, "episode_reward_mean": 214.37303333333344, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 98.78444444444439}, "policy_reward_max": {"default_policy": 291.3383333333334}, "policy_reward_mean": {"default_policy": 214.37303333333344}, "custom_metrics": {"num_consolidated_mean": 1.3351999999999997, "num_consolidated_min": 1.05, "num_consolidated_max": 1.57, "num_overloaded_mean": 0.2339, "num_overloaded_min": 0.1, "num_overloaded_max": 0.38, "num_moves_mean": 8.1878, "num_moves_min": 7.56, "num_moves_max": 9.04, "mean_accuracy_mean": 39.62977999999998, "mean_accuracy_min": 39.41533333333332, "mean_accuracy_max": 39.98533333333332, "num_model_switches_mean": 3.9040999999999997, "num_model_switches_min": 3.46, "num_model_switches_max": 4.63, "num_slav_mean": 0.017849999999999998, "num_slav_min": 0.006766666666666666, "num_slav_max": 0.03275, "mean_cluster_cpu_util_mean": 0.4756330935468221, "mean_cluster_cpu_util_min": 0.4638784538146584, "mean_cluster_cpu_util_max": 0.48787618434662056, "mean_cluster_mem_util_mean": 0.31077549237026025, "mean_cluster_mem_util_min": 0.30280433027641435, "mean_cluster_mem_util_max": 0.321179198061081, "reward_consolidation_mean_mean": 1.444583333333333, "reward_consolidation_mean_min": 0.9999999999999999, "reward_consolidation_mean_max": 1.833333333333333, "reward_illegal_mean_mean": -0.38983333333333325, "reward_illegal_mean_min": -0.6333333333333332, "reward_illegal_mean_max": -0.16666666666666669, "reward_accuracy_mean_mean": 1.532613666666666, "reward_accuracy_mean_min": 1.2733999999999994, "reward_accuracy_mean_max": 1.788383333333333, "reward_sla_mean_mean": -0.4436333333333333, "reward_sla_mean_min": -0.851111111111111, "reward_sla_mean_max": -0.1927777777777778, "reward_consolidation_sum_mean": 144.45833333333331, "reward_consolidation_sum_min": 99.99999999999999, "reward_consolidation_sum_max": 183.33333333333331, "reward_illegal_sum_mean": -38.98333333333332, "reward_illegal_sum_min": -63.33333333333332, "reward_illegal_sum_max": -16.666666666666668, "reward_accuracy_sum_mean": 153.26136666666665, "reward_accuracy_sum_min": 127.33999999999995, "reward_accuracy_sum_max": 178.8383333333333, "reward_sla_sum_mean": -44.36333333333333, "reward_sla_sum_min": -85.1111111111111, "reward_sla_sum_max": -19.27777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6023.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [194.98444444444453, 217.3250000000001, 170.81500000000003, 152.78222222222226, 131.71833333333325, 176.89222222222227, 175.3477777777778, 98.78444444444439, 153.7838888888888, 170.75888888888895, 176.4977777777779, 158.66611111111118, 155.9883333333334, 172.4816666666668, 171.88666666666668, 172.7966666666669, 186.1977777777778, 235.413888888889, 191.15222222222235, 175.84277777777783, 181.0433333333335, 182.43500000000003, 182.41777777777784, 166.48833333333343, 180.16666666666674, 193.21166666666673, 203.85777777777787, 209.61555555555566, 192.2505555555557, 188.3383333333333, 187.14777777777786, 222.87722222222237, 197.81277777777788, 196.22500000000008, 166.53333333333336, 206.39055555555564, 196.43944444444452, 206.19444444444449, 205.04500000000013, 245.133888888889, 214.97944444444465, 202.74277777777792, 224.2400000000001, 257.9711111111112, 149.40222222222224, 251.27166666666685, 215.75000000000014, 229.8416666666669, 204.94777777777793, 257.38944444444456, 227.0183333333335, 224.44111111111133, 248.5327777777779, 251.99555555555568, 212.76500000000013, 201.363888888889, 222.87611111111136, 241.1066666666667, 227.5966666666668, 278.74833333333345, 262.54333333333346, 226.67944444444464, 191.53666666666683, 214.92611111111117, 216.74833333333348, 222.27333333333348, 215.05166666666688, 213.72444444444457, 185.4177777777779, 206.21222222222235, 255.6772222222224, 223.72833333333344, 223.77055555555575, 261.9533333333334, 235.06777777777793, 269.0477777777778, 218.73444444444453, 231.06722222222237, 257.7516666666668, 274.0666666666667, 244.023888888889, 283.81, 255.24666666666687, 218.59833333333344, 213.43222222222235, 264.33444444444456, 237.2816666666668, 225.98111111111132, 272.6294444444446, 227.01000000000016, 227.98666666666668, 244.7883333333334, 229.95666666666685, 261.40000000000015, 291.3383333333334, 245.42944444444453, 198.62388888888913, 265.1899999999999, 252.888888888889, 276.65388888888896], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [194.98444444444453, 217.3250000000001, 170.81500000000003, 152.78222222222226, 131.71833333333325, 176.89222222222227, 175.3477777777778, 98.78444444444439, 153.7838888888888, 170.75888888888895, 176.4977777777779, 158.66611111111118, 155.9883333333334, 172.4816666666668, 171.88666666666668, 172.7966666666669, 186.1977777777778, 235.413888888889, 191.15222222222235, 175.84277777777783, 181.0433333333335, 182.43500000000003, 182.41777777777784, 166.48833333333343, 180.16666666666674, 193.21166666666673, 203.85777777777787, 209.61555555555566, 192.2505555555557, 188.3383333333333, 187.14777777777786, 222.87722222222237, 197.81277777777788, 196.22500000000008, 166.53333333333336, 206.39055555555564, 196.43944444444452, 206.19444444444449, 205.04500000000013, 245.133888888889, 214.97944444444465, 202.74277777777792, 224.2400000000001, 257.9711111111112, 149.40222222222224, 251.27166666666685, 215.75000000000014, 229.8416666666669, 204.94777777777793, 257.38944444444456, 227.0183333333335, 224.44111111111133, 248.5327777777779, 251.99555555555568, 212.76500000000013, 201.363888888889, 222.87611111111136, 241.1066666666667, 227.5966666666668, 278.74833333333345, 262.54333333333346, 226.67944444444464, 191.53666666666683, 214.92611111111117, 216.74833333333348, 222.27333333333348, 215.05166666666688, 213.72444444444457, 185.4177777777779, 206.21222222222235, 255.6772222222224, 223.72833333333344, 223.77055555555575, 261.9533333333334, 235.06777777777793, 269.0477777777778, 218.73444444444453, 231.06722222222237, 257.7516666666668, 274.0666666666667, 244.023888888889, 283.81, 255.24666666666687, 218.59833333333344, 213.43222222222235, 264.33444444444456, 237.2816666666668, 225.98111111111132, 272.6294444444446, 227.01000000000016, 227.98666666666668, 244.7883333333334, 229.95666666666685, 261.40000000000015, 291.3383333333334, 245.42944444444453, 198.62388888888913, 265.1899999999999, 252.888888888889, 276.65388888888896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19421974109378679, "mean_inference_ms": 1.782788029289318, "mean_action_processing_ms": 0.07398951888525819, "mean_env_wait_ms": 1.2082849121856472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00492405891418457, "StateBufferConnector_ms": 0.0030434131622314453, "ViewRequirementAgentConnector_ms": 0.07027721405029297}, "num_episodes": 30, "episode_return_max": 291.3383333333334, "episode_return_min": 98.78444444444439, "episode_return_mean": 214.37303333333344, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 210900, "num_agent_steps_trained": 210600, "num_env_steps_sampled": 210900, "num_env_steps_trained": 210600, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 274.1658414657907, "num_env_steps_trained_throughput_per_sec": 259.73606033601226, "timesteps_total": 210900, "num_env_steps_sampled_lifetime": 210900, "num_agent_steps_sampled_lifetime": 210900, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 210900, "timers": {"training_iteration_time_ms": 10355.049, "restore_workers_time_ms": 0.014, "training_step_time_ms": 544.747, "sample_time_ms": 529.493, "synch_weights_time_ms": 13.925}, "counters": {"num_env_steps_sampled": 210900, "num_env_steps_trained": 210600, "num_agent_steps_sampled": 210900, "num_agent_steps_trained": 210600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1406, "num_samples_added_to_queue": 210900}, "done": false, "training_iteration": 70, "trial_id": "0313d_00000", "date": "2024-10-10_21-53-26", "timestamp": 1728593606, "time_this_iter_s": 10.408797979354858, "time_total_s": 720.2589950561523, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c1bd90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 720.2589950561523, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 14.693333333333332, "ram_util_percent": 61.81333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 234456.8125, "policy_loss": 234221.3125, "entropy": 21.244733810424805, "entropy_coeff": 0.01, "var_gnorm": 16.494081497192383, "vf_loss": 299235.0, "vf_explained_var": -0.5120213031768799}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 712.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 213750, "num_env_steps_trained": 213600, "num_agent_steps_sampled": 213750, "num_agent_steps_trained": 213600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1425, "num_samples_added_to_queue": 213600, "learner_queue": {"size_count": 712, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 52.119, "learner_load_time_ms": 0.234, "learner_load_wait_time_ms": 1056.387, "learner_dequeue_time_ms": 8700.72}}, "env_runners": {"episode_reward_max": 316.61055555555555, "episode_reward_min": 149.40222222222224, "episode_reward_mean": 240.16163888888903, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 149.40222222222224}, "policy_reward_max": {"default_policy": 316.61055555555555}, "policy_reward_mean": {"default_policy": 240.16163888888903}, "custom_metrics": {"num_consolidated_mean": 1.4019, "num_consolidated_min": 1.12, "num_consolidated_max": 1.66, "num_overloaded_mean": 0.2076, "num_overloaded_min": 0.1, "num_overloaded_max": 0.3, "num_moves_mean": 7.9583, "num_moves_min": 7.33, "num_moves_max": 8.57, "mean_accuracy_mean": 39.609259999999985, "mean_accuracy_min": 39.41533333333332, "mean_accuracy_max": 39.820666666666654, "num_model_switches_mean": 3.7751, "num_model_switches_min": 3.35, "num_model_switches_max": 4.28, "num_slav_mean": 0.015130499999999998, "num_slav_min": 0.005216666666666667, "num_slav_max": 0.02878333333333333, "mean_cluster_cpu_util_mean": 0.47403711099540646, "mean_cluster_cpu_util_min": 0.4615824097360551, "mean_cluster_cpu_util_max": 0.48531435665832645, "mean_cluster_mem_util_mean": 0.3084513088241626, "mean_cluster_mem_util_min": 0.3014307783661988, "mean_cluster_mem_util_max": 0.31569386714601455, "reward_consolidation_mean_mean": 1.552916666666667, "reward_consolidation_mean_min": 1.1944444444444442, "reward_consolidation_mean_max": 1.8611111111111112, "reward_illegal_mean_mean": -0.34599999999999986, "reward_illegal_mean_min": -0.5, "reward_illegal_mean_max": -0.16666666666666669, "reward_accuracy_mean_mean": 1.5798274999999995, "reward_accuracy_mean_min": 1.3884666666666667, "reward_accuracy_mean_max": 1.788383333333333, "reward_sla_mean_mean": -0.38512777777777774, "reward_sla_mean_min": -0.851111111111111, "reward_sla_mean_max": -0.1383333333333333, "reward_consolidation_sum_mean": 155.29166666666669, "reward_consolidation_sum_min": 119.44444444444443, "reward_consolidation_sum_max": 186.11111111111111, "reward_illegal_sum_mean": -34.6, "reward_illegal_sum_min": -50.0, "reward_illegal_sum_max": -16.666666666666668, "reward_accuracy_sum_mean": 157.98274999999998, "reward_accuracy_sum_min": 138.84666666666666, "reward_accuracy_sum_max": 178.8383333333333, "reward_sla_sum_mean": -38.512777777777785, "reward_sla_sum_min": -85.1111111111111, "reward_sla_sum_max": -13.833333333333332, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4818.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [209.61555555555566, 192.2505555555557, 188.3383333333333, 187.14777777777786, 222.87722222222237, 197.81277777777788, 196.22500000000008, 166.53333333333336, 206.39055555555564, 196.43944444444452, 206.19444444444449, 205.04500000000013, 245.133888888889, 214.97944444444465, 202.74277777777792, 224.2400000000001, 257.9711111111112, 149.40222222222224, 251.27166666666685, 215.75000000000014, 229.8416666666669, 204.94777777777793, 257.38944444444456, 227.0183333333335, 224.44111111111133, 248.5327777777779, 251.99555555555568, 212.76500000000013, 201.363888888889, 222.87611111111136, 241.1066666666667, 227.5966666666668, 278.74833333333345, 262.54333333333346, 226.67944444444464, 191.53666666666683, 214.92611111111117, 216.74833333333348, 222.27333333333348, 215.05166666666688, 213.72444444444457, 185.4177777777779, 206.21222222222235, 255.6772222222224, 223.72833333333344, 223.77055555555575, 261.9533333333334, 235.06777777777793, 269.0477777777778, 218.73444444444453, 231.06722222222237, 257.7516666666668, 274.0666666666667, 244.023888888889, 283.81, 255.24666666666687, 218.59833333333344, 213.43222222222235, 264.33444444444456, 237.2816666666668, 225.98111111111132, 272.6294444444446, 227.01000000000016, 227.98666666666668, 244.7883333333334, 229.95666666666685, 261.40000000000015, 291.3383333333334, 245.42944444444453, 198.62388888888913, 265.1899999999999, 252.888888888889, 276.65388888888896, 260.93944444444463, 316.61055555555555, 246.32722222222233, 270.5505555555558, 293.8561111111112, 248.5716666666668, 280.7944444444445, 268.55777777777797, 262.5505555555558, 280.68333333333334, 242.31166666666664, 268.07388888888914, 239.08277777777792, 239.62166666666687, 297.97444444444454, 301.2855555555555, 228.42333333333357, 244.47222222222234, 283.35888888888906, 308.8572222222222, 266.06555555555553, 285.446111111111, 270.27944444444466, 277.26388888888914, 299.17333333333335, 275.4866666666668, 251.97888888888906], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [209.61555555555566, 192.2505555555557, 188.3383333333333, 187.14777777777786, 222.87722222222237, 197.81277777777788, 196.22500000000008, 166.53333333333336, 206.39055555555564, 196.43944444444452, 206.19444444444449, 205.04500000000013, 245.133888888889, 214.97944444444465, 202.74277777777792, 224.2400000000001, 257.9711111111112, 149.40222222222224, 251.27166666666685, 215.75000000000014, 229.8416666666669, 204.94777777777793, 257.38944444444456, 227.0183333333335, 224.44111111111133, 248.5327777777779, 251.99555555555568, 212.76500000000013, 201.363888888889, 222.87611111111136, 241.1066666666667, 227.5966666666668, 278.74833333333345, 262.54333333333346, 226.67944444444464, 191.53666666666683, 214.92611111111117, 216.74833333333348, 222.27333333333348, 215.05166666666688, 213.72444444444457, 185.4177777777779, 206.21222222222235, 255.6772222222224, 223.72833333333344, 223.77055555555575, 261.9533333333334, 235.06777777777793, 269.0477777777778, 218.73444444444453, 231.06722222222237, 257.7516666666668, 274.0666666666667, 244.023888888889, 283.81, 255.24666666666687, 218.59833333333344, 213.43222222222235, 264.33444444444456, 237.2816666666668, 225.98111111111132, 272.6294444444446, 227.01000000000016, 227.98666666666668, 244.7883333333334, 229.95666666666685, 261.40000000000015, 291.3383333333334, 245.42944444444453, 198.62388888888913, 265.1899999999999, 252.888888888889, 276.65388888888896, 260.93944444444463, 316.61055555555555, 246.32722222222233, 270.5505555555558, 293.8561111111112, 248.5716666666668, 280.7944444444445, 268.55777777777797, 262.5505555555558, 280.68333333333334, 242.31166666666664, 268.07388888888914, 239.08277777777792, 239.62166666666687, 297.97444444444454, 301.2855555555555, 228.42333333333357, 244.47222222222234, 283.35888888888906, 308.8572222222222, 266.06555555555553, 285.446111111111, 270.27944444444466, 277.26388888888914, 299.17333333333335, 275.4866666666668, 251.97888888888906]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19440115429760194, "mean_inference_ms": 1.7831466769684652, "mean_action_processing_ms": 0.07405982569458053, "mean_env_wait_ms": 1.2091531141462073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005371570587158203, "StateBufferConnector_ms": 0.0030956268310546875, "ViewRequirementAgentConnector_ms": 0.07191014289855957}, "num_episodes": 27, "episode_return_max": 316.61055555555555, "episode_return_min": 149.40222222222224, "episode_return_mean": 240.16163888888903, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 213750, "num_agent_steps_trained": 213600, "num_env_steps_sampled": 213750, "num_env_steps_trained": 213600, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 273.11946127744267, "num_env_steps_trained_throughput_per_sec": 287.4941697657291, "timesteps_total": 213750, "num_env_steps_sampled_lifetime": 213750, "num_agent_steps_sampled_lifetime": 213750, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 213750, "timers": {"training_iteration_time_ms": 10347.449, "restore_workers_time_ms": 0.011, "training_step_time_ms": 516.036, "sample_time_ms": 502.134, "synch_weights_time_ms": 12.538}, "counters": {"num_env_steps_sampled": 213750, "num_env_steps_trained": 213600, "num_agent_steps_sampled": 213750, "num_agent_steps_trained": 213600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1425, "num_samples_added_to_queue": 213600}, "done": false, "training_iteration": 71, "trial_id": "0313d_00000", "date": "2024-10-10_21-53-37", "timestamp": 1728593617, "time_this_iter_s": 10.447631120681763, "time_total_s": 730.7066261768341, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c17340>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 730.7066261768341, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 14.486666666666672, "ram_util_percent": 62.39333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 246920.734375, "policy_loss": 246635.125, "entropy": 21.011234283447266, "entropy_coeff": 0.01, "var_gnorm": 16.500892639160156, "vf_loss": 348647.375, "vf_explained_var": -0.49957549571990967}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 721.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 216600, "num_env_steps_trained": 216300, "num_agent_steps_sampled": 216600, "num_agent_steps_trained": 216300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1444, "num_samples_added_to_queue": 216600, "learner_queue": {"size_count": 721, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.994, "learner_load_time_ms": 0.208, "learner_load_wait_time_ms": 1044.446, "learner_dequeue_time_ms": 8748.97}}, "env_runners": {"episode_reward_max": 333.3166666666665, "episode_reward_min": 185.4177777777779, "episode_reward_mean": 261.4587333333335, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 185.4177777777779}, "policy_reward_max": {"default_policy": 333.3166666666665}, "policy_reward_mean": {"default_policy": 261.4587333333335}, "custom_metrics": {"num_consolidated_mean": 1.4661000000000002, "num_consolidated_min": 1.23, "num_consolidated_max": 1.74, "num_overloaded_mean": 0.1885, "num_overloaded_min": 0.1, "num_overloaded_max": 0.29, "num_moves_mean": 7.7551999999999985, "num_moves_min": 7.2, "num_moves_max": 8.44, "mean_accuracy_mean": 39.60938666666665, "mean_accuracy_min": 39.42799999999999, "mean_accuracy_max": 39.77633333333332, "num_model_switches_mean": 3.6712000000000007, "num_model_switches_min": 3.23, "num_model_switches_max": 4.2, "num_slav_mean": 0.013089499999999999, "num_slav_min": 0.005216666666666667, "num_slav_max": 0.021433333333333332, "mean_cluster_cpu_util_mean": 0.473245369213823, "mean_cluster_cpu_util_min": 0.4615824097360551, "mean_cluster_cpu_util_max": 0.49327364899695353, "mean_cluster_mem_util_mean": 0.3065462816365998, "mean_cluster_mem_util_min": 0.298672128218376, "mean_cluster_mem_util_max": 0.3140622877737593, "reward_consolidation_mean_mean": 1.6544444444444446, "reward_consolidation_mean_min": 1.3194444444444446, "reward_consolidation_mean_max": 2.041666666666667, "reward_illegal_mean_mean": -0.31416666666666665, "reward_illegal_mean_min": -0.4833333333333333, "reward_illegal_mean_max": -0.16666666666666669, "reward_accuracy_mean_mean": 1.6151873333333333, "reward_accuracy_mean_min": 1.4263999999999997, "reward_accuracy_mean_max": 1.788383333333333, "reward_sla_mean_mean": -0.34087777777777784, "reward_sla_mean_min": -0.575, "reward_sla_mean_max": -0.1383333333333333, "reward_consolidation_sum_mean": 165.44444444444446, "reward_consolidation_sum_min": 131.94444444444446, "reward_consolidation_sum_max": 204.16666666666669, "reward_illegal_sum_mean": -31.416666666666664, "reward_illegal_sum_min": -48.33333333333333, "reward_illegal_sum_max": -16.666666666666668, "reward_accuracy_sum_mean": 161.51873333333333, "reward_accuracy_sum_min": 142.63999999999996, "reward_accuracy_sum_max": 178.8383333333333, "reward_sla_sum_mean": -34.087777777777774, "reward_sla_sum_min": -57.49999999999999, "reward_sla_sum_max": -13.833333333333332, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3483.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [241.1066666666667, 227.5966666666668, 278.74833333333345, 262.54333333333346, 226.67944444444464, 191.53666666666683, 214.92611111111117, 216.74833333333348, 222.27333333333348, 215.05166666666688, 213.72444444444457, 185.4177777777779, 206.21222222222235, 255.6772222222224, 223.72833333333344, 223.77055555555575, 261.9533333333334, 235.06777777777793, 269.0477777777778, 218.73444444444453, 231.06722222222237, 257.7516666666668, 274.0666666666667, 244.023888888889, 283.81, 255.24666666666687, 218.59833333333344, 213.43222222222235, 264.33444444444456, 237.2816666666668, 225.98111111111132, 272.6294444444446, 227.01000000000016, 227.98666666666668, 244.7883333333334, 229.95666666666685, 261.40000000000015, 291.3383333333334, 245.42944444444453, 198.62388888888913, 265.1899999999999, 252.888888888889, 276.65388888888896, 260.93944444444463, 316.61055555555555, 246.32722222222233, 270.5505555555558, 293.8561111111112, 248.5716666666668, 280.7944444444445, 268.55777777777797, 262.5505555555558, 280.68333333333334, 242.31166666666664, 268.07388888888914, 239.08277777777792, 239.62166666666687, 297.97444444444454, 301.2855555555555, 228.42333333333357, 244.47222222222234, 283.35888888888906, 308.8572222222222, 266.06555555555553, 285.446111111111, 270.27944444444466, 277.26388888888914, 299.17333333333335, 275.4866666666668, 251.97888888888906, 242.4316666666667, 269.4461111111112, 259.30444444444464, 293.9361111111112, 265.25555555555565, 272.2566666666667, 319.76111111111095, 280.8900000000001, 296.39777777777766, 258.46833333333353, 311.9305555555555, 277.2316666666668, 295.2472222222222, 315.34944444444443, 257.82777777777784, 268.2866666666668, 329.9822222222221, 291.5883333333333, 278.1927777777778, 265.6600000000001, 281.9927777777778, 300.11833333333345, 230.79000000000013, 304.80833333333334, 269.4677777777778, 275.8583333333334, 333.3166666666665, 305.7611111111111, 289.75500000000005, 305.92944444444447], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [241.1066666666667, 227.5966666666668, 278.74833333333345, 262.54333333333346, 226.67944444444464, 191.53666666666683, 214.92611111111117, 216.74833333333348, 222.27333333333348, 215.05166666666688, 213.72444444444457, 185.4177777777779, 206.21222222222235, 255.6772222222224, 223.72833333333344, 223.77055555555575, 261.9533333333334, 235.06777777777793, 269.0477777777778, 218.73444444444453, 231.06722222222237, 257.7516666666668, 274.0666666666667, 244.023888888889, 283.81, 255.24666666666687, 218.59833333333344, 213.43222222222235, 264.33444444444456, 237.2816666666668, 225.98111111111132, 272.6294444444446, 227.01000000000016, 227.98666666666668, 244.7883333333334, 229.95666666666685, 261.40000000000015, 291.3383333333334, 245.42944444444453, 198.62388888888913, 265.1899999999999, 252.888888888889, 276.65388888888896, 260.93944444444463, 316.61055555555555, 246.32722222222233, 270.5505555555558, 293.8561111111112, 248.5716666666668, 280.7944444444445, 268.55777777777797, 262.5505555555558, 280.68333333333334, 242.31166666666664, 268.07388888888914, 239.08277777777792, 239.62166666666687, 297.97444444444454, 301.2855555555555, 228.42333333333357, 244.47222222222234, 283.35888888888906, 308.8572222222222, 266.06555555555553, 285.446111111111, 270.27944444444466, 277.26388888888914, 299.17333333333335, 275.4866666666668, 251.97888888888906, 242.4316666666667, 269.4461111111112, 259.30444444444464, 293.9361111111112, 265.25555555555565, 272.2566666666667, 319.76111111111095, 280.8900000000001, 296.39777777777766, 258.46833333333353, 311.9305555555555, 277.2316666666668, 295.2472222222222, 315.34944444444443, 257.82777777777784, 268.2866666666668, 329.9822222222221, 291.5883333333333, 278.1927777777778, 265.6600000000001, 281.9927777777778, 300.11833333333345, 230.79000000000013, 304.80833333333334, 269.4677777777778, 275.8583333333334, 333.3166666666665, 305.7611111111111, 289.75500000000005, 305.92944444444447]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1946940844986857, "mean_inference_ms": 1.7866032696166445, "mean_action_processing_ms": 0.07416684386408291, "mean_env_wait_ms": 1.2107026849133984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005196094512939453, "StateBufferConnector_ms": 0.0030498504638671875, "ViewRequirementAgentConnector_ms": 0.07064294815063477}, "num_episodes": 30, "episode_return_max": 333.3166666666665, "episode_return_min": 185.4177777777779, "episode_return_mean": 261.4587333333335, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216600, "num_agent_steps_trained": 216300, "num_env_steps_sampled": 216600, "num_env_steps_trained": 216300, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 271.4484615368021, "num_env_steps_trained_throughput_per_sec": 257.1617004032862, "timesteps_total": 216600, "num_env_steps_sampled_lifetime": 216600, "num_agent_steps_sampled_lifetime": 216600, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 216600, "timers": {"training_iteration_time_ms": 10352.44, "restore_workers_time_ms": 0.012, "training_step_time_ms": 509.721, "sample_time_ms": 495.101, "synch_weights_time_ms": 13.235}, "counters": {"num_env_steps_sampled": 216600, "num_env_steps_trained": 216300, "num_agent_steps_sampled": 216600, "num_agent_steps_trained": 216300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1444, "num_samples_added_to_queue": 216600}, "done": false, "training_iteration": 72, "trial_id": "0313d_00000", "date": "2024-10-10_21-53-47", "timestamp": 1728593627, "time_this_iter_s": 10.508963108062744, "time_total_s": 741.2155892848969, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c15f90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 741.2155892848969, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 14.686666666666667, "ram_util_percent": 62.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 218953.8125, "policy_loss": 218735.875, "entropy": 21.179126739501953, "entropy_coeff": 0.01, "var_gnorm": 16.504779815673828, "vf_loss": 281464.9375, "vf_explained_var": -0.44638872146606445}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 731.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 219450, "num_env_steps_trained": 219300, "num_agent_steps_sampled": 219450, "num_agent_steps_trained": 219300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1463, "num_samples_added_to_queue": 219300, "learner_queue": {"size_count": 731, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.394, "learner_load_time_ms": 0.22, "learner_load_wait_time_ms": 986.205, "learner_dequeue_time_ms": 8732.964}}, "env_runners": {"episode_reward_max": 333.3166666666665, "episode_reward_min": 198.62388888888913, "episode_reward_mean": 271.02722777777785, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 198.62388888888913}, "policy_reward_max": {"default_policy": 333.3166666666665}, "policy_reward_mean": {"default_policy": 271.02722777777785}, "custom_metrics": {"num_consolidated_mean": 1.4957999999999996, "num_consolidated_min": 1.25, "num_consolidated_max": 1.74, "num_overloaded_mean": 0.17920000000000003, "num_overloaded_min": 0.08, "num_overloaded_max": 0.29, "num_moves_mean": 7.633599999999999, "num_moves_min": 7.17, "num_moves_max": 8.18, "mean_accuracy_mean": 39.61343999999999, "mean_accuracy_min": 39.44066666666665, "mean_accuracy_max": 39.78899999999998, "num_model_switches_mean": 3.6086, "num_model_switches_min": 3.14, "num_model_switches_max": 4.07, "num_slav_mean": 0.012339166666666668, "num_slav_min": 0.005216666666666667, "num_slav_max": 0.021433333333333332, "mean_cluster_cpu_util_mean": 0.4724964979751877, "mean_cluster_cpu_util_min": 0.4570740309831746, "mean_cluster_cpu_util_max": 0.49327364899695353, "mean_cluster_mem_util_mean": 0.30532587710970466, "mean_cluster_mem_util_min": 0.29697394227733287, "mean_cluster_mem_util_max": 0.3131548098036683, "reward_consolidation_mean_mean": 1.7005555555555558, "reward_consolidation_mean_min": 1.3333333333333335, "reward_consolidation_mean_max": 2.041666666666667, "reward_illegal_mean_mean": -0.2986666666666667, "reward_illegal_mean_min": -0.4833333333333333, "reward_illegal_mean_max": -0.13333333333333333, "reward_accuracy_mean_mean": 1.6323444999999994, "reward_accuracy_mean_min": 1.4191166666666666, "reward_accuracy_mean_max": 1.8158666666666665, "reward_sla_mean_mean": -0.32396111111111103, "reward_sla_mean_min": -0.5738888888888888, "reward_sla_mean_max": -0.1383333333333333, "reward_consolidation_sum_mean": 170.05555555555551, "reward_consolidation_sum_min": 133.33333333333334, "reward_consolidation_sum_max": 204.16666666666669, "reward_illegal_sum_mean": -29.86666666666666, "reward_illegal_sum_min": -48.33333333333333, "reward_illegal_sum_max": -13.333333333333332, "reward_accuracy_sum_mean": 163.23444999999998, "reward_accuracy_sum_min": 141.91166666666666, "reward_accuracy_sum_max": 181.58666666666664, "reward_sla_sum_mean": -32.39611111111111, "reward_sla_sum_min": -57.38888888888888, "reward_sla_sum_max": -13.833333333333332, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2350.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [213.43222222222235, 264.33444444444456, 237.2816666666668, 225.98111111111132, 272.6294444444446, 227.01000000000016, 227.98666666666668, 244.7883333333334, 229.95666666666685, 261.40000000000015, 291.3383333333334, 245.42944444444453, 198.62388888888913, 265.1899999999999, 252.888888888889, 276.65388888888896, 260.93944444444463, 316.61055555555555, 246.32722222222233, 270.5505555555558, 293.8561111111112, 248.5716666666668, 280.7944444444445, 268.55777777777797, 262.5505555555558, 280.68333333333334, 242.31166666666664, 268.07388888888914, 239.08277777777792, 239.62166666666687, 297.97444444444454, 301.2855555555555, 228.42333333333357, 244.47222222222234, 283.35888888888906, 308.8572222222222, 266.06555555555553, 285.446111111111, 270.27944444444466, 277.26388888888914, 299.17333333333335, 275.4866666666668, 251.97888888888906, 242.4316666666667, 269.4461111111112, 259.30444444444464, 293.9361111111112, 265.25555555555565, 272.2566666666667, 319.76111111111095, 280.8900000000001, 296.39777777777766, 258.46833333333353, 311.9305555555555, 277.2316666666668, 295.2472222222222, 315.34944444444443, 257.82777777777784, 268.2866666666668, 329.9822222222221, 291.5883333333333, 278.1927777777778, 265.6600000000001, 281.9927777777778, 300.11833333333345, 230.79000000000013, 304.80833333333334, 269.4677777777778, 275.8583333333334, 333.3166666666665, 305.7611111111111, 289.75500000000005, 305.92944444444447, 279.91944444444454, 280.5633333333334, 253.9316666666668, 316.0311111111108, 252.61333333333354, 229.24222222222235, 276.3644444444445, 281.96000000000004, 279.6777777777778, 287.6127777777778, 305.16611111111104, 262.62277777777797, 279.03944444444454, 260.69777777777796, 294.38166666666666, 248.20000000000022, 269.4055555555558, 256.98055555555567, 255.73277777777795, 241.262777777778, 230.85611111111126, 289.54833333333346, 270.31055555555565, 272.3266666666667, 266.2955555555557, 291.13444444444457, 280.0811111111112], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [213.43222222222235, 264.33444444444456, 237.2816666666668, 225.98111111111132, 272.6294444444446, 227.01000000000016, 227.98666666666668, 244.7883333333334, 229.95666666666685, 261.40000000000015, 291.3383333333334, 245.42944444444453, 198.62388888888913, 265.1899999999999, 252.888888888889, 276.65388888888896, 260.93944444444463, 316.61055555555555, 246.32722222222233, 270.5505555555558, 293.8561111111112, 248.5716666666668, 280.7944444444445, 268.55777777777797, 262.5505555555558, 280.68333333333334, 242.31166666666664, 268.07388888888914, 239.08277777777792, 239.62166666666687, 297.97444444444454, 301.2855555555555, 228.42333333333357, 244.47222222222234, 283.35888888888906, 308.8572222222222, 266.06555555555553, 285.446111111111, 270.27944444444466, 277.26388888888914, 299.17333333333335, 275.4866666666668, 251.97888888888906, 242.4316666666667, 269.4461111111112, 259.30444444444464, 293.9361111111112, 265.25555555555565, 272.2566666666667, 319.76111111111095, 280.8900000000001, 296.39777777777766, 258.46833333333353, 311.9305555555555, 277.2316666666668, 295.2472222222222, 315.34944444444443, 257.82777777777784, 268.2866666666668, 329.9822222222221, 291.5883333333333, 278.1927777777778, 265.6600000000001, 281.9927777777778, 300.11833333333345, 230.79000000000013, 304.80833333333334, 269.4677777777778, 275.8583333333334, 333.3166666666665, 305.7611111111111, 289.75500000000005, 305.92944444444447, 279.91944444444454, 280.5633333333334, 253.9316666666668, 316.0311111111108, 252.61333333333354, 229.24222222222235, 276.3644444444445, 281.96000000000004, 279.6777777777778, 287.6127777777778, 305.16611111111104, 262.62277777777797, 279.03944444444454, 260.69777777777796, 294.38166666666666, 248.20000000000022, 269.4055555555558, 256.98055555555567, 255.73277777777795, 241.262777777778, 230.85611111111126, 289.54833333333346, 270.31055555555565, 272.3266666666667, 266.2955555555557, 291.13444444444457, 280.0811111111112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482118611913044, "mean_inference_ms": 1.786545085859634, "mean_action_processing_ms": 0.07420778314408975, "mean_env_wait_ms": 1.2112574630494037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005051374435424805, "StateBufferConnector_ms": 0.0030193328857421875, "ViewRequirementAgentConnector_ms": 0.07002925872802734}, "num_episodes": 27, "episode_return_max": 333.3166666666665, "episode_return_min": 198.62388888888913, "episode_return_mean": 271.02722777777785, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 219450, "num_agent_steps_trained": 219300, "num_env_steps_sampled": 219450, "num_env_steps_trained": 219300, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 283.8473816312629, "num_env_steps_trained_throughput_per_sec": 298.78671750659254, "timesteps_total": 219450, "num_env_steps_sampled_lifetime": 219450, "num_agent_steps_sampled_lifetime": 219450, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 219450, "timers": {"training_iteration_time_ms": 10356.304, "restore_workers_time_ms": 0.012, "training_step_time_ms": 549.967, "sample_time_ms": 534.452, "synch_weights_time_ms": 14.032}, "counters": {"num_env_steps_sampled": 219450, "num_env_steps_trained": 219300, "num_agent_steps_sampled": 219450, "num_agent_steps_trained": 219300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1463, "num_samples_added_to_queue": 219300}, "done": false, "training_iteration": 73, "trial_id": "0313d_00000", "date": "2024-10-10_21-53-57", "timestamp": 1728593637, "time_this_iter_s": 10.053173303604126, "time_total_s": 751.268762588501, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c155a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 751.268762588501, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 12.2, "ram_util_percent": 62.2357142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 217394.765625, "policy_loss": 217185.515625, "entropy": 21.011333465576172, "entropy_coeff": 0.01, "var_gnorm": 16.509662628173828, "vf_loss": 272274.25, "vf_explained_var": -0.4969125986099243}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 740.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 222300, "num_env_steps_trained": 222000, "num_agent_steps_sampled": 222300, "num_agent_steps_trained": 222000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1482, "num_samples_added_to_queue": 222300, "learner_queue": {"size_count": 740, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.041, "learner_load_time_ms": 0.188, "learner_load_wait_time_ms": 1036.715, "learner_dequeue_time_ms": 8756.525}}, "env_runners": {"episode_reward_max": 333.3166666666665, "episode_reward_min": 221.592777777778, "episode_reward_mean": 279.6304555555556, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 221.592777777778}, "policy_reward_max": {"default_policy": 333.3166666666665}, "policy_reward_mean": {"default_policy": 279.6304555555556}, "custom_metrics": {"num_consolidated_mean": 1.5238, "num_consolidated_min": 1.37, "num_consolidated_max": 1.74, "num_overloaded_mean": 0.1724, "num_overloaded_min": 0.08, "num_overloaded_max": 0.29, "num_moves_mean": 7.5665, "num_moves_min": 7.17, "num_moves_max": 8.14, "mean_accuracy_mean": 39.60786666666665, "mean_accuracy_min": 39.46599999999998, "mean_accuracy_max": 39.78899999999998, "num_model_switches_mean": 3.5457000000000005, "num_model_switches_min": 3.14, "num_model_switches_max": 4.05, "num_slav_mean": 0.011497166666666668, "num_slav_min": 0.006083333333333333, "num_slav_max": 0.021433333333333332, "mean_cluster_cpu_util_mean": 0.4723667854884234, "mean_cluster_cpu_util_min": 0.4570740309831746, "mean_cluster_cpu_util_max": 0.49327364899695353, "mean_cluster_mem_util_mean": 0.30461721073186654, "mean_cluster_mem_util_min": 0.29697394227733287, "mean_cluster_mem_util_max": 0.3121474235052671, "reward_consolidation_mean_mean": 1.7451388888888892, "reward_consolidation_mean_min": 1.5, "reward_consolidation_mean_max": 2.041666666666667, "reward_illegal_mean_mean": -0.2873333333333333, "reward_illegal_mean_min": -0.4833333333333333, "reward_illegal_mean_max": -0.13333333333333333, "reward_accuracy_mean_mean": 1.6464656666666664, "reward_accuracy_mean_min": 1.4191166666666666, "reward_accuracy_mean_max": 1.8158666666666665, "reward_sla_mean_mean": -0.3079666666666666, "reward_sla_mean_min": -0.5738888888888888, "reward_sla_mean_max": -0.1383333333333333, "reward_consolidation_sum_mean": 174.5138888888889, "reward_consolidation_sum_min": 150.0, "reward_consolidation_sum_max": 204.16666666666669, "reward_illegal_sum_mean": -28.73333333333333, "reward_illegal_sum_min": -48.33333333333333, "reward_illegal_sum_max": -13.333333333333332, "reward_accuracy_sum_mean": 164.64656666666667, "reward_accuracy_sum_min": 141.91166666666666, "reward_accuracy_sum_max": 181.58666666666664, "reward_sla_sum_mean": -30.79666666666666, "reward_sla_sum_min": -57.38888888888888, "reward_sla_sum_max": -13.833333333333332, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2263.0, "global_timestep_min": 200, "global_timestep_max": 3900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [297.97444444444454, 301.2855555555555, 228.42333333333357, 244.47222222222234, 283.35888888888906, 308.8572222222222, 266.06555555555553, 285.446111111111, 270.27944444444466, 277.26388888888914, 299.17333333333335, 275.4866666666668, 251.97888888888906, 242.4316666666667, 269.4461111111112, 259.30444444444464, 293.9361111111112, 265.25555555555565, 272.2566666666667, 319.76111111111095, 280.8900000000001, 296.39777777777766, 258.46833333333353, 311.9305555555555, 277.2316666666668, 295.2472222222222, 315.34944444444443, 257.82777777777784, 268.2866666666668, 329.9822222222221, 291.5883333333333, 278.1927777777778, 265.6600000000001, 281.9927777777778, 300.11833333333345, 230.79000000000013, 304.80833333333334, 269.4677777777778, 275.8583333333334, 333.3166666666665, 305.7611111111111, 289.75500000000005, 305.92944444444447, 279.91944444444454, 280.5633333333334, 253.9316666666668, 316.0311111111108, 252.61333333333354, 229.24222222222235, 276.3644444444445, 281.96000000000004, 279.6777777777778, 287.6127777777778, 305.16611111111104, 262.62277777777797, 279.03944444444454, 260.69777777777796, 294.38166666666666, 248.20000000000022, 269.4055555555558, 256.98055555555567, 255.73277777777795, 241.262777777778, 230.85611111111126, 289.54833333333346, 270.31055555555565, 272.3266666666667, 266.2955555555557, 291.13444444444457, 280.0811111111112, 277.54166666666663, 289.79277777777787, 275.63444444444445, 268.9694444444446, 281.47166666666675, 292.7305555555556, 280.7566666666668, 287.6050000000002, 306.74833333333333, 311.7455555555554, 268.05611111111114, 271.58944444444455, 278.7644444444444, 257.9011111111113, 267.95444444444456, 310.6683333333333, 293.2005555555555, 302.0572222222221, 221.592777777778, 291.2555555555556, 259.9922222222224, 269.34166666666687, 305.2922222222222, 301.1327777777778, 291.2700000000001, 286.5661111111112, 319.9044444444444, 276.6616666666668, 272.6527777777778, 294.9294444444445], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [297.97444444444454, 301.2855555555555, 228.42333333333357, 244.47222222222234, 283.35888888888906, 308.8572222222222, 266.06555555555553, 285.446111111111, 270.27944444444466, 277.26388888888914, 299.17333333333335, 275.4866666666668, 251.97888888888906, 242.4316666666667, 269.4461111111112, 259.30444444444464, 293.9361111111112, 265.25555555555565, 272.2566666666667, 319.76111111111095, 280.8900000000001, 296.39777777777766, 258.46833333333353, 311.9305555555555, 277.2316666666668, 295.2472222222222, 315.34944444444443, 257.82777777777784, 268.2866666666668, 329.9822222222221, 291.5883333333333, 278.1927777777778, 265.6600000000001, 281.9927777777778, 300.11833333333345, 230.79000000000013, 304.80833333333334, 269.4677777777778, 275.8583333333334, 333.3166666666665, 305.7611111111111, 289.75500000000005, 305.92944444444447, 279.91944444444454, 280.5633333333334, 253.9316666666668, 316.0311111111108, 252.61333333333354, 229.24222222222235, 276.3644444444445, 281.96000000000004, 279.6777777777778, 287.6127777777778, 305.16611111111104, 262.62277777777797, 279.03944444444454, 260.69777777777796, 294.38166666666666, 248.20000000000022, 269.4055555555558, 256.98055555555567, 255.73277777777795, 241.262777777778, 230.85611111111126, 289.54833333333346, 270.31055555555565, 272.3266666666667, 266.2955555555557, 291.13444444444457, 280.0811111111112, 277.54166666666663, 289.79277777777787, 275.63444444444445, 268.9694444444446, 281.47166666666675, 292.7305555555556, 280.7566666666668, 287.6050000000002, 306.74833333333333, 311.7455555555554, 268.05611111111114, 271.58944444444455, 278.7644444444444, 257.9011111111113, 267.95444444444456, 310.6683333333333, 293.2005555555555, 302.0572222222221, 221.592777777778, 291.2555555555556, 259.9922222222224, 269.34166666666687, 305.2922222222222, 301.1327777777778, 291.2700000000001, 286.5661111111112, 319.9044444444444, 276.6616666666668, 272.6527777777778, 294.9294444444445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19506235330500513, "mean_inference_ms": 1.7894396279805431, "mean_action_processing_ms": 0.07428687514995468, "mean_env_wait_ms": 1.212425911490067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004710197448730469, "StateBufferConnector_ms": 0.003014087677001953, "ViewRequirementAgentConnector_ms": 0.06961917877197266}, "num_episodes": 30, "episode_return_max": 333.3166666666665, "episode_return_min": 221.592777777778, "episode_return_mean": 279.6304555555556, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 222300, "num_agent_steps_trained": 222000, "num_env_steps_sampled": 222300, "num_env_steps_trained": 222000, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 277.27122484973967, "num_env_steps_trained_throughput_per_sec": 262.6780024892271, "timesteps_total": 222300, "num_env_steps_sampled_lifetime": 222300, "num_agent_steps_sampled_lifetime": 222300, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 222300, "timers": {"training_iteration_time_ms": 10364.531, "restore_workers_time_ms": 0.012, "training_step_time_ms": 548.652, "sample_time_ms": 534.348, "synch_weights_time_ms": 12.97}, "counters": {"num_env_steps_sampled": 222300, "num_env_steps_trained": 222000, "num_agent_steps_sampled": 222300, "num_agent_steps_trained": 222000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1482, "num_samples_added_to_queue": 222300}, "done": false, "training_iteration": 74, "trial_id": "0313d_00000", "date": "2024-10-10_21-54-08", "timestamp": 1728593648, "time_this_iter_s": 10.290066957473755, "time_total_s": 761.5588295459747, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c16b60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 761.5588295459747, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 13.393333333333334, "ram_util_percent": 62.58}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 255210.640625, "policy_loss": 254892.140625, "entropy": 20.548263549804688, "entropy_coeff": 0.01, "var_gnorm": 16.518911361694336, "vf_loss": 380138.21875, "vf_explained_var": -0.4186372756958008}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 750.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 225300, "num_env_steps_trained": 225000, "num_agent_steps_sampled": 225300, "num_agent_steps_trained": 225000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1502, "num_samples_added_to_queue": 225300, "learner_queue": {"size_count": 750, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 52.565, "learner_load_time_ms": 0.191, "learner_load_wait_time_ms": 992.141, "learner_dequeue_time_ms": 8742.519}}, "env_runners": {"episode_reward_max": 364.9016666666665, "episode_reward_min": 221.592777777778, "episode_reward_mean": 285.36485000000005, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 221.592777777778}, "policy_reward_max": {"default_policy": 364.9016666666665}, "policy_reward_mean": {"default_policy": 285.36485000000005}, "custom_metrics": {"num_consolidated_mean": 1.5361000000000002, "num_consolidated_min": 1.37, "num_consolidated_max": 1.71, "num_overloaded_mean": 0.1671, "num_overloaded_min": 0.08, "num_overloaded_max": 0.29, "num_moves_mean": 7.5169999999999995, "num_moves_min": 6.75, "num_moves_max": 8.14, "mean_accuracy_mean": 39.591083333333316, "mean_accuracy_min": 39.33299999999998, "mean_accuracy_max": 39.78899999999998, "num_model_switches_mean": 3.4838000000000005, "num_model_switches_min": 3.14, "num_model_switches_max": 4.05, "num_slav_mean": 0.011011999999999997, "num_slav_min": 0.003516666666666666, "num_slav_max": 0.018916666666666665, "mean_cluster_cpu_util_mean": 0.4711097876968846, "mean_cluster_cpu_util_min": 0.4570740309831746, "mean_cluster_cpu_util_max": 0.4853042412932124, "mean_cluster_mem_util_mean": 0.30369821356095184, "mean_cluster_mem_util_min": 0.29697394227733287, "mean_cluster_mem_util_max": 0.31083377931341316, "reward_consolidation_mean_mean": 1.775, "reward_consolidation_mean_min": 1.5, "reward_consolidation_mean_max": 2.152777777777778, "reward_illegal_mean_mean": -0.2785, "reward_illegal_mean_min": -0.4833333333333333, "reward_illegal_mean_max": -0.13333333333333333, "reward_accuracy_mean_mean": 1.6560151666666665, "reward_accuracy_mean_min": 1.4191166666666666, "reward_accuracy_mean_max": 1.825683333333333, "reward_sla_mean_mean": -0.2988666666666667, "reward_sla_mean_min": -0.6305555555555554, "reward_sla_mean_max": -0.1161111111111111, "reward_consolidation_sum_mean": 177.5, "reward_consolidation_sum_min": 150.0, "reward_consolidation_sum_max": 215.2777777777778, "reward_illegal_sum_mean": -27.85, "reward_illegal_sum_min": -48.33333333333333, "reward_illegal_sum_max": -13.333333333333332, "reward_accuracy_sum_mean": 165.60151666666664, "reward_accuracy_sum_min": 141.91166666666666, "reward_accuracy_sum_max": 182.5683333333333, "reward_sla_sum_mean": -29.886666666666667, "reward_sla_sum_min": -63.05555555555554, "reward_sla_sum_max": -11.611111111111109, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3257.0, "global_timestep_min": 1100, "global_timestep_max": 4900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [291.5883333333333, 278.1927777777778, 265.6600000000001, 281.9927777777778, 300.11833333333345, 230.79000000000013, 304.80833333333334, 269.4677777777778, 275.8583333333334, 333.3166666666665, 305.7611111111111, 289.75500000000005, 305.92944444444447, 279.91944444444454, 280.5633333333334, 253.9316666666668, 316.0311111111108, 252.61333333333354, 229.24222222222235, 276.3644444444445, 281.96000000000004, 279.6777777777778, 287.6127777777778, 305.16611111111104, 262.62277777777797, 279.03944444444454, 260.69777777777796, 294.38166666666666, 248.20000000000022, 269.4055555555558, 256.98055555555567, 255.73277777777795, 241.262777777778, 230.85611111111126, 289.54833333333346, 270.31055555555565, 272.3266666666667, 266.2955555555557, 291.13444444444457, 280.0811111111112, 277.54166666666663, 289.79277777777787, 275.63444444444445, 268.9694444444446, 281.47166666666675, 292.7305555555556, 280.7566666666668, 287.6050000000002, 306.74833333333333, 311.7455555555554, 268.05611111111114, 271.58944444444455, 278.7644444444444, 257.9011111111113, 267.95444444444456, 310.6683333333333, 293.2005555555555, 302.0572222222221, 221.592777777778, 291.2555555555556, 259.9922222222224, 269.34166666666687, 305.2922222222222, 301.1327777777778, 291.2700000000001, 286.5661111111112, 319.9044444444444, 276.6616666666668, 272.6527777777778, 294.9294444444445, 297.34888888888895, 288.961111111111, 310.36666666666673, 319.45333333333343, 318.3961111111112, 289.2255555555555, 327.03999999999996, 364.9016666666665, 319.40444444444455, 326.58722222222207, 244.87666666666675, 319.6361111111111, 305.77888888888896, 314.69888888888875, 288.3005555555556, 289.88777777777784, 284.2788888888889, 326.6816666666667, 304.5566666666667, 305.78055555555574, 269.0972222222223, 268.73166666666674, 280.5811111111113, 262.3061111111113, 289.87388888888887, 275.06666666666683, 295.8505555555557, 294.3188888888889, 299.2311111111109, 296.2894444444444], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [291.5883333333333, 278.1927777777778, 265.6600000000001, 281.9927777777778, 300.11833333333345, 230.79000000000013, 304.80833333333334, 269.4677777777778, 275.8583333333334, 333.3166666666665, 305.7611111111111, 289.75500000000005, 305.92944444444447, 279.91944444444454, 280.5633333333334, 253.9316666666668, 316.0311111111108, 252.61333333333354, 229.24222222222235, 276.3644444444445, 281.96000000000004, 279.6777777777778, 287.6127777777778, 305.16611111111104, 262.62277777777797, 279.03944444444454, 260.69777777777796, 294.38166666666666, 248.20000000000022, 269.4055555555558, 256.98055555555567, 255.73277777777795, 241.262777777778, 230.85611111111126, 289.54833333333346, 270.31055555555565, 272.3266666666667, 266.2955555555557, 291.13444444444457, 280.0811111111112, 277.54166666666663, 289.79277777777787, 275.63444444444445, 268.9694444444446, 281.47166666666675, 292.7305555555556, 280.7566666666668, 287.6050000000002, 306.74833333333333, 311.7455555555554, 268.05611111111114, 271.58944444444455, 278.7644444444444, 257.9011111111113, 267.95444444444456, 310.6683333333333, 293.2005555555555, 302.0572222222221, 221.592777777778, 291.2555555555556, 259.9922222222224, 269.34166666666687, 305.2922222222222, 301.1327777777778, 291.2700000000001, 286.5661111111112, 319.9044444444444, 276.6616666666668, 272.6527777777778, 294.9294444444445, 297.34888888888895, 288.961111111111, 310.36666666666673, 319.45333333333343, 318.3961111111112, 289.2255555555555, 327.03999999999996, 364.9016666666665, 319.40444444444455, 326.58722222222207, 244.87666666666675, 319.6361111111111, 305.77888888888896, 314.69888888888875, 288.3005555555556, 289.88777777777784, 284.2788888888889, 326.6816666666667, 304.5566666666667, 305.78055555555574, 269.0972222222223, 268.73166666666674, 280.5811111111113, 262.3061111111113, 289.87388888888887, 275.06666666666683, 295.8505555555557, 294.3188888888889, 299.2311111111109, 296.2894444444444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19519788095209997, "mean_inference_ms": 1.7902841110624692, "mean_action_processing_ms": 0.07432781090590188, "mean_env_wait_ms": 1.2129845963113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004528045654296875, "StateBufferConnector_ms": 0.0030066967010498047, "ViewRequirementAgentConnector_ms": 0.06956171989440918}, "num_episodes": 30, "episode_return_max": 364.9016666666665, "episode_return_min": 221.592777777778, "episode_return_mean": 285.36485000000005, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225300, "num_agent_steps_trained": 225000, "num_env_steps_sampled": 225300, "num_env_steps_trained": 225000, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 288.657524366474, "num_env_steps_trained_throughput_per_sec": 288.657524366474, "timesteps_total": 225300, "num_env_steps_sampled_lifetime": 225300, "num_agent_steps_sampled_lifetime": 225300, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 225300, "timers": {"training_iteration_time_ms": 10369.815, "restore_workers_time_ms": 0.011, "training_step_time_ms": 517.892, "sample_time_ms": 503.623, "synch_weights_time_ms": 12.899}, "counters": {"num_env_steps_sampled": 225300, "num_env_steps_trained": 225000, "num_agent_steps_sampled": 225300, "num_agent_steps_trained": 225000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1502, "num_samples_added_to_queue": 225300}, "done": false, "training_iteration": 75, "trial_id": "0313d_00000", "date": "2024-10-10_21-54-18", "timestamp": 1728593658, "time_this_iter_s": 10.403829097747803, "time_total_s": 771.9626586437225, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae4319f430>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 771.9626586437225, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 11.226666666666665, "ram_util_percent": 62.64000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 239566.0, "policy_loss": 239267.859375, "entropy": 20.232133865356445, "entropy_coeff": 0.01, "var_gnorm": 16.52587890625, "vf_loss": 358842.75, "vf_explained_var": -0.4492868185043335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 760.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 228300, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228300, "num_agent_steps_trained": 228000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1522, "num_samples_added_to_queue": 228300, "learner_queue": {"size_count": 760, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.197, "learner_load_time_ms": 0.235, "learner_load_wait_time_ms": 984.439, "learner_dequeue_time_ms": 8684.983}}, "env_runners": {"episode_reward_max": 364.9016666666665, "episode_reward_min": 221.592777777778, "episode_reward_mean": 293.20045000000005, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 221.592777777778}, "policy_reward_max": {"default_policy": 364.9016666666665}, "policy_reward_mean": {"default_policy": 293.20045000000005}, "custom_metrics": {"num_consolidated_mean": 1.5592000000000001, "num_consolidated_min": 1.39, "num_consolidated_max": 1.75, "num_overloaded_mean": 0.1611, "num_overloaded_min": 0.08, "num_overloaded_max": 0.29, "num_moves_mean": 7.431000000000001, "num_moves_min": 6.75, "num_moves_max": 8.14, "mean_accuracy_mean": 39.55409666666665, "mean_accuracy_min": 39.33299999999998, "mean_accuracy_max": 39.75099999999999, "num_model_switches_mean": 3.3953, "num_model_switches_min": 2.95, "num_model_switches_max": 4.05, "num_slav_mean": 0.010395166666666667, "num_slav_min": 0.003516666666666666, "num_slav_max": 0.018916666666666665, "mean_cluster_cpu_util_mean": 0.4702997655049836, "mean_cluster_cpu_util_min": 0.45832761891008333, "mean_cluster_cpu_util_max": 0.48450358976369573, "mean_cluster_mem_util_mean": 0.3030048528714228, "mean_cluster_mem_util_min": 0.2952112982218204, "mean_cluster_mem_util_max": 0.31038028663997247, "reward_consolidation_mean_mean": 1.8169444444444445, "reward_consolidation_mean_min": 1.5, "reward_consolidation_mean_max": 2.152777777777778, "reward_illegal_mean_mean": -0.26849999999999996, "reward_illegal_mean_min": -0.4833333333333333, "reward_illegal_mean_max": -0.13333333333333333, "reward_accuracy_mean_mean": 1.6658378333333328, "reward_accuracy_mean_min": 1.4191166666666666, "reward_accuracy_mean_max": 1.825683333333333, "reward_sla_mean_mean": -0.2822777777777778, "reward_sla_mean_min": -0.6305555555555554, "reward_sla_mean_max": -0.09888888888888889, "reward_consolidation_sum_mean": 181.69444444444443, "reward_consolidation_sum_min": 150.0, "reward_consolidation_sum_max": 215.2777777777778, "reward_illegal_sum_mean": -26.84999999999999, "reward_illegal_sum_min": -48.33333333333333, "reward_illegal_sum_max": -13.333333333333332, "reward_accuracy_sum_mean": 166.58378333333334, "reward_accuracy_sum_min": 141.91166666666666, "reward_accuracy_sum_max": 182.5683333333333, "reward_sla_sum_mean": -28.227777777777778, "reward_sla_sum_min": -63.05555555555554, "reward_sla_sum_max": -9.88888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4259.0, "global_timestep_min": 2100, "global_timestep_max": 5900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [256.98055555555567, 255.73277777777795, 241.262777777778, 230.85611111111126, 289.54833333333346, 270.31055555555565, 272.3266666666667, 266.2955555555557, 291.13444444444457, 280.0811111111112, 277.54166666666663, 289.79277777777787, 275.63444444444445, 268.9694444444446, 281.47166666666675, 292.7305555555556, 280.7566666666668, 287.6050000000002, 306.74833333333333, 311.7455555555554, 268.05611111111114, 271.58944444444455, 278.7644444444444, 257.9011111111113, 267.95444444444456, 310.6683333333333, 293.2005555555555, 302.0572222222221, 221.592777777778, 291.2555555555556, 259.9922222222224, 269.34166666666687, 305.2922222222222, 301.1327777777778, 291.2700000000001, 286.5661111111112, 319.9044444444444, 276.6616666666668, 272.6527777777778, 294.9294444444445, 297.34888888888895, 288.961111111111, 310.36666666666673, 319.45333333333343, 318.3961111111112, 289.2255555555555, 327.03999999999996, 364.9016666666665, 319.40444444444455, 326.58722222222207, 244.87666666666675, 319.6361111111111, 305.77888888888896, 314.69888888888875, 288.3005555555556, 289.88777777777784, 284.2788888888889, 326.6816666666667, 304.5566666666667, 305.78055555555574, 269.0972222222223, 268.73166666666674, 280.5811111111113, 262.3061111111113, 289.87388888888887, 275.06666666666683, 295.8505555555557, 294.3188888888889, 299.2311111111109, 296.2894444444444, 349.14166666666637, 341.6105555555555, 332.08888888888873, 316.0644444444443, 280.80888888888904, 321.6455555555555, 298.84388888888896, 296.3988888888889, 318.2627777777776, 332.14999999999975, 306.1444444444443, 268.9866666666668, 307.59611111111127, 253.86833333333348, 331.57999999999976, 300.95722222222224, 298.13666666666666, 301.2383333333333, 280.2005555555557, 285.7966666666667, 308.8977777777778, 299.8361111111111, 298.89277777777767, 280.2722222222221, 313.57166666666654, 307.30111111111114, 292.4488888888888, 299.99333333333345, 341.2938888888889, 310.2000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [256.98055555555567, 255.73277777777795, 241.262777777778, 230.85611111111126, 289.54833333333346, 270.31055555555565, 272.3266666666667, 266.2955555555557, 291.13444444444457, 280.0811111111112, 277.54166666666663, 289.79277777777787, 275.63444444444445, 268.9694444444446, 281.47166666666675, 292.7305555555556, 280.7566666666668, 287.6050000000002, 306.74833333333333, 311.7455555555554, 268.05611111111114, 271.58944444444455, 278.7644444444444, 257.9011111111113, 267.95444444444456, 310.6683333333333, 293.2005555555555, 302.0572222222221, 221.592777777778, 291.2555555555556, 259.9922222222224, 269.34166666666687, 305.2922222222222, 301.1327777777778, 291.2700000000001, 286.5661111111112, 319.9044444444444, 276.6616666666668, 272.6527777777778, 294.9294444444445, 297.34888888888895, 288.961111111111, 310.36666666666673, 319.45333333333343, 318.3961111111112, 289.2255555555555, 327.03999999999996, 364.9016666666665, 319.40444444444455, 326.58722222222207, 244.87666666666675, 319.6361111111111, 305.77888888888896, 314.69888888888875, 288.3005555555556, 289.88777777777784, 284.2788888888889, 326.6816666666667, 304.5566666666667, 305.78055555555574, 269.0972222222223, 268.73166666666674, 280.5811111111113, 262.3061111111113, 289.87388888888887, 275.06666666666683, 295.8505555555557, 294.3188888888889, 299.2311111111109, 296.2894444444444, 349.14166666666637, 341.6105555555555, 332.08888888888873, 316.0644444444443, 280.80888888888904, 321.6455555555555, 298.84388888888896, 296.3988888888889, 318.2627777777776, 332.14999999999975, 306.1444444444443, 268.9866666666668, 307.59611111111127, 253.86833333333348, 331.57999999999976, 300.95722222222224, 298.13666666666666, 301.2383333333333, 280.2005555555557, 285.7966666666667, 308.8977777777778, 299.8361111111111, 298.89277777777767, 280.2722222222221, 313.57166666666654, 307.30111111111114, 292.4488888888888, 299.99333333333345, 341.2938888888889, 310.2000000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19536590999563688, "mean_inference_ms": 1.7922175500074078, "mean_action_processing_ms": 0.0743795650647536, "mean_env_wait_ms": 1.2137393844628794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004426717758178711, "StateBufferConnector_ms": 0.0029916763305664062, "ViewRequirementAgentConnector_ms": 0.06890654563903809}, "num_episodes": 30, "episode_return_max": 364.9016666666665, "episode_return_min": 221.592777777778, "episode_return_mean": 293.20045000000005, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228300, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228300, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 288.8306525584657, "num_env_steps_trained_throughput_per_sec": 288.8306525584657, "timesteps_total": 228300, "num_env_steps_sampled_lifetime": 228300, "num_agent_steps_sampled_lifetime": 228300, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 228300, "timers": {"training_iteration_time_ms": 10403.575, "restore_workers_time_ms": 0.011, "training_step_time_ms": 524.255, "sample_time_ms": 510.459, "synch_weights_time_ms": 12.472}, "counters": {"num_env_steps_sampled": 228300, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228300, "num_agent_steps_trained": 228000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1522, "num_samples_added_to_queue": 228300}, "done": false, "training_iteration": 76, "trial_id": "0313d_00000", "date": "2024-10-10_21-54-29", "timestamp": 1728593669, "time_this_iter_s": 10.397094488143921, "time_total_s": 782.3597531318665, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae4319fdf0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 782.3597531318665, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 12.453333333333335, "ram_util_percent": 62.84}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 238601.671875, "policy_loss": 238289.265625, "entropy": 19.929367065429688, "entropy_coeff": 0.01, "var_gnorm": 16.532394409179688, "vf_loss": 372192.46875, "vf_explained_var": -0.4217357635498047}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 770.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 231150, "num_env_steps_trained": 231000, "num_agent_steps_sampled": 231150, "num_agent_steps_trained": 231000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1541, "num_samples_added_to_queue": 231000, "learner_queue": {"size_count": 770, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.15, "learner_load_time_ms": 0.263, "learner_load_wait_time_ms": 1029.316, "learner_dequeue_time_ms": 8682.905}}, "env_runners": {"episode_reward_max": 367.0244444444444, "episode_reward_min": 221.592777777778, "episode_reward_mean": 302.6040666666666, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 221.592777777778}, "policy_reward_max": {"default_policy": 367.0244444444444}, "policy_reward_mean": {"default_policy": 302.6040666666666}, "custom_metrics": {"num_consolidated_mean": 1.5883, "num_consolidated_min": 1.4, "num_consolidated_max": 1.76, "num_overloaded_mean": 0.15349999999999997, "num_overloaded_min": 0.08, "num_overloaded_max": 0.27, "num_moves_mean": 7.3049, "num_moves_min": 6.71, "num_moves_max": 8.14, "mean_accuracy_mean": 39.51425999999998, "mean_accuracy_min": 39.28233333333332, "mean_accuracy_max": 39.73833333333332, "num_model_switches_mean": 3.3207000000000004, "num_model_switches_min": 2.85, "num_model_switches_max": 4.05, "num_slav_mean": 0.009758, "num_slav_min": 0.003516666666666666, "num_slav_max": 0.018916666666666665, "mean_cluster_cpu_util_mean": 0.4691392804715535, "mean_cluster_cpu_util_min": 0.4538989633495184, "mean_cluster_cpu_util_max": 0.48450358976369573, "mean_cluster_mem_util_mean": 0.30207226742659093, "mean_cluster_mem_util_min": 0.2948556678578605, "mean_cluster_mem_util_max": 0.3097880842948994, "reward_consolidation_mean_mean": 1.87125, "reward_consolidation_mean_min": 1.5, "reward_consolidation_mean_max": 2.1944444444444446, "reward_illegal_mean_mean": -0.2558333333333333, "reward_illegal_mean_min": -0.45, "reward_illegal_mean_max": -0.13333333333333333, "reward_accuracy_mean_mean": 1.678357333333333, "reward_accuracy_mean_min": 1.4798166666666663, "reward_accuracy_mean_max": 1.825683333333333, "reward_sla_mean_mean": -0.2677333333333334, "reward_sla_mean_min": -0.6305555555555554, "reward_sla_mean_max": -0.09888888888888889, "reward_consolidation_sum_mean": 187.125, "reward_consolidation_sum_min": 150.0, "reward_consolidation_sum_max": 219.44444444444446, "reward_illegal_sum_mean": -25.58333333333333, "reward_illegal_sum_min": -45.0, "reward_illegal_sum_max": -13.333333333333332, "reward_accuracy_sum_mean": 167.8357333333333, "reward_accuracy_sum_min": 147.98166666666663, "reward_accuracy_sum_max": 182.5683333333333, "reward_sla_sum_mean": -26.773333333333333, "reward_sla_sum_min": -63.05555555555554, "reward_sla_sum_max": -9.88888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5157.0, "global_timestep_min": 3000, "global_timestep_max": 6800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [302.0572222222221, 221.592777777778, 291.2555555555556, 259.9922222222224, 269.34166666666687, 305.2922222222222, 301.1327777777778, 291.2700000000001, 286.5661111111112, 319.9044444444444, 276.6616666666668, 272.6527777777778, 294.9294444444445, 297.34888888888895, 288.961111111111, 310.36666666666673, 319.45333333333343, 318.3961111111112, 289.2255555555555, 327.03999999999996, 364.9016666666665, 319.40444444444455, 326.58722222222207, 244.87666666666675, 319.6361111111111, 305.77888888888896, 314.69888888888875, 288.3005555555556, 289.88777777777784, 284.2788888888889, 326.6816666666667, 304.5566666666667, 305.78055555555574, 269.0972222222223, 268.73166666666674, 280.5811111111113, 262.3061111111113, 289.87388888888887, 275.06666666666683, 295.8505555555557, 294.3188888888889, 299.2311111111109, 296.2894444444444, 349.14166666666637, 341.6105555555555, 332.08888888888873, 316.0644444444443, 280.80888888888904, 321.6455555555555, 298.84388888888896, 296.3988888888889, 318.2627777777776, 332.14999999999975, 306.1444444444443, 268.9866666666668, 307.59611111111127, 253.86833333333348, 331.57999999999976, 300.95722222222224, 298.13666666666666, 301.2383333333333, 280.2005555555557, 285.7966666666667, 308.8977777777778, 299.8361111111111, 298.89277777777767, 280.2722222222221, 313.57166666666654, 307.30111111111114, 292.4488888888888, 299.99333333333345, 341.2938888888889, 310.2000000000001, 336.9127777777777, 287.57444444444445, 304.6699999999999, 312.1377777777777, 326.66944444444437, 306.31222222222215, 315.4477777777777, 349.277222222222, 335.1922222222221, 324.54944444444453, 271.9266666666668, 288.0733333333333, 325.73055555555555, 305.9866666666667, 313.25388888888875, 314.34333333333325, 335.42944444444436, 312.46333333333337, 292.16111111111104, 290.09833333333336, 349.39666666666653, 270.2655555555557, 298.7394444444446, 367.0244444444444, 293.67888888888876, 289.31277777777774, 299.39333333333326], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [302.0572222222221, 221.592777777778, 291.2555555555556, 259.9922222222224, 269.34166666666687, 305.2922222222222, 301.1327777777778, 291.2700000000001, 286.5661111111112, 319.9044444444444, 276.6616666666668, 272.6527777777778, 294.9294444444445, 297.34888888888895, 288.961111111111, 310.36666666666673, 319.45333333333343, 318.3961111111112, 289.2255555555555, 327.03999999999996, 364.9016666666665, 319.40444444444455, 326.58722222222207, 244.87666666666675, 319.6361111111111, 305.77888888888896, 314.69888888888875, 288.3005555555556, 289.88777777777784, 284.2788888888889, 326.6816666666667, 304.5566666666667, 305.78055555555574, 269.0972222222223, 268.73166666666674, 280.5811111111113, 262.3061111111113, 289.87388888888887, 275.06666666666683, 295.8505555555557, 294.3188888888889, 299.2311111111109, 296.2894444444444, 349.14166666666637, 341.6105555555555, 332.08888888888873, 316.0644444444443, 280.80888888888904, 321.6455555555555, 298.84388888888896, 296.3988888888889, 318.2627777777776, 332.14999999999975, 306.1444444444443, 268.9866666666668, 307.59611111111127, 253.86833333333348, 331.57999999999976, 300.95722222222224, 298.13666666666666, 301.2383333333333, 280.2005555555557, 285.7966666666667, 308.8977777777778, 299.8361111111111, 298.89277777777767, 280.2722222222221, 313.57166666666654, 307.30111111111114, 292.4488888888888, 299.99333333333345, 341.2938888888889, 310.2000000000001, 336.9127777777777, 287.57444444444445, 304.6699999999999, 312.1377777777777, 326.66944444444437, 306.31222222222215, 315.4477777777777, 349.277222222222, 335.1922222222221, 324.54944444444453, 271.9266666666668, 288.0733333333333, 325.73055555555555, 305.9866666666667, 313.25388888888875, 314.34333333333325, 335.42944444444436, 312.46333333333337, 292.16111111111104, 290.09833333333336, 349.39666666666653, 270.2655555555557, 298.7394444444446, 367.0244444444444, 293.67888888888876, 289.31277777777774, 299.39333333333326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19542749486191105, "mean_inference_ms": 1.7913303705242907, "mean_action_processing_ms": 0.07439334877036533, "mean_env_wait_ms": 1.2139042471143424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004441976547241211, "StateBufferConnector_ms": 0.0030078887939453125, "ViewRequirementAgentConnector_ms": 0.06957411766052246}, "num_episodes": 27, "episode_return_max": 367.0244444444444, "episode_return_min": 221.592777777778, "episode_return_mean": 302.6040666666666, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231150, "num_agent_steps_trained": 231000, "num_env_steps_sampled": 231150, "num_env_steps_trained": 231000, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 272.3116016349221, "num_env_steps_trained_throughput_per_sec": 286.64379119465485, "timesteps_total": 231150, "num_env_steps_sampled_lifetime": 231150, "num_agent_steps_sampled_lifetime": 231150, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 231150, "timers": {"training_iteration_time_ms": 10403.448, "restore_workers_time_ms": 0.011, "training_step_time_ms": 517.244, "sample_time_ms": 502.601, "synch_weights_time_ms": 13.303}, "counters": {"num_env_steps_sampled": 231150, "num_env_steps_trained": 231000, "num_agent_steps_sampled": 231150, "num_agent_steps_trained": 231000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1541, "num_samples_added_to_queue": 231000}, "done": false, "training_iteration": 77, "trial_id": "0313d_00000", "date": "2024-10-10_21-54-39", "timestamp": 1728593679, "time_this_iter_s": 10.482499122619629, "time_total_s": 792.8422522544861, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a4460>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 792.8422522544861, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 15.833333333333334, "ram_util_percent": 63.239999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 233722.703125, "policy_loss": 233393.578125, "entropy": 19.47176170349121, "entropy_coeff": 0.01, "var_gnorm": 16.542173385620117, "vf_loss": 387543.1875, "vf_explained_var": -0.378196120262146}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 780.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 234150, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234150, "num_agent_steps_trained": 234000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1561, "num_samples_added_to_queue": 234000, "learner_queue": {"size_count": 780, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.687, "learner_load_time_ms": 0.238, "learner_load_wait_time_ms": 995.579, "learner_dequeue_time_ms": 8627.115}}, "env_runners": {"episode_reward_max": 367.0244444444444, "episode_reward_min": 253.86833333333348, "episode_reward_mean": 310.61434444444444, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 253.86833333333348}, "policy_reward_max": {"default_policy": 367.0244444444444}, "policy_reward_mean": {"default_policy": 310.61434444444444}, "custom_metrics": {"num_consolidated_mean": 1.6275000000000004, "num_consolidated_min": 1.4, "num_consolidated_max": 1.82, "num_overloaded_mean": 0.1476, "num_overloaded_min": 0.04, "num_overloaded_max": 0.22, "num_moves_mean": 7.152100000000001, "num_moves_min": 6.62, "num_moves_max": 7.64, "mean_accuracy_mean": 39.44997666666665, "mean_accuracy_min": 39.237999999999985, "mean_accuracy_max": 39.73833333333332, "num_model_switches_mean": 3.1840999999999995, "num_model_switches_min": 2.75, "num_model_switches_max": 3.68, "num_slav_mean": 0.00918233333333333, "num_slav_min": 0.002666666666666666, "num_slav_max": 0.016483333333333332, "mean_cluster_cpu_util_mean": 0.46816198925035984, "mean_cluster_cpu_util_min": 0.4538989633495184, "mean_cluster_cpu_util_max": 0.48336659908064195, "mean_cluster_mem_util_mean": 0.30102514263289704, "mean_cluster_mem_util_min": 0.2948556678578605, "mean_cluster_mem_util_max": 0.3089050532449267, "reward_consolidation_mean_mean": 1.921388888888889, "reward_consolidation_mean_min": 1.611111111111111, "reward_consolidation_mean_max": 2.2222222222222223, "reward_illegal_mean_mean": -0.24599999999999994, "reward_illegal_mean_min": -0.36666666666666664, "reward_illegal_mean_max": -0.06666666666666667, "reward_accuracy_mean_mean": 1.684732333333333, "reward_accuracy_mean_min": 1.5386166666666663, "reward_accuracy_mean_max": 1.8936333333333328, "reward_sla_mean_mean": -0.25397777777777786, "reward_sla_mean_min": -0.4444444444444444, "reward_sla_mean_max": -0.08611111111111111, "reward_consolidation_sum_mean": 192.13888888888886, "reward_consolidation_sum_min": 161.1111111111111, "reward_consolidation_sum_max": 222.22222222222223, "reward_illegal_sum_mean": -24.599999999999994, "reward_illegal_sum_min": -36.666666666666664, "reward_illegal_sum_max": -6.666666666666666, "reward_accuracy_sum_mean": 168.47323333333327, "reward_accuracy_sum_min": 153.86166666666662, "reward_accuracy_sum_max": 189.3633333333333, "reward_sla_sum_mean": -25.397777777777772, "reward_sla_sum_min": -44.44444444444444, "reward_sla_sum_max": -8.61111111111111, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6157.0, "global_timestep_min": 4000, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [326.6816666666667, 304.5566666666667, 305.78055555555574, 269.0972222222223, 268.73166666666674, 280.5811111111113, 262.3061111111113, 289.87388888888887, 275.06666666666683, 295.8505555555557, 294.3188888888889, 299.2311111111109, 296.2894444444444, 349.14166666666637, 341.6105555555555, 332.08888888888873, 316.0644444444443, 280.80888888888904, 321.6455555555555, 298.84388888888896, 296.3988888888889, 318.2627777777776, 332.14999999999975, 306.1444444444443, 268.9866666666668, 307.59611111111127, 253.86833333333348, 331.57999999999976, 300.95722222222224, 298.13666666666666, 301.2383333333333, 280.2005555555557, 285.7966666666667, 308.8977777777778, 299.8361111111111, 298.89277777777767, 280.2722222222221, 313.57166666666654, 307.30111111111114, 292.4488888888888, 299.99333333333345, 341.2938888888889, 310.2000000000001, 336.9127777777777, 287.57444444444445, 304.6699999999999, 312.1377777777777, 326.66944444444437, 306.31222222222215, 315.4477777777777, 349.277222222222, 335.1922222222221, 324.54944444444453, 271.9266666666668, 288.0733333333333, 325.73055555555555, 305.9866666666667, 313.25388888888875, 314.34333333333325, 335.42944444444436, 312.46333333333337, 292.16111111111104, 290.09833333333336, 349.39666666666653, 270.2655555555557, 298.7394444444446, 367.0244444444444, 293.67888888888876, 289.31277777777774, 299.39333333333326, 317.1444444444443, 308.3116666666666, 294.0194444444445, 310.8377777777776, 316.88333333333316, 337.2161111111111, 326.80444444444424, 328.756111111111, 319.26444444444434, 363.682222222222, 301.5105555555555, 334.5627777777775, 315.6544444444444, 309.47833333333324, 318.4155555555553, 322.8455555555555, 336.5577777777776, 309.74611111111096, 357.89833333333326, 305.9077777777777, 311.41499999999974, 364.8077777777775, 302.4705555555556, 291.9255555555555, 319.1, 319.8688888888889, 343.39277777777755, 337.843333333333, 342.1544444444446, 334.3438888888889], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [326.6816666666667, 304.5566666666667, 305.78055555555574, 269.0972222222223, 268.73166666666674, 280.5811111111113, 262.3061111111113, 289.87388888888887, 275.06666666666683, 295.8505555555557, 294.3188888888889, 299.2311111111109, 296.2894444444444, 349.14166666666637, 341.6105555555555, 332.08888888888873, 316.0644444444443, 280.80888888888904, 321.6455555555555, 298.84388888888896, 296.3988888888889, 318.2627777777776, 332.14999999999975, 306.1444444444443, 268.9866666666668, 307.59611111111127, 253.86833333333348, 331.57999999999976, 300.95722222222224, 298.13666666666666, 301.2383333333333, 280.2005555555557, 285.7966666666667, 308.8977777777778, 299.8361111111111, 298.89277777777767, 280.2722222222221, 313.57166666666654, 307.30111111111114, 292.4488888888888, 299.99333333333345, 341.2938888888889, 310.2000000000001, 336.9127777777777, 287.57444444444445, 304.6699999999999, 312.1377777777777, 326.66944444444437, 306.31222222222215, 315.4477777777777, 349.277222222222, 335.1922222222221, 324.54944444444453, 271.9266666666668, 288.0733333333333, 325.73055555555555, 305.9866666666667, 313.25388888888875, 314.34333333333325, 335.42944444444436, 312.46333333333337, 292.16111111111104, 290.09833333333336, 349.39666666666653, 270.2655555555557, 298.7394444444446, 367.0244444444444, 293.67888888888876, 289.31277777777774, 299.39333333333326, 317.1444444444443, 308.3116666666666, 294.0194444444445, 310.8377777777776, 316.88333333333316, 337.2161111111111, 326.80444444444424, 328.756111111111, 319.26444444444434, 363.682222222222, 301.5105555555555, 334.5627777777775, 315.6544444444444, 309.47833333333324, 318.4155555555553, 322.8455555555555, 336.5577777777776, 309.74611111111096, 357.89833333333326, 305.9077777777777, 311.41499999999974, 364.8077777777775, 302.4705555555556, 291.9255555555555, 319.1, 319.8688888888889, 343.39277777777755, 337.843333333333, 342.1544444444446, 334.3438888888889]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1955358799023451, "mean_inference_ms": 1.7920521369154903, "mean_action_processing_ms": 0.07442977381017485, "mean_env_wait_ms": 1.2144399352813782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044591426849365234, "StateBufferConnector_ms": 0.0030188560485839844, "ViewRequirementAgentConnector_ms": 0.06924247741699219}, "num_episodes": 30, "episode_return_max": 367.0244444444444, "episode_return_min": 253.86833333333348, "episode_return_mean": 310.61434444444444, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234150, "num_agent_steps_trained": 234000, "num_env_steps_sampled": 234150, "num_env_steps_trained": 234000, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 285.0280274234987, "num_env_steps_trained_throughput_per_sec": 285.0280274234987, "timesteps_total": 234150, "num_env_steps_sampled_lifetime": 234150, "num_agent_steps_sampled_lifetime": 234150, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 234150, "timers": {"training_iteration_time_ms": 10400.277, "restore_workers_time_ms": 0.011, "training_step_time_ms": 513.612, "sample_time_ms": 499.123, "synch_weights_time_ms": 13.031}, "counters": {"num_env_steps_sampled": 234150, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234150, "num_agent_steps_trained": 234000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1561, "num_samples_added_to_queue": 234000}, "done": false, "training_iteration": 78, "trial_id": "0313d_00000", "date": "2024-10-10_21-54-50", "timestamp": 1728593690, "time_this_iter_s": 10.535438060760498, "time_total_s": 803.3776903152466, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d89780>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 803.3776903152466, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 11.713333333333335, "ram_util_percent": 63.36000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 229670.359375, "policy_loss": 229296.984375, "entropy": 18.51131820678711, "entropy_coeff": 0.01, "var_gnorm": 16.5517635345459, "vf_loss": 428913.4375, "vf_explained_var": -0.37243807315826416}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 790.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 237150, "num_env_steps_trained": 237000, "num_agent_steps_sampled": 237150, "num_agent_steps_trained": 237000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1581, "num_samples_added_to_queue": 237000, "learner_queue": {"size_count": 790, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 50.591, "learner_load_time_ms": 0.269, "learner_load_wait_time_ms": 970.678, "learner_dequeue_time_ms": 8591.959}}, "env_runners": {"episode_reward_max": 395.7955555555553, "episode_reward_min": 270.2655555555557, "episode_reward_mean": 322.8988722222222, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 270.2655555555557}, "policy_reward_max": {"default_policy": 395.7955555555553}, "policy_reward_mean": {"default_policy": 322.8988722222222}, "custom_metrics": {"num_consolidated_mean": 1.6798, "num_consolidated_min": 1.53, "num_consolidated_max": 1.94, "num_overloaded_mean": 0.1386, "num_overloaded_min": 0.04, "num_overloaded_max": 0.21, "num_moves_mean": 6.943099999999999, "num_moves_min": 6.23, "num_moves_max": 7.55, "mean_accuracy_mean": 39.38898666666665, "mean_accuracy_min": 39.19999999999998, "mean_accuracy_max": 39.61799999999999, "num_model_switches_mean": 3.035999999999999, "num_model_switches_min": 2.26, "num_model_switches_max": 3.61, "num_slav_mean": 0.008290833333333332, "num_slav_min": 0.002666666666666666, "num_slav_max": 0.014633333333333333, "mean_cluster_cpu_util_mean": 0.46674094580367687, "mean_cluster_cpu_util_min": 0.45329078915577575, "mean_cluster_cpu_util_max": 0.48336659908064195, "mean_cluster_mem_util_mean": 0.29954334698003676, "mean_cluster_mem_util_min": 0.29001073778667585, "mean_cluster_mem_util_max": 0.3089050532449267, "reward_consolidation_mean_mean": 1.9943055555555553, "reward_consolidation_mean_min": 1.708333333333333, "reward_consolidation_mean_max": 2.3472222222222228, "reward_illegal_mean_mean": -0.23099999999999996, "reward_illegal_mean_min": -0.3499999999999999, "reward_illegal_mean_max": -0.06666666666666667, "reward_accuracy_mean_mean": 1.6988498333333333, "reward_accuracy_mean_min": 1.550933333333333, "reward_accuracy_mean_max": 1.8936333333333328, "reward_sla_mean_mean": -0.23316666666666663, "reward_sla_mean_min": -0.4444444444444444, "reward_sla_mean_max": -0.061666666666666654, "reward_consolidation_sum_mean": 199.43055555555563, "reward_consolidation_sum_min": 170.83333333333331, "reward_consolidation_sum_max": 234.72222222222226, "reward_illegal_sum_mean": -23.1, "reward_illegal_sum_min": -34.99999999999999, "reward_illegal_sum_max": -6.666666666666666, "reward_accuracy_sum_mean": 169.88498333333334, "reward_accuracy_sum_min": 155.0933333333333, "reward_accuracy_sum_max": 189.3633333333333, "reward_sla_sum_mean": -23.31666666666667, "reward_sla_sum_min": -44.44444444444444, "reward_sla_sum_max": -6.166666666666665, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4817.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [301.2383333333333, 280.2005555555557, 285.7966666666667, 308.8977777777778, 299.8361111111111, 298.89277777777767, 280.2722222222221, 313.57166666666654, 307.30111111111114, 292.4488888888888, 299.99333333333345, 341.2938888888889, 310.2000000000001, 336.9127777777777, 287.57444444444445, 304.6699999999999, 312.1377777777777, 326.66944444444437, 306.31222222222215, 315.4477777777777, 349.277222222222, 335.1922222222221, 324.54944444444453, 271.9266666666668, 288.0733333333333, 325.73055555555555, 305.9866666666667, 313.25388888888875, 314.34333333333325, 335.42944444444436, 312.46333333333337, 292.16111111111104, 290.09833333333336, 349.39666666666653, 270.2655555555557, 298.7394444444446, 367.0244444444444, 293.67888888888876, 289.31277777777774, 299.39333333333326, 317.1444444444443, 308.3116666666666, 294.0194444444445, 310.8377777777776, 316.88333333333316, 337.2161111111111, 326.80444444444424, 328.756111111111, 319.26444444444434, 363.682222222222, 301.5105555555555, 334.5627777777775, 315.6544444444444, 309.47833333333324, 318.4155555555553, 322.8455555555555, 336.5577777777776, 309.74611111111096, 357.89833333333326, 305.9077777777777, 311.41499999999974, 364.8077777777775, 302.4705555555556, 291.9255555555555, 319.1, 319.8688888888889, 343.39277777777755, 337.843333333333, 342.1544444444446, 334.3438888888889, 351.2405555555554, 326.52055555555546, 318.2399999999998, 340.8594444444442, 315.10611111111103, 326.65333333333314, 308.2261111111111, 358.1061111111108, 376.6349999999997, 340.4227777777777, 350.34388888888856, 329.55888888888876, 311.7499999999999, 376.90388888888856, 329.55722222222215, 359.82833333333315, 329.3605555555554, 367.4866666666665, 336.50166666666667, 347.3272222222221, 330.0199999999998, 362.08944444444427, 306.91722222222216, 330.3455555555554, 365.4605555555553, 297.12499999999994, 379.50111111111084, 347.5199999999999, 395.7955555555553, 335.7005555555553], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [301.2383333333333, 280.2005555555557, 285.7966666666667, 308.8977777777778, 299.8361111111111, 298.89277777777767, 280.2722222222221, 313.57166666666654, 307.30111111111114, 292.4488888888888, 299.99333333333345, 341.2938888888889, 310.2000000000001, 336.9127777777777, 287.57444444444445, 304.6699999999999, 312.1377777777777, 326.66944444444437, 306.31222222222215, 315.4477777777777, 349.277222222222, 335.1922222222221, 324.54944444444453, 271.9266666666668, 288.0733333333333, 325.73055555555555, 305.9866666666667, 313.25388888888875, 314.34333333333325, 335.42944444444436, 312.46333333333337, 292.16111111111104, 290.09833333333336, 349.39666666666653, 270.2655555555557, 298.7394444444446, 367.0244444444444, 293.67888888888876, 289.31277777777774, 299.39333333333326, 317.1444444444443, 308.3116666666666, 294.0194444444445, 310.8377777777776, 316.88333333333316, 337.2161111111111, 326.80444444444424, 328.756111111111, 319.26444444444434, 363.682222222222, 301.5105555555555, 334.5627777777775, 315.6544444444444, 309.47833333333324, 318.4155555555553, 322.8455555555555, 336.5577777777776, 309.74611111111096, 357.89833333333326, 305.9077777777777, 311.41499999999974, 364.8077777777775, 302.4705555555556, 291.9255555555555, 319.1, 319.8688888888889, 343.39277777777755, 337.843333333333, 342.1544444444446, 334.3438888888889, 351.2405555555554, 326.52055555555546, 318.2399999999998, 340.8594444444442, 315.10611111111103, 326.65333333333314, 308.2261111111111, 358.1061111111108, 376.6349999999997, 340.4227777777777, 350.34388888888856, 329.55888888888876, 311.7499999999999, 376.90388888888856, 329.55722222222215, 359.82833333333315, 329.3605555555554, 367.4866666666665, 336.50166666666667, 347.3272222222221, 330.0199999999998, 362.08944444444427, 306.91722222222216, 330.3455555555554, 365.4605555555553, 297.12499999999994, 379.50111111111084, 347.5199999999999, 395.7955555555553, 335.7005555555553]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1956140596192686, "mean_inference_ms": 1.7925420960073424, "mean_action_processing_ms": 0.0744586592062839, "mean_env_wait_ms": 1.2148556874000236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004441261291503906, "StateBufferConnector_ms": 0.0030002593994140625, "ViewRequirementAgentConnector_ms": 0.06862854957580566}, "num_episodes": 30, "episode_return_max": 395.7955555555553, "episode_return_min": 270.2655555555557, "episode_return_mean": 322.8988722222222, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 237150, "num_agent_steps_trained": 237000, "num_env_steps_sampled": 237150, "num_env_steps_trained": 237000, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 296.73387178931847, "num_env_steps_trained_throughput_per_sec": 296.73387178931847, "timesteps_total": 237150, "num_env_steps_sampled_lifetime": 237150, "num_agent_steps_sampled_lifetime": 237150, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 237150, "timers": {"training_iteration_time_ms": 10352.98, "restore_workers_time_ms": 0.011, "training_step_time_ms": 486.559, "sample_time_ms": 472.59, "synch_weights_time_ms": 12.685}, "counters": {"num_env_steps_sampled": 237150, "num_env_steps_trained": 237000, "num_agent_steps_sampled": 237150, "num_agent_steps_trained": 237000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1581, "num_samples_added_to_queue": 237000}, "done": false, "training_iteration": 79, "trial_id": "0313d_00000", "date": "2024-10-10_21-55-00", "timestamp": 1728593700, "time_this_iter_s": 10.129578351974487, "time_total_s": 813.5072686672211, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d8aa40>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 813.5072686672211, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 10.72857142857143, "ram_util_percent": 63.37142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 232524.046875, "policy_loss": 232141.875, "entropy": 18.077373504638672, "entropy_coeff": 0.01, "var_gnorm": 16.560293197631836, "vf_loss": 436413.25, "vf_explained_var": -0.3544355630874634}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 799.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 239700, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 239700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1600, "num_samples_added_to_queue": 240000, "learner_queue": {"size_count": 799, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.541, "learner_load_time_ms": 0.263, "learner_load_wait_time_ms": 1022.548, "learner_dequeue_time_ms": 8515.695}}, "env_runners": {"episode_reward_max": 402.1527777777776, "episode_reward_min": 270.2655555555557, "episode_reward_mean": 339.3533333333333, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 270.2655555555557}, "policy_reward_max": {"default_policy": 402.1527777777776}, "policy_reward_mean": {"default_policy": 339.3533333333333}, "custom_metrics": {"num_consolidated_mean": 1.7308000000000001, "num_consolidated_min": 1.53, "num_consolidated_max": 1.94, "num_overloaded_mean": 0.12430000000000004, "num_overloaded_min": 0.04, "num_overloaded_max": 0.2, "num_moves_mean": 6.696800000000001, "num_moves_min": 5.97, "num_moves_max": 7.45, "mean_accuracy_mean": 39.34382999999998, "mean_accuracy_min": 39.187333333333314, "mean_accuracy_max": 39.567333333333316, "num_model_switches_mean": 2.8812, "num_model_switches_min": 2.26, "num_model_switches_max": 3.59, "num_slav_mean": 0.007390333333333335, "num_slav_min": 0.002666666666666666, "num_slav_max": 0.014633333333333333, "mean_cluster_cpu_util_mean": 0.4652110891266848, "mean_cluster_cpu_util_min": 0.4523953541760144, "mean_cluster_cpu_util_max": 0.4786435693577949, "mean_cluster_mem_util_mean": 0.2980561732289962, "mean_cluster_mem_util_min": 0.29001073778667585, "mean_cluster_mem_util_max": 0.3089050532449267, "reward_consolidation_mean_mean": 2.08375, "reward_consolidation_mean_min": 1.708333333333333, "reward_consolidation_mean_max": 2.444444444444444, "reward_illegal_mean_mean": -0.2071666666666666, "reward_illegal_mean_min": -0.33333333333333326, "reward_illegal_mean_max": -0.06666666666666667, "reward_accuracy_mean_mean": 1.7240833333333334, "reward_accuracy_mean_min": 1.5695833333333329, "reward_accuracy_mean_max": 1.8936333333333328, "reward_sla_mean_mean": -0.2071333333333333, "reward_sla_mean_min": -0.4444444444444444, "reward_sla_mean_max": -0.061666666666666654, "reward_consolidation_sum_mean": 208.37500000000003, "reward_consolidation_sum_min": 170.83333333333331, "reward_consolidation_sum_max": 244.44444444444443, "reward_illegal_sum_mean": -20.71666666666667, "reward_illegal_sum_min": -33.33333333333333, "reward_illegal_sum_max": -6.666666666666666, "reward_accuracy_sum_mean": 172.40833333333333, "reward_accuracy_sum_min": 156.9583333333333, "reward_accuracy_sum_max": 189.3633333333333, "reward_sla_sum_mean": -20.71333333333333, "reward_sla_sum_min": -44.44444444444444, "reward_sla_sum_max": -6.166666666666665, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3479.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [312.46333333333337, 292.16111111111104, 290.09833333333336, 349.39666666666653, 270.2655555555557, 298.7394444444446, 367.0244444444444, 293.67888888888876, 289.31277777777774, 299.39333333333326, 317.1444444444443, 308.3116666666666, 294.0194444444445, 310.8377777777776, 316.88333333333316, 337.2161111111111, 326.80444444444424, 328.756111111111, 319.26444444444434, 363.682222222222, 301.5105555555555, 334.5627777777775, 315.6544444444444, 309.47833333333324, 318.4155555555553, 322.8455555555555, 336.5577777777776, 309.74611111111096, 357.89833333333326, 305.9077777777777, 311.41499999999974, 364.8077777777775, 302.4705555555556, 291.9255555555555, 319.1, 319.8688888888889, 343.39277777777755, 337.843333333333, 342.1544444444446, 334.3438888888889, 351.2405555555554, 326.52055555555546, 318.2399999999998, 340.8594444444442, 315.10611111111103, 326.65333333333314, 308.2261111111111, 358.1061111111108, 376.6349999999997, 340.4227777777777, 350.34388888888856, 329.55888888888876, 311.7499999999999, 376.90388888888856, 329.55722222222215, 359.82833333333315, 329.3605555555554, 367.4866666666665, 336.50166666666667, 347.3272222222221, 330.0199999999998, 362.08944444444427, 306.91722222222216, 330.3455555555554, 365.4605555555553, 297.12499999999994, 379.50111111111084, 347.5199999999999, 395.7955555555553, 335.7005555555553, 327.57499999999976, 372.58055555555507, 383.3755555555554, 365.05777777777763, 366.4538888888886, 345.20166666666665, 402.1527777777776, 356.2966666666665, 356.556111111111, 374.96944444444415, 344.6522222222221, 350.218333333333, 350.5261111111108, 336.16999999999985, 366.0733333333331, 365.7794444444443, 395.7705555555554, 377.3177777777776, 367.6366666666665, 377.63555555555536, 363.4461111111109, 330.4416666666665, 361.66833333333324, 334.7266666666666, 303.3211111111111, 383.70777777777766, 367.8661111111107, 397.89555555555535, 394.24888888888853, 399.5549999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [312.46333333333337, 292.16111111111104, 290.09833333333336, 349.39666666666653, 270.2655555555557, 298.7394444444446, 367.0244444444444, 293.67888888888876, 289.31277777777774, 299.39333333333326, 317.1444444444443, 308.3116666666666, 294.0194444444445, 310.8377777777776, 316.88333333333316, 337.2161111111111, 326.80444444444424, 328.756111111111, 319.26444444444434, 363.682222222222, 301.5105555555555, 334.5627777777775, 315.6544444444444, 309.47833333333324, 318.4155555555553, 322.8455555555555, 336.5577777777776, 309.74611111111096, 357.89833333333326, 305.9077777777777, 311.41499999999974, 364.8077777777775, 302.4705555555556, 291.9255555555555, 319.1, 319.8688888888889, 343.39277777777755, 337.843333333333, 342.1544444444446, 334.3438888888889, 351.2405555555554, 326.52055555555546, 318.2399999999998, 340.8594444444442, 315.10611111111103, 326.65333333333314, 308.2261111111111, 358.1061111111108, 376.6349999999997, 340.4227777777777, 350.34388888888856, 329.55888888888876, 311.7499999999999, 376.90388888888856, 329.55722222222215, 359.82833333333315, 329.3605555555554, 367.4866666666665, 336.50166666666667, 347.3272222222221, 330.0199999999998, 362.08944444444427, 306.91722222222216, 330.3455555555554, 365.4605555555553, 297.12499999999994, 379.50111111111084, 347.5199999999999, 395.7955555555553, 335.7005555555553, 327.57499999999976, 372.58055555555507, 383.3755555555554, 365.05777777777763, 366.4538888888886, 345.20166666666665, 402.1527777777776, 356.2966666666665, 356.556111111111, 374.96944444444415, 344.6522222222221, 350.218333333333, 350.5261111111108, 336.16999999999985, 366.0733333333331, 365.7794444444443, 395.7705555555554, 377.3177777777776, 367.6366666666665, 377.63555555555536, 363.4461111111109, 330.4416666666665, 361.66833333333324, 334.7266666666666, 303.3211111111111, 383.70777777777766, 367.8661111111107, 397.89555555555535, 394.24888888888853, 399.5549999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19574299747797916, "mean_inference_ms": 1.7944986094320405, "mean_action_processing_ms": 0.07450625047402014, "mean_env_wait_ms": 1.2155380221175107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004425048828125, "StateBufferConnector_ms": 0.002992391586303711, "ViewRequirementAgentConnector_ms": 0.068695068359375}, "num_episodes": 30, "episode_return_max": 402.1527777777776, "episode_return_min": 270.2655555555557, "episode_return_mean": 339.3533333333333, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 239700, "num_env_steps_sampled": 240000, "num_env_steps_trained": 239700, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 275.7216146327864, "num_env_steps_trained_throughput_per_sec": 261.209950704745, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 10347.114, "restore_workers_time_ms": 0.012, "training_step_time_ms": 572.115, "sample_time_ms": 556.897, "synch_weights_time_ms": 13.847}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 239700, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 239700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1600, "num_samples_added_to_queue": 240000}, "done": false, "training_iteration": 80, "trial_id": "0313d_00000", "date": "2024-10-10_21-55-10", "timestamp": 1728593710, "time_this_iter_s": 10.351057529449463, "time_total_s": 823.8583261966705, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c175b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 823.8583261966705, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 13.253333333333332, "ram_util_percent": 63.67333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 247404.515625, "policy_loss": 246949.859375, "entropy": 17.93976593017578, "entropy_coeff": 0.01, "var_gnorm": 16.569868087768555, "vf_loss": 508466.0, "vf_explained_var": -0.332039475440979}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 809.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 243000, "num_env_steps_trained": 242700, "num_agent_steps_sampled": 243000, "num_agent_steps_trained": 242700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1620, "num_samples_added_to_queue": 243000, "learner_queue": {"size_count": 809, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.27, "learner_load_time_ms": 0.283, "learner_load_wait_time_ms": 956.826, "learner_dequeue_time_ms": 8477.678}}, "env_runners": {"episode_reward_max": 417.84166666666647, "episode_reward_min": 291.9255555555555, "episode_reward_mean": 358.47849999999977, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 291.9255555555555}, "policy_reward_max": {"default_policy": 417.84166666666647}, "policy_reward_mean": {"default_policy": 358.47849999999977}, "custom_metrics": {"num_consolidated_mean": 1.7719, "num_consolidated_min": 1.55, "num_consolidated_max": 1.94, "num_overloaded_mean": 0.10550000000000001, "num_overloaded_min": 0.02, "num_overloaded_max": 0.2, "num_moves_mean": 6.495299999999999, "num_moves_min": 5.97, "num_moves_max": 7.3, "mean_accuracy_mean": 39.322613333333315, "mean_accuracy_min": 39.187333333333314, "mean_accuracy_max": 39.52299999999998, "num_model_switches_mean": 2.7705000000000006, "num_model_switches_min": 2.26, "num_model_switches_max": 3.18, "num_slav_mean": 0.006326333333333334, "num_slav_min": 0.002566666666666666, "num_slav_max": 0.014633333333333333, "mean_cluster_cpu_util_mean": 0.46436188751938606, "mean_cluster_cpu_util_min": 0.4523953541760144, "mean_cluster_cpu_util_max": 0.4766822195229093, "mean_cluster_mem_util_mean": 0.29708361794791754, "mean_cluster_mem_util_min": 0.29001073778667585, "mean_cluster_mem_util_max": 0.30518684466402596, "reward_consolidation_mean_mean": 2.1813888888888893, "reward_consolidation_mean_min": 1.8055555555555554, "reward_consolidation_mean_max": 2.4722222222222228, "reward_illegal_mean_mean": -0.17583333333333337, "reward_illegal_mean_min": -0.33333333333333326, "reward_illegal_mean_max": -0.03333333333333333, "reward_accuracy_mean_mean": 1.7602849999999994, "reward_accuracy_mean_min": 1.5695833333333329, "reward_accuracy_mean_max": 1.9264999999999999, "reward_sla_mean_mean": -0.18105555555555555, "reward_sla_mean_min": -0.4444444444444444, "reward_sla_mean_max": -0.061666666666666654, "reward_consolidation_sum_mean": 218.13888888888894, "reward_consolidation_sum_min": 180.55555555555554, "reward_consolidation_sum_max": 247.22222222222226, "reward_illegal_sum_mean": -17.58333333333333, "reward_illegal_sum_min": -33.33333333333333, "reward_illegal_sum_max": -3.333333333333333, "reward_accuracy_sum_mean": 176.0285, "reward_accuracy_sum_min": 156.9583333333333, "reward_accuracy_sum_max": 192.64999999999998, "reward_sla_sum_mean": -18.10555555555555, "reward_sla_sum_min": -44.44444444444444, "reward_sla_sum_max": -6.166666666666665, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2130.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [311.41499999999974, 364.8077777777775, 302.4705555555556, 291.9255555555555, 319.1, 319.8688888888889, 343.39277777777755, 337.843333333333, 342.1544444444446, 334.3438888888889, 351.2405555555554, 326.52055555555546, 318.2399999999998, 340.8594444444442, 315.10611111111103, 326.65333333333314, 308.2261111111111, 358.1061111111108, 376.6349999999997, 340.4227777777777, 350.34388888888856, 329.55888888888876, 311.7499999999999, 376.90388888888856, 329.55722222222215, 359.82833333333315, 329.3605555555554, 367.4866666666665, 336.50166666666667, 347.3272222222221, 330.0199999999998, 362.08944444444427, 306.91722222222216, 330.3455555555554, 365.4605555555553, 297.12499999999994, 379.50111111111084, 347.5199999999999, 395.7955555555553, 335.7005555555553, 327.57499999999976, 372.58055555555507, 383.3755555555554, 365.05777777777763, 366.4538888888886, 345.20166666666665, 402.1527777777776, 356.2966666666665, 356.556111111111, 374.96944444444415, 344.6522222222221, 350.218333333333, 350.5261111111108, 336.16999999999985, 366.0733333333331, 365.7794444444443, 395.7705555555554, 377.3177777777776, 367.6366666666665, 377.63555555555536, 363.4461111111109, 330.4416666666665, 361.66833333333324, 334.7266666666666, 303.3211111111111, 383.70777777777766, 367.8661111111107, 397.89555555555535, 394.24888888888853, 399.5549999999997, 372.8822222222222, 363.3994444444442, 374.39944444444393, 341.96999999999986, 354.3994444444445, 359.89111111111083, 389.2527777777776, 377.86555555555543, 406.1977777777777, 382.9544444444442, 374.0399999999998, 393.05666666666656, 359.8533333333333, 379.1438888888886, 410.8972222222219, 380.6277777777775, 391.047222222222, 370.70722222222213, 400.79499999999973, 401.5177777777773, 371.79444444444414, 417.84166666666647, 378.912222222222, 356.93, 372.10499999999985, 403.1099999999999, 379.8983333333333, 407.896111111111, 335.4561111111107, 401.7055555555552], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [311.41499999999974, 364.8077777777775, 302.4705555555556, 291.9255555555555, 319.1, 319.8688888888889, 343.39277777777755, 337.843333333333, 342.1544444444446, 334.3438888888889, 351.2405555555554, 326.52055555555546, 318.2399999999998, 340.8594444444442, 315.10611111111103, 326.65333333333314, 308.2261111111111, 358.1061111111108, 376.6349999999997, 340.4227777777777, 350.34388888888856, 329.55888888888876, 311.7499999999999, 376.90388888888856, 329.55722222222215, 359.82833333333315, 329.3605555555554, 367.4866666666665, 336.50166666666667, 347.3272222222221, 330.0199999999998, 362.08944444444427, 306.91722222222216, 330.3455555555554, 365.4605555555553, 297.12499999999994, 379.50111111111084, 347.5199999999999, 395.7955555555553, 335.7005555555553, 327.57499999999976, 372.58055555555507, 383.3755555555554, 365.05777777777763, 366.4538888888886, 345.20166666666665, 402.1527777777776, 356.2966666666665, 356.556111111111, 374.96944444444415, 344.6522222222221, 350.218333333333, 350.5261111111108, 336.16999999999985, 366.0733333333331, 365.7794444444443, 395.7705555555554, 377.3177777777776, 367.6366666666665, 377.63555555555536, 363.4461111111109, 330.4416666666665, 361.66833333333324, 334.7266666666666, 303.3211111111111, 383.70777777777766, 367.8661111111107, 397.89555555555535, 394.24888888888853, 399.5549999999997, 372.8822222222222, 363.3994444444442, 374.39944444444393, 341.96999999999986, 354.3994444444445, 359.89111111111083, 389.2527777777776, 377.86555555555543, 406.1977777777777, 382.9544444444442, 374.0399999999998, 393.05666666666656, 359.8533333333333, 379.1438888888886, 410.8972222222219, 380.6277777777775, 391.047222222222, 370.70722222222213, 400.79499999999973, 401.5177777777773, 371.79444444444414, 417.84166666666647, 378.912222222222, 356.93, 372.10499999999985, 403.1099999999999, 379.8983333333333, 407.896111111111, 335.4561111111107, 401.7055555555552]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19577563459907676, "mean_inference_ms": 1.7944698158857006, "mean_action_processing_ms": 0.07451617871226937, "mean_env_wait_ms": 1.2156499741366888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004652738571166992, "StateBufferConnector_ms": 0.0029370784759521484, "ViewRequirementAgentConnector_ms": 0.06628251075744629}, "num_episodes": 30, "episode_return_max": 417.84166666666647, "episode_return_min": 291.9255555555555, "episode_return_mean": 358.47849999999977, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 243000, "num_agent_steps_trained": 242700, "num_env_steps_sampled": 243000, "num_env_steps_trained": 242700, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 297.545238164602, "num_env_steps_trained_throughput_per_sec": 297.545238164602, "timesteps_total": 243000, "num_env_steps_sampled_lifetime": 243000, "num_agent_steps_sampled_lifetime": 243000, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 243000, "timers": {"training_iteration_time_ms": 10311.865, "restore_workers_time_ms": 0.012, "training_step_time_ms": 496.191, "sample_time_ms": 481.808, "synch_weights_time_ms": 13.058}, "counters": {"num_env_steps_sampled": 243000, "num_env_steps_trained": 242700, "num_agent_steps_sampled": 243000, "num_agent_steps_trained": 242700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1620, "num_samples_added_to_queue": 243000}, "done": false, "training_iteration": 81, "trial_id": "0313d_00000", "date": "2024-10-10_21-55-20", "timestamp": 1728593720, "time_this_iter_s": 10.093664407730103, "time_total_s": 833.9519906044006, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c14040>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 833.9519906044006, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 10.726666666666667, "ram_util_percent": 63.986666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 234538.484375, "policy_loss": 234113.140625, "entropy": 17.67432403564453, "entropy_coeff": 0.01, "var_gnorm": 16.575559616088867, "vf_loss": 478362.25, "vf_explained_var": -0.34015798568725586}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 819.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 246000, "num_env_steps_trained": 245700, "num_agent_steps_sampled": 246000, "num_agent_steps_trained": 245700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1640, "num_samples_added_to_queue": 246000, "learner_queue": {"size_count": 819, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.492, "learner_load_time_ms": 0.291, "learner_load_wait_time_ms": 950.045, "learner_dequeue_time_ms": 8413.515}}, "env_runners": {"episode_reward_max": 417.84166666666647, "episode_reward_min": 297.12499999999994, "episode_reward_mean": 372.7295444444442, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 297.12499999999994}, "policy_reward_max": {"default_policy": 417.84166666666647}, "policy_reward_mean": {"default_policy": 372.7295444444442}, "custom_metrics": {"num_consolidated_mean": 1.8106, "num_consolidated_min": 1.66, "num_consolidated_max": 1.94, "num_overloaded_mean": 0.0919, "num_overloaded_min": 0.02, "num_overloaded_max": 0.2, "num_moves_mean": 6.347599999999999, "num_moves_min": 5.83, "num_moves_max": 7.02, "mean_accuracy_mean": 39.32159999999998, "mean_accuracy_min": 39.168333333333315, "mean_accuracy_max": 39.491333333333316, "num_model_switches_mean": 2.716600000000001, "num_model_switches_min": 2.26, "num_model_switches_max": 3.15, "num_slav_mean": 0.005671666666666666, "num_slav_min": 0.0017499999999999998, "num_slav_max": 0.01075, "mean_cluster_cpu_util_mean": 0.4641952167038132, "mean_cluster_cpu_util_min": 0.4523953541760144, "mean_cluster_cpu_util_max": 0.4766822195229093, "mean_cluster_mem_util_mean": 0.2967235394242085, "mean_cluster_mem_util_min": 0.29001073778667585, "mean_cluster_mem_util_max": 0.3024597489523235, "reward_consolidation_mean_mean": 2.26125, "reward_consolidation_mean_min": 1.8472222222222223, "reward_consolidation_mean_max": 2.5416666666666665, "reward_illegal_mean_mean": -0.15316666666666665, "reward_illegal_mean_min": -0.33333333333333326, "reward_illegal_mean_max": -0.03333333333333333, "reward_accuracy_mean_mean": 1.785834333333333, "reward_accuracy_mean_min": 1.5695833333333329, "reward_accuracy_mean_max": 1.9264999999999999, "reward_sla_mean_mean": -0.1666222222222222, "reward_sla_mean_min": -0.3038888888888889, "reward_sla_mean_max": -0.05777777777777777, "reward_consolidation_sum_mean": 226.12499999999997, "reward_consolidation_sum_min": 184.72222222222223, "reward_consolidation_sum_max": 254.16666666666666, "reward_illegal_sum_mean": -15.316666666666665, "reward_illegal_sum_min": -33.33333333333333, "reward_illegal_sum_max": -3.333333333333333, "reward_accuracy_sum_mean": 178.58343333333332, "reward_accuracy_sum_min": 156.9583333333333, "reward_accuracy_sum_max": 192.64999999999998, "reward_sla_sum_mean": -16.66222222222222, "reward_sla_sum_min": -30.388888888888886, "reward_sla_sum_max": -5.777777777777777, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2350.0, "global_timestep_min": 100, "global_timestep_max": 4000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [330.0199999999998, 362.08944444444427, 306.91722222222216, 330.3455555555554, 365.4605555555553, 297.12499999999994, 379.50111111111084, 347.5199999999999, 395.7955555555553, 335.7005555555553, 327.57499999999976, 372.58055555555507, 383.3755555555554, 365.05777777777763, 366.4538888888886, 345.20166666666665, 402.1527777777776, 356.2966666666665, 356.556111111111, 374.96944444444415, 344.6522222222221, 350.218333333333, 350.5261111111108, 336.16999999999985, 366.0733333333331, 365.7794444444443, 395.7705555555554, 377.3177777777776, 367.6366666666665, 377.63555555555536, 363.4461111111109, 330.4416666666665, 361.66833333333324, 334.7266666666666, 303.3211111111111, 383.70777777777766, 367.8661111111107, 397.89555555555535, 394.24888888888853, 399.5549999999997, 372.8822222222222, 363.3994444444442, 374.39944444444393, 341.96999999999986, 354.3994444444445, 359.89111111111083, 389.2527777777776, 377.86555555555543, 406.1977777777777, 382.9544444444442, 374.0399999999998, 393.05666666666656, 359.8533333333333, 379.1438888888886, 410.8972222222219, 380.6277777777775, 391.047222222222, 370.70722222222213, 400.79499999999973, 401.5177777777773, 371.79444444444414, 417.84166666666647, 378.912222222222, 356.93, 372.10499999999985, 403.1099999999999, 379.8983333333333, 407.896111111111, 335.4561111111107, 401.7055555555552, 397.0805555555552, 402.8588888888887, 406.53944444444403, 384.6588888888886, 374.4288888888888, 376.2638888888889, 370.3099999999997, 362.9627777777776, 392.75388888888864, 363.40611111111104, 375.25555555555536, 344.2799999999998, 366.4705555555553, 396.7238888888889, 393.0499999999997, 406.71388888888856, 365.9783333333332, 381.4772222222221, 377.8977777777775, 369.19277777777774, 349.0966666666667, 409.41277777777736, 392.87555555555525, 387.70055555555535, 394.8572222222219, 400.22277777777776, 344.48666666666645, 416.832222222222, 382.73277777777764, 406.5344444444441], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [330.0199999999998, 362.08944444444427, 306.91722222222216, 330.3455555555554, 365.4605555555553, 297.12499999999994, 379.50111111111084, 347.5199999999999, 395.7955555555553, 335.7005555555553, 327.57499999999976, 372.58055555555507, 383.3755555555554, 365.05777777777763, 366.4538888888886, 345.20166666666665, 402.1527777777776, 356.2966666666665, 356.556111111111, 374.96944444444415, 344.6522222222221, 350.218333333333, 350.5261111111108, 336.16999999999985, 366.0733333333331, 365.7794444444443, 395.7705555555554, 377.3177777777776, 367.6366666666665, 377.63555555555536, 363.4461111111109, 330.4416666666665, 361.66833333333324, 334.7266666666666, 303.3211111111111, 383.70777777777766, 367.8661111111107, 397.89555555555535, 394.24888888888853, 399.5549999999997, 372.8822222222222, 363.3994444444442, 374.39944444444393, 341.96999999999986, 354.3994444444445, 359.89111111111083, 389.2527777777776, 377.86555555555543, 406.1977777777777, 382.9544444444442, 374.0399999999998, 393.05666666666656, 359.8533333333333, 379.1438888888886, 410.8972222222219, 380.6277777777775, 391.047222222222, 370.70722222222213, 400.79499999999973, 401.5177777777773, 371.79444444444414, 417.84166666666647, 378.912222222222, 356.93, 372.10499999999985, 403.1099999999999, 379.8983333333333, 407.896111111111, 335.4561111111107, 401.7055555555552, 397.0805555555552, 402.8588888888887, 406.53944444444403, 384.6588888888886, 374.4288888888888, 376.2638888888889, 370.3099999999997, 362.9627777777776, 392.75388888888864, 363.40611111111104, 375.25555555555536, 344.2799999999998, 366.4705555555553, 396.7238888888889, 393.0499999999997, 406.71388888888856, 365.9783333333332, 381.4772222222221, 377.8977777777775, 369.19277777777774, 349.0966666666667, 409.41277777777736, 392.87555555555525, 387.70055555555535, 394.8572222222219, 400.22277777777776, 344.48666666666645, 416.832222222222, 382.73277777777764, 406.5344444444441]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1958141703635912, "mean_inference_ms": 1.7943891481400462, "mean_action_processing_ms": 0.07452891721670779, "mean_env_wait_ms": 1.2157774921321467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046634674072265625, "StateBufferConnector_ms": 0.0029382705688476562, "ViewRequirementAgentConnector_ms": 0.06637048721313477}, "num_episodes": 30, "episode_return_max": 417.84166666666647, "episode_return_min": 297.12499999999994, "episode_return_mean": 372.7295444444442, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 246000, "num_agent_steps_trained": 245700, "num_env_steps_sampled": 246000, "num_env_steps_trained": 245700, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 297.5794510527689, "num_env_steps_trained_throughput_per_sec": 297.5794510527689, "timesteps_total": 246000, "num_env_steps_sampled_lifetime": 246000, "num_agent_steps_sampled_lifetime": 246000, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 246000, "timers": {"training_iteration_time_ms": 10270.075, "restore_workers_time_ms": 0.011, "training_step_time_ms": 516.324, "sample_time_ms": 501.342, "synch_weights_time_ms": 13.627}, "counters": {"num_env_steps_sampled": 246000, "num_env_steps_trained": 245700, "num_agent_steps_sampled": 246000, "num_agent_steps_trained": 245700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1640, "num_samples_added_to_queue": 246000}, "done": false, "training_iteration": 82, "trial_id": "0313d_00000", "date": "2024-10-10_21-55-30", "timestamp": 1728593730, "time_this_iter_s": 10.090639114379883, "time_total_s": 844.0426297187805, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d882e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 844.0426297187805, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 12.149999999999997, "ram_util_percent": 64.10714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 239955.625, "policy_loss": 239551.78125, "entropy": 17.677885055541992, "entropy_coeff": 0.01, "var_gnorm": 16.57699203491211, "vf_loss": 456867.5625, "vf_explained_var": -0.35185492038726807}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 829.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 249000, "num_env_steps_trained": 248700, "num_agent_steps_sampled": 249000, "num_agent_steps_trained": 248700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1660, "num_samples_added_to_queue": 249000, "learner_queue": {"size_count": 829, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.712, "learner_load_time_ms": 0.29, "learner_load_wait_time_ms": 992.861, "learner_dequeue_time_ms": 8365.36}}, "env_runners": {"episode_reward_max": 417.84166666666647, "episode_reward_min": 303.3211111111111, "episode_reward_mean": 379.56381666666647, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 303.3211111111111}, "policy_reward_max": {"default_policy": 417.84166666666647}, "policy_reward_mean": {"default_policy": 379.56381666666647}, "custom_metrics": {"num_consolidated_mean": 1.8350999999999997, "num_consolidated_min": 1.66, "num_consolidated_max": 2.0, "num_overloaded_mean": 0.0859, "num_overloaded_min": 0.02, "num_overloaded_max": 0.18, "num_moves_mean": 6.2902999999999984, "num_moves_min": 5.71, "num_moves_max": 6.8, "mean_accuracy_mean": 39.332556666666655, "mean_accuracy_min": 39.11766666666665, "mean_accuracy_max": 39.54833333333332, "num_model_switches_mean": 2.7071000000000005, "num_model_switches_min": 2.37, "num_model_switches_max": 3.1, "num_slav_mean": 0.005665999999999999, "num_slav_min": 0.0017499999999999998, "num_slav_max": 0.009966666666666667, "mean_cluster_cpu_util_mean": 0.4649327072490634, "mean_cluster_cpu_util_min": 0.4523953541760144, "mean_cluster_cpu_util_max": 0.47856317585131664, "mean_cluster_mem_util_mean": 0.296902227539539, "mean_cluster_mem_util_min": 0.2914159582292833, "mean_cluster_mem_util_max": 0.30227762816096904, "reward_consolidation_mean_mean": 2.3097222222222222, "reward_consolidation_mean_min": 1.9166666666666665, "reward_consolidation_mean_max": 2.5416666666666665, "reward_illegal_mean_mean": -0.14316666666666664, "reward_illegal_mean_min": -0.3, "reward_illegal_mean_max": -0.03333333333333333, "reward_accuracy_mean_mean": 1.797604833333333, "reward_accuracy_mean_min": 1.6154333333333333, "reward_accuracy_mean_max": 1.9264999999999999, "reward_sla_mean_mean": -0.1685222222222222, "reward_sla_mean_min": -0.3322222222222222, "reward_sla_mean_max": -0.033888888888888885, "reward_consolidation_sum_mean": 230.97222222222226, "reward_consolidation_sum_min": 191.66666666666666, "reward_consolidation_sum_max": 254.16666666666666, "reward_illegal_sum_mean": -14.316666666666668, "reward_illegal_sum_min": -30.0, "reward_illegal_sum_max": -3.333333333333333, "reward_accuracy_sum_mean": 179.7604833333333, "reward_accuracy_sum_min": 161.54333333333332, "reward_accuracy_sum_max": 192.64999999999998, "reward_sla_sum_mean": -16.852222222222224, "reward_sla_sum_min": -33.22222222222222, "reward_sla_sum_max": -3.388888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3350.0, "global_timestep_min": 1100, "global_timestep_max": 5000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [363.4461111111109, 330.4416666666665, 361.66833333333324, 334.7266666666666, 303.3211111111111, 383.70777777777766, 367.8661111111107, 397.89555555555535, 394.24888888888853, 399.5549999999997, 372.8822222222222, 363.3994444444442, 374.39944444444393, 341.96999999999986, 354.3994444444445, 359.89111111111083, 389.2527777777776, 377.86555555555543, 406.1977777777777, 382.9544444444442, 374.0399999999998, 393.05666666666656, 359.8533333333333, 379.1438888888886, 410.8972222222219, 380.6277777777775, 391.047222222222, 370.70722222222213, 400.79499999999973, 401.5177777777773, 371.79444444444414, 417.84166666666647, 378.912222222222, 356.93, 372.10499999999985, 403.1099999999999, 379.8983333333333, 407.896111111111, 335.4561111111107, 401.7055555555552, 397.0805555555552, 402.8588888888887, 406.53944444444403, 384.6588888888886, 374.4288888888888, 376.2638888888889, 370.3099999999997, 362.9627777777776, 392.75388888888864, 363.40611111111104, 375.25555555555536, 344.2799999999998, 366.4705555555553, 396.7238888888889, 393.0499999999997, 406.71388888888856, 365.9783333333332, 381.4772222222221, 377.8977777777775, 369.19277777777774, 349.0966666666667, 409.41277777777736, 392.87555555555525, 387.70055555555535, 394.8572222222219, 400.22277777777776, 344.48666666666645, 416.832222222222, 382.73277777777764, 406.5344444444441, 403.8572222222219, 401.06611111111084, 388.376111111111, 380.4938888888885, 380.6044444444443, 398.28666666666646, 376.6955555555554, 408.1661111111108, 397.641111111111, 377.68499999999983, 339.5888888888887, 383.0244444444442, 346.76999999999987, 386.1911111111108, 378.6061111111107, 395.6494444444441, 360.78777777777765, 399.7555555555553, 359.2555555555555, 365.2227777777775, 386.92722222222187, 404.58777777777743, 377.0149999999998, 370.38055555555525, 412.6599999999998, 383.1277777777775, 354.7094444444444, 368.9938888888888, 365.2649999999996, 364.5111111111109], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [363.4461111111109, 330.4416666666665, 361.66833333333324, 334.7266666666666, 303.3211111111111, 383.70777777777766, 367.8661111111107, 397.89555555555535, 394.24888888888853, 399.5549999999997, 372.8822222222222, 363.3994444444442, 374.39944444444393, 341.96999999999986, 354.3994444444445, 359.89111111111083, 389.2527777777776, 377.86555555555543, 406.1977777777777, 382.9544444444442, 374.0399999999998, 393.05666666666656, 359.8533333333333, 379.1438888888886, 410.8972222222219, 380.6277777777775, 391.047222222222, 370.70722222222213, 400.79499999999973, 401.5177777777773, 371.79444444444414, 417.84166666666647, 378.912222222222, 356.93, 372.10499999999985, 403.1099999999999, 379.8983333333333, 407.896111111111, 335.4561111111107, 401.7055555555552, 397.0805555555552, 402.8588888888887, 406.53944444444403, 384.6588888888886, 374.4288888888888, 376.2638888888889, 370.3099999999997, 362.9627777777776, 392.75388888888864, 363.40611111111104, 375.25555555555536, 344.2799999999998, 366.4705555555553, 396.7238888888889, 393.0499999999997, 406.71388888888856, 365.9783333333332, 381.4772222222221, 377.8977777777775, 369.19277777777774, 349.0966666666667, 409.41277777777736, 392.87555555555525, 387.70055555555535, 394.8572222222219, 400.22277777777776, 344.48666666666645, 416.832222222222, 382.73277777777764, 406.5344444444441, 403.8572222222219, 401.06611111111084, 388.376111111111, 380.4938888888885, 380.6044444444443, 398.28666666666646, 376.6955555555554, 408.1661111111108, 397.641111111111, 377.68499999999983, 339.5888888888887, 383.0244444444442, 346.76999999999987, 386.1911111111108, 378.6061111111107, 395.6494444444441, 360.78777777777765, 399.7555555555553, 359.2555555555555, 365.2227777777775, 386.92722222222187, 404.58777777777743, 377.0149999999998, 370.38055555555525, 412.6599999999998, 383.1277777777775, 354.7094444444444, 368.9938888888888, 365.2649999999996, 364.5111111111109]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19583809195042773, "mean_inference_ms": 1.7942309953958915, "mean_action_processing_ms": 0.07453643992557357, "mean_env_wait_ms": 1.2158546778948223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004677295684814453, "StateBufferConnector_ms": 0.002923727035522461, "ViewRequirementAgentConnector_ms": 0.06648087501525879}, "num_episodes": 30, "episode_return_max": 417.84166666666647, "episode_return_min": 303.3211111111111, "episode_return_mean": 379.56381666666647, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 249000, "num_agent_steps_trained": 248700, "num_env_steps_sampled": 249000, "num_env_steps_trained": 248700, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 285.1118051455756, "num_env_steps_trained_throughput_per_sec": 285.1118051455756, "timesteps_total": 249000, "num_env_steps_sampled_lifetime": 249000, "num_agent_steps_sampled_lifetime": 249000, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 249000, "timers": {"training_iteration_time_ms": 10318.234, "restore_workers_time_ms": 0.012, "training_step_time_ms": 536.829, "sample_time_ms": 521.564, "synch_weights_time_ms": 13.938}, "counters": {"num_env_steps_sampled": 249000, "num_env_steps_trained": 248700, "num_agent_steps_sampled": 249000, "num_agent_steps_trained": 248700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1660, "num_samples_added_to_queue": 249000}, "done": false, "training_iteration": 83, "trial_id": "0313d_00000", "date": "2024-10-10_21-55-41", "timestamp": 1728593741, "time_this_iter_s": 10.533694982528687, "time_total_s": 854.5763247013092, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c17d30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 854.5763247013092, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 12.440000000000001, "ram_util_percent": 64.42666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 230150.78125, "policy_loss": 229742.875, "entropy": 17.72162437438965, "entropy_coeff": 0.01, "var_gnorm": 16.578075408935547, "vf_loss": 461083.0625, "vf_explained_var": -0.31331419944763184}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 839.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 251700, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 251700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1680, "num_samples_added_to_queue": 252000, "learner_queue": {"size_count": 839, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.254, "learner_load_time_ms": 0.287, "learner_load_wait_time_ms": 974.298, "learner_dequeue_time_ms": 8407.484}}, "env_runners": {"episode_reward_max": 428.7938888888889, "episode_reward_min": 335.4561111111107, "episode_reward_mean": 383.31862222222196, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 335.4561111111107}, "policy_reward_max": {"default_policy": 428.7938888888889}, "policy_reward_mean": {"default_policy": 383.31862222222196}, "custom_metrics": {"num_consolidated_mean": 1.8684, "num_consolidated_min": 1.68, "num_consolidated_max": 2.01, "num_overloaded_mean": 0.08730000000000002, "num_overloaded_min": 0.02, "num_overloaded_max": 0.16, "num_moves_mean": 6.258299999999999, "num_moves_min": 5.62, "num_moves_max": 6.66, "mean_accuracy_mean": 39.342689999999976, "mean_accuracy_min": 39.11766666666665, "mean_accuracy_max": 39.54833333333332, "num_model_switches_mean": 2.6978000000000004, "num_model_switches_min": 2.36, "num_model_switches_max": 3.1, "num_slav_mean": 0.0055005, "num_slav_min": 0.0017499999999999998, "num_slav_max": 0.009966666666666667, "mean_cluster_cpu_util_mean": 0.4667270415014451, "mean_cluster_cpu_util_min": 0.4539852137091357, "mean_cluster_cpu_util_max": 0.48077401894730726, "mean_cluster_mem_util_mean": 0.29738659668941414, "mean_cluster_mem_util_min": 0.2915096086641407, "mean_cluster_mem_util_max": 0.30373887130801686, "reward_consolidation_mean_mean": 2.3475000000000006, "reward_consolidation_mean_min": 2.013888888888889, "reward_consolidation_mean_max": 2.6388888888888893, "reward_illegal_mean_mean": -0.14550000000000002, "reward_illegal_mean_min": -0.26666666666666666, "reward_illegal_mean_max": -0.03333333333333333, "reward_accuracy_mean_mean": 1.7958639999999997, "reward_accuracy_mean_min": 1.6514666666666664, "reward_accuracy_mean_max": 1.9264999999999999, "reward_sla_mean_mean": -0.1646777777777778, "reward_sla_mean_min": -0.3322222222222222, "reward_sla_mean_max": -0.029444444444444447, "reward_consolidation_sum_mean": 234.75, "reward_consolidation_sum_min": 201.38888888888889, "reward_consolidation_sum_max": 263.8888888888889, "reward_illegal_sum_mean": -14.549999999999995, "reward_illegal_sum_min": -26.666666666666664, "reward_illegal_sum_max": -3.333333333333333, "reward_accuracy_sum_mean": 179.58639999999997, "reward_accuracy_sum_min": 165.14666666666665, "reward_accuracy_sum_max": 192.64999999999998, "reward_sla_sum_mean": -16.46777777777778, "reward_sla_sum_min": -33.22222222222222, "reward_sla_sum_max": -2.9444444444444446, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4350.0, "global_timestep_min": 2100, "global_timestep_max": 6000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [371.79444444444414, 417.84166666666647, 378.912222222222, 356.93, 372.10499999999985, 403.1099999999999, 379.8983333333333, 407.896111111111, 335.4561111111107, 401.7055555555552, 397.0805555555552, 402.8588888888887, 406.53944444444403, 384.6588888888886, 374.4288888888888, 376.2638888888889, 370.3099999999997, 362.9627777777776, 392.75388888888864, 363.40611111111104, 375.25555555555536, 344.2799999999998, 366.4705555555553, 396.7238888888889, 393.0499999999997, 406.71388888888856, 365.9783333333332, 381.4772222222221, 377.8977777777775, 369.19277777777774, 349.0966666666667, 409.41277777777736, 392.87555555555525, 387.70055555555535, 394.8572222222219, 400.22277777777776, 344.48666666666645, 416.832222222222, 382.73277777777764, 406.5344444444441, 403.8572222222219, 401.06611111111084, 388.376111111111, 380.4938888888885, 380.6044444444443, 398.28666666666646, 376.6955555555554, 408.1661111111108, 397.641111111111, 377.68499999999983, 339.5888888888887, 383.0244444444442, 346.76999999999987, 386.1911111111108, 378.6061111111107, 395.6494444444441, 360.78777777777765, 399.7555555555553, 359.2555555555555, 365.2227777777775, 386.92722222222187, 404.58777777777743, 377.0149999999998, 370.38055555555525, 412.6599999999998, 383.1277777777775, 354.7094444444444, 368.9938888888888, 365.2649999999996, 364.5111111111109, 428.7938888888889, 392.9161111111109, 379.1844444444441, 397.77944444444415, 366.88944444444434, 389.6133333333331, 376.6516666666664, 400.03999999999974, 375.232222222222, 394.8194444444441, 373.40499999999986, 348.31333333333316, 415.29944444444436, 359.11444444444436, 372.2877777777776, 399.65166666666653, 419.9038888888886, 401.1338888888888, 406.89722222222196, 371.8188888888887, 390.1516666666666, 395.37333333333305, 389.35055555555545, 389.70611111111094, 366.04166666666646, 357.897222222222, 370.0344444444442, 380.3338888888887, 365.88388888888863, 422.73777777777747], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [371.79444444444414, 417.84166666666647, 378.912222222222, 356.93, 372.10499999999985, 403.1099999999999, 379.8983333333333, 407.896111111111, 335.4561111111107, 401.7055555555552, 397.0805555555552, 402.8588888888887, 406.53944444444403, 384.6588888888886, 374.4288888888888, 376.2638888888889, 370.3099999999997, 362.9627777777776, 392.75388888888864, 363.40611111111104, 375.25555555555536, 344.2799999999998, 366.4705555555553, 396.7238888888889, 393.0499999999997, 406.71388888888856, 365.9783333333332, 381.4772222222221, 377.8977777777775, 369.19277777777774, 349.0966666666667, 409.41277777777736, 392.87555555555525, 387.70055555555535, 394.8572222222219, 400.22277777777776, 344.48666666666645, 416.832222222222, 382.73277777777764, 406.5344444444441, 403.8572222222219, 401.06611111111084, 388.376111111111, 380.4938888888885, 380.6044444444443, 398.28666666666646, 376.6955555555554, 408.1661111111108, 397.641111111111, 377.68499999999983, 339.5888888888887, 383.0244444444442, 346.76999999999987, 386.1911111111108, 378.6061111111107, 395.6494444444441, 360.78777777777765, 399.7555555555553, 359.2555555555555, 365.2227777777775, 386.92722222222187, 404.58777777777743, 377.0149999999998, 370.38055555555525, 412.6599999999998, 383.1277777777775, 354.7094444444444, 368.9938888888888, 365.2649999999996, 364.5111111111109, 428.7938888888889, 392.9161111111109, 379.1844444444441, 397.77944444444415, 366.88944444444434, 389.6133333333331, 376.6516666666664, 400.03999999999974, 375.232222222222, 394.8194444444441, 373.40499999999986, 348.31333333333316, 415.29944444444436, 359.11444444444436, 372.2877777777776, 399.65166666666653, 419.9038888888886, 401.1338888888888, 406.89722222222196, 371.8188888888887, 390.1516666666666, 395.37333333333305, 389.35055555555545, 389.70611111111094, 366.04166666666646, 357.897222222222, 370.0344444444442, 380.3338888888887, 365.88388888888863, 422.73777777777747]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19584336581405967, "mean_inference_ms": 1.7940319707309025, "mean_action_processing_ms": 0.0745370184559787, "mean_env_wait_ms": 1.2158300470737347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004396200180053711, "StateBufferConnector_ms": 0.0028984546661376953, "ViewRequirementAgentConnector_ms": 0.06593585014343262}, "num_episodes": 30, "episode_return_max": 428.7938888888889, "episode_return_min": 335.4561111111107, "episode_return_mean": 383.31862222222196, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 251700, "num_env_steps_sampled": 252000, "num_env_steps_trained": 251700, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 293.2947976905559, "num_env_steps_trained_throughput_per_sec": 293.2947976905559, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 252000, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 10313.22, "restore_workers_time_ms": 0.011, "training_step_time_ms": 496.54, "sample_time_ms": 482.808, "synch_weights_time_ms": 12.377}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 251700, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 251700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1680, "num_samples_added_to_queue": 252000}, "done": false, "training_iteration": 84, "trial_id": "0313d_00000", "date": "2024-10-10_21-55-51", "timestamp": 1728593751, "time_this_iter_s": 10.23851728439331, "time_total_s": 864.8148419857025, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42db7f40>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 864.8148419857025, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 11.360000000000003, "ram_util_percent": 64.63333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 230197.03125, "policy_loss": 229763.015625, "entropy": 17.55939483642578, "entropy_coeff": 0.01, "var_gnorm": 16.582918167114258, "vf_loss": 486687.1875, "vf_explained_var": -0.2893413305282593}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 849.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 254850, "num_env_steps_trained": 254700, "num_agent_steps_sampled": 254850, "num_agent_steps_trained": 254700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1699, "num_samples_added_to_queue": 254700, "learner_queue": {"size_count": 849, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.907, "learner_load_time_ms": 0.289, "learner_load_wait_time_ms": 1000.789, "learner_dequeue_time_ms": 8322.889}}, "env_runners": {"episode_reward_max": 428.7938888888889, "episode_reward_min": 339.5888888888887, "episode_reward_mean": 387.3269611111108, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 339.5888888888887}, "policy_reward_max": {"default_policy": 428.7938888888889}, "policy_reward_mean": {"default_policy": 387.3269611111108}, "custom_metrics": {"num_consolidated_mean": 1.8837000000000002, "num_consolidated_min": 1.68, "num_consolidated_max": 2.01, "num_overloaded_mean": 0.0851, "num_overloaded_min": 0.02, "num_overloaded_max": 0.16, "num_moves_mean": 6.2437999999999985, "num_moves_min": 5.62, "num_moves_max": 6.68, "mean_accuracy_mean": 39.359599999999986, "mean_accuracy_min": 39.11766666666665, "mean_accuracy_max": 39.54833333333332, "num_model_switches_mean": 2.6639999999999997, "num_model_switches_min": 2.36, "num_model_switches_max": 3.1, "num_slav_mean": 0.005114500000000001, "num_slav_min": 0.0017499999999999998, "num_slav_max": 0.009966666666666667, "mean_cluster_cpu_util_mean": 0.467168218908702, "mean_cluster_cpu_util_min": 0.4539852137091357, "mean_cluster_cpu_util_max": 0.48077401894730726, "mean_cluster_mem_util_mean": 0.29722891898267745, "mean_cluster_mem_util_min": 0.2915096086641407, "mean_cluster_mem_util_max": 0.30373887130801686, "reward_consolidation_mean_mean": 2.369166666666667, "reward_consolidation_mean_min": 2.041666666666667, "reward_consolidation_mean_max": 2.6388888888888893, "reward_illegal_mean_mean": -0.14183333333333334, "reward_illegal_mean_min": -0.26666666666666666, "reward_illegal_mean_max": -0.03333333333333333, "reward_accuracy_mean_mean": 1.8009585, "reward_accuracy_mean_min": 1.6514666666666664, "reward_accuracy_mean_max": 1.9340999999999997, "reward_sla_mean_mean": -0.1550222222222222, "reward_sla_mean_min": -0.3322222222222222, "reward_sla_mean_max": -0.029444444444444447, "reward_consolidation_sum_mean": 236.91666666666669, "reward_consolidation_sum_min": 204.16666666666669, "reward_consolidation_sum_max": 263.8888888888889, "reward_illegal_sum_mean": -14.183333333333335, "reward_illegal_sum_min": -26.666666666666664, "reward_illegal_sum_max": -3.333333333333333, "reward_accuracy_sum_mean": 180.09584999999996, "reward_accuracy_sum_min": 165.14666666666665, "reward_accuracy_sum_max": 193.40999999999997, "reward_sla_sum_mean": -15.502222222222223, "reward_sla_sum_min": -33.22222222222222, "reward_sla_sum_max": -2.9444444444444446, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5257.0, "global_timestep_min": 3100, "global_timestep_max": 6900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [381.4772222222221, 377.8977777777775, 369.19277777777774, 349.0966666666667, 409.41277777777736, 392.87555555555525, 387.70055555555535, 394.8572222222219, 400.22277777777776, 344.48666666666645, 416.832222222222, 382.73277777777764, 406.5344444444441, 403.8572222222219, 401.06611111111084, 388.376111111111, 380.4938888888885, 380.6044444444443, 398.28666666666646, 376.6955555555554, 408.1661111111108, 397.641111111111, 377.68499999999983, 339.5888888888887, 383.0244444444442, 346.76999999999987, 386.1911111111108, 378.6061111111107, 395.6494444444441, 360.78777777777765, 399.7555555555553, 359.2555555555555, 365.2227777777775, 386.92722222222187, 404.58777777777743, 377.0149999999998, 370.38055555555525, 412.6599999999998, 383.1277777777775, 354.7094444444444, 368.9938888888888, 365.2649999999996, 364.5111111111109, 428.7938888888889, 392.9161111111109, 379.1844444444441, 397.77944444444415, 366.88944444444434, 389.6133333333331, 376.6516666666664, 400.03999999999974, 375.232222222222, 394.8194444444441, 373.40499999999986, 348.31333333333316, 415.29944444444436, 359.11444444444436, 372.2877777777776, 399.65166666666653, 419.9038888888886, 401.1338888888888, 406.89722222222196, 371.8188888888887, 390.1516666666666, 395.37333333333305, 389.35055555555545, 389.70611111111094, 366.04166666666646, 357.897222222222, 370.0344444444442, 380.3338888888887, 365.88388888888863, 422.73777777777747, 382.40555555555534, 404.4283333333331, 373.67444444444413, 419.2988888888886, 392.2466666666664, 383.1188888888887, 405.2144444444442, 403.52388888888856, 413.6027777777772, 341.09833333333313, 387.75611111111084, 391.0149999999996, 408.3155555555554, 416.9061111111106, 393.7138888888887, 388.738333333333, 406.9749999999999, 393.47444444444415, 418.0388888888887, 398.2694444444444, 381.9916666666663, 396.72999999999973, 407.37333333333294, 403.89499999999975, 383.38999999999976, 415.2216666666663, 395.8022222222221], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [381.4772222222221, 377.8977777777775, 369.19277777777774, 349.0966666666667, 409.41277777777736, 392.87555555555525, 387.70055555555535, 394.8572222222219, 400.22277777777776, 344.48666666666645, 416.832222222222, 382.73277777777764, 406.5344444444441, 403.8572222222219, 401.06611111111084, 388.376111111111, 380.4938888888885, 380.6044444444443, 398.28666666666646, 376.6955555555554, 408.1661111111108, 397.641111111111, 377.68499999999983, 339.5888888888887, 383.0244444444442, 346.76999999999987, 386.1911111111108, 378.6061111111107, 395.6494444444441, 360.78777777777765, 399.7555555555553, 359.2555555555555, 365.2227777777775, 386.92722222222187, 404.58777777777743, 377.0149999999998, 370.38055555555525, 412.6599999999998, 383.1277777777775, 354.7094444444444, 368.9938888888888, 365.2649999999996, 364.5111111111109, 428.7938888888889, 392.9161111111109, 379.1844444444441, 397.77944444444415, 366.88944444444434, 389.6133333333331, 376.6516666666664, 400.03999999999974, 375.232222222222, 394.8194444444441, 373.40499999999986, 348.31333333333316, 415.29944444444436, 359.11444444444436, 372.2877777777776, 399.65166666666653, 419.9038888888886, 401.1338888888888, 406.89722222222196, 371.8188888888887, 390.1516666666666, 395.37333333333305, 389.35055555555545, 389.70611111111094, 366.04166666666646, 357.897222222222, 370.0344444444442, 380.3338888888887, 365.88388888888863, 422.73777777777747, 382.40555555555534, 404.4283333333331, 373.67444444444413, 419.2988888888886, 392.2466666666664, 383.1188888888887, 405.2144444444442, 403.52388888888856, 413.6027777777772, 341.09833333333313, 387.75611111111084, 391.0149999999996, 408.3155555555554, 416.9061111111106, 393.7138888888887, 388.738333333333, 406.9749999999999, 393.47444444444415, 418.0388888888887, 398.2694444444444, 381.9916666666663, 396.72999999999973, 407.37333333333294, 403.89499999999975, 383.38999999999976, 415.2216666666663, 395.8022222222221]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1958386208823981, "mean_inference_ms": 1.7928344447358477, "mean_action_processing_ms": 0.07452996529610378, "mean_env_wait_ms": 1.2157149137489207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004367351531982422, "StateBufferConnector_ms": 0.0029397010803222656, "ViewRequirementAgentConnector_ms": 0.06741046905517578}, "num_episodes": 27, "episode_return_max": 428.7938888888889, "episode_return_min": 339.5888888888887, "episode_return_mean": 387.3269611111108, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 254850, "num_agent_steps_trained": 254700, "num_env_steps_sampled": 254850, "num_env_steps_trained": 254700, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 284.17085577654996, "num_env_steps_trained_throughput_per_sec": 299.1272166068947, "timesteps_total": 254850, "num_env_steps_sampled_lifetime": 254850, "num_agent_steps_sampled_lifetime": 254850, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 254850, "timers": {"training_iteration_time_ms": 10276.844, "restore_workers_time_ms": 0.012, "training_step_time_ms": 506.658, "sample_time_ms": 491.812, "synch_weights_time_ms": 13.531}, "counters": {"num_env_steps_sampled": 254850, "num_env_steps_trained": 254700, "num_agent_steps_sampled": 254850, "num_agent_steps_trained": 254700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1699, "num_samples_added_to_queue": 254700}, "done": false, "training_iteration": 85, "trial_id": "0313d_00000", "date": "2024-10-10_21-56-01", "timestamp": 1728593761, "time_this_iter_s": 10.04067325592041, "time_total_s": 874.8555152416229, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42db62f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 874.8555152416229, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 12.871428571428572, "ram_util_percent": 64.96428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 222618.5625, "policy_loss": 222174.484375, "entropy": 17.11109161376953, "entropy_coeff": 0.01, "var_gnorm": 16.5926513671875, "vf_loss": 495413.375, "vf_explained_var": -0.26405882835388184}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 858.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 257700, "num_env_steps_trained": 257400, "num_agent_steps_sampled": 257700, "num_agent_steps_trained": 257400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1718, "num_samples_added_to_queue": 257700, "learner_queue": {"size_count": 858, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.415, "learner_load_time_ms": 0.319, "learner_load_wait_time_ms": 1023.374, "learner_dequeue_time_ms": 8346.978}}, "env_runners": {"episode_reward_max": 428.7938888888889, "episode_reward_min": 336.50888888888886, "episode_reward_mean": 389.00059444444423, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 336.50888888888886}, "policy_reward_max": {"default_policy": 428.7938888888889}, "policy_reward_mean": {"default_policy": 389.00059444444423}, "custom_metrics": {"num_consolidated_mean": 1.8905999999999998, "num_consolidated_min": 1.73, "num_consolidated_max": 2.01, "num_overloaded_mean": 0.08410000000000002, "num_overloaded_min": 0.02, "num_overloaded_max": 0.16, "num_moves_mean": 6.2071000000000005, "num_moves_min": 5.62, "num_moves_max": 6.68, "mean_accuracy_mean": 39.37004999999998, "mean_accuracy_min": 39.19999999999998, "mean_accuracy_max": 39.54199999999999, "num_model_switches_mean": 2.6344, "num_model_switches_min": 2.18, "num_model_switches_max": 3.1, "num_slav_mean": 0.005026833333333334, "num_slav_min": 0.0009833333333333332, "num_slav_max": 0.010733333333333333, "mean_cluster_cpu_util_mean": 0.46644655409168295, "mean_cluster_cpu_util_min": 0.45499386363966543, "mean_cluster_cpu_util_max": 0.48077401894730726, "mean_cluster_mem_util_mean": 0.2966880001237837, "mean_cluster_mem_util_min": 0.28988747847240165, "mean_cluster_mem_util_max": 0.30373887130801686, "reward_consolidation_mean_mean": 2.382361111111111, "reward_consolidation_mean_min": 2.194444444444444, "reward_consolidation_mean_max": 2.6388888888888893, "reward_illegal_mean_mean": -0.14016666666666666, "reward_illegal_mean_min": -0.26666666666666666, "reward_illegal_mean_max": -0.03333333333333333, "reward_accuracy_mean_mean": 1.803494833333333, "reward_accuracy_mean_min": 1.6514666666666664, "reward_accuracy_mean_max": 1.9340999999999997, "reward_sla_mean_mean": -0.15568333333333334, "reward_sla_mean_min": -0.3322222222222222, "reward_sla_mean_max": -0.029444444444444447, "reward_consolidation_sum_mean": 238.23611111111114, "reward_consolidation_sum_min": 219.44444444444443, "reward_consolidation_sum_max": 263.8888888888889, "reward_illegal_sum_mean": -14.016666666666662, "reward_illegal_sum_min": -26.666666666666664, "reward_illegal_sum_max": -3.333333333333333, "reward_accuracy_sum_mean": 180.34948333333332, "reward_accuracy_sum_min": 165.14666666666665, "reward_accuracy_sum_max": 193.40999999999997, "reward_sla_sum_mean": -15.568333333333333, "reward_sla_sum_min": -33.22222222222222, "reward_sla_sum_max": -2.9444444444444446, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6023.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [399.7555555555553, 359.2555555555555, 365.2227777777775, 386.92722222222187, 404.58777777777743, 377.0149999999998, 370.38055555555525, 412.6599999999998, 383.1277777777775, 354.7094444444444, 368.9938888888888, 365.2649999999996, 364.5111111111109, 428.7938888888889, 392.9161111111109, 379.1844444444441, 397.77944444444415, 366.88944444444434, 389.6133333333331, 376.6516666666664, 400.03999999999974, 375.232222222222, 394.8194444444441, 373.40499999999986, 348.31333333333316, 415.29944444444436, 359.11444444444436, 372.2877777777776, 399.65166666666653, 419.9038888888886, 401.1338888888888, 406.89722222222196, 371.8188888888887, 390.1516666666666, 395.37333333333305, 389.35055555555545, 389.70611111111094, 366.04166666666646, 357.897222222222, 370.0344444444442, 380.3338888888887, 365.88388888888863, 422.73777777777747, 382.40555555555534, 404.4283333333331, 373.67444444444413, 419.2988888888886, 392.2466666666664, 383.1188888888887, 405.2144444444442, 403.52388888888856, 413.6027777777772, 341.09833333333313, 387.75611111111084, 391.0149999999996, 408.3155555555554, 416.9061111111106, 393.7138888888887, 388.738333333333, 406.9749999999999, 393.47444444444415, 418.0388888888887, 398.2694444444444, 381.9916666666663, 396.72999999999973, 407.37333333333294, 403.89499999999975, 383.38999999999976, 415.2216666666663, 395.8022222222221, 391.383333333333, 413.2944444444441, 376.0949999999999, 379.6744444444443, 387.208333333333, 397.33222222222184, 391.7933333333332, 400.18277777777746, 428.2783333333329, 387.0411111111108, 377.3261111111108, 406.0388888888886, 365.7088888888886, 387.6122222222218, 389.3277777777775, 387.4838888888888, 372.94666666666643, 401.5233333333331, 405.2061111111108, 393.00055555555525, 402.3961111111108, 375.8827777777777, 379.76499999999993, 383.57444444444417, 405.44555555555525, 416.94388888888886, 336.50888888888886, 353.50833333333316, 398.3477777777774, 393.3422222222221], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [399.7555555555553, 359.2555555555555, 365.2227777777775, 386.92722222222187, 404.58777777777743, 377.0149999999998, 370.38055555555525, 412.6599999999998, 383.1277777777775, 354.7094444444444, 368.9938888888888, 365.2649999999996, 364.5111111111109, 428.7938888888889, 392.9161111111109, 379.1844444444441, 397.77944444444415, 366.88944444444434, 389.6133333333331, 376.6516666666664, 400.03999999999974, 375.232222222222, 394.8194444444441, 373.40499999999986, 348.31333333333316, 415.29944444444436, 359.11444444444436, 372.2877777777776, 399.65166666666653, 419.9038888888886, 401.1338888888888, 406.89722222222196, 371.8188888888887, 390.1516666666666, 395.37333333333305, 389.35055555555545, 389.70611111111094, 366.04166666666646, 357.897222222222, 370.0344444444442, 380.3338888888887, 365.88388888888863, 422.73777777777747, 382.40555555555534, 404.4283333333331, 373.67444444444413, 419.2988888888886, 392.2466666666664, 383.1188888888887, 405.2144444444442, 403.52388888888856, 413.6027777777772, 341.09833333333313, 387.75611111111084, 391.0149999999996, 408.3155555555554, 416.9061111111106, 393.7138888888887, 388.738333333333, 406.9749999999999, 393.47444444444415, 418.0388888888887, 398.2694444444444, 381.9916666666663, 396.72999999999973, 407.37333333333294, 403.89499999999975, 383.38999999999976, 415.2216666666663, 395.8022222222221, 391.383333333333, 413.2944444444441, 376.0949999999999, 379.6744444444443, 387.208333333333, 397.33222222222184, 391.7933333333332, 400.18277777777746, 428.2783333333329, 387.0411111111108, 377.3261111111108, 406.0388888888886, 365.7088888888886, 387.6122222222218, 389.3277777777775, 387.4838888888888, 372.94666666666643, 401.5233333333331, 405.2061111111108, 393.00055555555525, 402.3961111111108, 375.8827777777777, 379.76499999999993, 383.57444444444417, 405.44555555555525, 416.94388888888886, 336.50888888888886, 353.50833333333316, 398.3477777777774, 393.3422222222221]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19592195868202864, "mean_inference_ms": 1.7932813115202055, "mean_action_processing_ms": 0.07455184267419548, "mean_env_wait_ms": 1.215976241356711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004510402679443359, "StateBufferConnector_ms": 0.002977132797241211, "ViewRequirementAgentConnector_ms": 0.06806254386901855}, "num_episodes": 30, "episode_return_max": 428.7938888888889, "episode_return_min": 336.50888888888886, "episode_return_mean": 389.00059444444423, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 257700, "num_agent_steps_trained": 257400, "num_env_steps_sampled": 257700, "num_env_steps_trained": 257400, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 275.8357549427634, "num_env_steps_trained_throughput_per_sec": 261.3180836299864, "timesteps_total": 257700, "num_env_steps_sampled_lifetime": 257700, "num_agent_steps_sampled_lifetime": 257700, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 257700, "timers": {"training_iteration_time_ms": 10271.396, "restore_workers_time_ms": 0.013, "training_step_time_ms": 567.956, "sample_time_ms": 550.931, "synch_weights_time_ms": 15.53}, "counters": {"num_env_steps_sampled": 257700, "num_env_steps_trained": 257400, "num_agent_steps_sampled": 257700, "num_agent_steps_trained": 257400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1718, "num_samples_added_to_queue": 257700}, "done": false, "training_iteration": 86, "trial_id": "0313d_00000", "date": "2024-10-10_21-56-12", "timestamp": 1728593772, "time_this_iter_s": 10.346714973449707, "time_total_s": 885.2022302150726, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d89990>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 885.2022302150726, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 13.806666666666667, "ram_util_percent": 64.99333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 212804.296875, "policy_loss": 212349.828125, "entropy": 16.30261993408203, "entropy_coeff": 0.01, "var_gnorm": 16.599130630493164, "vf_loss": 503382.5625, "vf_explained_var": -0.2774306535720825}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 868.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 260700, "num_env_steps_trained": 260400, "num_agent_steps_sampled": 260700, "num_agent_steps_trained": 260400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1738, "num_samples_added_to_queue": 260700, "learner_queue": {"size_count": 868, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.388, "learner_load_time_ms": 0.317, "learner_load_wait_time_ms": 978.271, "learner_dequeue_time_ms": 8366.014}}, "env_runners": {"episode_reward_max": 441.0005555555554, "episode_reward_min": 336.50888888888886, "episode_reward_mean": 397.4200277777775, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 336.50888888888886}, "policy_reward_max": {"default_policy": 441.0005555555554}, "policy_reward_mean": {"default_policy": 397.4200277777775}, "custom_metrics": {"num_consolidated_mean": 1.8984999999999999, "num_consolidated_min": 1.74, "num_consolidated_max": 2.06, "num_overloaded_mean": 0.0751, "num_overloaded_min": 0.02, "num_overloaded_max": 0.14, "num_moves_mean": 6.0473, "num_moves_min": 5.32, "num_moves_max": 6.68, "mean_accuracy_mean": 39.366756666666646, "mean_accuracy_min": 39.20633333333331, "mean_accuracy_max": 39.54199999999999, "num_model_switches_mean": 2.5197, "num_model_switches_min": 1.98, "num_model_switches_max": 3.01, "num_slav_mean": 0.004375833333333332, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.010733333333333333, "mean_cluster_cpu_util_mean": 0.46418112790045646, "mean_cluster_cpu_util_min": 0.45185125710065566, "mean_cluster_cpu_util_max": 0.48077401894730726, "mean_cluster_mem_util_mean": 0.29518047137547, "mean_cluster_mem_util_min": 0.28931889638766894, "mean_cluster_mem_util_max": 0.30373887130801686, "reward_consolidation_mean_mean": 2.415277777777778, "reward_consolidation_mean_min": 2.194444444444444, "reward_consolidation_mean_max": 2.666666666666667, "reward_illegal_mean_mean": -0.12516666666666668, "reward_illegal_mean_min": -0.2333333333333333, "reward_illegal_mean_max": -0.03333333333333333, "reward_accuracy_mean_mean": 1.8206224999999998, "reward_accuracy_mean_min": 1.6925666666666666, "reward_accuracy_mean_max": 1.9340999999999997, "reward_sla_mean_mean": -0.1365333333333333, "reward_sla_mean_min": -0.33055555555555555, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 241.52777777777777, "reward_consolidation_sum_min": 219.44444444444443, "reward_consolidation_sum_max": 266.6666666666667, "reward_illegal_sum_mean": -12.516666666666666, "reward_illegal_sum_min": -23.333333333333332, "reward_illegal_sum_max": -3.333333333333333, "reward_accuracy_sum_mean": 182.06224999999998, "reward_accuracy_sum_min": 169.25666666666666, "reward_accuracy_sum_max": 193.40999999999997, "reward_sla_sum_mean": -13.653333333333332, "reward_sla_sum_min": -33.05555555555556, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4683.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [401.1338888888888, 406.89722222222196, 371.8188888888887, 390.1516666666666, 395.37333333333305, 389.35055555555545, 389.70611111111094, 366.04166666666646, 357.897222222222, 370.0344444444442, 380.3338888888887, 365.88388888888863, 422.73777777777747, 382.40555555555534, 404.4283333333331, 373.67444444444413, 419.2988888888886, 392.2466666666664, 383.1188888888887, 405.2144444444442, 403.52388888888856, 413.6027777777772, 341.09833333333313, 387.75611111111084, 391.0149999999996, 408.3155555555554, 416.9061111111106, 393.7138888888887, 388.738333333333, 406.9749999999999, 393.47444444444415, 418.0388888888887, 398.2694444444444, 381.9916666666663, 396.72999999999973, 407.37333333333294, 403.89499999999975, 383.38999999999976, 415.2216666666663, 395.8022222222221, 391.383333333333, 413.2944444444441, 376.0949999999999, 379.6744444444443, 387.208333333333, 397.33222222222184, 391.7933333333332, 400.18277777777746, 428.2783333333329, 387.0411111111108, 377.3261111111108, 406.0388888888886, 365.7088888888886, 387.6122222222218, 389.3277777777775, 387.4838888888888, 372.94666666666643, 401.5233333333331, 405.2061111111108, 393.00055555555525, 402.3961111111108, 375.8827777777777, 379.76499999999993, 383.57444444444417, 405.44555555555525, 416.94388888888886, 336.50888888888886, 353.50833333333316, 398.3477777777774, 393.3422222222221, 413.4605555555553, 428.54777777777747, 388.6683333333331, 441.0005555555554, 413.35777777777764, 423.5794444444441, 422.0872222222219, 375.97833333333307, 392.4527777777775, 413.7944444444442, 425.6588888888887, 398.8327777777774, 438.5783333333331, 391.4066666666663, 397.73166666666634, 402.79388888888855, 416.0711111111107, 384.20722222222196, 394.32666666666665, 424.79444444444385, 427.6111111111107, 391.17499999999967, 420.83222222222184, 409.96055555555506, 420.3422222222219, 433.2299999999997, 409.6194444444443, 408.60333333333324, 432.94333333333304, 402.6044444444439], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [401.1338888888888, 406.89722222222196, 371.8188888888887, 390.1516666666666, 395.37333333333305, 389.35055555555545, 389.70611111111094, 366.04166666666646, 357.897222222222, 370.0344444444442, 380.3338888888887, 365.88388888888863, 422.73777777777747, 382.40555555555534, 404.4283333333331, 373.67444444444413, 419.2988888888886, 392.2466666666664, 383.1188888888887, 405.2144444444442, 403.52388888888856, 413.6027777777772, 341.09833333333313, 387.75611111111084, 391.0149999999996, 408.3155555555554, 416.9061111111106, 393.7138888888887, 388.738333333333, 406.9749999999999, 393.47444444444415, 418.0388888888887, 398.2694444444444, 381.9916666666663, 396.72999999999973, 407.37333333333294, 403.89499999999975, 383.38999999999976, 415.2216666666663, 395.8022222222221, 391.383333333333, 413.2944444444441, 376.0949999999999, 379.6744444444443, 387.208333333333, 397.33222222222184, 391.7933333333332, 400.18277777777746, 428.2783333333329, 387.0411111111108, 377.3261111111108, 406.0388888888886, 365.7088888888886, 387.6122222222218, 389.3277777777775, 387.4838888888888, 372.94666666666643, 401.5233333333331, 405.2061111111108, 393.00055555555525, 402.3961111111108, 375.8827777777777, 379.76499999999993, 383.57444444444417, 405.44555555555525, 416.94388888888886, 336.50888888888886, 353.50833333333316, 398.3477777777774, 393.3422222222221, 413.4605555555553, 428.54777777777747, 388.6683333333331, 441.0005555555554, 413.35777777777764, 423.5794444444441, 422.0872222222219, 375.97833333333307, 392.4527777777775, 413.7944444444442, 425.6588888888887, 398.8327777777774, 438.5783333333331, 391.4066666666663, 397.73166666666634, 402.79388888888855, 416.0711111111107, 384.20722222222196, 394.32666666666665, 424.79444444444385, 427.6111111111107, 391.17499999999967, 420.83222222222184, 409.96055555555506, 420.3422222222219, 433.2299999999997, 409.6194444444443, 408.60333333333324, 432.94333333333304, 402.6044444444439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1959993862275227, "mean_inference_ms": 1.7936521153835157, "mean_action_processing_ms": 0.07457233055203144, "mean_env_wait_ms": 1.2162361504237689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004407644271850586, "StateBufferConnector_ms": 0.002974987030029297, "ViewRequirementAgentConnector_ms": 0.06760764122009277}, "num_episodes": 30, "episode_return_max": 441.0005555555554, "episode_return_min": 336.50888888888886, "episode_return_mean": 397.4200277777775, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260700, "num_agent_steps_trained": 260400, "num_env_steps_sampled": 260700, "num_env_steps_trained": 260400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 290.3512085829553, "num_env_steps_trained_throughput_per_sec": 290.3512085829553, "timesteps_total": 260700, "num_env_steps_sampled_lifetime": 260700, "num_agent_steps_sampled_lifetime": 260700, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 260700, "timers": {"training_iteration_time_ms": 10258.033, "restore_workers_time_ms": 0.01, "training_step_time_ms": 508.541, "sample_time_ms": 494.77, "synch_weights_time_ms": 12.22}, "counters": {"num_env_steps_sampled": 260700, "num_env_steps_trained": 260400, "num_agent_steps_sampled": 260700, "num_agent_steps_trained": 260400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1738, "num_samples_added_to_queue": 260700}, "done": false, "training_iteration": 87, "trial_id": "0313d_00000", "date": "2024-10-10_21-56-22", "timestamp": 1728593782, "time_this_iter_s": 10.34923505783081, "time_total_s": 895.5514652729034, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42db5db0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 895.5514652729034, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 10.959999999999999, "ram_util_percent": 65.11333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 212188.765625, "policy_loss": 211722.375, "entropy": 16.179733276367188, "entropy_coeff": 0.01, "var_gnorm": 16.599021911621094, "vf_loss": 514938.5625, "vf_explained_var": -0.26711976528167725}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 878.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 263550, "num_env_steps_trained": 263400, "num_agent_steps_sampled": 263550, "num_agent_steps_trained": 263400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1757, "num_samples_added_to_queue": 263400, "learner_queue": {"size_count": 878, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.139, "learner_load_time_ms": 0.322, "learner_load_wait_time_ms": 1032.574, "learner_dequeue_time_ms": 8375.799}}, "env_runners": {"episode_reward_max": 441.0005555555554, "episode_reward_min": 336.50888888888886, "episode_reward_mean": 403.05986666666644, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 336.50888888888886}, "policy_reward_max": {"default_policy": 441.0005555555554}, "policy_reward_mean": {"default_policy": 403.05986666666644}, "custom_metrics": {"num_consolidated_mean": 1.8988000000000003, "num_consolidated_min": 1.74, "num_consolidated_max": 2.06, "num_overloaded_mean": 0.0693, "num_overloaded_min": 0.02, "num_overloaded_max": 0.13, "num_moves_mean": 5.9064, "num_moves_min": 5.29, "num_moves_max": 6.49, "mean_accuracy_mean": 39.34281666666665, "mean_accuracy_min": 39.11766666666664, "mean_accuracy_max": 39.52933333333331, "num_model_switches_mean": 2.4224000000000006, "num_model_switches_min": 1.98, "num_model_switches_max": 3.01, "num_slav_mean": 0.0038653333333333335, "num_slav_min": 0.00018333333333333334, "num_slav_max": 0.010733333333333333, "mean_cluster_cpu_util_mean": 0.46123626638449816, "mean_cluster_cpu_util_min": 0.4500767019038045, "mean_cluster_cpu_util_max": 0.474963838389648, "mean_cluster_mem_util_mean": 0.29344036133715085, "mean_cluster_mem_util_min": 0.28788710281580987, "mean_cluster_mem_util_max": 0.3013203486035765, "reward_consolidation_mean_mean": 2.435416666666667, "reward_consolidation_mean_min": 2.194444444444444, "reward_consolidation_mean_max": 2.666666666666667, "reward_illegal_mean_mean": -0.1155, "reward_illegal_mean_min": -0.21666666666666667, "reward_illegal_mean_max": -0.03333333333333333, "reward_accuracy_mean_mean": 1.8309486666666663, "reward_accuracy_mean_min": 1.7115333333333327, "reward_accuracy_mean_max": 1.9274499999999997, "reward_sla_mean_mean": -0.12026666666666666, "reward_sla_mean_min": -0.33055555555555555, "reward_sla_mean_max": -0.006111111111111111, "reward_consolidation_sum_mean": 243.54166666666669, "reward_consolidation_sum_min": 219.44444444444443, "reward_consolidation_sum_max": 266.6666666666667, "reward_illegal_sum_mean": -11.549999999999997, "reward_illegal_sum_min": -21.666666666666668, "reward_illegal_sum_max": -3.333333333333333, "reward_accuracy_sum_mean": 183.0948666666666, "reward_accuracy_sum_min": 171.15333333333328, "reward_accuracy_sum_max": 192.74499999999998, "reward_sla_sum_mean": -12.026666666666667, "reward_sla_sum_min": -33.05555555555556, "reward_sla_sum_max": -0.6111111111111112, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3483.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [393.7138888888887, 388.738333333333, 406.9749999999999, 393.47444444444415, 418.0388888888887, 398.2694444444444, 381.9916666666663, 396.72999999999973, 407.37333333333294, 403.89499999999975, 383.38999999999976, 415.2216666666663, 395.8022222222221, 391.383333333333, 413.2944444444441, 376.0949999999999, 379.6744444444443, 387.208333333333, 397.33222222222184, 391.7933333333332, 400.18277777777746, 428.2783333333329, 387.0411111111108, 377.3261111111108, 406.0388888888886, 365.7088888888886, 387.6122222222218, 389.3277777777775, 387.4838888888888, 372.94666666666643, 401.5233333333331, 405.2061111111108, 393.00055555555525, 402.3961111111108, 375.8827777777777, 379.76499999999993, 383.57444444444417, 405.44555555555525, 416.94388888888886, 336.50888888888886, 353.50833333333316, 398.3477777777774, 393.3422222222221, 413.4605555555553, 428.54777777777747, 388.6683333333331, 441.0005555555554, 413.35777777777764, 423.5794444444441, 422.0872222222219, 375.97833333333307, 392.4527777777775, 413.7944444444442, 425.6588888888887, 398.8327777777774, 438.5783333333331, 391.4066666666663, 397.73166666666634, 402.79388888888855, 416.0711111111107, 384.20722222222196, 394.32666666666665, 424.79444444444385, 427.6111111111107, 391.17499999999967, 420.83222222222184, 409.96055555555506, 420.3422222222219, 433.2299999999997, 409.6194444444443, 408.60333333333324, 432.94333333333304, 402.6044444444439, 413.03277777777754, 392.4699999999998, 386.46055555555523, 410.87444444444395, 414.9033333333331, 398.1272222222218, 422.02499999999964, 429.04222222222165, 411.065555555555, 403.4211111111109, 400.47055555555534, 412.079444444444, 397.7472222222219, 415.26888888888857, 434.9061111111108, 433.7688888888885, 401.9077777777775, 426.6266666666664, 421.71444444444404, 379.69222222222214, 392.8355555555554, 428.32555555555524, 401.8116666666665, 424.4055555555552, 396.66611111111087, 423.1977777777772, 421.10277777777753], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [393.7138888888887, 388.738333333333, 406.9749999999999, 393.47444444444415, 418.0388888888887, 398.2694444444444, 381.9916666666663, 396.72999999999973, 407.37333333333294, 403.89499999999975, 383.38999999999976, 415.2216666666663, 395.8022222222221, 391.383333333333, 413.2944444444441, 376.0949999999999, 379.6744444444443, 387.208333333333, 397.33222222222184, 391.7933333333332, 400.18277777777746, 428.2783333333329, 387.0411111111108, 377.3261111111108, 406.0388888888886, 365.7088888888886, 387.6122222222218, 389.3277777777775, 387.4838888888888, 372.94666666666643, 401.5233333333331, 405.2061111111108, 393.00055555555525, 402.3961111111108, 375.8827777777777, 379.76499999999993, 383.57444444444417, 405.44555555555525, 416.94388888888886, 336.50888888888886, 353.50833333333316, 398.3477777777774, 393.3422222222221, 413.4605555555553, 428.54777777777747, 388.6683333333331, 441.0005555555554, 413.35777777777764, 423.5794444444441, 422.0872222222219, 375.97833333333307, 392.4527777777775, 413.7944444444442, 425.6588888888887, 398.8327777777774, 438.5783333333331, 391.4066666666663, 397.73166666666634, 402.79388888888855, 416.0711111111107, 384.20722222222196, 394.32666666666665, 424.79444444444385, 427.6111111111107, 391.17499999999967, 420.83222222222184, 409.96055555555506, 420.3422222222219, 433.2299999999997, 409.6194444444443, 408.60333333333324, 432.94333333333304, 402.6044444444439, 413.03277777777754, 392.4699999999998, 386.46055555555523, 410.87444444444395, 414.9033333333331, 398.1272222222218, 422.02499999999964, 429.04222222222165, 411.065555555555, 403.4211111111109, 400.47055555555534, 412.079444444444, 397.7472222222219, 415.26888888888857, 434.9061111111108, 433.7688888888885, 401.9077777777775, 426.6266666666664, 421.71444444444404, 379.69222222222214, 392.8355555555554, 428.32555555555524, 401.8116666666665, 424.4055555555552, 396.66611111111087, 423.1977777777772, 421.10277777777753]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1961209197174098, "mean_inference_ms": 1.7945163706979579, "mean_action_processing_ms": 0.07461257776388185, "mean_env_wait_ms": 1.2167353608017595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046231746673583984, "StateBufferConnector_ms": 0.0030248165130615234, "ViewRequirementAgentConnector_ms": 0.06981611251831055}, "num_episodes": 27, "episode_return_max": 441.0005555555554, "episode_return_min": 336.50888888888886, "episode_return_mean": 403.05986666666644, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 263550, "num_agent_steps_trained": 263400, "num_env_steps_sampled": 263550, "num_env_steps_trained": 263400, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 269.52187161773486, "num_env_steps_trained_throughput_per_sec": 283.7072332818262, "timesteps_total": 263550, "num_env_steps_sampled_lifetime": 263550, "num_agent_steps_sampled_lifetime": 263550, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 263550, "timers": {"training_iteration_time_ms": 10262.933, "restore_workers_time_ms": 0.013, "training_step_time_ms": 580.028, "sample_time_ms": 564.738, "synch_weights_time_ms": 13.866}, "counters": {"num_env_steps_sampled": 263550, "num_env_steps_trained": 263400, "num_agent_steps_sampled": 263550, "num_agent_steps_trained": 263400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1757, "num_samples_added_to_queue": 263400}, "done": false, "training_iteration": 88, "trial_id": "0313d_00000", "date": "2024-10-10_21-56-33", "timestamp": 1728593793, "time_this_iter_s": 10.584823846817017, "time_total_s": 906.1362891197205, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d88e50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 906.1362891197205, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 14.799999999999999, "ram_util_percent": 65.58000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 203794.6875, "policy_loss": 203363.015625, "entropy": 16.3698787689209, "entropy_coeff": 0.01, "var_gnorm": 16.607210159301758, "vf_loss": 480774.71875, "vf_explained_var": -0.2510666847229004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 887.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 266400, "num_env_steps_trained": 266100, "num_agent_steps_sampled": 266400, "num_agent_steps_trained": 266100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1776, "num_samples_added_to_queue": 266400, "learner_queue": {"size_count": 887, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.423, "learner_load_time_ms": 0.323, "learner_load_wait_time_ms": 1038.059, "learner_dequeue_time_ms": 8428.512}}, "env_runners": {"episode_reward_max": 441.0005555555554, "episode_reward_min": 336.50888888888886, "episode_reward_mean": 406.86031111111083, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 336.50888888888886}, "policy_reward_max": {"default_policy": 441.0005555555554}, "policy_reward_mean": {"default_policy": 406.86031111111083}, "custom_metrics": {"num_consolidated_mean": 1.9064999999999999, "num_consolidated_min": 1.77, "num_consolidated_max": 2.06, "num_overloaded_mean": 0.0669, "num_overloaded_min": 0.02, "num_overloaded_max": 0.13, "num_moves_mean": 5.7787000000000015, "num_moves_min": 5.29, "num_moves_max": 6.39, "mean_accuracy_mean": 39.31311333333332, "mean_accuracy_min": 39.11766666666664, "mean_accuracy_max": 39.516666666666644, "num_model_switches_mean": 2.3503, "num_model_switches_min": 1.98, "num_model_switches_max": 2.82, "num_slav_mean": 0.003506333333333333, "num_slav_min": 0.00018333333333333334, "num_slav_max": 0.010733333333333333, "mean_cluster_cpu_util_mean": 0.4599975536080154, "mean_cluster_cpu_util_min": 0.4495249844870381, "mean_cluster_cpu_util_max": 0.474963838389648, "mean_cluster_mem_util_mean": 0.29278418629086655, "mean_cluster_mem_util_min": 0.28788710281580987, "mean_cluster_mem_util_max": 0.3013203486035765, "reward_consolidation_mean_mean": 2.4523611111111117, "reward_consolidation_mean_min": 2.1944444444444446, "reward_consolidation_mean_max": 2.666666666666667, "reward_illegal_mean_mean": -0.11149999999999999, "reward_illegal_mean_min": -0.21666666666666667, "reward_illegal_mean_max": -0.03333333333333333, "reward_accuracy_mean_mean": 1.8343919999999998, "reward_accuracy_mean_min": 1.7178666666666667, "reward_accuracy_mean_max": 1.9274499999999997, "reward_sla_mean_mean": -0.10665, "reward_sla_mean_min": -0.33055555555555555, "reward_sla_mean_max": -0.006111111111111111, "reward_consolidation_sum_mean": 245.23611111111114, "reward_consolidation_sum_min": 219.44444444444446, "reward_consolidation_sum_max": 266.6666666666667, "reward_illegal_sum_mean": -11.15, "reward_illegal_sum_min": -21.666666666666668, "reward_illegal_sum_max": -3.333333333333333, "reward_accuracy_sum_mean": 183.43919999999997, "reward_accuracy_sum_min": 171.78666666666666, "reward_accuracy_sum_max": 192.74499999999998, "reward_sla_sum_mean": -10.664999999999997, "reward_sla_sum_min": -33.05555555555556, "reward_sla_sum_max": -0.6111111111111112, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2215.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [401.5233333333331, 405.2061111111108, 393.00055555555525, 402.3961111111108, 375.8827777777777, 379.76499999999993, 383.57444444444417, 405.44555555555525, 416.94388888888886, 336.50888888888886, 353.50833333333316, 398.3477777777774, 393.3422222222221, 413.4605555555553, 428.54777777777747, 388.6683333333331, 441.0005555555554, 413.35777777777764, 423.5794444444441, 422.0872222222219, 375.97833333333307, 392.4527777777775, 413.7944444444442, 425.6588888888887, 398.8327777777774, 438.5783333333331, 391.4066666666663, 397.73166666666634, 402.79388888888855, 416.0711111111107, 384.20722222222196, 394.32666666666665, 424.79444444444385, 427.6111111111107, 391.17499999999967, 420.83222222222184, 409.96055555555506, 420.3422222222219, 433.2299999999997, 409.6194444444443, 408.60333333333324, 432.94333333333304, 402.6044444444439, 413.03277777777754, 392.4699999999998, 386.46055555555523, 410.87444444444395, 414.9033333333331, 398.1272222222218, 422.02499999999964, 429.04222222222165, 411.065555555555, 403.4211111111109, 400.47055555555534, 412.079444444444, 397.7472222222219, 415.26888888888857, 434.9061111111108, 433.7688888888885, 401.9077777777775, 426.6266666666664, 421.71444444444404, 379.69222222222214, 392.8355555555554, 428.32555555555524, 401.8116666666665, 424.4055555555552, 396.66611111111087, 423.1977777777772, 421.10277777777753, 392.70055555555524, 414.5572222222219, 402.8983333333331, 418.2549999999997, 423.2399999999996, 410.7961111111109, 398.37555555555525, 399.5649999999996, 418.20666666666625, 398.3672222222217, 411.4844444444439, 411.18277777777763, 392.39111111111094, 411.7383333333329, 394.88166666666626, 400.8805555555552, 392.3194444444441, 397.9533333333332, 397.8827777777775, 413.0027777777773, 423.0011111111107, 425.5094444444441, 396.11166666666645, 415.9772222222218, 407.72222222222166, 395.4533333333329, 425.91166666666646, 412.1838888888885, 390.61333333333306, 409.22333333333313], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [401.5233333333331, 405.2061111111108, 393.00055555555525, 402.3961111111108, 375.8827777777777, 379.76499999999993, 383.57444444444417, 405.44555555555525, 416.94388888888886, 336.50888888888886, 353.50833333333316, 398.3477777777774, 393.3422222222221, 413.4605555555553, 428.54777777777747, 388.6683333333331, 441.0005555555554, 413.35777777777764, 423.5794444444441, 422.0872222222219, 375.97833333333307, 392.4527777777775, 413.7944444444442, 425.6588888888887, 398.8327777777774, 438.5783333333331, 391.4066666666663, 397.73166666666634, 402.79388888888855, 416.0711111111107, 384.20722222222196, 394.32666666666665, 424.79444444444385, 427.6111111111107, 391.17499999999967, 420.83222222222184, 409.96055555555506, 420.3422222222219, 433.2299999999997, 409.6194444444443, 408.60333333333324, 432.94333333333304, 402.6044444444439, 413.03277777777754, 392.4699999999998, 386.46055555555523, 410.87444444444395, 414.9033333333331, 398.1272222222218, 422.02499999999964, 429.04222222222165, 411.065555555555, 403.4211111111109, 400.47055555555534, 412.079444444444, 397.7472222222219, 415.26888888888857, 434.9061111111108, 433.7688888888885, 401.9077777777775, 426.6266666666664, 421.71444444444404, 379.69222222222214, 392.8355555555554, 428.32555555555524, 401.8116666666665, 424.4055555555552, 396.66611111111087, 423.1977777777772, 421.10277777777753, 392.70055555555524, 414.5572222222219, 402.8983333333331, 418.2549999999997, 423.2399999999996, 410.7961111111109, 398.37555555555525, 399.5649999999996, 418.20666666666625, 398.3672222222217, 411.4844444444439, 411.18277777777763, 392.39111111111094, 411.7383333333329, 394.88166666666626, 400.8805555555552, 392.3194444444441, 397.9533333333332, 397.8827777777775, 413.0027777777773, 423.0011111111107, 425.5094444444441, 396.11166666666645, 415.9772222222218, 407.72222222222166, 395.4533333333329, 425.91166666666646, 412.1838888888885, 390.61333333333306, 409.22333333333313]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1962649449075367, "mean_inference_ms": 1.7953029043626014, "mean_action_processing_ms": 0.07465305980056315, "mean_env_wait_ms": 1.217191102419199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004716634750366211, "StateBufferConnector_ms": 0.0030663013458251953, "ViewRequirementAgentConnector_ms": 0.07115721702575684}, "num_episodes": 30, "episode_return_max": 441.0005555555554, "episode_return_min": 336.50888888888886, "episode_return_mean": 406.86031111111083, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 266400, "num_agent_steps_trained": 266100, "num_env_steps_sampled": 266400, "num_env_steps_trained": 266100, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 280.31453528211006, "num_env_steps_trained_throughput_per_sec": 265.56113868831477, "timesteps_total": 266400, "num_env_steps_sampled_lifetime": 266400, "num_agent_steps_sampled_lifetime": 266400, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 266400, "timers": {"training_iteration_time_ms": 10268.641, "restore_workers_time_ms": 0.012, "training_step_time_ms": 534.85, "sample_time_ms": 521.594, "synch_weights_time_ms": 11.908}, "counters": {"num_env_steps_sampled": 266400, "num_env_steps_trained": 266100, "num_agent_steps_sampled": 266400, "num_agent_steps_trained": 266100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1776, "num_samples_added_to_queue": 266400}, "done": false, "training_iteration": 89, "trial_id": "0313d_00000", "date": "2024-10-10_21-56-43", "timestamp": 1728593803, "time_this_iter_s": 10.176867961883545, "time_total_s": 916.313157081604, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42db66b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 916.313157081604, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 12.942857142857141, "ram_util_percent": 65.80714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 207267.546875, "policy_loss": 206822.109375, "entropy": 16.093788146972656, "entropy_coeff": 0.01, "var_gnorm": 16.613832473754883, "vf_loss": 493712.90625, "vf_explained_var": -0.24472260475158691}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 898.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 269550, "num_env_steps_trained": 269400, "num_agent_steps_sampled": 269550, "num_agent_steps_trained": 269400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1797, "num_samples_added_to_queue": 269400, "learner_queue": {"size_count": 898, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 50.668, "learner_load_time_ms": 0.307, "learner_load_wait_time_ms": 943.249, "learner_dequeue_time_ms": 8447.274}}, "env_runners": {"episode_reward_max": 435.5161111111107, "episode_reward_min": 368.3749999999999, "episode_reward_mean": 407.6433999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 368.3749999999999}, "policy_reward_max": {"default_policy": 435.5161111111107}, "policy_reward_mean": {"default_policy": 407.6433999999996}, "custom_metrics": {"num_consolidated_mean": 1.9191, "num_consolidated_min": 1.77, "num_consolidated_max": 2.13, "num_overloaded_mean": 0.06849999999999999, "num_overloaded_min": 0.03, "num_overloaded_max": 0.13, "num_moves_mean": 5.6941999999999995, "num_moves_min": 5.24, "num_moves_max": 6.19, "mean_accuracy_mean": 39.29480999999999, "mean_accuracy_min": 39.11133333333331, "mean_accuracy_max": 39.45966666666666, "num_model_switches_mean": 2.3055999999999996, "num_model_switches_min": 1.96, "num_model_switches_max": 2.66, "num_slav_mean": 0.0034233333333333333, "num_slav_min": 0.00018333333333333334, "num_slav_max": 0.007433333333333333, "mean_cluster_cpu_util_mean": 0.46022495427879706, "mean_cluster_cpu_util_min": 0.4495249844870381, "mean_cluster_cpu_util_max": 0.47662451257862765, "mean_cluster_mem_util_mean": 0.29289477181104506, "mean_cluster_mem_util_min": 0.28788710281580987, "mean_cluster_mem_util_max": 0.3023369955366112, "reward_consolidation_mean_mean": 2.463055555555556, "reward_consolidation_mean_min": 2.291666666666667, "reward_consolidation_mean_max": 2.7361111111111116, "reward_illegal_mean_mean": -0.11416666666666667, "reward_illegal_mean_min": -0.21666666666666667, "reward_illegal_mean_max": -0.05, "reward_accuracy_mean_mean": 1.8305339999999994, "reward_accuracy_mean_min": 1.7026666666666663, "reward_accuracy_mean_max": 1.9094333333333333, "reward_sla_mean_mean": -0.10298888888888885, "reward_sla_mean_min": -0.20444444444444446, "reward_sla_mean_max": -0.006111111111111111, "reward_consolidation_sum_mean": 246.30555555555557, "reward_consolidation_sum_min": 229.16666666666669, "reward_consolidation_sum_max": 273.61111111111114, "reward_illegal_sum_mean": -11.416666666666664, "reward_illegal_sum_min": -21.666666666666668, "reward_illegal_sum_max": -5.0, "reward_accuracy_sum_mean": 183.05339999999995, "reward_accuracy_sum_min": 170.26666666666662, "reward_accuracy_sum_max": 190.94333333333333, "reward_sla_sum_mean": -10.29888888888889, "reward_sla_sum_min": -20.444444444444446, "reward_sla_sum_max": -0.6111111111111112, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2357.0, "global_timestep_min": 200, "global_timestep_max": 4000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [384.20722222222196, 394.32666666666665, 424.79444444444385, 427.6111111111107, 391.17499999999967, 420.83222222222184, 409.96055555555506, 420.3422222222219, 433.2299999999997, 409.6194444444443, 408.60333333333324, 432.94333333333304, 402.6044444444439, 413.03277777777754, 392.4699999999998, 386.46055555555523, 410.87444444444395, 414.9033333333331, 398.1272222222218, 422.02499999999964, 429.04222222222165, 411.065555555555, 403.4211111111109, 400.47055555555534, 412.079444444444, 397.7472222222219, 415.26888888888857, 434.9061111111108, 433.7688888888885, 401.9077777777775, 426.6266666666664, 421.71444444444404, 379.69222222222214, 392.8355555555554, 428.32555555555524, 401.8116666666665, 424.4055555555552, 396.66611111111087, 423.1977777777772, 421.10277777777753, 392.70055555555524, 414.5572222222219, 402.8983333333331, 418.2549999999997, 423.2399999999996, 410.7961111111109, 398.37555555555525, 399.5649999999996, 418.20666666666625, 398.3672222222217, 411.4844444444439, 411.18277777777763, 392.39111111111094, 411.7383333333329, 394.88166666666626, 400.8805555555552, 392.3194444444441, 397.9533333333332, 397.8827777777775, 413.0027777777773, 423.0011111111107, 425.5094444444441, 396.11166666666645, 415.9772222222218, 407.72222222222166, 395.4533333333329, 425.91166666666646, 412.1838888888885, 390.61333333333306, 409.22333333333313, 414.04833333333295, 385.65999999999974, 414.31888888888864, 378.32833333333315, 416.34111111111076, 389.09777777777754, 393.446111111111, 411.9061111111108, 422.73222222222194, 397.05555555555526, 396.7716666666664, 387.73888888888865, 407.66111111111087, 426.7944444444443, 410.17499999999967, 391.3599999999998, 394.5566666666662, 392.86777777777763, 381.8111111111108, 404.4855555555553, 419.4611111111108, 396.03888888888866, 382.98888888888877, 433.6111111111106, 396.2305555555553, 406.5488888888886, 368.3749999999999, 425.3261111111106, 426.5011111111109, 435.5161111111107], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [384.20722222222196, 394.32666666666665, 424.79444444444385, 427.6111111111107, 391.17499999999967, 420.83222222222184, 409.96055555555506, 420.3422222222219, 433.2299999999997, 409.6194444444443, 408.60333333333324, 432.94333333333304, 402.6044444444439, 413.03277777777754, 392.4699999999998, 386.46055555555523, 410.87444444444395, 414.9033333333331, 398.1272222222218, 422.02499999999964, 429.04222222222165, 411.065555555555, 403.4211111111109, 400.47055555555534, 412.079444444444, 397.7472222222219, 415.26888888888857, 434.9061111111108, 433.7688888888885, 401.9077777777775, 426.6266666666664, 421.71444444444404, 379.69222222222214, 392.8355555555554, 428.32555555555524, 401.8116666666665, 424.4055555555552, 396.66611111111087, 423.1977777777772, 421.10277777777753, 392.70055555555524, 414.5572222222219, 402.8983333333331, 418.2549999999997, 423.2399999999996, 410.7961111111109, 398.37555555555525, 399.5649999999996, 418.20666666666625, 398.3672222222217, 411.4844444444439, 411.18277777777763, 392.39111111111094, 411.7383333333329, 394.88166666666626, 400.8805555555552, 392.3194444444441, 397.9533333333332, 397.8827777777775, 413.0027777777773, 423.0011111111107, 425.5094444444441, 396.11166666666645, 415.9772222222218, 407.72222222222166, 395.4533333333329, 425.91166666666646, 412.1838888888885, 390.61333333333306, 409.22333333333313, 414.04833333333295, 385.65999999999974, 414.31888888888864, 378.32833333333315, 416.34111111111076, 389.09777777777754, 393.446111111111, 411.9061111111108, 422.73222222222194, 397.05555555555526, 396.7716666666664, 387.73888888888865, 407.66111111111087, 426.7944444444443, 410.17499999999967, 391.3599999999998, 394.5566666666662, 392.86777777777763, 381.8111111111108, 404.4855555555553, 419.4611111111108, 396.03888888888866, 382.98888888888877, 433.6111111111106, 396.2305555555553, 406.5488888888886, 368.3749999999999, 425.3261111111106, 426.5011111111109, 435.5161111111107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19634646002912567, "mean_inference_ms": 1.7956874921725787, "mean_action_processing_ms": 0.07467550223775195, "mean_env_wait_ms": 1.2174492778969372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004544973373413086, "StateBufferConnector_ms": 0.003133058547973633, "ViewRequirementAgentConnector_ms": 0.06943035125732422}, "num_episodes": 30, "episode_return_max": 435.5161111111107, "episode_return_min": 368.3749999999999, "episode_return_mean": 407.6433999999996, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 269550, "num_agent_steps_trained": 269400, "num_env_steps_sampled": 269550, "num_env_steps_trained": 269400, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 301.9650819998924, "num_env_steps_trained_throughput_per_sec": 316.3443716189349, "timesteps_total": 269550, "num_env_steps_sampled_lifetime": 269550, "num_agent_steps_sampled_lifetime": 269550, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 269550, "timers": {"training_iteration_time_ms": 10278.157, "restore_workers_time_ms": 0.011, "training_step_time_ms": 491.361, "sample_time_ms": 477.912, "synch_weights_time_ms": 12.188}, "counters": {"num_env_steps_sampled": 269550, "num_env_steps_trained": 269400, "num_agent_steps_sampled": 269550, "num_agent_steps_trained": 269400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1797, "num_samples_added_to_queue": 269400}, "done": false, "training_iteration": 90, "trial_id": "0313d_00000", "date": "2024-10-10_21-56-53", "timestamp": 1728593813, "time_this_iter_s": 10.441163539886475, "time_total_s": 926.7543206214905, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c29e10>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 926.7543206214905, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 10.546666666666665, "ram_util_percent": 65.79333333333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 203749.59375, "policy_loss": 203330.953125, "entropy": 16.03749656677246, "entropy_coeff": 0.01, "var_gnorm": 16.616254806518555, "vf_loss": 466754.625, "vf_explained_var": -0.25203871726989746}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 908.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 272700, "num_env_steps_trained": 272400, "num_agent_steps_sampled": 272700, "num_agent_steps_trained": 272400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1818, "num_samples_added_to_queue": 272700, "learner_queue": {"size_count": 908, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.534, "learner_load_time_ms": 0.336, "learner_load_wait_time_ms": 948.548, "learner_dequeue_time_ms": 8415.674}}, "env_runners": {"episode_reward_max": 448.0311111111107, "episode_reward_min": 364.9733333333333, "episode_reward_mean": 404.74555555555526, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 364.9733333333333}, "policy_reward_max": {"default_policy": 448.0311111111107}, "policy_reward_mean": {"default_policy": 404.74555555555526}, "custom_metrics": {"num_consolidated_mean": 1.9394, "num_consolidated_min": 1.77, "num_consolidated_max": 2.13, "num_overloaded_mean": 0.076, "num_overloaded_min": 0.03, "num_overloaded_max": 0.15, "num_moves_mean": 5.6579, "num_moves_min": 5.15, "num_moves_max": 6.19, "mean_accuracy_mean": 39.27713999999999, "mean_accuracy_min": 39.11133333333331, "mean_accuracy_max": 39.45966666666666, "num_model_switches_mean": 2.2944999999999998, "num_model_switches_min": 1.86, "num_model_switches_max": 2.64, "num_slav_mean": 0.0035001666666666657, "num_slav_min": 0.00018333333333333334, "num_slav_max": 0.007566666666666666, "mean_cluster_cpu_util_mean": 0.46218755551502916, "mean_cluster_cpu_util_min": 0.4495249844870381, "mean_cluster_cpu_util_max": 0.47662451257862765, "mean_cluster_mem_util_mean": 0.2938392276830563, "mean_cluster_mem_util_min": 0.28788710281580987, "mean_cluster_mem_util_max": 0.3023369955366112, "reward_consolidation_mean_mean": 2.4645833333333336, "reward_consolidation_mean_min": 2.2916666666666665, "reward_consolidation_mean_max": 2.7361111111111116, "reward_illegal_mean_mean": -0.12666666666666665, "reward_illegal_mean_min": -0.25, "reward_illegal_mean_max": -0.05, "reward_accuracy_mean_mean": 1.815333333333333, "reward_accuracy_mean_min": 1.664733333333333, "reward_accuracy_mean_max": 1.9091166666666664, "reward_sla_mean_mean": -0.10579444444444447, "reward_sla_mean_min": -0.225, "reward_sla_mean_max": -0.006111111111111111, "reward_consolidation_sum_mean": 246.45833333333337, "reward_consolidation_sum_min": 229.16666666666666, "reward_consolidation_sum_max": 273.61111111111114, "reward_illegal_sum_mean": -12.666666666666664, "reward_illegal_sum_min": -25.0, "reward_illegal_sum_max": -5.0, "reward_accuracy_sum_mean": 181.53333333333333, "reward_accuracy_sum_min": 166.4733333333333, "reward_accuracy_sum_max": 190.91166666666663, "reward_sla_sum_mean": -10.579444444444446, "reward_sla_sum_min": -22.5, "reward_sla_sum_max": -0.6111111111111112, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3467.0, "global_timestep_min": 1400, "global_timestep_max": 5100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [392.8355555555554, 428.32555555555524, 401.8116666666665, 424.4055555555552, 396.66611111111087, 423.1977777777772, 421.10277777777753, 392.70055555555524, 414.5572222222219, 402.8983333333331, 418.2549999999997, 423.2399999999996, 410.7961111111109, 398.37555555555525, 399.5649999999996, 418.20666666666625, 398.3672222222217, 411.4844444444439, 411.18277777777763, 392.39111111111094, 411.7383333333329, 394.88166666666626, 400.8805555555552, 392.3194444444441, 397.9533333333332, 397.8827777777775, 413.0027777777773, 423.0011111111107, 425.5094444444441, 396.11166666666645, 415.9772222222218, 407.72222222222166, 395.4533333333329, 425.91166666666646, 412.1838888888885, 390.61333333333306, 409.22333333333313, 414.04833333333295, 385.65999999999974, 414.31888888888864, 378.32833333333315, 416.34111111111076, 389.09777777777754, 393.446111111111, 411.9061111111108, 422.73222222222194, 397.05555555555526, 396.7716666666664, 387.73888888888865, 407.66111111111087, 426.7944444444443, 410.17499999999967, 391.3599999999998, 394.5566666666662, 392.86777777777763, 381.8111111111108, 404.4855555555553, 419.4611111111108, 396.03888888888866, 382.98888888888877, 433.6111111111106, 396.2305555555553, 406.5488888888886, 368.3749999999999, 425.3261111111106, 426.5011111111109, 435.5161111111107, 435.20111111111066, 396.78888888888844, 403.3494444444443, 430.3494444444441, 412.1838888888887, 393.7405555555553, 401.4633333333332, 377.51166666666654, 400.7088888888884, 423.6044444444442, 366.94611111111095, 429.9144444444439, 397.3744444444441, 448.0311111111107, 420.2377777777775, 364.9733333333333, 378.23277777777764, 422.9049999999999, 409.317222222222, 384.3599999999998, 371.89222222222196, 428.8199999999997, 399.7777777777775, 385.1922222222221, 375.4538888888886, 421.9938888888887, 395.9549999999998, 378.4155555555554, 437.12666666666655, 395.2411111111109, 371.40777777777754, 418.01055555555524, 399.58944444444415], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [392.8355555555554, 428.32555555555524, 401.8116666666665, 424.4055555555552, 396.66611111111087, 423.1977777777772, 421.10277777777753, 392.70055555555524, 414.5572222222219, 402.8983333333331, 418.2549999999997, 423.2399999999996, 410.7961111111109, 398.37555555555525, 399.5649999999996, 418.20666666666625, 398.3672222222217, 411.4844444444439, 411.18277777777763, 392.39111111111094, 411.7383333333329, 394.88166666666626, 400.8805555555552, 392.3194444444441, 397.9533333333332, 397.8827777777775, 413.0027777777773, 423.0011111111107, 425.5094444444441, 396.11166666666645, 415.9772222222218, 407.72222222222166, 395.4533333333329, 425.91166666666646, 412.1838888888885, 390.61333333333306, 409.22333333333313, 414.04833333333295, 385.65999999999974, 414.31888888888864, 378.32833333333315, 416.34111111111076, 389.09777777777754, 393.446111111111, 411.9061111111108, 422.73222222222194, 397.05555555555526, 396.7716666666664, 387.73888888888865, 407.66111111111087, 426.7944444444443, 410.17499999999967, 391.3599999999998, 394.5566666666662, 392.86777777777763, 381.8111111111108, 404.4855555555553, 419.4611111111108, 396.03888888888866, 382.98888888888877, 433.6111111111106, 396.2305555555553, 406.5488888888886, 368.3749999999999, 425.3261111111106, 426.5011111111109, 435.5161111111107, 435.20111111111066, 396.78888888888844, 403.3494444444443, 430.3494444444441, 412.1838888888887, 393.7405555555553, 401.4633333333332, 377.51166666666654, 400.7088888888884, 423.6044444444442, 366.94611111111095, 429.9144444444439, 397.3744444444441, 448.0311111111107, 420.2377777777775, 364.9733333333333, 378.23277777777764, 422.9049999999999, 409.317222222222, 384.3599999999998, 371.89222222222196, 428.8199999999997, 399.7777777777775, 385.1922222222221, 375.4538888888886, 421.9938888888887, 395.9549999999998, 378.4155555555554, 437.12666666666655, 395.2411111111109, 371.40777777777754, 418.01055555555524, 399.58944444444415]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19646996734500136, "mean_inference_ms": 1.7985214787204598, "mean_action_processing_ms": 0.07471725724762797, "mean_env_wait_ms": 1.218084580601027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004732847213745117, "StateBufferConnector_ms": 0.0030622482299804688, "ViewRequirementAgentConnector_ms": 0.06705808639526367}, "num_episodes": 33, "episode_return_max": 448.0311111111107, "episode_return_min": 364.9733333333333, "episode_return_mean": 404.74555555555526, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272700, "num_agent_steps_trained": 272400, "num_env_steps_sampled": 272700, "num_env_steps_trained": 272400, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 299.62233055628275, "num_env_steps_trained_throughput_per_sec": 285.3546005297931, "timesteps_total": 272700, "num_env_steps_sampled_lifetime": 272700, "num_agent_steps_sampled_lifetime": 272700, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 272700, "timers": {"training_iteration_time_ms": 10321.23, "restore_workers_time_ms": 0.012, "training_step_time_ms": 516.663, "sample_time_ms": 501.633, "synch_weights_time_ms": 13.628}, "counters": {"num_env_steps_sampled": 272700, "num_env_steps_trained": 272400, "num_agent_steps_sampled": 272700, "num_agent_steps_trained": 272400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1818, "num_samples_added_to_queue": 272700}, "done": false, "training_iteration": 91, "trial_id": "0313d_00000", "date": "2024-10-10_21-57-04", "timestamp": 1728593824, "time_this_iter_s": 10.52362871170044, "time_total_s": 937.2779493331909, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d8bca0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 937.2779493331909, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 11.553333333333336, "ram_util_percent": 65.98}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 210208.53125, "policy_loss": 209763.234375, "entropy": 16.1975154876709, "entropy_coeff": 0.01, "var_gnorm": 16.615087509155273, "vf_loss": 493898.15625, "vf_explained_var": -0.21859920024871826}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 917.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 275250, "num_env_steps_trained": 275100, "num_agent_steps_sampled": 275250, "num_agent_steps_trained": 275100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1835, "num_samples_added_to_queue": 275100, "learner_queue": {"size_count": 917, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.764, "learner_load_time_ms": 0.34, "learner_load_wait_time_ms": 1108.823, "learner_dequeue_time_ms": 8480.983}}, "env_runners": {"episode_reward_max": 448.0311111111107, "episode_reward_min": 364.9733333333333, "episode_reward_mean": 405.20562777777747, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 364.9733333333333}, "policy_reward_max": {"default_policy": 448.0311111111107}, "policy_reward_mean": {"default_policy": 405.20562777777747}, "custom_metrics": {"num_consolidated_mean": 1.963, "num_consolidated_min": 1.82, "num_consolidated_max": 2.13, "num_overloaded_mean": 0.0785, "num_overloaded_min": 0.03, "num_overloaded_max": 0.15, "num_moves_mean": 5.624999999999999, "num_moves_min": 5.15, "num_moves_max": 6.09, "mean_accuracy_mean": 39.27232666666665, "mean_accuracy_min": 39.11133333333331, "mean_accuracy_max": 39.45966666666666, "num_model_switches_mean": 2.278, "num_model_switches_min": 1.86, "num_model_switches_max": 2.77, "num_slav_mean": 0.0038125000000000004, "num_slav_min": 0.0009166666666666666, "num_slav_max": 0.00995, "mean_cluster_cpu_util_mean": 0.4640933822645971, "mean_cluster_cpu_util_min": 0.4495249844870381, "mean_cluster_cpu_util_max": 0.47662451257862765, "mean_cluster_mem_util_mean": 0.2944906261391687, "mean_cluster_mem_util_min": 0.2885477523393324, "mean_cluster_mem_util_max": 0.3023369955366112, "reward_consolidation_mean_mean": 2.487777777777778, "reward_consolidation_mean_min": 2.2916666666666665, "reward_consolidation_mean_max": 2.7361111111111116, "reward_illegal_mean_mean": -0.13083333333333333, "reward_illegal_mean_min": -0.25, "reward_illegal_mean_max": -0.05, "reward_accuracy_mean_mean": 1.8099618333333332, "reward_accuracy_mean_min": 1.664733333333333, "reward_accuracy_mean_max": 1.9110166666666666, "reward_sla_mean_mean": -0.11485, "reward_sla_mean_min": -0.24944444444444444, "reward_sla_mean_max": -0.030555555555555548, "reward_consolidation_sum_mean": 248.7777777777778, "reward_consolidation_sum_min": 229.16666666666666, "reward_consolidation_sum_max": 273.61111111111114, "reward_illegal_sum_mean": -13.083333333333332, "reward_illegal_sum_min": -25.0, "reward_illegal_sum_max": -5.0, "reward_accuracy_sum_mean": 180.9961833333333, "reward_accuracy_sum_min": 166.4733333333333, "reward_accuracy_sum_max": 191.10166666666666, "reward_sla_sum_mean": -11.485, "reward_sla_sum_min": -24.944444444444443, "reward_sla_sum_max": -3.055555555555555, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4257.0, "global_timestep_min": 2100, "global_timestep_max": 5900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [397.9533333333332, 397.8827777777775, 413.0027777777773, 423.0011111111107, 425.5094444444441, 396.11166666666645, 415.9772222222218, 407.72222222222166, 395.4533333333329, 425.91166666666646, 412.1838888888885, 390.61333333333306, 409.22333333333313, 414.04833333333295, 385.65999999999974, 414.31888888888864, 378.32833333333315, 416.34111111111076, 389.09777777777754, 393.446111111111, 411.9061111111108, 422.73222222222194, 397.05555555555526, 396.7716666666664, 387.73888888888865, 407.66111111111087, 426.7944444444443, 410.17499999999967, 391.3599999999998, 394.5566666666662, 392.86777777777763, 381.8111111111108, 404.4855555555553, 419.4611111111108, 396.03888888888866, 382.98888888888877, 433.6111111111106, 396.2305555555553, 406.5488888888886, 368.3749999999999, 425.3261111111106, 426.5011111111109, 435.5161111111107, 435.20111111111066, 396.78888888888844, 403.3494444444443, 430.3494444444441, 412.1838888888887, 393.7405555555553, 401.4633333333332, 377.51166666666654, 400.7088888888884, 423.6044444444442, 366.94611111111095, 429.9144444444439, 397.3744444444441, 448.0311111111107, 420.2377777777775, 364.9733333333333, 378.23277777777764, 422.9049999999999, 409.317222222222, 384.3599999999998, 371.89222222222196, 428.8199999999997, 399.7777777777775, 385.1922222222221, 375.4538888888886, 421.9938888888887, 395.9549999999998, 378.4155555555554, 437.12666666666655, 395.2411111111109, 371.40777777777754, 418.01055555555524, 399.58944444444415, 431.0788888888885, 412.8355555555553, 375.5994444444443, 387.4711111111109, 439.0572222222219, 403.57222222222214, 398.232222222222, 434.90499999999986, 408.4633333333328, 395.40555555555534, 387.2572222222219, 368.67722222222187, 403.4616666666663, 420.073333333333, 432.0561111111107, 443.8238888888885, 419.8744444444441, 416.7477777777774, 404.49388888888876, 409.83722222222184, 410.09611111111104, 396.43833333333316, 406.9144444444441, 419.8199999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [397.9533333333332, 397.8827777777775, 413.0027777777773, 423.0011111111107, 425.5094444444441, 396.11166666666645, 415.9772222222218, 407.72222222222166, 395.4533333333329, 425.91166666666646, 412.1838888888885, 390.61333333333306, 409.22333333333313, 414.04833333333295, 385.65999999999974, 414.31888888888864, 378.32833333333315, 416.34111111111076, 389.09777777777754, 393.446111111111, 411.9061111111108, 422.73222222222194, 397.05555555555526, 396.7716666666664, 387.73888888888865, 407.66111111111087, 426.7944444444443, 410.17499999999967, 391.3599999999998, 394.5566666666662, 392.86777777777763, 381.8111111111108, 404.4855555555553, 419.4611111111108, 396.03888888888866, 382.98888888888877, 433.6111111111106, 396.2305555555553, 406.5488888888886, 368.3749999999999, 425.3261111111106, 426.5011111111109, 435.5161111111107, 435.20111111111066, 396.78888888888844, 403.3494444444443, 430.3494444444441, 412.1838888888887, 393.7405555555553, 401.4633333333332, 377.51166666666654, 400.7088888888884, 423.6044444444442, 366.94611111111095, 429.9144444444439, 397.3744444444441, 448.0311111111107, 420.2377777777775, 364.9733333333333, 378.23277777777764, 422.9049999999999, 409.317222222222, 384.3599999999998, 371.89222222222196, 428.8199999999997, 399.7777777777775, 385.1922222222221, 375.4538888888886, 421.9938888888887, 395.9549999999998, 378.4155555555554, 437.12666666666655, 395.2411111111109, 371.40777777777754, 418.01055555555524, 399.58944444444415, 431.0788888888885, 412.8355555555553, 375.5994444444443, 387.4711111111109, 439.0572222222219, 403.57222222222214, 398.232222222222, 434.90499999999986, 408.4633333333328, 395.40555555555534, 387.2572222222219, 368.67722222222187, 403.4616666666663, 420.073333333333, 432.0561111111107, 443.8238888888885, 419.8744444444441, 416.7477777777774, 404.49388888888876, 409.83722222222184, 410.09611111111104, 396.43833333333316, 406.9144444444441, 419.8199999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19645900817233264, "mean_inference_ms": 1.7957301464950195, "mean_action_processing_ms": 0.07470659122416697, "mean_env_wait_ms": 1.2177215939911215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004939556121826172, "StateBufferConnector_ms": 0.0031299591064453125, "ViewRequirementAgentConnector_ms": 0.06873226165771484}, "num_episodes": 24, "episode_return_max": 448.0311111111107, "episode_return_min": 364.9733333333333, "episode_return_mean": 405.20562777777747, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 275250, "num_agent_steps_trained": 275100, "num_env_steps_sampled": 275250, "num_env_steps_trained": 275100, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 251.6609934673403, "num_env_steps_trained_throughput_per_sec": 266.46458131836033, "timesteps_total": 275250, "num_env_steps_sampled_lifetime": 275250, "num_agent_steps_sampled_lifetime": 275250, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 275250, "timers": {"training_iteration_time_ms": 10326.364, "restore_workers_time_ms": 0.013, "training_step_time_ms": 576.725, "sample_time_ms": 560.933, "synch_weights_time_ms": 14.257}, "counters": {"num_env_steps_sampled": 275250, "num_env_steps_trained": 275100, "num_agent_steps_sampled": 275250, "num_agent_steps_trained": 275100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1835, "num_samples_added_to_queue": 275100}, "done": false, "training_iteration": 92, "trial_id": "0313d_00000", "date": "2024-10-10_21-57-14", "timestamp": 1728593834, "time_this_iter_s": 10.14779782295227, "time_total_s": 947.4257471561432, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d881c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 947.4257471561432, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 18.753333333333334, "ram_util_percent": 67.88}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 195689.828125, "policy_loss": 195268.28125, "entropy": 16.02579116821289, "entropy_coeff": 0.01, "var_gnorm": 16.618436813354492, "vf_loss": 469620.875, "vf_explained_var": -0.22630417346954346}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 926.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 277950, "num_env_steps_trained": 277800, "num_agent_steps_sampled": 277950, "num_agent_steps_trained": 277800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1853, "num_samples_added_to_queue": 277800, "learner_queue": {"size_count": 926, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.817, "learner_load_time_ms": 0.313, "learner_load_wait_time_ms": 1081.87, "learner_dequeue_time_ms": 8576.057}}, "env_runners": {"episode_reward_max": 462.597222222222, "episode_reward_min": 364.9733333333333, "episode_reward_mean": 407.08617777777755, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 364.9733333333333}, "policy_reward_max": {"default_policy": 462.597222222222}, "policy_reward_mean": {"default_policy": 407.08617777777755}, "custom_metrics": {"num_consolidated_mean": 1.9775, "num_consolidated_min": 1.83, "num_consolidated_max": 2.22, "num_overloaded_mean": 0.0779, "num_overloaded_min": 0.02, "num_overloaded_max": 0.15, "num_moves_mean": 5.599599999999998, "num_moves_min": 5.15, "num_moves_max": 6.04, "mean_accuracy_mean": 39.263966666666654, "mean_accuracy_min": 39.11133333333331, "mean_accuracy_max": 39.45966666666666, "num_model_switches_mean": 2.2716, "num_model_switches_min": 1.86, "num_model_switches_max": 2.77, "num_slav_mean": 0.0039039999999999995, "num_slav_min": 0.0002, "num_slav_max": 0.00995, "mean_cluster_cpu_util_mean": 0.46550108283302466, "mean_cluster_cpu_util_min": 0.45180035402359364, "mean_cluster_cpu_util_max": 0.476179695250527, "mean_cluster_mem_util_mean": 0.29524017046090595, "mean_cluster_mem_util_min": 0.28860339167312493, "mean_cluster_mem_util_max": 0.3023369955366112, "reward_consolidation_mean_mean": 2.507361111111111, "reward_consolidation_mean_min": 2.2916666666666665, "reward_consolidation_mean_max": 2.930555555555556, "reward_illegal_mean_mean": -0.12983333333333333, "reward_illegal_mean_min": -0.25, "reward_illegal_mean_max": -0.03333333333333333, "reward_accuracy_mean_mean": 1.810767333333333, "reward_accuracy_mean_min": 1.664733333333333, "reward_accuracy_mean_max": 1.9236499999999999, "reward_sla_mean_mean": -0.11743333333333333, "reward_sla_mean_min": -0.24944444444444444, "reward_sla_mean_max": -0.0044444444444444444, "reward_consolidation_sum_mean": 250.73611111111114, "reward_consolidation_sum_min": 229.16666666666666, "reward_consolidation_sum_max": 293.0555555555556, "reward_illegal_sum_mean": -12.98333333333333, "reward_illegal_sum_min": -25.0, "reward_illegal_sum_max": -3.333333333333333, "reward_accuracy_sum_mean": 181.0767333333333, "reward_accuracy_sum_min": 166.4733333333333, "reward_accuracy_sum_max": 192.36499999999998, "reward_sla_sum_mean": -11.743333333333334, "reward_sla_sum_min": -24.944444444444443, "reward_sla_sum_max": -0.4444444444444445, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5158.0, "global_timestep_min": 3100, "global_timestep_max": 6800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [410.17499999999967, 391.3599999999998, 394.5566666666662, 392.86777777777763, 381.8111111111108, 404.4855555555553, 419.4611111111108, 396.03888888888866, 382.98888888888877, 433.6111111111106, 396.2305555555553, 406.5488888888886, 368.3749999999999, 425.3261111111106, 426.5011111111109, 435.5161111111107, 435.20111111111066, 396.78888888888844, 403.3494444444443, 430.3494444444441, 412.1838888888887, 393.7405555555553, 401.4633333333332, 377.51166666666654, 400.7088888888884, 423.6044444444442, 366.94611111111095, 429.9144444444439, 397.3744444444441, 448.0311111111107, 420.2377777777775, 364.9733333333333, 378.23277777777764, 422.9049999999999, 409.317222222222, 384.3599999999998, 371.89222222222196, 428.8199999999997, 399.7777777777775, 385.1922222222221, 375.4538888888886, 421.9938888888887, 395.9549999999998, 378.4155555555554, 437.12666666666655, 395.2411111111109, 371.40777777777754, 418.01055555555524, 399.58944444444415, 431.0788888888885, 412.8355555555553, 375.5994444444443, 387.4711111111109, 439.0572222222219, 403.57222222222214, 398.232222222222, 434.90499999999986, 408.4633333333328, 395.40555555555534, 387.2572222222219, 368.67722222222187, 403.4616666666663, 420.073333333333, 432.0561111111107, 443.8238888888885, 419.8744444444441, 416.7477777777774, 404.49388888888876, 409.83722222222184, 410.09611111111104, 396.43833333333316, 406.9144444444441, 419.8199999999999, 427.588333333333, 417.13777777777756, 419.73888888888865, 383.6699999999998, 448.19833333333304, 412.35166666666635, 397.8905555555554, 389.99444444444424, 379.00222222222214, 402.8833333333329, 410.1216666666665, 387.18333333333294, 412.1127777777775, 404.502222222222, 383.3822222222222, 423.9061111111108, 405.1505555555554, 435.85722222222205, 422.4288888888887, 411.5583333333331, 427.0411111111108, 406.1838888888885, 410.5016666666664, 431.07222222222174, 434.7305555555555, 462.597222222222, 393.71611111111065], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [410.17499999999967, 391.3599999999998, 394.5566666666662, 392.86777777777763, 381.8111111111108, 404.4855555555553, 419.4611111111108, 396.03888888888866, 382.98888888888877, 433.6111111111106, 396.2305555555553, 406.5488888888886, 368.3749999999999, 425.3261111111106, 426.5011111111109, 435.5161111111107, 435.20111111111066, 396.78888888888844, 403.3494444444443, 430.3494444444441, 412.1838888888887, 393.7405555555553, 401.4633333333332, 377.51166666666654, 400.7088888888884, 423.6044444444442, 366.94611111111095, 429.9144444444439, 397.3744444444441, 448.0311111111107, 420.2377777777775, 364.9733333333333, 378.23277777777764, 422.9049999999999, 409.317222222222, 384.3599999999998, 371.89222222222196, 428.8199999999997, 399.7777777777775, 385.1922222222221, 375.4538888888886, 421.9938888888887, 395.9549999999998, 378.4155555555554, 437.12666666666655, 395.2411111111109, 371.40777777777754, 418.01055555555524, 399.58944444444415, 431.0788888888885, 412.8355555555553, 375.5994444444443, 387.4711111111109, 439.0572222222219, 403.57222222222214, 398.232222222222, 434.90499999999986, 408.4633333333328, 395.40555555555534, 387.2572222222219, 368.67722222222187, 403.4616666666663, 420.073333333333, 432.0561111111107, 443.8238888888885, 419.8744444444441, 416.7477777777774, 404.49388888888876, 409.83722222222184, 410.09611111111104, 396.43833333333316, 406.9144444444441, 419.8199999999999, 427.588333333333, 417.13777777777756, 419.73888888888865, 383.6699999999998, 448.19833333333304, 412.35166666666635, 397.8905555555554, 389.99444444444424, 379.00222222222214, 402.8833333333329, 410.1216666666665, 387.18333333333294, 412.1127777777775, 404.502222222222, 383.3822222222222, 423.9061111111108, 405.1505555555554, 435.85722222222205, 422.4288888888887, 411.5583333333331, 427.0411111111108, 406.1838888888885, 410.5016666666664, 431.07222222222174, 434.7305555555555, 462.597222222222, 393.71611111111065]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19655635347937583, "mean_inference_ms": 1.7953277748216276, "mean_action_processing_ms": 0.07474303245923701, "mean_env_wait_ms": 1.2181074581476763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050394535064697266, "StateBufferConnector_ms": 0.0032041072845458984, "ViewRequirementAgentConnector_ms": 0.07046747207641602}, "num_episodes": 27, "episode_return_max": 462.597222222222, "episode_return_min": 364.9733333333333, "episode_return_mean": 407.08617777777755, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 277950, "num_agent_steps_trained": 277800, "num_env_steps_sampled": 277950, "num_env_steps_trained": 277800, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 263.04528325780683, "num_env_steps_trained_throughput_per_sec": 263.04528325780683, "timesteps_total": 277950, "num_env_steps_sampled_lifetime": 277950, "num_agent_steps_sampled_lifetime": 277950, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 277950, "timers": {"training_iteration_time_ms": 10300.584, "restore_workers_time_ms": 0.012, "training_step_time_ms": 571.803, "sample_time_ms": 555.539, "synch_weights_time_ms": 14.682}, "counters": {"num_env_steps_sampled": 277950, "num_env_steps_trained": 277800, "num_agent_steps_sampled": 277950, "num_agent_steps_trained": 277800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1853, "num_samples_added_to_queue": 277800}, "done": false, "training_iteration": 93, "trial_id": "0313d_00000", "date": "2024-10-10_21-57-25", "timestamp": 1728593845, "time_this_iter_s": 10.274175882339478, "time_total_s": 957.6999230384827, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42db5ba0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 957.6999230384827, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 14.813333333333333, "ram_util_percent": 68.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 202081.53125, "policy_loss": 201651.53125, "entropy": 15.547740936279297, "entropy_coeff": 0.01, "var_gnorm": 16.62773323059082, "vf_loss": 476645.8125, "vf_explained_var": -0.21216726303100586}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 935.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 280800, "num_env_steps_trained": 280500, "num_agent_steps_sampled": 280800, "num_agent_steps_trained": 280500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1872, "num_samples_added_to_queue": 280800, "learner_queue": {"size_count": 935, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.91, "learner_load_time_ms": 0.286, "learner_load_wait_time_ms": 1036.354, "learner_dequeue_time_ms": 8636.414}}, "env_runners": {"episode_reward_max": 463.4116666666661, "episode_reward_min": 364.9733333333333, "episode_reward_mean": 411.6833833333331, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 364.9733333333333}, "policy_reward_max": {"default_policy": 463.4116666666661}, "policy_reward_mean": {"default_policy": 411.6833833333331}, "custom_metrics": {"num_consolidated_mean": 1.9982999999999997, "num_consolidated_min": 1.83, "num_consolidated_max": 2.22, "num_overloaded_mean": 0.0759, "num_overloaded_min": 0.01, "num_overloaded_max": 0.15, "num_moves_mean": 5.5476, "num_moves_min": 5.04, "num_moves_max": 6.04, "mean_accuracy_mean": 39.26681666666664, "mean_accuracy_min": 39.13033333333331, "mean_accuracy_max": 39.427999999999976, "num_model_switches_mean": 2.2257, "num_model_switches_min": 1.86, "num_model_switches_max": 2.77, "num_slav_mean": 0.0037048333333333334, "num_slav_min": 0.0002, "num_slav_max": 0.00995, "mean_cluster_cpu_util_mean": 0.4663961320582042, "mean_cluster_cpu_util_min": 0.4551110831971074, "mean_cluster_cpu_util_max": 0.47848265564225273, "mean_cluster_mem_util_mean": 0.29543720885178965, "mean_cluster_mem_util_min": 0.28936322548006543, "mean_cluster_mem_util_max": 0.30025352281207845, "reward_consolidation_mean_mean": 2.5395833333333337, "reward_consolidation_mean_min": 2.2916666666666665, "reward_consolidation_mean_max": 2.930555555555556, "reward_illegal_mean_mean": -0.1265, "reward_illegal_mean_min": -0.25, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 1.8148171666666664, "reward_accuracy_mean_min": 1.664733333333333, "reward_accuracy_mean_max": 1.945783333333333, "reward_sla_mean_mean": -0.11106666666666663, "reward_sla_mean_min": -0.24944444444444444, "reward_sla_mean_max": -0.0044444444444444444, "reward_consolidation_sum_mean": 253.95833333333337, "reward_consolidation_sum_min": 229.16666666666666, "reward_consolidation_sum_max": 293.0555555555556, "reward_illegal_sum_mean": -12.65, "reward_illegal_sum_min": -25.0, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 181.4817166666666, "reward_accuracy_sum_min": 166.4733333333333, "reward_accuracy_sum_max": 194.5783333333333, "reward_sla_sum_mean": -11.106666666666667, "reward_sla_sum_min": -24.944444444444443, "reward_sla_sum_max": -0.4444444444444445, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6151.0, "global_timestep_min": 4100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [420.2377777777775, 364.9733333333333, 378.23277777777764, 422.9049999999999, 409.317222222222, 384.3599999999998, 371.89222222222196, 428.8199999999997, 399.7777777777775, 385.1922222222221, 375.4538888888886, 421.9938888888887, 395.9549999999998, 378.4155555555554, 437.12666666666655, 395.2411111111109, 371.40777777777754, 418.01055555555524, 399.58944444444415, 431.0788888888885, 412.8355555555553, 375.5994444444443, 387.4711111111109, 439.0572222222219, 403.57222222222214, 398.232222222222, 434.90499999999986, 408.4633333333328, 395.40555555555534, 387.2572222222219, 368.67722222222187, 403.4616666666663, 420.073333333333, 432.0561111111107, 443.8238888888885, 419.8744444444441, 416.7477777777774, 404.49388888888876, 409.83722222222184, 410.09611111111104, 396.43833333333316, 406.9144444444441, 419.8199999999999, 427.588333333333, 417.13777777777756, 419.73888888888865, 383.6699999999998, 448.19833333333304, 412.35166666666635, 397.8905555555554, 389.99444444444424, 379.00222222222214, 402.8833333333329, 410.1216666666665, 387.18333333333294, 412.1127777777775, 404.502222222222, 383.3822222222222, 423.9061111111108, 405.1505555555554, 435.85722222222205, 422.4288888888887, 411.5583333333331, 427.0411111111108, 406.1838888888885, 410.5016666666664, 431.07222222222174, 434.7305555555555, 462.597222222222, 393.71611111111065, 448.3499999999997, 404.92277777777747, 414.12055555555503, 413.3116666666667, 398.6833333333332, 422.81055555555537, 433.3983333333333, 420.9377777777774, 402.2316666666665, 463.4116666666661, 410.7872222222221, 383.21722222222195, 411.2399999999996, 436.69111111111096, 393.76277777777744, 452.0477777777778, 437.9216666666665, 445.79388888888866, 427.001111111111, 426.8755555555554, 410.51666666666637, 401.44777777777756, 443.02388888888845, 422.2861111111109, 390.33777777777755, 426.40555555555534, 418.9772222222221, 443.047222222222, 429.69777777777756, 409.48555555555515], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [420.2377777777775, 364.9733333333333, 378.23277777777764, 422.9049999999999, 409.317222222222, 384.3599999999998, 371.89222222222196, 428.8199999999997, 399.7777777777775, 385.1922222222221, 375.4538888888886, 421.9938888888887, 395.9549999999998, 378.4155555555554, 437.12666666666655, 395.2411111111109, 371.40777777777754, 418.01055555555524, 399.58944444444415, 431.0788888888885, 412.8355555555553, 375.5994444444443, 387.4711111111109, 439.0572222222219, 403.57222222222214, 398.232222222222, 434.90499999999986, 408.4633333333328, 395.40555555555534, 387.2572222222219, 368.67722222222187, 403.4616666666663, 420.073333333333, 432.0561111111107, 443.8238888888885, 419.8744444444441, 416.7477777777774, 404.49388888888876, 409.83722222222184, 410.09611111111104, 396.43833333333316, 406.9144444444441, 419.8199999999999, 427.588333333333, 417.13777777777756, 419.73888888888865, 383.6699999999998, 448.19833333333304, 412.35166666666635, 397.8905555555554, 389.99444444444424, 379.00222222222214, 402.8833333333329, 410.1216666666665, 387.18333333333294, 412.1127777777775, 404.502222222222, 383.3822222222222, 423.9061111111108, 405.1505555555554, 435.85722222222205, 422.4288888888887, 411.5583333333331, 427.0411111111108, 406.1838888888885, 410.5016666666664, 431.07222222222174, 434.7305555555555, 462.597222222222, 393.71611111111065, 448.3499999999997, 404.92277777777747, 414.12055555555503, 413.3116666666667, 398.6833333333332, 422.81055555555537, 433.3983333333333, 420.9377777777774, 402.2316666666665, 463.4116666666661, 410.7872222222221, 383.21722222222195, 411.2399999999996, 436.69111111111096, 393.76277777777744, 452.0477777777778, 437.9216666666665, 445.79388888888866, 427.001111111111, 426.8755555555554, 410.51666666666637, 401.44777777777756, 443.02388888888845, 422.2861111111109, 390.33777777777755, 426.40555555555534, 418.9772222222221, 443.047222222222, 429.69777777777756, 409.48555555555515]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1967247453581441, "mean_inference_ms": 1.7954270813486226, "mean_action_processing_ms": 0.07479947878490832, "mean_env_wait_ms": 1.2187350964000243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005039691925048828, "StateBufferConnector_ms": 0.003132343292236328, "ViewRequirementAgentConnector_ms": 0.07195305824279785}, "num_episodes": 30, "episode_return_max": 463.4116666666661, "episode_return_min": 364.9733333333333, "episode_return_mean": 411.6833833333331, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280800, "num_agent_steps_trained": 280500, "num_env_steps_sampled": 280800, "num_env_steps_trained": 280500, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 277.35016046902, "num_env_steps_trained_throughput_per_sec": 262.7527836022295, "timesteps_total": 280800, "num_env_steps_sampled_lifetime": 280800, "num_agent_steps_sampled_lifetime": 280800, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 280800, "timers": {"training_iteration_time_ms": 10305.304, "restore_workers_time_ms": 0.011, "training_step_time_ms": 565.6, "sample_time_ms": 550.525, "synch_weights_time_ms": 13.584}, "counters": {"num_env_steps_sampled": 280800, "num_env_steps_trained": 280500, "num_agent_steps_sampled": 280800, "num_agent_steps_trained": 280500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1872, "num_samples_added_to_queue": 280800}, "done": false, "training_iteration": 94, "trial_id": "0313d_00000", "date": "2024-10-10_21-57-35", "timestamp": 1728593855, "time_this_iter_s": 10.285803318023682, "time_total_s": 967.9857263565063, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c28280>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 967.9857263565063, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 13.69285714285714, "ram_util_percent": 68.36428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 183138.5625, "policy_loss": 182704.8125, "entropy": 14.959074020385742, "entropy_coeff": 0.01, "var_gnorm": 16.629924774169922, "vf_loss": 478627.25, "vf_explained_var": -0.2034522294998169}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 945.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 283650, "num_env_steps_trained": 283500, "num_agent_steps_sampled": 283650, "num_agent_steps_trained": 283500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1891, "num_samples_added_to_queue": 283500, "learner_queue": {"size_count": 945, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.124, "learner_load_time_ms": 0.259, "learner_load_wait_time_ms": 1022.342, "learner_dequeue_time_ms": 8655.329}}, "env_runners": {"episode_reward_max": 472.9427777777776, "episode_reward_min": 368.67722222222187, "episode_reward_mean": 421.8512499999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 368.67722222222187}, "policy_reward_max": {"default_policy": 472.9427777777776}, "policy_reward_mean": {"default_policy": 421.8512499999997}, "custom_metrics": {"num_consolidated_mean": 2.0284999999999997, "num_consolidated_min": 1.83, "num_consolidated_max": 2.22, "num_overloaded_mean": 0.0684, "num_overloaded_min": 0.01, "num_overloaded_max": 0.14, "num_moves_mean": 5.4129000000000005, "num_moves_min": 4.49, "num_moves_max": 6.04, "mean_accuracy_mean": 39.27156666666665, "mean_accuracy_min": 39.11133333333331, "mean_accuracy_max": 39.42799999999998, "num_model_switches_mean": 2.1454, "num_model_switches_min": 1.68, "num_model_switches_max": 2.77, "num_slav_mean": 0.003220833333333334, "num_slav_min": 0.00015, "num_slav_max": 0.00995, "mean_cluster_cpu_util_mean": 0.46704527160651055, "mean_cluster_cpu_util_min": 0.456507850672127, "mean_cluster_cpu_util_max": 0.47848265564225273, "mean_cluster_mem_util_mean": 0.29523903555282877, "mean_cluster_mem_util_min": 0.2907087967148885, "mean_cluster_mem_util_max": 0.30025352281207845, "reward_consolidation_mean_mean": 2.6005555555555553, "reward_consolidation_mean_min": 2.3055555555555554, "reward_consolidation_mean_max": 2.930555555555556, "reward_illegal_mean_mean": -0.11400000000000002, "reward_illegal_mean_min": -0.2333333333333333, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 1.8296124999999994, "reward_accuracy_mean_min": 1.6855999999999998, "reward_accuracy_mean_max": 1.945783333333333, "reward_sla_mean_mean": -0.09765555555555556, "reward_sla_mean_min": -0.24944444444444444, "reward_sla_mean_max": -0.0044444444444444444, "reward_consolidation_sum_mean": 260.0555555555556, "reward_consolidation_sum_min": 230.55555555555554, "reward_consolidation_sum_max": 293.0555555555556, "reward_illegal_sum_mean": -11.399999999999999, "reward_illegal_sum_min": -23.333333333333332, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 182.96125, "reward_accuracy_sum_min": 168.55999999999997, "reward_accuracy_sum_max": 194.5783333333333, "reward_sla_sum_mean": -9.765555555555556, "reward_sla_sum_min": -24.944444444444443, "reward_sla_sum_max": -0.4444444444444445, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4956.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [408.4633333333328, 395.40555555555534, 387.2572222222219, 368.67722222222187, 403.4616666666663, 420.073333333333, 432.0561111111107, 443.8238888888885, 419.8744444444441, 416.7477777777774, 404.49388888888876, 409.83722222222184, 410.09611111111104, 396.43833333333316, 406.9144444444441, 419.8199999999999, 427.588333333333, 417.13777777777756, 419.73888888888865, 383.6699999999998, 448.19833333333304, 412.35166666666635, 397.8905555555554, 389.99444444444424, 379.00222222222214, 402.8833333333329, 410.1216666666665, 387.18333333333294, 412.1127777777775, 404.502222222222, 383.3822222222222, 423.9061111111108, 405.1505555555554, 435.85722222222205, 422.4288888888887, 411.5583333333331, 427.0411111111108, 406.1838888888885, 410.5016666666664, 431.07222222222174, 434.7305555555555, 462.597222222222, 393.71611111111065, 448.3499999999997, 404.92277777777747, 414.12055555555503, 413.3116666666667, 398.6833333333332, 422.81055555555537, 433.3983333333333, 420.9377777777774, 402.2316666666665, 463.4116666666661, 410.7872222222221, 383.21722222222195, 411.2399999999996, 436.69111111111096, 393.76277777777744, 452.0477777777778, 437.9216666666665, 445.79388888888866, 427.001111111111, 426.8755555555554, 410.51666666666637, 401.44777777777756, 443.02388888888845, 422.2861111111109, 390.33777777777755, 426.40555555555534, 418.9772222222221, 443.047222222222, 429.69777777777756, 409.48555555555515, 449.508333333333, 444.684444444444, 459.5566666666664, 422.04777777777747, 450.8649999999996, 435.85833333333295, 470.15777777777754, 445.4149999999997, 431.2861111111108, 437.6277777777774, 407.9777777777774, 418.4788888888885, 412.22277777777754, 430.59555555555534, 444.13722222222185, 449.86611111111085, 472.9427777777776, 428.76333333333275, 409.3488888888888, 423.4544444444443, 422.2949999999999, 460.42999999999967, 429.8416666666665, 422.91277777777736, 466.6188888888885, 454.08722222222195, 457.45999999999987], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [408.4633333333328, 395.40555555555534, 387.2572222222219, 368.67722222222187, 403.4616666666663, 420.073333333333, 432.0561111111107, 443.8238888888885, 419.8744444444441, 416.7477777777774, 404.49388888888876, 409.83722222222184, 410.09611111111104, 396.43833333333316, 406.9144444444441, 419.8199999999999, 427.588333333333, 417.13777777777756, 419.73888888888865, 383.6699999999998, 448.19833333333304, 412.35166666666635, 397.8905555555554, 389.99444444444424, 379.00222222222214, 402.8833333333329, 410.1216666666665, 387.18333333333294, 412.1127777777775, 404.502222222222, 383.3822222222222, 423.9061111111108, 405.1505555555554, 435.85722222222205, 422.4288888888887, 411.5583333333331, 427.0411111111108, 406.1838888888885, 410.5016666666664, 431.07222222222174, 434.7305555555555, 462.597222222222, 393.71611111111065, 448.3499999999997, 404.92277777777747, 414.12055555555503, 413.3116666666667, 398.6833333333332, 422.81055555555537, 433.3983333333333, 420.9377777777774, 402.2316666666665, 463.4116666666661, 410.7872222222221, 383.21722222222195, 411.2399999999996, 436.69111111111096, 393.76277777777744, 452.0477777777778, 437.9216666666665, 445.79388888888866, 427.001111111111, 426.8755555555554, 410.51666666666637, 401.44777777777756, 443.02388888888845, 422.2861111111109, 390.33777777777755, 426.40555555555534, 418.9772222222221, 443.047222222222, 429.69777777777756, 409.48555555555515, 449.508333333333, 444.684444444444, 459.5566666666664, 422.04777777777747, 450.8649999999996, 435.85833333333295, 470.15777777777754, 445.4149999999997, 431.2861111111108, 437.6277777777774, 407.9777777777774, 418.4788888888885, 412.22277777777754, 430.59555555555534, 444.13722222222185, 449.86611111111085, 472.9427777777776, 428.76333333333275, 409.3488888888888, 423.4544444444443, 422.2949999999999, 460.42999999999967, 429.8416666666665, 422.91277777777736, 466.6188888888885, 454.08722222222195, 457.45999999999987]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1969653385207718, "mean_inference_ms": 1.7985668564832633, "mean_action_processing_ms": 0.07489093413349071, "mean_env_wait_ms": 1.2199878661318693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048046112060546875, "StateBufferConnector_ms": 0.003134012222290039, "ViewRequirementAgentConnector_ms": 0.07200837135314941}, "num_episodes": 27, "episode_return_max": 472.9427777777776, "episode_return_min": 368.67722222222187, "episode_return_mean": 421.8512499999997, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 283650, "num_agent_steps_trained": 283500, "num_env_steps_sampled": 283650, "num_env_steps_trained": 283500, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 278.66448983656664, "num_env_steps_trained_throughput_per_sec": 293.33104193322805, "timesteps_total": 283650, "num_env_steps_sampled_lifetime": 283650, "num_agent_steps_sampled_lifetime": 283650, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 283650, "timers": {"training_iteration_time_ms": 10325.122, "restore_workers_time_ms": 0.012, "training_step_time_ms": 535.071, "sample_time_ms": 520.282, "synch_weights_time_ms": 13.407}, "counters": {"num_env_steps_sampled": 283650, "num_env_steps_trained": 283500, "num_agent_steps_sampled": 283650, "num_agent_steps_trained": 283500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1891, "num_samples_added_to_queue": 283500}, "done": false, "training_iteration": 95, "trial_id": "0313d_00000", "date": "2024-10-10_21-57-45", "timestamp": 1728593865, "time_this_iter_s": 10.244916915893555, "time_total_s": 978.2306432723999, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c29660>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 978.2306432723999, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 14.52, "ram_util_percent": 68.44}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 194020.265625, "policy_loss": 193504.578125, "entropy": 14.660564422607422, "entropy_coeff": 0.01, "var_gnorm": 16.639345169067383, "vf_loss": 559664.25, "vf_explained_var": -0.19596731662750244}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 955.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 286650, "num_env_steps_trained": 286500, "num_agent_steps_sampled": 286650, "num_agent_steps_trained": 286500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1911, "num_samples_added_to_queue": 286500, "learner_queue": {"size_count": 955, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.933, "learner_load_time_ms": 0.232, "learner_load_wait_time_ms": 966.321, "learner_dequeue_time_ms": 8668.05}}, "env_runners": {"episode_reward_max": 472.9427777777776, "episode_reward_min": 383.21722222222195, "episode_reward_mean": 433.36653333333305, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 383.21722222222195}, "policy_reward_max": {"default_policy": 472.9427777777776}, "policy_reward_mean": {"default_policy": 433.36653333333305}, "custom_metrics": {"num_consolidated_mean": 2.058, "num_consolidated_min": 1.86, "num_consolidated_max": 2.23, "num_overloaded_mean": 0.059500000000000004, "num_overloaded_min": 0.01, "num_overloaded_max": 0.15, "num_moves_mean": 5.232800000000001, "num_moves_min": 4.49, "num_moves_max": 6.04, "mean_accuracy_mean": 39.27935666666665, "mean_accuracy_min": 39.11133333333331, "mean_accuracy_max": 39.42799999999998, "num_model_switches_mean": 2.0505, "num_model_switches_min": 1.68, "num_model_switches_max": 2.51, "num_slav_mean": 0.002654833333333333, "num_slav_min": 0.00015, "num_slav_max": 0.006666666666666666, "mean_cluster_cpu_util_mean": 0.46742112414135417, "mean_cluster_cpu_util_min": 0.4570975917042003, "mean_cluster_cpu_util_max": 0.47848265564225273, "mean_cluster_mem_util_mean": 0.29469238292215616, "mean_cluster_mem_util_min": 0.28829397388702316, "mean_cluster_mem_util_max": 0.30025352281207845, "reward_consolidation_mean_mean": 2.666805555555556, "reward_consolidation_mean_min": 2.361111111111111, "reward_consolidation_mean_max": 2.930555555555557, "reward_illegal_mean_mean": -0.09916666666666667, "reward_illegal_mean_min": -0.25, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 1.8473319999999995, "reward_accuracy_mean_min": 1.66885, "reward_accuracy_mean_max": 1.945783333333333, "reward_sla_mean_mean": -0.08130555555555556, "reward_sla_mean_min": -0.19722222222222222, "reward_sla_mean_max": -0.005, "reward_consolidation_sum_mean": 266.6805555555556, "reward_consolidation_sum_min": 236.11111111111111, "reward_consolidation_sum_max": 293.0555555555557, "reward_illegal_sum_mean": -9.916666666666668, "reward_illegal_sum_min": -25.0, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 184.7332, "reward_accuracy_sum_min": 166.885, "reward_accuracy_sum_max": 194.5783333333333, "reward_sla_sum_mean": -8.130555555555555, "reward_sla_sum_min": -19.72222222222222, "reward_sla_sum_max": -0.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3617.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [383.3822222222222, 423.9061111111108, 405.1505555555554, 435.85722222222205, 422.4288888888887, 411.5583333333331, 427.0411111111108, 406.1838888888885, 410.5016666666664, 431.07222222222174, 434.7305555555555, 462.597222222222, 393.71611111111065, 448.3499999999997, 404.92277777777747, 414.12055555555503, 413.3116666666667, 398.6833333333332, 422.81055555555537, 433.3983333333333, 420.9377777777774, 402.2316666666665, 463.4116666666661, 410.7872222222221, 383.21722222222195, 411.2399999999996, 436.69111111111096, 393.76277777777744, 452.0477777777778, 437.9216666666665, 445.79388888888866, 427.001111111111, 426.8755555555554, 410.51666666666637, 401.44777777777756, 443.02388888888845, 422.2861111111109, 390.33777777777755, 426.40555555555534, 418.9772222222221, 443.047222222222, 429.69777777777756, 409.48555555555515, 449.508333333333, 444.684444444444, 459.5566666666664, 422.04777777777747, 450.8649999999996, 435.85833333333295, 470.15777777777754, 445.4149999999997, 431.2861111111108, 437.6277777777774, 407.9777777777774, 418.4788888888885, 412.22277777777754, 430.59555555555534, 444.13722222222185, 449.86611111111085, 472.9427777777776, 428.76333333333275, 409.3488888888888, 423.4544444444443, 422.2949999999999, 460.42999999999967, 429.8416666666665, 422.91277777777736, 466.6188888888885, 454.08722222222195, 457.45999999999987, 430.6272222222221, 384.7738888888885, 419.8516666666664, 444.55555555555526, 434.62833333333305, 465.5466666666664, 450.27944444444404, 447.59444444444415, 451.2383333333329, 463.53944444444414, 391.62944444444406, 450.9211111111109, 449.58833333333314, 468.325, 443.96888888888844, 459.8027777777776, 457.88888888888835, 465.7611111111108, 468.08055555555524, 467.9616666666665, 443.5966666666663, 444.3961111111108, 423.82666666666637, 451.34944444444386, 453.0094444444441, 456.2461111111106, 440.53999999999974, 469.3722222222219, 438.63555555555513, 449.8094444444442], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [383.3822222222222, 423.9061111111108, 405.1505555555554, 435.85722222222205, 422.4288888888887, 411.5583333333331, 427.0411111111108, 406.1838888888885, 410.5016666666664, 431.07222222222174, 434.7305555555555, 462.597222222222, 393.71611111111065, 448.3499999999997, 404.92277777777747, 414.12055555555503, 413.3116666666667, 398.6833333333332, 422.81055555555537, 433.3983333333333, 420.9377777777774, 402.2316666666665, 463.4116666666661, 410.7872222222221, 383.21722222222195, 411.2399999999996, 436.69111111111096, 393.76277777777744, 452.0477777777778, 437.9216666666665, 445.79388888888866, 427.001111111111, 426.8755555555554, 410.51666666666637, 401.44777777777756, 443.02388888888845, 422.2861111111109, 390.33777777777755, 426.40555555555534, 418.9772222222221, 443.047222222222, 429.69777777777756, 409.48555555555515, 449.508333333333, 444.684444444444, 459.5566666666664, 422.04777777777747, 450.8649999999996, 435.85833333333295, 470.15777777777754, 445.4149999999997, 431.2861111111108, 437.6277777777774, 407.9777777777774, 418.4788888888885, 412.22277777777754, 430.59555555555534, 444.13722222222185, 449.86611111111085, 472.9427777777776, 428.76333333333275, 409.3488888888888, 423.4544444444443, 422.2949999999999, 460.42999999999967, 429.8416666666665, 422.91277777777736, 466.6188888888885, 454.08722222222195, 457.45999999999987, 430.6272222222221, 384.7738888888885, 419.8516666666664, 444.55555555555526, 434.62833333333305, 465.5466666666664, 450.27944444444404, 447.59444444444415, 451.2383333333329, 463.53944444444414, 391.62944444444406, 450.9211111111109, 449.58833333333314, 468.325, 443.96888888888844, 459.8027777777776, 457.88888888888835, 465.7611111111108, 468.08055555555524, 467.9616666666665, 443.5966666666663, 444.3961111111108, 423.82666666666637, 451.34944444444386, 453.0094444444441, 456.2461111111106, 440.53999999999974, 469.3722222222219, 438.63555555555513, 449.8094444444442]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19712287445826257, "mean_inference_ms": 1.8005190976331054, "mean_action_processing_ms": 0.07494146871456249, "mean_env_wait_ms": 1.2206188628214945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004509687423706055, "StateBufferConnector_ms": 0.0030193328857421875, "ViewRequirementAgentConnector_ms": 0.06865692138671875}, "num_episodes": 30, "episode_return_max": 472.9427777777776, "episode_return_min": 383.21722222222195, "episode_return_mean": 433.36653333333305, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 286650, "num_agent_steps_trained": 286500, "num_env_steps_sampled": 286650, "num_env_steps_trained": 286500, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 294.60552049606457, "num_env_steps_trained_throughput_per_sec": 294.60552049606457, "timesteps_total": 286650, "num_env_steps_sampled_lifetime": 286650, "num_agent_steps_sampled_lifetime": 286650, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 286650, "timers": {"training_iteration_time_ms": 10310.209, "restore_workers_time_ms": 0.012, "training_step_time_ms": 497.845, "sample_time_ms": 483.315, "synch_weights_time_ms": 13.209}, "counters": {"num_env_steps_sampled": 286650, "num_env_steps_trained": 286500, "num_agent_steps_sampled": 286650, "num_agent_steps_trained": 286500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1911, "num_samples_added_to_queue": 286500}, "done": false, "training_iteration": 96, "trial_id": "0313d_00000", "date": "2024-10-10_21-57-55", "timestamp": 1728593875, "time_this_iter_s": 10.201420068740845, "time_total_s": 988.4320633411407, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c29b70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 988.4320633411407, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 11.273333333333333, "ram_util_percent": 68.37999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 204129.96875, "policy_loss": 203613.21875, "entropy": 14.830119132995605, "entropy_coeff": 0.01, "var_gnorm": 16.64754295349121, "vf_loss": 561237.75, "vf_explained_var": -0.16907942295074463}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 965.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 289800, "num_env_steps_trained": 289500, "num_agent_steps_sampled": 289800, "num_agent_steps_trained": 289500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1932, "num_samples_added_to_queue": 289800, "learner_queue": {"size_count": 965, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.726, "learner_load_time_ms": 0.209, "learner_load_wait_time_ms": 931.187, "learner_dequeue_time_ms": 8524.983}}, "env_runners": {"episode_reward_max": 486.3644444444441, "episode_reward_min": 384.7738888888885, "episode_reward_mean": 443.5005166666664, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 384.7738888888885}, "policy_reward_max": {"default_policy": 486.3644444444441}, "policy_reward_mean": {"default_policy": 443.5005166666664}, "custom_metrics": {"num_consolidated_mean": 2.0884, "num_consolidated_min": 1.96, "num_consolidated_max": 2.23, "num_overloaded_mean": 0.05210000000000001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.15, "num_moves_mean": 5.0889, "num_moves_min": 4.49, "num_moves_max": 5.79, "mean_accuracy_mean": 39.28150999999998, "mean_accuracy_min": 39.111333333333306, "mean_accuracy_max": 39.42799999999998, "num_model_switches_mean": 1.9653, "num_model_switches_min": 1.65, "num_model_switches_max": 2.4, "num_slav_mean": 0.002264166666666666, "num_slav_min": 0.00015, "num_slav_max": 0.007533333333333333, "mean_cluster_cpu_util_mean": 0.4677461978389381, "mean_cluster_cpu_util_min": 0.45134365992003167, "mean_cluster_cpu_util_max": 0.4778852845460058, "mean_cluster_mem_util_mean": 0.2940995215688596, "mean_cluster_mem_util_min": 0.28694927882545423, "mean_cluster_mem_util_max": 0.298891032858291, "reward_consolidation_mean_mean": 2.7300000000000004, "reward_consolidation_mean_min": 2.402777777777778, "reward_consolidation_mean_max": 3.027777777777778, "reward_illegal_mean_mean": -0.08683333333333333, "reward_illegal_mean_min": -0.25, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.8617884999999998, "reward_accuracy_mean_min": 1.66885, "reward_accuracy_mean_max": 1.962533333333333, "reward_sla_mean_mean": -0.06995, "reward_sla_mean_min": -0.25055555555555553, "reward_sla_mean_max": -0.005, "reward_consolidation_sum_mean": 273.00000000000006, "reward_consolidation_sum_min": 240.2777777777778, "reward_consolidation_sum_max": 302.7777777777778, "reward_illegal_sum_mean": -8.683333333333332, "reward_illegal_sum_min": -25.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 186.17884999999998, "reward_accuracy_sum_min": 166.885, "reward_accuracy_sum_max": 196.2533333333333, "reward_sla_sum_mean": -6.995, "reward_sla_sum_min": -25.055555555555554, "reward_sla_sum_max": -0.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2130.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [410.51666666666637, 401.44777777777756, 443.02388888888845, 422.2861111111109, 390.33777777777755, 426.40555555555534, 418.9772222222221, 443.047222222222, 429.69777777777756, 409.48555555555515, 449.508333333333, 444.684444444444, 459.5566666666664, 422.04777777777747, 450.8649999999996, 435.85833333333295, 470.15777777777754, 445.4149999999997, 431.2861111111108, 437.6277777777774, 407.9777777777774, 418.4788888888885, 412.22277777777754, 430.59555555555534, 444.13722222222185, 449.86611111111085, 472.9427777777776, 428.76333333333275, 409.3488888888888, 423.4544444444443, 422.2949999999999, 460.42999999999967, 429.8416666666665, 422.91277777777736, 466.6188888888885, 454.08722222222195, 457.45999999999987, 430.6272222222221, 384.7738888888885, 419.8516666666664, 444.55555555555526, 434.62833333333305, 465.5466666666664, 450.27944444444404, 447.59444444444415, 451.2383333333329, 463.53944444444414, 391.62944444444406, 450.9211111111109, 449.58833333333314, 468.325, 443.96888888888844, 459.8027777777776, 457.88888888888835, 465.7611111111108, 468.08055555555524, 467.9616666666665, 443.5966666666663, 444.3961111111108, 423.82666666666637, 451.34944444444386, 453.0094444444441, 456.2461111111106, 440.53999999999974, 469.3722222222219, 438.63555555555513, 449.8094444444442, 455.8094444444442, 450.4699999999998, 459.30944444444435, 453.91166666666624, 445.9999999999999, 443.94833333333287, 464.92111111111075, 445.4849999999998, 454.6433333333329, 477.9994444444443, 486.3644444444441, 456.8333333333332, 481.5088888888885, 459.8411111111109, 442.59666666666635, 443.60333333333284, 453.2527777777774, 435.2872222222218, 442.98611111111063, 422.38277777777773, 446.18222222222204, 456.4522222222219, 462.77777777777754, 451.3499999999997, 448.25499999999965, 446.42111111111086, 429.1127777777775, 442.23888888888854, 449.47666666666623, 467.48499999999973, 454.41277777777753, 432.3244444444442, 445.39777777777743], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [410.51666666666637, 401.44777777777756, 443.02388888888845, 422.2861111111109, 390.33777777777755, 426.40555555555534, 418.9772222222221, 443.047222222222, 429.69777777777756, 409.48555555555515, 449.508333333333, 444.684444444444, 459.5566666666664, 422.04777777777747, 450.8649999999996, 435.85833333333295, 470.15777777777754, 445.4149999999997, 431.2861111111108, 437.6277777777774, 407.9777777777774, 418.4788888888885, 412.22277777777754, 430.59555555555534, 444.13722222222185, 449.86611111111085, 472.9427777777776, 428.76333333333275, 409.3488888888888, 423.4544444444443, 422.2949999999999, 460.42999999999967, 429.8416666666665, 422.91277777777736, 466.6188888888885, 454.08722222222195, 457.45999999999987, 430.6272222222221, 384.7738888888885, 419.8516666666664, 444.55555555555526, 434.62833333333305, 465.5466666666664, 450.27944444444404, 447.59444444444415, 451.2383333333329, 463.53944444444414, 391.62944444444406, 450.9211111111109, 449.58833333333314, 468.325, 443.96888888888844, 459.8027777777776, 457.88888888888835, 465.7611111111108, 468.08055555555524, 467.9616666666665, 443.5966666666663, 444.3961111111108, 423.82666666666637, 451.34944444444386, 453.0094444444441, 456.2461111111106, 440.53999999999974, 469.3722222222219, 438.63555555555513, 449.8094444444442, 455.8094444444442, 450.4699999999998, 459.30944444444435, 453.91166666666624, 445.9999999999999, 443.94833333333287, 464.92111111111075, 445.4849999999998, 454.6433333333329, 477.9994444444443, 486.3644444444441, 456.8333333333332, 481.5088888888885, 459.8411111111109, 442.59666666666635, 443.60333333333284, 453.2527777777774, 435.2872222222218, 442.98611111111063, 422.38277777777773, 446.18222222222204, 456.4522222222219, 462.77777777777754, 451.3499999999997, 448.25499999999965, 446.42111111111086, 429.1127777777775, 442.23888888888854, 449.47666666666623, 467.48499999999973, 454.41277777777753, 432.3244444444442, 445.39777777777743]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19719183808556018, "mean_inference_ms": 1.8015401902803825, "mean_action_processing_ms": 0.07496158589458389, "mean_env_wait_ms": 1.2208396597672844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042362213134765625, "StateBufferConnector_ms": 0.002912759780883789, "ViewRequirementAgentConnector_ms": 0.06525564193725586}, "num_episodes": 33, "episode_return_max": 486.3644444444441, "episode_return_min": 384.7738888888885, "episode_return_mean": 443.5005166666664, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 289800, "num_agent_steps_trained": 289500, "num_env_steps_sampled": 289800, "num_env_steps_trained": 289500, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 303.01422846508115, "num_env_steps_trained_throughput_per_sec": 288.58497949055345, "timesteps_total": 289800, "num_env_steps_sampled_lifetime": 289800, "num_agent_steps_sampled_lifetime": 289800, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 289800, "timers": {"training_iteration_time_ms": 10316.532, "restore_workers_time_ms": 0.01, "training_step_time_ms": 499.929, "sample_time_ms": 485.401, "synch_weights_time_ms": 13.149}, "counters": {"num_env_steps_sampled": 289800, "num_env_steps_trained": 289500, "num_agent_steps_sampled": 289800, "num_agent_steps_trained": 289500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1932, "num_samples_added_to_queue": 289800}, "done": false, "training_iteration": 97, "trial_id": "0313d_00000", "date": "2024-10-10_21-58-06", "timestamp": 1728593886, "time_this_iter_s": 10.405130863189697, "time_total_s": 998.8371942043304, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d885b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 998.8371942043304, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 10.385714285714286, "ram_util_percent": 68.56428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 186673.40625, "policy_loss": 186232.21875, "entropy": 14.53180980682373, "entropy_coeff": 0.01, "var_gnorm": 16.653993606567383, "vf_loss": 484773.59375, "vf_explained_var": -0.1794898509979248}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 975.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 292800, "num_env_steps_trained": 292500, "num_agent_steps_sampled": 292800, "num_agent_steps_trained": 292500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1952, "num_samples_added_to_queue": 292800, "learner_queue": {"size_count": 975, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.803, "learner_load_time_ms": 0.238, "learner_load_wait_time_ms": 959.635, "learner_dequeue_time_ms": 8489.473}}, "env_runners": {"episode_reward_max": 486.3644444444441, "episode_reward_min": 384.7738888888885, "episode_reward_mean": 448.54396666666645, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 384.7738888888885}, "policy_reward_max": {"default_policy": 486.3644444444441}, "policy_reward_mean": {"default_policy": 448.54396666666645}, "custom_metrics": {"num_consolidated_mean": 2.0928999999999998, "num_consolidated_min": 1.96, "num_consolidated_max": 2.23, "num_overloaded_mean": 0.04610000000000001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.15, "num_moves_mean": 5.0093, "num_moves_min": 4.47, "num_moves_max": 5.57, "mean_accuracy_mean": 39.27295999999998, "mean_accuracy_min": 39.111333333333306, "mean_accuracy_max": 39.43433333333331, "num_model_switches_mean": 1.9771999999999996, "num_model_switches_min": 1.65, "num_model_switches_max": 2.4, "num_slav_mean": 0.002117333333333333, "num_slav_min": 0.00015, "num_slav_max": 0.007533333333333333, "mean_cluster_cpu_util_mean": 0.4665349303211692, "mean_cluster_cpu_util_min": 0.4499788691547898, "mean_cluster_cpu_util_max": 0.4774495155734539, "mean_cluster_mem_util_mean": 0.29352076141500905, "mean_cluster_mem_util_min": 0.28694927882545423, "mean_cluster_mem_util_max": 0.29852340211401013, "reward_consolidation_mean_mean": 2.755833333333334, "reward_consolidation_mean_min": 2.402777777777778, "reward_consolidation_mean_max": 3.027777777777778, "reward_illegal_mean_mean": -0.07683333333333332, "reward_illegal_mean_min": -0.25, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.8731396666666662, "reward_accuracy_mean_min": 1.66885, "reward_accuracy_mean_max": 1.962533333333333, "reward_sla_mean_mean": -0.0667, "reward_sla_mean_min": -0.25055555555555553, "reward_sla_mean_max": -0.005, "reward_consolidation_sum_mean": 275.5833333333334, "reward_consolidation_sum_min": 240.2777777777778, "reward_consolidation_sum_max": 302.7777777777778, "reward_illegal_sum_mean": -7.683333333333332, "reward_illegal_sum_min": -25.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 187.3139666666666, "reward_accuracy_sum_min": 166.885, "reward_accuracy_sum_max": 196.2533333333333, "reward_sla_sum_mean": -6.67, "reward_sla_sum_min": -25.055555555555554, "reward_sla_sum_max": -0.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2367.0, "global_timestep_min": 300, "global_timestep_max": 4000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [422.2949999999999, 460.42999999999967, 429.8416666666665, 422.91277777777736, 466.6188888888885, 454.08722222222195, 457.45999999999987, 430.6272222222221, 384.7738888888885, 419.8516666666664, 444.55555555555526, 434.62833333333305, 465.5466666666664, 450.27944444444404, 447.59444444444415, 451.2383333333329, 463.53944444444414, 391.62944444444406, 450.9211111111109, 449.58833333333314, 468.325, 443.96888888888844, 459.8027777777776, 457.88888888888835, 465.7611111111108, 468.08055555555524, 467.9616666666665, 443.5966666666663, 444.3961111111108, 423.82666666666637, 451.34944444444386, 453.0094444444441, 456.2461111111106, 440.53999999999974, 469.3722222222219, 438.63555555555513, 449.8094444444442, 455.8094444444442, 450.4699999999998, 459.30944444444435, 453.91166666666624, 445.9999999999999, 443.94833333333287, 464.92111111111075, 445.4849999999998, 454.6433333333329, 477.9994444444443, 486.3644444444441, 456.8333333333332, 481.5088888888885, 459.8411111111109, 442.59666666666635, 443.60333333333284, 453.2527777777774, 435.2872222222218, 442.98611111111063, 422.38277777777773, 446.18222222222204, 456.4522222222219, 462.77777777777754, 451.3499999999997, 448.25499999999965, 446.42111111111086, 429.1127777777775, 442.23888888888854, 449.47666666666623, 467.48499999999973, 454.41277777777753, 432.3244444444442, 445.39777777777743, 423.83611111111077, 466.4427777777777, 438.8816666666663, 465.81888888888875, 436.9299999999999, 430.74777777777723, 437.45999999999964, 465.263333333333, 453.51722222222196, 425.46277777777743, 446.19111111111096, 432.48555555555527, 475.6338888888885, 418.6938888888885, 453.167222222222, 456.7072222222221, 428.644444444444, 459.103333333333, 436.82611111111066, 466.7461111111108, 455.1749999999997, 458.95277777777744, 464.61888888888853, 451.66666666666634, 469.8094444444441, 465.722222222222, 448.98444444444414, 431.66833333333295, 420.8116666666664, 458.3966666666664], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [422.2949999999999, 460.42999999999967, 429.8416666666665, 422.91277777777736, 466.6188888888885, 454.08722222222195, 457.45999999999987, 430.6272222222221, 384.7738888888885, 419.8516666666664, 444.55555555555526, 434.62833333333305, 465.5466666666664, 450.27944444444404, 447.59444444444415, 451.2383333333329, 463.53944444444414, 391.62944444444406, 450.9211111111109, 449.58833333333314, 468.325, 443.96888888888844, 459.8027777777776, 457.88888888888835, 465.7611111111108, 468.08055555555524, 467.9616666666665, 443.5966666666663, 444.3961111111108, 423.82666666666637, 451.34944444444386, 453.0094444444441, 456.2461111111106, 440.53999999999974, 469.3722222222219, 438.63555555555513, 449.8094444444442, 455.8094444444442, 450.4699999999998, 459.30944444444435, 453.91166666666624, 445.9999999999999, 443.94833333333287, 464.92111111111075, 445.4849999999998, 454.6433333333329, 477.9994444444443, 486.3644444444441, 456.8333333333332, 481.5088888888885, 459.8411111111109, 442.59666666666635, 443.60333333333284, 453.2527777777774, 435.2872222222218, 442.98611111111063, 422.38277777777773, 446.18222222222204, 456.4522222222219, 462.77777777777754, 451.3499999999997, 448.25499999999965, 446.42111111111086, 429.1127777777775, 442.23888888888854, 449.47666666666623, 467.48499999999973, 454.41277777777753, 432.3244444444442, 445.39777777777743, 423.83611111111077, 466.4427777777777, 438.8816666666663, 465.81888888888875, 436.9299999999999, 430.74777777777723, 437.45999999999964, 465.263333333333, 453.51722222222196, 425.46277777777743, 446.19111111111096, 432.48555555555527, 475.6338888888885, 418.6938888888885, 453.167222222222, 456.7072222222221, 428.644444444444, 459.103333333333, 436.82611111111066, 466.7461111111108, 455.1749999999997, 458.95277777777744, 464.61888888888853, 451.66666666666634, 469.8094444444441, 465.722222222222, 448.98444444444414, 431.66833333333295, 420.8116666666664, 458.3966666666664]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1971968544493735, "mean_inference_ms": 1.8027349876580536, "mean_action_processing_ms": 0.07496546586343751, "mean_env_wait_ms": 1.2210144919918824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040740966796875, "StateBufferConnector_ms": 0.0028645992279052734, "ViewRequirementAgentConnector_ms": 0.0640723705291748}, "num_episodes": 30, "episode_return_max": 486.3644444444441, "episode_return_min": 384.7738888888885, "episode_return_mean": 448.54396666666645, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292800, "num_agent_steps_trained": 292500, "num_env_steps_sampled": 292800, "num_env_steps_trained": 292500, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 297.3028210249073, "num_env_steps_trained_throughput_per_sec": 297.3028210249073, "timesteps_total": 292800, "num_env_steps_sampled_lifetime": 292800, "num_agent_steps_sampled_lifetime": 292800, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 292800, "timers": {"training_iteration_time_ms": 10268.176, "restore_workers_time_ms": 0.011, "training_step_time_ms": 499.82, "sample_time_ms": 486.515, "synch_weights_time_ms": 11.916}, "counters": {"num_env_steps_sampled": 292800, "num_env_steps_trained": 292500, "num_agent_steps_sampled": 292800, "num_agent_steps_trained": 292500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1952, "num_samples_added_to_queue": 292800}, "done": false, "training_iteration": 98, "trial_id": "0313d_00000", "date": "2024-10-10_21-58-16", "timestamp": 1728593896, "time_this_iter_s": 10.104219198226929, "time_total_s": 1008.9414134025574, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d88b50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1008.9414134025574, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 10.646666666666668, "ram_util_percent": 68.57333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 195988.71875, "policy_loss": 195516.75, "entropy": 14.734819412231445, "entropy_coeff": 0.01, "var_gnorm": 16.650089263916016, "vf_loss": 516178.46875, "vf_explained_var": -0.15243911743164062}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 985.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 295800, "num_env_steps_trained": 295500, "num_agent_steps_sampled": 295800, "num_agent_steps_trained": 295500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1972, "num_samples_added_to_queue": 295800, "learner_queue": {"size_count": 985, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.045, "learner_load_time_ms": 0.197, "learner_load_wait_time_ms": 972.271, "learner_dequeue_time_ms": 8546.959}}, "env_runners": {"episode_reward_max": 486.3644444444441, "episode_reward_min": 414.1522222222219, "episode_reward_mean": 448.27126666666635, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 414.1522222222219}, "policy_reward_max": {"default_policy": 486.3644444444441}, "policy_reward_mean": {"default_policy": 448.27126666666635}, "custom_metrics": {"num_consolidated_mean": 2.0722000000000005, "num_consolidated_min": 1.87, "num_consolidated_max": 2.23, "num_overloaded_mean": 0.0425, "num_overloaded_min": 0.0, "num_overloaded_max": 0.09, "num_moves_mean": 4.9954, "num_moves_min": 4.47, "num_moves_max": 5.57, "mean_accuracy_mean": 39.26092666666665, "mean_accuracy_min": 39.111333333333306, "mean_accuracy_max": 39.43433333333331, "num_model_switches_mean": 2.0184, "num_model_switches_min": 1.65, "num_model_switches_max": 2.4, "num_slav_mean": 0.002224166666666667, "num_slav_min": 0.0002, "num_slav_max": 0.007533333333333333, "mean_cluster_cpu_util_mean": 0.46370457323284997, "mean_cluster_cpu_util_min": 0.44921427201131825, "mean_cluster_cpu_util_max": 0.4774495155734539, "mean_cluster_mem_util_mean": 0.29264708478285834, "mean_cluster_mem_util_min": 0.2864442047705158, "mean_cluster_mem_util_max": 0.29852340211401013, "reward_consolidation_mean_mean": 2.7438888888888884, "reward_consolidation_mean_min": 2.4722222222222228, "reward_consolidation_mean_max": 3.027777777777778, "reward_illegal_mean_mean": -0.07083333333333332, "reward_illegal_mean_min": -0.15, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.8794293333333332, "reward_accuracy_mean_min": 1.7839166666666662, "reward_accuracy_mean_max": 1.962533333333333, "reward_sla_mean_mean": -0.06977222222222222, "reward_sla_mean_min": -0.25055555555555553, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 274.3888888888889, "reward_consolidation_sum_min": 247.22222222222226, "reward_consolidation_sum_max": 302.7777777777778, "reward_illegal_sum_mean": -7.083333333333334, "reward_illegal_sum_min": -15.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 187.94293333333334, "reward_accuracy_sum_min": 178.39166666666662, "reward_accuracy_sum_max": 196.2533333333333, "reward_sla_sum_mean": -6.977222222222223, "reward_sla_sum_min": -25.055555555555554, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3367.0, "global_timestep_min": 1300, "global_timestep_max": 5000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [451.34944444444386, 453.0094444444441, 456.2461111111106, 440.53999999999974, 469.3722222222219, 438.63555555555513, 449.8094444444442, 455.8094444444442, 450.4699999999998, 459.30944444444435, 453.91166666666624, 445.9999999999999, 443.94833333333287, 464.92111111111075, 445.4849999999998, 454.6433333333329, 477.9994444444443, 486.3644444444441, 456.8333333333332, 481.5088888888885, 459.8411111111109, 442.59666666666635, 443.60333333333284, 453.2527777777774, 435.2872222222218, 442.98611111111063, 422.38277777777773, 446.18222222222204, 456.4522222222219, 462.77777777777754, 451.3499999999997, 448.25499999999965, 446.42111111111086, 429.1127777777775, 442.23888888888854, 449.47666666666623, 467.48499999999973, 454.41277777777753, 432.3244444444442, 445.39777777777743, 423.83611111111077, 466.4427777777777, 438.8816666666663, 465.81888888888875, 436.9299999999999, 430.74777777777723, 437.45999999999964, 465.263333333333, 453.51722222222196, 425.46277777777743, 446.19111111111096, 432.48555555555527, 475.6338888888885, 418.6938888888885, 453.167222222222, 456.7072222222221, 428.644444444444, 459.103333333333, 436.82611111111066, 466.7461111111108, 455.1749999999997, 458.95277777777744, 464.61888888888853, 451.66666666666634, 469.8094444444441, 465.722222222222, 448.98444444444414, 431.66833333333295, 420.8116666666664, 458.3966666666664, 446.80999999999966, 435.1916666666664, 446.17499999999944, 470.9772222222218, 419.4366666666664, 437.2705555555553, 426.6283333333328, 449.4772222222222, 461.7872222222219, 445.9777777777774, 467.97666666666646, 427.05611111111114, 442.413333333333, 414.1522222222219, 446.4777777777773, 451.7699999999995, 418.6522222222219, 445.32555555555524, 435.27055555555523, 436.9383333333331, 441.15277777777743, 482.2299999999995, 463.6188888888884, 443.3505555555553, 454.3494444444441, 428.59611111111076, 459.9049999999996, 426.342222222222, 441.4066666666663, 448.04166666666634], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [451.34944444444386, 453.0094444444441, 456.2461111111106, 440.53999999999974, 469.3722222222219, 438.63555555555513, 449.8094444444442, 455.8094444444442, 450.4699999999998, 459.30944444444435, 453.91166666666624, 445.9999999999999, 443.94833333333287, 464.92111111111075, 445.4849999999998, 454.6433333333329, 477.9994444444443, 486.3644444444441, 456.8333333333332, 481.5088888888885, 459.8411111111109, 442.59666666666635, 443.60333333333284, 453.2527777777774, 435.2872222222218, 442.98611111111063, 422.38277777777773, 446.18222222222204, 456.4522222222219, 462.77777777777754, 451.3499999999997, 448.25499999999965, 446.42111111111086, 429.1127777777775, 442.23888888888854, 449.47666666666623, 467.48499999999973, 454.41277777777753, 432.3244444444442, 445.39777777777743, 423.83611111111077, 466.4427777777777, 438.8816666666663, 465.81888888888875, 436.9299999999999, 430.74777777777723, 437.45999999999964, 465.263333333333, 453.51722222222196, 425.46277777777743, 446.19111111111096, 432.48555555555527, 475.6338888888885, 418.6938888888885, 453.167222222222, 456.7072222222221, 428.644444444444, 459.103333333333, 436.82611111111066, 466.7461111111108, 455.1749999999997, 458.95277777777744, 464.61888888888853, 451.66666666666634, 469.8094444444441, 465.722222222222, 448.98444444444414, 431.66833333333295, 420.8116666666664, 458.3966666666664, 446.80999999999966, 435.1916666666664, 446.17499999999944, 470.9772222222218, 419.4366666666664, 437.2705555555553, 426.6283333333328, 449.4772222222222, 461.7872222222219, 445.9777777777774, 467.97666666666646, 427.05611111111114, 442.413333333333, 414.1522222222219, 446.4777777777773, 451.7699999999995, 418.6522222222219, 445.32555555555524, 435.27055555555523, 436.9383333333331, 441.15277777777743, 482.2299999999995, 463.6188888888884, 443.3505555555553, 454.3494444444441, 428.59611111111076, 459.9049999999996, 426.342222222222, 441.4066666666663, 448.04166666666634]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19715232110473882, "mean_inference_ms": 1.802272729798495, "mean_action_processing_ms": 0.07494492167062626, "mean_env_wait_ms": 1.2207569970593561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004002571105957031, "StateBufferConnector_ms": 0.0028252601623535156, "ViewRequirementAgentConnector_ms": 0.06328392028808594}, "num_episodes": 30, "episode_return_max": 486.3644444444441, "episode_return_min": 414.1522222222219, "episode_return_mean": 448.27126666666635, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 295800, "num_agent_steps_trained": 295500, "num_env_steps_sampled": 295800, "num_env_steps_trained": 295500, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 292.2057704993837, "num_env_steps_trained_throughput_per_sec": 292.2057704993837, "timesteps_total": 295800, "num_env_steps_sampled_lifetime": 295800, "num_agent_steps_sampled_lifetime": 295800, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 295800, "timers": {"training_iteration_time_ms": 10278.135, "restore_workers_time_ms": 0.012, "training_step_time_ms": 521.977, "sample_time_ms": 506.154, "synch_weights_time_ms": 14.262}, "counters": {"num_env_steps_sampled": 295800, "num_env_steps_trained": 295500, "num_agent_steps_sampled": 295800, "num_agent_steps_trained": 295500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1972, "num_samples_added_to_queue": 295800}, "done": false, "training_iteration": 99, "trial_id": "0313d_00000", "date": "2024-10-10_21-58-26", "timestamp": 1728593906, "time_this_iter_s": 10.283557891845703, "time_total_s": 1019.2249712944031, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c2b490>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1019.2249712944031, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 11.253333333333332, "ram_util_percent": 68.92666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 182683.6875, "policy_loss": 182291.125, "entropy": 15.328611373901367, "entropy_coeff": 0.01, "var_gnorm": 16.63813591003418, "vf_loss": 438544.71875, "vf_explained_var": -0.15764915943145752}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 995.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 298650, "num_env_steps_trained": 298500, "num_agent_steps_sampled": 298650, "num_agent_steps_trained": 298500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1991, "num_samples_added_to_queue": 298500, "learner_queue": {"size_count": 995, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.972, "learner_load_time_ms": 0.203, "learner_load_wait_time_ms": 1009.684, "learner_dequeue_time_ms": 8468.918}}, "env_runners": {"episode_reward_max": 482.2299999999995, "episode_reward_min": 409.2399999999996, "episode_reward_mean": 444.4515999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 409.2399999999996}, "policy_reward_max": {"default_policy": 482.2299999999995}, "policy_reward_mean": {"default_policy": 444.4515999999998}, "custom_metrics": {"num_consolidated_mean": 2.0412999999999992, "num_consolidated_min": 1.87, "num_consolidated_max": 2.23, "num_overloaded_mean": 0.04170000000000001, "num_overloaded_min": 0.01, "num_overloaded_max": 0.09, "num_moves_mean": 5.001900000000001, "num_moves_min": 4.46, "num_moves_max": 5.57, "mean_accuracy_mean": 39.23774666666665, "mean_accuracy_min": 39.06699999999998, "mean_accuracy_max": 39.43433333333331, "num_model_switches_mean": 2.0785, "num_model_switches_min": 1.72, "num_model_switches_max": 2.53, "num_slav_mean": 0.0022281666666666665, "num_slav_min": 0.00015, "num_slav_max": 0.007533333333333333, "mean_cluster_cpu_util_mean": 0.4601618136871836, "mean_cluster_cpu_util_min": 0.4472258921932798, "mean_cluster_cpu_util_max": 0.4774495155734539, "mean_cluster_mem_util_mean": 0.29167313293830194, "mean_cluster_mem_util_min": 0.286295674208502, "mean_cluster_mem_util_max": 0.29852340211401013, "reward_consolidation_mean_mean": 2.7048611111111116, "reward_consolidation_mean_min": 2.4444444444444446, "reward_consolidation_mean_max": 2.944444444444445, "reward_illegal_mean_mean": -0.06949999999999999, "reward_illegal_mean_min": -0.15, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 1.8798826666666664, "reward_accuracy_mean_min": 1.7839166666666662, "reward_accuracy_mean_max": 1.945783333333333, "reward_sla_mean_mean": -0.07072777777777778, "reward_sla_mean_min": -0.25055555555555553, "reward_sla_mean_max": -0.005, "reward_consolidation_sum_mean": 270.48611111111114, "reward_consolidation_sum_min": 244.44444444444446, "reward_consolidation_sum_max": 294.4444444444445, "reward_illegal_sum_mean": -6.95, "reward_illegal_sum_min": -15.0, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 187.98826666666668, "reward_accuracy_sum_min": 178.39166666666662, "reward_accuracy_sum_max": 194.5783333333333, "reward_sla_sum_mean": -7.0727777777777785, "reward_sla_sum_min": -25.055555555555554, "reward_sla_sum_max": -0.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4249.0, "global_timestep_min": 2000, "global_timestep_max": 5900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [446.18222222222204, 456.4522222222219, 462.77777777777754, 451.3499999999997, 448.25499999999965, 446.42111111111086, 429.1127777777775, 442.23888888888854, 449.47666666666623, 467.48499999999973, 454.41277777777753, 432.3244444444442, 445.39777777777743, 423.83611111111077, 466.4427777777777, 438.8816666666663, 465.81888888888875, 436.9299999999999, 430.74777777777723, 437.45999999999964, 465.263333333333, 453.51722222222196, 425.46277777777743, 446.19111111111096, 432.48555555555527, 475.6338888888885, 418.6938888888885, 453.167222222222, 456.7072222222221, 428.644444444444, 459.103333333333, 436.82611111111066, 466.7461111111108, 455.1749999999997, 458.95277777777744, 464.61888888888853, 451.66666666666634, 469.8094444444441, 465.722222222222, 448.98444444444414, 431.66833333333295, 420.8116666666664, 458.3966666666664, 446.80999999999966, 435.1916666666664, 446.17499999999944, 470.9772222222218, 419.4366666666664, 437.2705555555553, 426.6283333333328, 449.4772222222222, 461.7872222222219, 445.9777777777774, 467.97666666666646, 427.05611111111114, 442.413333333333, 414.1522222222219, 446.4777777777773, 451.7699999999995, 418.6522222222219, 445.32555555555524, 435.27055555555523, 436.9383333333331, 441.15277777777743, 482.2299999999995, 463.6188888888884, 443.3505555555553, 454.3494444444441, 428.59611111111076, 459.9049999999996, 426.342222222222, 441.4066666666663, 448.04166666666634, 446.7244444444441, 437.79555555555515, 431.7705555555551, 448.8288888888888, 452.2944444444442, 409.2399999999996, 418.6061111111108, 429.98611111111074, 424.3199999999996, 453.80999999999983, 460.50888888888863, 421.0338888888885, 448.3577777777774, 450.588333333333, 438.3738888888886, 450.8088888888886, 433.4616666666665, 424.0344444444442, 439.50888888888846, 459.961111111111, 467.0094444444442, 418.62833333333316, 429.2561111111107, 447.12777777777717, 437.86722222222176, 431.20833333333286, 443.03888888888844], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [446.18222222222204, 456.4522222222219, 462.77777777777754, 451.3499999999997, 448.25499999999965, 446.42111111111086, 429.1127777777775, 442.23888888888854, 449.47666666666623, 467.48499999999973, 454.41277777777753, 432.3244444444442, 445.39777777777743, 423.83611111111077, 466.4427777777777, 438.8816666666663, 465.81888888888875, 436.9299999999999, 430.74777777777723, 437.45999999999964, 465.263333333333, 453.51722222222196, 425.46277777777743, 446.19111111111096, 432.48555555555527, 475.6338888888885, 418.6938888888885, 453.167222222222, 456.7072222222221, 428.644444444444, 459.103333333333, 436.82611111111066, 466.7461111111108, 455.1749999999997, 458.95277777777744, 464.61888888888853, 451.66666666666634, 469.8094444444441, 465.722222222222, 448.98444444444414, 431.66833333333295, 420.8116666666664, 458.3966666666664, 446.80999999999966, 435.1916666666664, 446.17499999999944, 470.9772222222218, 419.4366666666664, 437.2705555555553, 426.6283333333328, 449.4772222222222, 461.7872222222219, 445.9777777777774, 467.97666666666646, 427.05611111111114, 442.413333333333, 414.1522222222219, 446.4777777777773, 451.7699999999995, 418.6522222222219, 445.32555555555524, 435.27055555555523, 436.9383333333331, 441.15277777777743, 482.2299999999995, 463.6188888888884, 443.3505555555553, 454.3494444444441, 428.59611111111076, 459.9049999999996, 426.342222222222, 441.4066666666663, 448.04166666666634, 446.7244444444441, 437.79555555555515, 431.7705555555551, 448.8288888888888, 452.2944444444442, 409.2399999999996, 418.6061111111108, 429.98611111111074, 424.3199999999996, 453.80999999999983, 460.50888888888863, 421.0338888888885, 448.3577777777774, 450.588333333333, 438.3738888888886, 450.8088888888886, 433.4616666666665, 424.0344444444442, 439.50888888888846, 459.961111111111, 467.0094444444442, 418.62833333333316, 429.2561111111107, 447.12777777777717, 437.86722222222176, 431.20833333333286, 443.03888888888844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19707209054731925, "mean_inference_ms": 1.7991760794329605, "mean_action_processing_ms": 0.07490597797706236, "mean_env_wait_ms": 1.2200752966812398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004129171371459961, "StateBufferConnector_ms": 0.0028574466705322266, "ViewRequirementAgentConnector_ms": 0.06435275077819824}, "num_episodes": 27, "episode_return_max": 482.2299999999995, "episode_return_min": 409.2399999999996, "episode_return_mean": 444.4515999999998, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 298650, "num_agent_steps_trained": 298500, "num_env_steps_sampled": 298650, "num_env_steps_trained": 298500, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 276.6498305191597, "num_env_steps_trained_throughput_per_sec": 291.21034791490496, "timesteps_total": 298650, "num_env_steps_sampled_lifetime": 298650, "num_agent_steps_sampled_lifetime": 298650, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 298650, "timers": {"training_iteration_time_ms": 10265.151, "restore_workers_time_ms": 0.013, "training_step_time_ms": 547.947, "sample_time_ms": 531.885, "synch_weights_time_ms": 14.652}, "counters": {"num_env_steps_sampled": 298650, "num_env_steps_trained": 298500, "num_agent_steps_sampled": 298650, "num_agent_steps_trained": 298500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1991, "num_samples_added_to_queue": 298500}, "done": false, "training_iteration": 100, "trial_id": "0313d_00000", "date": "2024-10-10_21-58-37", "timestamp": 1728593917, "time_this_iter_s": 10.316128969192505, "time_total_s": 1029.5411002635956, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d8b460>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1029.5411002635956, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 12.671428571428573, "ram_util_percent": 69.22857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 194448.28125, "policy_loss": 194048.15625, "entropy": 15.638968467712402, "entropy_coeff": 0.01, "var_gnorm": 16.633291244506836, "vf_loss": 447044.15625, "vf_explained_var": -0.13399648666381836}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1004.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 301500, "num_env_steps_trained": 301200, "num_agent_steps_sampled": 301500, "num_agent_steps_trained": 301200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2010, "num_samples_added_to_queue": 301500, "learner_queue": {"size_count": 1004, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.81, "learner_load_time_ms": 0.201, "learner_load_wait_time_ms": 1034.533, "learner_dequeue_time_ms": 8445.545}}, "env_runners": {"episode_reward_max": 482.2299999999995, "episode_reward_min": 403.4383333333332, "episode_reward_mean": 441.80773888888865, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 403.4383333333332}, "policy_reward_max": {"default_policy": 482.2299999999995}, "policy_reward_mean": {"default_policy": 441.80773888888865}, "custom_metrics": {"num_consolidated_mean": 2.0084, "num_consolidated_min": 1.87, "num_consolidated_max": 2.2, "num_overloaded_mean": 0.0385, "num_overloaded_min": 0.0, "num_overloaded_max": 0.09, "num_moves_mean": 5.0648, "num_moves_min": 4.46, "num_moves_max": 5.56, "mean_accuracy_mean": 39.22108999999998, "mean_accuracy_min": 39.06699999999998, "mean_accuracy_max": 39.38366666666664, "num_model_switches_mean": 2.174, "num_model_switches_min": 1.72, "num_model_switches_max": 2.81, "num_slav_mean": 0.0023901666666666667, "num_slav_min": 0.00015, "num_slav_max": 0.006033333333333332, "mean_cluster_cpu_util_mean": 0.456851825345691, "mean_cluster_cpu_util_min": 0.44666919689893186, "mean_cluster_cpu_util_max": 0.4718721673498205, "mean_cluster_mem_util_mean": 0.2908324960819771, "mean_cluster_mem_util_min": 0.286295674208502, "mean_cluster_mem_util_max": 0.29612071116421257, "reward_consolidation_mean_mean": 2.6730555555555555, "reward_consolidation_mean_min": 2.4444444444444446, "reward_consolidation_mean_max": 2.944444444444445, "reward_illegal_mean_mean": -0.06416666666666665, "reward_illegal_mean_min": -0.15, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.8853218333333333, "reward_accuracy_mean_min": 1.804783333333333, "reward_accuracy_mean_max": 1.9580999999999995, "reward_sla_mean_mean": -0.07613333333333333, "reward_sla_mean_min": -0.20055555555555554, "reward_sla_mean_max": -0.005, "reward_consolidation_sum_mean": 267.30555555555554, "reward_consolidation_sum_min": 244.44444444444446, "reward_consolidation_sum_max": 294.4444444444445, "reward_illegal_sum_mean": -6.416666666666668, "reward_illegal_sum_min": -14.999999999999998, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 188.53218333333328, "reward_accuracy_sum_min": 180.4783333333333, "reward_accuracy_sum_max": 195.80999999999995, "reward_sla_sum_mean": -7.613333333333332, "reward_sla_sum_min": -20.055555555555554, "reward_sla_sum_max": -0.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5257.0, "global_timestep_min": 3100, "global_timestep_max": 6900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [459.103333333333, 436.82611111111066, 466.7461111111108, 455.1749999999997, 458.95277777777744, 464.61888888888853, 451.66666666666634, 469.8094444444441, 465.722222222222, 448.98444444444414, 431.66833333333295, 420.8116666666664, 458.3966666666664, 446.80999999999966, 435.1916666666664, 446.17499999999944, 470.9772222222218, 419.4366666666664, 437.2705555555553, 426.6283333333328, 449.4772222222222, 461.7872222222219, 445.9777777777774, 467.97666666666646, 427.05611111111114, 442.413333333333, 414.1522222222219, 446.4777777777773, 451.7699999999995, 418.6522222222219, 445.32555555555524, 435.27055555555523, 436.9383333333331, 441.15277777777743, 482.2299999999995, 463.6188888888884, 443.3505555555553, 454.3494444444441, 428.59611111111076, 459.9049999999996, 426.342222222222, 441.4066666666663, 448.04166666666634, 446.7244444444441, 437.79555555555515, 431.7705555555551, 448.8288888888888, 452.2944444444442, 409.2399999999996, 418.6061111111108, 429.98611111111074, 424.3199999999996, 453.80999999999983, 460.50888888888863, 421.0338888888885, 448.3577777777774, 450.588333333333, 438.3738888888886, 450.8088888888886, 433.4616666666665, 424.0344444444442, 439.50888888888846, 459.961111111111, 467.0094444444442, 418.62833333333316, 429.2561111111107, 447.12777777777717, 437.86722222222176, 431.20833333333286, 443.03888888888844, 453.78666666666635, 464.5322222222219, 432.6766666666663, 419.96999999999974, 456.1261111111108, 448.2316666666663, 427.1516666666665, 452.61055555555504, 424.0011111111107, 403.4383333333332, 448.0238888888888, 441.62722222222203, 426.263333333333, 445.1838888888886, 461.0394444444441, 423.01611111111083, 422.8761111111108, 444.9772222222219, 421.6938888888888, 453.7627777777775, 427.2161111111107, 425.707222222222, 432.6688888888885, 440.5727777777774, 451.2472222222218, 432.8899999999996, 444.9144444444439, 438.19333333333304, 409.25333333333305, 449.73222222222176], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [459.103333333333, 436.82611111111066, 466.7461111111108, 455.1749999999997, 458.95277777777744, 464.61888888888853, 451.66666666666634, 469.8094444444441, 465.722222222222, 448.98444444444414, 431.66833333333295, 420.8116666666664, 458.3966666666664, 446.80999999999966, 435.1916666666664, 446.17499999999944, 470.9772222222218, 419.4366666666664, 437.2705555555553, 426.6283333333328, 449.4772222222222, 461.7872222222219, 445.9777777777774, 467.97666666666646, 427.05611111111114, 442.413333333333, 414.1522222222219, 446.4777777777773, 451.7699999999995, 418.6522222222219, 445.32555555555524, 435.27055555555523, 436.9383333333331, 441.15277777777743, 482.2299999999995, 463.6188888888884, 443.3505555555553, 454.3494444444441, 428.59611111111076, 459.9049999999996, 426.342222222222, 441.4066666666663, 448.04166666666634, 446.7244444444441, 437.79555555555515, 431.7705555555551, 448.8288888888888, 452.2944444444442, 409.2399999999996, 418.6061111111108, 429.98611111111074, 424.3199999999996, 453.80999999999983, 460.50888888888863, 421.0338888888885, 448.3577777777774, 450.588333333333, 438.3738888888886, 450.8088888888886, 433.4616666666665, 424.0344444444442, 439.50888888888846, 459.961111111111, 467.0094444444442, 418.62833333333316, 429.2561111111107, 447.12777777777717, 437.86722222222176, 431.20833333333286, 443.03888888888844, 453.78666666666635, 464.5322222222219, 432.6766666666663, 419.96999999999974, 456.1261111111108, 448.2316666666663, 427.1516666666665, 452.61055555555504, 424.0011111111107, 403.4383333333332, 448.0238888888888, 441.62722222222203, 426.263333333333, 445.1838888888886, 461.0394444444441, 423.01611111111083, 422.8761111111108, 444.9772222222219, 421.6938888888888, 453.7627777777775, 427.2161111111107, 425.707222222222, 432.6688888888885, 440.5727777777774, 451.2472222222218, 432.8899999999996, 444.9144444444439, 438.19333333333304, 409.25333333333305, 449.73222222222176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19711560293613356, "mean_inference_ms": 1.7996571498814569, "mean_action_processing_ms": 0.07492170759213913, "mean_env_wait_ms": 1.2203113892483897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00455164909362793, "StateBufferConnector_ms": 0.002923727035522461, "ViewRequirementAgentConnector_ms": 0.06611061096191406}, "num_episodes": 30, "episode_return_max": 482.2299999999995, "episode_return_min": 403.4383333333332, "episode_return_mean": 441.80773888888865, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 301500, "num_agent_steps_trained": 301200, "num_env_steps_sampled": 301500, "num_env_steps_trained": 301200, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 279.1413058931024, "num_env_steps_trained_throughput_per_sec": 264.4496582145181, "timesteps_total": 301500, "num_env_steps_sampled_lifetime": 301500, "num_agent_steps_sampled_lifetime": 301500, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 301500, "timers": {"training_iteration_time_ms": 10234.816, "restore_workers_time_ms": 0.012, "training_step_time_ms": 531.588, "sample_time_ms": 517.722, "synch_weights_time_ms": 12.566}, "counters": {"num_env_steps_sampled": 301500, "num_env_steps_trained": 301200, "num_agent_steps_sampled": 301500, "num_agent_steps_trained": 301200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2010, "num_samples_added_to_queue": 301500}, "done": false, "training_iteration": 101, "trial_id": "0313d_00000", "date": "2024-10-10_21-58-47", "timestamp": 1728593927, "time_this_iter_s": 10.21957516670227, "time_total_s": 1039.7606754302979, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c19330>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1039.7606754302979, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 12.946666666666665, "ram_util_percent": 69.49333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 191260.359375, "policy_loss": 190809.6875, "entropy": 15.56981086730957, "entropy_coeff": 0.01, "var_gnorm": 16.63517189025879, "vf_loss": 497367.46875, "vf_explained_var": -0.1202620267868042}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1014.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 304500, "num_env_steps_trained": 304200, "num_agent_steps_sampled": 304500, "num_agent_steps_trained": 304200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2030, "num_samples_added_to_queue": 304500, "learner_queue": {"size_count": 1014, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.228, "learner_load_time_ms": 0.205, "learner_load_wait_time_ms": 992.051, "learner_dequeue_time_ms": 8372.775}}, "env_runners": {"episode_reward_max": 482.2299999999995, "episode_reward_min": 403.4383333333332, "episode_reward_mean": 440.9335611111108, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 403.4383333333332}, "policy_reward_max": {"default_policy": 482.2299999999995}, "policy_reward_mean": {"default_policy": 440.9335611111108}, "custom_metrics": {"num_consolidated_mean": 1.9957999999999998, "num_consolidated_min": 1.86, "num_consolidated_max": 2.13, "num_overloaded_mean": 0.0364, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 5.1323, "num_moves_min": 4.46, "num_moves_max": 5.67, "mean_accuracy_mean": 39.209563333333314, "mean_accuracy_min": 39.06699999999998, "mean_accuracy_max": 39.38366666666664, "num_model_switches_mean": 2.2798, "num_model_switches_min": 1.77, "num_model_switches_max": 2.81, "num_slav_mean": 0.002485, "num_slav_min": 0.00015, "num_slav_max": 0.006033333333333332, "mean_cluster_cpu_util_mean": 0.4549308523120476, "mean_cluster_cpu_util_min": 0.44451274788290185, "mean_cluster_cpu_util_max": 0.4658002561261166, "mean_cluster_mem_util_mean": 0.2903140674154683, "mean_cluster_mem_util_min": 0.286295674208502, "mean_cluster_mem_util_max": 0.2947523766468613, "reward_consolidation_mean_mean": 2.6612500000000012, "reward_consolidation_mean_min": 2.4444444444444446, "reward_consolidation_mean_max": 2.930555555555556, "reward_illegal_mean_mean": -0.060666666666666653, "reward_illegal_mean_min": -0.11666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.8888744999999993, "reward_accuracy_mean_min": 1.8199499999999997, "reward_accuracy_mean_max": 1.9580999999999995, "reward_sla_mean_mean": -0.0801222222222222, "reward_sla_mean_min": -0.20055555555555554, "reward_sla_mean_max": -0.005, "reward_consolidation_sum_mean": 266.12500000000006, "reward_consolidation_sum_min": 244.44444444444446, "reward_consolidation_sum_max": 293.0555555555556, "reward_illegal_sum_mean": -6.066666666666666, "reward_illegal_sum_min": -11.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 188.88745, "reward_accuracy_sum_min": 181.99499999999998, "reward_accuracy_sum_max": 195.80999999999995, "reward_sla_sum_mean": -8.012222222222222, "reward_sla_sum_min": -20.055555555555554, "reward_sla_sum_max": -0.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6023.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [445.32555555555524, 435.27055555555523, 436.9383333333331, 441.15277777777743, 482.2299999999995, 463.6188888888884, 443.3505555555553, 454.3494444444441, 428.59611111111076, 459.9049999999996, 426.342222222222, 441.4066666666663, 448.04166666666634, 446.7244444444441, 437.79555555555515, 431.7705555555551, 448.8288888888888, 452.2944444444442, 409.2399999999996, 418.6061111111108, 429.98611111111074, 424.3199999999996, 453.80999999999983, 460.50888888888863, 421.0338888888885, 448.3577777777774, 450.588333333333, 438.3738888888886, 450.8088888888886, 433.4616666666665, 424.0344444444442, 439.50888888888846, 459.961111111111, 467.0094444444442, 418.62833333333316, 429.2561111111107, 447.12777777777717, 437.86722222222176, 431.20833333333286, 443.03888888888844, 453.78666666666635, 464.5322222222219, 432.6766666666663, 419.96999999999974, 456.1261111111108, 448.2316666666663, 427.1516666666665, 452.61055555555504, 424.0011111111107, 403.4383333333332, 448.0238888888888, 441.62722222222203, 426.263333333333, 445.1838888888886, 461.0394444444441, 423.01611111111083, 422.8761111111108, 444.9772222222219, 421.6938888888888, 453.7627777777775, 427.2161111111107, 425.707222222222, 432.6688888888885, 440.5727777777774, 451.2472222222218, 432.8899999999996, 444.9144444444439, 438.19333333333304, 409.25333333333305, 449.73222222222176, 415.6677777777775, 458.8811111111107, 421.46944444444415, 440.2155555555551, 461.9522222222218, 447.45333333333303, 434.5561111111112, 432.62888888888864, 455.1122222222217, 425.67499999999967, 451.15166666666624, 431.46944444444426, 440.6755555555553, 440.0249999999996, 444.1511111111107, 447.18333333333305, 442.08833333333314, 432.54055555555516, 467.565555555555, 447.9766666666662, 449.48333333333295, 449.1366666666662, 452.25444444444423, 453.64444444444433, 458.3811111111107, 438.73833333333283, 438.0866666666665, 428.3499999999996, 451.65888888888844, 451.1211111111108], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [445.32555555555524, 435.27055555555523, 436.9383333333331, 441.15277777777743, 482.2299999999995, 463.6188888888884, 443.3505555555553, 454.3494444444441, 428.59611111111076, 459.9049999999996, 426.342222222222, 441.4066666666663, 448.04166666666634, 446.7244444444441, 437.79555555555515, 431.7705555555551, 448.8288888888888, 452.2944444444442, 409.2399999999996, 418.6061111111108, 429.98611111111074, 424.3199999999996, 453.80999999999983, 460.50888888888863, 421.0338888888885, 448.3577777777774, 450.588333333333, 438.3738888888886, 450.8088888888886, 433.4616666666665, 424.0344444444442, 439.50888888888846, 459.961111111111, 467.0094444444442, 418.62833333333316, 429.2561111111107, 447.12777777777717, 437.86722222222176, 431.20833333333286, 443.03888888888844, 453.78666666666635, 464.5322222222219, 432.6766666666663, 419.96999999999974, 456.1261111111108, 448.2316666666663, 427.1516666666665, 452.61055555555504, 424.0011111111107, 403.4383333333332, 448.0238888888888, 441.62722222222203, 426.263333333333, 445.1838888888886, 461.0394444444441, 423.01611111111083, 422.8761111111108, 444.9772222222219, 421.6938888888888, 453.7627777777775, 427.2161111111107, 425.707222222222, 432.6688888888885, 440.5727777777774, 451.2472222222218, 432.8899999999996, 444.9144444444439, 438.19333333333304, 409.25333333333305, 449.73222222222176, 415.6677777777775, 458.8811111111107, 421.46944444444415, 440.2155555555551, 461.9522222222218, 447.45333333333303, 434.5561111111112, 432.62888888888864, 455.1122222222217, 425.67499999999967, 451.15166666666624, 431.46944444444426, 440.6755555555553, 440.0249999999996, 444.1511111111107, 447.18333333333305, 442.08833333333314, 432.54055555555516, 467.565555555555, 447.9766666666662, 449.48333333333295, 449.1366666666662, 452.25444444444423, 453.64444444444433, 458.3811111111107, 438.73833333333283, 438.0866666666665, 428.3499999999996, 451.65888888888844, 451.1211111111108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19718474656409005, "mean_inference_ms": 1.80012469969994, "mean_action_processing_ms": 0.07494568464111767, "mean_env_wait_ms": 1.2206024705958214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004920244216918945, "StateBufferConnector_ms": 0.002979755401611328, "ViewRequirementAgentConnector_ms": 0.06795907020568848}, "num_episodes": 30, "episode_return_max": 482.2299999999995, "episode_return_min": 403.4383333333332, "episode_return_mean": 440.9335611111108, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304500, "num_agent_steps_trained": 304200, "num_env_steps_sampled": 304500, "num_env_steps_trained": 304200, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 286.548571757281, "num_env_steps_trained_throughput_per_sec": 286.548571757281, "timesteps_total": 304500, "num_env_steps_sampled_lifetime": 304500, "num_agent_steps_sampled_lifetime": 304500, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 304500, "timers": {"training_iteration_time_ms": 10268.491, "restore_workers_time_ms": 0.013, "training_step_time_ms": 536.263, "sample_time_ms": 522.172, "synch_weights_time_ms": 12.728}, "counters": {"num_env_steps_sampled": 304500, "num_env_steps_trained": 304200, "num_agent_steps_sampled": 304500, "num_agent_steps_trained": 304200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2030, "num_samples_added_to_queue": 304500}, "done": false, "training_iteration": 102, "trial_id": "0313d_00000", "date": "2024-10-10_21-58-57", "timestamp": 1728593937, "time_this_iter_s": 10.487999200820923, "time_total_s": 1050.2486746311188, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d89720>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1050.2486746311188, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 12.373333333333333, "ram_util_percent": 69.50666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 182331.4375, "policy_loss": 181899.078125, "entropy": 14.844075202941895, "entropy_coeff": 0.01, "var_gnorm": 16.642404556274414, "vf_loss": 476896.84375, "vf_explained_var": -0.1061021089553833}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1024.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 307350, "num_env_steps_trained": 307200, "num_agent_steps_sampled": 307350, "num_agent_steps_trained": 307200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2049, "num_samples_added_to_queue": 307200, "learner_queue": {"size_count": 1024, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.675, "learner_load_time_ms": 0.212, "learner_load_wait_time_ms": 1029.683, "learner_dequeue_time_ms": 8371.58}}, "env_runners": {"episode_reward_max": 481.26388888888846, "episode_reward_min": 398.50944444444417, "episode_reward_mean": 443.65959444444417, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 398.50944444444417}, "policy_reward_max": {"default_policy": 481.26388888888846}, "policy_reward_mean": {"default_policy": 443.65959444444417}, "custom_metrics": {"num_consolidated_mean": 1.9985, "num_consolidated_min": 1.86, "num_consolidated_max": 2.2, "num_overloaded_mean": 0.033499999999999995, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 5.116999999999999, "num_moves_min": 4.46, "num_moves_max": 5.67, "mean_accuracy_mean": 39.20829666666664, "mean_accuracy_min": 39.06066666666665, "mean_accuracy_max": 39.38366666666664, "num_model_switches_mean": 2.3362, "num_model_switches_min": 1.77, "num_model_switches_max": 2.81, "num_slav_mean": 0.002329333333333333, "num_slav_min": 0.0001, "num_slav_max": 0.006033333333333332, "mean_cluster_cpu_util_mean": 0.4543648250585629, "mean_cluster_cpu_util_min": 0.44451274788290185, "mean_cluster_cpu_util_max": 0.4648097898280934, "mean_cluster_mem_util_mean": 0.2902133672088033, "mean_cluster_mem_util_min": 0.28655962911535926, "mean_cluster_mem_util_max": 0.29459011075949365, "reward_consolidation_mean_mean": 2.672916666666667, "reward_consolidation_mean_min": 2.4444444444444446, "reward_consolidation_mean_max": 2.9444444444444446, "reward_illegal_mean_mean": -0.05583333333333332, "reward_illegal_mean_min": -0.11666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.8945014999999998, "reward_accuracy_mean_min": 1.824383333333333, "reward_accuracy_mean_max": 1.963166666666666, "reward_sla_mean_mean": -0.07498888888888888, "reward_sla_mean_min": -0.20055555555555554, "reward_sla_mean_max": -0.002777777777777778, "reward_consolidation_sum_mean": 267.2916666666667, "reward_consolidation_sum_min": 244.44444444444446, "reward_consolidation_sum_max": 294.44444444444446, "reward_illegal_sum_mean": -5.583333333333334, "reward_illegal_sum_min": -11.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 189.45015, "reward_accuracy_sum_min": 182.4383333333333, "reward_accuracy_sum_max": 196.3166666666666, "reward_sla_sum_mean": -7.498888888888888, "reward_sla_sum_min": -20.055555555555554, "reward_sla_sum_max": -0.2777777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4823.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [438.3738888888886, 450.8088888888886, 433.4616666666665, 424.0344444444442, 439.50888888888846, 459.961111111111, 467.0094444444442, 418.62833333333316, 429.2561111111107, 447.12777777777717, 437.86722222222176, 431.20833333333286, 443.03888888888844, 453.78666666666635, 464.5322222222219, 432.6766666666663, 419.96999999999974, 456.1261111111108, 448.2316666666663, 427.1516666666665, 452.61055555555504, 424.0011111111107, 403.4383333333332, 448.0238888888888, 441.62722222222203, 426.263333333333, 445.1838888888886, 461.0394444444441, 423.01611111111083, 422.8761111111108, 444.9772222222219, 421.6938888888888, 453.7627777777775, 427.2161111111107, 425.707222222222, 432.6688888888885, 440.5727777777774, 451.2472222222218, 432.8899999999996, 444.9144444444439, 438.19333333333304, 409.25333333333305, 449.73222222222176, 415.6677777777775, 458.8811111111107, 421.46944444444415, 440.2155555555551, 461.9522222222218, 447.45333333333303, 434.5561111111112, 432.62888888888864, 455.1122222222217, 425.67499999999967, 451.15166666666624, 431.46944444444426, 440.6755555555553, 440.0249999999996, 444.1511111111107, 447.18333333333305, 442.08833333333314, 432.54055555555516, 467.565555555555, 447.9766666666662, 449.48333333333295, 449.1366666666662, 452.25444444444423, 453.64444444444433, 458.3811111111107, 438.73833333333283, 438.0866666666665, 428.3499999999996, 451.65888888888844, 451.1211111111108, 438.9611111111107, 468.53277777777754, 438.063333333333, 471.92777777777735, 481.26388888888846, 467.7222222222217, 462.1911111111108, 461.2872222222218, 450.5955555555553, 432.29611111111063, 460.4777777777775, 441.166111111111, 459.61222222222193, 456.16666666666623, 440.4794444444442, 466.0311111111108, 461.77055555555506, 447.9449999999997, 444.0566666666664, 398.50944444444417, 437.8594444444442, 455.7544444444443, 455.8277777777774, 452.1288888888885, 458.17611111111097, 430.1838888888886, 474.00944444444434], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [438.3738888888886, 450.8088888888886, 433.4616666666665, 424.0344444444442, 439.50888888888846, 459.961111111111, 467.0094444444442, 418.62833333333316, 429.2561111111107, 447.12777777777717, 437.86722222222176, 431.20833333333286, 443.03888888888844, 453.78666666666635, 464.5322222222219, 432.6766666666663, 419.96999999999974, 456.1261111111108, 448.2316666666663, 427.1516666666665, 452.61055555555504, 424.0011111111107, 403.4383333333332, 448.0238888888888, 441.62722222222203, 426.263333333333, 445.1838888888886, 461.0394444444441, 423.01611111111083, 422.8761111111108, 444.9772222222219, 421.6938888888888, 453.7627777777775, 427.2161111111107, 425.707222222222, 432.6688888888885, 440.5727777777774, 451.2472222222218, 432.8899999999996, 444.9144444444439, 438.19333333333304, 409.25333333333305, 449.73222222222176, 415.6677777777775, 458.8811111111107, 421.46944444444415, 440.2155555555551, 461.9522222222218, 447.45333333333303, 434.5561111111112, 432.62888888888864, 455.1122222222217, 425.67499999999967, 451.15166666666624, 431.46944444444426, 440.6755555555553, 440.0249999999996, 444.1511111111107, 447.18333333333305, 442.08833333333314, 432.54055555555516, 467.565555555555, 447.9766666666662, 449.48333333333295, 449.1366666666662, 452.25444444444423, 453.64444444444433, 458.3811111111107, 438.73833333333283, 438.0866666666665, 428.3499999999996, 451.65888888888844, 451.1211111111108, 438.9611111111107, 468.53277777777754, 438.063333333333, 471.92777777777735, 481.26388888888846, 467.7222222222217, 462.1911111111108, 461.2872222222218, 450.5955555555553, 432.29611111111063, 460.4777777777775, 441.166111111111, 459.61222222222193, 456.16666666666623, 440.4794444444442, 466.0311111111108, 461.77055555555506, 447.9449999999997, 444.0566666666664, 398.50944444444417, 437.8594444444442, 455.7544444444443, 455.8277777777774, 452.1288888888885, 458.17611111111097, 430.1838888888886, 474.00944444444434]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19726249350984223, "mean_inference_ms": 1.8008035305340417, "mean_action_processing_ms": 0.07497226173937958, "mean_env_wait_ms": 1.2209819399164445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004941463470458984, "StateBufferConnector_ms": 0.0030069351196289062, "ViewRequirementAgentConnector_ms": 0.06936931610107422}, "num_episodes": 27, "episode_return_max": 481.26388888888846, "episode_return_min": 398.50944444444417, "episode_return_mean": 443.65959444444417, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 307350, "num_agent_steps_trained": 307200, "num_env_steps_sampled": 307350, "num_env_steps_trained": 307200, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 277.02942270334086, "num_env_steps_trained_throughput_per_sec": 291.60991863509565, "timesteps_total": 307350, "num_env_steps_sampled_lifetime": 307350, "num_agent_steps_sampled_lifetime": 307350, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 307350, "timers": {"training_iteration_time_ms": 10270.823, "restore_workers_time_ms": 0.012, "training_step_time_ms": 514.603, "sample_time_ms": 500.538, "synch_weights_time_ms": 12.771}, "counters": {"num_env_steps_sampled": 307350, "num_env_steps_trained": 307200, "num_agent_steps_sampled": 307350, "num_agent_steps_trained": 307200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2049, "num_samples_added_to_queue": 307200}, "done": false, "training_iteration": 103, "trial_id": "0313d_00000", "date": "2024-10-10_21-59-08", "timestamp": 1728593948, "time_this_iter_s": 10.298337459564209, "time_total_s": 1060.547012090683, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d8ac20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1060.547012090683, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 12.693333333333333, "ram_util_percent": 69.93333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 180649.46875, "policy_loss": 180227.09375, "entropy": 14.75303840637207, "entropy_coeff": 0.01, "var_gnorm": 16.640548706054688, "vf_loss": 466645.5625, "vf_explained_var": -0.10606229305267334}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1034.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 310350, "num_env_steps_trained": 310200, "num_agent_steps_sampled": 310350, "num_agent_steps_trained": 310200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2069, "num_samples_added_to_queue": 310200, "learner_queue": {"size_count": 1034, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 49.104, "learner_load_time_ms": 0.261, "learner_load_wait_time_ms": 994.747, "learner_dequeue_time_ms": 8373.45}}, "env_runners": {"episode_reward_max": 485.4055555555551, "episode_reward_min": 398.50944444444417, "episode_reward_mean": 447.18493333333294, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 398.50944444444417}, "policy_reward_max": {"default_policy": 485.4055555555551}, "policy_reward_mean": {"default_policy": 447.18493333333294}, "custom_metrics": {"num_consolidated_mean": 2.0236, "num_consolidated_min": 1.86, "num_consolidated_max": 2.2, "num_overloaded_mean": 0.0341, "num_overloaded_min": 0.0, "num_overloaded_max": 0.08, "num_moves_mean": 5.0573, "num_moves_min": 4.57, "num_moves_max": 5.67, "mean_accuracy_mean": 39.21576999999998, "mean_accuracy_min": 39.04799999999997, "mean_accuracy_max": 39.38999999999998, "num_model_switches_mean": 2.3562, "num_model_switches_min": 2.05, "num_model_switches_max": 2.81, "num_slav_mean": 0.0021791666666666665, "num_slav_min": 0.0001, "num_slav_max": 0.005116666666666666, "mean_cluster_cpu_util_mean": 0.4552968725146515, "mean_cluster_cpu_util_min": 0.44451274788290185, "mean_cluster_cpu_util_max": 0.46912449506514553, "mean_cluster_mem_util_mean": 0.2901854013766899, "mean_cluster_mem_util_min": 0.28655962911535926, "mean_cluster_mem_util_max": 0.2956217407216051, "reward_consolidation_mean_mean": 2.7052777777777783, "reward_consolidation_mean_min": 2.430555555555556, "reward_consolidation_mean_max": 2.9444444444444446, "reward_illegal_mean_mean": -0.05683333333333332, "reward_illegal_mean_min": -0.13333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.8936326666666667, "reward_accuracy_mean_min": 1.8050999999999997, "reward_accuracy_mean_max": 1.963166666666666, "reward_sla_mean_mean": -0.07022777777777776, "reward_sla_mean_min": -0.17055555555555554, "reward_sla_mean_max": -0.002777777777777778, "reward_consolidation_sum_mean": 270.5277777777778, "reward_consolidation_sum_min": 243.05555555555557, "reward_consolidation_sum_max": 294.44444444444446, "reward_illegal_sum_mean": -5.683333333333333, "reward_illegal_sum_min": -13.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 189.36326666666662, "reward_accuracy_sum_min": 180.50999999999996, "reward_accuracy_sum_max": 196.3166666666666, "reward_sla_sum_mean": -7.022777777777776, "reward_sla_sum_min": -17.055555555555554, "reward_sla_sum_max": -0.2777777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3477.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [444.9772222222219, 421.6938888888888, 453.7627777777775, 427.2161111111107, 425.707222222222, 432.6688888888885, 440.5727777777774, 451.2472222222218, 432.8899999999996, 444.9144444444439, 438.19333333333304, 409.25333333333305, 449.73222222222176, 415.6677777777775, 458.8811111111107, 421.46944444444415, 440.2155555555551, 461.9522222222218, 447.45333333333303, 434.5561111111112, 432.62888888888864, 455.1122222222217, 425.67499999999967, 451.15166666666624, 431.46944444444426, 440.6755555555553, 440.0249999999996, 444.1511111111107, 447.18333333333305, 442.08833333333314, 432.54055555555516, 467.565555555555, 447.9766666666662, 449.48333333333295, 449.1366666666662, 452.25444444444423, 453.64444444444433, 458.3811111111107, 438.73833333333283, 438.0866666666665, 428.3499999999996, 451.65888888888844, 451.1211111111108, 438.9611111111107, 468.53277777777754, 438.063333333333, 471.92777777777735, 481.26388888888846, 467.7222222222217, 462.1911111111108, 461.2872222222218, 450.5955555555553, 432.29611111111063, 460.4777777777775, 441.166111111111, 459.61222222222193, 456.16666666666623, 440.4794444444442, 466.0311111111108, 461.77055555555506, 447.9449999999997, 444.0566666666664, 398.50944444444417, 437.8594444444442, 455.7544444444443, 455.8277777777774, 452.1288888888885, 458.17611111111097, 430.1838888888886, 474.00944444444434, 447.6305555555553, 428.1994444444443, 454.96999999999974, 476.1672222222218, 452.92111111111063, 453.5638888888884, 430.6766666666661, 456.0883333333331, 446.0244444444442, 452.3883333333333, 445.32888888888846, 445.97888888888855, 448.5483333333329, 451.351666666666, 431.9366666666662, 436.00055555555514, 446.87388888888864, 441.16722222222177, 468.1361111111109, 455.698333333333, 462.17388888888877, 454.7211111111105, 465.1205555555553, 485.4055555555551, 412.50055555555537, 431.88944444444417, 476.7616666666664, 447.2555555555553, 448.10999999999984, 469.78499999999957], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [444.9772222222219, 421.6938888888888, 453.7627777777775, 427.2161111111107, 425.707222222222, 432.6688888888885, 440.5727777777774, 451.2472222222218, 432.8899999999996, 444.9144444444439, 438.19333333333304, 409.25333333333305, 449.73222222222176, 415.6677777777775, 458.8811111111107, 421.46944444444415, 440.2155555555551, 461.9522222222218, 447.45333333333303, 434.5561111111112, 432.62888888888864, 455.1122222222217, 425.67499999999967, 451.15166666666624, 431.46944444444426, 440.6755555555553, 440.0249999999996, 444.1511111111107, 447.18333333333305, 442.08833333333314, 432.54055555555516, 467.565555555555, 447.9766666666662, 449.48333333333295, 449.1366666666662, 452.25444444444423, 453.64444444444433, 458.3811111111107, 438.73833333333283, 438.0866666666665, 428.3499999999996, 451.65888888888844, 451.1211111111108, 438.9611111111107, 468.53277777777754, 438.063333333333, 471.92777777777735, 481.26388888888846, 467.7222222222217, 462.1911111111108, 461.2872222222218, 450.5955555555553, 432.29611111111063, 460.4777777777775, 441.166111111111, 459.61222222222193, 456.16666666666623, 440.4794444444442, 466.0311111111108, 461.77055555555506, 447.9449999999997, 444.0566666666664, 398.50944444444417, 437.8594444444442, 455.7544444444443, 455.8277777777774, 452.1288888888885, 458.17611111111097, 430.1838888888886, 474.00944444444434, 447.6305555555553, 428.1994444444443, 454.96999999999974, 476.1672222222218, 452.92111111111063, 453.5638888888884, 430.6766666666661, 456.0883333333331, 446.0244444444442, 452.3883333333333, 445.32888888888846, 445.97888888888855, 448.5483333333329, 451.351666666666, 431.9366666666662, 436.00055555555514, 446.87388888888864, 441.16722222222177, 468.1361111111109, 455.698333333333, 462.17388888888877, 454.7211111111105, 465.1205555555553, 485.4055555555551, 412.50055555555537, 431.88944444444417, 476.7616666666664, 447.2555555555553, 448.10999999999984, 469.78499999999957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1973381281358931, "mean_inference_ms": 1.8010614222487584, "mean_action_processing_ms": 0.07499283898890784, "mean_env_wait_ms": 1.221218269601854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004774570465087891, "StateBufferConnector_ms": 0.002995014190673828, "ViewRequirementAgentConnector_ms": 0.06926226615905762}, "num_episodes": 30, "episode_return_max": 485.4055555555551, "episode_return_min": 398.50944444444417, "episode_return_mean": 447.18493333333294, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 310350, "num_agent_steps_trained": 310200, "num_env_steps_sampled": 310350, "num_env_steps_trained": 310200, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 288.1382809622755, "num_env_steps_trained_throughput_per_sec": 288.1382809622755, "timesteps_total": 310350, "num_env_steps_sampled_lifetime": 310350, "num_agent_steps_sampled_lifetime": 310350, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 310350, "timers": {"training_iteration_time_ms": 10284.408, "restore_workers_time_ms": 0.012, "training_step_time_ms": 521.172, "sample_time_ms": 506.606, "synch_weights_time_ms": 13.167}, "counters": {"num_env_steps_sampled": 310350, "num_env_steps_trained": 310200, "num_agent_steps_sampled": 310350, "num_agent_steps_trained": 310200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2069, "num_samples_added_to_queue": 310200}, "done": false, "training_iteration": 104, "trial_id": "0313d_00000", "date": "2024-10-10_21-59-18", "timestamp": 1728593958, "time_this_iter_s": 10.421789646148682, "time_total_s": 1070.9688017368317, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c28460>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1070.9688017368317, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 12.580000000000002, "ram_util_percent": 70.08666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 175943.5625, "policy_loss": 175556.609375, "entropy": 15.328495979309082, "entropy_coeff": 0.01, "var_gnorm": 16.636852264404297, "vf_loss": 432939.53125, "vf_explained_var": -0.09243643283843994}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1043.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 313050, "num_env_steps_trained": 312900, "num_agent_steps_sampled": 313050, "num_agent_steps_trained": 312900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2087, "num_samples_added_to_queue": 312900, "learner_queue": {"size_count": 1043, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.648, "learner_load_time_ms": 0.265, "learner_load_wait_time_ms": 1058.785, "learner_dequeue_time_ms": 8493.544}}, "env_runners": {"episode_reward_max": 485.4055555555551, "episode_reward_min": 398.50944444444417, "episode_reward_mean": 449.1450722222219, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 398.50944444444417}, "policy_reward_max": {"default_policy": 485.4055555555551}, "policy_reward_mean": {"default_policy": 449.1450722222219}, "custom_metrics": {"num_consolidated_mean": 2.0435, "num_consolidated_min": 1.86, "num_consolidated_max": 2.2, "num_overloaded_mean": 0.0355, "num_overloaded_min": 0.0, "num_overloaded_max": 0.08, "num_moves_mean": 5.016699999999999, "num_moves_min": 4.57, "num_moves_max": 5.43, "mean_accuracy_mean": 39.23818999999999, "mean_accuracy_min": 39.04799999999997, "mean_accuracy_max": 39.42799999999998, "num_model_switches_mean": 2.3587000000000002, "num_model_switches_min": 2.05, "num_model_switches_max": 2.76, "num_slav_mean": 0.002173333333333333, "num_slav_min": 0.0001, "num_slav_max": 0.0059833333333333336, "mean_cluster_cpu_util_mean": 0.4576495038558239, "mean_cluster_cpu_util_min": 0.44451274788290185, "mean_cluster_cpu_util_max": 0.4769286041335033, "mean_cluster_mem_util_mean": 0.2906292013422458, "mean_cluster_mem_util_min": 0.28656893764889924, "mean_cluster_mem_util_max": 0.29988680358219233, "reward_consolidation_mean_mean": 2.7272222222222235, "reward_consolidation_mean_min": 2.430555555555556, "reward_consolidation_mean_max": 2.9444444444444446, "reward_illegal_mean_mean": -0.05916666666666665, "reward_illegal_mean_min": -0.13333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.8917784999999996, "reward_accuracy_mean_min": 1.80415, "reward_accuracy_mean_max": 1.963166666666666, "reward_sla_mean_mean": -0.06838333333333332, "reward_sla_mean_min": -0.16833333333333336, "reward_sla_mean_max": -0.002777777777777778, "reward_consolidation_sum_mean": 272.7222222222223, "reward_consolidation_sum_min": 243.05555555555557, "reward_consolidation_sum_max": 294.44444444444446, "reward_illegal_sum_mean": -5.916666666666666, "reward_illegal_sum_min": -13.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 189.17784999999995, "reward_accuracy_sum_min": 180.415, "reward_accuracy_sum_max": 196.3166666666666, "reward_sla_sum_mean": -6.838333333333335, "reward_sla_sum_min": -16.833333333333336, "reward_sla_sum_max": -0.2777777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2350.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [444.1511111111107, 447.18333333333305, 442.08833333333314, 432.54055555555516, 467.565555555555, 447.9766666666662, 449.48333333333295, 449.1366666666662, 452.25444444444423, 453.64444444444433, 458.3811111111107, 438.73833333333283, 438.0866666666665, 428.3499999999996, 451.65888888888844, 451.1211111111108, 438.9611111111107, 468.53277777777754, 438.063333333333, 471.92777777777735, 481.26388888888846, 467.7222222222217, 462.1911111111108, 461.2872222222218, 450.5955555555553, 432.29611111111063, 460.4777777777775, 441.166111111111, 459.61222222222193, 456.16666666666623, 440.4794444444442, 466.0311111111108, 461.77055555555506, 447.9449999999997, 444.0566666666664, 398.50944444444417, 437.8594444444442, 455.7544444444443, 455.8277777777774, 452.1288888888885, 458.17611111111097, 430.1838888888886, 474.00944444444434, 447.6305555555553, 428.1994444444443, 454.96999999999974, 476.1672222222218, 452.92111111111063, 453.5638888888884, 430.6766666666661, 456.0883333333331, 446.0244444444442, 452.3883333333333, 445.32888888888846, 445.97888888888855, 448.5483333333329, 451.351666666666, 431.9366666666662, 436.00055555555514, 446.87388888888864, 441.16722222222177, 468.1361111111109, 455.698333333333, 462.17388888888877, 454.7211111111105, 465.1205555555553, 485.4055555555551, 412.50055555555537, 431.88944444444417, 476.7616666666664, 447.2555555555553, 448.10999999999984, 469.78499999999957, 473.2233333333331, 450.8411111111109, 462.23777777777764, 449.70722222222196, 422.1372222222219, 424.5722222222221, 434.3505555555552, 457.42722222222187, 424.8027777777775, 442.1694444444442, 435.9144444444442, 457.9361111111107, 458.4616666666664, 460.7144444444444, 441.5633333333329, 432.3727777777773, 447.626111111111, 433.76333333333275, 458.7299999999999, 427.55555555555554, 441.0411111111108, 450.53944444444414, 444.67444444444413, 447.75611111111084, 433.38111111111095, 445.7138888888887, 466.5638888888886], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [444.1511111111107, 447.18333333333305, 442.08833333333314, 432.54055555555516, 467.565555555555, 447.9766666666662, 449.48333333333295, 449.1366666666662, 452.25444444444423, 453.64444444444433, 458.3811111111107, 438.73833333333283, 438.0866666666665, 428.3499999999996, 451.65888888888844, 451.1211111111108, 438.9611111111107, 468.53277777777754, 438.063333333333, 471.92777777777735, 481.26388888888846, 467.7222222222217, 462.1911111111108, 461.2872222222218, 450.5955555555553, 432.29611111111063, 460.4777777777775, 441.166111111111, 459.61222222222193, 456.16666666666623, 440.4794444444442, 466.0311111111108, 461.77055555555506, 447.9449999999997, 444.0566666666664, 398.50944444444417, 437.8594444444442, 455.7544444444443, 455.8277777777774, 452.1288888888885, 458.17611111111097, 430.1838888888886, 474.00944444444434, 447.6305555555553, 428.1994444444443, 454.96999999999974, 476.1672222222218, 452.92111111111063, 453.5638888888884, 430.6766666666661, 456.0883333333331, 446.0244444444442, 452.3883333333333, 445.32888888888846, 445.97888888888855, 448.5483333333329, 451.351666666666, 431.9366666666662, 436.00055555555514, 446.87388888888864, 441.16722222222177, 468.1361111111109, 455.698333333333, 462.17388888888877, 454.7211111111105, 465.1205555555553, 485.4055555555551, 412.50055555555537, 431.88944444444417, 476.7616666666664, 447.2555555555553, 448.10999999999984, 469.78499999999957, 473.2233333333331, 450.8411111111109, 462.23777777777764, 449.70722222222196, 422.1372222222219, 424.5722222222221, 434.3505555555552, 457.42722222222187, 424.8027777777775, 442.1694444444442, 435.9144444444442, 457.9361111111107, 458.4616666666664, 460.7144444444444, 441.5633333333329, 432.3727777777773, 447.626111111111, 433.76333333333275, 458.7299999999999, 427.55555555555554, 441.0411111111108, 450.53944444444414, 444.67444444444413, 447.75611111111084, 433.38111111111095, 445.7138888888887, 466.5638888888886]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1974032025322685, "mean_inference_ms": 1.8003792721499945, "mean_action_processing_ms": 0.07500740213309752, "mean_env_wait_ms": 1.2213497238557016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046460628509521484, "StateBufferConnector_ms": 0.0030317306518554688, "ViewRequirementAgentConnector_ms": 0.07021379470825195}, "num_episodes": 27, "episode_return_max": 485.4055555555551, "episode_return_min": 398.50944444444417, "episode_return_mean": 449.1450722222219, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 313050, "num_agent_steps_trained": 312900, "num_env_steps_sampled": 313050, "num_env_steps_trained": 312900, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 265.3544945456754, "num_env_steps_trained_throughput_per_sec": 265.3544945456754, "timesteps_total": 313050, "num_env_steps_sampled_lifetime": 313050, "num_agent_steps_sampled_lifetime": 313050, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 313050, "timers": {"training_iteration_time_ms": 10279.179, "restore_workers_time_ms": 0.014, "training_step_time_ms": 526.416, "sample_time_ms": 512.057, "synch_weights_time_ms": 12.858}, "counters": {"num_env_steps_sampled": 313050, "num_env_steps_trained": 312900, "num_agent_steps_sampled": 313050, "num_agent_steps_trained": 312900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2087, "num_samples_added_to_queue": 312900}, "done": false, "training_iteration": 105, "trial_id": "0313d_00000", "date": "2024-10-10_21-59-28", "timestamp": 1728593968, "time_this_iter_s": 10.185976266860962, "time_total_s": 1081.1547780036926, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d88340>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1081.1547780036926, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 14.764285714285718, "ram_util_percent": 70.24285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 184352.609375, "policy_loss": 183927.515625, "entropy": 15.313836097717285, "entropy_coeff": 0.01, "var_gnorm": 16.631208419799805, "vf_loss": 471031.84375, "vf_explained_var": -0.07768809795379639}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1053.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 316050, "num_env_steps_trained": 315900, "num_agent_steps_sampled": 316050, "num_agent_steps_trained": 315900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2107, "num_samples_added_to_queue": 315900, "learner_queue": {"size_count": 1053, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.617, "learner_load_time_ms": 0.257, "learner_load_wait_time_ms": 990.254, "learner_dequeue_time_ms": 8536.644}}, "env_runners": {"episode_reward_max": 485.4055555555551, "episode_reward_min": 390.88388888888846, "episode_reward_mean": 445.5249944444441, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 390.88388888888846}, "policy_reward_max": {"default_policy": 485.4055555555551}, "policy_reward_mean": {"default_policy": 445.5249944444441}, "custom_metrics": {"num_consolidated_mean": 2.0540000000000003, "num_consolidated_min": 1.87, "num_consolidated_max": 2.25, "num_overloaded_mean": 0.0433, "num_overloaded_min": 0.0, "num_overloaded_max": 0.12, "num_moves_mean": 5.0185, "num_moves_min": 4.57, "num_moves_max": 5.43, "mean_accuracy_mean": 39.26276333333331, "mean_accuracy_min": 39.04799999999997, "mean_accuracy_max": 39.45966666666666, "num_model_switches_mean": 2.394, "num_model_switches_min": 2.05, "num_model_switches_max": 2.82, "num_slav_mean": 0.002249, "num_slav_min": 0.0001, "num_slav_max": 0.006533333333333333, "mean_cluster_cpu_util_mean": 0.46084338563112726, "mean_cluster_cpu_util_min": 0.4466707571051808, "mean_cluster_cpu_util_max": 0.4821742662467241, "mean_cluster_mem_util_mean": 0.291517188944143, "mean_cluster_mem_util_min": 0.2865765580599328, "mean_cluster_mem_util_max": 0.29988680358219233, "reward_consolidation_mean_mean": 2.7191666666666663, "reward_consolidation_mean_min": 2.430555555555556, "reward_consolidation_mean_max": 2.944444444444445, "reward_illegal_mean_mean": -0.07216666666666666, "reward_illegal_mean_min": -0.2, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.8774721666666667, "reward_accuracy_mean_min": 1.7282833333333332, "reward_accuracy_mean_max": 1.956833333333333, "reward_sla_mean_mean": -0.06922222222222223, "reward_sla_mean_min": -0.2177777777777778, "reward_sla_mean_max": -0.002777777777777778, "reward_consolidation_sum_mean": 271.9166666666667, "reward_consolidation_sum_min": 243.05555555555557, "reward_consolidation_sum_max": 294.4444444444445, "reward_illegal_sum_mean": -7.216666666666666, "reward_illegal_sum_min": -20.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 187.74721666666665, "reward_accuracy_sum_min": 172.82833333333332, "reward_accuracy_sum_max": 195.6833333333333, "reward_sla_sum_mean": -6.9222222222222225, "reward_sla_sum_min": -21.77777777777778, "reward_sla_sum_max": -0.2777777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2263.0, "global_timestep_min": 200, "global_timestep_max": 3900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [440.4794444444442, 466.0311111111108, 461.77055555555506, 447.9449999999997, 444.0566666666664, 398.50944444444417, 437.8594444444442, 455.7544444444443, 455.8277777777774, 452.1288888888885, 458.17611111111097, 430.1838888888886, 474.00944444444434, 447.6305555555553, 428.1994444444443, 454.96999999999974, 476.1672222222218, 452.92111111111063, 453.5638888888884, 430.6766666666661, 456.0883333333331, 446.0244444444442, 452.3883333333333, 445.32888888888846, 445.97888888888855, 448.5483333333329, 451.351666666666, 431.9366666666662, 436.00055555555514, 446.87388888888864, 441.16722222222177, 468.1361111111109, 455.698333333333, 462.17388888888877, 454.7211111111105, 465.1205555555553, 485.4055555555551, 412.50055555555537, 431.88944444444417, 476.7616666666664, 447.2555555555553, 448.10999999999984, 469.78499999999957, 473.2233333333331, 450.8411111111109, 462.23777777777764, 449.70722222222196, 422.1372222222219, 424.5722222222221, 434.3505555555552, 457.42722222222187, 424.8027777777775, 442.1694444444442, 435.9144444444442, 457.9361111111107, 458.4616666666664, 460.7144444444444, 441.5633333333329, 432.3727777777773, 447.626111111111, 433.76333333333275, 458.7299999999999, 427.55555555555554, 441.0411111111108, 450.53944444444414, 444.67444444444413, 447.75611111111084, 433.38111111111095, 445.7138888888887, 466.5638888888886, 427.9616666666663, 445.61888888888853, 456.7772222222219, 420.1361111111107, 439.4611111111108, 429.3249999999996, 460.59666666666635, 466.4827777777777, 441.94333333333293, 420.8038888888885, 423.15944444444426, 439.468333333333, 390.88388888888846, 433.1922222222219, 398.10611111111086, 463.62833333333316, 438.38055555555525, 427.59555555555505, 453.3027777777777, 470.55499999999967, 449.80999999999955, 455.4188888888887, 448.0416666666661, 409.74833333333305, 448.11944444444396, 436.31833333333327, 429.0494444444442, 443.28611111111087, 448.23833333333295, 465.20722222222184], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [440.4794444444442, 466.0311111111108, 461.77055555555506, 447.9449999999997, 444.0566666666664, 398.50944444444417, 437.8594444444442, 455.7544444444443, 455.8277777777774, 452.1288888888885, 458.17611111111097, 430.1838888888886, 474.00944444444434, 447.6305555555553, 428.1994444444443, 454.96999999999974, 476.1672222222218, 452.92111111111063, 453.5638888888884, 430.6766666666661, 456.0883333333331, 446.0244444444442, 452.3883333333333, 445.32888888888846, 445.97888888888855, 448.5483333333329, 451.351666666666, 431.9366666666662, 436.00055555555514, 446.87388888888864, 441.16722222222177, 468.1361111111109, 455.698333333333, 462.17388888888877, 454.7211111111105, 465.1205555555553, 485.4055555555551, 412.50055555555537, 431.88944444444417, 476.7616666666664, 447.2555555555553, 448.10999999999984, 469.78499999999957, 473.2233333333331, 450.8411111111109, 462.23777777777764, 449.70722222222196, 422.1372222222219, 424.5722222222221, 434.3505555555552, 457.42722222222187, 424.8027777777775, 442.1694444444442, 435.9144444444442, 457.9361111111107, 458.4616666666664, 460.7144444444444, 441.5633333333329, 432.3727777777773, 447.626111111111, 433.76333333333275, 458.7299999999999, 427.55555555555554, 441.0411111111108, 450.53944444444414, 444.67444444444413, 447.75611111111084, 433.38111111111095, 445.7138888888887, 466.5638888888886, 427.9616666666663, 445.61888888888853, 456.7772222222219, 420.1361111111107, 439.4611111111108, 429.3249999999996, 460.59666666666635, 466.4827777777777, 441.94333333333293, 420.8038888888885, 423.15944444444426, 439.468333333333, 390.88388888888846, 433.1922222222219, 398.10611111111086, 463.62833333333316, 438.38055555555525, 427.59555555555505, 453.3027777777777, 470.55499999999967, 449.80999999999955, 455.4188888888887, 448.0416666666661, 409.74833333333305, 448.11944444444396, 436.31833333333327, 429.0494444444442, 443.28611111111087, 448.23833333333295, 465.20722222222184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19754094325253463, "mean_inference_ms": 1.802422567390935, "mean_action_processing_ms": 0.07505109118078282, "mean_env_wait_ms": 1.2219816666081635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004366874694824219, "StateBufferConnector_ms": 0.002963542938232422, "ViewRequirementAgentConnector_ms": 0.06798052787780762}, "num_episodes": 30, "episode_return_max": 485.4055555555551, "episode_return_min": 390.88388888888846, "episode_return_mean": 445.5249944444441, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316050, "num_agent_steps_trained": 315900, "num_env_steps_sampled": 316050, "num_env_steps_trained": 315900, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 290.1025351214884, "num_env_steps_trained_throughput_per_sec": 290.1025351214884, "timesteps_total": 316050, "num_env_steps_sampled_lifetime": 316050, "num_agent_steps_sampled_lifetime": 316050, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 316050, "timers": {"training_iteration_time_ms": 10294.986, "restore_workers_time_ms": 0.012, "training_step_time_ms": 503.926, "sample_time_ms": 488.93, "synch_weights_time_ms": 13.4}, "counters": {"num_env_steps_sampled": 316050, "num_env_steps_trained": 315900, "num_agent_steps_sampled": 316050, "num_agent_steps_trained": 315900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2107, "num_samples_added_to_queue": 315900}, "done": false, "training_iteration": 106, "trial_id": "0313d_00000", "date": "2024-10-10_21-59-39", "timestamp": 1728593979, "time_this_iter_s": 10.352108716964722, "time_total_s": 1091.5068867206573, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d89a50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1091.5068867206573, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 12.886666666666665, "ram_util_percent": 70.49333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 170806.8125, "policy_loss": 170417.921875, "entropy": 15.062516212463379, "entropy_coeff": 0.01, "var_gnorm": 16.63190269470215, "vf_loss": 434077.9375, "vf_explained_var": -0.07117974758148193}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1063.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 319050, "num_env_steps_trained": 318900, "num_agent_steps_sampled": 319050, "num_agent_steps_trained": 318900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2127, "num_samples_added_to_queue": 318900, "learner_queue": {"size_count": 1063, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.566, "learner_load_time_ms": 0.268, "learner_load_wait_time_ms": 987.361, "learner_dequeue_time_ms": 8545.514}}, "env_runners": {"episode_reward_max": 485.4055555555551, "episode_reward_min": 390.88388888888846, "episode_reward_mean": 441.5455222222219, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 390.88388888888846}, "policy_reward_max": {"default_policy": 485.4055555555551}, "policy_reward_mean": {"default_policy": 441.5455222222219}, "custom_metrics": {"num_consolidated_mean": 2.0553999999999997, "num_consolidated_min": 1.87, "num_consolidated_max": 2.25, "num_overloaded_mean": 0.0487, "num_overloaded_min": 0.0, "num_overloaded_max": 0.12, "num_moves_mean": 5.0281, "num_moves_min": 4.48, "num_moves_max": 5.43, "mean_accuracy_mean": 39.29506333333332, "mean_accuracy_min": 39.11766666666665, "mean_accuracy_max": 39.45966666666666, "num_model_switches_mean": 2.4226, "num_model_switches_min": 2.05, "num_model_switches_max": 2.82, "num_slav_mean": 0.002442833333333333, "num_slav_min": 0.0001, "num_slav_max": 0.006533333333333333, "mean_cluster_cpu_util_mean": 0.4634654734320209, "mean_cluster_cpu_util_min": 0.4526311335619881, "mean_cluster_cpu_util_max": 0.4821742662467241, "mean_cluster_mem_util_mean": 0.2921932091442062, "mean_cluster_mem_util_min": 0.28632882760699213, "mean_cluster_mem_util_max": 0.29988680358219233, "reward_consolidation_mean_mean": 2.7026388888888886, "reward_consolidation_mean_min": 2.402777777777778, "reward_consolidation_mean_max": 2.944444444444445, "reward_illegal_mean_mean": -0.08116666666666665, "reward_illegal_mean_min": -0.2, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.8683163333333332, "reward_accuracy_mean_min": 1.7228999999999997, "reward_accuracy_mean_max": 1.956833333333333, "reward_sla_mean_mean": -0.07433333333333333, "reward_sla_mean_min": -0.2177777777777778, "reward_sla_mean_max": -0.0033333333333333335, "reward_consolidation_sum_mean": 270.26388888888886, "reward_consolidation_sum_min": 240.2777777777778, "reward_consolidation_sum_max": 294.4444444444445, "reward_illegal_sum_mean": -8.116666666666667, "reward_illegal_sum_min": -20.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 186.83163333333334, "reward_accuracy_sum_min": 172.28999999999996, "reward_accuracy_sum_max": 195.6833333333333, "reward_sla_sum_mean": -7.433333333333333, "reward_sla_sum_min": -21.77777777777778, "reward_sla_sum_max": -0.33333333333333337, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3257.0, "global_timestep_min": 1100, "global_timestep_max": 4900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [441.16722222222177, 468.1361111111109, 455.698333333333, 462.17388888888877, 454.7211111111105, 465.1205555555553, 485.4055555555551, 412.50055555555537, 431.88944444444417, 476.7616666666664, 447.2555555555553, 448.10999999999984, 469.78499999999957, 473.2233333333331, 450.8411111111109, 462.23777777777764, 449.70722222222196, 422.1372222222219, 424.5722222222221, 434.3505555555552, 457.42722222222187, 424.8027777777775, 442.1694444444442, 435.9144444444442, 457.9361111111107, 458.4616666666664, 460.7144444444444, 441.5633333333329, 432.3727777777773, 447.626111111111, 433.76333333333275, 458.7299999999999, 427.55555555555554, 441.0411111111108, 450.53944444444414, 444.67444444444413, 447.75611111111084, 433.38111111111095, 445.7138888888887, 466.5638888888886, 427.9616666666663, 445.61888888888853, 456.7772222222219, 420.1361111111107, 439.4611111111108, 429.3249999999996, 460.59666666666635, 466.4827777777777, 441.94333333333293, 420.8038888888885, 423.15944444444426, 439.468333333333, 390.88388888888846, 433.1922222222219, 398.10611111111086, 463.62833333333316, 438.38055555555525, 427.59555555555505, 453.3027777777777, 470.55499999999967, 449.80999999999955, 455.4188888888887, 448.0416666666661, 409.74833333333305, 448.11944444444396, 436.31833333333327, 429.0494444444442, 443.28611111111087, 448.23833333333295, 465.20722222222184, 413.10333333333296, 427.1677777777774, 434.41333333333307, 432.29277777777753, 425.4772222222218, 418.2305555555551, 451.08055555555546, 447.27888888888856, 442.08666666666653, 422.74055555555543, 446.1988888888886, 442.5077777777775, 393.59833333333296, 460.50833333333276, 397.84555555555505, 425.81722222222203, 437.4138888888886, 422.68388888888836, 430.30111111111097, 434.1277777777774, 399.1849999999998, 446.33333333333314, 427.5388888888887, 442.4294444444442, 463.4438888888885, 456.81722222222186, 416.7716666666665, 458.5883333333329, 471.57888888888874, 441.87277777777746], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [441.16722222222177, 468.1361111111109, 455.698333333333, 462.17388888888877, 454.7211111111105, 465.1205555555553, 485.4055555555551, 412.50055555555537, 431.88944444444417, 476.7616666666664, 447.2555555555553, 448.10999999999984, 469.78499999999957, 473.2233333333331, 450.8411111111109, 462.23777777777764, 449.70722222222196, 422.1372222222219, 424.5722222222221, 434.3505555555552, 457.42722222222187, 424.8027777777775, 442.1694444444442, 435.9144444444442, 457.9361111111107, 458.4616666666664, 460.7144444444444, 441.5633333333329, 432.3727777777773, 447.626111111111, 433.76333333333275, 458.7299999999999, 427.55555555555554, 441.0411111111108, 450.53944444444414, 444.67444444444413, 447.75611111111084, 433.38111111111095, 445.7138888888887, 466.5638888888886, 427.9616666666663, 445.61888888888853, 456.7772222222219, 420.1361111111107, 439.4611111111108, 429.3249999999996, 460.59666666666635, 466.4827777777777, 441.94333333333293, 420.8038888888885, 423.15944444444426, 439.468333333333, 390.88388888888846, 433.1922222222219, 398.10611111111086, 463.62833333333316, 438.38055555555525, 427.59555555555505, 453.3027777777777, 470.55499999999967, 449.80999999999955, 455.4188888888887, 448.0416666666661, 409.74833333333305, 448.11944444444396, 436.31833333333327, 429.0494444444442, 443.28611111111087, 448.23833333333295, 465.20722222222184, 413.10333333333296, 427.1677777777774, 434.41333333333307, 432.29277777777753, 425.4772222222218, 418.2305555555551, 451.08055555555546, 447.27888888888856, 442.08666666666653, 422.74055555555543, 446.1988888888886, 442.5077777777775, 393.59833333333296, 460.50833333333276, 397.84555555555505, 425.81722222222203, 437.4138888888886, 422.68388888888836, 430.30111111111097, 434.1277777777774, 399.1849999999998, 446.33333333333314, 427.5388888888887, 442.4294444444442, 463.4438888888885, 456.81722222222186, 416.7716666666665, 458.5883333333329, 471.57888888888874, 441.87277777777746]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1976160881794401, "mean_inference_ms": 1.8028003733310767, "mean_action_processing_ms": 0.07507039908193774, "mean_env_wait_ms": 1.2221961837245143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004419803619384766, "StateBufferConnector_ms": 0.0030050277709960938, "ViewRequirementAgentConnector_ms": 0.06792497634887695}, "num_episodes": 30, "episode_return_max": 485.4055555555551, "episode_return_min": 390.88388888888846, "episode_return_mean": 441.5455222222219, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 319050, "num_agent_steps_trained": 318900, "num_env_steps_sampled": 319050, "num_env_steps_trained": 318900, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 284.79967146522273, "num_env_steps_trained_throughput_per_sec": 284.79967146522273, "timesteps_total": 319050, "num_env_steps_sampled_lifetime": 319050, "num_agent_steps_sampled_lifetime": 319050, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 319050, "timers": {"training_iteration_time_ms": 10308.803, "restore_workers_time_ms": 0.011, "training_step_time_ms": 533.861, "sample_time_ms": 518.927, "synch_weights_time_ms": 13.475}, "counters": {"num_env_steps_sampled": 319050, "num_env_steps_trained": 318900, "num_agent_steps_sampled": 319050, "num_agent_steps_trained": 318900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2127, "num_samples_added_to_queue": 318900}, "done": false, "training_iteration": 107, "trial_id": "0313d_00000", "date": "2024-10-10_21-59-49", "timestamp": 1728593989, "time_this_iter_s": 10.5531644821167, "time_total_s": 1102.060051202774, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c19d50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1102.060051202774, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 12.893333333333334, "ram_util_percent": 70.60666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 182760.40625, "policy_loss": 182353.6875, "entropy": 15.063644409179688, "entropy_coeff": 0.01, "var_gnorm": 16.630300521850586, "vf_loss": 451902.875, "vf_explained_var": -0.06233012676239014}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1073.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 322050, "num_env_steps_trained": 321900, "num_agent_steps_sampled": 322050, "num_agent_steps_trained": 321900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2147, "num_samples_added_to_queue": 321900, "learner_queue": {"size_count": 1073, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.456, "learner_load_time_ms": 0.292, "learner_load_wait_time_ms": 1012.497, "learner_dequeue_time_ms": 8568.549}}, "env_runners": {"episode_reward_max": 471.57888888888874, "episode_reward_min": 373.28888888888866, "episode_reward_mean": 438.33753333333306, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 373.28888888888866}, "policy_reward_max": {"default_policy": 471.57888888888874}, "policy_reward_mean": {"default_policy": 438.33753333333306}, "custom_metrics": {"num_consolidated_mean": 2.0562000000000005, "num_consolidated_min": 1.9, "num_consolidated_max": 2.25, "num_overloaded_mean": 0.0529, "num_overloaded_min": 0.01, "num_overloaded_max": 0.14, "num_moves_mean": 4.9872, "num_moves_min": 4.48, "num_moves_max": 5.43, "mean_accuracy_mean": 39.31108666666665, "mean_accuracy_min": 39.161999999999985, "mean_accuracy_max": 39.497666666666646, "num_model_switches_mean": 2.4251, "num_model_switches_min": 2.12, "num_model_switches_max": 2.82, "num_slav_mean": 0.0025631666666666663, "num_slav_min": 0.00016666666666666666, "num_slav_max": 0.006533333333333333, "mean_cluster_cpu_util_mean": 0.4650757833138402, "mean_cluster_cpu_util_min": 0.4544358651850671, "mean_cluster_cpu_util_max": 0.4821742662467241, "mean_cluster_mem_util_mean": 0.2926648088923333, "mean_cluster_mem_util_min": 0.28632882760699213, "mean_cluster_mem_util_max": 0.29988680358219233, "reward_consolidation_mean_mean": 2.6904166666666667, "reward_consolidation_mean_min": 2.402777777777778, "reward_consolidation_mean_max": 2.944444444444445, "reward_illegal_mean_mean": -0.08816666666666667, "reward_illegal_mean_min": -0.2333333333333333, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 1.8608253333333329, "reward_accuracy_mean_min": 1.6906666666666663, "reward_accuracy_mean_max": 1.9505333333333332, "reward_sla_mean_mean": -0.07970000000000002, "reward_sla_mean_min": -0.2177777777777778, "reward_sla_mean_max": -0.0044444444444444444, "reward_consolidation_sum_mean": 269.04166666666674, "reward_consolidation_sum_min": 240.2777777777778, "reward_consolidation_sum_max": 294.4444444444445, "reward_illegal_sum_mean": -8.816666666666665, "reward_illegal_sum_min": -23.333333333333332, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 186.08253333333334, "reward_accuracy_sum_min": 169.06666666666663, "reward_accuracy_sum_max": 195.0533333333333, "reward_sla_sum_mean": -7.97, "reward_sla_sum_min": -21.77777777777778, "reward_sla_sum_max": -0.4444444444444445, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4259.0, "global_timestep_min": 2100, "global_timestep_max": 5900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [433.76333333333275, 458.7299999999999, 427.55555555555554, 441.0411111111108, 450.53944444444414, 444.67444444444413, 447.75611111111084, 433.38111111111095, 445.7138888888887, 466.5638888888886, 427.9616666666663, 445.61888888888853, 456.7772222222219, 420.1361111111107, 439.4611111111108, 429.3249999999996, 460.59666666666635, 466.4827777777777, 441.94333333333293, 420.8038888888885, 423.15944444444426, 439.468333333333, 390.88388888888846, 433.1922222222219, 398.10611111111086, 463.62833333333316, 438.38055555555525, 427.59555555555505, 453.3027777777777, 470.55499999999967, 449.80999999999955, 455.4188888888887, 448.0416666666661, 409.74833333333305, 448.11944444444396, 436.31833333333327, 429.0494444444442, 443.28611111111087, 448.23833333333295, 465.20722222222184, 413.10333333333296, 427.1677777777774, 434.41333333333307, 432.29277777777753, 425.4772222222218, 418.2305555555551, 451.08055555555546, 447.27888888888856, 442.08666666666653, 422.74055555555543, 446.1988888888886, 442.5077777777775, 393.59833333333296, 460.50833333333276, 397.84555555555505, 425.81722222222203, 437.4138888888886, 422.68388888888836, 430.30111111111097, 434.1277777777774, 399.1849999999998, 446.33333333333314, 427.5388888888887, 442.4294444444442, 463.4438888888885, 456.81722222222186, 416.7716666666665, 458.5883333333329, 471.57888888888874, 441.87277777777746, 438.17388888888865, 466.5955555555554, 423.71499999999963, 453.81777777777745, 459.88666666666643, 460.93666666666627, 456.1022222222219, 402.9305555555553, 443.4199999999998, 450.6488888888888, 423.44611111111095, 447.86555555555515, 456.2927777777775, 411.2788888888887, 444.66777777777736, 440.4044444444441, 447.33277777777715, 451.3727777777774, 391.9555555555555, 430.00944444444417, 451.0788888888887, 463.58055555555524, 373.28888888888866, 439.4922222222219, 405.0577777777775, 441.6116666666665, 436.50833333333304, 452.76777777777755, 454.34166666666624, 455.40277777777743], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [433.76333333333275, 458.7299999999999, 427.55555555555554, 441.0411111111108, 450.53944444444414, 444.67444444444413, 447.75611111111084, 433.38111111111095, 445.7138888888887, 466.5638888888886, 427.9616666666663, 445.61888888888853, 456.7772222222219, 420.1361111111107, 439.4611111111108, 429.3249999999996, 460.59666666666635, 466.4827777777777, 441.94333333333293, 420.8038888888885, 423.15944444444426, 439.468333333333, 390.88388888888846, 433.1922222222219, 398.10611111111086, 463.62833333333316, 438.38055555555525, 427.59555555555505, 453.3027777777777, 470.55499999999967, 449.80999999999955, 455.4188888888887, 448.0416666666661, 409.74833333333305, 448.11944444444396, 436.31833333333327, 429.0494444444442, 443.28611111111087, 448.23833333333295, 465.20722222222184, 413.10333333333296, 427.1677777777774, 434.41333333333307, 432.29277777777753, 425.4772222222218, 418.2305555555551, 451.08055555555546, 447.27888888888856, 442.08666666666653, 422.74055555555543, 446.1988888888886, 442.5077777777775, 393.59833333333296, 460.50833333333276, 397.84555555555505, 425.81722222222203, 437.4138888888886, 422.68388888888836, 430.30111111111097, 434.1277777777774, 399.1849999999998, 446.33333333333314, 427.5388888888887, 442.4294444444442, 463.4438888888885, 456.81722222222186, 416.7716666666665, 458.5883333333329, 471.57888888888874, 441.87277777777746, 438.17388888888865, 466.5955555555554, 423.71499999999963, 453.81777777777745, 459.88666666666643, 460.93666666666627, 456.1022222222219, 402.9305555555553, 443.4199999999998, 450.6488888888888, 423.44611111111095, 447.86555555555515, 456.2927777777775, 411.2788888888887, 444.66777777777736, 440.4044444444441, 447.33277777777715, 451.3727777777774, 391.9555555555555, 430.00944444444417, 451.0788888888887, 463.58055555555524, 373.28888888888866, 439.4922222222219, 405.0577777777775, 441.6116666666665, 436.50833333333304, 452.76777777777755, 454.34166666666624, 455.40277777777743]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1976992334659991, "mean_inference_ms": 1.8046539071437089, "mean_action_processing_ms": 0.07510218934108687, "mean_env_wait_ms": 1.222691593729762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004367828369140625, "StateBufferConnector_ms": 0.002987384796142578, "ViewRequirementAgentConnector_ms": 0.06704950332641602}, "num_episodes": 30, "episode_return_max": 471.57888888888874, "episode_return_min": 373.28888888888866, "episode_return_mean": 438.33753333333306, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 322050, "num_agent_steps_trained": 321900, "num_env_steps_sampled": 322050, "num_env_steps_trained": 321900, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 285.1419130837952, "num_env_steps_trained_throughput_per_sec": 285.1419130837952, "timesteps_total": 322050, "num_env_steps_sampled_lifetime": 322050, "num_agent_steps_sampled_lifetime": 322050, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 322050, "timers": {"training_iteration_time_ms": 10351.838, "restore_workers_time_ms": 0.012, "training_step_time_ms": 545.304, "sample_time_ms": 530.433, "synch_weights_time_ms": 13.501}, "counters": {"num_env_steps_sampled": 322050, "num_env_steps_trained": 321900, "num_agent_steps_sampled": 322050, "num_agent_steps_trained": 321900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2147, "num_samples_added_to_queue": 321900}, "done": false, "training_iteration": 108, "trial_id": "0313d_00000", "date": "2024-10-10_22-00-00", "timestamp": 1728594000, "time_this_iter_s": 10.532735586166382, "time_total_s": 1112.5927867889404, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d8add0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1112.5927867889404, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 12.353333333333333, "ram_util_percent": 70.77333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 175397.734375, "policy_loss": 175004.71875, "entropy": 15.238590240478516, "entropy_coeff": 0.01, "var_gnorm": 16.629497528076172, "vf_loss": 438729.5, "vf_explained_var": -0.05465495586395264}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1082.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 324900, "num_env_steps_trained": 324600, "num_agent_steps_sampled": 324900, "num_agent_steps_trained": 324600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2166, "num_samples_added_to_queue": 324900, "learner_queue": {"size_count": 1082, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 51.433, "learner_load_time_ms": 0.315, "learner_load_wait_time_ms": 1021.428, "learner_dequeue_time_ms": 8536.825}}, "env_runners": {"episode_reward_max": 471.61888888888876, "episode_reward_min": 373.28888888888866, "episode_reward_mean": 439.8470055555552, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 373.28888888888866}, "policy_reward_max": {"default_policy": 471.61888888888876}, "policy_reward_mean": {"default_policy": 439.8470055555552}, "custom_metrics": {"num_consolidated_mean": 2.0631, "num_consolidated_min": 1.91, "num_consolidated_max": 2.23, "num_overloaded_mean": 0.05250000000000001, "num_overloaded_min": 0.01, "num_overloaded_max": 0.14, "num_moves_mean": 4.9625, "num_moves_min": 4.48, "num_moves_max": 5.49, "mean_accuracy_mean": 39.32014333333332, "mean_accuracy_min": 39.12399999999998, "mean_accuracy_max": 39.503999999999984, "num_model_switches_mean": 2.4155, "num_model_switches_min": 2.06, "num_model_switches_max": 2.77, "num_slav_mean": 0.0024226666666666667, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.005066666666666666, "mean_cluster_cpu_util_mean": 0.46606234883400044, "mean_cluster_cpu_util_min": 0.4544358651850671, "mean_cluster_cpu_util_max": 0.4809034652015476, "mean_cluster_mem_util_mean": 0.2929943290475473, "mean_cluster_mem_util_min": 0.28632882760699213, "mean_cluster_mem_util_max": 0.29905950891960165, "reward_consolidation_mean_mean": 2.7006944444444447, "reward_consolidation_mean_min": 2.402777777777778, "reward_consolidation_mean_max": 2.958333333333334, "reward_illegal_mean_mean": -0.0875, "reward_illegal_mean_min": -0.2333333333333333, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 1.8620811666666668, "reward_accuracy_mean_min": 1.6906666666666663, "reward_accuracy_mean_max": 1.9505333333333332, "reward_sla_mean_mean": -0.07680555555555554, "reward_sla_mean_min": -0.16777777777777778, "reward_sla_mean_max": -0.0033333333333333335, "reward_consolidation_sum_mean": 270.0694444444445, "reward_consolidation_sum_min": 240.2777777777778, "reward_consolidation_sum_max": 295.83333333333337, "reward_illegal_sum_mean": -8.749999999999998, "reward_illegal_sum_min": -23.333333333333332, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 186.20811666666657, "reward_accuracy_sum_min": 169.06666666666663, "reward_accuracy_sum_max": 195.0533333333333, "reward_sla_sum_mean": -7.6805555555555545, "reward_sla_sum_min": -16.77777777777778, "reward_sla_sum_max": -0.33333333333333337, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5250.0, "global_timestep_min": 3000, "global_timestep_max": 6900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [449.80999999999955, 455.4188888888887, 448.0416666666661, 409.74833333333305, 448.11944444444396, 436.31833333333327, 429.0494444444442, 443.28611111111087, 448.23833333333295, 465.20722222222184, 413.10333333333296, 427.1677777777774, 434.41333333333307, 432.29277777777753, 425.4772222222218, 418.2305555555551, 451.08055555555546, 447.27888888888856, 442.08666666666653, 422.74055555555543, 446.1988888888886, 442.5077777777775, 393.59833333333296, 460.50833333333276, 397.84555555555505, 425.81722222222203, 437.4138888888886, 422.68388888888836, 430.30111111111097, 434.1277777777774, 399.1849999999998, 446.33333333333314, 427.5388888888887, 442.4294444444442, 463.4438888888885, 456.81722222222186, 416.7716666666665, 458.5883333333329, 471.57888888888874, 441.87277777777746, 438.17388888888865, 466.5955555555554, 423.71499999999963, 453.81777777777745, 459.88666666666643, 460.93666666666627, 456.1022222222219, 402.9305555555553, 443.4199999999998, 450.6488888888888, 423.44611111111095, 447.86555555555515, 456.2927777777775, 411.2788888888887, 444.66777777777736, 440.4044444444441, 447.33277777777715, 451.3727777777774, 391.9555555555555, 430.00944444444417, 451.0788888888887, 463.58055555555524, 373.28888888888866, 439.4922222222219, 405.0577777777775, 441.6116666666665, 436.50833333333304, 452.76777777777755, 454.34166666666624, 455.40277777777743, 456.6511111111109, 411.707222222222, 438.37333333333294, 423.4455555555556, 443.053333333333, 462.98444444444397, 424.28888888888866, 454.2927777777774, 449.06999999999965, 452.2627777777775, 470.72111111111093, 449.00611111111084, 440.77111111111077, 453.2849999999998, 457.8177777777776, 439.65111111111065, 471.61888888888876, 422.2066666666664, 429.96722222222195, 457.10999999999956, 428.4361111111109, 430.4949999999998, 446.03222222222183, 432.9138888888885, 451.4922222222218, 466.87222222222204, 435.7944444444442, 450.3099999999996, 441.15999999999974, 456.2544444444443], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [449.80999999999955, 455.4188888888887, 448.0416666666661, 409.74833333333305, 448.11944444444396, 436.31833333333327, 429.0494444444442, 443.28611111111087, 448.23833333333295, 465.20722222222184, 413.10333333333296, 427.1677777777774, 434.41333333333307, 432.29277777777753, 425.4772222222218, 418.2305555555551, 451.08055555555546, 447.27888888888856, 442.08666666666653, 422.74055555555543, 446.1988888888886, 442.5077777777775, 393.59833333333296, 460.50833333333276, 397.84555555555505, 425.81722222222203, 437.4138888888886, 422.68388888888836, 430.30111111111097, 434.1277777777774, 399.1849999999998, 446.33333333333314, 427.5388888888887, 442.4294444444442, 463.4438888888885, 456.81722222222186, 416.7716666666665, 458.5883333333329, 471.57888888888874, 441.87277777777746, 438.17388888888865, 466.5955555555554, 423.71499999999963, 453.81777777777745, 459.88666666666643, 460.93666666666627, 456.1022222222219, 402.9305555555553, 443.4199999999998, 450.6488888888888, 423.44611111111095, 447.86555555555515, 456.2927777777775, 411.2788888888887, 444.66777777777736, 440.4044444444441, 447.33277777777715, 451.3727777777774, 391.9555555555555, 430.00944444444417, 451.0788888888887, 463.58055555555524, 373.28888888888866, 439.4922222222219, 405.0577777777775, 441.6116666666665, 436.50833333333304, 452.76777777777755, 454.34166666666624, 455.40277777777743, 456.6511111111109, 411.707222222222, 438.37333333333294, 423.4455555555556, 443.053333333333, 462.98444444444397, 424.28888888888866, 454.2927777777774, 449.06999999999965, 452.2627777777775, 470.72111111111093, 449.00611111111084, 440.77111111111077, 453.2849999999998, 457.8177777777776, 439.65111111111065, 471.61888888888876, 422.2066666666664, 429.96722222222195, 457.10999999999956, 428.4361111111109, 430.4949999999998, 446.03222222222183, 432.9138888888885, 451.4922222222218, 466.87222222222204, 435.7944444444442, 450.3099999999996, 441.15999999999974, 456.2544444444443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19775945302908413, "mean_inference_ms": 1.804743912169261, "mean_action_processing_ms": 0.07512047671345565, "mean_env_wait_ms": 1.222882840450994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004527091979980469, "StateBufferConnector_ms": 0.003027677536010742, "ViewRequirementAgentConnector_ms": 0.06878018379211426}, "num_episodes": 30, "episode_return_max": 471.61888888888876, "episode_return_min": 373.28888888888866, "episode_return_mean": 439.8470055555552, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324900, "num_agent_steps_trained": 324600, "num_env_steps_sampled": 324900, "num_env_steps_trained": 324600, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 280.44983399551035, "num_env_steps_trained_throughput_per_sec": 265.6893164167993, "timesteps_total": 324900, "num_env_steps_sampled_lifetime": 324900, "num_agent_steps_sampled_lifetime": 324900, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 324900, "timers": {"training_iteration_time_ms": 10341.389, "restore_workers_time_ms": 0.011, "training_step_time_ms": 513.257, "sample_time_ms": 498.697, "synch_weights_time_ms": 13.185}, "counters": {"num_env_steps_sampled": 324900, "num_env_steps_trained": 324600, "num_agent_steps_sampled": 324900, "num_agent_steps_trained": 324600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2166, "num_samples_added_to_queue": 324900}, "done": false, "training_iteration": 109, "trial_id": "0313d_00000", "date": "2024-10-10_22-00-10", "timestamp": 1728594010, "time_this_iter_s": 10.179359197616577, "time_total_s": 1122.772145986557, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a6a70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1122.772145986557, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 13.593333333333332, "ram_util_percent": 71.36}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 189193.734375, "policy_loss": 188806.421875, "entropy": 15.719657897949219, "entropy_coeff": 0.01, "var_gnorm": 16.6236515045166, "vf_loss": 434475.28125, "vf_explained_var": -0.04403388500213623}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1092.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 327900, "num_env_steps_trained": 327600, "num_agent_steps_sampled": 327900, "num_agent_steps_trained": 327600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2186, "num_samples_added_to_queue": 327900, "learner_queue": {"size_count": 1092, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 72.689, "learner_load_time_ms": 0.339, "learner_load_wait_time_ms": 978.935, "learner_dequeue_time_ms": 8575.537}}, "env_runners": {"episode_reward_max": 485.73611111111074, "episode_reward_min": 373.28888888888866, "episode_reward_mean": 441.172183333333, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 373.28888888888866}, "policy_reward_max": {"default_policy": 485.73611111111074}, "policy_reward_mean": {"default_policy": 441.172183333333}, "custom_metrics": {"num_consolidated_mean": 2.0560000000000005, "num_consolidated_min": 1.91, "num_consolidated_max": 2.23, "num_overloaded_mean": 0.04920000000000001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.14, "num_moves_mean": 5.0187, "num_moves_min": 4.48, "num_moves_max": 5.56, "mean_accuracy_mean": 39.35003666666665, "mean_accuracy_min": 39.12399999999998, "mean_accuracy_max": 39.567333333333316, "num_model_switches_mean": 2.4439, "num_model_switches_min": 2.06, "num_model_switches_max": 2.8, "num_slav_mean": 0.0024828333333333334, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0051, "mean_cluster_cpu_util_mean": 0.4656964589620086, "mean_cluster_cpu_util_min": 0.44721499273739745, "mean_cluster_cpu_util_max": 0.4796048081489282, "mean_cluster_mem_util_mean": 0.29290701513390166, "mean_cluster_mem_util_min": 0.28608554385889373, "mean_cluster_mem_util_max": 0.29905950891960165, "reward_consolidation_mean_mean": 2.702777777777779, "reward_consolidation_mean_min": 2.416666666666667, "reward_consolidation_mean_max": 2.9861111111111116, "reward_illegal_mean_mean": -0.08199999999999999, "reward_illegal_mean_min": -0.2333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.8699551666666665, "reward_accuracy_mean_min": 1.6906666666666663, "reward_accuracy_mean_max": 1.9688666666666665, "reward_sla_mean_mean": -0.0790111111111111, "reward_sla_mean_min": -0.17, "reward_sla_mean_max": -0.0033333333333333335, "reward_consolidation_sum_mean": 270.2777777777779, "reward_consolidation_sum_min": 241.66666666666669, "reward_consolidation_sum_max": 298.61111111111114, "reward_illegal_sum_mean": -8.2, "reward_illegal_sum_min": -23.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 186.99551666666667, "reward_accuracy_sum_min": 169.06666666666663, "reward_accuracy_sum_max": 196.88666666666666, "reward_sla_sum_mean": -7.901111111111111, "reward_sla_sum_min": -17.0, "reward_sla_sum_max": -0.33333333333333337, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6016.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [399.1849999999998, 446.33333333333314, 427.5388888888887, 442.4294444444442, 463.4438888888885, 456.81722222222186, 416.7716666666665, 458.5883333333329, 471.57888888888874, 441.87277777777746, 438.17388888888865, 466.5955555555554, 423.71499999999963, 453.81777777777745, 459.88666666666643, 460.93666666666627, 456.1022222222219, 402.9305555555553, 443.4199999999998, 450.6488888888888, 423.44611111111095, 447.86555555555515, 456.2927777777775, 411.2788888888887, 444.66777777777736, 440.4044444444441, 447.33277777777715, 451.3727777777774, 391.9555555555555, 430.00944444444417, 451.0788888888887, 463.58055555555524, 373.28888888888866, 439.4922222222219, 405.0577777777775, 441.6116666666665, 436.50833333333304, 452.76777777777755, 454.34166666666624, 455.40277777777743, 456.6511111111109, 411.707222222222, 438.37333333333294, 423.4455555555556, 443.053333333333, 462.98444444444397, 424.28888888888866, 454.2927777777774, 449.06999999999965, 452.2627777777775, 470.72111111111093, 449.00611111111084, 440.77111111111077, 453.2849999999998, 457.8177777777776, 439.65111111111065, 471.61888888888876, 422.2066666666664, 429.96722222222195, 457.10999999999956, 428.4361111111109, 430.4949999999998, 446.03222222222183, 432.9138888888885, 451.4922222222218, 466.87222222222204, 435.7944444444442, 450.3099999999996, 441.15999999999974, 456.2544444444443, 447.41944444444397, 438.12666666666615, 447.0949999999997, 446.33166666666637, 415.9194444444439, 421.6905555555553, 436.4194444444442, 433.44277777777745, 442.7299999999998, 423.0949999999997, 423.01722222222185, 433.82555555555535, 444.20499999999953, 433.45111111111083, 452.3161111111106, 431.4583333333331, 465.16611111111075, 448.33999999999963, 431.6261111111109, 432.6738888888884, 407.2622222222218, 447.08666666666625, 485.73611111111074, 483.7755555555554, 427.52388888888856, 426.3738888888886, 426.63388888888863, 444.2777777777777, 418.3177777777774, 455.29277777777753], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [399.1849999999998, 446.33333333333314, 427.5388888888887, 442.4294444444442, 463.4438888888885, 456.81722222222186, 416.7716666666665, 458.5883333333329, 471.57888888888874, 441.87277777777746, 438.17388888888865, 466.5955555555554, 423.71499999999963, 453.81777777777745, 459.88666666666643, 460.93666666666627, 456.1022222222219, 402.9305555555553, 443.4199999999998, 450.6488888888888, 423.44611111111095, 447.86555555555515, 456.2927777777775, 411.2788888888887, 444.66777777777736, 440.4044444444441, 447.33277777777715, 451.3727777777774, 391.9555555555555, 430.00944444444417, 451.0788888888887, 463.58055555555524, 373.28888888888866, 439.4922222222219, 405.0577777777775, 441.6116666666665, 436.50833333333304, 452.76777777777755, 454.34166666666624, 455.40277777777743, 456.6511111111109, 411.707222222222, 438.37333333333294, 423.4455555555556, 443.053333333333, 462.98444444444397, 424.28888888888866, 454.2927777777774, 449.06999999999965, 452.2627777777775, 470.72111111111093, 449.00611111111084, 440.77111111111077, 453.2849999999998, 457.8177777777776, 439.65111111111065, 471.61888888888876, 422.2066666666664, 429.96722222222195, 457.10999999999956, 428.4361111111109, 430.4949999999998, 446.03222222222183, 432.9138888888885, 451.4922222222218, 466.87222222222204, 435.7944444444442, 450.3099999999996, 441.15999999999974, 456.2544444444443, 447.41944444444397, 438.12666666666615, 447.0949999999997, 446.33166666666637, 415.9194444444439, 421.6905555555553, 436.4194444444442, 433.44277777777745, 442.7299999999998, 423.0949999999997, 423.01722222222185, 433.82555555555535, 444.20499999999953, 433.45111111111083, 452.3161111111106, 431.4583333333331, 465.16611111111075, 448.33999999999963, 431.6261111111109, 432.6738888888884, 407.2622222222218, 447.08666666666625, 485.73611111111074, 483.7755555555554, 427.52388888888856, 426.3738888888886, 426.63388888888863, 444.2777777777777, 418.3177777777774, 455.29277777777753]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19782006458161583, "mean_inference_ms": 1.8049805367105352, "mean_action_processing_ms": 0.07513972595775044, "mean_env_wait_ms": 1.2231336884937654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004645824432373047, "StateBufferConnector_ms": 0.003053903579711914, "ViewRequirementAgentConnector_ms": 0.07062864303588867}, "num_episodes": 30, "episode_return_max": 485.73611111111074, "episode_return_min": 373.28888888888866, "episode_return_mean": 441.172183333333, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 327900, "num_agent_steps_trained": 327600, "num_env_steps_sampled": 327900, "num_env_steps_trained": 327600, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 287.5195007586427, "num_env_steps_trained_throughput_per_sec": 287.5195007586427, "timesteps_total": 327900, "num_env_steps_sampled_lifetime": 327900, "num_agent_steps_sampled_lifetime": 327900, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 327900, "timers": {"training_iteration_time_ms": 10354.613, "restore_workers_time_ms": 0.013, "training_step_time_ms": 499.533, "sample_time_ms": 485.98, "synch_weights_time_ms": 12.218}, "counters": {"num_env_steps_sampled": 327900, "num_env_steps_trained": 327600, "num_agent_steps_sampled": 327900, "num_agent_steps_trained": 327600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2186, "num_samples_added_to_queue": 327900}, "done": false, "training_iteration": 110, "trial_id": "0313d_00000", "date": "2024-10-10_22-00-21", "timestamp": 1728594021, "time_this_iter_s": 10.443642616271973, "time_total_s": 1133.215788602829, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c18b80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1133.215788602829, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 13.26666666666667, "ram_util_percent": 71.24666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 179275.28125, "policy_loss": 178911.765625, "entropy": 15.640045166015625, "entropy_coeff": 0.01, "var_gnorm": 16.614471435546875, "vf_loss": 410431.65625, "vf_explained_var": -0.035484910011291504}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1103.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 331050, "num_env_steps_trained": 330900, "num_agent_steps_sampled": 331050, "num_agent_steps_trained": 330900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2207, "num_samples_added_to_queue": 330900, "learner_queue": {"size_count": 1103, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.437, "learner_load_time_ms": 0.356, "learner_load_wait_time_ms": 925.871, "learner_dequeue_time_ms": 8498.817}}, "env_runners": {"episode_reward_max": 485.73611111111074, "episode_reward_min": 373.28888888888866, "episode_reward_mean": 441.689033333333, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 373.28888888888866}, "policy_reward_max": {"default_policy": 485.73611111111074}, "policy_reward_mean": {"default_policy": 441.689033333333}, "custom_metrics": {"num_consolidated_mean": 2.0477000000000003, "num_consolidated_min": 1.91, "num_consolidated_max": 2.23, "num_overloaded_mean": 0.04739999999999999, "num_overloaded_min": 0.0, "num_overloaded_max": 0.14, "num_moves_mean": 5.103599999999999, "num_moves_min": 4.59, "num_moves_max": 5.56, "mean_accuracy_mean": 39.37125333333332, "mean_accuracy_min": 39.12399999999998, "mean_accuracy_max": 39.57366666666665, "num_model_switches_mean": 2.481, "num_model_switches_min": 2.06, "num_model_switches_max": 2.8, "num_slav_mean": 0.0024618333333333332, "num_slav_min": 0.00011666666666666667, "num_slav_max": 0.0051, "mean_cluster_cpu_util_mean": 0.4646869807637784, "mean_cluster_cpu_util_min": 0.44721499273739745, "mean_cluster_cpu_util_max": 0.4796048081489282, "mean_cluster_mem_util_mean": 0.29267529703780243, "mean_cluster_mem_util_min": 0.28608554385889373, "mean_cluster_mem_util_max": 0.29905950891960165, "reward_consolidation_mean_mean": 2.699722222222223, "reward_consolidation_mean_min": 2.416666666666667, "reward_consolidation_mean_max": 2.9861111111111116, "reward_illegal_mean_mean": -0.07899999999999999, "reward_illegal_mean_min": -0.2333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.8744236666666663, "reward_accuracy_mean_min": 1.6906666666666663, "reward_accuracy_mean_max": 1.9688666666666665, "reward_sla_mean_mean": -0.07825555555555556, "reward_sla_mean_min": -0.17, "reward_sla_mean_max": -0.0033333333333333335, "reward_consolidation_sum_mean": 269.9722222222223, "reward_consolidation_sum_min": 241.66666666666669, "reward_consolidation_sum_max": 298.61111111111114, "reward_illegal_sum_mean": -7.9, "reward_illegal_sum_min": -23.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 187.4423666666667, "reward_accuracy_sum_min": 169.06666666666663, "reward_accuracy_sum_max": 196.88666666666666, "reward_sla_sum_mean": -7.825555555555556, "reward_sla_sum_min": -17.0, "reward_sla_sum_max": -0.33333333333333337, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4676.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [451.0788888888887, 463.58055555555524, 373.28888888888866, 439.4922222222219, 405.0577777777775, 441.6116666666665, 436.50833333333304, 452.76777777777755, 454.34166666666624, 455.40277777777743, 456.6511111111109, 411.707222222222, 438.37333333333294, 423.4455555555556, 443.053333333333, 462.98444444444397, 424.28888888888866, 454.2927777777774, 449.06999999999965, 452.2627777777775, 470.72111111111093, 449.00611111111084, 440.77111111111077, 453.2849999999998, 457.8177777777776, 439.65111111111065, 471.61888888888876, 422.2066666666664, 429.96722222222195, 457.10999999999956, 428.4361111111109, 430.4949999999998, 446.03222222222183, 432.9138888888885, 451.4922222222218, 466.87222222222204, 435.7944444444442, 450.3099999999996, 441.15999999999974, 456.2544444444443, 447.41944444444397, 438.12666666666615, 447.0949999999997, 446.33166666666637, 415.9194444444439, 421.6905555555553, 436.4194444444442, 433.44277777777745, 442.7299999999998, 423.0949999999997, 423.01722222222185, 433.82555555555535, 444.20499999999953, 433.45111111111083, 452.3161111111106, 431.4583333333331, 465.16611111111075, 448.33999999999963, 431.6261111111109, 432.6738888888884, 407.2622222222218, 447.08666666666625, 485.73611111111074, 483.7755555555554, 427.52388888888856, 426.3738888888886, 426.63388888888863, 444.2777777777777, 418.3177777777774, 455.29277777777753, 446.2216666666665, 422.5316666666664, 430.39777777777743, 413.40499999999986, 426.8805555555552, 441.6977777777772, 443.2688888888887, 433.67444444444413, 450.94277777777745, 457.33944444444404, 477.4594444444444, 455.1338888888887, 435.96722222222184, 435.9105555555554, 452.26888888888857, 467.4666666666665, 417.5633333333331, 438.0961111111108, 460.6011111111107, 427.0866666666665, 466.96722222222195, 419.33333333333303, 451.0316666666664, 427.612222222222, 425.08722222222195, 467.5305555555553, 459.29333333333295, 447.1094444444443, 429.6405555555553, 449.5783333333329], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [451.0788888888887, 463.58055555555524, 373.28888888888866, 439.4922222222219, 405.0577777777775, 441.6116666666665, 436.50833333333304, 452.76777777777755, 454.34166666666624, 455.40277777777743, 456.6511111111109, 411.707222222222, 438.37333333333294, 423.4455555555556, 443.053333333333, 462.98444444444397, 424.28888888888866, 454.2927777777774, 449.06999999999965, 452.2627777777775, 470.72111111111093, 449.00611111111084, 440.77111111111077, 453.2849999999998, 457.8177777777776, 439.65111111111065, 471.61888888888876, 422.2066666666664, 429.96722222222195, 457.10999999999956, 428.4361111111109, 430.4949999999998, 446.03222222222183, 432.9138888888885, 451.4922222222218, 466.87222222222204, 435.7944444444442, 450.3099999999996, 441.15999999999974, 456.2544444444443, 447.41944444444397, 438.12666666666615, 447.0949999999997, 446.33166666666637, 415.9194444444439, 421.6905555555553, 436.4194444444442, 433.44277777777745, 442.7299999999998, 423.0949999999997, 423.01722222222185, 433.82555555555535, 444.20499999999953, 433.45111111111083, 452.3161111111106, 431.4583333333331, 465.16611111111075, 448.33999999999963, 431.6261111111109, 432.6738888888884, 407.2622222222218, 447.08666666666625, 485.73611111111074, 483.7755555555554, 427.52388888888856, 426.3738888888886, 426.63388888888863, 444.2777777777777, 418.3177777777774, 455.29277777777753, 446.2216666666665, 422.5316666666664, 430.39777777777743, 413.40499999999986, 426.8805555555552, 441.6977777777772, 443.2688888888887, 433.67444444444413, 450.94277777777745, 457.33944444444404, 477.4594444444444, 455.1338888888887, 435.96722222222184, 435.9105555555554, 452.26888888888857, 467.4666666666665, 417.5633333333331, 438.0961111111108, 460.6011111111107, 427.0866666666665, 466.96722222222195, 419.33333333333303, 451.0316666666664, 427.612222222222, 425.08722222222195, 467.5305555555553, 459.29333333333295, 447.1094444444443, 429.6405555555553, 449.5783333333329]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19783099054831946, "mean_inference_ms": 1.8048008998156362, "mean_action_processing_ms": 0.07514012260679202, "mean_env_wait_ms": 1.2231448293304719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004619121551513672, "StateBufferConnector_ms": 0.002987384796142578, "ViewRequirementAgentConnector_ms": 0.06831550598144531}, "num_episodes": 30, "episode_return_max": 485.73611111111074, "episode_return_min": 373.28888888888866, "episode_return_mean": 441.689033333333, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 331050, "num_agent_steps_trained": 330900, "num_env_steps_sampled": 331050, "num_env_steps_trained": 330900, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 303.54949407834084, "num_env_steps_trained_throughput_per_sec": 318.00423189159517, "timesteps_total": 331050, "num_env_steps_sampled_lifetime": 331050, "num_agent_steps_sampled_lifetime": 331050, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 331050, "timers": {"training_iteration_time_ms": 10371.347, "restore_workers_time_ms": 0.012, "training_step_time_ms": 503.009, "sample_time_ms": 488.945, "synch_weights_time_ms": 12.798}, "counters": {"num_env_steps_sampled": 331050, "num_env_steps_trained": 330900, "num_agent_steps_sampled": 331050, "num_agent_steps_trained": 330900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2207, "num_samples_added_to_queue": 330900}, "done": false, "training_iteration": 111, "trial_id": "0313d_00000", "date": "2024-10-10_22-00-31", "timestamp": 1728594031, "time_this_iter_s": 10.39211392402649, "time_total_s": 1143.6079025268555, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c2af80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1143.6079025268555, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 10.900000000000002, "ram_util_percent": 71.36666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 172423.171875, "policy_loss": 172082.4375, "entropy": 15.702959060668945, "entropy_coeff": 0.01, "var_gnorm": 16.615825653076172, "vf_loss": 387850.875, "vf_explained_var": -0.027203798294067383}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1113.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 334050, "num_env_steps_trained": 333900, "num_agent_steps_sampled": 334050, "num_agent_steps_trained": 333900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2227, "num_samples_added_to_queue": 333900, "learner_queue": {"size_count": 1113, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.926, "learner_load_time_ms": 0.34, "learner_load_wait_time_ms": 999.445, "learner_dequeue_time_ms": 8445.877}}, "env_runners": {"episode_reward_max": 485.73611111111074, "episode_reward_min": 395.92833333333317, "episode_reward_mean": 439.3371777777774, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 395.92833333333317}, "policy_reward_max": {"default_policy": 485.73611111111074}, "policy_reward_mean": {"default_policy": 439.3371777777774}, "custom_metrics": {"num_consolidated_mean": 2.0388, "num_consolidated_min": 1.91, "num_consolidated_max": 2.23, "num_overloaded_mean": 0.04879999999999999, "num_overloaded_min": 0.0, "num_overloaded_max": 0.1, "num_moves_mean": 5.1715, "num_moves_min": 4.68, "num_moves_max": 5.72, "mean_accuracy_mean": 39.397093333333316, "mean_accuracy_min": 39.250666666666646, "mean_accuracy_max": 39.57366666666665, "num_model_switches_mean": 2.5432, "num_model_switches_min": 2.11, "num_model_switches_max": 2.9, "num_slav_mean": 0.002556, "num_slav_min": 0.00011666666666666667, "num_slav_max": 0.00665, "mean_cluster_cpu_util_mean": 0.4632860667207402, "mean_cluster_cpu_util_min": 0.4460266881799983, "mean_cluster_cpu_util_max": 0.4796048081489282, "mean_cluster_mem_util_mean": 0.2921371764706938, "mean_cluster_mem_util_min": 0.2850798108800482, "mean_cluster_mem_util_max": 0.29905950891960165, "reward_consolidation_mean_mean": 2.6822222222222223, "reward_consolidation_mean_min": 2.486111111111111, "reward_consolidation_mean_max": 2.9861111111111116, "reward_illegal_mean_mean": -0.08133333333333331, "reward_illegal_mean_min": -0.16666666666666669, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.8731106666666664, "reward_accuracy_mean_min": 1.7719166666666664, "reward_accuracy_mean_max": 1.9688666666666665, "reward_sla_mean_mean": -0.08062777777777778, "reward_sla_mean_min": -0.22166666666666668, "reward_sla_mean_max": -0.0033333333333333335, "reward_consolidation_sum_mean": 268.22222222222223, "reward_consolidation_sum_min": 248.61111111111111, "reward_consolidation_sum_max": 298.61111111111114, "reward_illegal_sum_mean": -8.133333333333333, "reward_illegal_sum_min": -16.666666666666668, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 187.3110666666667, "reward_accuracy_sum_min": 177.19166666666663, "reward_accuracy_sum_max": 196.88666666666666, "reward_sla_sum_mean": -8.062777777777779, "reward_sla_sum_min": -22.166666666666668, "reward_sla_sum_max": -0.33333333333333337, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3336.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [428.4361111111109, 430.4949999999998, 446.03222222222183, 432.9138888888885, 451.4922222222218, 466.87222222222204, 435.7944444444442, 450.3099999999996, 441.15999999999974, 456.2544444444443, 447.41944444444397, 438.12666666666615, 447.0949999999997, 446.33166666666637, 415.9194444444439, 421.6905555555553, 436.4194444444442, 433.44277777777745, 442.7299999999998, 423.0949999999997, 423.01722222222185, 433.82555555555535, 444.20499999999953, 433.45111111111083, 452.3161111111106, 431.4583333333331, 465.16611111111075, 448.33999999999963, 431.6261111111109, 432.6738888888884, 407.2622222222218, 447.08666666666625, 485.73611111111074, 483.7755555555554, 427.52388888888856, 426.3738888888886, 426.63388888888863, 444.2777777777777, 418.3177777777774, 455.29277777777753, 446.2216666666665, 422.5316666666664, 430.39777777777743, 413.40499999999986, 426.8805555555552, 441.6977777777772, 443.2688888888887, 433.67444444444413, 450.94277777777745, 457.33944444444404, 477.4594444444444, 455.1338888888887, 435.96722222222184, 435.9105555555554, 452.26888888888857, 467.4666666666665, 417.5633333333331, 438.0961111111108, 460.6011111111107, 427.0866666666665, 466.96722222222195, 419.33333333333303, 451.0316666666664, 427.612222222222, 425.08722222222195, 467.5305555555553, 459.29333333333295, 447.1094444444443, 429.6405555555553, 449.5783333333329, 434.41388888888855, 411.09611111111076, 422.99999999999966, 435.80833333333294, 455.013333333333, 426.498333333333, 442.7133333333333, 397.30277777777764, 453.2366666666664, 450.2516666666662, 440.3566666666664, 447.7283333333329, 442.37111111111085, 435.04555555555527, 453.8549999999997, 425.46944444444404, 422.1594444444443, 428.92055555555544, 449.7538888888885, 431.43444444444424, 395.92833333333317, 436.4988888888884, 444.29333333333307, 436.4661111111107, 410.3899999999997, 464.8383333333332, 429.07111111111067, 455.8161111111107, 462.2666666666663, 404.2316666666664], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [428.4361111111109, 430.4949999999998, 446.03222222222183, 432.9138888888885, 451.4922222222218, 466.87222222222204, 435.7944444444442, 450.3099999999996, 441.15999999999974, 456.2544444444443, 447.41944444444397, 438.12666666666615, 447.0949999999997, 446.33166666666637, 415.9194444444439, 421.6905555555553, 436.4194444444442, 433.44277777777745, 442.7299999999998, 423.0949999999997, 423.01722222222185, 433.82555555555535, 444.20499999999953, 433.45111111111083, 452.3161111111106, 431.4583333333331, 465.16611111111075, 448.33999999999963, 431.6261111111109, 432.6738888888884, 407.2622222222218, 447.08666666666625, 485.73611111111074, 483.7755555555554, 427.52388888888856, 426.3738888888886, 426.63388888888863, 444.2777777777777, 418.3177777777774, 455.29277777777753, 446.2216666666665, 422.5316666666664, 430.39777777777743, 413.40499999999986, 426.8805555555552, 441.6977777777772, 443.2688888888887, 433.67444444444413, 450.94277777777745, 457.33944444444404, 477.4594444444444, 455.1338888888887, 435.96722222222184, 435.9105555555554, 452.26888888888857, 467.4666666666665, 417.5633333333331, 438.0961111111108, 460.6011111111107, 427.0866666666665, 466.96722222222195, 419.33333333333303, 451.0316666666664, 427.612222222222, 425.08722222222195, 467.5305555555553, 459.29333333333295, 447.1094444444443, 429.6405555555553, 449.5783333333329, 434.41388888888855, 411.09611111111076, 422.99999999999966, 435.80833333333294, 455.013333333333, 426.498333333333, 442.7133333333333, 397.30277777777764, 453.2366666666664, 450.2516666666662, 440.3566666666664, 447.7283333333329, 442.37111111111085, 435.04555555555527, 453.8549999999997, 425.46944444444404, 422.1594444444443, 428.92055555555544, 449.7538888888885, 431.43444444444424, 395.92833333333317, 436.4988888888884, 444.29333333333307, 436.4661111111107, 410.3899999999997, 464.8383333333332, 429.07111111111067, 455.8161111111107, 462.2666666666663, 404.2316666666664]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19782879802032924, "mean_inference_ms": 1.8046475428091395, "mean_action_processing_ms": 0.07513722888519839, "mean_env_wait_ms": 1.223132367650521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004843711853027344, "StateBufferConnector_ms": 0.0029723644256591797, "ViewRequirementAgentConnector_ms": 0.06815934181213379}, "num_episodes": 30, "episode_return_max": 485.73611111111074, "episode_return_min": 395.92833333333317, "episode_return_mean": 439.3371777777774, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 334050, "num_agent_steps_trained": 333900, "num_env_steps_sampled": 334050, "num_env_steps_trained": 333900, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 284.327350177555, "num_env_steps_trained_throughput_per_sec": 284.327350177555, "timesteps_total": 334050, "num_env_steps_sampled_lifetime": 334050, "num_agent_steps_sampled_lifetime": 334050, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 334050, "timers": {"training_iteration_time_ms": 10379.526, "restore_workers_time_ms": 0.014, "training_step_time_ms": 559.508, "sample_time_ms": 543.892, "synch_weights_time_ms": 14.141}, "counters": {"num_env_steps_sampled": 334050, "num_env_steps_trained": 333900, "num_agent_steps_sampled": 334050, "num_agent_steps_trained": 333900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2227, "num_samples_added_to_queue": 333900}, "done": false, "training_iteration": 112, "trial_id": "0313d_00000", "date": "2024-10-10_22-00-42", "timestamp": 1728594042, "time_this_iter_s": 10.563699960708618, "time_total_s": 1154.171602487564, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d89570>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1154.171602487564, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 12.033333333333335, "ram_util_percent": 71.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 180652.25, "policy_loss": 180272.515625, "entropy": 15.630960464477539, "entropy_coeff": 0.01, "var_gnorm": 16.620895385742188, "vf_loss": 426631.03125, "vf_explained_var": -0.016807913780212402}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1123.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 337050, "num_env_steps_trained": 336900, "num_agent_steps_sampled": 337050, "num_agent_steps_trained": 336900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2247, "num_samples_added_to_queue": 336900, "learner_queue": {"size_count": 1123, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.463, "learner_load_time_ms": 0.36, "learner_load_wait_time_ms": 979.759, "learner_dequeue_time_ms": 8369.086}}, "env_runners": {"episode_reward_max": 485.73611111111074, "episode_reward_min": 395.02222222222196, "episode_reward_mean": 436.46980555555524, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 395.02222222222196}, "policy_reward_max": {"default_policy": 485.73611111111074}, "policy_reward_mean": {"default_policy": 436.46980555555524}, "custom_metrics": {"num_consolidated_mean": 2.0287999999999995, "num_consolidated_min": 1.89, "num_consolidated_max": 2.17, "num_overloaded_mean": 0.050299999999999984, "num_overloaded_min": 0.0, "num_overloaded_max": 0.11, "num_moves_mean": 5.2264, "num_moves_min": 4.83, "num_moves_max": 5.72, "mean_accuracy_mean": 39.42020999999999, "mean_accuracy_min": 39.28866666666664, "mean_accuracy_max": 39.592666666666645, "num_model_switches_mean": 2.583, "num_model_switches_min": 2.11, "num_model_switches_max": 3.1, "num_slav_mean": 0.002727833333333334, "num_slav_min": 0.00011666666666666667, "num_slav_max": 0.007516666666666668, "mean_cluster_cpu_util_mean": 0.4623021647081813, "mean_cluster_cpu_util_min": 0.4460266881799983, "mean_cluster_cpu_util_max": 0.47596518466229804, "mean_cluster_mem_util_mean": 0.2920504987011682, "mean_cluster_mem_util_min": 0.2850798108800482, "mean_cluster_mem_util_max": 0.2980945890381469, "reward_consolidation_mean_mean": 2.6634722222222225, "reward_consolidation_mean_min": 2.361111111111111, "reward_consolidation_mean_max": 2.9861111111111116, "reward_illegal_mean_mean": -0.08383333333333332, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.8712758333333328, "reward_accuracy_mean_min": 1.7595999999999998, "reward_accuracy_mean_max": 1.9688666666666665, "reward_sla_mean_mean": -0.08621666666666668, "reward_sla_mean_min": -0.2505555555555556, "reward_sla_mean_max": -0.0038888888888888888, "reward_consolidation_sum_mean": 266.3472222222223, "reward_consolidation_sum_min": 236.11111111111111, "reward_consolidation_sum_max": 298.61111111111114, "reward_illegal_sum_mean": -8.383333333333333, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 187.1275833333333, "reward_accuracy_sum_min": 175.95999999999998, "reward_accuracy_sum_max": 196.88666666666666, "reward_sla_sum_mean": -8.621666666666666, "reward_sla_sum_min": -25.055555555555557, "reward_sla_sum_max": -0.3888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2152.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [407.2622222222218, 447.08666666666625, 485.73611111111074, 483.7755555555554, 427.52388888888856, 426.3738888888886, 426.63388888888863, 444.2777777777777, 418.3177777777774, 455.29277777777753, 446.2216666666665, 422.5316666666664, 430.39777777777743, 413.40499999999986, 426.8805555555552, 441.6977777777772, 443.2688888888887, 433.67444444444413, 450.94277777777745, 457.33944444444404, 477.4594444444444, 455.1338888888887, 435.96722222222184, 435.9105555555554, 452.26888888888857, 467.4666666666665, 417.5633333333331, 438.0961111111108, 460.6011111111107, 427.0866666666665, 466.96722222222195, 419.33333333333303, 451.0316666666664, 427.612222222222, 425.08722222222195, 467.5305555555553, 459.29333333333295, 447.1094444444443, 429.6405555555553, 449.5783333333329, 434.41388888888855, 411.09611111111076, 422.99999999999966, 435.80833333333294, 455.013333333333, 426.498333333333, 442.7133333333333, 397.30277777777764, 453.2366666666664, 450.2516666666662, 440.3566666666664, 447.7283333333329, 442.37111111111085, 435.04555555555527, 453.8549999999997, 425.46944444444404, 422.1594444444443, 428.92055555555544, 449.7538888888885, 431.43444444444424, 395.92833333333317, 436.4988888888884, 444.29333333333307, 436.4661111111107, 410.3899999999997, 464.8383333333332, 429.07111111111067, 455.8161111111107, 462.2666666666663, 404.2316666666664, 431.7599999999996, 395.02222222222196, 440.7366666666664, 432.0149999999997, 430.6827777777774, 447.8066666666664, 412.11055555555527, 440.3866666666665, 418.5377777777777, 447.6505555555552, 436.6016666666663, 401.61888888888865, 439.76055555555524, 445.09333333333313, 413.469444444444, 449.7522222222221, 469.47499999999985, 415.95833333333326, 429.0222222222221, 418.0716666666664, 405.8783333333331, 437.53833333333296, 436.75333333333305, 423.15833333333325, 400.12666666666627, 428.49277777777763, 463.99055555555526, 424.9599999999996, 420.78444444444426, 444.1577777777773], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [407.2622222222218, 447.08666666666625, 485.73611111111074, 483.7755555555554, 427.52388888888856, 426.3738888888886, 426.63388888888863, 444.2777777777777, 418.3177777777774, 455.29277777777753, 446.2216666666665, 422.5316666666664, 430.39777777777743, 413.40499999999986, 426.8805555555552, 441.6977777777772, 443.2688888888887, 433.67444444444413, 450.94277777777745, 457.33944444444404, 477.4594444444444, 455.1338888888887, 435.96722222222184, 435.9105555555554, 452.26888888888857, 467.4666666666665, 417.5633333333331, 438.0961111111108, 460.6011111111107, 427.0866666666665, 466.96722222222195, 419.33333333333303, 451.0316666666664, 427.612222222222, 425.08722222222195, 467.5305555555553, 459.29333333333295, 447.1094444444443, 429.6405555555553, 449.5783333333329, 434.41388888888855, 411.09611111111076, 422.99999999999966, 435.80833333333294, 455.013333333333, 426.498333333333, 442.7133333333333, 397.30277777777764, 453.2366666666664, 450.2516666666662, 440.3566666666664, 447.7283333333329, 442.37111111111085, 435.04555555555527, 453.8549999999997, 425.46944444444404, 422.1594444444443, 428.92055555555544, 449.7538888888885, 431.43444444444424, 395.92833333333317, 436.4988888888884, 444.29333333333307, 436.4661111111107, 410.3899999999997, 464.8383333333332, 429.07111111111067, 455.8161111111107, 462.2666666666663, 404.2316666666664, 431.7599999999996, 395.02222222222196, 440.7366666666664, 432.0149999999997, 430.6827777777774, 447.8066666666664, 412.11055555555527, 440.3866666666665, 418.5377777777777, 447.6505555555552, 436.6016666666663, 401.61888888888865, 439.76055555555524, 445.09333333333313, 413.469444444444, 449.7522222222221, 469.47499999999985, 415.95833333333326, 429.0222222222221, 418.0716666666664, 405.8783333333331, 437.53833333333296, 436.75333333333305, 423.15833333333325, 400.12666666666627, 428.49277777777763, 463.99055555555526, 424.9599999999996, 420.78444444444426, 444.1577777777773]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19782263695813654, "mean_inference_ms": 1.804368171734927, "mean_action_processing_ms": 0.07512871952521953, "mean_env_wait_ms": 1.2230368552021473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00479578971862793, "StateBufferConnector_ms": 0.002947568893432617, "ViewRequirementAgentConnector_ms": 0.06737589836120605}, "num_episodes": 30, "episode_return_max": 485.73611111111074, "episode_return_min": 395.02222222222196, "episode_return_mean": 436.46980555555524, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 337050, "num_agent_steps_trained": 336900, "num_env_steps_sampled": 337050, "num_env_steps_trained": 336900, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 294.12424565415705, "num_env_steps_trained_throughput_per_sec": 294.12424565415705, "timesteps_total": 337050, "num_env_steps_sampled_lifetime": 337050, "num_agent_steps_sampled_lifetime": 337050, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 337050, "timers": {"training_iteration_time_ms": 10370.732, "restore_workers_time_ms": 0.012, "training_step_time_ms": 509.263, "sample_time_ms": 494.383, "synch_weights_time_ms": 13.548}, "counters": {"num_env_steps_sampled": 337050, "num_env_steps_trained": 336900, "num_agent_steps_sampled": 337050, "num_agent_steps_trained": 336900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2247, "num_samples_added_to_queue": 336900}, "done": false, "training_iteration": 113, "trial_id": "0313d_00000", "date": "2024-10-10_22-00-52", "timestamp": 1728594052, "time_this_iter_s": 10.208112955093384, "time_total_s": 1164.3797154426575, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a5300>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1164.3797154426575, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 11.078571428571431, "ram_util_percent": 71.60000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 168092.71875, "policy_loss": 167751.53125, "entropy": 15.34317398071289, "entropy_coeff": 0.01, "var_gnorm": 16.625534057617188, "vf_loss": 387212.75, "vf_explained_var": -0.008692383766174316}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1132.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 339900, "num_env_steps_trained": 339600, "num_agent_steps_sampled": 339900, "num_agent_steps_trained": 339600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2266, "num_samples_added_to_queue": 339900, "learner_queue": {"size_count": 1132, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.06, "learner_load_time_ms": 0.363, "learner_load_wait_time_ms": 1035.811, "learner_dequeue_time_ms": 8406.585}}, "env_runners": {"episode_reward_max": 478.4416666666665, "episode_reward_min": 395.02222222222196, "episode_reward_mean": 437.60641111111096, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 395.02222222222196}, "policy_reward_max": {"default_policy": 478.4416666666665}, "policy_reward_mean": {"default_policy": 437.60641111111096}, "custom_metrics": {"num_consolidated_mean": 2.0323, "num_consolidated_min": 1.89, "num_consolidated_max": 2.17, "num_overloaded_mean": 0.049300000000000004, "num_overloaded_min": 0.01, "num_overloaded_max": 0.11, "num_moves_mean": 5.2072, "num_moves_min": 4.77, "num_moves_max": 5.72, "mean_accuracy_mean": 39.44117333333332, "mean_accuracy_min": 39.28866666666665, "mean_accuracy_max": 39.60533333333332, "num_model_switches_mean": 2.6301, "num_model_switches_min": 2.25, "num_model_switches_max": 3.1, "num_slav_mean": 0.0027015, "num_slav_min": 0.00011666666666666667, "num_slav_max": 0.007516666666666668, "mean_cluster_cpu_util_mean": 0.46190547132572923, "mean_cluster_cpu_util_min": 0.4460266881799983, "mean_cluster_cpu_util_max": 0.4741918714907543, "mean_cluster_mem_util_mean": 0.2921082110368409, "mean_cluster_mem_util_min": 0.2850798108800482, "mean_cluster_mem_util_max": 0.2971701796119291, "reward_consolidation_mean_mean": 2.66875, "reward_consolidation_mean_min": 2.361111111111111, "reward_consolidation_mean_max": 2.9444444444444446, "reward_illegal_mean_mean": -0.08216666666666668, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 1.8743029999999996, "reward_accuracy_mean_min": 1.7595999999999998, "reward_accuracy_mean_max": 1.954333333333333, "reward_sla_mean_mean": -0.08482222222222222, "reward_sla_mean_min": -0.2505555555555556, "reward_sla_mean_max": -0.0038888888888888888, "reward_consolidation_sum_mean": 266.87500000000006, "reward_consolidation_sum_min": 236.11111111111111, "reward_consolidation_sum_max": 294.44444444444446, "reward_illegal_sum_mean": -8.216666666666667, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 187.4303, "reward_accuracy_sum_min": 175.95999999999998, "reward_accuracy_sum_max": 195.4333333333333, "reward_sla_sum_mean": -8.482222222222221, "reward_sla_sum_min": -25.055555555555557, "reward_sla_sum_max": -0.3888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2450.0, "global_timestep_min": 200, "global_timestep_max": 4100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [466.96722222222195, 419.33333333333303, 451.0316666666664, 427.612222222222, 425.08722222222195, 467.5305555555553, 459.29333333333295, 447.1094444444443, 429.6405555555553, 449.5783333333329, 434.41388888888855, 411.09611111111076, 422.99999999999966, 435.80833333333294, 455.013333333333, 426.498333333333, 442.7133333333333, 397.30277777777764, 453.2366666666664, 450.2516666666662, 440.3566666666664, 447.7283333333329, 442.37111111111085, 435.04555555555527, 453.8549999999997, 425.46944444444404, 422.1594444444443, 428.92055555555544, 449.7538888888885, 431.43444444444424, 395.92833333333317, 436.4988888888884, 444.29333333333307, 436.4661111111107, 410.3899999999997, 464.8383333333332, 429.07111111111067, 455.8161111111107, 462.2666666666663, 404.2316666666664, 431.7599999999996, 395.02222222222196, 440.7366666666664, 432.0149999999997, 430.6827777777774, 447.8066666666664, 412.11055555555527, 440.3866666666665, 418.5377777777777, 447.6505555555552, 436.6016666666663, 401.61888888888865, 439.76055555555524, 445.09333333333313, 413.469444444444, 449.7522222222221, 469.47499999999985, 415.95833333333326, 429.0222222222221, 418.0716666666664, 405.8783333333331, 437.53833333333296, 436.75333333333305, 423.15833333333325, 400.12666666666627, 428.49277777777763, 463.99055555555526, 424.9599999999996, 420.78444444444426, 444.1577777777773, 463.45888888888845, 447.4911111111107, 444.44277777777745, 435.0455555555552, 437.9105555555554, 449.2827777777776, 478.4416666666665, 469.9499999999999, 438.6011111111108, 425.87944444444406, 447.1977777777775, 411.912222222222, 454.94111111111096, 467.03777777777753, 438.1094444444442, 453.3311111111106, 430.88222222222197, 405.8016666666665, 454.10055555555533, 458.6888888888885, 461.19611111111084, 436.24499999999966, 436.38666666666643, 449.84055555555534, 436.93388888888865, 432.79999999999967, 445.26111111111067, 456.8083333333328, 440.80833333333294, 461.06833333333293], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [466.96722222222195, 419.33333333333303, 451.0316666666664, 427.612222222222, 425.08722222222195, 467.5305555555553, 459.29333333333295, 447.1094444444443, 429.6405555555553, 449.5783333333329, 434.41388888888855, 411.09611111111076, 422.99999999999966, 435.80833333333294, 455.013333333333, 426.498333333333, 442.7133333333333, 397.30277777777764, 453.2366666666664, 450.2516666666662, 440.3566666666664, 447.7283333333329, 442.37111111111085, 435.04555555555527, 453.8549999999997, 425.46944444444404, 422.1594444444443, 428.92055555555544, 449.7538888888885, 431.43444444444424, 395.92833333333317, 436.4988888888884, 444.29333333333307, 436.4661111111107, 410.3899999999997, 464.8383333333332, 429.07111111111067, 455.8161111111107, 462.2666666666663, 404.2316666666664, 431.7599999999996, 395.02222222222196, 440.7366666666664, 432.0149999999997, 430.6827777777774, 447.8066666666664, 412.11055555555527, 440.3866666666665, 418.5377777777777, 447.6505555555552, 436.6016666666663, 401.61888888888865, 439.76055555555524, 445.09333333333313, 413.469444444444, 449.7522222222221, 469.47499999999985, 415.95833333333326, 429.0222222222221, 418.0716666666664, 405.8783333333331, 437.53833333333296, 436.75333333333305, 423.15833333333325, 400.12666666666627, 428.49277777777763, 463.99055555555526, 424.9599999999996, 420.78444444444426, 444.1577777777773, 463.45888888888845, 447.4911111111107, 444.44277777777745, 435.0455555555552, 437.9105555555554, 449.2827777777776, 478.4416666666665, 469.9499999999999, 438.6011111111108, 425.87944444444406, 447.1977777777775, 411.912222222222, 454.94111111111096, 467.03777777777753, 438.1094444444442, 453.3311111111106, 430.88222222222197, 405.8016666666665, 454.10055555555533, 458.6888888888885, 461.19611111111084, 436.24499999999966, 436.38666666666643, 449.84055555555534, 436.93388888888865, 432.79999999999967, 445.26111111111067, 456.8083333333328, 440.80833333333294, 461.06833333333293]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1978645716487074, "mean_inference_ms": 1.804537991951534, "mean_action_processing_ms": 0.07513693766440664, "mean_env_wait_ms": 1.2232033676580283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047092437744140625, "StateBufferConnector_ms": 0.002964019775390625, "ViewRequirementAgentConnector_ms": 0.06751704216003418}, "num_episodes": 30, "episode_return_max": 478.4416666666665, "episode_return_min": 395.02222222222196, "episode_return_mean": 437.60641111111096, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 339900, "num_agent_steps_trained": 339600, "num_env_steps_sampled": 339900, "num_env_steps_trained": 339600, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 274.0738643269341, "num_env_steps_trained_throughput_per_sec": 259.6489240992007, "timesteps_total": 339900, "num_env_steps_sampled_lifetime": 339900, "num_agent_steps_sampled_lifetime": 339900, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 339900, "timers": {"training_iteration_time_ms": 10369.431, "restore_workers_time_ms": 0.01, "training_step_time_ms": 522.117, "sample_time_ms": 507.772, "synch_weights_time_ms": 12.924}, "counters": {"num_env_steps_sampled": 339900, "num_env_steps_trained": 339600, "num_agent_steps_sampled": 339900, "num_agent_steps_trained": 339600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2266, "num_samples_added_to_queue": 339900}, "done": false, "training_iteration": 114, "trial_id": "0313d_00000", "date": "2024-10-10_22-01-02", "timestamp": 1728594062, "time_this_iter_s": 10.416846513748169, "time_total_s": 1174.7965619564056, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c19330>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1174.7965619564056, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 12.799999999999999, "ram_util_percent": 71.81333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 170246.5625, "policy_loss": 169840.0, "entropy": 14.72339153289795, "entropy_coeff": 0.01, "var_gnorm": 16.636890411376953, "vf_loss": 450729.34375, "vf_explained_var": 0.0009879469871520996}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1142.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 342900, "num_env_steps_trained": 342600, "num_agent_steps_sampled": 342900, "num_agent_steps_trained": 342600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2286, "num_samples_added_to_queue": 342900, "learner_queue": {"size_count": 1142, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.714, "learner_load_time_ms": 0.367, "learner_load_wait_time_ms": 959.008, "learner_dequeue_time_ms": 8402.704}}, "env_runners": {"episode_reward_max": 480.66999999999973, "episode_reward_min": 395.02222222222196, "episode_reward_mean": 441.10357777777756, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 395.02222222222196}, "policy_reward_max": {"default_policy": 480.66999999999973}, "policy_reward_mean": {"default_policy": 441.10357777777756}, "custom_metrics": {"num_consolidated_mean": 2.0496999999999996, "num_consolidated_min": 1.89, "num_consolidated_max": 2.2, "num_overloaded_mean": 0.048400000000000006, "num_overloaded_min": 0.01, "num_overloaded_max": 0.11, "num_moves_mean": 5.1224, "num_moves_min": 4.57, "num_moves_max": 5.72, "mean_accuracy_mean": 39.470559999999985, "mean_accuracy_min": 39.313999999999986, "mean_accuracy_max": 39.66866666666665, "num_model_switches_mean": 2.6203999999999996, "num_model_switches_min": 2.25, "num_model_switches_max": 3.1, "num_slav_mean": 0.002523, "num_slav_min": 0.00015, "num_slav_max": 0.007516666666666668, "mean_cluster_cpu_util_mean": 0.4629134601069493, "mean_cluster_cpu_util_min": 0.44893837823727034, "mean_cluster_cpu_util_max": 0.4814816273153638, "mean_cluster_mem_util_mean": 0.2925163813129682, "mean_cluster_mem_util_min": 0.28696928496081975, "mean_cluster_mem_util_max": 0.29936147098079735, "reward_consolidation_mean_mean": 2.6936111111111116, "reward_consolidation_mean_min": 2.361111111111111, "reward_consolidation_mean_max": 2.9444444444444446, "reward_illegal_mean_mean": -0.08066666666666665, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 1.8772579999999996, "reward_accuracy_mean_min": 1.7595999999999998, "reward_accuracy_mean_max": 1.960033333333333, "reward_sla_mean_mean": -0.07916666666666665, "reward_sla_mean_min": -0.2505555555555556, "reward_sla_mean_max": -0.0038888888888888896, "reward_consolidation_sum_mean": 269.36111111111114, "reward_consolidation_sum_min": 236.11111111111111, "reward_consolidation_sum_max": 294.44444444444446, "reward_illegal_sum_mean": -8.066666666666665, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 187.7258, "reward_accuracy_sum_min": 175.95999999999998, "reward_accuracy_sum_max": 196.0033333333333, "reward_sla_sum_mean": -7.916666666666665, "reward_sla_sum_min": -25.055555555555557, "reward_sla_sum_max": -0.38888888888888895, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3450.0, "global_timestep_min": 1200, "global_timestep_max": 5100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [395.92833333333317, 436.4988888888884, 444.29333333333307, 436.4661111111107, 410.3899999999997, 464.8383333333332, 429.07111111111067, 455.8161111111107, 462.2666666666663, 404.2316666666664, 431.7599999999996, 395.02222222222196, 440.7366666666664, 432.0149999999997, 430.6827777777774, 447.8066666666664, 412.11055555555527, 440.3866666666665, 418.5377777777777, 447.6505555555552, 436.6016666666663, 401.61888888888865, 439.76055555555524, 445.09333333333313, 413.469444444444, 449.7522222222221, 469.47499999999985, 415.95833333333326, 429.0222222222221, 418.0716666666664, 405.8783333333331, 437.53833333333296, 436.75333333333305, 423.15833333333325, 400.12666666666627, 428.49277777777763, 463.99055555555526, 424.9599999999996, 420.78444444444426, 444.1577777777773, 463.45888888888845, 447.4911111111107, 444.44277777777745, 435.0455555555552, 437.9105555555554, 449.2827777777776, 478.4416666666665, 469.9499999999999, 438.6011111111108, 425.87944444444406, 447.1977777777775, 411.912222222222, 454.94111111111096, 467.03777777777753, 438.1094444444442, 453.3311111111106, 430.88222222222197, 405.8016666666665, 454.10055555555533, 458.6888888888885, 461.19611111111084, 436.24499999999966, 436.38666666666643, 449.84055555555534, 436.93388888888865, 432.79999999999967, 445.26111111111067, 456.8083333333328, 440.80833333333294, 461.06833333333293, 452.55388888888854, 468.2499999999998, 458.8249999999997, 466.61499999999967, 441.2455555555554, 440.9433333333331, 466.8216666666664, 475.5199999999997, 472.4505555555553, 431.49111111111097, 480.66999999999973, 445.4111111111109, 432.3105555555553, 454.1799999999996, 446.09277777777766, 456.29944444444413, 459.32944444444416, 449.80611111111074, 457.9822222222221, 423.11055555555544, 442.7211111111109, 435.1494444444442, 443.515, 417.212222222222, 451.45111111111066, 421.80944444444395, 427.67333333333306, 447.7688888888886, 469.3527777777775, 462.7677777777774], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [395.92833333333317, 436.4988888888884, 444.29333333333307, 436.4661111111107, 410.3899999999997, 464.8383333333332, 429.07111111111067, 455.8161111111107, 462.2666666666663, 404.2316666666664, 431.7599999999996, 395.02222222222196, 440.7366666666664, 432.0149999999997, 430.6827777777774, 447.8066666666664, 412.11055555555527, 440.3866666666665, 418.5377777777777, 447.6505555555552, 436.6016666666663, 401.61888888888865, 439.76055555555524, 445.09333333333313, 413.469444444444, 449.7522222222221, 469.47499999999985, 415.95833333333326, 429.0222222222221, 418.0716666666664, 405.8783333333331, 437.53833333333296, 436.75333333333305, 423.15833333333325, 400.12666666666627, 428.49277777777763, 463.99055555555526, 424.9599999999996, 420.78444444444426, 444.1577777777773, 463.45888888888845, 447.4911111111107, 444.44277777777745, 435.0455555555552, 437.9105555555554, 449.2827777777776, 478.4416666666665, 469.9499999999999, 438.6011111111108, 425.87944444444406, 447.1977777777775, 411.912222222222, 454.94111111111096, 467.03777777777753, 438.1094444444442, 453.3311111111106, 430.88222222222197, 405.8016666666665, 454.10055555555533, 458.6888888888885, 461.19611111111084, 436.24499999999966, 436.38666666666643, 449.84055555555534, 436.93388888888865, 432.79999999999967, 445.26111111111067, 456.8083333333328, 440.80833333333294, 461.06833333333293, 452.55388888888854, 468.2499999999998, 458.8249999999997, 466.61499999999967, 441.2455555555554, 440.9433333333331, 466.8216666666664, 475.5199999999997, 472.4505555555553, 431.49111111111097, 480.66999999999973, 445.4111111111109, 432.3105555555553, 454.1799999999996, 446.09277777777766, 456.29944444444413, 459.32944444444416, 449.80611111111074, 457.9822222222221, 423.11055555555544, 442.7211111111109, 435.1494444444442, 443.515, 417.212222222222, 451.45111111111066, 421.80944444444395, 427.67333333333306, 447.7688888888886, 469.3527777777775, 462.7677777777774]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19787556691361372, "mean_inference_ms": 1.8046593306835579, "mean_action_processing_ms": 0.07513575886263321, "mean_env_wait_ms": 1.2232768765015978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043299198150634766, "StateBufferConnector_ms": 0.002916574478149414, "ViewRequirementAgentConnector_ms": 0.06565165519714355}, "num_episodes": 30, "episode_return_max": 480.66999999999973, "episode_return_min": 395.02222222222196, "episode_return_mean": 441.10357777777756, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 342900, "num_agent_steps_trained": 342600, "num_env_steps_sampled": 342900, "num_env_steps_trained": 342600, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 295.73936321508705, "num_env_steps_trained_throughput_per_sec": 295.73936321508705, "timesteps_total": 342900, "num_env_steps_sampled_lifetime": 342900, "num_agent_steps_sampled_lifetime": 342900, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 342900, "timers": {"training_iteration_time_ms": 10366.33, "restore_workers_time_ms": 0.012, "training_step_time_ms": 511.944, "sample_time_ms": 497.993, "synch_weights_time_ms": 12.703}, "counters": {"num_env_steps_sampled": 342900, "num_env_steps_trained": 342600, "num_agent_steps_sampled": 342900, "num_agent_steps_trained": 342600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2286, "num_samples_added_to_queue": 342900}, "done": false, "training_iteration": 115, "trial_id": "0313d_00000", "date": "2024-10-10_22-01-13", "timestamp": 1728594073, "time_this_iter_s": 10.154839038848877, "time_total_s": 1184.9514009952545, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c295d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1184.9514009952545, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 10.293333333333333, "ram_util_percent": 71.66666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 156665.953125, "policy_loss": 156274.671875, "entropy": 14.180146217346191, "entropy_coeff": 0.01, "var_gnorm": 16.647367477416992, "vf_loss": 433835.875, "vf_explained_var": 0.010350286960601807}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1152.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 345900, "num_env_steps_trained": 345600, "num_agent_steps_sampled": 345900, "num_agent_steps_trained": 345600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2306, "num_samples_added_to_queue": 345900, "learner_queue": {"size_count": 1152, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.019, "learner_load_time_ms": 0.338, "learner_load_wait_time_ms": 948.423, "learner_dequeue_time_ms": 8323.75}}, "env_runners": {"episode_reward_max": 495.0994444444443, "episode_reward_min": 400.12666666666627, "episode_reward_mean": 450.48767777777744, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 400.12666666666627}, "policy_reward_max": {"default_policy": 495.0994444444443}, "policy_reward_mean": {"default_policy": 450.48767777777744}, "custom_metrics": {"num_consolidated_mean": 2.0895999999999995, "num_consolidated_min": 1.91, "num_consolidated_max": 2.29, "num_overloaded_mean": 0.044899999999999995, "num_overloaded_min": 0.01, "num_overloaded_max": 0.11, "num_moves_mean": 4.952100000000001, "num_moves_min": 4.29, "num_moves_max": 5.59, "mean_accuracy_mean": 39.48797666666665, "mean_accuracy_min": 39.332999999999984, "mean_accuracy_max": 39.66866666666665, "num_model_switches_mean": 2.5567999999999995, "num_model_switches_min": 2.11, "num_model_switches_max": 3.1, "num_slav_mean": 0.0020311666666666664, "num_slav_min": 0.00011666666666666667, "num_slav_max": 0.007516666666666668, "mean_cluster_cpu_util_mean": 0.46460677681604956, "mean_cluster_cpu_util_min": 0.4483537493587618, "mean_cluster_cpu_util_max": 0.4820097923346976, "mean_cluster_mem_util_mean": 0.2928869397245185, "mean_cluster_mem_util_min": 0.28696928496081975, "mean_cluster_mem_util_max": 0.29936147098079735, "reward_consolidation_mean_mean": 2.758194444444444, "reward_consolidation_mean_min": 2.513888888888889, "reward_consolidation_mean_max": 3.0972222222222228, "reward_illegal_mean_mean": -0.07483333333333332, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 1.885049, "reward_accuracy_mean_min": 1.7595999999999998, "reward_accuracy_mean_max": 1.960033333333333, "reward_sla_mean_mean": -0.06353333333333332, "reward_sla_mean_min": -0.2505555555555556, "reward_sla_mean_max": -0.0038888888888888888, "reward_consolidation_sum_mean": 275.81944444444446, "reward_consolidation_sum_min": 251.38888888888889, "reward_consolidation_sum_max": 309.7222222222223, "reward_illegal_sum_mean": -7.483333333333332, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 188.50490000000002, "reward_accuracy_sum_min": 175.95999999999998, "reward_accuracy_sum_max": 196.0033333333333, "reward_sla_sum_mean": -6.353333333333333, "reward_sla_sum_min": -25.055555555555557, "reward_sla_sum_max": -0.3888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4450.0, "global_timestep_min": 2200, "global_timestep_max": 6100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [405.8783333333331, 437.53833333333296, 436.75333333333305, 423.15833333333325, 400.12666666666627, 428.49277777777763, 463.99055555555526, 424.9599999999996, 420.78444444444426, 444.1577777777773, 463.45888888888845, 447.4911111111107, 444.44277777777745, 435.0455555555552, 437.9105555555554, 449.2827777777776, 478.4416666666665, 469.9499999999999, 438.6011111111108, 425.87944444444406, 447.1977777777775, 411.912222222222, 454.94111111111096, 467.03777777777753, 438.1094444444442, 453.3311111111106, 430.88222222222197, 405.8016666666665, 454.10055555555533, 458.6888888888885, 461.19611111111084, 436.24499999999966, 436.38666666666643, 449.84055555555534, 436.93388888888865, 432.79999999999967, 445.26111111111067, 456.8083333333328, 440.80833333333294, 461.06833333333293, 452.55388888888854, 468.2499999999998, 458.8249999999997, 466.61499999999967, 441.2455555555554, 440.9433333333331, 466.8216666666664, 475.5199999999997, 472.4505555555553, 431.49111111111097, 480.66999999999973, 445.4111111111109, 432.3105555555553, 454.1799999999996, 446.09277777777766, 456.29944444444413, 459.32944444444416, 449.80611111111074, 457.9822222222221, 423.11055555555544, 442.7211111111109, 435.1494444444442, 443.515, 417.212222222222, 451.45111111111066, 421.80944444444395, 427.67333333333306, 447.7688888888886, 469.3527777777775, 462.7677777777774, 481.70444444444405, 455.093333333333, 464.2516666666665, 448.179444444444, 490.59944444444426, 451.7438888888885, 479.1077777777776, 490.37944444444435, 487.1638888888887, 437.9511111111108, 446.90277777777754, 471.1966666666665, 447.6016666666665, 476.48166666666646, 483.3861111111108, 454.83833333333297, 453.91888888888855, 440.3949999999997, 453.06333333333293, 464.736111111111, 440.3405555555555, 430.2294444444441, 468.56722222222186, 470.2272222222221, 437.43444444444395, 495.0994444444443, 464.98222222222205, 493.7988888888884, 453.62388888888864, 460.7444444444441], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [405.8783333333331, 437.53833333333296, 436.75333333333305, 423.15833333333325, 400.12666666666627, 428.49277777777763, 463.99055555555526, 424.9599999999996, 420.78444444444426, 444.1577777777773, 463.45888888888845, 447.4911111111107, 444.44277777777745, 435.0455555555552, 437.9105555555554, 449.2827777777776, 478.4416666666665, 469.9499999999999, 438.6011111111108, 425.87944444444406, 447.1977777777775, 411.912222222222, 454.94111111111096, 467.03777777777753, 438.1094444444442, 453.3311111111106, 430.88222222222197, 405.8016666666665, 454.10055555555533, 458.6888888888885, 461.19611111111084, 436.24499999999966, 436.38666666666643, 449.84055555555534, 436.93388888888865, 432.79999999999967, 445.26111111111067, 456.8083333333328, 440.80833333333294, 461.06833333333293, 452.55388888888854, 468.2499999999998, 458.8249999999997, 466.61499999999967, 441.2455555555554, 440.9433333333331, 466.8216666666664, 475.5199999999997, 472.4505555555553, 431.49111111111097, 480.66999999999973, 445.4111111111109, 432.3105555555553, 454.1799999999996, 446.09277777777766, 456.29944444444413, 459.32944444444416, 449.80611111111074, 457.9822222222221, 423.11055555555544, 442.7211111111109, 435.1494444444442, 443.515, 417.212222222222, 451.45111111111066, 421.80944444444395, 427.67333333333306, 447.7688888888886, 469.3527777777775, 462.7677777777774, 481.70444444444405, 455.093333333333, 464.2516666666665, 448.179444444444, 490.59944444444426, 451.7438888888885, 479.1077777777776, 490.37944444444435, 487.1638888888887, 437.9511111111108, 446.90277777777754, 471.1966666666665, 447.6016666666665, 476.48166666666646, 483.3861111111108, 454.83833333333297, 453.91888888888855, 440.3949999999997, 453.06333333333293, 464.736111111111, 440.3405555555555, 430.2294444444441, 468.56722222222186, 470.2272222222221, 437.43444444444395, 495.0994444444443, 464.98222222222205, 493.7988888888884, 453.62388888888864, 460.7444444444441]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1978641228725828, "mean_inference_ms": 1.8046004293805482, "mean_action_processing_ms": 0.07512588065454469, "mean_env_wait_ms": 1.223253137988822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039670467376708984, "StateBufferConnector_ms": 0.002835512161254883, "ViewRequirementAgentConnector_ms": 0.06285810470581055}, "num_episodes": 30, "episode_return_max": 495.0994444444443, "episode_return_min": 400.12666666666627, "episode_return_mean": 450.48767777777744, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 345900, "num_agent_steps_trained": 345600, "num_env_steps_sampled": 345900, "num_env_steps_trained": 345600, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 299.0213286421138, "num_env_steps_trained_throughput_per_sec": 299.0213286421138, "timesteps_total": 345900, "num_env_steps_sampled_lifetime": 345900, "num_agent_steps_sampled_lifetime": 345900, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 345900, "timers": {"training_iteration_time_ms": 10335.486, "restore_workers_time_ms": 0.013, "training_step_time_ms": 515.803, "sample_time_ms": 502.155, "synch_weights_time_ms": 12.372}, "counters": {"num_env_steps_sampled": 345900, "num_env_steps_trained": 345600, "num_agent_steps_sampled": 345900, "num_agent_steps_trained": 345600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2306, "num_samples_added_to_queue": 345900}, "done": false, "training_iteration": 116, "trial_id": "0313d_00000", "date": "2024-10-10_22-01-23", "timestamp": 1728594083, "time_this_iter_s": 10.04741382598877, "time_total_s": 1194.9988148212433, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c29960>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1194.9988148212433, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 10.457142857142857, "ram_util_percent": 71.90714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 153107.78125, "policy_loss": 152710.46875, "entropy": 13.603689193725586, "entropy_coeff": 0.01, "var_gnorm": 16.65743637084961, "vf_loss": 438130.125, "vf_explained_var": 0.01917332410812378}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1162.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 348900, "num_env_steps_trained": 348600, "num_agent_steps_sampled": 348900, "num_agent_steps_trained": 348600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2326, "num_samples_added_to_queue": 348900, "learner_queue": {"size_count": 1162, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.166, "learner_load_time_ms": 0.324, "learner_load_wait_time_ms": 953.46, "learner_dequeue_time_ms": 8259.531}}, "env_runners": {"episode_reward_max": 495.0994444444443, "episode_reward_min": 417.212222222222, "episode_reward_mean": 459.98151111111093, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 417.212222222222}, "policy_reward_max": {"default_policy": 495.0994444444443}, "policy_reward_mean": {"default_policy": 459.98151111111093}, "custom_metrics": {"num_consolidated_mean": 2.1348999999999996, "num_consolidated_min": 1.97, "num_consolidated_max": 2.29, "num_overloaded_mean": 0.041499999999999995, "num_overloaded_min": 0.0, "num_overloaded_max": 0.08, "num_moves_mean": 4.719600000000001, "num_moves_min": 4.02, "num_moves_max": 5.59, "mean_accuracy_mean": 39.49563999999999, "mean_accuracy_min": 39.35199999999998, "mean_accuracy_max": 39.66866666666665, "num_model_switches_mean": 2.4552, "num_model_switches_min": 2.02, "num_model_switches_max": 2.93, "num_slav_mean": 0.00165, "num_slav_min": 5e-05, "num_slav_max": 0.005816666666666668, "mean_cluster_cpu_util_mean": 0.4660521553312195, "mean_cluster_cpu_util_min": 0.4483537493587618, "mean_cluster_cpu_util_max": 0.4820097923346976, "mean_cluster_mem_util_mean": 0.2930895339687563, "mean_cluster_mem_util_min": 0.28721692015413763, "mean_cluster_mem_util_max": 0.29936147098079735, "reward_consolidation_mean_mean": 2.8281944444444447, "reward_consolidation_mean_min": 2.5694444444444446, "reward_consolidation_mean_max": 3.125, "reward_illegal_mean_mean": -0.06916666666666665, "reward_illegal_mean_min": -0.13333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.892137333333333, "reward_accuracy_mean_min": 1.8092166666666663, "reward_accuracy_mean_max": 1.9726666666666666, "reward_sla_mean_mean": -0.05135000000000001, "reward_sla_mean_min": -0.19388888888888886, "reward_sla_mean_max": -0.0016666666666666668, "reward_consolidation_sum_mean": 282.8194444444445, "reward_consolidation_sum_min": 256.94444444444446, "reward_consolidation_sum_max": 312.5, "reward_illegal_sum_mean": -6.916666666666666, "reward_illegal_sum_min": -13.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 189.21373333333338, "reward_accuracy_sum_min": 180.92166666666662, "reward_accuracy_sum_max": 197.26666666666665, "reward_sla_sum_mean": -5.134999999999999, "reward_sla_sum_min": -19.388888888888886, "reward_sla_sum_max": -0.16666666666666669, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5450.0, "global_timestep_min": 3200, "global_timestep_max": 7100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [461.19611111111084, 436.24499999999966, 436.38666666666643, 449.84055555555534, 436.93388888888865, 432.79999999999967, 445.26111111111067, 456.8083333333328, 440.80833333333294, 461.06833333333293, 452.55388888888854, 468.2499999999998, 458.8249999999997, 466.61499999999967, 441.2455555555554, 440.9433333333331, 466.8216666666664, 475.5199999999997, 472.4505555555553, 431.49111111111097, 480.66999999999973, 445.4111111111109, 432.3105555555553, 454.1799999999996, 446.09277777777766, 456.29944444444413, 459.32944444444416, 449.80611111111074, 457.9822222222221, 423.11055555555544, 442.7211111111109, 435.1494444444442, 443.515, 417.212222222222, 451.45111111111066, 421.80944444444395, 427.67333333333306, 447.7688888888886, 469.3527777777775, 462.7677777777774, 481.70444444444405, 455.093333333333, 464.2516666666665, 448.179444444444, 490.59944444444426, 451.7438888888885, 479.1077777777776, 490.37944444444435, 487.1638888888887, 437.9511111111108, 446.90277777777754, 471.1966666666665, 447.6016666666665, 476.48166666666646, 483.3861111111108, 454.83833333333297, 453.91888888888855, 440.3949999999997, 453.06333333333293, 464.736111111111, 440.3405555555555, 430.2294444444441, 468.56722222222186, 470.2272222222221, 437.43444444444395, 495.0994444444443, 464.98222222222205, 493.7988888888884, 453.62388888888864, 460.7444444444441, 482.0366666666664, 476.9494444444444, 478.21888888888856, 493.27499999999986, 451.3738888888885, 448.30055555555526, 472.6938888888887, 470.26055555555513, 482.3955555555554, 494.5366666666662, 457.1888888888885, 435.67333333333323, 493.40166666666636, 461.87222222222204, 474.37944444444435, 447.0616666666663, 481.3316666666664, 469.7116666666664, 479.56888888888864, 490.6555555555553, 447.5933333333332, 474.7599999999998, 472.14777777777755, 448.5938888888887, 468.0461111111107, 472.9977777777774, 483.8788888888887, 477.68944444444435, 467.56166666666644, 493.57555555555547], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [461.19611111111084, 436.24499999999966, 436.38666666666643, 449.84055555555534, 436.93388888888865, 432.79999999999967, 445.26111111111067, 456.8083333333328, 440.80833333333294, 461.06833333333293, 452.55388888888854, 468.2499999999998, 458.8249999999997, 466.61499999999967, 441.2455555555554, 440.9433333333331, 466.8216666666664, 475.5199999999997, 472.4505555555553, 431.49111111111097, 480.66999999999973, 445.4111111111109, 432.3105555555553, 454.1799999999996, 446.09277777777766, 456.29944444444413, 459.32944444444416, 449.80611111111074, 457.9822222222221, 423.11055555555544, 442.7211111111109, 435.1494444444442, 443.515, 417.212222222222, 451.45111111111066, 421.80944444444395, 427.67333333333306, 447.7688888888886, 469.3527777777775, 462.7677777777774, 481.70444444444405, 455.093333333333, 464.2516666666665, 448.179444444444, 490.59944444444426, 451.7438888888885, 479.1077777777776, 490.37944444444435, 487.1638888888887, 437.9511111111108, 446.90277777777754, 471.1966666666665, 447.6016666666665, 476.48166666666646, 483.3861111111108, 454.83833333333297, 453.91888888888855, 440.3949999999997, 453.06333333333293, 464.736111111111, 440.3405555555555, 430.2294444444441, 468.56722222222186, 470.2272222222221, 437.43444444444395, 495.0994444444443, 464.98222222222205, 493.7988888888884, 453.62388888888864, 460.7444444444441, 482.0366666666664, 476.9494444444444, 478.21888888888856, 493.27499999999986, 451.3738888888885, 448.30055555555526, 472.6938888888887, 470.26055555555513, 482.3955555555554, 494.5366666666662, 457.1888888888885, 435.67333333333323, 493.40166666666636, 461.87222222222204, 474.37944444444435, 447.0616666666663, 481.3316666666664, 469.7116666666664, 479.56888888888864, 490.6555555555553, 447.5933333333332, 474.7599999999998, 472.14777777777755, 448.5938888888887, 468.0461111111107, 472.9977777777774, 483.8788888888887, 477.68944444444435, 467.56166666666644, 493.57555555555547]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19782035369480502, "mean_inference_ms": 1.8042320150489894, "mean_action_processing_ms": 0.07510118922142475, "mean_env_wait_ms": 1.2230164759398392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003915548324584961, "StateBufferConnector_ms": 0.002786874771118164, "ViewRequirementAgentConnector_ms": 0.0623469352722168}, "num_episodes": 30, "episode_return_max": 495.0994444444443, "episode_return_min": 417.212222222222, "episode_return_mean": 459.98151111111093, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348900, "num_agent_steps_trained": 348600, "num_env_steps_sampled": 348900, "num_env_steps_trained": 348600, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 299.2850645124017, "num_env_steps_trained_throughput_per_sec": 299.2850645124017, "timesteps_total": 348900, "num_env_steps_sampled_lifetime": 348900, "num_agent_steps_sampled_lifetime": 348900, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 348900, "timers": {"training_iteration_time_ms": 10284.503, "restore_workers_time_ms": 0.011, "training_step_time_ms": 503.185, "sample_time_ms": 488.785, "synch_weights_time_ms": 13.083}, "counters": {"num_env_steps_sampled": 348900, "num_env_steps_trained": 348600, "num_agent_steps_sampled": 348900, "num_agent_steps_trained": 348600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2326, "num_samples_added_to_queue": 348900}, "done": false, "training_iteration": 117, "trial_id": "0313d_00000", "date": "2024-10-10_22-01-33", "timestamp": 1728594093, "time_this_iter_s": 10.033143758773804, "time_total_s": 1205.031958580017, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c28e20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1205.031958580017, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 11.386666666666665, "ram_util_percent": 72.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 146183.78125, "policy_loss": 145753.484375, "entropy": 13.055204391479492, "entropy_coeff": 0.01, "var_gnorm": 16.659114837646484, "vf_loss": 469473.1875, "vf_explained_var": 0.03030639886856079}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1172.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 351750, "num_env_steps_trained": 351600, "num_agent_steps_sampled": 351750, "num_agent_steps_trained": 351600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2345, "num_samples_added_to_queue": 351600, "learner_queue": {"size_count": 1172, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 64.268, "learner_load_time_ms": 0.321, "learner_load_wait_time_ms": 1012.167, "learner_dequeue_time_ms": 8265.593}}, "env_runners": {"episode_reward_max": 508.8944444444439, "episode_reward_min": 417.212222222222, "episode_reward_mean": 466.73653888888856, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 417.212222222222}, "policy_reward_max": {"default_policy": 508.8944444444439}, "policy_reward_mean": {"default_policy": 466.73653888888856}, "custom_metrics": {"num_consolidated_mean": 2.1715999999999998, "num_consolidated_min": 1.98, "num_consolidated_max": 2.34, "num_overloaded_mean": 0.03919999999999999, "num_overloaded_min": 0.0, "num_overloaded_max": 0.08, "num_moves_mean": 4.524500000000001, "num_moves_min": 3.97, "num_moves_max": 5.59, "mean_accuracy_mean": 39.49259999999998, "mean_accuracy_min": 39.36466666666665, "mean_accuracy_max": 39.66866666666665, "num_model_switches_mean": 2.37, "num_model_switches_min": 2.02, "num_model_switches_max": 2.84, "num_slav_mean": 0.0015274999999999998, "num_slav_min": 5e-05, "num_slav_max": 0.004233333333333334, "mean_cluster_cpu_util_mean": 0.46744451194718367, "mean_cluster_cpu_util_min": 0.4483537493587618, "mean_cluster_cpu_util_max": 0.4820097923346976, "mean_cluster_mem_util_mean": 0.2934621521857688, "mean_cluster_mem_util_min": 0.28841087376933894, "mean_cluster_mem_util_max": 0.29936147098079735, "reward_consolidation_mean_mean": 2.884444444444445, "reward_consolidation_mean_min": 2.5694444444444446, "reward_consolidation_mean_max": 3.1805555555555554, "reward_illegal_mean_mean": -0.06533333333333333, "reward_illegal_mean_min": -0.13333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.8965598333333333, "reward_accuracy_mean_min": 1.8136499999999998, "reward_accuracy_mean_max": 1.9789999999999999, "reward_sla_mean_mean": -0.04830555555555556, "reward_sla_mean_min": -0.1411111111111111, "reward_sla_mean_max": -0.0016666666666666668, "reward_consolidation_sum_mean": 288.4444444444445, "reward_consolidation_sum_min": 256.94444444444446, "reward_consolidation_sum_max": 318.05555555555554, "reward_illegal_sum_mean": -6.533333333333334, "reward_illegal_sum_min": -13.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 189.65598333333332, "reward_accuracy_sum_min": 181.36499999999998, "reward_accuracy_sum_max": 197.89999999999998, "reward_sla_sum_mean": -4.830555555555555, "reward_sla_sum_min": -14.11111111111111, "reward_sla_sum_max": -0.16666666666666669, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5889.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [449.80611111111074, 457.9822222222221, 423.11055555555544, 442.7211111111109, 435.1494444444442, 443.515, 417.212222222222, 451.45111111111066, 421.80944444444395, 427.67333333333306, 447.7688888888886, 469.3527777777775, 462.7677777777774, 481.70444444444405, 455.093333333333, 464.2516666666665, 448.179444444444, 490.59944444444426, 451.7438888888885, 479.1077777777776, 490.37944444444435, 487.1638888888887, 437.9511111111108, 446.90277777777754, 471.1966666666665, 447.6016666666665, 476.48166666666646, 483.3861111111108, 454.83833333333297, 453.91888888888855, 440.3949999999997, 453.06333333333293, 464.736111111111, 440.3405555555555, 430.2294444444441, 468.56722222222186, 470.2272222222221, 437.43444444444395, 495.0994444444443, 464.98222222222205, 493.7988888888884, 453.62388888888864, 460.7444444444441, 482.0366666666664, 476.9494444444444, 478.21888888888856, 493.27499999999986, 451.3738888888885, 448.30055555555526, 472.6938888888887, 470.26055555555513, 482.3955555555554, 494.5366666666662, 457.1888888888885, 435.67333333333323, 493.40166666666636, 461.87222222222204, 474.37944444444435, 447.0616666666663, 481.3316666666664, 469.7116666666664, 479.56888888888864, 490.6555555555553, 447.5933333333332, 474.7599999999998, 472.14777777777755, 448.5938888888887, 468.0461111111107, 472.9977777777774, 483.8788888888887, 477.68944444444435, 467.56166666666644, 493.57555555555547, 446.03777777777736, 487.8538888888888, 479.86222222222204, 485.6405555555552, 487.10888888888854, 459.8249999999998, 488.1072222222221, 483.83888888888856, 491.3444444444443, 479.59444444444387, 474.38666666666654, 491.8949999999999, 477.1405555555552, 508.8944444444439, 448.61944444444407, 473.1644444444442, 495.4727777777774, 466.664444444444, 453.8305555555551, 487.02166666666653, 490.942222222222, 482.8711111111107, 452.0544444444441, 473.52833333333297, 474.49055555555526, 468.99722222222175, 472.6733333333328], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [449.80611111111074, 457.9822222222221, 423.11055555555544, 442.7211111111109, 435.1494444444442, 443.515, 417.212222222222, 451.45111111111066, 421.80944444444395, 427.67333333333306, 447.7688888888886, 469.3527777777775, 462.7677777777774, 481.70444444444405, 455.093333333333, 464.2516666666665, 448.179444444444, 490.59944444444426, 451.7438888888885, 479.1077777777776, 490.37944444444435, 487.1638888888887, 437.9511111111108, 446.90277777777754, 471.1966666666665, 447.6016666666665, 476.48166666666646, 483.3861111111108, 454.83833333333297, 453.91888888888855, 440.3949999999997, 453.06333333333293, 464.736111111111, 440.3405555555555, 430.2294444444441, 468.56722222222186, 470.2272222222221, 437.43444444444395, 495.0994444444443, 464.98222222222205, 493.7988888888884, 453.62388888888864, 460.7444444444441, 482.0366666666664, 476.9494444444444, 478.21888888888856, 493.27499999999986, 451.3738888888885, 448.30055555555526, 472.6938888888887, 470.26055555555513, 482.3955555555554, 494.5366666666662, 457.1888888888885, 435.67333333333323, 493.40166666666636, 461.87222222222204, 474.37944444444435, 447.0616666666663, 481.3316666666664, 469.7116666666664, 479.56888888888864, 490.6555555555553, 447.5933333333332, 474.7599999999998, 472.14777777777755, 448.5938888888887, 468.0461111111107, 472.9977777777774, 483.8788888888887, 477.68944444444435, 467.56166666666644, 493.57555555555547, 446.03777777777736, 487.8538888888888, 479.86222222222204, 485.6405555555552, 487.10888888888854, 459.8249999999998, 488.1072222222221, 483.83888888888856, 491.3444444444443, 479.59444444444387, 474.38666666666654, 491.8949999999999, 477.1405555555552, 508.8944444444439, 448.61944444444407, 473.1644444444442, 495.4727777777774, 466.664444444444, 453.8305555555551, 487.02166666666653, 490.942222222222, 482.8711111111107, 452.0544444444441, 473.52833333333297, 474.49055555555526, 468.99722222222175, 472.6733333333328]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19777287191710757, "mean_inference_ms": 1.8026013685837237, "mean_action_processing_ms": 0.07507650429101956, "mean_env_wait_ms": 1.222673793931854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00412297248840332, "StateBufferConnector_ms": 0.002862215042114258, "ViewRequirementAgentConnector_ms": 0.06457042694091797}, "num_episodes": 27, "episode_return_max": 508.8944444444439, "episode_return_min": 417.212222222222, "episode_return_mean": 466.73653888888856, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 351750, "num_agent_steps_trained": 351600, "num_env_steps_sampled": 351750, "num_env_steps_trained": 351600, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 277.5855032422337, "num_env_steps_trained_throughput_per_sec": 292.19526657077233, "timesteps_total": 351750, "num_env_steps_sampled_lifetime": 351750, "num_agent_steps_sampled_lifetime": 351750, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 351750, "timers": {"training_iteration_time_ms": 10259.106, "restore_workers_time_ms": 0.012, "training_step_time_ms": 533.479, "sample_time_ms": 518.34, "synch_weights_time_ms": 13.764}, "counters": {"num_env_steps_sampled": 351750, "num_env_steps_trained": 351600, "num_agent_steps_sampled": 351750, "num_agent_steps_trained": 351600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2345, "num_samples_added_to_queue": 351600}, "done": false, "training_iteration": 118, "trial_id": "0313d_00000", "date": "2024-10-10_22-01-43", "timestamp": 1728594103, "time_this_iter_s": 10.2790846824646, "time_total_s": 1215.3110432624817, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d8a110>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1215.3110432624817, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 14.085714285714287, "ram_util_percent": 72.54285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 150190.75, "policy_loss": 149778.71875, "entropy": 13.25329875946045, "entropy_coeff": 0.01, "var_gnorm": 16.6558837890625, "vf_loss": 451790.59375, "vf_explained_var": 0.04007488489151001}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1182.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 354750, "num_env_steps_trained": 354600, "num_agent_steps_sampled": 354750, "num_agent_steps_trained": 354600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2365, "num_samples_added_to_queue": 354600, "learner_queue": {"size_count": 1182, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 52.12, "learner_load_time_ms": 0.319, "learner_load_wait_time_ms": 984.177, "learner_dequeue_time_ms": 8288.674}}, "env_runners": {"episode_reward_max": 508.8944444444439, "episode_reward_min": 430.2294444444441, "episode_reward_mean": 475.2364944444442, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 430.2294444444441}, "policy_reward_max": {"default_policy": 508.8944444444439}, "policy_reward_mean": {"default_policy": 475.2364944444442}, "custom_metrics": {"num_consolidated_mean": 2.2006, "num_consolidated_min": 2.07, "num_consolidated_max": 2.34, "num_overloaded_mean": 0.0332, "num_overloaded_min": 0.0, "num_overloaded_max": 0.08, "num_moves_mean": 4.3301, "num_moves_min": 3.71, "num_moves_max": 5.13, "mean_accuracy_mean": 39.470306666666644, "mean_accuracy_min": 39.320333333333316, "mean_accuracy_max": 39.662333333333315, "num_model_switches_mean": 2.2851999999999997, "num_model_switches_min": 1.81, "num_model_switches_max": 2.64, "num_slav_mean": 0.0012819999999999997, "num_slav_min": 5e-05, "num_slav_max": 0.004233333333333334, "mean_cluster_cpu_util_mean": 0.46729148962173617, "mean_cluster_cpu_util_min": 0.45667517938890306, "mean_cluster_cpu_util_max": 0.48035127156572605, "mean_cluster_mem_util_mean": 0.2933084957787967, "mean_cluster_mem_util_min": 0.28860092945406013, "mean_cluster_mem_util_max": 0.2985550394313844, "reward_consolidation_mean_mean": 2.9415277777777775, "reward_consolidation_mean_min": 2.6250000000000004, "reward_consolidation_mean_max": 3.1805555555555554, "reward_illegal_mean_mean": -0.055333333333333325, "reward_illegal_mean_min": -0.13333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9074204999999995, "reward_accuracy_mean_min": 1.816183333333333, "reward_accuracy_mean_max": 1.9789999999999999, "reward_sla_mean_mean": -0.04124999999999999, "reward_sla_mean_min": -0.1411111111111111, "reward_sla_mean_max": -0.0016666666666666668, "reward_consolidation_sum_mean": 294.1527777777778, "reward_consolidation_sum_min": 262.50000000000006, "reward_consolidation_sum_max": 318.05555555555554, "reward_illegal_sum_mean": -5.533333333333332, "reward_illegal_sum_min": -13.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 190.74204999999995, "reward_accuracy_sum_min": 181.6183333333333, "reward_accuracy_sum_max": 197.89999999999998, "reward_sla_sum_mean": -4.125, "reward_sla_sum_min": -14.11111111111111, "reward_sla_sum_max": -0.16666666666666669, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4549.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [440.3949999999997, 453.06333333333293, 464.736111111111, 440.3405555555555, 430.2294444444441, 468.56722222222186, 470.2272222222221, 437.43444444444395, 495.0994444444443, 464.98222222222205, 493.7988888888884, 453.62388888888864, 460.7444444444441, 482.0366666666664, 476.9494444444444, 478.21888888888856, 493.27499999999986, 451.3738888888885, 448.30055555555526, 472.6938888888887, 470.26055555555513, 482.3955555555554, 494.5366666666662, 457.1888888888885, 435.67333333333323, 493.40166666666636, 461.87222222222204, 474.37944444444435, 447.0616666666663, 481.3316666666664, 469.7116666666664, 479.56888888888864, 490.6555555555553, 447.5933333333332, 474.7599999999998, 472.14777777777755, 448.5938888888887, 468.0461111111107, 472.9977777777774, 483.8788888888887, 477.68944444444435, 467.56166666666644, 493.57555555555547, 446.03777777777736, 487.8538888888888, 479.86222222222204, 485.6405555555552, 487.10888888888854, 459.8249999999998, 488.1072222222221, 483.83888888888856, 491.3444444444443, 479.59444444444387, 474.38666666666654, 491.8949999999999, 477.1405555555552, 508.8944444444439, 448.61944444444407, 473.1644444444442, 495.4727777777774, 466.664444444444, 453.8305555555551, 487.02166666666653, 490.942222222222, 482.8711111111107, 452.0544444444441, 473.52833333333297, 474.49055555555526, 468.99722222222175, 472.6733333333328, 482.1177777777774, 487.0377777777775, 468.4122222222218, 460.3633333333332, 482.06833333333327, 465.9177777777777, 476.37166666666616, 485.98388888888877, 496.7366666666663, 470.58666666666625, 496.8144444444442, 479.3794444444442, 485.54555555555515, 494.7361111111106, 486.3149999999997, 498.418333333333, 480.0538888888884, 492.85499999999985, 493.94222222222163, 471.59222222222195, 477.3705555555553, 489.697222222222, 472.75944444444434, 478.5299999999996, 497.2744444444442, 488.70555555555507, 471.6499999999998, 494.7999999999998, 485.8944444444444, 508.8861111111107], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [440.3949999999997, 453.06333333333293, 464.736111111111, 440.3405555555555, 430.2294444444441, 468.56722222222186, 470.2272222222221, 437.43444444444395, 495.0994444444443, 464.98222222222205, 493.7988888888884, 453.62388888888864, 460.7444444444441, 482.0366666666664, 476.9494444444444, 478.21888888888856, 493.27499999999986, 451.3738888888885, 448.30055555555526, 472.6938888888887, 470.26055555555513, 482.3955555555554, 494.5366666666662, 457.1888888888885, 435.67333333333323, 493.40166666666636, 461.87222222222204, 474.37944444444435, 447.0616666666663, 481.3316666666664, 469.7116666666664, 479.56888888888864, 490.6555555555553, 447.5933333333332, 474.7599999999998, 472.14777777777755, 448.5938888888887, 468.0461111111107, 472.9977777777774, 483.8788888888887, 477.68944444444435, 467.56166666666644, 493.57555555555547, 446.03777777777736, 487.8538888888888, 479.86222222222204, 485.6405555555552, 487.10888888888854, 459.8249999999998, 488.1072222222221, 483.83888888888856, 491.3444444444443, 479.59444444444387, 474.38666666666654, 491.8949999999999, 477.1405555555552, 508.8944444444439, 448.61944444444407, 473.1644444444442, 495.4727777777774, 466.664444444444, 453.8305555555551, 487.02166666666653, 490.942222222222, 482.8711111111107, 452.0544444444441, 473.52833333333297, 474.49055555555526, 468.99722222222175, 472.6733333333328, 482.1177777777774, 487.0377777777775, 468.4122222222218, 460.3633333333332, 482.06833333333327, 465.9177777777777, 476.37166666666616, 485.98388888888877, 496.7366666666663, 470.58666666666625, 496.8144444444442, 479.3794444444442, 485.54555555555515, 494.7361111111106, 486.3149999999997, 498.418333333333, 480.0538888888884, 492.85499999999985, 493.94222222222163, 471.59222222222195, 477.3705555555553, 489.697222222222, 472.75944444444434, 478.5299999999996, 497.2744444444442, 488.70555555555507, 471.6499999999998, 494.7999999999998, 485.8944444444444, 508.8861111111107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19778762640627703, "mean_inference_ms": 1.802512947922721, "mean_action_processing_ms": 0.07507515539364341, "mean_env_wait_ms": 1.2226634866526345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004271745681762695, "StateBufferConnector_ms": 0.0029048919677734375, "ViewRequirementAgentConnector_ms": 0.06610536575317383}, "num_episodes": 30, "episode_return_max": 508.8944444444439, "episode_return_min": 430.2294444444441, "episode_return_mean": 475.2364944444442, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 354750, "num_agent_steps_trained": 354600, "num_env_steps_sampled": 354750, "num_env_steps_trained": 354600, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 291.0604426407294, "num_env_steps_trained_throughput_per_sec": 291.0604426407294, "timesteps_total": 354750, "num_env_steps_sampled_lifetime": 354750, "num_agent_steps_sampled_lifetime": 354750, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 354750, "timers": {"training_iteration_time_ms": 10273.595, "restore_workers_time_ms": 0.012, "training_step_time_ms": 537.928, "sample_time_ms": 522.835, "synch_weights_time_ms": 13.62}, "counters": {"num_env_steps_sampled": 354750, "num_env_steps_trained": 354600, "num_agent_steps_sampled": 354750, "num_agent_steps_trained": 354600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2365, "num_samples_added_to_queue": 354600}, "done": false, "training_iteration": 119, "trial_id": "0313d_00000", "date": "2024-10-10_22-01-53", "timestamp": 1728594113, "time_this_iter_s": 10.321471691131592, "time_total_s": 1225.6325149536133, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d889a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1225.6325149536133, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 13.26, "ram_util_percent": 72.67999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 144222.328125, "policy_loss": 143821.609375, "entropy": 13.296142578125, "entropy_coeff": 0.01, "var_gnorm": 16.650495529174805, "vf_loss": 440616.125, "vf_explained_var": 0.048298656940460205}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1192.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 357750, "num_env_steps_trained": 357600, "num_agent_steps_sampled": 357750, "num_agent_steps_trained": 357600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2385, "num_samples_added_to_queue": 357600, "learner_queue": {"size_count": 1192, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.192, "learner_load_time_ms": 0.3, "learner_load_wait_time_ms": 984.733, "learner_dequeue_time_ms": 8334.288}}, "env_runners": {"episode_reward_max": 516.6088888888887, "episode_reward_min": 445.7055555555553, "episode_reward_mean": 480.0456444444441, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 445.7055555555553}, "policy_reward_max": {"default_policy": 516.6088888888887}, "policy_reward_mean": {"default_policy": 480.0456444444441}, "custom_metrics": {"num_consolidated_mean": 2.2152999999999996, "num_consolidated_min": 2.09, "num_consolidated_max": 2.36, "num_overloaded_mean": 0.0298, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 4.2433, "num_moves_min": 3.71, "num_moves_max": 4.78, "mean_accuracy_mean": 39.43787999999998, "mean_accuracy_min": 39.231666666666655, "mean_accuracy_max": 39.60533333333333, "num_model_switches_mean": 2.2180999999999997, "num_model_switches_min": 1.81, "num_model_switches_max": 2.6, "num_slav_mean": 0.0011093333333333333, "num_slav_min": 5e-05, "num_slav_max": 0.0035166666666666666, "mean_cluster_cpu_util_mean": 0.46659542975119955, "mean_cluster_cpu_util_min": 0.4514792477591792, "mean_cluster_cpu_util_max": 0.48035127156572605, "mean_cluster_mem_util_mean": 0.29318065682317235, "mean_cluster_mem_util_min": 0.28856324449611065, "mean_cluster_mem_util_max": 0.2985550394313844, "reward_consolidation_mean_mean": 2.973611111111112, "reward_consolidation_mean_min": 2.7500000000000004, "reward_consolidation_mean_max": 3.236111111111112, "reward_illegal_mean_mean": -0.04966666666666666, "reward_illegal_mean_min": -0.11666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9126119999999995, "reward_accuracy_mean_min": 1.830083333333333, "reward_accuracy_mean_max": 1.9789999999999999, "reward_sla_mean_mean": -0.03609999999999999, "reward_sla_mean_min": -0.11722222222222221, "reward_sla_mean_max": -0.0005555555555555556, "reward_consolidation_sum_mean": 297.36111111111114, "reward_consolidation_sum_min": 275.00000000000006, "reward_consolidation_sum_max": 323.6111111111112, "reward_illegal_sum_mean": -4.966666666666666, "reward_illegal_sum_min": -11.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 191.2612, "reward_accuracy_sum_min": 183.0083333333333, "reward_accuracy_sum_max": 197.89999999999998, "reward_sla_sum_mean": -3.61, "reward_sla_sum_min": -11.722222222222221, "reward_sla_sum_max": -0.05555555555555556, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3209.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [469.7116666666664, 479.56888888888864, 490.6555555555553, 447.5933333333332, 474.7599999999998, 472.14777777777755, 448.5938888888887, 468.0461111111107, 472.9977777777774, 483.8788888888887, 477.68944444444435, 467.56166666666644, 493.57555555555547, 446.03777777777736, 487.8538888888888, 479.86222222222204, 485.6405555555552, 487.10888888888854, 459.8249999999998, 488.1072222222221, 483.83888888888856, 491.3444444444443, 479.59444444444387, 474.38666666666654, 491.8949999999999, 477.1405555555552, 508.8944444444439, 448.61944444444407, 473.1644444444442, 495.4727777777774, 466.664444444444, 453.8305555555551, 487.02166666666653, 490.942222222222, 482.8711111111107, 452.0544444444441, 473.52833333333297, 474.49055555555526, 468.99722222222175, 472.6733333333328, 482.1177777777774, 487.0377777777775, 468.4122222222218, 460.3633333333332, 482.06833333333327, 465.9177777777777, 476.37166666666616, 485.98388888888877, 496.7366666666663, 470.58666666666625, 496.8144444444442, 479.3794444444442, 485.54555555555515, 494.7361111111106, 486.3149999999997, 498.418333333333, 480.0538888888884, 492.85499999999985, 493.94222222222163, 471.59222222222195, 477.3705555555553, 489.697222222222, 472.75944444444434, 478.5299999999996, 497.2744444444442, 488.70555555555507, 471.6499999999998, 494.7999999999998, 485.8944444444444, 508.8861111111107, 481.7677777777776, 488.3322222222218, 481.38722222222196, 506.93611111111085, 516.6088888888887, 491.45055555555564, 481.5238888888888, 492.25277777777745, 445.7055555555553, 486.67388888888877, 483.0216666666665, 498.41888888888855, 486.1088888888886, 473.1744444444443, 486.1327777777773, 471.7844444444441, 474.27611111111094, 480.0944444444443, 461.38777777777744, 465.3399999999998, 487.98333333333306, 488.94277777777756, 476.14222222222173, 477.9766666666661, 478.7605555555552, 467.4905555555555, 471.9599999999999, 481.1588888888886, 496.5144444444443, 475.7994444444441], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [469.7116666666664, 479.56888888888864, 490.6555555555553, 447.5933333333332, 474.7599999999998, 472.14777777777755, 448.5938888888887, 468.0461111111107, 472.9977777777774, 483.8788888888887, 477.68944444444435, 467.56166666666644, 493.57555555555547, 446.03777777777736, 487.8538888888888, 479.86222222222204, 485.6405555555552, 487.10888888888854, 459.8249999999998, 488.1072222222221, 483.83888888888856, 491.3444444444443, 479.59444444444387, 474.38666666666654, 491.8949999999999, 477.1405555555552, 508.8944444444439, 448.61944444444407, 473.1644444444442, 495.4727777777774, 466.664444444444, 453.8305555555551, 487.02166666666653, 490.942222222222, 482.8711111111107, 452.0544444444441, 473.52833333333297, 474.49055555555526, 468.99722222222175, 472.6733333333328, 482.1177777777774, 487.0377777777775, 468.4122222222218, 460.3633333333332, 482.06833333333327, 465.9177777777777, 476.37166666666616, 485.98388888888877, 496.7366666666663, 470.58666666666625, 496.8144444444442, 479.3794444444442, 485.54555555555515, 494.7361111111106, 486.3149999999997, 498.418333333333, 480.0538888888884, 492.85499999999985, 493.94222222222163, 471.59222222222195, 477.3705555555553, 489.697222222222, 472.75944444444434, 478.5299999999996, 497.2744444444442, 488.70555555555507, 471.6499999999998, 494.7999999999998, 485.8944444444444, 508.8861111111107, 481.7677777777776, 488.3322222222218, 481.38722222222196, 506.93611111111085, 516.6088888888887, 491.45055555555564, 481.5238888888888, 492.25277777777745, 445.7055555555553, 486.67388888888877, 483.0216666666665, 498.41888888888855, 486.1088888888886, 473.1744444444443, 486.1327777777773, 471.7844444444441, 474.27611111111094, 480.0944444444443, 461.38777777777744, 465.3399999999998, 487.98333333333306, 488.94277777777756, 476.14222222222173, 477.9766666666661, 478.7605555555552, 467.4905555555555, 471.9599999999999, 481.1588888888886, 496.5144444444443, 475.7994444444441]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19783200714193291, "mean_inference_ms": 1.8026164900206845, "mean_action_processing_ms": 0.07508518039654366, "mean_env_wait_ms": 1.2227885170478476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00438690185546875, "StateBufferConnector_ms": 0.0029625892639160156, "ViewRequirementAgentConnector_ms": 0.0677495002746582}, "num_episodes": 30, "episode_return_max": 516.6088888888887, "episode_return_min": 445.7055555555553, "episode_return_mean": 480.0456444444441, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 357750, "num_agent_steps_trained": 357600, "num_env_steps_sampled": 357750, "num_env_steps_trained": 357600, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 289.3050023513812, "num_env_steps_trained_throughput_per_sec": 289.3050023513812, "timesteps_total": 357750, "num_env_steps_sampled_lifetime": 357750, "num_agent_steps_sampled_lifetime": 357750, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 357750, "timers": {"training_iteration_time_ms": 10267.155, "restore_workers_time_ms": 0.011, "training_step_time_ms": 523.456, "sample_time_ms": 509.521, "synch_weights_time_ms": 12.606}, "counters": {"num_env_steps_sampled": 357750, "num_env_steps_trained": 357600, "num_agent_steps_sampled": 357750, "num_agent_steps_trained": 357600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2385, "num_samples_added_to_queue": 357600}, "done": false, "training_iteration": 120, "trial_id": "0313d_00000", "date": "2024-10-10_22-02-04", "timestamp": 1728594124, "time_this_iter_s": 10.382282972335815, "time_total_s": 1236.014797925949, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c29e40>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1236.014797925949, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 12.213333333333333, "ram_util_percent": 72.83999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 147060.4375, "policy_loss": 146624.78125, "entropy": 13.265832901000977, "entropy_coeff": 0.01, "var_gnorm": 16.654285430908203, "vf_loss": 475458.875, "vf_explained_var": 0.05601376295089722}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1202.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 360750, "num_env_steps_trained": 360600, "num_agent_steps_sampled": 360750, "num_agent_steps_trained": 360600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2405, "num_samples_added_to_queue": 360600, "learner_queue": {"size_count": 1202, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.559, "learner_load_time_ms": 0.309, "learner_load_wait_time_ms": 959.09, "learner_dequeue_time_ms": 8304.67}}, "env_runners": {"episode_reward_max": 516.6088888888887, "episode_reward_min": 445.7055555555553, "episode_reward_mean": 481.93671666666637, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 445.7055555555553}, "policy_reward_max": {"default_policy": 516.6088888888887}, "policy_reward_mean": {"default_policy": 481.93671666666637}, "custom_metrics": {"num_consolidated_mean": 2.222, "num_consolidated_min": 2.09, "num_consolidated_max": 2.36, "num_overloaded_mean": 0.027999999999999997, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 4.236, "num_moves_min": 3.71, "num_moves_max": 4.61, "mean_accuracy_mean": 39.408239999999985, "mean_accuracy_min": 39.15566666666665, "mean_accuracy_max": 39.60533333333333, "num_model_switches_mean": 2.1866000000000003, "num_model_switches_min": 1.81, "num_model_switches_max": 2.51, "num_slav_mean": 0.001179833333333333, "num_slav_min": 5e-05, "num_slav_max": 0.0051333333333333335, "mean_cluster_cpu_util_mean": 0.4660617377716717, "mean_cluster_cpu_util_min": 0.4514792477591792, "mean_cluster_cpu_util_max": 0.4794212324460312, "mean_cluster_mem_util_mean": 0.2931886868398203, "mean_cluster_mem_util_min": 0.28856324449611065, "mean_cluster_mem_util_max": 0.29819894443009276, "reward_consolidation_mean_mean": 2.9891666666666676, "reward_consolidation_mean_min": 2.7500000000000004, "reward_consolidation_mean_max": 3.236111111111112, "reward_illegal_mean_mean": -0.046666666666666655, "reward_illegal_mean_min": -0.11666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9148004999999997, "reward_accuracy_mean_min": 1.8243833333333332, "reward_accuracy_mean_max": 1.972033333333333, "reward_sla_mean_mean": -0.037933333333333326, "reward_sla_mean_min": -0.1433333333333333, "reward_sla_mean_max": -0.0005555555555555556, "reward_consolidation_sum_mean": 298.91666666666674, "reward_consolidation_sum_min": 275.00000000000006, "reward_consolidation_sum_max": 323.6111111111112, "reward_illegal_sum_mean": -4.666666666666666, "reward_illegal_sum_min": -11.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 191.48004999999995, "reward_accuracy_sum_min": 182.43833333333333, "reward_accuracy_sum_max": 197.20333333333332, "reward_sla_sum_mean": -3.793333333333333, "reward_sla_sum_min": -14.33333333333333, "reward_sla_sum_max": -0.05555555555555556, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2105.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [466.664444444444, 453.8305555555551, 487.02166666666653, 490.942222222222, 482.8711111111107, 452.0544444444441, 473.52833333333297, 474.49055555555526, 468.99722222222175, 472.6733333333328, 482.1177777777774, 487.0377777777775, 468.4122222222218, 460.3633333333332, 482.06833333333327, 465.9177777777777, 476.37166666666616, 485.98388888888877, 496.7366666666663, 470.58666666666625, 496.8144444444442, 479.3794444444442, 485.54555555555515, 494.7361111111106, 486.3149999999997, 498.418333333333, 480.0538888888884, 492.85499999999985, 493.94222222222163, 471.59222222222195, 477.3705555555553, 489.697222222222, 472.75944444444434, 478.5299999999996, 497.2744444444442, 488.70555555555507, 471.6499999999998, 494.7999999999998, 485.8944444444444, 508.8861111111107, 481.7677777777776, 488.3322222222218, 481.38722222222196, 506.93611111111085, 516.6088888888887, 491.45055555555564, 481.5238888888888, 492.25277777777745, 445.7055555555553, 486.67388888888877, 483.0216666666665, 498.41888888888855, 486.1088888888886, 473.1744444444443, 486.1327777777773, 471.7844444444441, 474.27611111111094, 480.0944444444443, 461.38777777777744, 465.3399999999998, 487.98333333333306, 488.94277777777756, 476.14222222222173, 477.9766666666661, 478.7605555555552, 467.4905555555555, 471.9599999999999, 481.1588888888886, 496.5144444444443, 475.7994444444441, 491.6488888888885, 478.77499999999975, 447.82722222222196, 465.682222222222, 472.152222222222, 496.4005555555552, 489.5544444444442, 473.0622222222221, 494.88777777777756, 483.618333333333, 474.8749999999997, 476.48277777777764, 495.28444444444415, 493.1327777777776, 489.52944444444427, 454.09333333333296, 486.8088888888887, 493.70444444444433, 484.03722222222206, 488.55388888888876, 508.06944444444423, 499.474444444444, 499.1877777777777, 487.5516666666664, 459.0883333333331, 487.68888888888875, 489.03833333333284, 474.3955555555553, 460.1183333333329, 499.9505555555554], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [466.664444444444, 453.8305555555551, 487.02166666666653, 490.942222222222, 482.8711111111107, 452.0544444444441, 473.52833333333297, 474.49055555555526, 468.99722222222175, 472.6733333333328, 482.1177777777774, 487.0377777777775, 468.4122222222218, 460.3633333333332, 482.06833333333327, 465.9177777777777, 476.37166666666616, 485.98388888888877, 496.7366666666663, 470.58666666666625, 496.8144444444442, 479.3794444444442, 485.54555555555515, 494.7361111111106, 486.3149999999997, 498.418333333333, 480.0538888888884, 492.85499999999985, 493.94222222222163, 471.59222222222195, 477.3705555555553, 489.697222222222, 472.75944444444434, 478.5299999999996, 497.2744444444442, 488.70555555555507, 471.6499999999998, 494.7999999999998, 485.8944444444444, 508.8861111111107, 481.7677777777776, 488.3322222222218, 481.38722222222196, 506.93611111111085, 516.6088888888887, 491.45055555555564, 481.5238888888888, 492.25277777777745, 445.7055555555553, 486.67388888888877, 483.0216666666665, 498.41888888888855, 486.1088888888886, 473.1744444444443, 486.1327777777773, 471.7844444444441, 474.27611111111094, 480.0944444444443, 461.38777777777744, 465.3399999999998, 487.98333333333306, 488.94277777777756, 476.14222222222173, 477.9766666666661, 478.7605555555552, 467.4905555555555, 471.9599999999999, 481.1588888888886, 496.5144444444443, 475.7994444444441, 491.6488888888885, 478.77499999999975, 447.82722222222196, 465.682222222222, 472.152222222222, 496.4005555555552, 489.5544444444442, 473.0622222222221, 494.88777777777756, 483.618333333333, 474.8749999999997, 476.48277777777764, 495.28444444444415, 493.1327777777776, 489.52944444444427, 454.09333333333296, 486.8088888888887, 493.70444444444433, 484.03722222222206, 488.55388888888876, 508.06944444444423, 499.474444444444, 499.1877777777777, 487.5516666666664, 459.0883333333331, 487.68888888888875, 489.03833333333284, 474.3955555555553, 460.1183333333329, 499.9505555555554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19788868318448682, "mean_inference_ms": 1.8039973090878072, "mean_action_processing_ms": 0.0751024464578496, "mean_env_wait_ms": 1.223079947213611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004256248474121094, "StateBufferConnector_ms": 0.0028836727142333984, "ViewRequirementAgentConnector_ms": 0.06553125381469727}, "num_episodes": 30, "episode_return_max": 516.6088888888887, "episode_return_min": 445.7055555555553, "episode_return_mean": 481.93671666666637, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360750, "num_agent_steps_trained": 360600, "num_env_steps_sampled": 360750, "num_env_steps_trained": 360600, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 295.48176039603237, "num_env_steps_trained_throughput_per_sec": 295.48176039603237, "timesteps_total": 360750, "num_env_steps_sampled_lifetime": 360750, "num_agent_steps_sampled_lifetime": 360750, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 360750, "timers": {"training_iteration_time_ms": 10244.724, "restore_workers_time_ms": 0.011, "training_step_time_ms": 525.796, "sample_time_ms": 511.696, "synch_weights_time_ms": 12.724}, "counters": {"num_env_steps_sampled": 360750, "num_env_steps_trained": 360600, "num_agent_steps_sampled": 360750, "num_agent_steps_trained": 360600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2405, "num_samples_added_to_queue": 360600}, "done": false, "training_iteration": 121, "trial_id": "0313d_00000", "date": "2024-10-10_22-02-14", "timestamp": 1728594134, "time_this_iter_s": 10.163594722747803, "time_total_s": 1246.178392648697, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c2a530>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1246.178392648697, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 11.599999999999998, "ram_util_percent": 72.80714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 138807.703125, "policy_loss": 138418.484375, "entropy": 12.962752342224121, "entropy_coeff": 0.01, "var_gnorm": 16.657258987426758, "vf_loss": 428113.28125, "vf_explained_var": 0.0691601037979126}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1212.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 363750, "num_env_steps_trained": 363600, "num_agent_steps_sampled": 363750, "num_agent_steps_trained": 363600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2425, "num_samples_added_to_queue": 363600, "learner_queue": {"size_count": 1212, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.141, "learner_load_time_ms": 0.315, "learner_load_wait_time_ms": 956.308, "learner_dequeue_time_ms": 8227.834}}, "env_runners": {"episode_reward_max": 516.6088888888887, "episode_reward_min": 445.7055555555553, "episode_reward_mean": 481.8736499999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 445.7055555555553}, "policy_reward_max": {"default_policy": 516.6088888888887}, "policy_reward_mean": {"default_policy": 481.8736499999997}, "custom_metrics": {"num_consolidated_mean": 2.2244, "num_consolidated_min": 2.08, "num_consolidated_max": 2.36, "num_overloaded_mean": 0.028399999999999998, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 4.2287, "num_moves_min": 3.71, "num_moves_max": 4.73, "mean_accuracy_mean": 39.387466666666654, "mean_accuracy_min": 39.15566666666665, "mean_accuracy_max": 39.567333333333316, "num_model_switches_mean": 2.1511, "num_model_switches_min": 1.83, "num_model_switches_max": 2.45, "num_slav_mean": 0.0012508333333333332, "num_slav_min": 5e-05, "num_slav_max": 0.0051333333333333335, "mean_cluster_cpu_util_mean": 0.4659639062893852, "mean_cluster_cpu_util_min": 0.45060072448003147, "mean_cluster_cpu_util_max": 0.4794212324460312, "mean_cluster_mem_util_mean": 0.2933329074367089, "mean_cluster_mem_util_min": 0.28816216937196826, "mean_cluster_mem_util_max": 0.2983262981141823, "reward_consolidation_mean_mean": 2.9927777777777784, "reward_consolidation_mean_min": 2.7500000000000004, "reward_consolidation_mean_max": 3.236111111111112, "reward_illegal_mean_mean": -0.047333333333333324, "reward_illegal_mean_min": -0.11666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9130031666666665, "reward_accuracy_mean_min": 1.8243833333333332, "reward_accuracy_mean_max": 1.9710833333333333, "reward_sla_mean_mean": -0.03971111111111111, "reward_sla_mean_min": -0.1433333333333333, "reward_sla_mean_max": -0.0005555555555555556, "reward_consolidation_sum_mean": 299.2777777777778, "reward_consolidation_sum_min": 275.00000000000006, "reward_consolidation_sum_max": 323.6111111111112, "reward_illegal_sum_mean": -4.733333333333333, "reward_illegal_sum_min": -11.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 191.30031666666662, "reward_accuracy_sum_min": 182.43833333333333, "reward_accuracy_sum_max": 197.10833333333332, "reward_sla_sum_mean": -3.971111111111111, "reward_sla_sum_min": -14.33333333333333, "reward_sla_sum_max": -0.05555555555555556, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2550.0, "global_timestep_min": 300, "global_timestep_max": 4200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [477.3705555555553, 489.697222222222, 472.75944444444434, 478.5299999999996, 497.2744444444442, 488.70555555555507, 471.6499999999998, 494.7999999999998, 485.8944444444444, 508.8861111111107, 481.7677777777776, 488.3322222222218, 481.38722222222196, 506.93611111111085, 516.6088888888887, 491.45055555555564, 481.5238888888888, 492.25277777777745, 445.7055555555553, 486.67388888888877, 483.0216666666665, 498.41888888888855, 486.1088888888886, 473.1744444444443, 486.1327777777773, 471.7844444444441, 474.27611111111094, 480.0944444444443, 461.38777777777744, 465.3399999999998, 487.98333333333306, 488.94277777777756, 476.14222222222173, 477.9766666666661, 478.7605555555552, 467.4905555555555, 471.9599999999999, 481.1588888888886, 496.5144444444443, 475.7994444444441, 491.6488888888885, 478.77499999999975, 447.82722222222196, 465.682222222222, 472.152222222222, 496.4005555555552, 489.5544444444442, 473.0622222222221, 494.88777777777756, 483.618333333333, 474.8749999999997, 476.48277777777764, 495.28444444444415, 493.1327777777776, 489.52944444444427, 454.09333333333296, 486.8088888888887, 493.70444444444433, 484.03722222222206, 488.55388888888876, 508.06944444444423, 499.474444444444, 499.1877777777777, 487.5516666666664, 459.0883333333331, 487.68888888888875, 489.03833333333284, 474.3955555555553, 460.1183333333329, 499.9505555555554, 454.8394444444443, 489.9677777777775, 473.2916666666664, 490.6088888888885, 466.6888888888885, 481.68166666666644, 492.5477777777778, 498.18777777777746, 488.12666666666627, 480.67999999999984, 495.022222222222, 472.6644444444442, 493.05388888888854, 462.5616666666662, 463.5794444444441, 486.8955555555552, 491.6088888888887, 477.42944444444396, 501.86999999999966, 475.3088888888885, 460.44611111111084, 470.6983333333328, 460.2922222222218, 480.237222222222, 485.7455555555553, 475.9361111111111, 481.07833333333303, 452.5405555555552, 467.95222222222185, 500.4738888888887], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [477.3705555555553, 489.697222222222, 472.75944444444434, 478.5299999999996, 497.2744444444442, 488.70555555555507, 471.6499999999998, 494.7999999999998, 485.8944444444444, 508.8861111111107, 481.7677777777776, 488.3322222222218, 481.38722222222196, 506.93611111111085, 516.6088888888887, 491.45055555555564, 481.5238888888888, 492.25277777777745, 445.7055555555553, 486.67388888888877, 483.0216666666665, 498.41888888888855, 486.1088888888886, 473.1744444444443, 486.1327777777773, 471.7844444444441, 474.27611111111094, 480.0944444444443, 461.38777777777744, 465.3399999999998, 487.98333333333306, 488.94277777777756, 476.14222222222173, 477.9766666666661, 478.7605555555552, 467.4905555555555, 471.9599999999999, 481.1588888888886, 496.5144444444443, 475.7994444444441, 491.6488888888885, 478.77499999999975, 447.82722222222196, 465.682222222222, 472.152222222222, 496.4005555555552, 489.5544444444442, 473.0622222222221, 494.88777777777756, 483.618333333333, 474.8749999999997, 476.48277777777764, 495.28444444444415, 493.1327777777776, 489.52944444444427, 454.09333333333296, 486.8088888888887, 493.70444444444433, 484.03722222222206, 488.55388888888876, 508.06944444444423, 499.474444444444, 499.1877777777777, 487.5516666666664, 459.0883333333331, 487.68888888888875, 489.03833333333284, 474.3955555555553, 460.1183333333329, 499.9505555555554, 454.8394444444443, 489.9677777777775, 473.2916666666664, 490.6088888888885, 466.6888888888885, 481.68166666666644, 492.5477777777778, 498.18777777777746, 488.12666666666627, 480.67999999999984, 495.022222222222, 472.6644444444442, 493.05388888888854, 462.5616666666662, 463.5794444444441, 486.8955555555552, 491.6088888888887, 477.42944444444396, 501.86999999999966, 475.3088888888885, 460.44611111111084, 470.6983333333328, 460.2922222222218, 480.237222222222, 485.7455555555553, 475.9361111111111, 481.07833333333303, 452.5405555555552, 467.95222222222185, 500.4738888888887]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19787371987159524, "mean_inference_ms": 1.8035997327399291, "mean_action_processing_ms": 0.07509191578594634, "mean_env_wait_ms": 1.2229186958258813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004556417465209961, "StateBufferConnector_ms": 0.0028765201568603516, "ViewRequirementAgentConnector_ms": 0.06537818908691406}, "num_episodes": 30, "episode_return_max": 516.6088888888887, "episode_return_min": 445.7055555555553, "episode_return_mean": 481.8736499999997, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 363750, "num_agent_steps_trained": 363600, "num_env_steps_sampled": 363750, "num_env_steps_trained": 363600, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 297.6606589874111, "num_env_steps_trained_throughput_per_sec": 297.6606589874111, "timesteps_total": 363750, "num_env_steps_sampled_lifetime": 363750, "num_agent_steps_sampled_lifetime": 363750, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 363750, "timers": {"training_iteration_time_ms": 10197.463, "restore_workers_time_ms": 0.011, "training_step_time_ms": 514.571, "sample_time_ms": 500.261, "synch_weights_time_ms": 12.985}, "counters": {"num_env_steps_sampled": 363750, "num_env_steps_trained": 363600, "num_agent_steps_sampled": 363750, "num_agent_steps_trained": 363600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2425, "num_samples_added_to_queue": 363600}, "done": false, "training_iteration": 122, "trial_id": "0313d_00000", "date": "2024-10-10_22-02-24", "timestamp": 1728594144, "time_this_iter_s": 10.103488445281982, "time_total_s": 1256.2818810939789, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c2a3e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1256.2818810939789, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 11.306666666666667, "ram_util_percent": 73.02000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 142127.765625, "policy_loss": 141703.640625, "entropy": 13.011731147766113, "entropy_coeff": 0.01, "var_gnorm": 16.65593910217285, "vf_loss": 463153.5625, "vf_explained_var": 0.07337045669555664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1222.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 366750, "num_env_steps_trained": 366600, "num_agent_steps_sampled": 366750, "num_agent_steps_trained": 366600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2445, "num_samples_added_to_queue": 366600, "learner_queue": {"size_count": 1222, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 51.067, "learner_load_time_ms": 0.298, "learner_load_wait_time_ms": 982.407, "learner_dequeue_time_ms": 8247.943}}, "env_runners": {"episode_reward_max": 508.06944444444423, "episode_reward_min": 447.82722222222196, "episode_reward_mean": 482.2486055555553, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 447.82722222222196}, "policy_reward_max": {"default_policy": 508.06944444444423}, "policy_reward_mean": {"default_policy": 482.2486055555553}, "custom_metrics": {"num_consolidated_mean": 2.2276, "num_consolidated_min": 2.08, "num_consolidated_max": 2.37, "num_overloaded_mean": 0.0278, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 4.2263, "num_moves_min": 3.78, "num_moves_max": 4.74, "mean_accuracy_mean": 39.37106333333332, "mean_accuracy_min": 39.13666666666665, "mean_accuracy_max": 39.567333333333316, "num_model_switches_mean": 2.1241, "num_model_switches_min": 1.78, "num_model_switches_max": 2.45, "num_slav_mean": 0.0013931666666666667, "num_slav_min": 6.666666666666667e-05, "num_slav_max": 0.0051333333333333335, "mean_cluster_cpu_util_mean": 0.46579397685246376, "mean_cluster_cpu_util_min": 0.45060072448003147, "mean_cluster_cpu_util_max": 0.4794212324460312, "mean_cluster_mem_util_mean": 0.2933512574987801, "mean_cluster_mem_util_min": 0.28816216937196826, "mean_cluster_mem_util_max": 0.2983262981141823, "reward_consolidation_mean_mean": 2.999722222222223, "reward_consolidation_mean_min": 2.777777777777778, "reward_consolidation_mean_max": 3.208333333333334, "reward_illegal_mean_mean": -0.04633333333333332, "reward_illegal_mean_min": -0.11666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9133304999999996, "reward_accuracy_mean_min": 1.8243833333333332, "reward_accuracy_mean_max": 1.9707666666666666, "reward_sla_mean_mean": -0.044233333333333326, "reward_sla_mean_min": -0.1444444444444444, "reward_sla_mean_max": -0.0022222222222222222, "reward_consolidation_sum_mean": 299.9722222222223, "reward_consolidation_sum_min": 277.7777777777778, "reward_consolidation_sum_max": 320.83333333333337, "reward_illegal_sum_mean": -4.633333333333333, "reward_illegal_sum_min": -11.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 191.33305000000001, "reward_accuracy_sum_min": 182.43833333333333, "reward_accuracy_sum_max": 197.07666666666665, "reward_sla_sum_mean": -4.423333333333333, "reward_sla_sum_min": -14.444444444444441, "reward_sla_sum_max": -0.22222222222222224, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3550.0, "global_timestep_min": 1300, "global_timestep_max": 5200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [487.98333333333306, 488.94277777777756, 476.14222222222173, 477.9766666666661, 478.7605555555552, 467.4905555555555, 471.9599999999999, 481.1588888888886, 496.5144444444443, 475.7994444444441, 491.6488888888885, 478.77499999999975, 447.82722222222196, 465.682222222222, 472.152222222222, 496.4005555555552, 489.5544444444442, 473.0622222222221, 494.88777777777756, 483.618333333333, 474.8749999999997, 476.48277777777764, 495.28444444444415, 493.1327777777776, 489.52944444444427, 454.09333333333296, 486.8088888888887, 493.70444444444433, 484.03722222222206, 488.55388888888876, 508.06944444444423, 499.474444444444, 499.1877777777777, 487.5516666666664, 459.0883333333331, 487.68888888888875, 489.03833333333284, 474.3955555555553, 460.1183333333329, 499.9505555555554, 454.8394444444443, 489.9677777777775, 473.2916666666664, 490.6088888888885, 466.6888888888885, 481.68166666666644, 492.5477777777778, 498.18777777777746, 488.12666666666627, 480.67999999999984, 495.022222222222, 472.6644444444442, 493.05388888888854, 462.5616666666662, 463.5794444444441, 486.8955555555552, 491.6088888888887, 477.42944444444396, 501.86999999999966, 475.3088888888885, 460.44611111111084, 470.6983333333328, 460.2922222222218, 480.237222222222, 485.7455555555553, 475.9361111111111, 481.07833333333303, 452.5405555555552, 467.95222222222185, 500.4738888888887, 492.2061111111108, 497.63388888888875, 482.9127777777774, 476.36277777777764, 490.76944444444416, 478.69666666666643, 482.27611111111077, 501.4438888888887, 492.9833333333329, 499.91111111111087, 458.22055555555517, 504.43388888888876, 468.73833333333306, 495.9422222222218, 479.91222222222194, 485.91944444444414, 488.9661111111109, 469.78555555555533, 494.9749999999997, 503.3799999999997, 476.7055555555553, 482.3655555555553, 491.97777777777765, 467.75333333333316, 490.18277777777735, 471.85499999999985, 471.18999999999966, 478.4205555555549, 484.2216666666664, 495.29999999999984], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [487.98333333333306, 488.94277777777756, 476.14222222222173, 477.9766666666661, 478.7605555555552, 467.4905555555555, 471.9599999999999, 481.1588888888886, 496.5144444444443, 475.7994444444441, 491.6488888888885, 478.77499999999975, 447.82722222222196, 465.682222222222, 472.152222222222, 496.4005555555552, 489.5544444444442, 473.0622222222221, 494.88777777777756, 483.618333333333, 474.8749999999997, 476.48277777777764, 495.28444444444415, 493.1327777777776, 489.52944444444427, 454.09333333333296, 486.8088888888887, 493.70444444444433, 484.03722222222206, 488.55388888888876, 508.06944444444423, 499.474444444444, 499.1877777777777, 487.5516666666664, 459.0883333333331, 487.68888888888875, 489.03833333333284, 474.3955555555553, 460.1183333333329, 499.9505555555554, 454.8394444444443, 489.9677777777775, 473.2916666666664, 490.6088888888885, 466.6888888888885, 481.68166666666644, 492.5477777777778, 498.18777777777746, 488.12666666666627, 480.67999999999984, 495.022222222222, 472.6644444444442, 493.05388888888854, 462.5616666666662, 463.5794444444441, 486.8955555555552, 491.6088888888887, 477.42944444444396, 501.86999999999966, 475.3088888888885, 460.44611111111084, 470.6983333333328, 460.2922222222218, 480.237222222222, 485.7455555555553, 475.9361111111111, 481.07833333333303, 452.5405555555552, 467.95222222222185, 500.4738888888887, 492.2061111111108, 497.63388888888875, 482.9127777777774, 476.36277777777764, 490.76944444444416, 478.69666666666643, 482.27611111111077, 501.4438888888887, 492.9833333333329, 499.91111111111087, 458.22055555555517, 504.43388888888876, 468.73833333333306, 495.9422222222218, 479.91222222222194, 485.91944444444414, 488.9661111111109, 469.78555555555533, 494.9749999999997, 503.3799999999997, 476.7055555555553, 482.3655555555553, 491.97777777777765, 467.75333333333316, 490.18277777777735, 471.85499999999985, 471.18999999999966, 478.4205555555549, 484.2216666666664, 495.29999999999984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19785626163511533, "mean_inference_ms": 1.8032785282618837, "mean_action_processing_ms": 0.07508264777033981, "mean_env_wait_ms": 1.2227884806366673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004564523696899414, "StateBufferConnector_ms": 0.0028624534606933594, "ViewRequirementAgentConnector_ms": 0.06528329849243164}, "num_episodes": 30, "episode_return_max": 508.06944444444423, "episode_return_min": 447.82722222222196, "episode_return_mean": 482.2486055555553, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 366750, "num_agent_steps_trained": 366600, "num_env_steps_sampled": 366750, "num_env_steps_trained": 366600, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 290.29527547883134, "num_env_steps_trained_throughput_per_sec": 290.29527547883134, "timesteps_total": 366750, "num_env_steps_sampled_lifetime": 366750, "num_agent_steps_sampled_lifetime": 366750, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 366750, "timers": {"training_iteration_time_ms": 10210.916, "restore_workers_time_ms": 0.012, "training_step_time_ms": 511.992, "sample_time_ms": 496.495, "synch_weights_time_ms": 13.887}, "counters": {"num_env_steps_sampled": 366750, "num_env_steps_trained": 366600, "num_agent_steps_sampled": 366750, "num_agent_steps_trained": 366600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2445, "num_samples_added_to_queue": 366600}, "done": false, "training_iteration": 123, "trial_id": "0313d_00000", "date": "2024-10-10_22-02-35", "timestamp": 1728594155, "time_this_iter_s": 10.35524606704712, "time_total_s": 1266.637127161026, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a50f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1266.637127161026, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 11.959999999999999, "ram_util_percent": 73.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 140034.359375, "policy_loss": 139648.9375, "entropy": 13.030229568481445, "entropy_coeff": 0.01, "var_gnorm": 16.652217864990234, "vf_loss": 424510.28125, "vf_explained_var": 0.08424156904220581}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1232.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 369750, "num_env_steps_trained": 369600, "num_agent_steps_sampled": 369750, "num_agent_steps_trained": 369600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2465, "num_samples_added_to_queue": 369600, "learner_queue": {"size_count": 1232, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 51.418, "learner_load_time_ms": 0.28, "learner_load_wait_time_ms": 988.491, "learner_dequeue_time_ms": 8247.035}}, "env_runners": {"episode_reward_max": 508.8783333333333, "episode_reward_min": 452.5405555555552, "episode_reward_mean": 483.9741611111108, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 452.5405555555552}, "policy_reward_max": {"default_policy": 508.8783333333333}, "policy_reward_mean": {"default_policy": 483.9741611111108}, "custom_metrics": {"num_consolidated_mean": 2.2288, "num_consolidated_min": 2.08, "num_consolidated_max": 2.37, "num_overloaded_mean": 0.025799999999999997, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 4.1998999999999995, "num_moves_min": 3.78, "num_moves_max": 4.74, "mean_accuracy_mean": 39.378473333333325, "mean_accuracy_min": 39.13666666666665, "mean_accuracy_max": 39.554666666666655, "num_model_switches_mean": 2.0951000000000004, "num_model_switches_min": 1.78, "num_model_switches_max": 2.45, "num_slav_mean": 0.0013571666666666671, "num_slav_min": 0.00011666666666666667, "num_slav_max": 0.004333333333333332, "mean_cluster_cpu_util_mean": 0.46629574564395676, "mean_cluster_cpu_util_min": 0.45060072448003147, "mean_cluster_cpu_util_max": 0.47909291024594963, "mean_cluster_mem_util_mean": 0.29354886358857885, "mean_cluster_mem_util_min": 0.28816216937196826, "mean_cluster_mem_util_max": 0.298755891027297, "reward_consolidation_mean_mean": 3.0084722222222227, "reward_consolidation_mean_min": 2.777777777777779, "reward_consolidation_mean_max": 3.208333333333334, "reward_illegal_mean_mean": -0.04299999999999999, "reward_illegal_mean_min": -0.11666666666666664, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9176304999999996, "reward_accuracy_mean_min": 1.8250166666666663, "reward_accuracy_mean_max": 1.9707666666666666, "reward_sla_mean_mean": -0.043361111111111114, "reward_sla_mean_min": -0.1444444444444444, "reward_sla_mean_max": -0.0038888888888888896, "reward_consolidation_sum_mean": 300.8472222222223, "reward_consolidation_sum_min": 277.7777777777779, "reward_consolidation_sum_max": 320.83333333333337, "reward_illegal_sum_mean": -4.3, "reward_illegal_sum_min": -11.666666666666664, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 191.76304999999994, "reward_accuracy_sum_min": 182.50166666666664, "reward_accuracy_sum_max": 197.07666666666665, "reward_sla_sum_mean": -4.336111111111111, "reward_sla_sum_min": -14.444444444444441, "reward_sla_sum_max": -0.38888888888888895, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4550.0, "global_timestep_min": 2300, "global_timestep_max": 6200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [508.06944444444423, 499.474444444444, 499.1877777777777, 487.5516666666664, 459.0883333333331, 487.68888888888875, 489.03833333333284, 474.3955555555553, 460.1183333333329, 499.9505555555554, 454.8394444444443, 489.9677777777775, 473.2916666666664, 490.6088888888885, 466.6888888888885, 481.68166666666644, 492.5477777777778, 498.18777777777746, 488.12666666666627, 480.67999999999984, 495.022222222222, 472.6644444444442, 493.05388888888854, 462.5616666666662, 463.5794444444441, 486.8955555555552, 491.6088888888887, 477.42944444444396, 501.86999999999966, 475.3088888888885, 460.44611111111084, 470.6983333333328, 460.2922222222218, 480.237222222222, 485.7455555555553, 475.9361111111111, 481.07833333333303, 452.5405555555552, 467.95222222222185, 500.4738888888887, 492.2061111111108, 497.63388888888875, 482.9127777777774, 476.36277777777764, 490.76944444444416, 478.69666666666643, 482.27611111111077, 501.4438888888887, 492.9833333333329, 499.91111111111087, 458.22055555555517, 504.43388888888876, 468.73833333333306, 495.9422222222218, 479.91222222222194, 485.91944444444414, 488.9661111111109, 469.78555555555533, 494.9749999999997, 503.3799999999997, 476.7055555555553, 482.3655555555553, 491.97777777777765, 467.75333333333316, 490.18277777777735, 471.85499999999985, 471.18999999999966, 478.4205555555549, 484.2216666666664, 495.29999999999984, 506.3466666666663, 484.46722222222184, 491.32166666666643, 490.72833333333307, 486.51333333333315, 504.87166666666644, 503.95777777777744, 497.41222222222194, 480.2688888888884, 472.69777777777756, 484.58666666666653, 470.80777777777763, 455.6505555555552, 479.6338888888886, 460.19666666666654, 485.56833333333327, 504.1477777777774, 466.99944444444446, 491.2922222222219, 506.57666666666626, 484.86388888888865, 496.1722222222218, 468.77722222222224, 477.7616666666666, 485.6188888888888, 468.41055555555533, 498.7366666666665, 508.8783333333333, 500.4649999999998, 491.6655555555552], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [508.06944444444423, 499.474444444444, 499.1877777777777, 487.5516666666664, 459.0883333333331, 487.68888888888875, 489.03833333333284, 474.3955555555553, 460.1183333333329, 499.9505555555554, 454.8394444444443, 489.9677777777775, 473.2916666666664, 490.6088888888885, 466.6888888888885, 481.68166666666644, 492.5477777777778, 498.18777777777746, 488.12666666666627, 480.67999999999984, 495.022222222222, 472.6644444444442, 493.05388888888854, 462.5616666666662, 463.5794444444441, 486.8955555555552, 491.6088888888887, 477.42944444444396, 501.86999999999966, 475.3088888888885, 460.44611111111084, 470.6983333333328, 460.2922222222218, 480.237222222222, 485.7455555555553, 475.9361111111111, 481.07833333333303, 452.5405555555552, 467.95222222222185, 500.4738888888887, 492.2061111111108, 497.63388888888875, 482.9127777777774, 476.36277777777764, 490.76944444444416, 478.69666666666643, 482.27611111111077, 501.4438888888887, 492.9833333333329, 499.91111111111087, 458.22055555555517, 504.43388888888876, 468.73833333333306, 495.9422222222218, 479.91222222222194, 485.91944444444414, 488.9661111111109, 469.78555555555533, 494.9749999999997, 503.3799999999997, 476.7055555555553, 482.3655555555553, 491.97777777777765, 467.75333333333316, 490.18277777777735, 471.85499999999985, 471.18999999999966, 478.4205555555549, 484.2216666666664, 495.29999999999984, 506.3466666666663, 484.46722222222184, 491.32166666666643, 490.72833333333307, 486.51333333333315, 504.87166666666644, 503.95777777777744, 497.41222222222194, 480.2688888888884, 472.69777777777756, 484.58666666666653, 470.80777777777763, 455.6505555555552, 479.6338888888886, 460.19666666666654, 485.56833333333327, 504.1477777777774, 466.99944444444446, 491.2922222222219, 506.57666666666626, 484.86388888888865, 496.1722222222218, 468.77722222222224, 477.7616666666666, 485.6188888888888, 468.41055555555533, 498.7366666666665, 508.8783333333333, 500.4649999999998, 491.6655555555552]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19784761967607906, "mean_inference_ms": 1.8029221747065804, "mean_action_processing_ms": 0.07507277667366756, "mean_env_wait_ms": 1.2226511963970585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004604816436767578, "StateBufferConnector_ms": 0.002885580062866211, "ViewRequirementAgentConnector_ms": 0.06608247756958008}, "num_episodes": 30, "episode_return_max": 508.8783333333333, "episode_return_min": 452.5405555555552, "episode_return_mean": 483.9741611111108, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 369750, "num_agent_steps_trained": 369600, "num_env_steps_sampled": 369750, "num_env_steps_trained": 369600, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 293.5192511532777, "num_env_steps_trained_throughput_per_sec": 293.5192511532777, "timesteps_total": 369750, "num_env_steps_sampled_lifetime": 369750, "num_agent_steps_sampled_lifetime": 369750, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 369750, "timers": {"training_iteration_time_ms": 10193.13, "restore_workers_time_ms": 0.011, "training_step_time_ms": 491.312, "sample_time_ms": 476.659, "synch_weights_time_ms": 13.289}, "counters": {"num_env_steps_sampled": 369750, "num_env_steps_trained": 369600, "num_agent_steps_sampled": 369750, "num_agent_steps_trained": 369600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2465, "num_samples_added_to_queue": 369600}, "done": false, "training_iteration": 124, "trial_id": "0313d_00000", "date": "2024-10-10_22-02-45", "timestamp": 1728594165, "time_this_iter_s": 10.232821702957153, "time_total_s": 1276.8699488639832, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c29a50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1276.8699488639832, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 11.87857142857143, "ram_util_percent": 73.17857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 142730.890625, "policy_loss": 142349.578125, "entropy": 12.85683822631836, "entropy_coeff": 0.01, "var_gnorm": 16.65128517150879, "vf_loss": 419889.875, "vf_explained_var": 0.0907202959060669}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1241.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 372600, "num_env_steps_trained": 372300, "num_agent_steps_sampled": 372600, "num_agent_steps_trained": 372300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2484, "num_samples_added_to_queue": 372600, "learner_queue": {"size_count": 1241, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.876, "learner_load_time_ms": 0.353, "learner_load_wait_time_ms": 1024.851, "learner_dequeue_time_ms": 8354.58}}, "env_runners": {"episode_reward_max": 512.1088888888885, "episode_reward_min": 452.5405555555552, "episode_reward_mean": 486.5637055555554, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 452.5405555555552}, "policy_reward_max": {"default_policy": 512.1088888888885}, "policy_reward_mean": {"default_policy": 486.5637055555554}, "custom_metrics": {"num_consolidated_mean": 2.2472, "num_consolidated_min": 2.08, "num_consolidated_max": 2.37, "num_overloaded_mean": 0.025499999999999995, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 4.185200000000001, "num_moves_min": 3.78, "num_moves_max": 4.79, "mean_accuracy_mean": 39.40329999999999, "mean_accuracy_min": 39.13666666666665, "mean_accuracy_max": 39.65599999999999, "num_model_switches_mean": 2.0648, "num_model_switches_min": 1.6, "num_model_switches_max": 2.44, "num_slav_mean": 0.0014266666666666666, "num_slav_min": 0.00011666666666666667, "num_slav_max": 0.0052, "mean_cluster_cpu_util_mean": 0.46845532460228356, "mean_cluster_cpu_util_min": 0.45060072448003147, "mean_cluster_cpu_util_max": 0.47909291024594963, "mean_cluster_mem_util_mean": 0.29431030470342134, "mean_cluster_mem_util_min": 0.28816216937196826, "mean_cluster_mem_util_max": 0.298755891027297, "reward_consolidation_mean_mean": 3.0341666666666667, "reward_consolidation_mean_min": 2.777777777777779, "reward_consolidation_mean_max": 3.2222222222222223, "reward_illegal_mean_mean": -0.04249999999999999, "reward_illegal_mean_min": -0.11666666666666664, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.919364833333333, "reward_accuracy_mean_min": 1.8250166666666663, "reward_accuracy_mean_max": 1.9713999999999998, "reward_sla_mean_mean": -0.045394444444444446, "reward_sla_mean_min": -0.1733333333333333, "reward_sla_mean_max": -0.0038888888888888896, "reward_consolidation_sum_mean": 303.4166666666667, "reward_consolidation_sum_min": 277.7777777777779, "reward_consolidation_sum_max": 322.22222222222223, "reward_illegal_sum_mean": -4.250000000000001, "reward_illegal_sum_min": -11.666666666666664, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 191.93648333333329, "reward_accuracy_sum_min": 182.50166666666664, "reward_accuracy_sum_max": 197.14, "reward_sla_sum_mean": -4.5394444444444435, "reward_sla_sum_min": -17.333333333333332, "reward_sla_sum_max": -0.38888888888888895, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5550.0, "global_timestep_min": 3300, "global_timestep_max": 7200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [460.44611111111084, 470.6983333333328, 460.2922222222218, 480.237222222222, 485.7455555555553, 475.9361111111111, 481.07833333333303, 452.5405555555552, 467.95222222222185, 500.4738888888887, 492.2061111111108, 497.63388888888875, 482.9127777777774, 476.36277777777764, 490.76944444444416, 478.69666666666643, 482.27611111111077, 501.4438888888887, 492.9833333333329, 499.91111111111087, 458.22055555555517, 504.43388888888876, 468.73833333333306, 495.9422222222218, 479.91222222222194, 485.91944444444414, 488.9661111111109, 469.78555555555533, 494.9749999999997, 503.3799999999997, 476.7055555555553, 482.3655555555553, 491.97777777777765, 467.75333333333316, 490.18277777777735, 471.85499999999985, 471.18999999999966, 478.4205555555549, 484.2216666666664, 495.29999999999984, 506.3466666666663, 484.46722222222184, 491.32166666666643, 490.72833333333307, 486.51333333333315, 504.87166666666644, 503.95777777777744, 497.41222222222194, 480.2688888888884, 472.69777777777756, 484.58666666666653, 470.80777777777763, 455.6505555555552, 479.6338888888886, 460.19666666666654, 485.56833333333327, 504.1477777777774, 466.99944444444446, 491.2922222222219, 506.57666666666626, 484.86388888888865, 496.1722222222218, 468.77722222222224, 477.7616666666666, 485.6188888888888, 468.41055555555533, 498.7366666666665, 508.8783333333333, 500.4649999999998, 491.6655555555552, 481.3949999999998, 488.9811111111107, 502.4177777777775, 501.7183333333329, 503.1716666666663, 488.09277777777754, 481.0222222222222, 491.9822222222221, 488.3549999999996, 488.41777777777764, 482.72944444444414, 494.1322222222223, 496.3788888888885, 479.5627777777776, 487.4033333333331, 504.2683333333331, 479.964444444444, 499.9727777777776, 490.32222222222214, 504.6394444444442, 501.2511111111109, 507.1094444444441, 473.9738888888887, 489.7649999999997, 489.8144444444442, 490.48222222222205, 469.51444444444434, 488.7983333333331, 502.38722222222196, 512.1088888888885], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [460.44611111111084, 470.6983333333328, 460.2922222222218, 480.237222222222, 485.7455555555553, 475.9361111111111, 481.07833333333303, 452.5405555555552, 467.95222222222185, 500.4738888888887, 492.2061111111108, 497.63388888888875, 482.9127777777774, 476.36277777777764, 490.76944444444416, 478.69666666666643, 482.27611111111077, 501.4438888888887, 492.9833333333329, 499.91111111111087, 458.22055555555517, 504.43388888888876, 468.73833333333306, 495.9422222222218, 479.91222222222194, 485.91944444444414, 488.9661111111109, 469.78555555555533, 494.9749999999997, 503.3799999999997, 476.7055555555553, 482.3655555555553, 491.97777777777765, 467.75333333333316, 490.18277777777735, 471.85499999999985, 471.18999999999966, 478.4205555555549, 484.2216666666664, 495.29999999999984, 506.3466666666663, 484.46722222222184, 491.32166666666643, 490.72833333333307, 486.51333333333315, 504.87166666666644, 503.95777777777744, 497.41222222222194, 480.2688888888884, 472.69777777777756, 484.58666666666653, 470.80777777777763, 455.6505555555552, 479.6338888888886, 460.19666666666654, 485.56833333333327, 504.1477777777774, 466.99944444444446, 491.2922222222219, 506.57666666666626, 484.86388888888865, 496.1722222222218, 468.77722222222224, 477.7616666666666, 485.6188888888888, 468.41055555555533, 498.7366666666665, 508.8783333333333, 500.4649999999998, 491.6655555555552, 481.3949999999998, 488.9811111111107, 502.4177777777775, 501.7183333333329, 503.1716666666663, 488.09277777777754, 481.0222222222222, 491.9822222222221, 488.3549999999996, 488.41777777777764, 482.72944444444414, 494.1322222222223, 496.3788888888885, 479.5627777777776, 487.4033333333331, 504.2683333333331, 479.964444444444, 499.9727777777776, 490.32222222222214, 504.6394444444442, 501.2511111111109, 507.1094444444441, 473.9738888888887, 489.7649999999997, 489.8144444444442, 490.48222222222205, 469.51444444444434, 488.7983333333331, 502.38722222222196, 512.1088888888885]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19787727740033437, "mean_inference_ms": 1.8028701324484775, "mean_action_processing_ms": 0.0750784531907789, "mean_env_wait_ms": 1.2227144151669882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00439000129699707, "StateBufferConnector_ms": 0.002908945083618164, "ViewRequirementAgentConnector_ms": 0.0666646957397461}, "num_episodes": 30, "episode_return_max": 512.1088888888885, "episode_return_min": 452.5405555555552, "episode_return_mean": 486.5637055555554, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372600, "num_agent_steps_trained": 372300, "num_env_steps_sampled": 372600, "num_env_steps_trained": 372300, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 275.6879568318743, "num_env_steps_trained_throughput_per_sec": 261.17806436703887, "timesteps_total": 372600, "num_env_steps_sampled_lifetime": 372600, "num_agent_steps_sampled_lifetime": 372600, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 372600, "timers": {"training_iteration_time_ms": 10212.503, "restore_workers_time_ms": 0.016, "training_step_time_ms": 546.773, "sample_time_ms": 530.234, "synch_weights_time_ms": 15.174}, "counters": {"num_env_steps_sampled": 372600, "num_env_steps_trained": 372300, "num_agent_steps_sampled": 372600, "num_agent_steps_trained": 372300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2484, "num_samples_added_to_queue": 372600}, "done": false, "training_iteration": 125, "trial_id": "0313d_00000", "date": "2024-10-10_22-02-55", "timestamp": 1728594175, "time_this_iter_s": 10.349608421325684, "time_total_s": 1287.2195572853088, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a4a00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1287.2195572853088, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 15.473333333333333, "ram_util_percent": 73.71999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 131209.375, "policy_loss": 130782.1328125, "entropy": 12.082483291625977, "entropy_coeff": 0.01, "var_gnorm": 16.652387619018555, "vf_loss": 463487.90625, "vf_explained_var": 0.10324615240097046}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1251.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 375450, "num_env_steps_trained": 375300, "num_agent_steps_sampled": 375450, "num_agent_steps_trained": 375300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2503, "num_samples_added_to_queue": 375300, "learner_queue": {"size_count": 1251, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 72.009, "learner_load_time_ms": 0.352, "learner_load_wait_time_ms": 987.075, "learner_dequeue_time_ms": 8334.204}}, "env_runners": {"episode_reward_max": 527.1799999999997, "episode_reward_min": 455.6505555555552, "episode_reward_mean": 493.1987777777774, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 455.6505555555552}, "policy_reward_max": {"default_policy": 527.1799999999997}, "policy_reward_mean": {"default_policy": 493.1987777777774}, "custom_metrics": {"num_consolidated_mean": 2.2795, "num_consolidated_min": 2.1, "num_consolidated_max": 2.44, "num_overloaded_mean": 0.022499999999999996, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 4.0969, "num_moves_min": 3.58, "num_moves_max": 4.79, "mean_accuracy_mean": 39.43306666666665, "mean_accuracy_min": 39.13666666666665, "mean_accuracy_max": 39.66233333333333, "num_model_switches_mean": 2.0107, "num_model_switches_min": 1.59, "num_model_switches_max": 2.44, "num_slav_mean": 0.0014048333333333332, "num_slav_min": 0.00016666666666666666, "num_slav_max": 0.0052, "mean_cluster_cpu_util_mean": 0.47196409542406614, "mean_cluster_cpu_util_min": 0.45360004208832394, "mean_cluster_cpu_util_max": 0.4877114963700086, "mean_cluster_mem_util_mean": 0.2957655661848073, "mean_cluster_mem_util_min": 0.2890777662963919, "mean_cluster_mem_util_max": 0.302671954383019, "reward_consolidation_mean_mean": 3.0881944444444454, "reward_consolidation_mean_min": 2.8194444444444446, "reward_consolidation_mean_max": 3.3333333333333344, "reward_illegal_mean_mean": -0.03749999999999999, "reward_illegal_mean_min": -0.11666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9267933333333331, "reward_accuracy_mean_min": 1.8376833333333336, "reward_accuracy_mean_max": 1.9723499999999996, "reward_sla_mean_mean": -0.045500000000000006, "reward_sla_mean_min": -0.1733333333333333, "reward_sla_mean_max": -0.0044444444444444444, "reward_consolidation_sum_mean": 308.8194444444445, "reward_consolidation_sum_min": 281.94444444444446, "reward_consolidation_sum_max": 333.3333333333334, "reward_illegal_sum_mean": -3.75, "reward_illegal_sum_min": -11.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 192.67933333333335, "reward_accuracy_sum_min": 183.76833333333335, "reward_accuracy_sum_max": 197.23499999999996, "reward_sla_sum_mean": -4.55, "reward_sla_sum_min": -17.333333333333332, "reward_sla_sum_max": -0.4444444444444444, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5755.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [469.78555555555533, 494.9749999999997, 503.3799999999997, 476.7055555555553, 482.3655555555553, 491.97777777777765, 467.75333333333316, 490.18277777777735, 471.85499999999985, 471.18999999999966, 478.4205555555549, 484.2216666666664, 495.29999999999984, 506.3466666666663, 484.46722222222184, 491.32166666666643, 490.72833333333307, 486.51333333333315, 504.87166666666644, 503.95777777777744, 497.41222222222194, 480.2688888888884, 472.69777777777756, 484.58666666666653, 470.80777777777763, 455.6505555555552, 479.6338888888886, 460.19666666666654, 485.56833333333327, 504.1477777777774, 466.99944444444446, 491.2922222222219, 506.57666666666626, 484.86388888888865, 496.1722222222218, 468.77722222222224, 477.7616666666666, 485.6188888888888, 468.41055555555533, 498.7366666666665, 508.8783333333333, 500.4649999999998, 491.6655555555552, 481.3949999999998, 488.9811111111107, 502.4177777777775, 501.7183333333329, 503.1716666666663, 488.09277777777754, 481.0222222222222, 491.9822222222221, 488.3549999999996, 488.41777777777764, 482.72944444444414, 494.1322222222223, 496.3788888888885, 479.5627777777776, 487.4033333333331, 504.2683333333331, 479.964444444444, 499.9727777777776, 490.32222222222214, 504.6394444444442, 501.2511111111109, 507.1094444444441, 473.9738888888887, 489.7649999999997, 489.8144444444442, 490.48222222222205, 469.51444444444434, 488.7983333333331, 502.38722222222196, 512.1088888888885, 503.04611111111075, 466.4349999999999, 509.1477777777778, 509.8633333333331, 515.3699999999995, 521.6488888888887, 504.321111111111, 514.0761111111109, 504.4661111111109, 499.076111111111, 505.17999999999984, 514.5927777777777, 485.37833333333305, 512.8461111111111, 505.3216666666666, 523.2044444444442, 509.77499999999986, 527.1799999999997, 502.2838888888888, 497.7272222222221, 512.4494444444442, 506.97888888888883, 496.59222222222206, 505.85388888888883, 493.2038888888886, 513.5455555555554, 516.6727777777777], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [469.78555555555533, 494.9749999999997, 503.3799999999997, 476.7055555555553, 482.3655555555553, 491.97777777777765, 467.75333333333316, 490.18277777777735, 471.85499999999985, 471.18999999999966, 478.4205555555549, 484.2216666666664, 495.29999999999984, 506.3466666666663, 484.46722222222184, 491.32166666666643, 490.72833333333307, 486.51333333333315, 504.87166666666644, 503.95777777777744, 497.41222222222194, 480.2688888888884, 472.69777777777756, 484.58666666666653, 470.80777777777763, 455.6505555555552, 479.6338888888886, 460.19666666666654, 485.56833333333327, 504.1477777777774, 466.99944444444446, 491.2922222222219, 506.57666666666626, 484.86388888888865, 496.1722222222218, 468.77722222222224, 477.7616666666666, 485.6188888888888, 468.41055555555533, 498.7366666666665, 508.8783333333333, 500.4649999999998, 491.6655555555552, 481.3949999999998, 488.9811111111107, 502.4177777777775, 501.7183333333329, 503.1716666666663, 488.09277777777754, 481.0222222222222, 491.9822222222221, 488.3549999999996, 488.41777777777764, 482.72944444444414, 494.1322222222223, 496.3788888888885, 479.5627777777776, 487.4033333333331, 504.2683333333331, 479.964444444444, 499.9727777777776, 490.32222222222214, 504.6394444444442, 501.2511111111109, 507.1094444444441, 473.9738888888887, 489.7649999999997, 489.8144444444442, 490.48222222222205, 469.51444444444434, 488.7983333333331, 502.38722222222196, 512.1088888888885, 503.04611111111075, 466.4349999999999, 509.1477777777778, 509.8633333333331, 515.3699999999995, 521.6488888888887, 504.321111111111, 514.0761111111109, 504.4661111111109, 499.076111111111, 505.17999999999984, 514.5927777777777, 485.37833333333305, 512.8461111111111, 505.3216666666666, 523.2044444444442, 509.77499999999986, 527.1799999999997, 502.2838888888888, 497.7272222222221, 512.4494444444442, 506.97888888888883, 496.59222222222206, 505.85388888888883, 493.2038888888886, 513.5455555555554, 516.6727777777777]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1978877466547857, "mean_inference_ms": 1.8016729627213897, "mean_action_processing_ms": 0.07507476562152175, "mean_env_wait_ms": 1.2226159004996155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004317760467529297, "StateBufferConnector_ms": 0.002894878387451172, "ViewRequirementAgentConnector_ms": 0.06640863418579102}, "num_episodes": 27, "episode_return_max": 527.1799999999997, "episode_return_min": 455.6505555555552, "episode_return_mean": 493.1987777777774, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 375450, "num_agent_steps_trained": 375300, "num_env_steps_sampled": 375450, "num_env_steps_trained": 375300, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 282.9171481744446, "num_env_steps_trained_throughput_per_sec": 297.8075243941522, "timesteps_total": 375450, "num_env_steps_sampled_lifetime": 375450, "num_agent_steps_sampled_lifetime": 375450, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 375450, "timers": {"training_iteration_time_ms": 10216.592, "restore_workers_time_ms": 0.013, "training_step_time_ms": 524.978, "sample_time_ms": 509.403, "synch_weights_time_ms": 14.127}, "counters": {"num_env_steps_sampled": 375450, "num_env_steps_trained": 375300, "num_agent_steps_sampled": 375450, "num_agent_steps_trained": 375300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2503, "num_samples_added_to_queue": 375300}, "done": false, "training_iteration": 126, "trial_id": "0313d_00000", "date": "2024-10-10_22-03-05", "timestamp": 1728594185, "time_this_iter_s": 10.08555793762207, "time_total_s": 1297.305115222931, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a7fa0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1297.305115222931, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 12.686666666666666, "ram_util_percent": 74.08666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 123267.765625, "policy_loss": 122853.171875, "entropy": 12.125669479370117, "entropy_coeff": 0.01, "var_gnorm": 16.6517333984375, "vf_loss": 450971.6875, "vf_explained_var": 0.10601413249969482}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1260.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 378300, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378300, "num_agent_steps_trained": 378000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2522, "num_samples_added_to_queue": 378300, "learner_queue": {"size_count": 1260, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.565, "learner_load_time_ms": 0.325, "learner_load_wait_time_ms": 1015.541, "learner_dequeue_time_ms": 8371.969}}, "env_runners": {"episode_reward_max": 536.8944444444443, "episode_reward_min": 466.4349999999999, "episode_reward_mean": 502.1659777777776, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 466.4349999999999}, "policy_reward_max": {"default_policy": 536.8944444444443}, "policy_reward_mean": {"default_policy": 502.1659777777776}, "custom_metrics": {"num_consolidated_mean": 2.3280999999999996, "num_consolidated_min": 2.1, "num_consolidated_max": 2.52, "num_overloaded_mean": 0.020100000000000003, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 3.9517, "num_moves_min": 3.18, "num_moves_max": 4.79, "mean_accuracy_mean": 39.45257333333332, "mean_accuracy_min": 39.30766666666664, "mean_accuracy_max": 39.66233333333333, "num_model_switches_mean": 1.9076999999999997, "num_model_switches_min": 1.4, "num_model_switches_max": 2.42, "num_slav_mean": 0.0012366666666666665, "num_slav_min": 5e-05, "num_slav_max": 0.0052, "mean_cluster_cpu_util_mean": 0.47633654462684105, "mean_cluster_cpu_util_min": 0.45656708906518084, "mean_cluster_cpu_util_max": 0.4933265821762468, "mean_cluster_mem_util_mean": 0.2975543943030799, "mean_cluster_mem_util_min": 0.28950045010620284, "mean_cluster_mem_util_max": 0.30523399153965386, "reward_consolidation_mean_mean": 3.1633333333333336, "reward_consolidation_mean_min": 2.8472222222222228, "reward_consolidation_mean_max": 3.458333333333334, "reward_illegal_mean_mean": -0.033499999999999995, "reward_illegal_mean_min": -0.11666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.932548666666667, "reward_accuracy_mean_min": 1.8376833333333336, "reward_accuracy_mean_max": 1.9751999999999998, "reward_sla_mean_mean": -0.04072222222222222, "reward_sla_mean_min": -0.1733333333333333, "reward_sla_mean_max": -0.0016666666666666668, "reward_consolidation_sum_mean": 316.33333333333337, "reward_consolidation_sum_min": 284.7222222222223, "reward_consolidation_sum_max": 345.83333333333337, "reward_illegal_sum_mean": -3.3499999999999996, "reward_illegal_sum_min": -11.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 193.25486666666663, "reward_accuracy_sum_min": 183.76833333333335, "reward_accuracy_sum_max": 197.51999999999998, "reward_sla_sum_mean": -4.072222222222222, "reward_sla_sum_min": -17.333333333333332, "reward_sla_sum_max": -0.16666666666666669, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4415.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [466.99944444444446, 491.2922222222219, 506.57666666666626, 484.86388888888865, 496.1722222222218, 468.77722222222224, 477.7616666666666, 485.6188888888888, 468.41055555555533, 498.7366666666665, 508.8783333333333, 500.4649999999998, 491.6655555555552, 481.3949999999998, 488.9811111111107, 502.4177777777775, 501.7183333333329, 503.1716666666663, 488.09277777777754, 481.0222222222222, 491.9822222222221, 488.3549999999996, 488.41777777777764, 482.72944444444414, 494.1322222222223, 496.3788888888885, 479.5627777777776, 487.4033333333331, 504.2683333333331, 479.964444444444, 499.9727777777776, 490.32222222222214, 504.6394444444442, 501.2511111111109, 507.1094444444441, 473.9738888888887, 489.7649999999997, 489.8144444444442, 490.48222222222205, 469.51444444444434, 488.7983333333331, 502.38722222222196, 512.1088888888885, 503.04611111111075, 466.4349999999999, 509.1477777777778, 509.8633333333331, 515.3699999999995, 521.6488888888887, 504.321111111111, 514.0761111111109, 504.4661111111109, 499.076111111111, 505.17999999999984, 514.5927777777777, 485.37833333333305, 512.8461111111111, 505.3216666666666, 523.2044444444442, 509.77499999999986, 527.1799999999997, 502.2838888888888, 497.7272222222221, 512.4494444444442, 506.97888888888883, 496.59222222222206, 505.85388888888883, 493.2038888888886, 513.5455555555554, 516.6727777777777, 536.1716666666666, 506.759444444444, 531.1483333333332, 530.2422222222223, 520.6633333333333, 492.6255555555553, 512.291111111111, 512.4344444444441, 495.0694444444442, 517.5466666666664, 493.7833333333331, 495.9905555555553, 536.8944444444443, 505.648333333333, 520.3399999999998, 520.0055555555556, 512.8716666666666, 515.6333333333332, 500.40999999999974, 510.783333333333, 525.9177777777776, 502.8144444444443, 518.2038888888889, 521.2116666666666, 511.8933333333331, 513.3077777777776, 504.5066666666665, 509.51277777777756, 533.9894444444444, 525.3394444444442], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [466.99944444444446, 491.2922222222219, 506.57666666666626, 484.86388888888865, 496.1722222222218, 468.77722222222224, 477.7616666666666, 485.6188888888888, 468.41055555555533, 498.7366666666665, 508.8783333333333, 500.4649999999998, 491.6655555555552, 481.3949999999998, 488.9811111111107, 502.4177777777775, 501.7183333333329, 503.1716666666663, 488.09277777777754, 481.0222222222222, 491.9822222222221, 488.3549999999996, 488.41777777777764, 482.72944444444414, 494.1322222222223, 496.3788888888885, 479.5627777777776, 487.4033333333331, 504.2683333333331, 479.964444444444, 499.9727777777776, 490.32222222222214, 504.6394444444442, 501.2511111111109, 507.1094444444441, 473.9738888888887, 489.7649999999997, 489.8144444444442, 490.48222222222205, 469.51444444444434, 488.7983333333331, 502.38722222222196, 512.1088888888885, 503.04611111111075, 466.4349999999999, 509.1477777777778, 509.8633333333331, 515.3699999999995, 521.6488888888887, 504.321111111111, 514.0761111111109, 504.4661111111109, 499.076111111111, 505.17999999999984, 514.5927777777777, 485.37833333333305, 512.8461111111111, 505.3216666666666, 523.2044444444442, 509.77499999999986, 527.1799999999997, 502.2838888888888, 497.7272222222221, 512.4494444444442, 506.97888888888883, 496.59222222222206, 505.85388888888883, 493.2038888888886, 513.5455555555554, 516.6727777777777, 536.1716666666666, 506.759444444444, 531.1483333333332, 530.2422222222223, 520.6633333333333, 492.6255555555553, 512.291111111111, 512.4344444444441, 495.0694444444442, 517.5466666666664, 493.7833333333331, 495.9905555555553, 536.8944444444443, 505.648333333333, 520.3399999999998, 520.0055555555556, 512.8716666666666, 515.6333333333332, 500.40999999999974, 510.783333333333, 525.9177777777776, 502.8144444444443, 518.2038888888889, 521.2116666666666, 511.8933333333331, 513.3077777777776, 504.5066666666665, 509.51277777777756, 533.9894444444444, 525.3394444444442]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19794692714009016, "mean_inference_ms": 1.8021298398520493, "mean_action_processing_ms": 0.07509308640888591, "mean_env_wait_ms": 1.2228587008624447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004328250885009766, "StateBufferConnector_ms": 0.0029001235961914062, "ViewRequirementAgentConnector_ms": 0.0665578842163086}, "num_episodes": 30, "episode_return_max": 536.8944444444443, "episode_return_min": 466.4349999999999, "episode_return_mean": 502.1659777777776, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 378300, "num_agent_steps_trained": 378000, "num_env_steps_sampled": 378300, "num_env_steps_trained": 378000, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 281.0565808471974, "num_env_steps_trained_throughput_per_sec": 266.26412922366063, "timesteps_total": 378300, "num_env_steps_sampled_lifetime": 378300, "num_agent_steps_sampled_lifetime": 378300, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 378300, "timers": {"training_iteration_time_ms": 10228.234, "restore_workers_time_ms": 0.012, "training_step_time_ms": 536.263, "sample_time_ms": 521.635, "synch_weights_time_ms": 13.262}, "counters": {"num_env_steps_sampled": 378300, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378300, "num_agent_steps_trained": 378000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2522, "num_samples_added_to_queue": 378300}, "done": false, "training_iteration": 127, "trial_id": "0313d_00000", "date": "2024-10-10_22-03-16", "timestamp": 1728594196, "time_this_iter_s": 10.149752616882324, "time_total_s": 1307.4548678398132, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c2a140>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1307.4548678398132, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 12.664285714285716, "ram_util_percent": 73.99285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 131146.390625, "policy_loss": 130681.953125, "entropy": 12.035391807556152, "entropy_coeff": 0.01, "var_gnorm": 16.65085792541504, "vf_loss": 500548.15625, "vf_explained_var": 0.10677647590637207}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1270.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 381150, "num_env_steps_trained": 381000, "num_agent_steps_sampled": 381150, "num_agent_steps_trained": 381000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2541, "num_samples_added_to_queue": 381000, "learner_queue": {"size_count": 1270, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.324, "learner_load_time_ms": 0.345, "learner_load_wait_time_ms": 1021.302, "learner_dequeue_time_ms": 8368.796}}, "env_runners": {"episode_reward_max": 546.561111111111, "episode_reward_min": 466.4349999999999, "episode_reward_mean": 510.66308888888875, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 466.4349999999999}, "policy_reward_max": {"default_policy": 546.561111111111}, "policy_reward_mean": {"default_policy": 510.66308888888875}, "custom_metrics": {"num_consolidated_mean": 2.3745000000000003, "num_consolidated_min": 2.18, "num_consolidated_max": 2.55, "num_overloaded_mean": 0.0177, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 3.805799999999999, "num_moves_min": 3.11, "num_moves_max": 4.79, "mean_accuracy_mean": 39.44693666666665, "mean_accuracy_min": 39.28866666666665, "mean_accuracy_max": 39.66233333333333, "num_model_switches_mean": 1.7931000000000004, "num_model_switches_min": 1.4, "num_model_switches_max": 2.42, "num_slav_mean": 0.0011001666666666664, "num_slav_min": 5e-05, "num_slav_max": 0.0052, "mean_cluster_cpu_util_mean": 0.4804228363926704, "mean_cluster_cpu_util_min": 0.46761362970741444, "mean_cluster_cpu_util_max": 0.49610012753018173, "mean_cluster_mem_util_mean": 0.2993760495744711, "mean_cluster_mem_util_min": 0.29289235877895464, "mean_cluster_mem_util_max": 0.3071402860300238, "reward_consolidation_mean_mean": 3.2350000000000008, "reward_consolidation_mean_min": 2.930555555555556, "reward_consolidation_mean_max": 3.5000000000000013, "reward_illegal_mean_mean": -0.02949999999999999, "reward_illegal_mean_min": -0.11666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9370753333333333, "reward_accuracy_mean_min": 1.8376833333333336, "reward_accuracy_mean_max": 1.9751999999999998, "reward_sla_mean_mean": -0.035944444444444446, "reward_sla_mean_min": -0.1733333333333333, "reward_sla_mean_max": -0.0016666666666666668, "reward_consolidation_sum_mean": 323.50000000000006, "reward_consolidation_sum_min": 293.0555555555556, "reward_consolidation_sum_max": 350.0000000000001, "reward_illegal_sum_mean": -2.95, "reward_illegal_sum_min": -11.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 193.70753333333334, "reward_accuracy_sum_min": 183.76833333333335, "reward_accuracy_sum_max": 197.51999999999998, "reward_sla_sum_mean": -3.5944444444444446, "reward_sla_sum_min": -17.333333333333332, "reward_sla_sum_max": -0.16666666666666669, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3210.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [487.4033333333331, 504.2683333333331, 479.964444444444, 499.9727777777776, 490.32222222222214, 504.6394444444442, 501.2511111111109, 507.1094444444441, 473.9738888888887, 489.7649999999997, 489.8144444444442, 490.48222222222205, 469.51444444444434, 488.7983333333331, 502.38722222222196, 512.1088888888885, 503.04611111111075, 466.4349999999999, 509.1477777777778, 509.8633333333331, 515.3699999999995, 521.6488888888887, 504.321111111111, 514.0761111111109, 504.4661111111109, 499.076111111111, 505.17999999999984, 514.5927777777777, 485.37833333333305, 512.8461111111111, 505.3216666666666, 523.2044444444442, 509.77499999999986, 527.1799999999997, 502.2838888888888, 497.7272222222221, 512.4494444444442, 506.97888888888883, 496.59222222222206, 505.85388888888883, 493.2038888888886, 513.5455555555554, 516.6727777777777, 536.1716666666666, 506.759444444444, 531.1483333333332, 530.2422222222223, 520.6633333333333, 492.6255555555553, 512.291111111111, 512.4344444444441, 495.0694444444442, 517.5466666666664, 493.7833333333331, 495.9905555555553, 536.8944444444443, 505.648333333333, 520.3399999999998, 520.0055555555556, 512.8716666666666, 515.6333333333332, 500.40999999999974, 510.783333333333, 525.9177777777776, 502.8144444444443, 518.2038888888889, 521.2116666666666, 511.8933333333331, 513.3077777777776, 504.5066666666665, 509.51277777777756, 533.9894444444444, 525.3394444444442, 512.8872222222221, 519.8233333333333, 489.491111111111, 541.6088888888887, 503.7199999999998, 527.0133333333331, 540.3466666666662, 512.9583333333331, 516.5366666666665, 529.7677777777776, 519.9888888888888, 521.8622222222219, 525.9805555555556, 497.2616666666666, 525.7122222222221, 523.3555555555556, 524.3722222222219, 519.4266666666666, 522.3461111111111, 508.35499999999996, 514.943333333333, 517.077222222222, 544.9344444444444, 546.561111111111, 535.5777777777773, 515.0299999999997, 507.34833333333296], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [487.4033333333331, 504.2683333333331, 479.964444444444, 499.9727777777776, 490.32222222222214, 504.6394444444442, 501.2511111111109, 507.1094444444441, 473.9738888888887, 489.7649999999997, 489.8144444444442, 490.48222222222205, 469.51444444444434, 488.7983333333331, 502.38722222222196, 512.1088888888885, 503.04611111111075, 466.4349999999999, 509.1477777777778, 509.8633333333331, 515.3699999999995, 521.6488888888887, 504.321111111111, 514.0761111111109, 504.4661111111109, 499.076111111111, 505.17999999999984, 514.5927777777777, 485.37833333333305, 512.8461111111111, 505.3216666666666, 523.2044444444442, 509.77499999999986, 527.1799999999997, 502.2838888888888, 497.7272222222221, 512.4494444444442, 506.97888888888883, 496.59222222222206, 505.85388888888883, 493.2038888888886, 513.5455555555554, 516.6727777777777, 536.1716666666666, 506.759444444444, 531.1483333333332, 530.2422222222223, 520.6633333333333, 492.6255555555553, 512.291111111111, 512.4344444444441, 495.0694444444442, 517.5466666666664, 493.7833333333331, 495.9905555555553, 536.8944444444443, 505.648333333333, 520.3399999999998, 520.0055555555556, 512.8716666666666, 515.6333333333332, 500.40999999999974, 510.783333333333, 525.9177777777776, 502.8144444444443, 518.2038888888889, 521.2116666666666, 511.8933333333331, 513.3077777777776, 504.5066666666665, 509.51277777777756, 533.9894444444444, 525.3394444444442, 512.8872222222221, 519.8233333333333, 489.491111111111, 541.6088888888887, 503.7199999999998, 527.0133333333331, 540.3466666666662, 512.9583333333331, 516.5366666666665, 529.7677777777776, 519.9888888888888, 521.8622222222219, 525.9805555555556, 497.2616666666666, 525.7122222222221, 523.3555555555556, 524.3722222222219, 519.4266666666666, 522.3461111111111, 508.35499999999996, 514.943333333333, 517.077222222222, 544.9344444444444, 546.561111111111, 535.5777777777773, 515.0299999999997, 507.34833333333296]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19795955996744147, "mean_inference_ms": 1.8012637713763007, "mean_action_processing_ms": 0.07509759561651708, "mean_env_wait_ms": 1.2228894563526906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044786930084228516, "StateBufferConnector_ms": 0.002973794937133789, "ViewRequirementAgentConnector_ms": 0.06879043579101562}, "num_episodes": 27, "episode_return_max": 546.561111111111, "episode_return_min": 466.4349999999999, "episode_return_mean": 510.66308888888875, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 381150, "num_agent_steps_trained": 381000, "num_env_steps_sampled": 381150, "num_env_steps_trained": 381000, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 279.06605779553723, "num_env_steps_trained_throughput_per_sec": 293.75374504793393, "timesteps_total": 381150, "num_env_steps_sampled_lifetime": 381150, "num_agent_steps_sampled_lifetime": 381150, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 381150, "timers": {"training_iteration_time_ms": 10222.787, "restore_workers_time_ms": 0.012, "training_step_time_ms": 560.651, "sample_time_ms": 545.486, "synch_weights_time_ms": 13.729}, "counters": {"num_env_steps_sampled": 381150, "num_env_steps_trained": 381000, "num_agent_steps_sampled": 381150, "num_agent_steps_trained": 381000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2541, "num_samples_added_to_queue": 381000}, "done": false, "training_iteration": 128, "trial_id": "0313d_00000", "date": "2024-10-10_22-03-26", "timestamp": 1728594206, "time_this_iter_s": 10.224598407745361, "time_total_s": 1317.6794662475586, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a6680>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1317.6794662475586, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 12.559999999999999, "ram_util_percent": 74.09333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 128574.109375, "policy_loss": 128161.6796875, "entropy": 12.039955139160156, "entropy_coeff": 0.01, "var_gnorm": 16.656145095825195, "vf_loss": 448545.84375, "vf_explained_var": 0.12479597330093384}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1279.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 383700, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 383700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2560, "num_samples_added_to_queue": 384000, "learner_queue": {"size_count": 1279, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.006, "learner_load_time_ms": 0.319, "learner_load_wait_time_ms": 1030.677, "learner_dequeue_time_ms": 8411.956}}, "env_runners": {"episode_reward_max": 546.561111111111, "episode_reward_min": 489.491111111111, "episode_reward_mean": 516.7901388888887, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 489.491111111111}, "policy_reward_max": {"default_policy": 546.561111111111}, "policy_reward_mean": {"default_policy": 516.7901388888887}, "custom_metrics": {"num_consolidated_mean": 2.4128, "num_consolidated_min": 2.26, "num_consolidated_max": 2.58, "num_overloaded_mean": 0.016700000000000003, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 3.7094, "num_moves_min": 3.11, "num_moves_max": 4.35, "mean_accuracy_mean": 39.425339999999984, "mean_accuracy_min": 39.28866666666665, "mean_accuracy_max": 39.66233333333333, "num_model_switches_mean": 1.7074, "num_model_switches_min": 1.38, "num_model_switches_max": 2.38, "num_slav_mean": 0.0009893333333333334, "num_slav_min": 5e-05, "num_slav_max": 0.0034999999999999996, "mean_cluster_cpu_util_mean": 0.4839733491066606, "mean_cluster_cpu_util_min": 0.4684154262935744, "mean_cluster_cpu_util_max": 0.5005953244033925, "mean_cluster_mem_util_mean": 0.30116275171323803, "mean_cluster_mem_util_min": 0.2939754698398347, "mean_cluster_mem_util_max": 0.3082830726699962, "reward_consolidation_mean_mean": 3.2902777777777787, "reward_consolidation_mean_min": 3.0555555555555554, "reward_consolidation_mean_max": 3.5000000000000013, "reward_illegal_mean_mean": -0.02783333333333333, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9380124999999995, "reward_accuracy_mean_min": 1.8692833333333332, "reward_accuracy_mean_max": 1.9751999999999998, "reward_sla_mean_mean": -0.03255555555555555, "reward_sla_mean_min": -0.11666666666666665, "reward_sla_mean_max": -0.0016666666666666668, "reward_consolidation_sum_mean": 329.0277777777779, "reward_consolidation_sum_min": 305.55555555555554, "reward_consolidation_sum_max": 350.0000000000001, "reward_illegal_sum_mean": -2.783333333333333, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 193.80125, "reward_accuracy_sum_min": 186.9283333333333, "reward_accuracy_sum_max": 197.51999999999998, "reward_sla_sum_mean": -3.2555555555555555, "reward_sla_sum_min": -11.666666666666666, "reward_sla_sum_max": -0.16666666666666669, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2109.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [505.3216666666666, 523.2044444444442, 509.77499999999986, 527.1799999999997, 502.2838888888888, 497.7272222222221, 512.4494444444442, 506.97888888888883, 496.59222222222206, 505.85388888888883, 493.2038888888886, 513.5455555555554, 516.6727777777777, 536.1716666666666, 506.759444444444, 531.1483333333332, 530.2422222222223, 520.6633333333333, 492.6255555555553, 512.291111111111, 512.4344444444441, 495.0694444444442, 517.5466666666664, 493.7833333333331, 495.9905555555553, 536.8944444444443, 505.648333333333, 520.3399999999998, 520.0055555555556, 512.8716666666666, 515.6333333333332, 500.40999999999974, 510.783333333333, 525.9177777777776, 502.8144444444443, 518.2038888888889, 521.2116666666666, 511.8933333333331, 513.3077777777776, 504.5066666666665, 509.51277777777756, 533.9894444444444, 525.3394444444442, 512.8872222222221, 519.8233333333333, 489.491111111111, 541.6088888888887, 503.7199999999998, 527.0133333333331, 540.3466666666662, 512.9583333333331, 516.5366666666665, 529.7677777777776, 519.9888888888888, 521.8622222222219, 525.9805555555556, 497.2616666666666, 525.7122222222221, 523.3555555555556, 524.3722222222219, 519.4266666666666, 522.3461111111111, 508.35499999999996, 514.943333333333, 517.077222222222, 544.9344444444444, 546.561111111111, 535.5777777777773, 515.0299999999997, 507.34833333333296, 507.77555555555523, 522.5466666666664, 516.4827777777775, 521.9344444444442, 531.2911111111113, 524.3955555555555, 528.483333333333, 533.3155555555554, 525.1577777777776, 510.7283333333327, 510.212222222222, 515.4327777777777, 515.9494444444442, 528.1955555555554, 523.6099999999999, 520.9572222222221, 508.911111111111, 505.29166666666646, 531.1338888888887, 522.3399999999999, 519.5844444444443, 523.5055555555554, 530.9511111111109, 510.48166666666634, 513.221111111111, 512.2844444444443, 511.0705555555553, 511.14, 529.2599999999999, 504.28444444444403], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [505.3216666666666, 523.2044444444442, 509.77499999999986, 527.1799999999997, 502.2838888888888, 497.7272222222221, 512.4494444444442, 506.97888888888883, 496.59222222222206, 505.85388888888883, 493.2038888888886, 513.5455555555554, 516.6727777777777, 536.1716666666666, 506.759444444444, 531.1483333333332, 530.2422222222223, 520.6633333333333, 492.6255555555553, 512.291111111111, 512.4344444444441, 495.0694444444442, 517.5466666666664, 493.7833333333331, 495.9905555555553, 536.8944444444443, 505.648333333333, 520.3399999999998, 520.0055555555556, 512.8716666666666, 515.6333333333332, 500.40999999999974, 510.783333333333, 525.9177777777776, 502.8144444444443, 518.2038888888889, 521.2116666666666, 511.8933333333331, 513.3077777777776, 504.5066666666665, 509.51277777777756, 533.9894444444444, 525.3394444444442, 512.8872222222221, 519.8233333333333, 489.491111111111, 541.6088888888887, 503.7199999999998, 527.0133333333331, 540.3466666666662, 512.9583333333331, 516.5366666666665, 529.7677777777776, 519.9888888888888, 521.8622222222219, 525.9805555555556, 497.2616666666666, 525.7122222222221, 523.3555555555556, 524.3722222222219, 519.4266666666666, 522.3461111111111, 508.35499999999996, 514.943333333333, 517.077222222222, 544.9344444444444, 546.561111111111, 535.5777777777773, 515.0299999999997, 507.34833333333296, 507.77555555555523, 522.5466666666664, 516.4827777777775, 521.9344444444442, 531.2911111111113, 524.3955555555555, 528.483333333333, 533.3155555555554, 525.1577777777776, 510.7283333333327, 510.212222222222, 515.4327777777777, 515.9494444444442, 528.1955555555554, 523.6099999999999, 520.9572222222221, 508.911111111111, 505.29166666666646, 531.1338888888887, 522.3399999999999, 519.5844444444443, 523.5055555555554, 530.9511111111109, 510.48166666666634, 513.221111111111, 512.2844444444443, 511.0705555555553, 511.14, 529.2599999999999, 504.28444444444403]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19804651273522061, "mean_inference_ms": 1.8033040669799212, "mean_action_processing_ms": 0.07513318530423886, "mean_env_wait_ms": 1.2234601893923864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004454135894775391, "StateBufferConnector_ms": 0.002958059310913086, "ViewRequirementAgentConnector_ms": 0.06817817687988281}, "num_episodes": 30, "episode_return_max": 546.561111111111, "episode_return_min": 489.491111111111, "episode_return_mean": 516.7901388888887, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 383700, "num_env_steps_sampled": 384000, "num_env_steps_trained": 383700, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 277.01493312081357, "num_env_steps_trained_throughput_per_sec": 262.4351997986655, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 10220.898, "restore_workers_time_ms": 0.012, "training_step_time_ms": 549.01, "sample_time_ms": 534.472, "synch_weights_time_ms": 13.244}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 383700, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 383700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2560, "num_samples_added_to_queue": 384000}, "done": false, "training_iteration": 129, "trial_id": "0313d_00000", "date": "2024-10-10_22-03-36", "timestamp": 1728594216, "time_this_iter_s": 10.29781723022461, "time_total_s": 1327.9772834777832, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a66e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1327.9772834777832, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 13.907142857142857, "ram_util_percent": 74.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 116031.40625, "policy_loss": 115639.46875, "entropy": 11.455896377563477, "entropy_coeff": 0.01, "var_gnorm": 16.66499900817871, "vf_loss": 426304.6875, "vf_explained_var": 0.13745468854904175}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1289.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 387000, "num_env_steps_trained": 386700, "num_agent_steps_sampled": 387000, "num_agent_steps_trained": 386700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2580, "num_samples_added_to_queue": 387000, "learner_queue": {"size_count": 1289, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.117, "learner_load_time_ms": 0.25, "learner_load_wait_time_ms": 978.056, "learner_dequeue_time_ms": 8490.886}}, "env_runners": {"episode_reward_max": 560.9977777777776, "episode_reward_min": 489.491111111111, "episode_reward_mean": 523.5884555555552, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 489.491111111111}, "policy_reward_max": {"default_policy": 560.9977777777776}, "policy_reward_mean": {"default_policy": 523.5884555555552}, "custom_metrics": {"num_consolidated_mean": 2.456, "num_consolidated_min": 2.29, "num_consolidated_max": 2.68, "num_overloaded_mean": 0.0158, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 3.6009999999999995, "num_moves_min": 2.83, "num_moves_max": 4.17, "mean_accuracy_mean": 39.404186666666654, "mean_accuracy_min": 39.237999999999985, "mean_accuracy_max": 39.567333333333316, "num_model_switches_mean": 1.6229, "num_model_switches_min": 1.35, "num_model_switches_max": 2.0, "num_slav_mean": 0.0008751666666666666, "num_slav_min": 5e-05, "num_slav_max": 0.00345, "mean_cluster_cpu_util_mean": 0.4880614654883185, "mean_cluster_cpu_util_min": 0.46935060680062535, "mean_cluster_cpu_util_max": 0.5100177391062153, "mean_cluster_mem_util_mean": 0.30296521769783863, "mean_cluster_mem_util_min": 0.29446595787049, "mean_cluster_mem_util_max": 0.31226520332816676, "reward_consolidation_mean_mean": 3.3519444444444453, "reward_consolidation_mean_min": 3.1111111111111116, "reward_consolidation_mean_max": 3.652777777777778, "reward_illegal_mean_mean": -0.02633333333333333, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9387789999999994, "reward_accuracy_mean_min": 1.8692833333333332, "reward_accuracy_mean_max": 1.9745666666666666, "reward_sla_mean_mean": -0.02850555555555556, "reward_sla_mean_min": -0.115, "reward_sla_mean_max": -0.0016666666666666668, "reward_consolidation_sum_mean": 335.1944444444445, "reward_consolidation_sum_min": 311.11111111111114, "reward_consolidation_sum_max": 365.2777777777778, "reward_illegal_sum_mean": -2.6333333333333337, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 193.87789999999998, "reward_accuracy_sum_min": 186.9283333333333, "reward_accuracy_sum_max": 197.45666666666665, "reward_sla_sum_mean": -2.850555555555555, "reward_sla_sum_min": -11.5, "reward_sla_sum_max": -0.16666666666666669, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2557.0, "global_timestep_min": 400, "global_timestep_max": 4200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [515.6333333333332, 500.40999999999974, 510.783333333333, 525.9177777777776, 502.8144444444443, 518.2038888888889, 521.2116666666666, 511.8933333333331, 513.3077777777776, 504.5066666666665, 509.51277777777756, 533.9894444444444, 525.3394444444442, 512.8872222222221, 519.8233333333333, 489.491111111111, 541.6088888888887, 503.7199999999998, 527.0133333333331, 540.3466666666662, 512.9583333333331, 516.5366666666665, 529.7677777777776, 519.9888888888888, 521.8622222222219, 525.9805555555556, 497.2616666666666, 525.7122222222221, 523.3555555555556, 524.3722222222219, 519.4266666666666, 522.3461111111111, 508.35499999999996, 514.943333333333, 517.077222222222, 544.9344444444444, 546.561111111111, 535.5777777777773, 515.0299999999997, 507.34833333333296, 507.77555555555523, 522.5466666666664, 516.4827777777775, 521.9344444444442, 531.2911111111113, 524.3955555555555, 528.483333333333, 533.3155555555554, 525.1577777777776, 510.7283333333327, 510.212222222222, 515.4327777777777, 515.9494444444442, 528.1955555555554, 523.6099999999999, 520.9572222222221, 508.911111111111, 505.29166666666646, 531.1338888888887, 522.3399999999999, 519.5844444444443, 523.5055555555554, 530.9511111111109, 510.48166666666634, 513.221111111111, 512.2844444444443, 511.0705555555553, 511.14, 529.2599999999999, 504.28444444444403, 550.2677777777775, 531.5849999999997, 525.8238888888886, 527.0138888888888, 531.8566666666667, 526.522222222222, 511.1105555555554, 541.4905555555556, 551.9499999999999, 542.6411111111111, 531.102222222222, 530.3227777777777, 540.3866666666664, 541.7683333333331, 547.3161111111108, 507.387222222222, 531.6016666666667, 548.9338888888886, 512.1899999999997, 531.8233333333329, 537.1788888888888, 516.7216666666667, 538.6183333333331, 516.426111111111, 534.102222222222, 528.0299999999997, 539.4183333333331, 539.6411111111108, 560.9977777777776, 556.878333333333], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [515.6333333333332, 500.40999999999974, 510.783333333333, 525.9177777777776, 502.8144444444443, 518.2038888888889, 521.2116666666666, 511.8933333333331, 513.3077777777776, 504.5066666666665, 509.51277777777756, 533.9894444444444, 525.3394444444442, 512.8872222222221, 519.8233333333333, 489.491111111111, 541.6088888888887, 503.7199999999998, 527.0133333333331, 540.3466666666662, 512.9583333333331, 516.5366666666665, 529.7677777777776, 519.9888888888888, 521.8622222222219, 525.9805555555556, 497.2616666666666, 525.7122222222221, 523.3555555555556, 524.3722222222219, 519.4266666666666, 522.3461111111111, 508.35499999999996, 514.943333333333, 517.077222222222, 544.9344444444444, 546.561111111111, 535.5777777777773, 515.0299999999997, 507.34833333333296, 507.77555555555523, 522.5466666666664, 516.4827777777775, 521.9344444444442, 531.2911111111113, 524.3955555555555, 528.483333333333, 533.3155555555554, 525.1577777777776, 510.7283333333327, 510.212222222222, 515.4327777777777, 515.9494444444442, 528.1955555555554, 523.6099999999999, 520.9572222222221, 508.911111111111, 505.29166666666646, 531.1338888888887, 522.3399999999999, 519.5844444444443, 523.5055555555554, 530.9511111111109, 510.48166666666634, 513.221111111111, 512.2844444444443, 511.0705555555553, 511.14, 529.2599999999999, 504.28444444444403, 550.2677777777775, 531.5849999999997, 525.8238888888886, 527.0138888888888, 531.8566666666667, 526.522222222222, 511.1105555555554, 541.4905555555556, 551.9499999999999, 542.6411111111111, 531.102222222222, 530.3227777777777, 540.3866666666664, 541.7683333333331, 547.3161111111108, 507.387222222222, 531.6016666666667, 548.9338888888886, 512.1899999999997, 531.8233333333329, 537.1788888888888, 516.7216666666667, 538.6183333333331, 516.426111111111, 534.102222222222, 528.0299999999997, 539.4183333333331, 539.6411111111108, 560.9977777777776, 556.878333333333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19809301174530233, "mean_inference_ms": 1.803643641303832, "mean_action_processing_ms": 0.07514827649271977, "mean_env_wait_ms": 1.2236590362850088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004513740539550781, "StateBufferConnector_ms": 0.0029897689819335938, "ViewRequirementAgentConnector_ms": 0.0691061019897461}, "num_episodes": 30, "episode_return_max": 560.9977777777776, "episode_return_min": 489.491111111111, "episode_return_mean": 523.5884555555552, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 387000, "num_agent_steps_trained": 386700, "num_env_steps_sampled": 387000, "num_env_steps_trained": 386700, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 289.47763633311837, "num_env_steps_trained_throughput_per_sec": 289.47763633311837, "timesteps_total": 387000, "num_env_steps_sampled_lifetime": 387000, "num_agent_steps_sampled_lifetime": 387000, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 387000, "timers": {"training_iteration_time_ms": 10220.28, "restore_workers_time_ms": 0.012, "training_step_time_ms": 528.757, "sample_time_ms": 513.469, "synch_weights_time_ms": 13.838}, "counters": {"num_env_steps_sampled": 387000, "num_env_steps_trained": 386700, "num_agent_steps_sampled": 387000, "num_agent_steps_trained": 386700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2580, "num_samples_added_to_queue": 387000}, "done": false, "training_iteration": 130, "trial_id": "0313d_00000", "date": "2024-10-10_22-03-47", "timestamp": 1728594227, "time_this_iter_s": 10.374521493911743, "time_total_s": 1338.351804971695, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42fa13c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1338.351804971695, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 12.67333333333333, "ram_util_percent": 74.62666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 119128.6328125, "policy_loss": 118671.5234375, "entropy": 11.116581916809082, "entropy_coeff": 0.01, "var_gnorm": 16.67018699645996, "vf_loss": 490458.15625, "vf_explained_var": 0.1436448097229004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1299.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 389850, "num_env_steps_trained": 389700, "num_agent_steps_sampled": 389850, "num_agent_steps_trained": 389700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2599, "num_samples_added_to_queue": 389700, "learner_queue": {"size_count": 1299, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.763, "learner_load_time_ms": 0.241, "learner_load_wait_time_ms": 995.58, "learner_dequeue_time_ms": 8488.902}}, "env_runners": {"episode_reward_max": 561.6877777777778, "episode_reward_min": 504.28444444444403, "episode_reward_mean": 530.2343888888886, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 504.28444444444403}, "policy_reward_max": {"default_policy": 561.6877777777778}, "policy_reward_mean": {"default_policy": 530.2343888888886}, "custom_metrics": {"num_consolidated_mean": 2.4957000000000003, "num_consolidated_min": 2.33, "num_consolidated_max": 2.68, "num_overloaded_mean": 0.013800000000000002, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 3.488099999999999, "num_moves_min": 2.83, "num_moves_max": 4.06, "mean_accuracy_mean": 39.386389999999984, "mean_accuracy_min": 39.237999999999985, "mean_accuracy_max": 39.567333333333316, "num_model_switches_mean": 1.5949999999999998, "num_model_switches_min": 1.24, "num_model_switches_max": 2.0, "num_slav_mean": 0.0009071666666666666, "num_slav_min": 5e-05, "num_slav_max": 0.00345, "mean_cluster_cpu_util_mean": 0.4917632716966828, "mean_cluster_cpu_util_min": 0.47047975634974615, "mean_cluster_cpu_util_max": 0.5100177391062153, "mean_cluster_mem_util_mean": 0.30450720014387617, "mean_cluster_mem_util_min": 0.2961517216696805, "mean_cluster_mem_util_max": 0.31226520332816676, "reward_consolidation_mean_mean": 3.4133333333333336, "reward_consolidation_mean_min": 3.1805555555555567, "reward_consolidation_mean_max": 3.6805555555555554, "reward_illegal_mean_mean": -0.023, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.941888333333333, "reward_accuracy_mean_min": 1.879733333333333, "reward_accuracy_mean_max": 1.9745666666666666, "reward_sla_mean_mean": -0.02987777777777778, "reward_sla_mean_min": -0.115, "reward_sla_mean_max": -0.0016666666666666668, "reward_consolidation_sum_mean": 341.33333333333337, "reward_consolidation_sum_min": 318.05555555555566, "reward_consolidation_sum_max": 368.05555555555554, "reward_illegal_sum_mean": -2.3, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 194.18883333333332, "reward_accuracy_sum_min": 187.9733333333333, "reward_accuracy_sum_max": 197.45666666666665, "reward_sla_sum_mean": -2.9877777777777776, "reward_sla_sum_min": -11.5, "reward_sla_sum_max": -0.16666666666666669, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3463.0, "global_timestep_min": 1400, "global_timestep_max": 5100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [525.7122222222221, 523.3555555555556, 524.3722222222219, 519.4266666666666, 522.3461111111111, 508.35499999999996, 514.943333333333, 517.077222222222, 544.9344444444444, 546.561111111111, 535.5777777777773, 515.0299999999997, 507.34833333333296, 507.77555555555523, 522.5466666666664, 516.4827777777775, 521.9344444444442, 531.2911111111113, 524.3955555555555, 528.483333333333, 533.3155555555554, 525.1577777777776, 510.7283333333327, 510.212222222222, 515.4327777777777, 515.9494444444442, 528.1955555555554, 523.6099999999999, 520.9572222222221, 508.911111111111, 505.29166666666646, 531.1338888888887, 522.3399999999999, 519.5844444444443, 523.5055555555554, 530.9511111111109, 510.48166666666634, 513.221111111111, 512.2844444444443, 511.0705555555553, 511.14, 529.2599999999999, 504.28444444444403, 550.2677777777775, 531.5849999999997, 525.8238888888886, 527.0138888888888, 531.8566666666667, 526.522222222222, 511.1105555555554, 541.4905555555556, 551.9499999999999, 542.6411111111111, 531.102222222222, 530.3227777777777, 540.3866666666664, 541.7683333333331, 547.3161111111108, 507.387222222222, 531.6016666666667, 548.9338888888886, 512.1899999999997, 531.8233333333329, 537.1788888888888, 516.7216666666667, 538.6183333333331, 516.426111111111, 534.102222222222, 528.0299999999997, 539.4183333333331, 539.6411111111108, 560.9977777777776, 556.878333333333, 539.3955555555556, 521.1733333333331, 535.808333333333, 549.9894444444442, 536.8794444444442, 542.8077777777777, 540.9349999999998, 561.6877777777778, 545.8316666666664, 539.5216666666666, 533.3322222222222, 546.4416666666665, 527.118333333333, 560.4499999999997, 547.6255555555556, 536.2994444444441, 555.9033333333333, 552.2361111111112, 530.6094444444441, 553.6338888888889, 524.5533333333335, 523.9361111111109, 524.7694444444442, 539.0533333333332, 547.1083333333331, 557.9566666666666, 542.3066666666664], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [525.7122222222221, 523.3555555555556, 524.3722222222219, 519.4266666666666, 522.3461111111111, 508.35499999999996, 514.943333333333, 517.077222222222, 544.9344444444444, 546.561111111111, 535.5777777777773, 515.0299999999997, 507.34833333333296, 507.77555555555523, 522.5466666666664, 516.4827777777775, 521.9344444444442, 531.2911111111113, 524.3955555555555, 528.483333333333, 533.3155555555554, 525.1577777777776, 510.7283333333327, 510.212222222222, 515.4327777777777, 515.9494444444442, 528.1955555555554, 523.6099999999999, 520.9572222222221, 508.911111111111, 505.29166666666646, 531.1338888888887, 522.3399999999999, 519.5844444444443, 523.5055555555554, 530.9511111111109, 510.48166666666634, 513.221111111111, 512.2844444444443, 511.0705555555553, 511.14, 529.2599999999999, 504.28444444444403, 550.2677777777775, 531.5849999999997, 525.8238888888886, 527.0138888888888, 531.8566666666667, 526.522222222222, 511.1105555555554, 541.4905555555556, 551.9499999999999, 542.6411111111111, 531.102222222222, 530.3227777777777, 540.3866666666664, 541.7683333333331, 547.3161111111108, 507.387222222222, 531.6016666666667, 548.9338888888886, 512.1899999999997, 531.8233333333329, 537.1788888888888, 516.7216666666667, 538.6183333333331, 516.426111111111, 534.102222222222, 528.0299999999997, 539.4183333333331, 539.6411111111108, 560.9977777777776, 556.878333333333, 539.3955555555556, 521.1733333333331, 535.808333333333, 549.9894444444442, 536.8794444444442, 542.8077777777777, 540.9349999999998, 561.6877777777778, 545.8316666666664, 539.5216666666666, 533.3322222222222, 546.4416666666665, 527.118333333333, 560.4499999999997, 547.6255555555556, 536.2994444444441, 555.9033333333333, 552.2361111111112, 530.6094444444441, 553.6338888888889, 524.5533333333335, 523.9361111111109, 524.7694444444442, 539.0533333333332, 547.1083333333331, 557.9566666666666, 542.3066666666664]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19815086152302477, "mean_inference_ms": 1.8039926118182266, "mean_action_processing_ms": 0.0751659677146686, "mean_env_wait_ms": 1.2239250670147164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004595279693603516, "StateBufferConnector_ms": 0.003012418746948242, "ViewRequirementAgentConnector_ms": 0.0699009895324707}, "num_episodes": 27, "episode_return_max": 561.6877777777778, "episode_return_min": 504.28444444444403, "episode_return_mean": 530.2343888888886, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 389850, "num_agent_steps_trained": 389700, "num_env_steps_sampled": 389850, "num_env_steps_trained": 389700, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 282.89624488719653, "num_env_steps_trained_throughput_per_sec": 297.78552093389106, "timesteps_total": 389850, "num_env_steps_sampled_lifetime": 389850, "num_agent_steps_sampled_lifetime": 389850, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 389850, "timers": {"training_iteration_time_ms": 10212.425, "restore_workers_time_ms": 0.011, "training_step_time_ms": 539.46, "sample_time_ms": 523.69, "synch_weights_time_ms": 14.28}, "counters": {"num_env_steps_sampled": 389850, "num_env_steps_trained": 389700, "num_agent_steps_sampled": 389850, "num_agent_steps_trained": 389700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2599, "num_samples_added_to_queue": 389700}, "done": false, "training_iteration": 131, "trial_id": "0313d_00000", "date": "2024-10-10_22-03-57", "timestamp": 1728594237, "time_this_iter_s": 10.098233461380005, "time_total_s": 1348.450038433075, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a6aa0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1348.450038433075, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 13.106666666666666, "ram_util_percent": 74.76}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 106711.3671875, "policy_loss": 106252.453125, "entropy": 10.907632827758789, "entropy_coeff": 0.01, "var_gnorm": 16.67308235168457, "vf_loss": 491638.59375, "vf_explained_var": 0.14792263507843018}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1308.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 392700, "num_env_steps_trained": 392400, "num_agent_steps_sampled": 392700, "num_agent_steps_trained": 392400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2618, "num_samples_added_to_queue": 392700, "learner_queue": {"size_count": 1308, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.88, "learner_load_time_ms": 0.233, "learner_load_wait_time_ms": 1033.557, "learner_dequeue_time_ms": 8543.878}}, "env_runners": {"episode_reward_max": 571.4644444444444, "episode_reward_min": 504.28444444444403, "episode_reward_mean": 537.2151388888888, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 504.28444444444403}, "policy_reward_max": {"default_policy": 571.4644444444444}, "policy_reward_mean": {"default_policy": 537.2151388888888}, "custom_metrics": {"num_consolidated_mean": 2.5431, "num_consolidated_min": 2.34, "num_consolidated_max": 2.7, "num_overloaded_mean": 0.0131, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 3.3109999999999995, "num_moves_min": 2.55, "num_moves_max": 4.0, "mean_accuracy_mean": 39.39487666666665, "mean_accuracy_min": 39.237999999999985, "mean_accuracy_max": 39.567333333333316, "num_model_switches_mean": 1.5565, "num_model_switches_min": 1.19, "num_model_switches_max": 2.0, "num_slav_mean": 0.0009678333333333331, "num_slav_min": 0.00011666666666666667, "num_slav_max": 0.00345, "mean_cluster_cpu_util_mean": 0.4960140604570581, "mean_cluster_cpu_util_min": 0.47079013526254926, "mean_cluster_cpu_util_max": 0.5164155779133527, "mean_cluster_mem_util_mean": 0.30594956042079274, "mean_cluster_mem_util_min": 0.2968370027124774, "mean_cluster_mem_util_max": 0.3125081578834065, "reward_consolidation_mean_mean": 3.481944444444445, "reward_consolidation_mean_min": 3.1805555555555567, "reward_consolidation_mean_max": 3.75, "reward_illegal_mean_mean": -0.02183333333333333, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9436625, "reward_accuracy_mean_min": 1.8692833333333332, "reward_accuracy_mean_max": 1.9751999999999998, "reward_sla_mean_mean": -0.03162222222222222, "reward_sla_mean_min": -0.115, "reward_sla_mean_max": -0.0038888888888888888, "reward_consolidation_sum_mean": 348.19444444444446, "reward_consolidation_sum_min": 318.05555555555566, "reward_consolidation_sum_max": 375.0, "reward_illegal_sum_mean": -2.183333333333333, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 194.36625000000004, "reward_accuracy_sum_min": 186.9283333333333, "reward_accuracy_sum_max": 197.51999999999998, "reward_sla_sum_mean": -3.162222222222222, "reward_sla_sum_min": -11.5, "reward_sla_sum_max": -0.3888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4457.0, "global_timestep_min": 2300, "global_timestep_max": 6100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [505.29166666666646, 531.1338888888887, 522.3399999999999, 519.5844444444443, 523.5055555555554, 530.9511111111109, 510.48166666666634, 513.221111111111, 512.2844444444443, 511.0705555555553, 511.14, 529.2599999999999, 504.28444444444403, 550.2677777777775, 531.5849999999997, 525.8238888888886, 527.0138888888888, 531.8566666666667, 526.522222222222, 511.1105555555554, 541.4905555555556, 551.9499999999999, 542.6411111111111, 531.102222222222, 530.3227777777777, 540.3866666666664, 541.7683333333331, 547.3161111111108, 507.387222222222, 531.6016666666667, 548.9338888888886, 512.1899999999997, 531.8233333333329, 537.1788888888888, 516.7216666666667, 538.6183333333331, 516.426111111111, 534.102222222222, 528.0299999999997, 539.4183333333331, 539.6411111111108, 560.9977777777776, 556.878333333333, 539.3955555555556, 521.1733333333331, 535.808333333333, 549.9894444444442, 536.8794444444442, 542.8077777777777, 540.9349999999998, 561.6877777777778, 545.8316666666664, 539.5216666666666, 533.3322222222222, 546.4416666666665, 527.118333333333, 560.4499999999997, 547.6255555555556, 536.2994444444441, 555.9033333333333, 552.2361111111112, 530.6094444444441, 553.6338888888889, 524.5533333333335, 523.9361111111109, 524.7694444444442, 539.0533333333332, 547.1083333333331, 557.9566666666666, 542.3066666666664, 549.7199999999998, 544.8627777777775, 551.0138888888889, 549.6494444444445, 516.8638888888888, 517.0394444444443, 542.2277777777775, 541.0455555555556, 552.5055555555554, 550.5222222222224, 571.4644444444444, 537.267222222222, 560.76, 553.0761111111109, 547.798333333333, 528.7916666666666, 524.2272222222224, 553.2277777777778, 548.2672222222224, 554.9883333333335, 538.435, 541.1733333333333, 540.0849999999999, 541.737222222222, 532.7122222222222, 541.377777777778, 553.101111111111, 549.5994444444442, 561.2200000000001, 553.7344444444445], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [505.29166666666646, 531.1338888888887, 522.3399999999999, 519.5844444444443, 523.5055555555554, 530.9511111111109, 510.48166666666634, 513.221111111111, 512.2844444444443, 511.0705555555553, 511.14, 529.2599999999999, 504.28444444444403, 550.2677777777775, 531.5849999999997, 525.8238888888886, 527.0138888888888, 531.8566666666667, 526.522222222222, 511.1105555555554, 541.4905555555556, 551.9499999999999, 542.6411111111111, 531.102222222222, 530.3227777777777, 540.3866666666664, 541.7683333333331, 547.3161111111108, 507.387222222222, 531.6016666666667, 548.9338888888886, 512.1899999999997, 531.8233333333329, 537.1788888888888, 516.7216666666667, 538.6183333333331, 516.426111111111, 534.102222222222, 528.0299999999997, 539.4183333333331, 539.6411111111108, 560.9977777777776, 556.878333333333, 539.3955555555556, 521.1733333333331, 535.808333333333, 549.9894444444442, 536.8794444444442, 542.8077777777777, 540.9349999999998, 561.6877777777778, 545.8316666666664, 539.5216666666666, 533.3322222222222, 546.4416666666665, 527.118333333333, 560.4499999999997, 547.6255555555556, 536.2994444444441, 555.9033333333333, 552.2361111111112, 530.6094444444441, 553.6338888888889, 524.5533333333335, 523.9361111111109, 524.7694444444442, 539.0533333333332, 547.1083333333331, 557.9566666666666, 542.3066666666664, 549.7199999999998, 544.8627777777775, 551.0138888888889, 549.6494444444445, 516.8638888888888, 517.0394444444443, 542.2277777777775, 541.0455555555556, 552.5055555555554, 550.5222222222224, 571.4644444444444, 537.267222222222, 560.76, 553.0761111111109, 547.798333333333, 528.7916666666666, 524.2272222222224, 553.2277777777778, 548.2672222222224, 554.9883333333335, 538.435, 541.1733333333333, 540.0849999999999, 541.737222222222, 532.7122222222222, 541.377777777778, 553.101111111111, 549.5994444444442, 561.2200000000001, 553.7344444444445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1982163154744296, "mean_inference_ms": 1.8042011337232469, "mean_action_processing_ms": 0.07517957759970123, "mean_env_wait_ms": 1.2241130849127306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004906892776489258, "StateBufferConnector_ms": 0.0029811859130859375, "ViewRequirementAgentConnector_ms": 0.0693204402923584}, "num_episodes": 30, "episode_return_max": 571.4644444444444, "episode_return_min": 504.28444444444403, "episode_return_mean": 537.2151388888888, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392700, "num_agent_steps_trained": 392400, "num_env_steps_sampled": 392700, "num_env_steps_trained": 392400, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 276.57536277568073, "num_env_steps_trained_throughput_per_sec": 262.01876473485544, "timesteps_total": 392700, "num_env_steps_sampled_lifetime": 392700, "num_agent_steps_sampled_lifetime": 392700, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 392700, "timers": {"training_iteration_time_ms": 10235.026, "restore_workers_time_ms": 0.012, "training_step_time_ms": 546.237, "sample_time_ms": 530.417, "synch_weights_time_ms": 14.403}, "counters": {"num_env_steps_sampled": 392700, "num_env_steps_trained": 392400, "num_agent_steps_sampled": 392700, "num_agent_steps_trained": 392400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2618, "num_samples_added_to_queue": 392700}, "done": false, "training_iteration": 132, "trial_id": "0313d_00000", "date": "2024-10-10_22-04-07", "timestamp": 1728594247, "time_this_iter_s": 10.316466093063354, "time_total_s": 1358.7665045261383, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a6560>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1358.7665045261383, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 14.464285714285714, "ram_util_percent": 75.20714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 110069.3828125, "policy_loss": 109606.90625, "entropy": 10.7129487991333, "entropy_coeff": 0.01, "var_gnorm": 16.677717208862305, "vf_loss": 494614.3125, "vf_explained_var": 0.15706896781921387}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1318.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 395700, "num_env_steps_trained": 395400, "num_agent_steps_sampled": 395700, "num_agent_steps_trained": 395400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2638, "num_samples_added_to_queue": 395700, "learner_queue": {"size_count": 1318, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.38, "learner_load_time_ms": 0.203, "learner_load_wait_time_ms": 957.648, "learner_dequeue_time_ms": 8573.644}}, "env_runners": {"episode_reward_max": 571.4644444444444, "episode_reward_min": 512.1899999999997, "episode_reward_mean": 543.0052277777777, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 512.1899999999997}, "policy_reward_max": {"default_policy": 571.4644444444444}, "policy_reward_mean": {"default_policy": 543.0052277777777}, "custom_metrics": {"num_consolidated_mean": 2.5701, "num_consolidated_min": 2.39, "num_consolidated_max": 2.74, "num_overloaded_mean": 0.0114, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 3.1447, "num_moves_min": 2.55, "num_moves_max": 3.69, "mean_accuracy_mean": 39.407923333333315, "mean_accuracy_min": 39.28233333333332, "mean_accuracy_max": 39.567333333333316, "num_model_switches_mean": 1.5406, "num_model_switches_min": 1.19, "num_model_switches_max": 1.81, "num_slav_mean": 0.0007659999999999999, "num_slav_min": 0.0001, "num_slav_max": 0.002766666666666667, "mean_cluster_cpu_util_mean": 0.4981545771485111, "mean_cluster_cpu_util_min": 0.48222428375722926, "mean_cluster_cpu_util_max": 0.5164155779133527, "mean_cluster_mem_util_mean": 0.30670107823308645, "mean_cluster_mem_util_min": 0.3005301224920348, "mean_cluster_mem_util_max": 0.3137969624558684, "reward_consolidation_mean_mean": 3.526527777777779, "reward_consolidation_mean_min": 3.2916666666666674, "reward_consolidation_mean_max": 3.777777777777779, "reward_illegal_mean_mean": -0.018999999999999996, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.947691166666666, "reward_accuracy_mean_min": 1.8692833333333332, "reward_accuracy_mean_max": 1.9751999999999998, "reward_sla_mean_mean": -0.02516666666666666, "reward_sla_mean_min": -0.09222222222222222, "reward_sla_mean_max": -0.0033333333333333335, "reward_consolidation_sum_mean": 352.6527777777777, "reward_consolidation_sum_min": 329.16666666666674, "reward_consolidation_sum_max": 377.7777777777779, "reward_illegal_sum_mean": -1.8999999999999997, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 194.76911666666666, "reward_accuracy_sum_min": 186.9283333333333, "reward_accuracy_sum_max": 197.51999999999998, "reward_sla_sum_mean": -2.5166666666666666, "reward_sla_sum_min": -9.222222222222221, "reward_sla_sum_max": -0.33333333333333337, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5457.0, "global_timestep_min": 3300, "global_timestep_max": 7100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [548.9338888888886, 512.1899999999997, 531.8233333333329, 537.1788888888888, 516.7216666666667, 538.6183333333331, 516.426111111111, 534.102222222222, 528.0299999999997, 539.4183333333331, 539.6411111111108, 560.9977777777776, 556.878333333333, 539.3955555555556, 521.1733333333331, 535.808333333333, 549.9894444444442, 536.8794444444442, 542.8077777777777, 540.9349999999998, 561.6877777777778, 545.8316666666664, 539.5216666666666, 533.3322222222222, 546.4416666666665, 527.118333333333, 560.4499999999997, 547.6255555555556, 536.2994444444441, 555.9033333333333, 552.2361111111112, 530.6094444444441, 553.6338888888889, 524.5533333333335, 523.9361111111109, 524.7694444444442, 539.0533333333332, 547.1083333333331, 557.9566666666666, 542.3066666666664, 549.7199999999998, 544.8627777777775, 551.0138888888889, 549.6494444444445, 516.8638888888888, 517.0394444444443, 542.2277777777775, 541.0455555555556, 552.5055555555554, 550.5222222222224, 571.4644444444444, 537.267222222222, 560.76, 553.0761111111109, 547.798333333333, 528.7916666666666, 524.2272222222224, 553.2277777777778, 548.2672222222224, 554.9883333333335, 538.435, 541.1733333333333, 540.0849999999999, 541.737222222222, 532.7122222222222, 541.377777777778, 553.101111111111, 549.5994444444442, 561.2200000000001, 553.7344444444445, 555.5766666666666, 535.0377777777775, 562.656111111111, 533.6105555555555, 566.2033333333335, 541.2433333333336, 570.6327777777776, 531.5366666666666, 548.1166666666664, 541.0927777777777, 547.7833333333331, 547.505, 563.5683333333335, 568.7672222222221, 545.4505555555555, 548.9972222222221, 538.465, 555.3705555555556, 525.8622222222219, 528.7822222222223, 559.2361111111111, 545.6794444444441, 547.9016666666666, 537.6177777777773, 525.4899999999998, 531.3316666666665, 544.497777777778, 532.1183333333333, 546.3933333333332, 547.1799999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [548.9338888888886, 512.1899999999997, 531.8233333333329, 537.1788888888888, 516.7216666666667, 538.6183333333331, 516.426111111111, 534.102222222222, 528.0299999999997, 539.4183333333331, 539.6411111111108, 560.9977777777776, 556.878333333333, 539.3955555555556, 521.1733333333331, 535.808333333333, 549.9894444444442, 536.8794444444442, 542.8077777777777, 540.9349999999998, 561.6877777777778, 545.8316666666664, 539.5216666666666, 533.3322222222222, 546.4416666666665, 527.118333333333, 560.4499999999997, 547.6255555555556, 536.2994444444441, 555.9033333333333, 552.2361111111112, 530.6094444444441, 553.6338888888889, 524.5533333333335, 523.9361111111109, 524.7694444444442, 539.0533333333332, 547.1083333333331, 557.9566666666666, 542.3066666666664, 549.7199999999998, 544.8627777777775, 551.0138888888889, 549.6494444444445, 516.8638888888888, 517.0394444444443, 542.2277777777775, 541.0455555555556, 552.5055555555554, 550.5222222222224, 571.4644444444444, 537.267222222222, 560.76, 553.0761111111109, 547.798333333333, 528.7916666666666, 524.2272222222224, 553.2277777777778, 548.2672222222224, 554.9883333333335, 538.435, 541.1733333333333, 540.0849999999999, 541.737222222222, 532.7122222222222, 541.377777777778, 553.101111111111, 549.5994444444442, 561.2200000000001, 553.7344444444445, 555.5766666666666, 535.0377777777775, 562.656111111111, 533.6105555555555, 566.2033333333335, 541.2433333333336, 570.6327777777776, 531.5366666666666, 548.1166666666664, 541.0927777777777, 547.7833333333331, 547.505, 563.5683333333335, 568.7672222222221, 545.4505555555555, 548.9972222222221, 538.465, 555.3705555555556, 525.8622222222219, 528.7822222222223, 559.2361111111111, 545.6794444444441, 547.9016666666666, 537.6177777777773, 525.4899999999998, 531.3316666666665, 544.497777777778, 532.1183333333333, 546.3933333333332, 547.1799999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19825626519149842, "mean_inference_ms": 1.8043115100096085, "mean_action_processing_ms": 0.07518572719353196, "mean_env_wait_ms": 1.2242389538264333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00490260124206543, "StateBufferConnector_ms": 0.002965211868286133, "ViewRequirementAgentConnector_ms": 0.06870460510253906}, "num_episodes": 30, "episode_return_max": 571.4644444444444, "episode_return_min": 512.1899999999997, "episode_return_mean": 543.0052277777777, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 395700, "num_agent_steps_trained": 395400, "num_env_steps_sampled": 395700, "num_env_steps_trained": 395400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 297.3700187573897, "num_env_steps_trained_throughput_per_sec": 297.3700187573897, "timesteps_total": 395700, "num_env_steps_sampled_lifetime": 395700, "num_agent_steps_sampled_lifetime": 395700, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 395700, "timers": {"training_iteration_time_ms": 10210.439, "restore_workers_time_ms": 0.011, "training_step_time_ms": 511.991, "sample_time_ms": 497.889, "synch_weights_time_ms": 12.765}, "counters": {"num_env_steps_sampled": 395700, "num_env_steps_trained": 395400, "num_agent_steps_sampled": 395700, "num_agent_steps_trained": 395400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2638, "num_samples_added_to_queue": 395700}, "done": false, "training_iteration": 133, "trial_id": "0313d_00000", "date": "2024-10-10_22-04-17", "timestamp": 1728594257, "time_this_iter_s": 10.099767684936523, "time_total_s": 1368.8662722110748, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d89960>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1368.8662722110748, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 12.566666666666665, "ram_util_percent": 75.39333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 105495.4609375, "policy_loss": 105039.21875, "entropy": 10.441637992858887, "entropy_coeff": 0.01, "var_gnorm": 16.67571449279785, "vf_loss": 487567.1875, "vf_explained_var": 0.16931557655334473}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1328.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 398550, "num_env_steps_trained": 398400, "num_agent_steps_sampled": 398550, "num_agent_steps_trained": 398400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2657, "num_samples_added_to_queue": 398400, "learner_queue": {"size_count": 1328, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.161, "learner_load_time_ms": 0.161, "learner_load_wait_time_ms": 1030.142, "learner_dequeue_time_ms": 8487.673}}, "env_runners": {"episode_reward_max": 571.4644444444444, "episode_reward_min": 516.8638888888888, "episode_reward_mean": 543.2154555555555, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 516.8638888888888}, "policy_reward_max": {"default_policy": 571.4644444444444}, "policy_reward_mean": {"default_policy": 543.2154555555555}, "custom_metrics": {"num_consolidated_mean": 2.5719, "num_consolidated_min": 2.41, "num_consolidated_max": 2.74, "num_overloaded_mean": 0.011500000000000002, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 3.0726, "num_moves_min": 2.55, "num_moves_max": 3.61, "mean_accuracy_mean": 39.42850666666666, "mean_accuracy_min": 39.28233333333332, "mean_accuracy_max": 39.567333333333316, "num_model_switches_mean": 1.5607999999999997, "num_model_switches_min": 1.19, "num_model_switches_max": 1.81, "num_slav_mean": 0.0007853333333333333, "num_slav_min": 0.0001, "num_slav_max": 0.002766666666666667, "mean_cluster_cpu_util_mean": 0.4980396285270182, "mean_cluster_cpu_util_min": 0.479068335722645, "mean_cluster_cpu_util_max": 0.5164155779133527, "mean_cluster_mem_util_mean": 0.3066596921876345, "mean_cluster_mem_util_min": 0.298514082278481, "mean_cluster_mem_util_max": 0.3137969624558684, "reward_consolidation_mean_mean": 3.528611111111112, "reward_consolidation_mean_min": 3.3472222222222228, "reward_consolidation_mean_max": 3.777777777777779, "reward_illegal_mean_mean": -0.019166666666666665, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9484990000000002, "reward_accuracy_mean_min": 1.8692833333333332, "reward_accuracy_mean_max": 1.975833333333333, "reward_sla_mean_mean": -0.02578888888888889, "reward_sla_mean_min": -0.09222222222222222, "reward_sla_mean_max": -0.0033333333333333335, "reward_consolidation_sum_mean": 352.86111111111126, "reward_consolidation_sum_min": 334.7222222222223, "reward_consolidation_sum_max": 377.7777777777779, "reward_illegal_sum_mean": -1.9166666666666663, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 194.84990000000002, "reward_accuracy_sum_min": 186.9283333333333, "reward_accuracy_sum_max": 197.58333333333331, "reward_sla_sum_mean": -2.5788888888888892, "reward_sla_sum_min": -9.222222222222221, "reward_sla_sum_max": -0.33333333333333337, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5895.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [547.6255555555556, 536.2994444444441, 555.9033333333333, 552.2361111111112, 530.6094444444441, 553.6338888888889, 524.5533333333335, 523.9361111111109, 524.7694444444442, 539.0533333333332, 547.1083333333331, 557.9566666666666, 542.3066666666664, 549.7199999999998, 544.8627777777775, 551.0138888888889, 549.6494444444445, 516.8638888888888, 517.0394444444443, 542.2277777777775, 541.0455555555556, 552.5055555555554, 550.5222222222224, 571.4644444444444, 537.267222222222, 560.76, 553.0761111111109, 547.798333333333, 528.7916666666666, 524.2272222222224, 553.2277777777778, 548.2672222222224, 554.9883333333335, 538.435, 541.1733333333333, 540.0849999999999, 541.737222222222, 532.7122222222222, 541.377777777778, 553.101111111111, 549.5994444444442, 561.2200000000001, 553.7344444444445, 555.5766666666666, 535.0377777777775, 562.656111111111, 533.6105555555555, 566.2033333333335, 541.2433333333336, 570.6327777777776, 531.5366666666666, 548.1166666666664, 541.0927777777777, 547.7833333333331, 547.505, 563.5683333333335, 568.7672222222221, 545.4505555555555, 548.9972222222221, 538.465, 555.3705555555556, 525.8622222222219, 528.7822222222223, 559.2361111111111, 545.6794444444441, 547.9016666666666, 537.6177777777773, 525.4899999999998, 531.3316666666665, 544.497777777778, 532.1183333333333, 546.3933333333332, 547.1799999999997, 523.0783333333333, 524.0611111111109, 553.3222222222221, 549.5283333333333, 531.4749999999999, 540.1883333333333, 530.7194444444442, 532.4655555555555, 531.7499999999999, 546.9566666666665, 537.7988888888885, 544.2355555555557, 543.5516666666665, 548.06, 544.7988888888888, 540.3777777777773, 548.6005555555555, 535.8155555555554, 540.83, 550.9805555555555, 537.1722222222222, 531.9416666666665, 530.5222222222221, 527.5922222222221, 537.2450000000001, 545.4733333333332, 554.8138888888885], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [547.6255555555556, 536.2994444444441, 555.9033333333333, 552.2361111111112, 530.6094444444441, 553.6338888888889, 524.5533333333335, 523.9361111111109, 524.7694444444442, 539.0533333333332, 547.1083333333331, 557.9566666666666, 542.3066666666664, 549.7199999999998, 544.8627777777775, 551.0138888888889, 549.6494444444445, 516.8638888888888, 517.0394444444443, 542.2277777777775, 541.0455555555556, 552.5055555555554, 550.5222222222224, 571.4644444444444, 537.267222222222, 560.76, 553.0761111111109, 547.798333333333, 528.7916666666666, 524.2272222222224, 553.2277777777778, 548.2672222222224, 554.9883333333335, 538.435, 541.1733333333333, 540.0849999999999, 541.737222222222, 532.7122222222222, 541.377777777778, 553.101111111111, 549.5994444444442, 561.2200000000001, 553.7344444444445, 555.5766666666666, 535.0377777777775, 562.656111111111, 533.6105555555555, 566.2033333333335, 541.2433333333336, 570.6327777777776, 531.5366666666666, 548.1166666666664, 541.0927777777777, 547.7833333333331, 547.505, 563.5683333333335, 568.7672222222221, 545.4505555555555, 548.9972222222221, 538.465, 555.3705555555556, 525.8622222222219, 528.7822222222223, 559.2361111111111, 545.6794444444441, 547.9016666666666, 537.6177777777773, 525.4899999999998, 531.3316666666665, 544.497777777778, 532.1183333333333, 546.3933333333332, 547.1799999999997, 523.0783333333333, 524.0611111111109, 553.3222222222221, 549.5283333333333, 531.4749999999999, 540.1883333333333, 530.7194444444442, 532.4655555555555, 531.7499999999999, 546.9566666666665, 537.7988888888885, 544.2355555555557, 543.5516666666665, 548.06, 544.7988888888888, 540.3777777777773, 548.6005555555555, 535.8155555555554, 540.83, 550.9805555555555, 537.1722222222222, 531.9416666666665, 530.5222222222221, 527.5922222222221, 537.2450000000001, 545.4733333333332, 554.8138888888885]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1983179045397822, "mean_inference_ms": 1.8046326957898822, "mean_action_processing_ms": 0.0752017258206335, "mean_env_wait_ms": 1.2244864230273478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005101203918457031, "StateBufferConnector_ms": 0.003034353256225586, "ViewRequirementAgentConnector_ms": 0.07032346725463867}, "num_episodes": 27, "episode_return_max": 571.4644444444444, "episode_return_min": 516.8638888888888, "episode_return_mean": 543.2154555555555, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 398550, "num_agent_steps_trained": 398400, "num_env_steps_sampled": 398550, "num_env_steps_trained": 398400, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 274.498887940884, "num_env_steps_trained_throughput_per_sec": 288.9461978325095, "timesteps_total": 398550, "num_env_steps_sampled_lifetime": 398550, "num_agent_steps_sampled_lifetime": 398550, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 398550, "timers": {"training_iteration_time_ms": 10226.615, "restore_workers_time_ms": 0.012, "training_step_time_ms": 555.521, "sample_time_ms": 540.081, "synch_weights_time_ms": 14.029}, "counters": {"num_env_steps_sampled": 398550, "num_env_steps_trained": 398400, "num_agent_steps_sampled": 398550, "num_agent_steps_trained": 398400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2657, "num_samples_added_to_queue": 398400}, "done": false, "training_iteration": 134, "trial_id": "0313d_00000", "date": "2024-10-10_22-04-28", "timestamp": 1728594268, "time_this_iter_s": 10.39165735244751, "time_total_s": 1379.2579295635223, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a61a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1379.2579295635223, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 14.873333333333331, "ram_util_percent": 75.36}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 100408.6875, "policy_loss": 99981.671875, "entropy": 10.518372535705566, "entropy_coeff": 0.01, "var_gnorm": 16.67557144165039, "vf_loss": 458568.34375, "vf_explained_var": 0.18339771032333374}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1337.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 401400, "num_env_steps_trained": 401100, "num_agent_steps_sampled": 401400, "num_agent_steps_trained": 401100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2676, "num_samples_added_to_queue": 401400, "learner_queue": {"size_count": 1337, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.306, "learner_load_time_ms": 0.215, "learner_load_wait_time_ms": 1006.339, "learner_dequeue_time_ms": 8535.678}}, "env_runners": {"episode_reward_max": 570.6327777777776, "episode_reward_min": 517.4888888888888, "episode_reward_mean": 542.8633444444444, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 517.4888888888888}, "policy_reward_max": {"default_policy": 570.6327777777776}, "policy_reward_mean": {"default_policy": 542.8633444444444}, "custom_metrics": {"num_consolidated_mean": 2.5632000000000006, "num_consolidated_min": 2.4, "num_consolidated_max": 2.74, "num_overloaded_mean": 0.0108, "num_overloaded_min": 0.0, "num_overloaded_max": 0.03, "num_moves_mean": 2.9999000000000002, "num_moves_min": 2.4, "num_moves_max": 3.56, "mean_accuracy_mean": 39.45592999999999, "mean_accuracy_min": 39.28233333333332, "mean_accuracy_max": 39.586333333333314, "num_model_switches_mean": 1.5751000000000002, "num_model_switches_min": 1.28, "num_model_switches_max": 1.84, "num_slav_mean": 0.0007036666666666666, "num_slav_min": 8.333333333333333e-05, "num_slav_max": 0.002766666666666667, "mean_cluster_cpu_util_mean": 0.4961743278430666, "mean_cluster_cpu_util_min": 0.4761314130185753, "mean_cluster_cpu_util_max": 0.5164155779133527, "mean_cluster_mem_util_mean": 0.30593865736853815, "mean_cluster_mem_util_min": 0.298514082278481, "mean_cluster_mem_util_max": 0.3137969624558684, "reward_consolidation_mean_mean": 3.518472222222223, "reward_consolidation_mean_min": 3.305555555555556, "reward_consolidation_mean_max": 3.777777777777779, "reward_illegal_mean_mean": -0.018, "reward_illegal_mean_min": -0.05, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9512389999999997, "reward_accuracy_mean_min": 1.90785, "reward_accuracy_mean_max": 1.9786833333333331, "reward_sla_mean_mean": -0.023077777777777784, "reward_sla_mean_min": -0.09222222222222222, "reward_sla_mean_max": -0.002777777777777778, "reward_consolidation_sum_mean": 351.84722222222234, "reward_consolidation_sum_min": 330.5555555555556, "reward_consolidation_sum_max": 377.7777777777779, "reward_illegal_sum_mean": -1.8, "reward_illegal_sum_min": -5.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 195.1239, "reward_accuracy_sum_min": 190.785, "reward_accuracy_sum_max": 197.8683333333333, "reward_sla_sum_mean": -2.307777777777778, "reward_sla_sum_min": -9.222222222222221, "reward_sla_sum_max": -0.2777777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4549.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [553.2277777777778, 548.2672222222224, 554.9883333333335, 538.435, 541.1733333333333, 540.0849999999999, 541.737222222222, 532.7122222222222, 541.377777777778, 553.101111111111, 549.5994444444442, 561.2200000000001, 553.7344444444445, 555.5766666666666, 535.0377777777775, 562.656111111111, 533.6105555555555, 566.2033333333335, 541.2433333333336, 570.6327777777776, 531.5366666666666, 548.1166666666664, 541.0927777777777, 547.7833333333331, 547.505, 563.5683333333335, 568.7672222222221, 545.4505555555555, 548.9972222222221, 538.465, 555.3705555555556, 525.8622222222219, 528.7822222222223, 559.2361111111111, 545.6794444444441, 547.9016666666666, 537.6177777777773, 525.4899999999998, 531.3316666666665, 544.497777777778, 532.1183333333333, 546.3933333333332, 547.1799999999997, 523.0783333333333, 524.0611111111109, 553.3222222222221, 549.5283333333333, 531.4749999999999, 540.1883333333333, 530.7194444444442, 532.4655555555555, 531.7499999999999, 546.9566666666665, 537.7988888888885, 544.2355555555557, 543.5516666666665, 548.06, 544.7988888888888, 540.3777777777773, 548.6005555555555, 535.8155555555554, 540.83, 550.9805555555555, 537.1722222222222, 531.9416666666665, 530.5222222222221, 527.5922222222221, 537.2450000000001, 545.4733333333332, 554.8138888888885, 539.9727777777775, 533.4499999999997, 548.7900000000001, 538.3861111111111, 546.4727777777775, 536.2116666666664, 559.4238888888889, 540.3949999999998, 555.6461111111112, 550.3866666666669, 559.2983333333334, 550.7038888888885, 527.0844444444443, 545.663888888889, 517.4888888888888, 538.8694444444443, 547.6788888888889, 523.7744444444445, 539.3872222222224, 548.6077777777775, 556.3377777777775, 528.7505555555558, 542.6011111111109, 531.7811111111112, 536.147222222222, 532.3616666666667, 547.1705555555554, 544.9088888888889, 542.1549999999999, 529.7099999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [553.2277777777778, 548.2672222222224, 554.9883333333335, 538.435, 541.1733333333333, 540.0849999999999, 541.737222222222, 532.7122222222222, 541.377777777778, 553.101111111111, 549.5994444444442, 561.2200000000001, 553.7344444444445, 555.5766666666666, 535.0377777777775, 562.656111111111, 533.6105555555555, 566.2033333333335, 541.2433333333336, 570.6327777777776, 531.5366666666666, 548.1166666666664, 541.0927777777777, 547.7833333333331, 547.505, 563.5683333333335, 568.7672222222221, 545.4505555555555, 548.9972222222221, 538.465, 555.3705555555556, 525.8622222222219, 528.7822222222223, 559.2361111111111, 545.6794444444441, 547.9016666666666, 537.6177777777773, 525.4899999999998, 531.3316666666665, 544.497777777778, 532.1183333333333, 546.3933333333332, 547.1799999999997, 523.0783333333333, 524.0611111111109, 553.3222222222221, 549.5283333333333, 531.4749999999999, 540.1883333333333, 530.7194444444442, 532.4655555555555, 531.7499999999999, 546.9566666666665, 537.7988888888885, 544.2355555555557, 543.5516666666665, 548.06, 544.7988888888888, 540.3777777777773, 548.6005555555555, 535.8155555555554, 540.83, 550.9805555555555, 537.1722222222222, 531.9416666666665, 530.5222222222221, 527.5922222222221, 537.2450000000001, 545.4733333333332, 554.8138888888885, 539.9727777777775, 533.4499999999997, 548.7900000000001, 538.3861111111111, 546.4727777777775, 536.2116666666664, 559.4238888888889, 540.3949999999998, 555.6461111111112, 550.3866666666669, 559.2983333333334, 550.7038888888885, 527.0844444444443, 545.663888888889, 517.4888888888888, 538.8694444444443, 547.6788888888889, 523.7744444444445, 539.3872222222224, 548.6077777777775, 556.3377777777775, 528.7505555555558, 542.6011111111109, 531.7811111111112, 536.147222222222, 532.3616666666667, 547.1705555555554, 544.9088888888889, 542.1549999999999, 529.7099999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19836950838816014, "mean_inference_ms": 1.8046563839570506, "mean_action_processing_ms": 0.07521235761798366, "mean_env_wait_ms": 1.2245821274435094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004851102828979492, "StateBufferConnector_ms": 0.0030193328857421875, "ViewRequirementAgentConnector_ms": 0.06994247436523438}, "num_episodes": 30, "episode_return_max": 570.6327777777776, "episode_return_min": 517.4888888888888, "episode_return_mean": 542.8633444444444, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 401400, "num_agent_steps_trained": 401100, "num_env_steps_sampled": 401400, "num_env_steps_trained": 401100, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 284.89781373239066, "num_env_steps_trained_throughput_per_sec": 269.90319195700164, "timesteps_total": 401400, "num_env_steps_sampled_lifetime": 401400, "num_agent_steps_sampled_lifetime": 401400, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 401400, "timers": {"training_iteration_time_ms": 10193.195, "restore_workers_time_ms": 0.013, "training_step_time_ms": 548.775, "sample_time_ms": 531.474, "synch_weights_time_ms": 15.776}, "counters": {"num_env_steps_sampled": 401400, "num_env_steps_trained": 401100, "num_agent_steps_sampled": 401400, "num_agent_steps_trained": 401100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2676, "num_samples_added_to_queue": 401400}, "done": false, "training_iteration": 135, "trial_id": "0313d_00000", "date": "2024-10-10_22-04-38", "timestamp": 1728594278, "time_this_iter_s": 10.013124227523804, "time_total_s": 1389.2710537910461, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a62c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1389.2710537910461, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 13.05, "ram_util_percent": 75.54999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 87025.828125, "policy_loss": 86626.625, "entropy": 10.195308685302734, "entropy_coeff": 0.01, "var_gnorm": 16.68532371520996, "vf_loss": 429789.78125, "vf_explained_var": 0.20021075010299683}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1347.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 404250, "num_env_steps_trained": 404100, "num_agent_steps_sampled": 404250, "num_agent_steps_trained": 404100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2695, "num_samples_added_to_queue": 404100, "learner_queue": {"size_count": 1347, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.05, "learner_load_time_ms": 0.19, "learner_load_wait_time_ms": 1014.982, "learner_dequeue_time_ms": 8548.482}}, "env_runners": {"episode_reward_max": 562.4799999999998, "episode_reward_min": 517.4888888888888, "episode_reward_mean": 542.5638722222221, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 517.4888888888888}, "policy_reward_max": {"default_policy": 562.4799999999998}, "policy_reward_mean": {"default_policy": 542.5638722222221}, "custom_metrics": {"num_consolidated_mean": 2.5585999999999998, "num_consolidated_min": 2.4, "num_consolidated_max": 2.68, "num_overloaded_mean": 0.0106, "num_overloaded_min": 0.0, "num_overloaded_max": 0.03, "num_moves_mean": 2.9388, "num_moves_min": 2.21, "num_moves_max": 3.56, "mean_accuracy_mean": 39.48322666666666, "mean_accuracy_min": 39.34566666666665, "mean_accuracy_max": 39.60533333333332, "num_model_switches_mean": 1.5684, "num_model_switches_min": 1.22, "num_model_switches_max": 1.84, "num_slav_mean": 0.0006763333333333333, "num_slav_min": 8.333333333333333e-05, "num_slav_max": 0.002583333333333333, "mean_cluster_cpu_util_mean": 0.4950672502948981, "mean_cluster_cpu_util_min": 0.4761314130185753, "mean_cluster_cpu_util_max": 0.5110122299565745, "mean_cluster_mem_util_mean": 0.30548962164169463, "mean_cluster_mem_util_min": 0.298514082278481, "mean_cluster_mem_util_max": 0.31160845980797386, "reward_consolidation_mean_mean": 3.512777777777779, "reward_consolidation_mean_min": 3.305555555555556, "reward_consolidation_mean_max": 3.680555555555556, "reward_illegal_mean_mean": -0.017666666666666667, "reward_illegal_mean_min": -0.05, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9529831666666666, "reward_accuracy_mean_min": 1.90785, "reward_accuracy_mean_max": 1.9799499999999997, "reward_sla_mean_mean": -0.02245555555555555, "reward_sla_mean_min": -0.08611111111111111, "reward_sla_mean_max": -0.002777777777777778, "reward_consolidation_sum_mean": 351.2777777777778, "reward_consolidation_sum_min": 330.5555555555556, "reward_consolidation_sum_max": 368.0555555555556, "reward_illegal_sum_mean": -1.7666666666666666, "reward_illegal_sum_min": -5.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 195.29831666666666, "reward_accuracy_sum_min": 190.785, "reward_accuracy_sum_max": 197.99499999999998, "reward_sla_sum_mean": -2.2455555555555553, "reward_sla_sum_min": -8.61111111111111, "reward_sla_sum_max": -0.2777777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3344.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [545.4505555555555, 548.9972222222221, 538.465, 555.3705555555556, 525.8622222222219, 528.7822222222223, 559.2361111111111, 545.6794444444441, 547.9016666666666, 537.6177777777773, 525.4899999999998, 531.3316666666665, 544.497777777778, 532.1183333333333, 546.3933333333332, 547.1799999999997, 523.0783333333333, 524.0611111111109, 553.3222222222221, 549.5283333333333, 531.4749999999999, 540.1883333333333, 530.7194444444442, 532.4655555555555, 531.7499999999999, 546.9566666666665, 537.7988888888885, 544.2355555555557, 543.5516666666665, 548.06, 544.7988888888888, 540.3777777777773, 548.6005555555555, 535.8155555555554, 540.83, 550.9805555555555, 537.1722222222222, 531.9416666666665, 530.5222222222221, 527.5922222222221, 537.2450000000001, 545.4733333333332, 554.8138888888885, 539.9727777777775, 533.4499999999997, 548.7900000000001, 538.3861111111111, 546.4727777777775, 536.2116666666664, 559.4238888888889, 540.3949999999998, 555.6461111111112, 550.3866666666669, 559.2983333333334, 550.7038888888885, 527.0844444444443, 545.663888888889, 517.4888888888888, 538.8694444444443, 547.6788888888889, 523.7744444444445, 539.3872222222224, 548.6077777777775, 556.3377777777775, 528.7505555555558, 542.6011111111109, 531.7811111111112, 536.147222222222, 532.3616666666667, 547.1705555555554, 544.9088888888889, 542.1549999999999, 529.7099999999997, 550.2266666666666, 562.0994444444444, 544.8288888888887, 540.6066666666667, 554.7183333333331, 555.0672222222221, 556.4949999999999, 557.7744444444444, 527.9255555555553, 536.9811111111111, 530.107222222222, 541.2827777777778, 560.6866666666667, 543.9094444444443, 558.2966666666666, 557.7572222222221, 562.4799999999998, 560.79, 532.4344444444444, 552.5833333333331, 534.5755555555555, 526.5283333333332, 548.9088888888891, 552.2027777777778, 553.7583333333334, 546.5683333333334, 543.4488888888887], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [545.4505555555555, 548.9972222222221, 538.465, 555.3705555555556, 525.8622222222219, 528.7822222222223, 559.2361111111111, 545.6794444444441, 547.9016666666666, 537.6177777777773, 525.4899999999998, 531.3316666666665, 544.497777777778, 532.1183333333333, 546.3933333333332, 547.1799999999997, 523.0783333333333, 524.0611111111109, 553.3222222222221, 549.5283333333333, 531.4749999999999, 540.1883333333333, 530.7194444444442, 532.4655555555555, 531.7499999999999, 546.9566666666665, 537.7988888888885, 544.2355555555557, 543.5516666666665, 548.06, 544.7988888888888, 540.3777777777773, 548.6005555555555, 535.8155555555554, 540.83, 550.9805555555555, 537.1722222222222, 531.9416666666665, 530.5222222222221, 527.5922222222221, 537.2450000000001, 545.4733333333332, 554.8138888888885, 539.9727777777775, 533.4499999999997, 548.7900000000001, 538.3861111111111, 546.4727777777775, 536.2116666666664, 559.4238888888889, 540.3949999999998, 555.6461111111112, 550.3866666666669, 559.2983333333334, 550.7038888888885, 527.0844444444443, 545.663888888889, 517.4888888888888, 538.8694444444443, 547.6788888888889, 523.7744444444445, 539.3872222222224, 548.6077777777775, 556.3377777777775, 528.7505555555558, 542.6011111111109, 531.7811111111112, 536.147222222222, 532.3616666666667, 547.1705555555554, 544.9088888888889, 542.1549999999999, 529.7099999999997, 550.2266666666666, 562.0994444444444, 544.8288888888887, 540.6066666666667, 554.7183333333331, 555.0672222222221, 556.4949999999999, 557.7744444444444, 527.9255555555553, 536.9811111111111, 530.107222222222, 541.2827777777778, 560.6866666666667, 543.9094444444443, 558.2966666666666, 557.7572222222221, 562.4799999999998, 560.79, 532.4344444444444, 552.5833333333331, 534.5755555555555, 526.5283333333332, 548.9088888888891, 552.2027777777778, 553.7583333333334, 546.5683333333334, 543.4488888888887]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19840074161630944, "mean_inference_ms": 1.8036243234761349, "mean_action_processing_ms": 0.07521804840750522, "mean_env_wait_ms": 1.2245660495963475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00473475456237793, "StateBufferConnector_ms": 0.0030438899993896484, "ViewRequirementAgentConnector_ms": 0.07074785232543945}, "num_episodes": 27, "episode_return_max": 562.4799999999998, "episode_return_min": 517.4888888888888, "episode_return_mean": 542.5638722222221, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 404250, "num_agent_steps_trained": 404100, "num_env_steps_sampled": 404250, "num_env_steps_trained": 404100, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 273.694953389095, "num_env_steps_trained_throughput_per_sec": 288.09995093588947, "timesteps_total": 404250, "num_env_steps_sampled_lifetime": 404250, "num_agent_steps_sampled_lifetime": 404250, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 404250, "timers": {"training_iteration_time_ms": 10227.138, "restore_workers_time_ms": 0.012, "training_step_time_ms": 560.963, "sample_time_ms": 546.99, "synch_weights_time_ms": 12.564}, "counters": {"num_env_steps_sampled": 404250, "num_env_steps_trained": 404100, "num_agent_steps_sampled": 404250, "num_agent_steps_trained": 404100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2695, "num_samples_added_to_queue": 404100}, "done": false, "training_iteration": 136, "trial_id": "0313d_00000", "date": "2024-10-10_22-04-48", "timestamp": 1728594288, "time_this_iter_s": 10.422901153564453, "time_total_s": 1399.6939549446106, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c1bbe0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1399.6939549446106, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 13.833333333333334, "ram_util_percent": 75.78}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 87105.09375, "policy_loss": 86707.625, "entropy": 9.925850868225098, "entropy_coeff": 0.01, "var_gnorm": 16.6967716217041, "vf_loss": 427251.5625, "vf_explained_var": 0.20515871047973633}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1357.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 407250, "num_env_steps_trained": 407100, "num_agent_steps_sampled": 407250, "num_agent_steps_trained": 407100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2715, "num_samples_added_to_queue": 407100, "learner_queue": {"size_count": 1357, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.574, "learner_load_time_ms": 0.219, "learner_load_wait_time_ms": 1004.074, "learner_dequeue_time_ms": 8557.385}}, "env_runners": {"episode_reward_max": 568.1861111111108, "episode_reward_min": 517.4888888888888, "episode_reward_mean": 545.7252555555555, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 517.4888888888888}, "policy_reward_max": {"default_policy": 568.1861111111108}, "policy_reward_mean": {"default_policy": 545.7252555555555}, "custom_metrics": {"num_consolidated_mean": 2.5760999999999994, "num_consolidated_min": 2.4, "num_consolidated_max": 2.68, "num_overloaded_mean": 0.01, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 2.827399999999999, "num_moves_min": 2.21, "num_moves_max": 3.5, "mean_accuracy_mean": 39.51033333333332, "mean_accuracy_min": 39.34566666666665, "mean_accuracy_max": 39.65599999999998, "num_model_switches_mean": 1.5377, "num_model_switches_min": 1.22, "num_model_switches_max": 1.85, "num_slav_mean": 0.0006263333333333332, "num_slav_min": 8.333333333333333e-05, "num_slav_max": 0.0020499999999999997, "mean_cluster_cpu_util_mean": 0.4964270477265459, "mean_cluster_cpu_util_min": 0.4761314130185753, "mean_cluster_cpu_util_max": 0.5093218664352732, "mean_cluster_mem_util_mean": 0.30606176806703694, "mean_cluster_mem_util_min": 0.298532925385344, "mean_cluster_mem_util_max": 0.3122129563850857, "reward_consolidation_mean_mean": 3.5391666666666675, "reward_consolidation_mean_min": 3.305555555555556, "reward_consolidation_mean_max": 3.708333333333334, "reward_illegal_mean_mean": -0.016666666666666666, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.955530333333333, "reward_accuracy_mean_min": 1.8920499999999998, "reward_accuracy_mean_max": 1.9799499999999997, "reward_sla_mean_mean": -0.020777777777777773, "reward_sla_mean_min": -0.06833333333333332, "reward_sla_mean_max": -0.002777777777777778, "reward_consolidation_sum_mean": 353.91666666666674, "reward_consolidation_sum_min": 330.5555555555556, "reward_consolidation_sum_max": 370.83333333333337, "reward_illegal_sum_mean": -1.6666666666666663, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 195.5530333333333, "reward_accuracy_sum_min": 189.20499999999998, "reward_accuracy_sum_max": 197.99499999999998, "reward_sla_sum_mean": -2.0777777777777775, "reward_sla_sum_min": -6.833333333333332, "reward_sla_sum_max": -0.2777777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2165.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [544.7988888888888, 540.3777777777773, 548.6005555555555, 535.8155555555554, 540.83, 550.9805555555555, 537.1722222222222, 531.9416666666665, 530.5222222222221, 527.5922222222221, 537.2450000000001, 545.4733333333332, 554.8138888888885, 539.9727777777775, 533.4499999999997, 548.7900000000001, 538.3861111111111, 546.4727777777775, 536.2116666666664, 559.4238888888889, 540.3949999999998, 555.6461111111112, 550.3866666666669, 559.2983333333334, 550.7038888888885, 527.0844444444443, 545.663888888889, 517.4888888888888, 538.8694444444443, 547.6788888888889, 523.7744444444445, 539.3872222222224, 548.6077777777775, 556.3377777777775, 528.7505555555558, 542.6011111111109, 531.7811111111112, 536.147222222222, 532.3616666666667, 547.1705555555554, 544.9088888888889, 542.1549999999999, 529.7099999999997, 550.2266666666666, 562.0994444444444, 544.8288888888887, 540.6066666666667, 554.7183333333331, 555.0672222222221, 556.4949999999999, 557.7744444444444, 527.9255555555553, 536.9811111111111, 530.107222222222, 541.2827777777778, 560.6866666666667, 543.9094444444443, 558.2966666666666, 557.7572222222221, 562.4799999999998, 560.79, 532.4344444444444, 552.5833333333331, 534.5755555555555, 526.5283333333332, 548.9088888888891, 552.2027777777778, 553.7583333333334, 546.5683333333334, 543.4488888888887, 530.2099999999998, 564.8294444444443, 548.2983333333331, 533.14, 539.995, 554.2100000000002, 566.9883333333335, 553.2100000000003, 551.5283333333332, 559.465, 548.9722222222223, 535.2194444444442, 545.3372222222222, 559.9477777777776, 548.4183333333332, 529.0938888888887, 545.4872222222222, 555.9244444444444, 568.1861111111108, 557.2422222222224, 545.5188888888889, 554.9716666666666, 550.8861111111111, 546.8766666666664, 539.448333333333, 560.79, 557.0366666666667, 549.7572222222221, 554.4327777777778, 558.2816666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [544.7988888888888, 540.3777777777773, 548.6005555555555, 535.8155555555554, 540.83, 550.9805555555555, 537.1722222222222, 531.9416666666665, 530.5222222222221, 527.5922222222221, 537.2450000000001, 545.4733333333332, 554.8138888888885, 539.9727777777775, 533.4499999999997, 548.7900000000001, 538.3861111111111, 546.4727777777775, 536.2116666666664, 559.4238888888889, 540.3949999999998, 555.6461111111112, 550.3866666666669, 559.2983333333334, 550.7038888888885, 527.0844444444443, 545.663888888889, 517.4888888888888, 538.8694444444443, 547.6788888888889, 523.7744444444445, 539.3872222222224, 548.6077777777775, 556.3377777777775, 528.7505555555558, 542.6011111111109, 531.7811111111112, 536.147222222222, 532.3616666666667, 547.1705555555554, 544.9088888888889, 542.1549999999999, 529.7099999999997, 550.2266666666666, 562.0994444444444, 544.8288888888887, 540.6066666666667, 554.7183333333331, 555.0672222222221, 556.4949999999999, 557.7744444444444, 527.9255555555553, 536.9811111111111, 530.107222222222, 541.2827777777778, 560.6866666666667, 543.9094444444443, 558.2966666666666, 557.7572222222221, 562.4799999999998, 560.79, 532.4344444444444, 552.5833333333331, 534.5755555555555, 526.5283333333332, 548.9088888888891, 552.2027777777778, 553.7583333333334, 546.5683333333334, 543.4488888888887, 530.2099999999998, 564.8294444444443, 548.2983333333331, 533.14, 539.995, 554.2100000000002, 566.9883333333335, 553.2100000000003, 551.5283333333332, 559.465, 548.9722222222223, 535.2194444444442, 545.3372222222222, 559.9477777777776, 548.4183333333332, 529.0938888888887, 545.4872222222222, 555.9244444444444, 568.1861111111108, 557.2422222222224, 545.5188888888889, 554.9716666666666, 550.8861111111111, 546.8766666666664, 539.448333333333, 560.79, 557.0366666666667, 549.7572222222221, 554.4327777777778, 558.2816666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19851427218258977, "mean_inference_ms": 1.8055439675493432, "mean_action_processing_ms": 0.07525655534579229, "mean_env_wait_ms": 1.2250965315797262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004578828811645508, "StateBufferConnector_ms": 0.0030019283294677734, "ViewRequirementAgentConnector_ms": 0.06974363327026367}, "num_episodes": 30, "episode_return_max": 568.1861111111108, "episode_return_min": 517.4888888888888, "episode_return_mean": 545.7252555555555, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 407250, "num_agent_steps_trained": 407100, "num_env_steps_sampled": 407250, "num_env_steps_trained": 407100, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 286.70065143910927, "num_env_steps_trained_throughput_per_sec": 286.70065143910927, "timesteps_total": 407250, "num_env_steps_sampled_lifetime": 407250, "num_agent_steps_sampled_lifetime": 407250, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 407250, "timers": {"training_iteration_time_ms": 10259.495, "restore_workers_time_ms": 0.012, "training_step_time_ms": 504.167, "sample_time_ms": 489.926, "synch_weights_time_ms": 12.905}, "counters": {"num_env_steps_sampled": 407250, "num_env_steps_trained": 407100, "num_agent_steps_sampled": 407250, "num_agent_steps_trained": 407100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2715, "num_samples_added_to_queue": 407100}, "done": false, "training_iteration": 137, "trial_id": "0313d_00000", "date": "2024-10-10_22-04-59", "timestamp": 1728594299, "time_this_iter_s": 10.474711894989014, "time_total_s": 1410.1686668395996, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c17700>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1410.1686668395996, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 11.833333333333334, "ram_util_percent": 75.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 85590.78125, "policy_loss": 85198.875, "entropy": 9.553625106811523, "entropy_coeff": 0.01, "var_gnorm": 16.701061248779297, "vf_loss": 420574.125, "vf_explained_var": 0.22803246974945068}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1367.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 410250, "num_env_steps_trained": 410100, "num_agent_steps_sampled": 410250, "num_agent_steps_trained": 410100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2735, "num_samples_added_to_queue": 410100, "learner_queue": {"size_count": 1367, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.507, "learner_load_time_ms": 0.247, "learner_load_wait_time_ms": 969.259, "learner_dequeue_time_ms": 8508.817}}, "env_runners": {"episode_reward_max": 581.4094444444444, "episode_reward_min": 523.7744444444445, "episode_reward_mean": 551.3324666666666, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 523.7744444444445}, "policy_reward_max": {"default_policy": 581.4094444444444}, "policy_reward_mean": {"default_policy": 551.3324666666666}, "custom_metrics": {"num_consolidated_mean": 2.6040000000000005, "num_consolidated_min": 2.43, "num_consolidated_max": 2.77, "num_overloaded_mean": 0.0081, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 2.6976, "num_moves_min": 2.1, "num_moves_max": 3.5, "mean_accuracy_mean": 39.53686999999998, "mean_accuracy_min": 39.36466666666665, "mean_accuracy_max": 39.75099999999998, "num_model_switches_mean": 1.4848, "num_model_switches_min": 1.1, "num_model_switches_max": 1.85, "num_slav_mean": 0.000567, "num_slav_min": 8.333333333333333e-05, "num_slav_max": 0.0019166666666666668, "mean_cluster_cpu_util_mean": 0.5000328489959176, "mean_cluster_cpu_util_min": 0.4775130330433531, "mean_cluster_cpu_util_max": 0.5174334810175646, "mean_cluster_mem_util_mean": 0.30746490147535804, "mean_cluster_mem_util_min": 0.29929130536180715, "mean_cluster_mem_util_max": 0.31627000990269527, "reward_consolidation_mean_mean": 3.5850000000000004, "reward_consolidation_mean_min": 3.333333333333334, "reward_consolidation_mean_max": 3.8472222222222223, "reward_illegal_mean_mean": -0.013500000000000002, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.960641333333333, "reward_accuracy_mean_min": 1.8920499999999998, "reward_accuracy_mean_max": 1.9834333333333334, "reward_sla_mean_mean": -0.01881666666666667, "reward_sla_mean_min": -0.06388888888888888, "reward_sla_mean_max": -0.002777777777777778, "reward_consolidation_sum_mean": 358.5, "reward_consolidation_sum_min": 333.33333333333337, "reward_consolidation_sum_max": 384.72222222222223, "reward_illegal_sum_mean": -1.35, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 196.0641333333333, "reward_accuracy_sum_min": 189.20499999999998, "reward_accuracy_sum_max": 198.34333333333333, "reward_sla_sum_mean": -1.8816666666666666, "reward_sla_sum_min": -6.388888888888888, "reward_sla_sum_max": -0.2777777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2457.0, "global_timestep_min": 300, "global_timestep_max": 4100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [523.7744444444445, 539.3872222222224, 548.6077777777775, 556.3377777777775, 528.7505555555558, 542.6011111111109, 531.7811111111112, 536.147222222222, 532.3616666666667, 547.1705555555554, 544.9088888888889, 542.1549999999999, 529.7099999999997, 550.2266666666666, 562.0994444444444, 544.8288888888887, 540.6066666666667, 554.7183333333331, 555.0672222222221, 556.4949999999999, 557.7744444444444, 527.9255555555553, 536.9811111111111, 530.107222222222, 541.2827777777778, 560.6866666666667, 543.9094444444443, 558.2966666666666, 557.7572222222221, 562.4799999999998, 560.79, 532.4344444444444, 552.5833333333331, 534.5755555555555, 526.5283333333332, 548.9088888888891, 552.2027777777778, 553.7583333333334, 546.5683333333334, 543.4488888888887, 530.2099999999998, 564.8294444444443, 548.2983333333331, 533.14, 539.995, 554.2100000000002, 566.9883333333335, 553.2100000000003, 551.5283333333332, 559.465, 548.9722222222223, 535.2194444444442, 545.3372222222222, 559.9477777777776, 548.4183333333332, 529.0938888888887, 545.4872222222222, 555.9244444444444, 568.1861111111108, 557.2422222222224, 545.5188888888889, 554.9716666666666, 550.8861111111111, 546.8766666666664, 539.448333333333, 560.79, 557.0366666666667, 549.7572222222221, 554.4327777777778, 558.2816666666666, 554.6305555555559, 550.7111111111109, 545.2566666666667, 552.7955555555552, 545.807222222222, 557.9627777777779, 553.7033333333333, 563.4561111111111, 564.925, 563.8683333333332, 545.3449999999999, 541.3288888888889, 566.3372222222224, 556.7888888888888, 574.6472222222224, 571.3855555555557, 553.6938888888888, 578.8683333333333, 563.1472222222224, 550.8049999999998, 551.4322222222221, 560.9077777777777, 560.75, 559.7566666666667, 574.4088888888889, 567.558888888889, 573.447222222222, 581.4094444444444, 568.7877777777777, 568.885], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [523.7744444444445, 539.3872222222224, 548.6077777777775, 556.3377777777775, 528.7505555555558, 542.6011111111109, 531.7811111111112, 536.147222222222, 532.3616666666667, 547.1705555555554, 544.9088888888889, 542.1549999999999, 529.7099999999997, 550.2266666666666, 562.0994444444444, 544.8288888888887, 540.6066666666667, 554.7183333333331, 555.0672222222221, 556.4949999999999, 557.7744444444444, 527.9255555555553, 536.9811111111111, 530.107222222222, 541.2827777777778, 560.6866666666667, 543.9094444444443, 558.2966666666666, 557.7572222222221, 562.4799999999998, 560.79, 532.4344444444444, 552.5833333333331, 534.5755555555555, 526.5283333333332, 548.9088888888891, 552.2027777777778, 553.7583333333334, 546.5683333333334, 543.4488888888887, 530.2099999999998, 564.8294444444443, 548.2983333333331, 533.14, 539.995, 554.2100000000002, 566.9883333333335, 553.2100000000003, 551.5283333333332, 559.465, 548.9722222222223, 535.2194444444442, 545.3372222222222, 559.9477777777776, 548.4183333333332, 529.0938888888887, 545.4872222222222, 555.9244444444444, 568.1861111111108, 557.2422222222224, 545.5188888888889, 554.9716666666666, 550.8861111111111, 546.8766666666664, 539.448333333333, 560.79, 557.0366666666667, 549.7572222222221, 554.4327777777778, 558.2816666666666, 554.6305555555559, 550.7111111111109, 545.2566666666667, 552.7955555555552, 545.807222222222, 557.9627777777779, 553.7033333333333, 563.4561111111111, 564.925, 563.8683333333332, 545.3449999999999, 541.3288888888889, 566.3372222222224, 556.7888888888888, 574.6472222222224, 571.3855555555557, 553.6938888888888, 578.8683333333333, 563.1472222222224, 550.8049999999998, 551.4322222222221, 560.9077777777777, 560.75, 559.7566666666667, 574.4088888888889, 567.558888888889, 573.447222222222, 581.4094444444444, 568.7877777777777, 568.885]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19855585281502727, "mean_inference_ms": 1.8057788980122182, "mean_action_processing_ms": 0.07526244472598298, "mean_env_wait_ms": 1.2251664303874676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043888092041015625, "StateBufferConnector_ms": 0.0029439926147460938, "ViewRequirementAgentConnector_ms": 0.06733322143554688}, "num_episodes": 30, "episode_return_max": 581.4094444444444, "episode_return_min": 523.7744444444445, "episode_return_mean": 551.3324666666666, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 410250, "num_agent_steps_trained": 410100, "num_env_steps_sampled": 410250, "num_env_steps_trained": 410100, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 284.67765375195125, "num_env_steps_trained_throughput_per_sec": 284.67765375195125, "timesteps_total": 410250, "num_env_steps_sampled_lifetime": 410250, "num_agent_steps_sampled_lifetime": 410250, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 410250, "timers": {"training_iteration_time_ms": 10292.055, "restore_workers_time_ms": 0.012, "training_step_time_ms": 539.617, "sample_time_ms": 525.121, "synch_weights_time_ms": 12.893}, "counters": {"num_env_steps_sampled": 410250, "num_env_steps_trained": 410100, "num_agent_steps_sampled": 410250, "num_agent_steps_trained": 410100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2735, "num_samples_added_to_queue": 410100}, "done": false, "training_iteration": 138, "trial_id": "0313d_00000", "date": "2024-10-10_22-05-09", "timestamp": 1728594309, "time_this_iter_s": 10.551290512084961, "time_total_s": 1420.7199573516846, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a6620>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1420.7199573516846, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 12.173333333333336, "ram_util_percent": 75.82000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 81202.515625, "policy_loss": 80760.796875, "entropy": 9.42558479309082, "entropy_coeff": 0.01, "var_gnorm": 16.70139503479004, "vf_loss": 469994.3125, "vf_explained_var": 0.2205280065536499}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1377.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 413250, "num_env_steps_trained": 413100, "num_agent_steps_sampled": 413250, "num_agent_steps_trained": 413100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2755, "num_samples_added_to_queue": 413100, "learner_queue": {"size_count": 1377, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.487, "learner_load_time_ms": 0.273, "learner_load_wait_time_ms": 1019.451, "learner_dequeue_time_ms": 8537.806}}, "env_runners": {"episode_reward_max": 584.3766666666669, "episode_reward_min": 526.5283333333332, "episode_reward_mean": 557.7570499999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 526.5283333333332}, "policy_reward_max": {"default_policy": 584.3766666666669}, "policy_reward_mean": {"default_policy": 557.7570499999998}, "custom_metrics": {"num_consolidated_mean": 2.6489, "num_consolidated_min": 2.45, "num_consolidated_max": 2.83, "num_overloaded_mean": 0.0079, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 2.5399000000000003, "num_moves_min": 1.87, "num_moves_max": 3.02, "mean_accuracy_mean": 39.538009999999986, "mean_accuracy_min": 39.408999999999985, "mean_accuracy_max": 39.75099999999998, "num_model_switches_mean": 1.4204, "num_model_switches_min": 1.09, "num_model_switches_max": 1.85, "num_slav_mean": 0.000547, "num_slav_min": 0.0001, "num_slav_max": 0.0019833333333333335, "mean_cluster_cpu_util_mean": 0.5048843057550023, "mean_cluster_cpu_util_min": 0.4840865454244294, "mean_cluster_cpu_util_max": 0.5228758156197992, "mean_cluster_mem_util_mean": 0.3093730990215706, "mean_cluster_mem_util_min": 0.3009634908077155, "mean_cluster_mem_util_max": 0.31646915687160937, "reward_consolidation_mean_mean": 3.6475, "reward_consolidation_mean_min": 3.361111111111112, "reward_consolidation_mean_max": 3.902777777777778, "reward_illegal_mean_mean": -0.013166666666666667, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9610871666666665, "reward_accuracy_mean_min": 1.8920499999999998, "reward_accuracy_mean_max": 1.9834333333333334, "reward_sla_mean_mean": -0.01785, "reward_sla_mean_min": -0.0661111111111111, "reward_sla_mean_max": -0.0033333333333333335, "reward_consolidation_sum_mean": 364.75, "reward_consolidation_sum_min": 336.1111111111112, "reward_consolidation_sum_max": 390.2777777777778, "reward_illegal_sum_mean": -1.3166666666666667, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 196.10871666666662, "reward_accuracy_sum_min": 189.20499999999998, "reward_accuracy_sum_max": 198.34333333333333, "reward_sla_sum_mean": -1.785, "reward_sla_sum_min": -6.611111111111111, "reward_sla_sum_max": -0.33333333333333337, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3459.0, "global_timestep_min": 1300, "global_timestep_max": 5100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [560.79, 532.4344444444444, 552.5833333333331, 534.5755555555555, 526.5283333333332, 548.9088888888891, 552.2027777777778, 553.7583333333334, 546.5683333333334, 543.4488888888887, 530.2099999999998, 564.8294444444443, 548.2983333333331, 533.14, 539.995, 554.2100000000002, 566.9883333333335, 553.2100000000003, 551.5283333333332, 559.465, 548.9722222222223, 535.2194444444442, 545.3372222222222, 559.9477777777776, 548.4183333333332, 529.0938888888887, 545.4872222222222, 555.9244444444444, 568.1861111111108, 557.2422222222224, 545.5188888888889, 554.9716666666666, 550.8861111111111, 546.8766666666664, 539.448333333333, 560.79, 557.0366666666667, 549.7572222222221, 554.4327777777778, 558.2816666666666, 554.6305555555559, 550.7111111111109, 545.2566666666667, 552.7955555555552, 545.807222222222, 557.9627777777779, 553.7033333333333, 563.4561111111111, 564.925, 563.8683333333332, 545.3449999999999, 541.3288888888889, 566.3372222222224, 556.7888888888888, 574.6472222222224, 571.3855555555557, 553.6938888888888, 578.8683333333333, 563.1472222222224, 550.8049999999998, 551.4322222222221, 560.9077777777777, 560.75, 559.7566666666667, 574.4088888888889, 567.558888888889, 573.447222222222, 581.4094444444444, 568.7877777777777, 568.885, 584.3766666666669, 560.3127777777776, 571.1305555555557, 566.7827777777777, 576.1472222222222, 542.5455555555556, 563.3305555555554, 555.4883333333335, 559.5755555555554, 577.7972222222224, 563.6155555555554, 569.2900000000001, 565.1700000000002, 579.3127777777775, 562.7983333333332, 558.5761111111109, 549.4961111111111, 575.9872222222223, 582.06, 570.7199999999999, 542.6633333333331, 573.3372222222224, 570.9, 569.4716666666665, 575.1466666666668, 554.1705555555554, 559.4183333333335, 574.1561111111109, 569.5027777777779, 564.1149999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [560.79, 532.4344444444444, 552.5833333333331, 534.5755555555555, 526.5283333333332, 548.9088888888891, 552.2027777777778, 553.7583333333334, 546.5683333333334, 543.4488888888887, 530.2099999999998, 564.8294444444443, 548.2983333333331, 533.14, 539.995, 554.2100000000002, 566.9883333333335, 553.2100000000003, 551.5283333333332, 559.465, 548.9722222222223, 535.2194444444442, 545.3372222222222, 559.9477777777776, 548.4183333333332, 529.0938888888887, 545.4872222222222, 555.9244444444444, 568.1861111111108, 557.2422222222224, 545.5188888888889, 554.9716666666666, 550.8861111111111, 546.8766666666664, 539.448333333333, 560.79, 557.0366666666667, 549.7572222222221, 554.4327777777778, 558.2816666666666, 554.6305555555559, 550.7111111111109, 545.2566666666667, 552.7955555555552, 545.807222222222, 557.9627777777779, 553.7033333333333, 563.4561111111111, 564.925, 563.8683333333332, 545.3449999999999, 541.3288888888889, 566.3372222222224, 556.7888888888888, 574.6472222222224, 571.3855555555557, 553.6938888888888, 578.8683333333333, 563.1472222222224, 550.8049999999998, 551.4322222222221, 560.9077777777777, 560.75, 559.7566666666667, 574.4088888888889, 567.558888888889, 573.447222222222, 581.4094444444444, 568.7877777777777, 568.885, 584.3766666666669, 560.3127777777776, 571.1305555555557, 566.7827777777777, 576.1472222222222, 542.5455555555556, 563.3305555555554, 555.4883333333335, 559.5755555555554, 577.7972222222224, 563.6155555555554, 569.2900000000001, 565.1700000000002, 579.3127777777775, 562.7983333333332, 558.5761111111109, 549.4961111111111, 575.9872222222223, 582.06, 570.7199999999999, 542.6633333333331, 573.3372222222224, 570.9, 569.4716666666665, 575.1466666666668, 554.1705555555554, 559.4183333333335, 574.1561111111109, 569.5027777777779, 564.1149999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19863308712010422, "mean_inference_ms": 1.8076303357213572, "mean_action_processing_ms": 0.07528748736845403, "mean_env_wait_ms": 1.2256209738746568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004274606704711914, "StateBufferConnector_ms": 0.0029134750366210938, "ViewRequirementAgentConnector_ms": 0.06656742095947266}, "num_episodes": 30, "episode_return_max": 584.3766666666669, "episode_return_min": 526.5283333333332, "episode_return_mean": 557.7570499999998, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 413250, "num_agent_steps_trained": 413100, "num_env_steps_sampled": 413250, "num_env_steps_trained": 413100, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 283.05550374154166, "num_env_steps_trained_throughput_per_sec": 283.05550374154166, "timesteps_total": 413250, "num_env_steps_sampled_lifetime": 413250, "num_agent_steps_sampled_lifetime": 413250, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 413250, "timers": {"training_iteration_time_ms": 10323.093, "restore_workers_time_ms": 0.014, "training_step_time_ms": 536.854, "sample_time_ms": 520.03, "synch_weights_time_ms": 15.267}, "counters": {"num_env_steps_sampled": 413250, "num_env_steps_trained": 413100, "num_agent_steps_sampled": 413250, "num_agent_steps_trained": 413100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2755, "num_samples_added_to_queue": 413100}, "done": false, "training_iteration": 139, "trial_id": "0313d_00000", "date": "2024-10-10_22-05-20", "timestamp": 1728594320, "time_this_iter_s": 10.61643385887146, "time_total_s": 1431.336391210556, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a6500>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1431.336391210556, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 13.946666666666667, "ram_util_percent": 76.71333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 82113.4375, "policy_loss": 81717.734375, "entropy": 9.304862022399902, "entropy_coeff": 0.01, "var_gnorm": 16.702877044677734, "vf_loss": 423614.53125, "vf_explained_var": 0.23759722709655762}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1386.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 416100, "num_env_steps_trained": 415800, "num_agent_steps_sampled": 416100, "num_agent_steps_trained": 415800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2774, "num_samples_added_to_queue": 416100, "learner_queue": {"size_count": 1386, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.477, "learner_load_time_ms": 0.302, "learner_load_wait_time_ms": 1048.57, "learner_dequeue_time_ms": 8570.378}}, "env_runners": {"episode_reward_max": 584.3766666666669, "episode_reward_min": 539.448333333333, "episode_reward_mean": 563.4651277777778, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 539.448333333333}, "policy_reward_max": {"default_policy": 584.3766666666669}, "policy_reward_mean": {"default_policy": 563.4651277777778}, "custom_metrics": {"num_consolidated_mean": 2.6819, "num_consolidated_min": 2.52, "num_consolidated_max": 2.83, "num_overloaded_mean": 0.0065000000000000014, "num_overloaded_min": 0.0, "num_overloaded_max": 0.03, "num_moves_mean": 2.4316, "num_moves_min": 1.87, "num_moves_max": 2.92, "mean_accuracy_mean": 39.52901666666665, "mean_accuracy_min": 39.37099999999998, "mean_accuracy_max": 39.75099999999998, "num_model_switches_mean": 1.3562000000000003, "num_model_switches_min": 0.94, "num_model_switches_max": 1.72, "num_slav_mean": 0.0005063333333333332, "num_slav_min": 0.00011666666666666667, "num_slav_max": 0.0019833333333333335, "mean_cluster_cpu_util_mean": 0.5080522762250625, "mean_cluster_cpu_util_min": 0.48952144552226434, "mean_cluster_cpu_util_max": 0.5228758156197992, "mean_cluster_mem_util_mean": 0.3105437674517064, "mean_cluster_mem_util_min": 0.30418748331611123, "mean_cluster_mem_util_max": 0.31646915687160937, "reward_consolidation_mean_mean": 3.6983333333333337, "reward_consolidation_mean_min": 3.4861111111111116, "reward_consolidation_mean_max": 3.902777777777778, "reward_illegal_mean_mean": -0.010833333333333332, "reward_illegal_mean_min": -0.05, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9634068333333332, "reward_accuracy_mean_min": 1.9132333333333333, "reward_accuracy_mean_max": 1.9834333333333334, "reward_sla_mean_mean": -0.016255555555555554, "reward_sla_mean_min": -0.0661111111111111, "reward_sla_mean_max": -0.0038888888888888888, "reward_consolidation_sum_mean": 369.83333333333337, "reward_consolidation_sum_min": 348.61111111111114, "reward_consolidation_sum_max": 390.2777777777778, "reward_illegal_sum_mean": -1.0833333333333333, "reward_illegal_sum_min": -5.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 196.34068333333337, "reward_accuracy_sum_min": 191.32333333333332, "reward_accuracy_sum_max": 198.34333333333333, "reward_sla_sum_mean": -1.6255555555555554, "reward_sla_sum_min": -6.611111111111111, "reward_sla_sum_max": -0.3888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4450.0, "global_timestep_min": 2200, "global_timestep_max": 6100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [545.5188888888889, 554.9716666666666, 550.8861111111111, 546.8766666666664, 539.448333333333, 560.79, 557.0366666666667, 549.7572222222221, 554.4327777777778, 558.2816666666666, 554.6305555555559, 550.7111111111109, 545.2566666666667, 552.7955555555552, 545.807222222222, 557.9627777777779, 553.7033333333333, 563.4561111111111, 564.925, 563.8683333333332, 545.3449999999999, 541.3288888888889, 566.3372222222224, 556.7888888888888, 574.6472222222224, 571.3855555555557, 553.6938888888888, 578.8683333333333, 563.1472222222224, 550.8049999999998, 551.4322222222221, 560.9077777777777, 560.75, 559.7566666666667, 574.4088888888889, 567.558888888889, 573.447222222222, 581.4094444444444, 568.7877777777777, 568.885, 584.3766666666669, 560.3127777777776, 571.1305555555557, 566.7827777777777, 576.1472222222222, 542.5455555555556, 563.3305555555554, 555.4883333333335, 559.5755555555554, 577.7972222222224, 563.6155555555554, 569.2900000000001, 565.1700000000002, 579.3127777777775, 562.7983333333332, 558.5761111111109, 549.4961111111111, 575.9872222222223, 582.06, 570.7199999999999, 542.6633333333331, 573.3372222222224, 570.9, 569.4716666666665, 575.1466666666668, 554.1705555555554, 559.4183333333335, 574.1561111111109, 569.5027777777779, 564.1149999999999, 556.362222222222, 568.1555555555555, 565.0350000000001, 571.7194444444442, 559.0849999999997, 569.9727777777778, 555.8377777777778, 575.0672222222223, 568.0044444444442, 563.7822222222222, 572.2416666666664, 575.9166666666665, 561.8455555555557, 570.8933333333334, 570.1705555555556, 556.433333333333, 578.9105555555557, 572.0294444444444, 559.5605555555555, 569.0283333333331, 560.2733333333332, 573.21, 550.0605555555558, 570.4083333333334, 564.8138888888888, 570.377222222222, 572.0594444444446, 575.5677777777779, 571.3550000000001, 570.132777777778], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [545.5188888888889, 554.9716666666666, 550.8861111111111, 546.8766666666664, 539.448333333333, 560.79, 557.0366666666667, 549.7572222222221, 554.4327777777778, 558.2816666666666, 554.6305555555559, 550.7111111111109, 545.2566666666667, 552.7955555555552, 545.807222222222, 557.9627777777779, 553.7033333333333, 563.4561111111111, 564.925, 563.8683333333332, 545.3449999999999, 541.3288888888889, 566.3372222222224, 556.7888888888888, 574.6472222222224, 571.3855555555557, 553.6938888888888, 578.8683333333333, 563.1472222222224, 550.8049999999998, 551.4322222222221, 560.9077777777777, 560.75, 559.7566666666667, 574.4088888888889, 567.558888888889, 573.447222222222, 581.4094444444444, 568.7877777777777, 568.885, 584.3766666666669, 560.3127777777776, 571.1305555555557, 566.7827777777777, 576.1472222222222, 542.5455555555556, 563.3305555555554, 555.4883333333335, 559.5755555555554, 577.7972222222224, 563.6155555555554, 569.2900000000001, 565.1700000000002, 579.3127777777775, 562.7983333333332, 558.5761111111109, 549.4961111111111, 575.9872222222223, 582.06, 570.7199999999999, 542.6633333333331, 573.3372222222224, 570.9, 569.4716666666665, 575.1466666666668, 554.1705555555554, 559.4183333333335, 574.1561111111109, 569.5027777777779, 564.1149999999999, 556.362222222222, 568.1555555555555, 565.0350000000001, 571.7194444444442, 559.0849999999997, 569.9727777777778, 555.8377777777778, 575.0672222222223, 568.0044444444442, 563.7822222222222, 572.2416666666664, 575.9166666666665, 561.8455555555557, 570.8933333333334, 570.1705555555556, 556.433333333333, 578.9105555555557, 572.0294444444444, 559.5605555555555, 569.0283333333331, 560.2733333333332, 573.21, 550.0605555555558, 570.4083333333334, 564.8138888888888, 570.377222222222, 572.0594444444446, 575.5677777777779, 571.3550000000001, 570.132777777778]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19869083721274744, "mean_inference_ms": 1.8079612977416588, "mean_action_processing_ms": 0.07529617249774816, "mean_env_wait_ms": 1.2257995740610845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004452228546142578, "StateBufferConnector_ms": 0.0030069351196289062, "ViewRequirementAgentConnector_ms": 0.06882333755493164}, "num_episodes": 30, "episode_return_max": 584.3766666666669, "episode_return_min": 539.448333333333, "episode_return_mean": 563.4651277777778, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416100, "num_agent_steps_trained": 415800, "num_env_steps_sampled": 416100, "num_env_steps_trained": 415800, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 273.1675382231217, "num_env_steps_trained_throughput_per_sec": 258.7902993692732, "timesteps_total": 416100, "num_env_steps_sampled_lifetime": 416100, "num_agent_steps_sampled_lifetime": 416100, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 416100, "timers": {"training_iteration_time_ms": 10330.059, "restore_workers_time_ms": 0.013, "training_step_time_ms": 528.031, "sample_time_ms": 512.502, "synch_weights_time_ms": 13.888}, "counters": {"num_env_steps_sampled": 416100, "num_env_steps_trained": 415800, "num_agent_steps_sampled": 416100, "num_agent_steps_trained": 415800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2774, "num_samples_added_to_queue": 416100}, "done": false, "training_iteration": 140, "trial_id": "0313d_00000", "date": "2024-10-10_22-05-30", "timestamp": 1728594330, "time_this_iter_s": 10.447379112243652, "time_total_s": 1441.7837703227997, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42d8bac0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1441.7837703227997, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 16.306666666666665, "ram_util_percent": 76.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 76019.09375, "policy_loss": 75627.5390625, "entropy": 9.416756629943848, "entropy_coeff": 0.01, "var_gnorm": 16.700698852539062, "vf_loss": 419801.375, "vf_explained_var": 0.24286216497421265}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1396.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 419100, "num_env_steps_trained": 418800, "num_agent_steps_sampled": 419100, "num_agent_steps_trained": 418800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2794, "num_samples_added_to_queue": 419100, "learner_queue": {"size_count": 1396, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 64.72, "learner_load_time_ms": 0.32, "learner_load_wait_time_ms": 989.603, "learner_dequeue_time_ms": 8553.72}}, "env_runners": {"episode_reward_max": 585.5366666666667, "episode_reward_min": 542.5455555555556, "episode_reward_mean": 566.9746166666666, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 542.5455555555556}, "policy_reward_max": {"default_policy": 585.5366666666667}, "policy_reward_mean": {"default_policy": 566.9746166666666}, "custom_metrics": {"num_consolidated_mean": 2.7030000000000007, "num_consolidated_min": 2.56, "num_consolidated_max": 2.83, "num_overloaded_mean": 0.0058, "num_overloaded_min": 0.0, "num_overloaded_max": 0.03, "num_moves_mean": 2.3620999999999994, "num_moves_min": 1.87, "num_moves_max": 2.75, "mean_accuracy_mean": 39.50368333333332, "mean_accuracy_min": 39.37099999999998, "mean_accuracy_max": 39.66866666666665, "num_model_switches_mean": 1.3048, "num_model_switches_min": 0.94, "num_model_switches_max": 1.72, "num_slav_mean": 0.0004548333333333334, "num_slav_min": 3.3333333333333335e-05, "num_slav_max": 0.0019833333333333335, "mean_cluster_cpu_util_mean": 0.5100985712094073, "mean_cluster_cpu_util_min": 0.49669882847814245, "mean_cluster_cpu_util_max": 0.5228758156197992, "mean_cluster_mem_util_mean": 0.31127643254865234, "mean_cluster_mem_util_min": 0.30586082892017563, "mean_cluster_mem_util_max": 0.3166071559530985, "reward_consolidation_mean_mean": 3.7304166666666676, "reward_consolidation_mean_min": 3.527777777777778, "reward_consolidation_mean_max": 3.902777777777778, "reward_illegal_mean_mean": -0.009666666666666667, "reward_illegal_mean_min": -0.05, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9635628333333335, "reward_accuracy_mean_min": 1.9132333333333333, "reward_accuracy_mean_max": 1.9834333333333334, "reward_sla_mean_mean": -0.01456666666666667, "reward_sla_mean_min": -0.0661111111111111, "reward_sla_mean_max": -0.0011111111111111111, "reward_consolidation_sum_mean": 373.04166666666663, "reward_consolidation_sum_min": 352.7777777777778, "reward_consolidation_sum_max": 390.2777777777778, "reward_illegal_sum_mean": -0.9666666666666666, "reward_illegal_sum_min": -5.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 196.3562833333333, "reward_accuracy_sum_min": 191.32333333333332, "reward_accuracy_sum_max": 198.34333333333333, "reward_sla_sum_mean": -1.4566666666666668, "reward_sla_sum_min": -6.611111111111111, "reward_sla_sum_max": -0.11111111111111112, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5450.0, "global_timestep_min": 3200, "global_timestep_max": 7100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [551.4322222222221, 560.9077777777777, 560.75, 559.7566666666667, 574.4088888888889, 567.558888888889, 573.447222222222, 581.4094444444444, 568.7877777777777, 568.885, 584.3766666666669, 560.3127777777776, 571.1305555555557, 566.7827777777777, 576.1472222222222, 542.5455555555556, 563.3305555555554, 555.4883333333335, 559.5755555555554, 577.7972222222224, 563.6155555555554, 569.2900000000001, 565.1700000000002, 579.3127777777775, 562.7983333333332, 558.5761111111109, 549.4961111111111, 575.9872222222223, 582.06, 570.7199999999999, 542.6633333333331, 573.3372222222224, 570.9, 569.4716666666665, 575.1466666666668, 554.1705555555554, 559.4183333333335, 574.1561111111109, 569.5027777777779, 564.1149999999999, 556.362222222222, 568.1555555555555, 565.0350000000001, 571.7194444444442, 559.0849999999997, 569.9727777777778, 555.8377777777778, 575.0672222222223, 568.0044444444442, 563.7822222222222, 572.2416666666664, 575.9166666666665, 561.8455555555557, 570.8933333333334, 570.1705555555556, 556.433333333333, 578.9105555555557, 572.0294444444444, 559.5605555555555, 569.0283333333331, 560.2733333333332, 573.21, 550.0605555555558, 570.4083333333334, 564.8138888888888, 570.377222222222, 572.0594444444446, 575.5677777777779, 571.3550000000001, 570.132777777778, 571.8377777777778, 568.0605555555554, 557.8699999999999, 554.1705555555557, 558.3461111111112, 569.4177777777775, 564.1000000000001, 581.0366666666665, 576.1555555555553, 551.6872222222222, 558.91, 570.2977777777776, 576.0677777777779, 576.4733333333332, 558.3555555555555, 568.4972222222221, 575.4811111111111, 565.2038888888887, 556.0133333333332, 585.5366666666667, 566.3772222222221, 571.908888888889, 575.8461111111111, 557.4261111111109, 568.4644444444444, 566.2105555555554, 566.536111111111, 574.2033333333333, 558.2655555555557, 575.6555555555552], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [551.4322222222221, 560.9077777777777, 560.75, 559.7566666666667, 574.4088888888889, 567.558888888889, 573.447222222222, 581.4094444444444, 568.7877777777777, 568.885, 584.3766666666669, 560.3127777777776, 571.1305555555557, 566.7827777777777, 576.1472222222222, 542.5455555555556, 563.3305555555554, 555.4883333333335, 559.5755555555554, 577.7972222222224, 563.6155555555554, 569.2900000000001, 565.1700000000002, 579.3127777777775, 562.7983333333332, 558.5761111111109, 549.4961111111111, 575.9872222222223, 582.06, 570.7199999999999, 542.6633333333331, 573.3372222222224, 570.9, 569.4716666666665, 575.1466666666668, 554.1705555555554, 559.4183333333335, 574.1561111111109, 569.5027777777779, 564.1149999999999, 556.362222222222, 568.1555555555555, 565.0350000000001, 571.7194444444442, 559.0849999999997, 569.9727777777778, 555.8377777777778, 575.0672222222223, 568.0044444444442, 563.7822222222222, 572.2416666666664, 575.9166666666665, 561.8455555555557, 570.8933333333334, 570.1705555555556, 556.433333333333, 578.9105555555557, 572.0294444444444, 559.5605555555555, 569.0283333333331, 560.2733333333332, 573.21, 550.0605555555558, 570.4083333333334, 564.8138888888888, 570.377222222222, 572.0594444444446, 575.5677777777779, 571.3550000000001, 570.132777777778, 571.8377777777778, 568.0605555555554, 557.8699999999999, 554.1705555555557, 558.3461111111112, 569.4177777777775, 564.1000000000001, 581.0366666666665, 576.1555555555553, 551.6872222222222, 558.91, 570.2977777777776, 576.0677777777779, 576.4733333333332, 558.3555555555555, 568.4972222222221, 575.4811111111111, 565.2038888888887, 556.0133333333332, 585.5366666666667, 566.3772222222221, 571.908888888889, 575.8461111111111, 557.4261111111109, 568.4644444444444, 566.2105555555554, 566.536111111111, 574.2033333333333, 558.2655555555557, 575.6555555555552]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19875717567594223, "mean_inference_ms": 1.8083313569687585, "mean_action_processing_ms": 0.0753096240786702, "mean_env_wait_ms": 1.2260227593658088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004573345184326172, "StateBufferConnector_ms": 0.003021240234375, "ViewRequirementAgentConnector_ms": 0.0697021484375}, "num_episodes": 30, "episode_return_max": 585.5366666666667, "episode_return_min": 542.5455555555556, "episode_return_mean": 566.9746166666666, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 419100, "num_agent_steps_trained": 418800, "num_env_steps_sampled": 419100, "num_env_steps_trained": 418800, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 286.0090282928165, "num_env_steps_trained_throughput_per_sec": 286.0090282928165, "timesteps_total": 419100, "num_env_steps_sampled_lifetime": 419100, "num_agent_steps_sampled_lifetime": 419100, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 419100, "timers": {"training_iteration_time_ms": 10371.541, "restore_workers_time_ms": 0.013, "training_step_time_ms": 541.185, "sample_time_ms": 526.407, "synch_weights_time_ms": 13.272}, "counters": {"num_env_steps_sampled": 419100, "num_env_steps_trained": 418800, "num_agent_steps_sampled": 419100, "num_agent_steps_trained": 418800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2794, "num_samples_added_to_queue": 419100}, "done": false, "training_iteration": 141, "trial_id": "0313d_00000", "date": "2024-10-10_22-05-41", "timestamp": 1728594341, "time_this_iter_s": 10.500426530838013, "time_total_s": 1452.2841968536377, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42fa1fc0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1452.2841968536377, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 12.0, "ram_util_percent": 76.27999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 66368.421875, "policy_loss": 65982.375, "entropy": 8.567805290222168, "entropy_coeff": 0.01, "var_gnorm": 16.707378387451172, "vf_loss": 411752.90625, "vf_explained_var": 0.263671875}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1406.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 421950, "num_env_steps_trained": 421800, "num_agent_steps_sampled": 421950, "num_agent_steps_trained": 421800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2813, "num_samples_added_to_queue": 421800, "learner_queue": {"size_count": 1406, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.377, "learner_load_time_ms": 0.325, "learner_load_wait_time_ms": 1046.13, "learner_dequeue_time_ms": 8597.543}}, "env_runners": {"episode_reward_max": 592.3544444444444, "episode_reward_min": 542.6633333333331, "episode_reward_mean": 569.1520055555555, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 542.6633333333331}, "policy_reward_max": {"default_policy": 592.3544444444444}, "policy_reward_mean": {"default_policy": 569.1520055555555}, "custom_metrics": {"num_consolidated_mean": 2.7156999999999996, "num_consolidated_min": 2.56, "num_consolidated_max": 2.85, "num_overloaded_mean": 0.005, "num_overloaded_min": 0.0, "num_overloaded_max": 0.03, "num_moves_mean": 2.2971000000000004, "num_moves_min": 1.8, "num_moves_max": 2.75, "mean_accuracy_mean": 39.46815333333332, "mean_accuracy_min": 39.32666666666665, "mean_accuracy_max": 39.61166666666665, "num_model_switches_mean": 1.2391, "num_model_switches_min": 0.89, "num_model_switches_max": 1.72, "num_slav_mean": 0.0004488333333333333, "num_slav_min": 3.3333333333333335e-05, "num_slav_max": 0.0019833333333333335, "mean_cluster_cpu_util_mean": 0.5106451971347075, "mean_cluster_cpu_util_min": 0.49669882847814245, "mean_cluster_cpu_util_max": 0.5232506859223873, "mean_cluster_mem_util_mean": 0.31141315712814666, "mean_cluster_mem_util_min": 0.30586082892017563, "mean_cluster_mem_util_max": 0.3166071559530985, "reward_consolidation_mean_mean": 3.7511111111111113, "reward_consolidation_mean_min": 3.527777777777778, "reward_consolidation_mean_max": 3.958333333333334, "reward_illegal_mean_mean": -0.008333333333333333, "reward_illegal_mean_min": -0.05, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9634144999999996, "reward_accuracy_mean_min": 1.9141833333333331, "reward_accuracy_mean_max": 1.9805833333333331, "reward_sla_mean_mean": -0.014672222222222222, "reward_sla_mean_min": -0.0661111111111111, "reward_sla_mean_max": -0.0011111111111111111, "reward_consolidation_sum_mean": 375.11111111111114, "reward_consolidation_sum_min": 352.7777777777778, "reward_consolidation_sum_max": 395.83333333333337, "reward_illegal_sum_mean": -0.8333333333333333, "reward_illegal_sum_min": -5.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 196.34145, "reward_accuracy_sum_min": 191.41833333333332, "reward_accuracy_sum_max": 198.0583333333333, "reward_sla_sum_mean": -1.467222222222222, "reward_sla_sum_min": -6.611111111111111, "reward_sla_sum_max": -0.11111111111111112, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5889.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [575.9872222222223, 582.06, 570.7199999999999, 542.6633333333331, 573.3372222222224, 570.9, 569.4716666666665, 575.1466666666668, 554.1705555555554, 559.4183333333335, 574.1561111111109, 569.5027777777779, 564.1149999999999, 556.362222222222, 568.1555555555555, 565.0350000000001, 571.7194444444442, 559.0849999999997, 569.9727777777778, 555.8377777777778, 575.0672222222223, 568.0044444444442, 563.7822222222222, 572.2416666666664, 575.9166666666665, 561.8455555555557, 570.8933333333334, 570.1705555555556, 556.433333333333, 578.9105555555557, 572.0294444444444, 559.5605555555555, 569.0283333333331, 560.2733333333332, 573.21, 550.0605555555558, 570.4083333333334, 564.8138888888888, 570.377222222222, 572.0594444444446, 575.5677777777779, 571.3550000000001, 570.132777777778, 571.8377777777778, 568.0605555555554, 557.8699999999999, 554.1705555555557, 558.3461111111112, 569.4177777777775, 564.1000000000001, 581.0366666666665, 576.1555555555553, 551.6872222222222, 558.91, 570.2977777777776, 576.0677777777779, 576.4733333333332, 558.3555555555555, 568.4972222222221, 575.4811111111111, 565.2038888888887, 556.0133333333332, 585.5366666666667, 566.3772222222221, 571.908888888889, 575.8461111111111, 557.4261111111109, 568.4644444444444, 566.2105555555554, 566.536111111111, 574.2033333333333, 558.2655555555557, 575.6555555555552, 573.9583333333333, 571.5138888888887, 574.6083333333335, 569.3144444444445, 568.2994444444444, 572.4027777777779, 566.7994444444445, 582.6800000000002, 578.7994444444447, 581.251111111111, 592.3544444444444, 574.2349999999999, 566.0683333333334, 571.2977777777774, 574.0138888888887, 571.3638888888889, 577.7994444444445, 579.473888888889, 568.6394444444443, 566.0838888888886, 565.6722222222223, 579.5444444444445, 562.3149999999998, 579.6322222222223, 570.5611111111112, 582.5216666666668, 569.625], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [575.9872222222223, 582.06, 570.7199999999999, 542.6633333333331, 573.3372222222224, 570.9, 569.4716666666665, 575.1466666666668, 554.1705555555554, 559.4183333333335, 574.1561111111109, 569.5027777777779, 564.1149999999999, 556.362222222222, 568.1555555555555, 565.0350000000001, 571.7194444444442, 559.0849999999997, 569.9727777777778, 555.8377777777778, 575.0672222222223, 568.0044444444442, 563.7822222222222, 572.2416666666664, 575.9166666666665, 561.8455555555557, 570.8933333333334, 570.1705555555556, 556.433333333333, 578.9105555555557, 572.0294444444444, 559.5605555555555, 569.0283333333331, 560.2733333333332, 573.21, 550.0605555555558, 570.4083333333334, 564.8138888888888, 570.377222222222, 572.0594444444446, 575.5677777777779, 571.3550000000001, 570.132777777778, 571.8377777777778, 568.0605555555554, 557.8699999999999, 554.1705555555557, 558.3461111111112, 569.4177777777775, 564.1000000000001, 581.0366666666665, 576.1555555555553, 551.6872222222222, 558.91, 570.2977777777776, 576.0677777777779, 576.4733333333332, 558.3555555555555, 568.4972222222221, 575.4811111111111, 565.2038888888887, 556.0133333333332, 585.5366666666667, 566.3772222222221, 571.908888888889, 575.8461111111111, 557.4261111111109, 568.4644444444444, 566.2105555555554, 566.536111111111, 574.2033333333333, 558.2655555555557, 575.6555555555552, 573.9583333333333, 571.5138888888887, 574.6083333333335, 569.3144444444445, 568.2994444444444, 572.4027777777779, 566.7994444444445, 582.6800000000002, 578.7994444444447, 581.251111111111, 592.3544444444444, 574.2349999999999, 566.0683333333334, 571.2977777777774, 574.0138888888887, 571.3638888888889, 577.7994444444445, 579.473888888889, 568.6394444444443, 566.0838888888886, 565.6722222222223, 579.5444444444445, 562.3149999999998, 579.6322222222223, 570.5611111111112, 582.5216666666668, 569.625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19880519960674378, "mean_inference_ms": 1.8072730188956023, "mean_action_processing_ms": 0.07531373683425686, "mean_env_wait_ms": 1.2260324070937805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005105018615722656, "StateBufferConnector_ms": 0.0031163692474365234, "ViewRequirementAgentConnector_ms": 0.07201504707336426}, "num_episodes": 27, "episode_return_max": 592.3544444444444, "episode_return_min": 542.6633333333331, "episode_return_mean": 569.1520055555555, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 421950, "num_agent_steps_trained": 421800, "num_env_steps_sampled": 421950, "num_env_steps_trained": 421800, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 272.752007449739, "num_env_steps_trained_throughput_per_sec": 287.1073762628831, "timesteps_total": 421950, "num_env_steps_sampled_lifetime": 421950, "num_agent_steps_sampled_lifetime": 421950, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 421950, "timers": {"training_iteration_time_ms": 10385.985, "restore_workers_time_ms": 0.013, "training_step_time_ms": 576.649, "sample_time_ms": 560.489, "synch_weights_time_ms": 14.715}, "counters": {"num_env_steps_sampled": 421950, "num_env_steps_trained": 421800, "num_agent_steps_sampled": 421950, "num_agent_steps_trained": 421800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2813, "num_samples_added_to_queue": 421800}, "done": false, "training_iteration": 142, "trial_id": "0313d_00000", "date": "2024-10-10_22-05-51", "timestamp": 1728594351, "time_this_iter_s": 10.458370208740234, "time_total_s": 1462.742567062378, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a7220>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1462.742567062378, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 13.713333333333333, "ram_util_percent": 76.59333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 62007.03125, "policy_loss": 61573.046875, "entropy": 8.578255653381348, "entropy_coeff": 0.01, "var_gnorm": 16.706329345703125, "vf_loss": 459719.875, "vf_explained_var": 0.25607603788375854}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1415.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 424800, "num_env_steps_trained": 424500, "num_agent_steps_sampled": 424800, "num_agent_steps_trained": 424500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2832, "num_samples_added_to_queue": 424800, "learner_queue": {"size_count": 1415, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.846, "learner_load_time_ms": 0.339, "learner_load_wait_time_ms": 1045.57, "learner_dequeue_time_ms": 8604.193}}, "env_runners": {"episode_reward_max": 592.3544444444444, "episode_reward_min": 550.0605555555558, "episode_reward_mean": 571.9782555555554, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 550.0605555555558}, "policy_reward_max": {"default_policy": 592.3544444444444}, "policy_reward_mean": {"default_policy": 571.9782555555554}, "custom_metrics": {"num_consolidated_mean": 2.7301000000000006, "num_consolidated_min": 2.56, "num_consolidated_max": 2.85, "num_overloaded_mean": 0.0037, "num_overloaded_min": 0.0, "num_overloaded_max": 0.03, "num_moves_mean": 2.1891, "num_moves_min": 1.56, "num_moves_max": 2.73, "mean_accuracy_mean": 39.42052666666665, "mean_accuracy_min": 39.30133333333332, "mean_accuracy_max": 39.554666666666655, "num_model_switches_mean": 1.1309999999999998, "num_model_switches_min": 0.68, "num_model_switches_max": 1.68, "num_slav_mean": 0.00043550000000000007, "num_slav_min": 3.3333333333333335e-05, "num_slav_max": 0.0011666666666666665, "mean_cluster_cpu_util_mean": 0.5113610073867716, "mean_cluster_cpu_util_min": 0.49669882847814245, "mean_cluster_cpu_util_max": 0.5232506859223873, "mean_cluster_mem_util_mean": 0.3117242439471569, "mean_cluster_mem_util_min": 0.30586082892017563, "mean_cluster_mem_util_max": 0.3166071559530985, "reward_consolidation_mean_mean": 3.776805555555556, "reward_consolidation_mean_min": 3.555555555555556, "reward_consolidation_mean_max": 3.958333333333334, "reward_illegal_mean_mean": -0.006166666666666667, "reward_illegal_mean_min": -0.05, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9636603333333331, "reward_accuracy_mean_min": 1.9167166666666666, "reward_accuracy_mean_max": 1.9777333333333331, "reward_sla_mean_mean": -0.014516666666666667, "reward_sla_mean_min": -0.03888888888888888, "reward_sla_mean_max": -0.0011111111111111111, "reward_consolidation_sum_mean": 377.6805555555557, "reward_consolidation_sum_min": 355.5555555555556, "reward_consolidation_sum_max": 395.83333333333337, "reward_illegal_sum_mean": -0.6166666666666666, "reward_illegal_sum_min": -5.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 196.3660333333333, "reward_accuracy_sum_min": 191.67166666666665, "reward_accuracy_sum_max": 197.7733333333333, "reward_sla_sum_mean": -1.4516666666666669, "reward_sla_sum_min": -3.8888888888888884, "reward_sla_sum_max": -0.11111111111111112, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4549.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [572.0294444444444, 559.5605555555555, 569.0283333333331, 560.2733333333332, 573.21, 550.0605555555558, 570.4083333333334, 564.8138888888888, 570.377222222222, 572.0594444444446, 575.5677777777779, 571.3550000000001, 570.132777777778, 571.8377777777778, 568.0605555555554, 557.8699999999999, 554.1705555555557, 558.3461111111112, 569.4177777777775, 564.1000000000001, 581.0366666666665, 576.1555555555553, 551.6872222222222, 558.91, 570.2977777777776, 576.0677777777779, 576.4733333333332, 558.3555555555555, 568.4972222222221, 575.4811111111111, 565.2038888888887, 556.0133333333332, 585.5366666666667, 566.3772222222221, 571.908888888889, 575.8461111111111, 557.4261111111109, 568.4644444444444, 566.2105555555554, 566.536111111111, 574.2033333333333, 558.2655555555557, 575.6555555555552, 573.9583333333333, 571.5138888888887, 574.6083333333335, 569.3144444444445, 568.2994444444444, 572.4027777777779, 566.7994444444445, 582.6800000000002, 578.7994444444447, 581.251111111111, 592.3544444444444, 574.2349999999999, 566.0683333333334, 571.2977777777774, 574.0138888888887, 571.3638888888889, 577.7994444444445, 579.473888888889, 568.6394444444443, 566.0838888888886, 565.6722222222223, 579.5444444444445, 562.3149999999998, 579.6322222222223, 570.5611111111112, 582.5216666666668, 569.625, 575.9033333333332, 579.2672222222219, 579.4416666666666, 569.5938888888887, 575.745, 582.2361111111112, 586.2683333333333, 574.8399999999998, 579.7605555555555, 586.545, 577.728888888889, 578.0699999999999, 564.49, 572.8394444444444, 586.1411111111113, 566.0461111111111, 580.2366666666666, 569.9099999999999, 571.4988888888888, 575.1333333333332, 577.8477777777778, 587.7511111111113, 575.7827777777778, 576.7444444444442, 576.6411111111111, 570.9266666666666, 567.0455555555553, 582.5927777777779, 582.8399999999997, 573.8394444444443], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [572.0294444444444, 559.5605555555555, 569.0283333333331, 560.2733333333332, 573.21, 550.0605555555558, 570.4083333333334, 564.8138888888888, 570.377222222222, 572.0594444444446, 575.5677777777779, 571.3550000000001, 570.132777777778, 571.8377777777778, 568.0605555555554, 557.8699999999999, 554.1705555555557, 558.3461111111112, 569.4177777777775, 564.1000000000001, 581.0366666666665, 576.1555555555553, 551.6872222222222, 558.91, 570.2977777777776, 576.0677777777779, 576.4733333333332, 558.3555555555555, 568.4972222222221, 575.4811111111111, 565.2038888888887, 556.0133333333332, 585.5366666666667, 566.3772222222221, 571.908888888889, 575.8461111111111, 557.4261111111109, 568.4644444444444, 566.2105555555554, 566.536111111111, 574.2033333333333, 558.2655555555557, 575.6555555555552, 573.9583333333333, 571.5138888888887, 574.6083333333335, 569.3144444444445, 568.2994444444444, 572.4027777777779, 566.7994444444445, 582.6800000000002, 578.7994444444447, 581.251111111111, 592.3544444444444, 574.2349999999999, 566.0683333333334, 571.2977777777774, 574.0138888888887, 571.3638888888889, 577.7994444444445, 579.473888888889, 568.6394444444443, 566.0838888888886, 565.6722222222223, 579.5444444444445, 562.3149999999998, 579.6322222222223, 570.5611111111112, 582.5216666666668, 569.625, 575.9033333333332, 579.2672222222219, 579.4416666666666, 569.5938888888887, 575.745, 582.2361111111112, 586.2683333333333, 574.8399999999998, 579.7605555555555, 586.545, 577.728888888889, 578.0699999999999, 564.49, 572.8394444444444, 586.1411111111113, 566.0461111111111, 580.2366666666666, 569.9099999999999, 571.4988888888888, 575.1333333333332, 577.8477777777778, 587.7511111111113, 575.7827777777778, 576.7444444444442, 576.6411111111111, 570.9266666666666, 567.0455555555553, 582.5927777777779, 582.8399999999997, 573.8394444444443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19893058512277548, "mean_inference_ms": 1.8078420581606027, "mean_action_processing_ms": 0.07534417446243448, "mean_env_wait_ms": 1.2263940938987046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005408763885498047, "StateBufferConnector_ms": 0.0030930042266845703, "ViewRequirementAgentConnector_ms": 0.07195019721984863}, "num_episodes": 30, "episode_return_max": 592.3544444444444, "episode_return_min": 550.0605555555558, "episode_return_mean": 571.9782555555554, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 424800, "num_agent_steps_trained": 424500, "num_env_steps_sampled": 424800, "num_env_steps_trained": 424500, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 270.31882052759016, "num_env_steps_trained_throughput_per_sec": 256.0915141840328, "timesteps_total": 424800, "num_env_steps_sampled_lifetime": 424800, "num_agent_steps_sampled_lifetime": 424800, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 424800, "timers": {"training_iteration_time_ms": 10431.452, "restore_workers_time_ms": 0.015, "training_step_time_ms": 559.304, "sample_time_ms": 543.452, "synch_weights_time_ms": 14.355}, "counters": {"num_env_steps_sampled": 424800, "num_env_steps_trained": 424500, "num_agent_steps_sampled": 424800, "num_agent_steps_trained": 424500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2832, "num_samples_added_to_queue": 424800}, "done": false, "training_iteration": 143, "trial_id": "0313d_00000", "date": "2024-10-10_22-06-02", "timestamp": 1728594362, "time_this_iter_s": 10.55496096611023, "time_total_s": 1473.2975280284882, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42fa3e50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1473.2975280284882, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 15.066666666666665, "ram_util_percent": 77.31333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 67700.9453125, "policy_loss": 67276.0078125, "entropy": 8.770109176635742, "entropy_coeff": 0.01, "var_gnorm": 16.70743179321289, "vf_loss": 451247.96875, "vf_explained_var": 0.27281683683395386}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1425.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 427650, "num_env_steps_trained": 427500, "num_agent_steps_sampled": 427650, "num_agent_steps_trained": 427500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2851, "num_samples_added_to_queue": 427500, "learner_queue": {"size_count": 1425, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.61, "learner_load_time_ms": 0.328, "learner_load_wait_time_ms": 1027.265, "learner_dequeue_time_ms": 8635.933}}, "env_runners": {"episode_reward_max": 596.616111111111, "episode_reward_min": 556.0133333333332, "episode_reward_mean": 575.5288777777778, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 556.0133333333332}, "policy_reward_max": {"default_policy": 596.616111111111}, "policy_reward_mean": {"default_policy": 575.5288777777778}, "custom_metrics": {"num_consolidated_mean": 2.7510000000000003, "num_consolidated_min": 2.62, "num_consolidated_max": 2.88, "num_overloaded_mean": 0.0026, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 2.0743, "num_moves_min": 1.56, "num_moves_max": 2.61, "mean_accuracy_mean": 39.38613666666666, "mean_accuracy_min": 39.21899999999998, "mean_accuracy_max": 39.54199999999998, "num_model_switches_mean": 1.0342, "num_model_switches_min": 0.68, "num_model_switches_max": 1.46, "num_slav_mean": 0.00045233333333333334, "num_slav_min": 3.3333333333333335e-05, "num_slav_max": 0.0018166666666666665, "mean_cluster_cpu_util_mean": 0.5130260438097536, "mean_cluster_cpu_util_min": 0.4981157745120875, "mean_cluster_cpu_util_max": 0.5281742295407521, "mean_cluster_mem_util_mean": 0.31222610615258756, "mean_cluster_mem_util_min": 0.30613845959269786, "mean_cluster_mem_util_max": 0.31701957127787816, "reward_consolidation_mean_mean": 3.8105555555555566, "reward_consolidation_mean_min": 3.6388888888888893, "reward_consolidation_mean_max": 4.0, "reward_illegal_mean_mean": -0.004333333333333333, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9641443333333333, "reward_accuracy_mean_min": 1.9296666666666664, "reward_accuracy_mean_max": 1.9770999999999999, "reward_sla_mean_mean": -0.015077777777777777, "reward_sla_mean_min": -0.06055555555555556, "reward_sla_mean_max": -0.0011111111111111111, "reward_consolidation_sum_mean": 381.05555555555554, "reward_consolidation_sum_min": 363.8888888888889, "reward_consolidation_sum_max": 400.0, "reward_illegal_sum_mean": -0.43333333333333324, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 196.41443333333333, "reward_accuracy_sum_min": 192.96666666666664, "reward_accuracy_sum_max": 197.70999999999998, "reward_sla_sum_mean": -1.507777777777778, "reward_sla_sum_min": -6.055555555555555, "reward_sla_sum_max": -0.11111111111111112, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3344.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [558.3555555555555, 568.4972222222221, 575.4811111111111, 565.2038888888887, 556.0133333333332, 585.5366666666667, 566.3772222222221, 571.908888888889, 575.8461111111111, 557.4261111111109, 568.4644444444444, 566.2105555555554, 566.536111111111, 574.2033333333333, 558.2655555555557, 575.6555555555552, 573.9583333333333, 571.5138888888887, 574.6083333333335, 569.3144444444445, 568.2994444444444, 572.4027777777779, 566.7994444444445, 582.6800000000002, 578.7994444444447, 581.251111111111, 592.3544444444444, 574.2349999999999, 566.0683333333334, 571.2977777777774, 574.0138888888887, 571.3638888888889, 577.7994444444445, 579.473888888889, 568.6394444444443, 566.0838888888886, 565.6722222222223, 579.5444444444445, 562.3149999999998, 579.6322222222223, 570.5611111111112, 582.5216666666668, 569.625, 575.9033333333332, 579.2672222222219, 579.4416666666666, 569.5938888888887, 575.745, 582.2361111111112, 586.2683333333333, 574.8399999999998, 579.7605555555555, 586.545, 577.728888888889, 578.0699999999999, 564.49, 572.8394444444444, 586.1411111111113, 566.0461111111111, 580.2366666666666, 569.9099999999999, 571.4988888888888, 575.1333333333332, 577.8477777777778, 587.7511111111113, 575.7827777777778, 576.7444444444442, 576.6411111111111, 570.9266666666666, 567.0455555555553, 582.5927777777779, 582.8399999999997, 573.8394444444443, 579.4977777777777, 583.5766666666666, 571.5777777777779, 583.2600000000003, 576.0944444444443, 578.4105555555553, 572.4344444444444, 567.2194444444443, 573.7283333333334, 583.221111111111, 582.2205555555555, 582.1566666666666, 593.1727777777777, 590.1894444444445, 576.5855555555551, 596.616111111111, 581.1327777777778, 581.4283333333332, 590.9422222222221, 580.4111111111112, 563.3716666666668, 577.7127777777778, 579.4022222222221, 585.3783333333332, 572.0772222222223, 587.7922222222221, 578.7594444444443], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [558.3555555555555, 568.4972222222221, 575.4811111111111, 565.2038888888887, 556.0133333333332, 585.5366666666667, 566.3772222222221, 571.908888888889, 575.8461111111111, 557.4261111111109, 568.4644444444444, 566.2105555555554, 566.536111111111, 574.2033333333333, 558.2655555555557, 575.6555555555552, 573.9583333333333, 571.5138888888887, 574.6083333333335, 569.3144444444445, 568.2994444444444, 572.4027777777779, 566.7994444444445, 582.6800000000002, 578.7994444444447, 581.251111111111, 592.3544444444444, 574.2349999999999, 566.0683333333334, 571.2977777777774, 574.0138888888887, 571.3638888888889, 577.7994444444445, 579.473888888889, 568.6394444444443, 566.0838888888886, 565.6722222222223, 579.5444444444445, 562.3149999999998, 579.6322222222223, 570.5611111111112, 582.5216666666668, 569.625, 575.9033333333332, 579.2672222222219, 579.4416666666666, 569.5938888888887, 575.745, 582.2361111111112, 586.2683333333333, 574.8399999999998, 579.7605555555555, 586.545, 577.728888888889, 578.0699999999999, 564.49, 572.8394444444444, 586.1411111111113, 566.0461111111111, 580.2366666666666, 569.9099999999999, 571.4988888888888, 575.1333333333332, 577.8477777777778, 587.7511111111113, 575.7827777777778, 576.7444444444442, 576.6411111111111, 570.9266666666666, 567.0455555555553, 582.5927777777779, 582.8399999999997, 573.8394444444443, 579.4977777777777, 583.5766666666666, 571.5777777777779, 583.2600000000003, 576.0944444444443, 578.4105555555553, 572.4344444444444, 567.2194444444443, 573.7283333333334, 583.221111111111, 582.2205555555555, 582.1566666666666, 593.1727777777777, 590.1894444444445, 576.5855555555551, 596.616111111111, 581.1327777777778, 581.4283333333332, 590.9422222222221, 580.4111111111112, 563.3716666666668, 577.7127777777778, 579.4022222222221, 585.3783333333332, 572.0772222222223, 587.7922222222221, 578.7594444444443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19898946163201814, "mean_inference_ms": 1.8068917526791057, "mean_action_processing_ms": 0.07535320697423224, "mean_env_wait_ms": 1.2264123866965468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005303144454956055, "StateBufferConnector_ms": 0.0030431747436523438, "ViewRequirementAgentConnector_ms": 0.07050871849060059}, "num_episodes": 27, "episode_return_max": 596.616111111111, "episode_return_min": 556.0133333333332, "episode_return_mean": 575.5288777777778, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 427650, "num_agent_steps_trained": 427500, "num_env_steps_sampled": 427650, "num_env_steps_trained": 427500, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 283.5621856624229, "num_env_steps_trained_throughput_per_sec": 298.48651122360303, "timesteps_total": 427650, "num_env_steps_sampled_lifetime": 427650, "num_agent_steps_sampled_lifetime": 427650, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 427650, "timers": {"training_iteration_time_ms": 10398.267, "restore_workers_time_ms": 0.013, "training_step_time_ms": 521.555, "sample_time_ms": 506.958, "synch_weights_time_ms": 13.062}, "counters": {"num_env_steps_sampled": 427650, "num_env_steps_trained": 427500, "num_agent_steps_sampled": 427650, "num_agent_steps_trained": 427500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2851, "num_samples_added_to_queue": 427500}, "done": false, "training_iteration": 144, "trial_id": "0313d_00000", "date": "2024-10-10_22-06-12", "timestamp": 1728594372, "time_this_iter_s": 10.061380386352539, "time_total_s": 1483.3589084148407, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c171c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1483.3589084148407, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 14.273333333333335, "ram_util_percent": 77.45333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 66225.921875, "policy_loss": 65832.171875, "entropy": 8.9420747756958, "entropy_coeff": 0.01, "var_gnorm": 16.713485717773438, "vf_loss": 420574.5625, "vf_explained_var": 0.2851073145866394}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1435.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 430650, "num_env_steps_trained": 430500, "num_agent_steps_sampled": 430650, "num_agent_steps_trained": 430500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2871, "num_samples_added_to_queue": 430500, "learner_queue": {"size_count": 1435, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 46.662, "learner_load_time_ms": 0.479, "learner_load_wait_time_ms": 978.367, "learner_dequeue_time_ms": 8572.043}}, "env_runners": {"episode_reward_max": 596.616111111111, "episode_reward_min": 552.1177777777776, "episode_reward_mean": 576.5805444444445, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 552.1177777777776}, "policy_reward_max": {"default_policy": 596.616111111111}, "policy_reward_mean": {"default_policy": 576.5805444444445}, "custom_metrics": {"num_consolidated_mean": 2.7622000000000004, "num_consolidated_min": 2.65, "num_consolidated_max": 2.88, "num_overloaded_mean": 0.0031000000000000003, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 2.0157999999999996, "num_moves_min": 1.56, "num_moves_max": 2.51, "mean_accuracy_mean": 39.35522999999998, "mean_accuracy_min": 39.21899999999998, "mean_accuracy_max": 39.472333333333324, "num_model_switches_mean": 0.9537000000000002, "num_model_switches_min": 0.64, "num_model_switches_max": 1.41, "num_slav_mean": 0.00044116666666666664, "num_slav_min": 6.666666666666667e-05, "num_slav_max": 0.0018166666666666665, "mean_cluster_cpu_util_mean": 0.5142694259843273, "mean_cluster_cpu_util_min": 0.5038940402570143, "mean_cluster_cpu_util_max": 0.5281742295407521, "mean_cluster_mem_util_mean": 0.3126887254226585, "mean_cluster_mem_util_min": 0.3078808512012399, "mean_cluster_mem_util_max": 0.3175044158486179, "reward_consolidation_mean_mean": 3.8240277777777782, "reward_consolidation_mean_min": 3.666666666666667, "reward_consolidation_mean_max": 4.0, "reward_illegal_mean_mean": -0.0051666666666666675, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.961644333333333, "reward_accuracy_mean_min": 1.9284000000000001, "reward_accuracy_mean_max": 1.9736166666666666, "reward_sla_mean_mean": -0.0147, "reward_sla_mean_min": -0.06055555555555556, "reward_sla_mean_max": -0.0022222222222222222, "reward_consolidation_sum_mean": 382.4027777777778, "reward_consolidation_sum_min": 366.6666666666667, "reward_consolidation_sum_max": 400.0, "reward_illegal_sum_mean": -0.5166666666666666, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 196.1644333333334, "reward_accuracy_sum_min": 192.84, "reward_accuracy_sum_max": 197.36166666666665, "reward_sla_sum_mean": -1.47, "reward_sla_sum_min": -6.055555555555555, "reward_sla_sum_max": -0.22222222222222224, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2165.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [574.0138888888887, 571.3638888888889, 577.7994444444445, 579.473888888889, 568.6394444444443, 566.0838888888886, 565.6722222222223, 579.5444444444445, 562.3149999999998, 579.6322222222223, 570.5611111111112, 582.5216666666668, 569.625, 575.9033333333332, 579.2672222222219, 579.4416666666666, 569.5938888888887, 575.745, 582.2361111111112, 586.2683333333333, 574.8399999999998, 579.7605555555555, 586.545, 577.728888888889, 578.0699999999999, 564.49, 572.8394444444444, 586.1411111111113, 566.0461111111111, 580.2366666666666, 569.9099999999999, 571.4988888888888, 575.1333333333332, 577.8477777777778, 587.7511111111113, 575.7827777777778, 576.7444444444442, 576.6411111111111, 570.9266666666666, 567.0455555555553, 582.5927777777779, 582.8399999999997, 573.8394444444443, 579.4977777777777, 583.5766666666666, 571.5777777777779, 583.2600000000003, 576.0944444444443, 578.4105555555553, 572.4344444444444, 567.2194444444443, 573.7283333333334, 583.221111111111, 582.2205555555555, 582.1566666666666, 593.1727777777777, 590.1894444444445, 576.5855555555551, 596.616111111111, 581.1327777777778, 581.4283333333332, 590.9422222222221, 580.4111111111112, 563.3716666666668, 577.7127777777778, 579.4022222222221, 585.3783333333332, 572.0772222222223, 587.7922222222221, 578.7594444444443, 577.6644444444445, 575.7044444444447, 568.3955555555553, 576.1500000000001, 573.411111111111, 588.9427777777779, 578.8394444444446, 569.228888888889, 577.9033333333331, 568.7527777777776, 578.7211111111112, 575.1177777777774, 572.3866666666667, 573.4516666666665, 575.2294444444444, 580.6972222222221, 585.743888888889, 569.1655555555554, 552.1177777777776, 568.6094444444441, 581.4027777777778, 573.6811111111108, 583.4822222222222, 566.895, 576.8394444444443, 581.1005555555553, 569.1016666666666, 565.1966666666667, 574.307222222222, 580.491111111111], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [574.0138888888887, 571.3638888888889, 577.7994444444445, 579.473888888889, 568.6394444444443, 566.0838888888886, 565.6722222222223, 579.5444444444445, 562.3149999999998, 579.6322222222223, 570.5611111111112, 582.5216666666668, 569.625, 575.9033333333332, 579.2672222222219, 579.4416666666666, 569.5938888888887, 575.745, 582.2361111111112, 586.2683333333333, 574.8399999999998, 579.7605555555555, 586.545, 577.728888888889, 578.0699999999999, 564.49, 572.8394444444444, 586.1411111111113, 566.0461111111111, 580.2366666666666, 569.9099999999999, 571.4988888888888, 575.1333333333332, 577.8477777777778, 587.7511111111113, 575.7827777777778, 576.7444444444442, 576.6411111111111, 570.9266666666666, 567.0455555555553, 582.5927777777779, 582.8399999999997, 573.8394444444443, 579.4977777777777, 583.5766666666666, 571.5777777777779, 583.2600000000003, 576.0944444444443, 578.4105555555553, 572.4344444444444, 567.2194444444443, 573.7283333333334, 583.221111111111, 582.2205555555555, 582.1566666666666, 593.1727777777777, 590.1894444444445, 576.5855555555551, 596.616111111111, 581.1327777777778, 581.4283333333332, 590.9422222222221, 580.4111111111112, 563.3716666666668, 577.7127777777778, 579.4022222222221, 585.3783333333332, 572.0772222222223, 587.7922222222221, 578.7594444444443, 577.6644444444445, 575.7044444444447, 568.3955555555553, 576.1500000000001, 573.411111111111, 588.9427777777779, 578.8394444444446, 569.228888888889, 577.9033333333331, 568.7527777777776, 578.7211111111112, 575.1177777777774, 572.3866666666667, 573.4516666666665, 575.2294444444444, 580.6972222222221, 585.743888888889, 569.1655555555554, 552.1177777777776, 568.6094444444441, 581.4027777777778, 573.6811111111108, 583.4822222222222, 566.895, 576.8394444444443, 581.1005555555553, 569.1016666666666, 565.1966666666667, 574.307222222222, 580.491111111111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19909797403142457, "mean_inference_ms": 1.8087640130469662, "mean_action_processing_ms": 0.07538999411446069, "mean_env_wait_ms": 1.226927194891657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00486302375793457, "StateBufferConnector_ms": 0.002957582473754883, "ViewRequirementAgentConnector_ms": 0.06748127937316895}, "num_episodes": 30, "episode_return_max": 596.616111111111, "episode_return_min": 552.1177777777776, "episode_return_mean": 576.5805444444445, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 430650, "num_agent_steps_trained": 430500, "num_env_steps_sampled": 430650, "num_env_steps_trained": 430500, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 293.78519834772163, "num_env_steps_trained_throughput_per_sec": 293.78519834772163, "timesteps_total": 430650, "num_env_steps_sampled_lifetime": 430650, "num_agent_steps_sampled_lifetime": 430650, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 430650, "timers": {"training_iteration_time_ms": 10419.062, "restore_workers_time_ms": 0.011, "training_step_time_ms": 510.175, "sample_time_ms": 495.887, "synch_weights_time_ms": 12.88}, "counters": {"num_env_steps_sampled": 430650, "num_env_steps_trained": 430500, "num_agent_steps_sampled": 430650, "num_agent_steps_trained": 430500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2871, "num_samples_added_to_queue": 430500}, "done": false, "training_iteration": 145, "trial_id": "0313d_00000", "date": "2024-10-10_22-06-22", "timestamp": 1728594382, "time_this_iter_s": 10.226832628250122, "time_total_s": 1493.5857410430908, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a5fc0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1493.5857410430908, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 10.67857142857143, "ram_util_percent": 77.32857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 67630.0078125, "policy_loss": 67266.515625, "entropy": 9.022608757019043, "entropy_coeff": 0.01, "var_gnorm": 16.71891212463379, "vf_loss": 390559.90625, "vf_explained_var": 0.3025081753730774}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1445.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 433650, "num_env_steps_trained": 433500, "num_agent_steps_sampled": 433650, "num_agent_steps_trained": 433500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2891, "num_samples_added_to_queue": 433500, "learner_queue": {"size_count": 1445, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.183, "learner_load_time_ms": 0.466, "learner_load_wait_time_ms": 977.656, "learner_dequeue_time_ms": 8556.42}}, "env_runners": {"episode_reward_max": 596.616111111111, "episode_reward_min": 552.1177777777776, "episode_reward_mean": 576.5153611111109, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 552.1177777777776}, "policy_reward_max": {"default_policy": 596.616111111111}, "policy_reward_mean": {"default_policy": 576.5153611111109}, "custom_metrics": {"num_consolidated_mean": 2.7608000000000006, "num_consolidated_min": 2.64, "num_consolidated_max": 2.88, "num_overloaded_mean": 0.0027, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 2.0710000000000006, "num_moves_min": 1.56, "num_moves_max": 2.56, "mean_accuracy_mean": 39.34978333333331, "mean_accuracy_min": 39.21899999999998, "mean_accuracy_max": 39.43433333333332, "num_model_switches_mean": 0.9375000000000003, "num_model_switches_min": 0.64, "num_model_switches_max": 1.33, "num_slav_mean": 0.00048416666666666665, "num_slav_min": 6.666666666666667e-05, "num_slav_max": 0.0018833333333333332, "mean_cluster_cpu_util_mean": 0.5147261007661992, "mean_cluster_cpu_util_min": 0.5038940402570143, "mean_cluster_cpu_util_max": 0.5281742295407521, "mean_cluster_mem_util_mean": 0.31273162033927493, "mean_cluster_mem_util_min": 0.3078808512012399, "mean_cluster_mem_util_max": 0.3175044158486179, "reward_consolidation_mean_mean": 3.823611111111111, "reward_consolidation_mean_min": 3.666666666666667, "reward_consolidation_mean_max": 4.0, "reward_illegal_mean_mean": -0.0045000000000000005, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.962159166666667, "reward_accuracy_mean_min": 1.9284000000000001, "reward_accuracy_mean_max": 1.9717166666666666, "reward_sla_mean_mean": -0.016116666666666665, "reward_sla_mean_min": -0.06277777777777777, "reward_sla_mean_max": -0.0022222222222222222, "reward_consolidation_sum_mean": 382.36111111111126, "reward_consolidation_sum_min": 366.6666666666667, "reward_consolidation_sum_max": 400.0, "reward_illegal_sum_mean": -0.44999999999999996, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 196.2159166666666, "reward_accuracy_sum_min": 192.84, "reward_accuracy_sum_max": 197.17166666666665, "reward_sla_sum_mean": -1.611666666666666, "reward_sla_sum_min": -6.277777777777777, "reward_sla_sum_max": -0.22222222222222224, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2457.0, "global_timestep_min": 300, "global_timestep_max": 4100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [569.9099999999999, 571.4988888888888, 575.1333333333332, 577.8477777777778, 587.7511111111113, 575.7827777777778, 576.7444444444442, 576.6411111111111, 570.9266666666666, 567.0455555555553, 582.5927777777779, 582.8399999999997, 573.8394444444443, 579.4977777777777, 583.5766666666666, 571.5777777777779, 583.2600000000003, 576.0944444444443, 578.4105555555553, 572.4344444444444, 567.2194444444443, 573.7283333333334, 583.221111111111, 582.2205555555555, 582.1566666666666, 593.1727777777777, 590.1894444444445, 576.5855555555551, 596.616111111111, 581.1327777777778, 581.4283333333332, 590.9422222222221, 580.4111111111112, 563.3716666666668, 577.7127777777778, 579.4022222222221, 585.3783333333332, 572.0772222222223, 587.7922222222221, 578.7594444444443, 577.6644444444445, 575.7044444444447, 568.3955555555553, 576.1500000000001, 573.411111111111, 588.9427777777779, 578.8394444444446, 569.228888888889, 577.9033333333331, 568.7527777777776, 578.7211111111112, 575.1177777777774, 572.3866666666667, 573.4516666666665, 575.2294444444444, 580.6972222222221, 585.743888888889, 569.1655555555554, 552.1177777777776, 568.6094444444441, 581.4027777777778, 573.6811111111108, 583.4822222222222, 566.895, 576.8394444444443, 581.1005555555553, 569.1016666666666, 565.1966666666667, 574.307222222222, 580.491111111111, 566.7283333333335, 582.0066666666664, 565.6255555555556, 572.2599999999998, 584.9744444444443, 580.6488888888889, 585.0216666666668, 582.3466666666667, 574.1894444444445, 579.3238888888889, 580.7194444444443, 574.8077777777779, 588.6249999999999, 565.5455555555558, 570.791666666667, 575.3155555555554, 581.433888888889, 575.9911111111111, 574.0866666666666, 581.0766666666667, 568.8944444444444, 575.2677777777777, 560.006111111111, 558.5383333333332, 572.9666666666666, 573.3955555555553, 580.227222222222, 566.9899999999999, 588.6261111111113, 569.4499999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [569.9099999999999, 571.4988888888888, 575.1333333333332, 577.8477777777778, 587.7511111111113, 575.7827777777778, 576.7444444444442, 576.6411111111111, 570.9266666666666, 567.0455555555553, 582.5927777777779, 582.8399999999997, 573.8394444444443, 579.4977777777777, 583.5766666666666, 571.5777777777779, 583.2600000000003, 576.0944444444443, 578.4105555555553, 572.4344444444444, 567.2194444444443, 573.7283333333334, 583.221111111111, 582.2205555555555, 582.1566666666666, 593.1727777777777, 590.1894444444445, 576.5855555555551, 596.616111111111, 581.1327777777778, 581.4283333333332, 590.9422222222221, 580.4111111111112, 563.3716666666668, 577.7127777777778, 579.4022222222221, 585.3783333333332, 572.0772222222223, 587.7922222222221, 578.7594444444443, 577.6644444444445, 575.7044444444447, 568.3955555555553, 576.1500000000001, 573.411111111111, 588.9427777777779, 578.8394444444446, 569.228888888889, 577.9033333333331, 568.7527777777776, 578.7211111111112, 575.1177777777774, 572.3866666666667, 573.4516666666665, 575.2294444444444, 580.6972222222221, 585.743888888889, 569.1655555555554, 552.1177777777776, 568.6094444444441, 581.4027777777778, 573.6811111111108, 583.4822222222222, 566.895, 576.8394444444443, 581.1005555555553, 569.1016666666666, 565.1966666666667, 574.307222222222, 580.491111111111, 566.7283333333335, 582.0066666666664, 565.6255555555556, 572.2599999999998, 584.9744444444443, 580.6488888888889, 585.0216666666668, 582.3466666666667, 574.1894444444445, 579.3238888888889, 580.7194444444443, 574.8077777777779, 588.6249999999999, 565.5455555555558, 570.791666666667, 575.3155555555554, 581.433888888889, 575.9911111111111, 574.0866666666666, 581.0766666666667, 568.8944444444444, 575.2677777777777, 560.006111111111, 558.5383333333332, 572.9666666666666, 573.3955555555553, 580.227222222222, 566.9899999999999, 588.6261111111113, 569.4499999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19912148061292814, "mean_inference_ms": 1.8087209499205517, "mean_action_processing_ms": 0.07539466449609973, "mean_env_wait_ms": 1.2269398602441448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004224061965942383, "StateBufferConnector_ms": 0.002856016159057617, "ViewRequirementAgentConnector_ms": 0.0649559497833252}, "num_episodes": 30, "episode_return_max": 596.616111111111, "episode_return_min": 552.1177777777776, "episode_return_mean": 576.5153611111109, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 433650, "num_agent_steps_trained": 433500, "num_env_steps_sampled": 433650, "num_env_steps_trained": 433500, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 291.0880962087702, "num_env_steps_trained_throughput_per_sec": 291.0880962087702, "timesteps_total": 433650, "num_env_steps_sampled_lifetime": 433650, "num_agent_steps_sampled_lifetime": 433650, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 433650, "timers": {"training_iteration_time_ms": 10408.373, "restore_workers_time_ms": 0.012, "training_step_time_ms": 540.945, "sample_time_ms": 525.214, "synch_weights_time_ms": 14.231}, "counters": {"num_env_steps_sampled": 433650, "num_env_steps_trained": 433500, "num_agent_steps_sampled": 433650, "num_agent_steps_trained": 433500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2891, "num_samples_added_to_queue": 433500}, "done": false, "training_iteration": 146, "trial_id": "0313d_00000", "date": "2024-10-10_22-06-33", "timestamp": 1728594393, "time_this_iter_s": 10.316573858261108, "time_total_s": 1503.902314901352, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a6110>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1503.902314901352, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 11.573333333333334, "ram_util_percent": 77.54666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 64940.34765625, "policy_loss": 64607.82421875, "entropy": 9.145356178283691, "entropy_coeff": 0.01, "var_gnorm": 16.720726013183594, "vf_loss": 359961.5625, "vf_explained_var": 0.3207838535308838}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1454.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 436350, "num_env_steps_trained": 436200, "num_agent_steps_sampled": 436350, "num_agent_steps_trained": 436200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2909, "num_samples_added_to_queue": 436200, "learner_queue": {"size_count": 1454, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.515, "learner_load_time_ms": 0.469, "learner_load_wait_time_ms": 1071.34, "learner_dequeue_time_ms": 8586.338}}, "env_runners": {"episode_reward_max": 596.616111111111, "episode_reward_min": 552.1177777777776, "episode_reward_mean": 575.2325666666665, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 552.1177777777776}, "policy_reward_max": {"default_policy": 596.616111111111}, "policy_reward_mean": {"default_policy": 575.2325666666665}, "custom_metrics": {"num_consolidated_mean": 2.7577000000000003, "num_consolidated_min": 2.64, "num_consolidated_max": 2.88, "num_overloaded_mean": 0.0037000000000000006, "num_overloaded_min": 0.0, "num_overloaded_max": 0.03, "num_moves_mean": 2.1675, "num_moves_min": 1.73, "num_moves_max": 2.68, "mean_accuracy_mean": 39.34724999999998, "mean_accuracy_min": 39.21899999999998, "mean_accuracy_max": 39.44066666666665, "num_model_switches_mean": 0.9527, "num_model_switches_min": 0.64, "num_model_switches_max": 1.33, "num_slav_mean": 0.0004981666666666666, "num_slav_min": 6.666666666666667e-05, "num_slav_max": 0.0018833333333333332, "mean_cluster_cpu_util_mean": 0.5149081355631632, "mean_cluster_cpu_util_min": 0.5043704797920079, "mean_cluster_cpu_util_max": 0.5281742295407521, "mean_cluster_mem_util_mean": 0.3128127882312208, "mean_cluster_mem_util_min": 0.30811704017049857, "mean_cluster_mem_util_max": 0.3175044158486179, "reward_consolidation_mean_mean": 3.815, "reward_consolidation_mean_min": 3.666666666666667, "reward_consolidation_mean_max": 4.0, "reward_illegal_mean_mean": -0.006166666666666668, "reward_illegal_mean_min": -0.05, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9600756666666665, "reward_accuracy_mean_min": 1.9062666666666663, "reward_accuracy_mean_max": 1.972033333333333, "reward_sla_mean_mean": -0.016583333333333335, "reward_sla_mean_min": -0.06277777777777777, "reward_sla_mean_max": -0.0022222222222222222, "reward_consolidation_sum_mean": 381.50000000000006, "reward_consolidation_sum_min": 366.6666666666667, "reward_consolidation_sum_max": 400.0, "reward_illegal_sum_mean": -0.6166666666666666, "reward_illegal_sum_min": -5.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 196.00756666666663, "reward_accuracy_sum_min": 190.62666666666664, "reward_accuracy_sum_max": 197.20333333333332, "reward_sla_sum_mean": -1.6583333333333334, "reward_sla_sum_min": -6.277777777777777, "reward_sla_sum_max": -0.22222222222222224, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3363.0, "global_timestep_min": 1300, "global_timestep_max": 5000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [576.5855555555551, 596.616111111111, 581.1327777777778, 581.4283333333332, 590.9422222222221, 580.4111111111112, 563.3716666666668, 577.7127777777778, 579.4022222222221, 585.3783333333332, 572.0772222222223, 587.7922222222221, 578.7594444444443, 577.6644444444445, 575.7044444444447, 568.3955555555553, 576.1500000000001, 573.411111111111, 588.9427777777779, 578.8394444444446, 569.228888888889, 577.9033333333331, 568.7527777777776, 578.7211111111112, 575.1177777777774, 572.3866666666667, 573.4516666666665, 575.2294444444444, 580.6972222222221, 585.743888888889, 569.1655555555554, 552.1177777777776, 568.6094444444441, 581.4027777777778, 573.6811111111108, 583.4822222222222, 566.895, 576.8394444444443, 581.1005555555553, 569.1016666666666, 565.1966666666667, 574.307222222222, 580.491111111111, 566.7283333333335, 582.0066666666664, 565.6255555555556, 572.2599999999998, 584.9744444444443, 580.6488888888889, 585.0216666666668, 582.3466666666667, 574.1894444444445, 579.3238888888889, 580.7194444444443, 574.8077777777779, 588.6249999999999, 565.5455555555558, 570.791666666667, 575.3155555555554, 581.433888888889, 575.9911111111111, 574.0866666666666, 581.0766666666667, 568.8944444444444, 575.2677777777777, 560.006111111111, 558.5383333333332, 572.9666666666666, 573.3955555555553, 580.227222222222, 566.9899999999999, 588.6261111111113, 569.4499999999999, 575.371111111111, 583.6411111111111, 570.0383333333332, 578.435, 568.4583333333331, 559.7933333333336, 575.2838888888888, 570.5777777777778, 576.022222222222, 578.3311111111111, 568.61, 568.1416666666664, 578.3788888888889, 584.99, 564.6255555555555, 580.6255555555553, 570.5938888888888, 580.8316666666667, 573.8944444444445, 574.3144444444446, 577.6650000000001, 566.8705555555555, 571.8955555555553, 570.2838888888888, 566.6338888888887, 568.8394444444446, 573.8877777777777], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [576.5855555555551, 596.616111111111, 581.1327777777778, 581.4283333333332, 590.9422222222221, 580.4111111111112, 563.3716666666668, 577.7127777777778, 579.4022222222221, 585.3783333333332, 572.0772222222223, 587.7922222222221, 578.7594444444443, 577.6644444444445, 575.7044444444447, 568.3955555555553, 576.1500000000001, 573.411111111111, 588.9427777777779, 578.8394444444446, 569.228888888889, 577.9033333333331, 568.7527777777776, 578.7211111111112, 575.1177777777774, 572.3866666666667, 573.4516666666665, 575.2294444444444, 580.6972222222221, 585.743888888889, 569.1655555555554, 552.1177777777776, 568.6094444444441, 581.4027777777778, 573.6811111111108, 583.4822222222222, 566.895, 576.8394444444443, 581.1005555555553, 569.1016666666666, 565.1966666666667, 574.307222222222, 580.491111111111, 566.7283333333335, 582.0066666666664, 565.6255555555556, 572.2599999999998, 584.9744444444443, 580.6488888888889, 585.0216666666668, 582.3466666666667, 574.1894444444445, 579.3238888888889, 580.7194444444443, 574.8077777777779, 588.6249999999999, 565.5455555555558, 570.791666666667, 575.3155555555554, 581.433888888889, 575.9911111111111, 574.0866666666666, 581.0766666666667, 568.8944444444444, 575.2677777777777, 560.006111111111, 558.5383333333332, 572.9666666666666, 573.3955555555553, 580.227222222222, 566.9899999999999, 588.6261111111113, 569.4499999999999, 575.371111111111, 583.6411111111111, 570.0383333333332, 578.435, 568.4583333333331, 559.7933333333336, 575.2838888888888, 570.5777777777778, 576.022222222222, 578.3311111111111, 568.61, 568.1416666666664, 578.3788888888889, 584.99, 564.6255555555555, 580.6255555555553, 570.5938888888888, 580.8316666666667, 573.8944444444445, 574.3144444444446, 577.6650000000001, 566.8705555555555, 571.8955555555553, 570.2838888888888, 566.6338888888887, 568.8394444444446, 573.8877777777777]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19916004525260142, "mean_inference_ms": 1.8089411632296666, "mean_action_processing_ms": 0.07540683616306076, "mean_env_wait_ms": 1.2270964874881167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043239593505859375, "StateBufferConnector_ms": 0.0029366016387939453, "ViewRequirementAgentConnector_ms": 0.06694936752319336}, "num_episodes": 27, "episode_return_max": 596.616111111111, "episode_return_min": 552.1177777777776, "episode_return_mean": 575.2325666666665, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 436350, "num_agent_steps_trained": 436200, "num_env_steps_sampled": 436350, "num_env_steps_trained": 436200, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 267.4609061208181, "num_env_steps_trained_throughput_per_sec": 267.4609061208181, "timesteps_total": 436350, "num_env_steps_sampled_lifetime": 436350, "num_agent_steps_sampled_lifetime": 436350, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 436350, "timers": {"training_iteration_time_ms": 10371.478, "restore_workers_time_ms": 0.013, "training_step_time_ms": 564.252, "sample_time_ms": 548.466, "synch_weights_time_ms": 14.343}, "counters": {"num_env_steps_sampled": 436350, "num_env_steps_trained": 436200, "num_agent_steps_sampled": 436350, "num_agent_steps_trained": 436200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2909, "num_samples_added_to_queue": 436200}, "done": false, "training_iteration": 147, "trial_id": "0313d_00000", "date": "2024-10-10_22-06-43", "timestamp": 1728594403, "time_this_iter_s": 10.104895114898682, "time_total_s": 1514.0072100162506, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a5240>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1514.0072100162506, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 14.999999999999998, "ram_util_percent": 78.11428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 72176.796875, "policy_loss": 71840.921875, "entropy": 9.533888816833496, "entropy_coeff": 0.01, "var_gnorm": 16.717931747436523, "vf_loss": 364478.59375, "vf_explained_var": 0.32185566425323486}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1464.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 439350, "num_env_steps_trained": 439200, "num_agent_steps_sampled": 439350, "num_agent_steps_trained": 439200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2929, "num_samples_added_to_queue": 439200, "learner_queue": {"size_count": 1464, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.592, "learner_load_time_ms": 0.501, "learner_load_wait_time_ms": 958.304, "learner_dequeue_time_ms": 8603.905}}, "env_runners": {"episode_reward_max": 588.6261111111113, "episode_reward_min": 552.1177777777776, "episode_reward_mean": 573.0972722222223, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 552.1177777777776}, "policy_reward_max": {"default_policy": 588.6261111111113}, "policy_reward_mean": {"default_policy": 573.0972722222223}, "custom_metrics": {"num_consolidated_mean": 2.7516000000000003, "num_consolidated_min": 2.64, "num_consolidated_max": 2.85, "num_overloaded_mean": 0.005000000000000001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.03, "num_moves_mean": 2.3228, "num_moves_min": 1.73, "num_moves_max": 2.94, "mean_accuracy_mean": 39.335976666666646, "mean_accuracy_min": 39.18733333333332, "mean_accuracy_max": 39.47233333333332, "num_model_switches_mean": 0.9811000000000001, "num_model_switches_min": 0.74, "num_model_switches_max": 1.33, "num_slav_mean": 0.0005436666666666666, "num_slav_min": 8.333333333333333e-05, "num_slav_max": 0.0018833333333333332, "mean_cluster_cpu_util_mean": 0.514536573779897, "mean_cluster_cpu_util_min": 0.5043306326966439, "mean_cluster_cpu_util_max": 0.5246362868363632, "mean_cluster_mem_util_mean": 0.31273563002490024, "mean_cluster_mem_util_min": 0.30811704017049857, "mean_cluster_mem_util_max": 0.3172788747883119, "reward_consolidation_mean_mean": 3.8004166666666674, "reward_consolidation_mean_min": 3.666666666666667, "reward_consolidation_mean_max": 3.958333333333334, "reward_illegal_mean_mean": -0.008333333333333335, "reward_illegal_mean_min": -0.05, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9569671666666664, "reward_accuracy_mean_min": 1.902783333333333, "reward_accuracy_mean_max": 1.9736166666666666, "reward_sla_mean_mean": -0.018077777777777776, "reward_sla_mean_min": -0.06277777777777777, "reward_sla_mean_max": -0.002777777777777778, "reward_consolidation_sum_mean": 380.04166666666663, "reward_consolidation_sum_min": 366.6666666666667, "reward_consolidation_sum_max": 395.83333333333337, "reward_illegal_sum_mean": -0.8333333333333331, "reward_illegal_sum_min": -5.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 195.69671666666665, "reward_accuracy_sum_min": 190.2783333333333, "reward_accuracy_sum_max": 197.36166666666665, "reward_sla_sum_mean": -1.8077777777777777, "reward_sla_sum_min": -6.277777777777777, "reward_sla_sum_max": -0.2777777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4357.0, "global_timestep_min": 2200, "global_timestep_max": 6000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [569.1655555555554, 552.1177777777776, 568.6094444444441, 581.4027777777778, 573.6811111111108, 583.4822222222222, 566.895, 576.8394444444443, 581.1005555555553, 569.1016666666666, 565.1966666666667, 574.307222222222, 580.491111111111, 566.7283333333335, 582.0066666666664, 565.6255555555556, 572.2599999999998, 584.9744444444443, 580.6488888888889, 585.0216666666668, 582.3466666666667, 574.1894444444445, 579.3238888888889, 580.7194444444443, 574.8077777777779, 588.6249999999999, 565.5455555555558, 570.791666666667, 575.3155555555554, 581.433888888889, 575.9911111111111, 574.0866666666666, 581.0766666666667, 568.8944444444444, 575.2677777777777, 560.006111111111, 558.5383333333332, 572.9666666666666, 573.3955555555553, 580.227222222222, 566.9899999999999, 588.6261111111113, 569.4499999999999, 575.371111111111, 583.6411111111111, 570.0383333333332, 578.435, 568.4583333333331, 559.7933333333336, 575.2838888888888, 570.5777777777778, 576.022222222222, 578.3311111111111, 568.61, 568.1416666666664, 578.3788888888889, 584.99, 564.6255555555555, 580.6255555555553, 570.5938888888888, 580.8316666666667, 573.8944444444445, 574.3144444444446, 577.6650000000001, 566.8705555555555, 571.8955555555553, 570.2838888888888, 566.6338888888887, 568.8394444444446, 573.8877777777777, 581.8316666666667, 565.5700000000002, 567.2611111111111, 586.085, 572.7288888888888, 570.8955555555556, 571.3955555555555, 566.3961111111112, 574.6899999999999, 564.2694444444443, 573.3322222222221, 568.862777777778, 572.4511111111112, 564.8255555555554, 577.0066666666667, 580.5544444444441, 561.5777777777778, 563.8011111111113, 579.0705555555554, 584.1822222222221, 567.8616666666666, 571.3322222222221, 577.61, 562.3966666666665, 569.4277777777776, 573.316111111111, 559.7783333333334, 563.8327777777777, 561.7372222222222, 580.3405555555556], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [569.1655555555554, 552.1177777777776, 568.6094444444441, 581.4027777777778, 573.6811111111108, 583.4822222222222, 566.895, 576.8394444444443, 581.1005555555553, 569.1016666666666, 565.1966666666667, 574.307222222222, 580.491111111111, 566.7283333333335, 582.0066666666664, 565.6255555555556, 572.2599999999998, 584.9744444444443, 580.6488888888889, 585.0216666666668, 582.3466666666667, 574.1894444444445, 579.3238888888889, 580.7194444444443, 574.8077777777779, 588.6249999999999, 565.5455555555558, 570.791666666667, 575.3155555555554, 581.433888888889, 575.9911111111111, 574.0866666666666, 581.0766666666667, 568.8944444444444, 575.2677777777777, 560.006111111111, 558.5383333333332, 572.9666666666666, 573.3955555555553, 580.227222222222, 566.9899999999999, 588.6261111111113, 569.4499999999999, 575.371111111111, 583.6411111111111, 570.0383333333332, 578.435, 568.4583333333331, 559.7933333333336, 575.2838888888888, 570.5777777777778, 576.022222222222, 578.3311111111111, 568.61, 568.1416666666664, 578.3788888888889, 584.99, 564.6255555555555, 580.6255555555553, 570.5938888888888, 580.8316666666667, 573.8944444444445, 574.3144444444446, 577.6650000000001, 566.8705555555555, 571.8955555555553, 570.2838888888888, 566.6338888888887, 568.8394444444446, 573.8877777777777, 581.8316666666667, 565.5700000000002, 567.2611111111111, 586.085, 572.7288888888888, 570.8955555555556, 571.3955555555555, 566.3961111111112, 574.6899999999999, 564.2694444444443, 573.3322222222221, 568.862777777778, 572.4511111111112, 564.8255555555554, 577.0066666666667, 580.5544444444441, 561.5777777777778, 563.8011111111113, 579.0705555555554, 584.1822222222221, 567.8616666666666, 571.3322222222221, 577.61, 562.3966666666665, 569.4277777777776, 573.316111111111, 559.7783333333334, 563.8327777777777, 561.7372222222222, 580.3405555555556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1991894960570974, "mean_inference_ms": 1.8089119146381893, "mean_action_processing_ms": 0.07541325384491956, "mean_env_wait_ms": 1.2271433353374572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043487548828125, "StateBufferConnector_ms": 0.002933502197265625, "ViewRequirementAgentConnector_ms": 0.0667729377746582}, "num_episodes": 30, "episode_return_max": 588.6261111111113, "episode_return_min": 552.1177777777776, "episode_return_mean": 573.0972722222223, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 439350, "num_agent_steps_trained": 439200, "num_env_steps_sampled": 439350, "num_env_steps_trained": 439200, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 296.5024018205653, "num_env_steps_trained_throughput_per_sec": 296.5024018205653, "timesteps_total": 439350, "num_env_steps_sampled_lifetime": 439350, "num_agent_steps_sampled_lifetime": 439350, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 439350, "timers": {"training_iteration_time_ms": 10329.451, "restore_workers_time_ms": 0.012, "training_step_time_ms": 517.406, "sample_time_ms": 502.714, "synch_weights_time_ms": 13.331}, "counters": {"num_env_steps_sampled": 439350, "num_env_steps_trained": 439200, "num_agent_steps_sampled": 439350, "num_agent_steps_trained": 439200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2929, "num_samples_added_to_queue": 439200}, "done": false, "training_iteration": 148, "trial_id": "0313d_00000", "date": "2024-10-10_22-06-53", "timestamp": 1728594413, "time_this_iter_s": 10.135076999664307, "time_total_s": 1524.142287015915, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a62c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1524.142287015915, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 11.086666666666668, "ram_util_percent": 78.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 71255.265625, "policy_loss": 70940.2578125, "entropy": 9.720694541931152, "entropy_coeff": 0.01, "var_gnorm": 16.714210510253906, "vf_loss": 344168.0625, "vf_explained_var": 0.32316744327545166}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1473.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 442050, "num_env_steps_trained": 441900, "num_agent_steps_sampled": 442050, "num_agent_steps_trained": 441900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2947, "num_samples_added_to_queue": 441900, "learner_queue": {"size_count": 1473, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.428, "learner_load_time_ms": 0.454, "learner_load_wait_time_ms": 1049.198, "learner_dequeue_time_ms": 8593.027}}, "env_runners": {"episode_reward_max": 596.445, "episode_reward_min": 558.5383333333332, "episode_reward_mean": 572.9181277777777, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 558.5383333333332}, "policy_reward_max": {"default_policy": 596.445}, "policy_reward_mean": {"default_policy": 572.9181277777777}, "custom_metrics": {"num_consolidated_mean": 2.7561999999999993, "num_consolidated_min": 2.64, "num_consolidated_max": 2.89, "num_overloaded_mean": 0.0057, "num_overloaded_min": 0.0, "num_overloaded_max": 0.03, "num_moves_mean": 2.4466, "num_moves_min": 1.97, "num_moves_max": 2.94, "mean_accuracy_mean": 39.30050999999998, "mean_accuracy_min": 39.07966666666665, "mean_accuracy_max": 39.47233333333332, "num_model_switches_mean": 1.0232, "num_model_switches_min": 0.74, "num_model_switches_max": 1.33, "num_slav_mean": 0.0005611666666666666, "num_slav_min": 8.333333333333333e-05, "num_slav_max": 0.001933333333333333, "mean_cluster_cpu_util_mean": 0.5147905776913307, "mean_cluster_cpu_util_min": 0.5026546122051258, "mean_cluster_cpu_util_max": 0.5235947494414023, "mean_cluster_mem_util_mean": 0.31311784040156143, "mean_cluster_mem_util_min": 0.30811704017049857, "mean_cluster_mem_util_max": 0.3179815002583312, "reward_consolidation_mean_mean": 3.803472222222223, "reward_consolidation_mean_min": 3.666666666666667, "reward_consolidation_mean_max": 4.013888888888889, "reward_illegal_mean_mean": -0.009500000000000001, "reward_illegal_mean_min": -0.05, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9538535000000001, "reward_accuracy_mean_min": 1.902783333333333, "reward_accuracy_mean_max": 1.9736166666666666, "reward_sla_mean_mean": -0.018644444444444443, "reward_sla_mean_min": -0.06444444444444444, "reward_sla_mean_max": -0.002777777777777778, "reward_consolidation_sum_mean": 380.3472222222223, "reward_consolidation_sum_min": 366.6666666666667, "reward_consolidation_sum_max": 401.3888888888889, "reward_illegal_sum_mean": -0.9499999999999998, "reward_illegal_sum_min": -5.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 195.38534999999996, "reward_accuracy_sum_min": 190.2783333333333, "reward_accuracy_sum_max": 197.36166666666665, "reward_sla_sum_mean": -1.8644444444444443, "reward_sla_sum_min": -6.444444444444444, "reward_sla_sum_max": -0.2777777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5258.0, "global_timestep_min": 3200, "global_timestep_max": 6900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [570.791666666667, 575.3155555555554, 581.433888888889, 575.9911111111111, 574.0866666666666, 581.0766666666667, 568.8944444444444, 575.2677777777777, 560.006111111111, 558.5383333333332, 572.9666666666666, 573.3955555555553, 580.227222222222, 566.9899999999999, 588.6261111111113, 569.4499999999999, 575.371111111111, 583.6411111111111, 570.0383333333332, 578.435, 568.4583333333331, 559.7933333333336, 575.2838888888888, 570.5777777777778, 576.022222222222, 578.3311111111111, 568.61, 568.1416666666664, 578.3788888888889, 584.99, 564.6255555555555, 580.6255555555553, 570.5938888888888, 580.8316666666667, 573.8944444444445, 574.3144444444446, 577.6650000000001, 566.8705555555555, 571.8955555555553, 570.2838888888888, 566.6338888888887, 568.8394444444446, 573.8877777777777, 581.8316666666667, 565.5700000000002, 567.2611111111111, 586.085, 572.7288888888888, 570.8955555555556, 571.3955555555555, 566.3961111111112, 574.6899999999999, 564.2694444444443, 573.3322222222221, 568.862777777778, 572.4511111111112, 564.8255555555554, 577.0066666666667, 580.5544444444441, 561.5777777777778, 563.8011111111113, 579.0705555555554, 584.1822222222221, 567.8616666666666, 571.3322222222221, 577.61, 562.3966666666665, 569.4277777777776, 573.316111111111, 559.7783333333334, 563.8327777777777, 561.7372222222222, 580.3405555555556, 588.5783333333335, 576.3488888888888, 578.3888888888889, 572.0466666666665, 583.4433333333333, 579.6033333333332, 566.7777777777776, 558.6599999999997, 580.5072222222223, 560.6422222222224, 565.2055555555553, 578.5794444444443, 561.4522222222221, 581.7611111111112, 574.4916666666667, 559.7155555555557, 596.445, 585.6355555555556, 579.1266666666667, 578.8961111111112, 579.4127777777776, 577.2772222222222, 563.1583333333335, 584.88, 570.6755555555557, 565.533888888889, 560.0561111111111], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [570.791666666667, 575.3155555555554, 581.433888888889, 575.9911111111111, 574.0866666666666, 581.0766666666667, 568.8944444444444, 575.2677777777777, 560.006111111111, 558.5383333333332, 572.9666666666666, 573.3955555555553, 580.227222222222, 566.9899999999999, 588.6261111111113, 569.4499999999999, 575.371111111111, 583.6411111111111, 570.0383333333332, 578.435, 568.4583333333331, 559.7933333333336, 575.2838888888888, 570.5777777777778, 576.022222222222, 578.3311111111111, 568.61, 568.1416666666664, 578.3788888888889, 584.99, 564.6255555555555, 580.6255555555553, 570.5938888888888, 580.8316666666667, 573.8944444444445, 574.3144444444446, 577.6650000000001, 566.8705555555555, 571.8955555555553, 570.2838888888888, 566.6338888888887, 568.8394444444446, 573.8877777777777, 581.8316666666667, 565.5700000000002, 567.2611111111111, 586.085, 572.7288888888888, 570.8955555555556, 571.3955555555555, 566.3961111111112, 574.6899999999999, 564.2694444444443, 573.3322222222221, 568.862777777778, 572.4511111111112, 564.8255555555554, 577.0066666666667, 580.5544444444441, 561.5777777777778, 563.8011111111113, 579.0705555555554, 584.1822222222221, 567.8616666666666, 571.3322222222221, 577.61, 562.3966666666665, 569.4277777777776, 573.316111111111, 559.7783333333334, 563.8327777777777, 561.7372222222222, 580.3405555555556, 588.5783333333335, 576.3488888888888, 578.3888888888889, 572.0466666666665, 583.4433333333333, 579.6033333333332, 566.7777777777776, 558.6599999999997, 580.5072222222223, 560.6422222222224, 565.2055555555553, 578.5794444444443, 561.4522222222221, 581.7611111111112, 574.4916666666667, 559.7155555555557, 596.445, 585.6355555555556, 579.1266666666667, 578.8961111111112, 579.4127777777776, 577.2772222222222, 563.1583333333335, 584.88, 570.6755555555557, 565.533888888889, 560.0561111111111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.199206003542482, "mean_inference_ms": 1.8078461475243592, "mean_action_processing_ms": 0.07541581152104128, "mean_env_wait_ms": 1.2271013198894887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004593372344970703, "StateBufferConnector_ms": 0.003034830093383789, "ViewRequirementAgentConnector_ms": 0.06911969184875488}, "num_episodes": 27, "episode_return_max": 596.445, "episode_return_min": 558.5383333333332, "episode_return_mean": 572.9181277777777, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 442050, "num_agent_steps_trained": 441900, "num_env_steps_sampled": 442050, "num_env_steps_trained": 441900, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 269.1856472870598, "num_env_steps_trained_throughput_per_sec": 269.1856472870598, "timesteps_total": 442050, "num_env_steps_sampled_lifetime": 442050, "num_agent_steps_sampled_lifetime": 442050, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 442050, "timers": {"training_iteration_time_ms": 10272.613, "restore_workers_time_ms": 0.015, "training_step_time_ms": 548.528, "sample_time_ms": 534.684, "synch_weights_time_ms": 12.513}, "counters": {"num_env_steps_sampled": 442050, "num_env_steps_trained": 441900, "num_agent_steps_sampled": 442050, "num_agent_steps_trained": 441900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2947, "num_samples_added_to_queue": 441900}, "done": false, "training_iteration": 149, "trial_id": "0313d_00000", "date": "2024-10-10_22-07-03", "timestamp": 1728594423, "time_this_iter_s": 10.04015302658081, "time_total_s": 1534.1824400424957, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae402ce4d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1534.1824400424957, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 14.05, "ram_util_percent": 78.54285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 72209.5234375, "policy_loss": 71930.5390625, "entropy": 9.747566223144531, "entropy_coeff": 0.01, "var_gnorm": 16.7132511138916, "vf_loss": 308226.5, "vf_explained_var": 0.34739911556243896}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1482.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 444900, "num_env_steps_trained": 444600, "num_agent_steps_sampled": 444900, "num_agent_steps_trained": 444600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2966, "num_samples_added_to_queue": 444900, "learner_queue": {"size_count": 1482, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.347, "learner_load_time_ms": 0.454, "learner_load_wait_time_ms": 1017.711, "learner_dequeue_time_ms": 8618.413}}, "env_runners": {"episode_reward_max": 596.445, "episode_reward_min": 552.5511111111109, "episode_reward_mean": 571.2801222222222, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 552.5511111111109}, "policy_reward_max": {"default_policy": 596.445}, "policy_reward_mean": {"default_policy": 571.2801222222222}, "custom_metrics": {"num_consolidated_mean": 2.753999999999999, "num_consolidated_min": 2.65, "num_consolidated_max": 2.89, "num_overloaded_mean": 0.006699999999999999, "num_overloaded_min": 0.0, "num_overloaded_max": 0.03, "num_moves_mean": 2.5418, "num_moves_min": 2.02, "num_moves_max": 2.94, "mean_accuracy_mean": 39.22001333333331, "mean_accuracy_min": 38.97199999999999, "mean_accuracy_max": 39.47233333333332, "num_model_switches_mean": 1.0846, "num_model_switches_min": 0.78, "num_model_switches_max": 1.39, "num_slav_mean": 0.0006149999999999999, "num_slav_min": 8.333333333333333e-05, "num_slav_max": 0.001933333333333333, "mean_cluster_cpu_util_mean": 0.5132264942181097, "mean_cluster_cpu_util_min": 0.49994642084918267, "mean_cluster_cpu_util_max": 0.5235531572881568, "mean_cluster_mem_util_mean": 0.3130445503656104, "mean_cluster_mem_util_min": 0.3077694770946353, "mean_cluster_mem_util_max": 0.3179815002583312, "reward_consolidation_mean_mean": 3.7965277777777784, "reward_consolidation_mean_min": 3.6388888888888897, "reward_consolidation_mean_max": 4.013888888888889, "reward_illegal_mean_mean": -0.011166666666666665, "reward_illegal_mean_min": -0.05, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9478623333333331, "reward_accuracy_mean_min": 1.8920166666666662, "reward_accuracy_mean_max": 1.9736166666666666, "reward_sla_mean_mean": -0.02042222222222222, "reward_sla_mean_min": -0.06444444444444444, "reward_sla_mean_max": -0.002777777777777778, "reward_consolidation_sum_mean": 379.6527777777778, "reward_consolidation_sum_min": 363.88888888888897, "reward_consolidation_sum_max": 401.3888888888889, "reward_illegal_sum_mean": -1.1166666666666667, "reward_illegal_sum_min": -5.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 194.78623333333334, "reward_accuracy_sum_min": 189.20166666666663, "reward_accuracy_sum_max": 197.36166666666665, "reward_sla_sum_mean": -2.042222222222222, "reward_sla_sum_min": -6.444444444444444, "reward_sla_sum_max": -0.2777777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6029.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [564.6255555555555, 580.6255555555553, 570.5938888888888, 580.8316666666667, 573.8944444444445, 574.3144444444446, 577.6650000000001, 566.8705555555555, 571.8955555555553, 570.2838888888888, 566.6338888888887, 568.8394444444446, 573.8877777777777, 581.8316666666667, 565.5700000000002, 567.2611111111111, 586.085, 572.7288888888888, 570.8955555555556, 571.3955555555555, 566.3961111111112, 574.6899999999999, 564.2694444444443, 573.3322222222221, 568.862777777778, 572.4511111111112, 564.8255555555554, 577.0066666666667, 580.5544444444441, 561.5777777777778, 563.8011111111113, 579.0705555555554, 584.1822222222221, 567.8616666666666, 571.3322222222221, 577.61, 562.3966666666665, 569.4277777777776, 573.316111111111, 559.7783333333334, 563.8327777777777, 561.7372222222222, 580.3405555555556, 588.5783333333335, 576.3488888888888, 578.3888888888889, 572.0466666666665, 583.4433333333333, 579.6033333333332, 566.7777777777776, 558.6599999999997, 580.5072222222223, 560.6422222222224, 565.2055555555553, 578.5794444444443, 561.4522222222221, 581.7611111111112, 574.4916666666667, 559.7155555555557, 596.445, 585.6355555555556, 579.1266666666667, 578.8961111111112, 579.4127777777776, 577.2772222222222, 563.1583333333335, 584.88, 570.6755555555557, 565.533888888889, 560.0561111111111, 572.1833333333336, 583.8894444444447, 554.5333333333332, 578.3738888888892, 568.3672222222225, 561.9783333333335, 559.7477777777774, 580.7955555555554, 569.8122222222221, 552.5511111111109, 580.7788888888889, 555.6844444444442, 577.1038888888888, 571.8177777777777, 570.1677777777775, 568.6200000000001, 569.0494444444446, 576.2877777777778, 566.875, 562.6461111111112, 562.2466666666666, 570.4933333333333, 563.4383333333332, 555.2472222222221, 560.486111111111, 573.6055555555556, 580.6527777777779, 571.566111111111, 566.3116666666665, 560.0188888888891], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [564.6255555555555, 580.6255555555553, 570.5938888888888, 580.8316666666667, 573.8944444444445, 574.3144444444446, 577.6650000000001, 566.8705555555555, 571.8955555555553, 570.2838888888888, 566.6338888888887, 568.8394444444446, 573.8877777777777, 581.8316666666667, 565.5700000000002, 567.2611111111111, 586.085, 572.7288888888888, 570.8955555555556, 571.3955555555555, 566.3961111111112, 574.6899999999999, 564.2694444444443, 573.3322222222221, 568.862777777778, 572.4511111111112, 564.8255555555554, 577.0066666666667, 580.5544444444441, 561.5777777777778, 563.8011111111113, 579.0705555555554, 584.1822222222221, 567.8616666666666, 571.3322222222221, 577.61, 562.3966666666665, 569.4277777777776, 573.316111111111, 559.7783333333334, 563.8327777777777, 561.7372222222222, 580.3405555555556, 588.5783333333335, 576.3488888888888, 578.3888888888889, 572.0466666666665, 583.4433333333333, 579.6033333333332, 566.7777777777776, 558.6599999999997, 580.5072222222223, 560.6422222222224, 565.2055555555553, 578.5794444444443, 561.4522222222221, 581.7611111111112, 574.4916666666667, 559.7155555555557, 596.445, 585.6355555555556, 579.1266666666667, 578.8961111111112, 579.4127777777776, 577.2772222222222, 563.1583333333335, 584.88, 570.6755555555557, 565.533888888889, 560.0561111111111, 572.1833333333336, 583.8894444444447, 554.5333333333332, 578.3738888888892, 568.3672222222225, 561.9783333333335, 559.7477777777774, 580.7955555555554, 569.8122222222221, 552.5511111111109, 580.7788888888889, 555.6844444444442, 577.1038888888888, 571.8177777777777, 570.1677777777775, 568.6200000000001, 569.0494444444446, 576.2877777777778, 566.875, 562.6461111111112, 562.2466666666666, 570.4933333333333, 563.4383333333332, 555.2472222222221, 560.486111111111, 573.6055555555556, 580.6527777777779, 571.566111111111, 566.3116666666665, 560.0188888888891]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19929948671505407, "mean_inference_ms": 1.8097631595519403, "mean_action_processing_ms": 0.07545426583122007, "mean_env_wait_ms": 1.227612166638099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044400691986083984, "StateBufferConnector_ms": 0.002969503402709961, "ViewRequirementAgentConnector_ms": 0.06727743148803711}, "num_episodes": 30, "episode_return_max": 596.445, "episode_return_min": 552.5511111111109, "episode_return_mean": 571.2801222222222, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444900, "num_agent_steps_trained": 444600, "num_env_steps_sampled": 444900, "num_env_steps_trained": 444600, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 278.370976792433, "num_env_steps_trained_throughput_per_sec": 263.719872750726, "timesteps_total": 444900, "num_env_steps_sampled_lifetime": 444900, "num_agent_steps_sampled_lifetime": 444900, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 444900, "timers": {"training_iteration_time_ms": 10253.111, "restore_workers_time_ms": 0.012, "training_step_time_ms": 539.126, "sample_time_ms": 523.685, "synch_weights_time_ms": 14.045}, "counters": {"num_env_steps_sampled": 444900, "num_env_steps_trained": 444600, "num_agent_steps_sampled": 444900, "num_agent_steps_trained": 444600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2966, "num_samples_added_to_queue": 444900}, "done": false, "training_iteration": 150, "trial_id": "0313d_00000", "date": "2024-10-10_22-07-13", "timestamp": 1728594433, "time_this_iter_s": 10.247943878173828, "time_total_s": 1544.4303839206696, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42db4e80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1544.4303839206696, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 13.300000000000002, "ram_util_percent": 78.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 69103.03125, "policy_loss": 68771.5, "entropy": 9.397226333618164, "entropy_coeff": 0.01, "var_gnorm": 16.715394973754883, "vf_loss": 359722.875, "vf_explained_var": 0.34536832571029663}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1492.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 447900, "num_env_steps_trained": 447600, "num_agent_steps_sampled": 447900, "num_agent_steps_trained": 447600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2986, "num_samples_added_to_queue": 447900, "learner_queue": {"size_count": 1492, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.284, "learner_load_time_ms": 0.468, "learner_load_wait_time_ms": 965.156, "learner_dequeue_time_ms": 8519.506}}, "env_runners": {"episode_reward_max": 596.445, "episode_reward_min": 552.5511111111109, "episode_reward_mean": 571.1527666666667, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 552.5511111111109}, "policy_reward_max": {"default_policy": 596.445}, "policy_reward_mean": {"default_policy": 571.1527666666667}, "custom_metrics": {"num_consolidated_mean": 2.7521000000000004, "num_consolidated_min": 2.65, "num_consolidated_max": 2.89, "num_overloaded_mean": 0.0059, "num_overloaded_min": 0.0, "num_overloaded_max": 0.03, "num_moves_mean": 2.5288999999999997, "num_moves_min": 2.11, "num_moves_max": 2.94, "mean_accuracy_mean": 39.10765999999999, "mean_accuracy_min": 38.832666666666654, "mean_accuracy_max": 39.47233333333332, "num_model_switches_mean": 1.1077, "num_model_switches_min": 0.82, "num_model_switches_max": 1.39, "num_slav_mean": 0.0005761666666666667, "num_slav_min": 8.333333333333333e-05, "num_slav_max": 0.001933333333333333, "mean_cluster_cpu_util_mean": 0.5110796667240923, "mean_cluster_cpu_util_min": 0.49469992663866413, "mean_cluster_cpu_util_max": 0.5235531572881568, "mean_cluster_mem_util_mean": 0.31275162445284016, "mean_cluster_mem_util_min": 0.3073628336777749, "mean_cluster_mem_util_max": 0.3179815002583312, "reward_consolidation_mean_mean": 3.796666666666667, "reward_consolidation_mean_min": 3.6388888888888897, "reward_consolidation_mean_max": 4.013888888888889, "reward_illegal_mean_mean": -0.009833333333333333, "reward_illegal_mean_min": -0.05, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9438443333333324, "reward_accuracy_mean_min": 1.8920166666666662, "reward_accuracy_mean_max": 1.9736166666666666, "reward_sla_mean_mean": -0.01915, "reward_sla_mean_min": -0.06444444444444444, "reward_sla_mean_max": -0.002777777777777778, "reward_consolidation_sum_mean": 379.6666666666668, "reward_consolidation_sum_min": 363.88888888888897, "reward_consolidation_sum_max": 401.3888888888889, "reward_illegal_sum_mean": -0.9833333333333332, "reward_illegal_sum_min": -5.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 194.38443333333325, "reward_accuracy_sum_min": 189.20166666666663, "reward_accuracy_sum_max": 197.36166666666665, "reward_sla_sum_mean": -1.9150000000000003, "reward_sla_sum_min": -6.444444444444444, "reward_sla_sum_max": -0.2777777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4683.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [563.8011111111113, 579.0705555555554, 584.1822222222221, 567.8616666666666, 571.3322222222221, 577.61, 562.3966666666665, 569.4277777777776, 573.316111111111, 559.7783333333334, 563.8327777777777, 561.7372222222222, 580.3405555555556, 588.5783333333335, 576.3488888888888, 578.3888888888889, 572.0466666666665, 583.4433333333333, 579.6033333333332, 566.7777777777776, 558.6599999999997, 580.5072222222223, 560.6422222222224, 565.2055555555553, 578.5794444444443, 561.4522222222221, 581.7611111111112, 574.4916666666667, 559.7155555555557, 596.445, 585.6355555555556, 579.1266666666667, 578.8961111111112, 579.4127777777776, 577.2772222222222, 563.1583333333335, 584.88, 570.6755555555557, 565.533888888889, 560.0561111111111, 572.1833333333336, 583.8894444444447, 554.5333333333332, 578.3738888888892, 568.3672222222225, 561.9783333333335, 559.7477777777774, 580.7955555555554, 569.8122222222221, 552.5511111111109, 580.7788888888889, 555.6844444444442, 577.1038888888888, 571.8177777777777, 570.1677777777775, 568.6200000000001, 569.0494444444446, 576.2877777777778, 566.875, 562.6461111111112, 562.2466666666666, 570.4933333333333, 563.4383333333332, 555.2472222222221, 560.486111111111, 573.6055555555556, 580.6527777777779, 571.566111111111, 566.3116666666665, 560.0188888888891, 587.6605555555557, 579.5733333333336, 576.2488888888892, 576.21, 562.5738888888887, 564.0516666666668, 569.597777777778, 569.3044444444444, 578.852777777778, 583.0827777777781, 567.5022222222223, 567.13, 565.4150000000001, 563.296666666667, 576.0272222222225, 578.5188888888889, 577.5427777777778, 569.6472222222225, 558.996666666667, 564.2650000000001, 567.2566666666668, 575.9083333333338, 565.0027777777777, 559.9955555555557, 579.9722222222225, 578.613888888889, 580.4155555555556, 557.4805555555555, 577.2022222222225, 570.6144444444446], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [563.8011111111113, 579.0705555555554, 584.1822222222221, 567.8616666666666, 571.3322222222221, 577.61, 562.3966666666665, 569.4277777777776, 573.316111111111, 559.7783333333334, 563.8327777777777, 561.7372222222222, 580.3405555555556, 588.5783333333335, 576.3488888888888, 578.3888888888889, 572.0466666666665, 583.4433333333333, 579.6033333333332, 566.7777777777776, 558.6599999999997, 580.5072222222223, 560.6422222222224, 565.2055555555553, 578.5794444444443, 561.4522222222221, 581.7611111111112, 574.4916666666667, 559.7155555555557, 596.445, 585.6355555555556, 579.1266666666667, 578.8961111111112, 579.4127777777776, 577.2772222222222, 563.1583333333335, 584.88, 570.6755555555557, 565.533888888889, 560.0561111111111, 572.1833333333336, 583.8894444444447, 554.5333333333332, 578.3738888888892, 568.3672222222225, 561.9783333333335, 559.7477777777774, 580.7955555555554, 569.8122222222221, 552.5511111111109, 580.7788888888889, 555.6844444444442, 577.1038888888888, 571.8177777777777, 570.1677777777775, 568.6200000000001, 569.0494444444446, 576.2877777777778, 566.875, 562.6461111111112, 562.2466666666666, 570.4933333333333, 563.4383333333332, 555.2472222222221, 560.486111111111, 573.6055555555556, 580.6527777777779, 571.566111111111, 566.3116666666665, 560.0188888888891, 587.6605555555557, 579.5733333333336, 576.2488888888892, 576.21, 562.5738888888887, 564.0516666666668, 569.597777777778, 569.3044444444444, 578.852777777778, 583.0827777777781, 567.5022222222223, 567.13, 565.4150000000001, 563.296666666667, 576.0272222222225, 578.5188888888889, 577.5427777777778, 569.6472222222225, 558.996666666667, 564.2650000000001, 567.2566666666668, 575.9083333333338, 565.0027777777777, 559.9955555555557, 579.9722222222225, 578.613888888889, 580.4155555555556, 557.4805555555555, 577.2022222222225, 570.6144444444446]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1993324897946576, "mean_inference_ms": 1.8099072059750136, "mean_action_processing_ms": 0.07546741767699153, "mean_env_wait_ms": 1.227700275677547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043888092041015625, "StateBufferConnector_ms": 0.002961874008178711, "ViewRequirementAgentConnector_ms": 0.06714463233947754}, "num_episodes": 30, "episode_return_max": 596.445, "episode_return_min": 552.5511111111109, "episode_return_mean": 571.1527666666667, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 447900, "num_agent_steps_trained": 447600, "num_env_steps_sampled": 447900, "num_env_steps_trained": 447600, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 295.9071612126799, "num_env_steps_trained_throughput_per_sec": 295.9071612126799, "timesteps_total": 447900, "num_env_steps_sampled_lifetime": 447900, "num_agent_steps_sampled_lifetime": 447900, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 447900, "timers": {"training_iteration_time_ms": 10218.024, "restore_workers_time_ms": 0.011, "training_step_time_ms": 511.011, "sample_time_ms": 496.591, "synch_weights_time_ms": 12.948}, "counters": {"num_env_steps_sampled": 447900, "num_env_steps_trained": 447600, "num_agent_steps_sampled": 447900, "num_agent_steps_trained": 447600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2986, "num_samples_added_to_queue": 447900}, "done": false, "training_iteration": 151, "trial_id": "0313d_00000", "date": "2024-10-10_22-07-24", "timestamp": 1728594444, "time_this_iter_s": 10.149020433425903, "time_total_s": 1554.5794043540955, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42fa2770>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1554.5794043540955, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 11.357142857142858, "ram_util_percent": 78.73571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 76671.0859375, "policy_loss": 76337.3671875, "entropy": 9.434536933898926, "entropy_coeff": 0.01, "var_gnorm": 16.718467712402344, "vf_loss": 362022.9375, "vf_explained_var": 0.35757261514663696}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1502.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 450750, "num_env_steps_trained": 450600, "num_agent_steps_sampled": 450750, "num_agent_steps_trained": 450600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3005, "num_samples_added_to_queue": 450600, "learner_queue": {"size_count": 1502, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.43, "learner_load_time_ms": 0.42, "learner_load_wait_time_ms": 976.892, "learner_dequeue_time_ms": 8466.861}}, "env_runners": {"episode_reward_max": 596.445, "episode_reward_min": 552.5511111111109, "episode_reward_mean": 570.3856000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 552.5511111111109}, "policy_reward_max": {"default_policy": 596.445}, "policy_reward_mean": {"default_policy": 570.3856000000001}, "custom_metrics": {"num_consolidated_mean": 2.7457, "num_consolidated_min": 2.62, "num_consolidated_max": 2.89, "num_overloaded_mean": 0.0054, "num_overloaded_min": 0.0, "num_overloaded_max": 0.03, "num_moves_mean": 2.4813, "num_moves_min": 2.09, "num_moves_max": 2.88, "mean_accuracy_mean": 39.01316666666665, "mean_accuracy_min": 38.775666666666645, "mean_accuracy_max": 39.275999999999975, "num_model_switches_mean": 1.1022999999999998, "num_model_switches_min": 0.78, "num_model_switches_max": 1.39, "num_slav_mean": 0.0005275, "num_slav_min": 5e-05, "num_slav_max": 0.0025666666666666667, "mean_cluster_cpu_util_mean": 0.5087676262461573, "mean_cluster_cpu_util_min": 0.49469992663866413, "mean_cluster_cpu_util_max": 0.5226900010044279, "mean_cluster_mem_util_mean": 0.31236737123984615, "mean_cluster_mem_util_min": 0.3073628336777749, "mean_cluster_mem_util_max": 0.3179815002583312, "reward_consolidation_mean_mean": 3.790277777777778, "reward_consolidation_mean_min": 3.6388888888888893, "reward_consolidation_mean_max": 4.013888888888889, "reward_illegal_mean_mean": -0.009000000000000001, "reward_illegal_mean_min": -0.05, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9401059999999999, "reward_accuracy_mean_min": 1.8910666666666662, "reward_accuracy_mean_max": 1.9638, "reward_sla_mean_mean": -0.017527777777777778, "reward_sla_mean_min": -0.08555555555555555, "reward_sla_mean_max": -0.0016666666666666668, "reward_consolidation_sum_mean": 379.0277777777779, "reward_consolidation_sum_min": 363.8888888888889, "reward_consolidation_sum_max": 401.3888888888889, "reward_illegal_sum_mean": -0.8999999999999999, "reward_illegal_sum_min": -5.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 194.01059999999995, "reward_accuracy_sum_min": 189.10666666666663, "reward_accuracy_sum_max": 196.38, "reward_sla_sum_mean": -1.7527777777777773, "reward_sla_sum_min": -8.555555555555555, "reward_sla_sum_max": -0.16666666666666669, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3483.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [574.4916666666667, 559.7155555555557, 596.445, 585.6355555555556, 579.1266666666667, 578.8961111111112, 579.4127777777776, 577.2772222222222, 563.1583333333335, 584.88, 570.6755555555557, 565.533888888889, 560.0561111111111, 572.1833333333336, 583.8894444444447, 554.5333333333332, 578.3738888888892, 568.3672222222225, 561.9783333333335, 559.7477777777774, 580.7955555555554, 569.8122222222221, 552.5511111111109, 580.7788888888889, 555.6844444444442, 577.1038888888888, 571.8177777777777, 570.1677777777775, 568.6200000000001, 569.0494444444446, 576.2877777777778, 566.875, 562.6461111111112, 562.2466666666666, 570.4933333333333, 563.4383333333332, 555.2472222222221, 560.486111111111, 573.6055555555556, 580.6527777777779, 571.566111111111, 566.3116666666665, 560.0188888888891, 587.6605555555557, 579.5733333333336, 576.2488888888892, 576.21, 562.5738888888887, 564.0516666666668, 569.597777777778, 569.3044444444444, 578.852777777778, 583.0827777777781, 567.5022222222223, 567.13, 565.4150000000001, 563.296666666667, 576.0272222222225, 578.5188888888889, 577.5427777777778, 569.6472222222225, 558.996666666667, 564.2650000000001, 567.2566666666668, 575.9083333333338, 565.0027777777777, 559.9955555555557, 579.9722222222225, 578.613888888889, 580.4155555555556, 557.4805555555555, 577.2022222222225, 570.6144444444446, 552.9955555555555, 555.9161111111113, 567.0522222222228, 555.518888888889, 569.5277777777778, 573.2655555555558, 557.7816666666668, 564.3133333333337, 585.0911111111116, 584.471666666667, 557.3050000000002, 583.948333333334, 569.5200000000003, 570.6061111111113, 571.416666666667, 565.0033333333336, 569.0905555555556, 560.6061111111114, 578.2500000000001, 558.2172222222223, 581.9894444444449, 575.7255555555558, 575.6866666666667, 570.361111111111, 571.4644444444448, 567.9638888888891, 576.8772222222224], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [574.4916666666667, 559.7155555555557, 596.445, 585.6355555555556, 579.1266666666667, 578.8961111111112, 579.4127777777776, 577.2772222222222, 563.1583333333335, 584.88, 570.6755555555557, 565.533888888889, 560.0561111111111, 572.1833333333336, 583.8894444444447, 554.5333333333332, 578.3738888888892, 568.3672222222225, 561.9783333333335, 559.7477777777774, 580.7955555555554, 569.8122222222221, 552.5511111111109, 580.7788888888889, 555.6844444444442, 577.1038888888888, 571.8177777777777, 570.1677777777775, 568.6200000000001, 569.0494444444446, 576.2877777777778, 566.875, 562.6461111111112, 562.2466666666666, 570.4933333333333, 563.4383333333332, 555.2472222222221, 560.486111111111, 573.6055555555556, 580.6527777777779, 571.566111111111, 566.3116666666665, 560.0188888888891, 587.6605555555557, 579.5733333333336, 576.2488888888892, 576.21, 562.5738888888887, 564.0516666666668, 569.597777777778, 569.3044444444444, 578.852777777778, 583.0827777777781, 567.5022222222223, 567.13, 565.4150000000001, 563.296666666667, 576.0272222222225, 578.5188888888889, 577.5427777777778, 569.6472222222225, 558.996666666667, 564.2650000000001, 567.2566666666668, 575.9083333333338, 565.0027777777777, 559.9955555555557, 579.9722222222225, 578.613888888889, 580.4155555555556, 557.4805555555555, 577.2022222222225, 570.6144444444446, 552.9955555555555, 555.9161111111113, 567.0522222222228, 555.518888888889, 569.5277777777778, 573.2655555555558, 557.7816666666668, 564.3133333333337, 585.0911111111116, 584.471666666667, 557.3050000000002, 583.948333333334, 569.5200000000003, 570.6061111111113, 571.416666666667, 565.0033333333336, 569.0905555555556, 560.6061111111114, 578.2500000000001, 558.2172222222223, 581.9894444444449, 575.7255555555558, 575.6866666666667, 570.361111111111, 571.4644444444448, 567.9638888888891, 576.8772222222224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19936752323873733, "mean_inference_ms": 1.8100966750053384, "mean_action_processing_ms": 0.07547865315175498, "mean_env_wait_ms": 1.2278426207737454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004503011703491211, "StateBufferConnector_ms": 0.0029671192169189453, "ViewRequirementAgentConnector_ms": 0.06766510009765625}, "num_episodes": 27, "episode_return_max": 596.445, "episode_return_min": 552.5511111111109, "episode_return_mean": 570.3856000000001, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 450750, "num_agent_steps_trained": 450600, "num_env_steps_sampled": 450750, "num_env_steps_trained": 450600, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 284.1315377409476, "num_env_steps_trained_throughput_per_sec": 299.0858292009974, "timesteps_total": 450750, "num_env_steps_sampled_lifetime": 450750, "num_agent_steps_sampled_lifetime": 450750, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 450750, "timers": {"training_iteration_time_ms": 10176.176, "restore_workers_time_ms": 0.012, "training_step_time_ms": 543.803, "sample_time_ms": 527.386, "synch_weights_time_ms": 14.9}, "counters": {"num_env_steps_sampled": 450750, "num_env_steps_trained": 450600, "num_agent_steps_sampled": 450750, "num_agent_steps_trained": 450600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3005, "num_samples_added_to_queue": 450600}, "done": false, "training_iteration": 152, "trial_id": "0313d_00000", "date": "2024-10-10_22-07-34", "timestamp": 1728594454, "time_this_iter_s": 10.042004585266113, "time_total_s": 1564.6214089393616, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a6b00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1564.6214089393616, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 12.206666666666667, "ram_util_percent": 78.88000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 80476.3984375, "policy_loss": 80156.5078125, "entropy": 10.189412117004395, "entropy_coeff": 0.01, "var_gnorm": 16.717967987060547, "vf_loss": 350458.0, "vf_explained_var": 0.3473486304283142}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1511.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 453450, "num_env_steps_trained": 453300, "num_agent_steps_sampled": 453450, "num_agent_steps_trained": 453300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3023, "num_samples_added_to_queue": 453300, "learner_queue": {"size_count": 1511, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.466, "learner_load_time_ms": 0.444, "learner_load_wait_time_ms": 1067.371, "learner_dequeue_time_ms": 8508.904}}, "env_runners": {"episode_reward_max": 587.6605555555557, "episode_reward_min": 549.3366666666667, "episode_reward_mean": 568.3611500000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 549.3366666666667}, "policy_reward_max": {"default_policy": 587.6605555555557}, "policy_reward_mean": {"default_policy": 568.3611500000001}, "custom_metrics": {"num_consolidated_mean": 2.7321999999999997, "num_consolidated_min": 2.62, "num_consolidated_max": 2.83, "num_overloaded_mean": 0.0051, "num_overloaded_min": 0.0, "num_overloaded_max": 0.03, "num_moves_mean": 2.5086, "num_moves_min": 2.09, "num_moves_max": 3.03, "mean_accuracy_mean": 38.955849999999984, "mean_accuracy_min": 38.775666666666645, "mean_accuracy_max": 39.168333333333315, "num_model_switches_mean": 1.101, "num_model_switches_min": 0.78, "num_model_switches_max": 1.43, "num_slav_mean": 0.0005395, "num_slav_min": 5e-05, "num_slav_max": 0.0025666666666666667, "mean_cluster_cpu_util_mean": 0.5066957741126086, "mean_cluster_cpu_util_min": 0.49469992663866413, "mean_cluster_cpu_util_max": 0.5164358491600674, "mean_cluster_mem_util_mean": 0.31202479813571, "mean_cluster_mem_util_min": 0.3070626318565401, "mean_cluster_mem_util_max": 0.31649144224145354, "reward_consolidation_mean_mean": 3.772222222222223, "reward_consolidation_mean_min": 3.611111111111112, "reward_consolidation_mean_max": 3.930555555555556, "reward_illegal_mean_mean": -0.008500000000000002, "reward_illegal_mean_min": -0.05, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9378281666666664, "reward_accuracy_mean_min": 1.8910666666666662, "reward_accuracy_mean_max": 1.9561999999999997, "reward_sla_mean_mean": -0.01793888888888889, "reward_sla_mean_min": -0.08555555555555555, "reward_sla_mean_max": -0.0016666666666666668, "reward_consolidation_sum_mean": 377.22222222222234, "reward_consolidation_sum_min": 361.1111111111112, "reward_consolidation_sum_max": 393.0555555555556, "reward_illegal_sum_mean": -0.85, "reward_illegal_sum_min": -5.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 193.78281666666663, "reward_accuracy_sum_min": 189.10666666666663, "reward_accuracy_sum_max": 195.61999999999998, "reward_sla_sum_mean": -1.7938888888888889, "reward_sla_sum_min": -8.555555555555555, "reward_sla_sum_max": -0.16666666666666669, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2350.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [570.1677777777775, 568.6200000000001, 569.0494444444446, 576.2877777777778, 566.875, 562.6461111111112, 562.2466666666666, 570.4933333333333, 563.4383333333332, 555.2472222222221, 560.486111111111, 573.6055555555556, 580.6527777777779, 571.566111111111, 566.3116666666665, 560.0188888888891, 587.6605555555557, 579.5733333333336, 576.2488888888892, 576.21, 562.5738888888887, 564.0516666666668, 569.597777777778, 569.3044444444444, 578.852777777778, 583.0827777777781, 567.5022222222223, 567.13, 565.4150000000001, 563.296666666667, 576.0272222222225, 578.5188888888889, 577.5427777777778, 569.6472222222225, 558.996666666667, 564.2650000000001, 567.2566666666668, 575.9083333333338, 565.0027777777777, 559.9955555555557, 579.9722222222225, 578.613888888889, 580.4155555555556, 557.4805555555555, 577.2022222222225, 570.6144444444446, 552.9955555555555, 555.9161111111113, 567.0522222222228, 555.518888888889, 569.5277777777778, 573.2655555555558, 557.7816666666668, 564.3133333333337, 585.0911111111116, 584.471666666667, 557.3050000000002, 583.948333333334, 569.5200000000003, 570.6061111111113, 571.416666666667, 565.0033333333336, 569.0905555555556, 560.6061111111114, 578.2500000000001, 558.2172222222223, 581.9894444444449, 575.7255555555558, 575.6866666666667, 570.361111111111, 571.4644444444448, 567.9638888888891, 576.8772222222224, 566.1388888888889, 563.8772222222223, 580.3683333333335, 557.6866666666668, 565.5750000000003, 569.2250000000003, 567.2738888888894, 567.8383333333333, 562.2261111111112, 559.1472222222224, 572.3272222222224, 559.153888888889, 568.3294444444447, 577.4244444444445, 562.8683333333331, 566.8450000000001, 551.9388888888891, 549.3366666666667, 575.6227777777779, 569.6944444444447, 573.6294444444446, 554.5277777777775, 561.8761111111112, 565.2655555555558, 561.1466666666669, 559.1622222222222, 551.9711111111109], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [570.1677777777775, 568.6200000000001, 569.0494444444446, 576.2877777777778, 566.875, 562.6461111111112, 562.2466666666666, 570.4933333333333, 563.4383333333332, 555.2472222222221, 560.486111111111, 573.6055555555556, 580.6527777777779, 571.566111111111, 566.3116666666665, 560.0188888888891, 587.6605555555557, 579.5733333333336, 576.2488888888892, 576.21, 562.5738888888887, 564.0516666666668, 569.597777777778, 569.3044444444444, 578.852777777778, 583.0827777777781, 567.5022222222223, 567.13, 565.4150000000001, 563.296666666667, 576.0272222222225, 578.5188888888889, 577.5427777777778, 569.6472222222225, 558.996666666667, 564.2650000000001, 567.2566666666668, 575.9083333333338, 565.0027777777777, 559.9955555555557, 579.9722222222225, 578.613888888889, 580.4155555555556, 557.4805555555555, 577.2022222222225, 570.6144444444446, 552.9955555555555, 555.9161111111113, 567.0522222222228, 555.518888888889, 569.5277777777778, 573.2655555555558, 557.7816666666668, 564.3133333333337, 585.0911111111116, 584.471666666667, 557.3050000000002, 583.948333333334, 569.5200000000003, 570.6061111111113, 571.416666666667, 565.0033333333336, 569.0905555555556, 560.6061111111114, 578.2500000000001, 558.2172222222223, 581.9894444444449, 575.7255555555558, 575.6866666666667, 570.361111111111, 571.4644444444448, 567.9638888888891, 576.8772222222224, 566.1388888888889, 563.8772222222223, 580.3683333333335, 557.6866666666668, 565.5750000000003, 569.2250000000003, 567.2738888888894, 567.8383333333333, 562.2261111111112, 559.1472222222224, 572.3272222222224, 559.153888888889, 568.3294444444447, 577.4244444444445, 562.8683333333331, 566.8450000000001, 551.9388888888891, 549.3366666666667, 575.6227777777779, 569.6944444444447, 573.6294444444446, 554.5277777777775, 561.8761111111112, 565.2655555555558, 561.1466666666669, 559.1622222222222, 551.9711111111109]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19937355556865094, "mean_inference_ms": 1.8087534220158523, "mean_action_processing_ms": 0.07547291994550856, "mean_env_wait_ms": 1.2276737419886419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004914999008178711, "StateBufferConnector_ms": 0.0029897689819335938, "ViewRequirementAgentConnector_ms": 0.06876826286315918}, "num_episodes": 27, "episode_return_max": 587.6605555555557, "episode_return_min": 549.3366666666667, "episode_return_mean": 568.3611500000001, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 453450, "num_agent_steps_trained": 453300, "num_env_steps_sampled": 453450, "num_env_steps_trained": 453300, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 269.307933910928, "num_env_steps_trained_throughput_per_sec": 269.307933910928, "timesteps_total": 453450, "num_env_steps_sampled_lifetime": 453450, "num_agent_steps_sampled_lifetime": 453450, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 453450, "timers": {"training_iteration_time_ms": 10124.436, "restore_workers_time_ms": 0.012, "training_step_time_ms": 525.811, "sample_time_ms": 510.793, "synch_weights_time_ms": 13.673}, "counters": {"num_env_steps_sampled": 453450, "num_env_steps_trained": 453300, "num_agent_steps_sampled": 453450, "num_agent_steps_trained": 453300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3023, "num_samples_added_to_queue": 453300}, "done": false, "training_iteration": 153, "trial_id": "0313d_00000", "date": "2024-10-10_22-07-44", "timestamp": 1728594464, "time_this_iter_s": 10.035980224609375, "time_total_s": 1574.657389163971, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae417a7b50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1574.657389163971, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 13.892857142857142, "ram_util_percent": 79.28571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 76513.9765625, "policy_loss": 76218.71875, "entropy": 10.322333335876465, "entropy_coeff": 0.01, "var_gnorm": 16.722003936767578, "vf_loss": 326230.375, "vf_explained_var": 0.3588579297065735}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1521.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 456450, "num_env_steps_trained": 456300, "num_agent_steps_sampled": 456450, "num_agent_steps_trained": 456300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3043, "num_samples_added_to_queue": 456300, "learner_queue": {"size_count": 1521, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.752, "learner_load_time_ms": 0.255, "learner_load_wait_time_ms": 959.459, "learner_dequeue_time_ms": 8548.723}}, "env_runners": {"episode_reward_max": 585.0911111111116, "episode_reward_min": 547.4000000000001, "episode_reward_mean": 566.2883944444446, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 547.4000000000001}, "policy_reward_max": {"default_policy": 585.0911111111116}, "policy_reward_mean": {"default_policy": 566.2883944444446}, "custom_metrics": {"num_consolidated_mean": 2.7144, "num_consolidated_min": 2.58, "num_consolidated_max": 2.82, "num_overloaded_mean": 0.004600000000000001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.03, "num_moves_mean": 2.6301000000000005, "num_moves_min": 2.09, "num_moves_max": 3.28, "mean_accuracy_mean": 38.933936666666646, "mean_accuracy_min": 38.775666666666645, "mean_accuracy_max": 39.05433333333331, "num_model_switches_mean": 1.1183, "num_model_switches_min": 0.78, "num_model_switches_max": 1.43, "num_slav_mean": 0.0005073333333333334, "num_slav_min": 5e-05, "num_slav_max": 0.0025666666666666667, "mean_cluster_cpu_util_mean": 0.5047452984740616, "mean_cluster_cpu_util_min": 0.49019219895982485, "mean_cluster_cpu_util_max": 0.5160339668670998, "mean_cluster_mem_util_mean": 0.31168624839081205, "mean_cluster_mem_util_min": 0.3060613552699561, "mean_cluster_mem_util_max": 0.31649144224145354, "reward_consolidation_mean_mean": 3.749722222222222, "reward_consolidation_mean_min": 3.583333333333334, "reward_consolidation_mean_max": 3.916666666666667, "reward_illegal_mean_mean": -0.007666666666666667, "reward_illegal_mean_min": -0.05, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.937706166666666, "reward_accuracy_mean_min": 1.8910666666666662, "reward_accuracy_mean_max": 1.9527166666666664, "reward_sla_mean_mean": -0.016877777777777776, "reward_sla_mean_min": -0.08555555555555555, "reward_sla_mean_max": -0.0016666666666666668, "reward_consolidation_sum_mean": 374.9722222222222, "reward_consolidation_sum_min": 358.33333333333337, "reward_consolidation_sum_max": 391.6666666666667, "reward_illegal_sum_mean": -0.7666666666666667, "reward_illegal_sum_min": -5.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 193.7706166666666, "reward_accuracy_sum_min": 189.10666666666663, "reward_accuracy_sum_max": 195.27166666666665, "reward_sla_sum_mean": -1.6877777777777774, "reward_sla_sum_min": -8.555555555555555, "reward_sla_sum_max": -0.16666666666666669, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2258.0, "global_timestep_min": 200, "global_timestep_max": 3900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [576.0272222222225, 578.5188888888889, 577.5427777777778, 569.6472222222225, 558.996666666667, 564.2650000000001, 567.2566666666668, 575.9083333333338, 565.0027777777777, 559.9955555555557, 579.9722222222225, 578.613888888889, 580.4155555555556, 557.4805555555555, 577.2022222222225, 570.6144444444446, 552.9955555555555, 555.9161111111113, 567.0522222222228, 555.518888888889, 569.5277777777778, 573.2655555555558, 557.7816666666668, 564.3133333333337, 585.0911111111116, 584.471666666667, 557.3050000000002, 583.948333333334, 569.5200000000003, 570.6061111111113, 571.416666666667, 565.0033333333336, 569.0905555555556, 560.6061111111114, 578.2500000000001, 558.2172222222223, 581.9894444444449, 575.7255555555558, 575.6866666666667, 570.361111111111, 571.4644444444448, 567.9638888888891, 576.8772222222224, 566.1388888888889, 563.8772222222223, 580.3683333333335, 557.6866666666668, 565.5750000000003, 569.2250000000003, 567.2738888888894, 567.8383333333333, 562.2261111111112, 559.1472222222224, 572.3272222222224, 559.153888888889, 568.3294444444447, 577.4244444444445, 562.8683333333331, 566.8450000000001, 551.9388888888891, 549.3366666666667, 575.6227777777779, 569.6944444444447, 573.6294444444446, 554.5277777777775, 561.8761111111112, 565.2655555555558, 561.1466666666669, 559.1622222222222, 551.9711111111109, 562.0750000000002, 552.5266666666664, 573.6466666666671, 580.5105555555559, 557.5661111111112, 557.726111111111, 559.2566666666665, 556.1616666666664, 574.8200000000002, 556.6294444444443, 556.2811111111113, 550.8611111111113, 572.0105555555557, 553.9566666666666, 569.9716666666667, 555.4405555555556, 572.217777777778, 576.2255555555555, 570.7961111111114, 566.3683333333335, 567.2422222222224, 562.8833333333333, 564.8205555555556, 571.6466666666668, 555.5111111111113, 567.8838888888888, 555.3922222222221, 547.4000000000001, 551.6938888888888, 561.4150000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [576.0272222222225, 578.5188888888889, 577.5427777777778, 569.6472222222225, 558.996666666667, 564.2650000000001, 567.2566666666668, 575.9083333333338, 565.0027777777777, 559.9955555555557, 579.9722222222225, 578.613888888889, 580.4155555555556, 557.4805555555555, 577.2022222222225, 570.6144444444446, 552.9955555555555, 555.9161111111113, 567.0522222222228, 555.518888888889, 569.5277777777778, 573.2655555555558, 557.7816666666668, 564.3133333333337, 585.0911111111116, 584.471666666667, 557.3050000000002, 583.948333333334, 569.5200000000003, 570.6061111111113, 571.416666666667, 565.0033333333336, 569.0905555555556, 560.6061111111114, 578.2500000000001, 558.2172222222223, 581.9894444444449, 575.7255555555558, 575.6866666666667, 570.361111111111, 571.4644444444448, 567.9638888888891, 576.8772222222224, 566.1388888888889, 563.8772222222223, 580.3683333333335, 557.6866666666668, 565.5750000000003, 569.2250000000003, 567.2738888888894, 567.8383333333333, 562.2261111111112, 559.1472222222224, 572.3272222222224, 559.153888888889, 568.3294444444447, 577.4244444444445, 562.8683333333331, 566.8450000000001, 551.9388888888891, 549.3366666666667, 575.6227777777779, 569.6944444444447, 573.6294444444446, 554.5277777777775, 561.8761111111112, 565.2655555555558, 561.1466666666669, 559.1622222222222, 551.9711111111109, 562.0750000000002, 552.5266666666664, 573.6466666666671, 580.5105555555559, 557.5661111111112, 557.726111111111, 559.2566666666665, 556.1616666666664, 574.8200000000002, 556.6294444444443, 556.2811111111113, 550.8611111111113, 572.0105555555557, 553.9566666666666, 569.9716666666667, 555.4405555555556, 572.217777777778, 576.2255555555555, 570.7961111111114, 566.3683333333335, 567.2422222222224, 562.8833333333333, 564.8205555555556, 571.6466666666668, 555.5111111111113, 567.8838888888888, 555.3922222222221, 547.4000000000001, 551.6938888888888, 561.4150000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.199414547946526, "mean_inference_ms": 1.8088616217903566, "mean_action_processing_ms": 0.07548095956752936, "mean_env_wait_ms": 1.2277645239630102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004949092864990234, "StateBufferConnector_ms": 0.0029859542846679688, "ViewRequirementAgentConnector_ms": 0.06874918937683105}, "num_episodes": 30, "episode_return_max": 585.0911111111116, "episode_return_min": 547.4000000000001, "episode_return_mean": 566.2883944444446, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456450, "num_agent_steps_trained": 456300, "num_env_steps_sampled": 456450, "num_env_steps_trained": 456300, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 297.0273148304535, "num_env_steps_trained_throughput_per_sec": 297.0273148304535, "timesteps_total": 456450, "num_env_steps_sampled_lifetime": 456450, "num_agent_steps_sampled_lifetime": 456450, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 456450, "timers": {"training_iteration_time_ms": 10129.374, "restore_workers_time_ms": 0.012, "training_step_time_ms": 498.778, "sample_time_ms": 484.085, "synch_weights_time_ms": 13.351}, "counters": {"num_env_steps_sampled": 456450, "num_env_steps_trained": 456300, "num_agent_steps_sampled": 456450, "num_agent_steps_trained": 456300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3043, "num_samples_added_to_queue": 456300}, "done": false, "training_iteration": 154, "trial_id": "0313d_00000", "date": "2024-10-10_22-07-54", "timestamp": 1728594474, "time_this_iter_s": 10.10921573638916, "time_total_s": 1584.76660490036, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c14220>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1584.76660490036, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 11.126666666666667, "ram_util_percent": 79.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 80012.5, "policy_loss": 79689.9375, "entropy": 10.422314643859863, "entropy_coeff": 0.01, "var_gnorm": 16.72368812561035, "vf_loss": 353831.75, "vf_explained_var": 0.35200291872024536}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1530.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 459300, "num_env_steps_trained": 459000, "num_agent_steps_sampled": 459300, "num_agent_steps_trained": 459000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3062, "num_samples_added_to_queue": 459300, "learner_queue": {"size_count": 1530, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.569, "learner_load_time_ms": 0.228, "learner_load_wait_time_ms": 1030.379, "learner_dequeue_time_ms": 8500.63}}, "env_runners": {"episode_reward_max": 581.9894444444449, "episode_reward_min": 547.4000000000001, "episode_reward_mean": 563.3771611111111, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 547.4000000000001}, "policy_reward_max": {"default_policy": 581.9894444444449}, "policy_reward_mean": {"default_policy": 563.3771611111111}, "custom_metrics": {"num_consolidated_mean": 2.6945999999999994, "num_consolidated_min": 2.58, "num_consolidated_max": 2.8, "num_overloaded_mean": 0.004700000000000001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 2.8078999999999996, "num_moves_min": 2.09, "num_moves_max": 3.34, "mean_accuracy_mean": 38.95711666666665, "mean_accuracy_min": 38.775666666666645, "mean_accuracy_max": 39.12399999999998, "num_model_switches_mean": 1.1571, "num_model_switches_min": 0.78, "num_model_switches_max": 1.43, "num_slav_mean": 0.0005579999999999999, "num_slav_min": 5e-05, "num_slav_max": 0.0025666666666666667, "mean_cluster_cpu_util_mean": 0.5033711993050932, "mean_cluster_cpu_util_min": 0.49019219895982485, "mean_cluster_cpu_util_max": 0.5160339668670998, "mean_cluster_mem_util_mean": 0.3111718395440455, "mean_cluster_mem_util_min": 0.3059179690863687, "mean_cluster_mem_util_max": 0.31649144224145354, "reward_consolidation_mean_mean": 3.721527777777778, "reward_consolidation_mean_min": 3.583333333333334, "reward_consolidation_mean_max": 3.8888888888888893, "reward_illegal_mean_mean": -0.007833333333333333, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9386438333333325, "reward_accuracy_mean_min": 1.906866666666666, "reward_accuracy_mean_max": 1.9542999999999995, "reward_sla_mean_mean": -0.018566666666666665, "reward_sla_mean_min": -0.08555555555555555, "reward_sla_mean_max": -0.0016666666666666668, "reward_consolidation_sum_mean": 372.1527777777779, "reward_consolidation_sum_min": 358.33333333333337, "reward_consolidation_sum_max": 388.8888888888889, "reward_illegal_sum_mean": -0.7833333333333333, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 193.86438333333328, "reward_accuracy_sum_min": 190.6866666666666, "reward_accuracy_sum_max": 195.42999999999995, "reward_sla_sum_mean": -1.8566666666666662, "reward_sla_sum_min": -8.555555555555555, "reward_sla_sum_max": -0.16666666666666669, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3263.0, "global_timestep_min": 1200, "global_timestep_max": 4900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [571.416666666667, 565.0033333333336, 569.0905555555556, 560.6061111111114, 578.2500000000001, 558.2172222222223, 581.9894444444449, 575.7255555555558, 575.6866666666667, 570.361111111111, 571.4644444444448, 567.9638888888891, 576.8772222222224, 566.1388888888889, 563.8772222222223, 580.3683333333335, 557.6866666666668, 565.5750000000003, 569.2250000000003, 567.2738888888894, 567.8383333333333, 562.2261111111112, 559.1472222222224, 572.3272222222224, 559.153888888889, 568.3294444444447, 577.4244444444445, 562.8683333333331, 566.8450000000001, 551.9388888888891, 549.3366666666667, 575.6227777777779, 569.6944444444447, 573.6294444444446, 554.5277777777775, 561.8761111111112, 565.2655555555558, 561.1466666666669, 559.1622222222222, 551.9711111111109, 562.0750000000002, 552.5266666666664, 573.6466666666671, 580.5105555555559, 557.5661111111112, 557.726111111111, 559.2566666666665, 556.1616666666664, 574.8200000000002, 556.6294444444443, 556.2811111111113, 550.8611111111113, 572.0105555555557, 553.9566666666666, 569.9716666666667, 555.4405555555556, 572.217777777778, 576.2255555555555, 570.7961111111114, 566.3683333333335, 567.2422222222224, 562.8833333333333, 564.8205555555556, 571.6466666666668, 555.5111111111113, 567.8838888888888, 555.3922222222221, 547.4000000000001, 551.6938888888888, 561.4150000000001, 549.7005555555555, 558.7016666666669, 553.9788888888886, 553.3922222222222, 557.7405555555557, 553.0033333333332, 557.6533333333333, 549.7416666666668, 561.7811111111112, 559.8911111111113, 573.8594444444445, 571.3744444444447, 563.8283333333331, 564.0261111111113, 548.4394444444445, 555.3288888888887, 561.8444444444444, 564.1133333333336, 562.5977777777775, 550.4394444444443, 563.9322222222224, 569.6211111111111, 563.4000000000001, 560.0333333333332, 564.7488888888888, 557.5022222222224, 558.8349999999998, 559.7005555555554, 563.413888888889, 561.0266666666666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [571.416666666667, 565.0033333333336, 569.0905555555556, 560.6061111111114, 578.2500000000001, 558.2172222222223, 581.9894444444449, 575.7255555555558, 575.6866666666667, 570.361111111111, 571.4644444444448, 567.9638888888891, 576.8772222222224, 566.1388888888889, 563.8772222222223, 580.3683333333335, 557.6866666666668, 565.5750000000003, 569.2250000000003, 567.2738888888894, 567.8383333333333, 562.2261111111112, 559.1472222222224, 572.3272222222224, 559.153888888889, 568.3294444444447, 577.4244444444445, 562.8683333333331, 566.8450000000001, 551.9388888888891, 549.3366666666667, 575.6227777777779, 569.6944444444447, 573.6294444444446, 554.5277777777775, 561.8761111111112, 565.2655555555558, 561.1466666666669, 559.1622222222222, 551.9711111111109, 562.0750000000002, 552.5266666666664, 573.6466666666671, 580.5105555555559, 557.5661111111112, 557.726111111111, 559.2566666666665, 556.1616666666664, 574.8200000000002, 556.6294444444443, 556.2811111111113, 550.8611111111113, 572.0105555555557, 553.9566666666666, 569.9716666666667, 555.4405555555556, 572.217777777778, 576.2255555555555, 570.7961111111114, 566.3683333333335, 567.2422222222224, 562.8833333333333, 564.8205555555556, 571.6466666666668, 555.5111111111113, 567.8838888888888, 555.3922222222221, 547.4000000000001, 551.6938888888888, 561.4150000000001, 549.7005555555555, 558.7016666666669, 553.9788888888886, 553.3922222222222, 557.7405555555557, 553.0033333333332, 557.6533333333333, 549.7416666666668, 561.7811111111112, 559.8911111111113, 573.8594444444445, 571.3744444444447, 563.8283333333331, 564.0261111111113, 548.4394444444445, 555.3288888888887, 561.8444444444444, 564.1133333333336, 562.5977777777775, 550.4394444444443, 563.9322222222224, 569.6211111111111, 563.4000000000001, 560.0333333333332, 564.7488888888888, 557.5022222222224, 558.8349999999998, 559.7005555555554, 563.413888888889, 561.0266666666666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19951841169849782, "mean_inference_ms": 1.8106789988544205, "mean_action_processing_ms": 0.07551442972992753, "mean_env_wait_ms": 1.2282340802114842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005094051361083984, "StateBufferConnector_ms": 0.003039121627807617, "ViewRequirementAgentConnector_ms": 0.07059860229492188}, "num_episodes": 30, "episode_return_max": 581.9894444444449, "episode_return_min": 547.4000000000001, "episode_return_mean": 563.3771611111111, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 459300, "num_agent_steps_trained": 459000, "num_env_steps_sampled": 459300, "num_env_steps_trained": 459000, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 273.37776376735735, "num_env_steps_trained_throughput_per_sec": 258.98946041118063, "timesteps_total": 459300, "num_env_steps_sampled_lifetime": 459300, "num_agent_steps_sampled_lifetime": 459300, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 459300, "timers": {"training_iteration_time_ms": 10150.733, "restore_workers_time_ms": 0.012, "training_step_time_ms": 593.903, "sample_time_ms": 576.335, "synch_weights_time_ms": 15.935}, "counters": {"num_env_steps_sampled": 459300, "num_env_steps_trained": 459000, "num_agent_steps_sampled": 459300, "num_agent_steps_trained": 459000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3062, "num_samples_added_to_queue": 459300}, "done": false, "training_iteration": 155, "trial_id": "0313d_00000", "date": "2024-10-10_22-08-04", "timestamp": 1728594484, "time_this_iter_s": 10.443696022033691, "time_total_s": 1595.2103009223938, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42dca650>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1595.2103009223938, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 16.52, "ram_util_percent": 79.46000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 80960.71875, "policy_loss": 80673.8203125, "entropy": 10.622955322265625, "entropy_coeff": 0.01, "var_gnorm": 16.72300910949707, "vf_loss": 318761.8125, "vf_explained_var": 0.3677685856819153}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1540.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 462150, "num_env_steps_trained": 462000, "num_agent_steps_sampled": 462150, "num_agent_steps_trained": 462000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3081, "num_samples_added_to_queue": 462000, "learner_queue": {"size_count": 1540, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.445, "learner_load_time_ms": 0.19, "learner_load_wait_time_ms": 1031.886, "learner_dequeue_time_ms": 8584.863}}, "env_runners": {"episode_reward_max": 580.5105555555559, "episode_reward_min": 541.3116666666666, "episode_reward_mean": 561.3149722222222, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 541.3116666666666}, "policy_reward_max": {"default_policy": 580.5105555555559}, "policy_reward_mean": {"default_policy": 561.3149722222222}, "custom_metrics": {"num_consolidated_mean": 2.6863, "num_consolidated_min": 2.54, "num_consolidated_max": 2.81, "num_overloaded_mean": 0.0062, "num_overloaded_min": 0.0, "num_overloaded_max": 0.03, "num_moves_mean": 2.9410000000000003, "num_moves_min": 2.36, "num_moves_max": 3.36, "mean_accuracy_mean": 38.989669999999975, "mean_accuracy_min": 38.87066666666665, "mean_accuracy_max": 39.12399999999998, "num_model_switches_mean": 1.1853999999999998, "num_model_switches_min": 0.83, "num_model_switches_max": 1.43, "num_slav_mean": 0.000534, "num_slav_min": 6.666666666666667e-05, "num_slav_max": 0.0019166666666666668, "mean_cluster_cpu_util_mean": 0.503573457985356, "mean_cluster_cpu_util_min": 0.48757162309224206, "mean_cluster_cpu_util_max": 0.5236165732108204, "mean_cluster_mem_util_mean": 0.3110285902903356, "mean_cluster_mem_util_min": 0.3049110420433996, "mean_cluster_mem_util_max": 0.3177805530440025, "reward_consolidation_mean_mean": 3.7036111111111114, "reward_consolidation_mean_min": 3.527777777777778, "reward_consolidation_mean_max": 3.8611111111111107, "reward_illegal_mean_mean": -0.010333333333333337, "reward_illegal_mean_min": -0.05, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9373441666666664, "reward_accuracy_mean_min": 1.8945499999999995, "reward_accuracy_mean_max": 1.9542999999999995, "reward_sla_mean_mean": -0.017472222222222222, "reward_sla_mean_min": -0.06388888888888887, "reward_sla_mean_max": -0.0022222222222222222, "reward_consolidation_sum_mean": 370.36111111111114, "reward_consolidation_sum_min": 352.7777777777778, "reward_consolidation_sum_max": 386.1111111111111, "reward_illegal_sum_mean": -1.0333333333333332, "reward_illegal_sum_min": -5.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 193.73441666666656, "reward_accuracy_sum_min": 189.45499999999996, "reward_accuracy_sum_max": 195.42999999999995, "reward_sla_sum_mean": -1.747222222222222, "reward_sla_sum_min": -6.3888888888888875, "reward_sla_sum_max": -0.22222222222222224, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4163.0, "global_timestep_min": 2100, "global_timestep_max": 5800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [562.8683333333331, 566.8450000000001, 551.9388888888891, 549.3366666666667, 575.6227777777779, 569.6944444444447, 573.6294444444446, 554.5277777777775, 561.8761111111112, 565.2655555555558, 561.1466666666669, 559.1622222222222, 551.9711111111109, 562.0750000000002, 552.5266666666664, 573.6466666666671, 580.5105555555559, 557.5661111111112, 557.726111111111, 559.2566666666665, 556.1616666666664, 574.8200000000002, 556.6294444444443, 556.2811111111113, 550.8611111111113, 572.0105555555557, 553.9566666666666, 569.9716666666667, 555.4405555555556, 572.217777777778, 576.2255555555555, 570.7961111111114, 566.3683333333335, 567.2422222222224, 562.8833333333333, 564.8205555555556, 571.6466666666668, 555.5111111111113, 567.8838888888888, 555.3922222222221, 547.4000000000001, 551.6938888888888, 561.4150000000001, 549.7005555555555, 558.7016666666669, 553.9788888888886, 553.3922222222222, 557.7405555555557, 553.0033333333332, 557.6533333333333, 549.7416666666668, 561.7811111111112, 559.8911111111113, 573.8594444444445, 571.3744444444447, 563.8283333333331, 564.0261111111113, 548.4394444444445, 555.3288888888887, 561.8444444444444, 564.1133333333336, 562.5977777777775, 550.4394444444443, 563.9322222222224, 569.6211111111111, 563.4000000000001, 560.0333333333332, 564.7488888888888, 557.5022222222224, 558.8349999999998, 559.7005555555554, 563.413888888889, 561.0266666666666, 566.8988888888887, 568.3744444444447, 562.9227777777779, 553.185, 558.1699999999998, 562.8999999999999, 578.2716666666668, 552.1927777777777, 560.0888888888887, 566.6927777777778, 570.7561111111108, 577.5661111111112, 559.502222222222, 562.6933333333332, 541.3116666666666, 556.7877777777778, 547.296111111111, 555.843888888889, 557.883888888889, 569.3361111111111, 562.026666666667, 557.0733333333333, 556.5255555555556, 569.5905555555556, 560.4944444444444, 560.0588888888886, 558.5811111111111], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [562.8683333333331, 566.8450000000001, 551.9388888888891, 549.3366666666667, 575.6227777777779, 569.6944444444447, 573.6294444444446, 554.5277777777775, 561.8761111111112, 565.2655555555558, 561.1466666666669, 559.1622222222222, 551.9711111111109, 562.0750000000002, 552.5266666666664, 573.6466666666671, 580.5105555555559, 557.5661111111112, 557.726111111111, 559.2566666666665, 556.1616666666664, 574.8200000000002, 556.6294444444443, 556.2811111111113, 550.8611111111113, 572.0105555555557, 553.9566666666666, 569.9716666666667, 555.4405555555556, 572.217777777778, 576.2255555555555, 570.7961111111114, 566.3683333333335, 567.2422222222224, 562.8833333333333, 564.8205555555556, 571.6466666666668, 555.5111111111113, 567.8838888888888, 555.3922222222221, 547.4000000000001, 551.6938888888888, 561.4150000000001, 549.7005555555555, 558.7016666666669, 553.9788888888886, 553.3922222222222, 557.7405555555557, 553.0033333333332, 557.6533333333333, 549.7416666666668, 561.7811111111112, 559.8911111111113, 573.8594444444445, 571.3744444444447, 563.8283333333331, 564.0261111111113, 548.4394444444445, 555.3288888888887, 561.8444444444444, 564.1133333333336, 562.5977777777775, 550.4394444444443, 563.9322222222224, 569.6211111111111, 563.4000000000001, 560.0333333333332, 564.7488888888888, 557.5022222222224, 558.8349999999998, 559.7005555555554, 563.413888888889, 561.0266666666666, 566.8988888888887, 568.3744444444447, 562.9227777777779, 553.185, 558.1699999999998, 562.8999999999999, 578.2716666666668, 552.1927777777777, 560.0888888888887, 566.6927777777778, 570.7561111111108, 577.5661111111112, 559.502222222222, 562.6933333333332, 541.3116666666666, 556.7877777777778, 547.296111111111, 555.843888888889, 557.883888888889, 569.3361111111111, 562.026666666667, 557.0733333333333, 556.5255555555556, 569.5905555555556, 560.4944444444444, 560.0588888888886, 558.5811111111111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19957046487628283, "mean_inference_ms": 1.8109093540921009, "mean_action_processing_ms": 0.0755268939020492, "mean_env_wait_ms": 1.228373960186208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049419403076171875, "StateBufferConnector_ms": 0.003084897994995117, "ViewRequirementAgentConnector_ms": 0.07191872596740723}, "num_episodes": 27, "episode_return_max": 580.5105555555559, "episode_return_min": 541.3116666666666, "episode_return_mean": 561.3149722222222, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 462150, "num_agent_steps_trained": 462000, "num_env_steps_sampled": 462150, "num_env_steps_trained": 462000, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 278.53408148015075, "num_env_steps_trained_throughput_per_sec": 293.19376997910604, "timesteps_total": 462150, "num_env_steps_sampled_lifetime": 462150, "num_agent_steps_sampled_lifetime": 462150, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 462150, "timers": {"training_iteration_time_ms": 10143.331, "restore_workers_time_ms": 0.01, "training_step_time_ms": 521.034, "sample_time_ms": 505.659, "synch_weights_time_ms": 13.797}, "counters": {"num_env_steps_sampled": 462150, "num_env_steps_trained": 462000, "num_agent_steps_sampled": 462150, "num_agent_steps_trained": 462000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3081, "num_samples_added_to_queue": 462000}, "done": false, "training_iteration": 156, "trial_id": "0313d_00000", "date": "2024-10-10_22-08-15", "timestamp": 1728594495, "time_this_iter_s": 10.242857217788696, "time_total_s": 1605.4531581401825, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae402cd330>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1605.4531581401825, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 15.042857142857143, "ram_util_percent": 79.72857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 78020.8359375, "policy_loss": 77767.96875, "entropy": 10.486961364746094, "entropy_coeff": 0.01, "var_gnorm": 16.72762107849121, "vf_loss": 284327.0625, "vf_explained_var": 0.3919742703437805}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1549.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 465000, "num_env_steps_trained": 464700, "num_agent_steps_sampled": 465000, "num_agent_steps_trained": 464700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3100, "num_samples_added_to_queue": 465000, "learner_queue": {"size_count": 1549, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.41, "learner_load_time_ms": 0.232, "learner_load_wait_time_ms": 1028.521, "learner_dequeue_time_ms": 8574.237}}, "env_runners": {"episode_reward_max": 578.2716666666668, "episode_reward_min": 524.2805555555555, "episode_reward_mean": 558.4188666666668, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 524.2805555555555}, "policy_reward_max": {"default_policy": 578.2716666666668}, "policy_reward_mean": {"default_policy": 558.4188666666668}, "custom_metrics": {"num_consolidated_mean": 2.6733, "num_consolidated_min": 2.54, "num_consolidated_max": 2.81, "num_overloaded_mean": 0.0074, "num_overloaded_min": 0.0, "num_overloaded_max": 0.03, "num_moves_mean": 3.0316, "num_moves_min": 2.5, "num_moves_max": 3.42, "mean_accuracy_mean": 39.02355333333332, "mean_accuracy_min": 38.87066666666665, "mean_accuracy_max": 39.13033333333331, "num_model_switches_mean": 1.1906999999999999, "num_model_switches_min": 0.86, "num_model_switches_max": 1.58, "num_slav_mean": 0.0006401666666666665, "num_slav_min": 6.666666666666667e-05, "num_slav_max": 0.00255, "mean_cluster_cpu_util_mean": 0.5032840843897093, "mean_cluster_cpu_util_min": 0.48757162309224206, "mean_cluster_cpu_util_max": 0.5236165732108204, "mean_cluster_mem_util_mean": 0.3106985953134418, "mean_cluster_mem_util_min": 0.3049110420433996, "mean_cluster_mem_util_max": 0.3177805530440025, "reward_consolidation_mean_mean": 3.6808333333333336, "reward_consolidation_mean_min": 3.4305555555555567, "reward_consolidation_mean_max": 3.8472222222222228, "reward_illegal_mean_mean": -0.012333333333333332, "reward_illegal_mean_min": -0.05, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.936705333333333, "reward_accuracy_mean_min": 1.8939166666666665, "reward_accuracy_mean_max": 1.9555666666666665, "reward_sla_mean_mean": -0.021016666666666666, "reward_sla_mean_min": -0.085, "reward_sla_mean_max": -0.0022222222222222222, "reward_consolidation_sum_mean": 368.08333333333337, "reward_consolidation_sum_min": 343.05555555555566, "reward_consolidation_sum_max": 384.7222222222223, "reward_illegal_sum_mean": -1.2333333333333332, "reward_illegal_sum_min": -5.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 193.6705333333333, "reward_accuracy_sum_min": 189.39166666666665, "reward_accuracy_sum_max": 195.55666666666664, "reward_sla_sum_mean": -2.101666666666666, "reward_sla_sum_min": -8.5, "reward_sla_sum_max": -0.22222222222222224, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5157.0, "global_timestep_min": 3000, "global_timestep_max": 6800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [576.2255555555555, 570.7961111111114, 566.3683333333335, 567.2422222222224, 562.8833333333333, 564.8205555555556, 571.6466666666668, 555.5111111111113, 567.8838888888888, 555.3922222222221, 547.4000000000001, 551.6938888888888, 561.4150000000001, 549.7005555555555, 558.7016666666669, 553.9788888888886, 553.3922222222222, 557.7405555555557, 553.0033333333332, 557.6533333333333, 549.7416666666668, 561.7811111111112, 559.8911111111113, 573.8594444444445, 571.3744444444447, 563.8283333333331, 564.0261111111113, 548.4394444444445, 555.3288888888887, 561.8444444444444, 564.1133333333336, 562.5977777777775, 550.4394444444443, 563.9322222222224, 569.6211111111111, 563.4000000000001, 560.0333333333332, 564.7488888888888, 557.5022222222224, 558.8349999999998, 559.7005555555554, 563.413888888889, 561.0266666666666, 566.8988888888887, 568.3744444444447, 562.9227777777779, 553.185, 558.1699999999998, 562.8999999999999, 578.2716666666668, 552.1927777777777, 560.0888888888887, 566.6927777777778, 570.7561111111108, 577.5661111111112, 559.502222222222, 562.6933333333332, 541.3116666666666, 556.7877777777778, 547.296111111111, 555.843888888889, 557.883888888889, 569.3361111111111, 562.026666666667, 557.0733333333333, 556.5255555555556, 569.5905555555556, 560.4944444444444, 560.0588888888886, 558.5811111111111, 534.6999999999998, 560.1044444444444, 555.8922222222222, 551.3283333333333, 550.3111111111111, 566.5566666666664, 528.6049999999998, 550.6927777777776, 554.7955555555556, 570.6450000000001, 558.8516666666668, 545.3038888888887, 572.6211111111111, 550.7638888888886, 524.2805555555555, 557.5972222222221, 555.1288888888886, 539.9311111111109, 560.065, 559.4144444444446, 552.2322222222222, 554.375, 545.5016666666666, 551.6844444444442, 542.2405555555554, 551.2316666666667, 575.4544444444443, 547.7872222222217, 559.4222222222221, 548.4144444444441], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [576.2255555555555, 570.7961111111114, 566.3683333333335, 567.2422222222224, 562.8833333333333, 564.8205555555556, 571.6466666666668, 555.5111111111113, 567.8838888888888, 555.3922222222221, 547.4000000000001, 551.6938888888888, 561.4150000000001, 549.7005555555555, 558.7016666666669, 553.9788888888886, 553.3922222222222, 557.7405555555557, 553.0033333333332, 557.6533333333333, 549.7416666666668, 561.7811111111112, 559.8911111111113, 573.8594444444445, 571.3744444444447, 563.8283333333331, 564.0261111111113, 548.4394444444445, 555.3288888888887, 561.8444444444444, 564.1133333333336, 562.5977777777775, 550.4394444444443, 563.9322222222224, 569.6211111111111, 563.4000000000001, 560.0333333333332, 564.7488888888888, 557.5022222222224, 558.8349999999998, 559.7005555555554, 563.413888888889, 561.0266666666666, 566.8988888888887, 568.3744444444447, 562.9227777777779, 553.185, 558.1699999999998, 562.8999999999999, 578.2716666666668, 552.1927777777777, 560.0888888888887, 566.6927777777778, 570.7561111111108, 577.5661111111112, 559.502222222222, 562.6933333333332, 541.3116666666666, 556.7877777777778, 547.296111111111, 555.843888888889, 557.883888888889, 569.3361111111111, 562.026666666667, 557.0733333333333, 556.5255555555556, 569.5905555555556, 560.4944444444444, 560.0588888888886, 558.5811111111111, 534.6999999999998, 560.1044444444444, 555.8922222222222, 551.3283333333333, 550.3111111111111, 566.5566666666664, 528.6049999999998, 550.6927777777776, 554.7955555555556, 570.6450000000001, 558.8516666666668, 545.3038888888887, 572.6211111111111, 550.7638888888886, 524.2805555555555, 557.5972222222221, 555.1288888888886, 539.9311111111109, 560.065, 559.4144444444446, 552.2322222222222, 554.375, 545.5016666666666, 551.6844444444442, 542.2405555555554, 551.2316666666667, 575.4544444444443, 547.7872222222217, 559.4222222222221, 548.4144444444441]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19962872673832863, "mean_inference_ms": 1.8111735295855202, "mean_action_processing_ms": 0.07554276887107612, "mean_env_wait_ms": 1.2285470038472397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004714250564575195, "StateBufferConnector_ms": 0.0030837059020996094, "ViewRequirementAgentConnector_ms": 0.07134318351745605}, "num_episodes": 30, "episode_return_max": 578.2716666666668, "episode_return_min": 524.2805555555555, "episode_return_mean": 558.4188666666668, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 465000, "num_agent_steps_trained": 464700, "num_env_steps_sampled": 465000, "num_env_steps_trained": 464700, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 276.7641768934117, "num_env_steps_trained_throughput_per_sec": 262.19764126744263, "timesteps_total": 465000, "num_env_steps_sampled_lifetime": 465000, "num_agent_steps_sampled_lifetime": 465000, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 465000, "timers": {"training_iteration_time_ms": 10163.595, "restore_workers_time_ms": 0.011, "training_step_time_ms": 560.147, "sample_time_ms": 545.579, "synch_weights_time_ms": 13.147}, "counters": {"num_env_steps_sampled": 465000, "num_env_steps_trained": 464700, "num_agent_steps_sampled": 465000, "num_agent_steps_trained": 464700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3100, "num_samples_added_to_queue": 465000}, "done": false, "training_iteration": 157, "trial_id": "0313d_00000", "date": "2024-10-10_22-08-25", "timestamp": 1728594505, "time_this_iter_s": 10.307631254196167, "time_total_s": 1615.7607893943787, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42db6f80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1615.7607893943787, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 14.073333333333334, "ram_util_percent": 79.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 72223.8125, "policy_loss": 71972.671875, "entropy": 10.055248260498047, "entropy_coeff": 0.01, "var_gnorm": 16.738182067871094, "vf_loss": 281302.875, "vf_explained_var": 0.39670896530151367}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1558.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 467700, "num_env_steps_trained": 467400, "num_agent_steps_sampled": 467700, "num_agent_steps_trained": 467400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3118, "num_samples_added_to_queue": 467700, "learner_queue": {"size_count": 1558, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 74.444, "learner_load_time_ms": 0.244, "learner_load_wait_time_ms": 1093.238, "learner_dequeue_time_ms": 8590.927}}, "env_runners": {"episode_reward_max": 578.2716666666668, "episode_reward_min": 524.2805555555555, "episode_reward_mean": 557.2281055555554, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 524.2805555555555}, "policy_reward_max": {"default_policy": 578.2716666666668}, "policy_reward_mean": {"default_policy": 557.2281055555554}, "custom_metrics": {"num_consolidated_mean": 2.6767999999999996, "num_consolidated_min": 2.54, "num_consolidated_max": 2.81, "num_overloaded_mean": 0.009899999999999999, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 3.0430999999999995, "num_moves_min": 2.55, "num_moves_max": 3.42, "mean_accuracy_mean": 39.05217999999998, "mean_accuracy_min": 38.92766666666665, "mean_accuracy_max": 39.22533333333332, "num_model_switches_mean": 1.1754999999999998, "num_model_switches_min": 0.83, "num_model_switches_max": 1.58, "num_slav_mean": 0.0006070000000000001, "num_slav_min": 6.666666666666667e-05, "num_slav_max": 0.00255, "mean_cluster_cpu_util_mean": 0.5044533206783764, "mean_cluster_cpu_util_min": 0.48757162309224206, "mean_cluster_cpu_util_max": 0.5236165732108204, "mean_cluster_mem_util_mean": 0.3110410459488648, "mean_cluster_mem_util_min": 0.3049110420433996, "mean_cluster_mem_util_max": 0.3177805530440025, "reward_consolidation_mean_mean": 3.67513888888889, "reward_consolidation_mean_min": 3.4305555555555567, "reward_consolidation_mean_max": 3.833333333333334, "reward_illegal_mean_mean": -0.016500000000000004, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9332588333333327, "reward_accuracy_mean_min": 1.873683333333333, "reward_accuracy_mean_max": 1.9571499999999997, "reward_sla_mean_mean": -0.019616666666666668, "reward_sla_mean_min": -0.085, "reward_sla_mean_max": -0.0022222222222222222, "reward_consolidation_sum_mean": 367.51388888888897, "reward_consolidation_sum_min": 343.05555555555566, "reward_consolidation_sum_max": 383.33333333333337, "reward_illegal_sum_mean": -1.6500000000000004, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 193.32588333333334, "reward_accuracy_sum_min": 187.36833333333328, "reward_accuracy_sum_max": 195.71499999999997, "reward_sla_sum_mean": -1.9616666666666667, "reward_sla_sum_min": -8.5, "reward_sla_sum_max": -0.22222222222222224, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6058.0, "global_timestep_min": 4000, "global_timestep_max": 7700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [548.4394444444445, 555.3288888888887, 561.8444444444444, 564.1133333333336, 562.5977777777775, 550.4394444444443, 563.9322222222224, 569.6211111111111, 563.4000000000001, 560.0333333333332, 564.7488888888888, 557.5022222222224, 558.8349999999998, 559.7005555555554, 563.413888888889, 561.0266666666666, 566.8988888888887, 568.3744444444447, 562.9227777777779, 553.185, 558.1699999999998, 562.8999999999999, 578.2716666666668, 552.1927777777777, 560.0888888888887, 566.6927777777778, 570.7561111111108, 577.5661111111112, 559.502222222222, 562.6933333333332, 541.3116666666666, 556.7877777777778, 547.296111111111, 555.843888888889, 557.883888888889, 569.3361111111111, 562.026666666667, 557.0733333333333, 556.5255555555556, 569.5905555555556, 560.4944444444444, 560.0588888888886, 558.5811111111111, 534.6999999999998, 560.1044444444444, 555.8922222222222, 551.3283333333333, 550.3111111111111, 566.5566666666664, 528.6049999999998, 550.6927777777776, 554.7955555555556, 570.6450000000001, 558.8516666666668, 545.3038888888887, 572.6211111111111, 550.7638888888886, 524.2805555555555, 557.5972222222221, 555.1288888888886, 539.9311111111109, 560.065, 559.4144444444446, 552.2322222222222, 554.375, 545.5016666666666, 551.6844444444442, 542.2405555555554, 551.2316666666667, 575.4544444444443, 547.7872222222217, 559.4222222222221, 548.4144444444441, 547.7555555555554, 568.8194444444446, 555.3194444444442, 556.7633333333332, 550.963888888889, 559.5094444444443, 563.6838888888889, 554.7950000000001, 575.4783333333331, 567.0594444444446, 537.3583333333332, 563.9444444444446, 539.6461111111109, 559.5644444444443, 547.2555555555556, 564.7477777777777, 559.1038888888886, 572.5805555555556, 554.382777777778, 540.042222222222, 545.5327777777775, 555.8749999999995, 539.4705555555554, 564.4222222222223, 550.1216666666668, 571.2316666666666, 563.4477777777777], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [548.4394444444445, 555.3288888888887, 561.8444444444444, 564.1133333333336, 562.5977777777775, 550.4394444444443, 563.9322222222224, 569.6211111111111, 563.4000000000001, 560.0333333333332, 564.7488888888888, 557.5022222222224, 558.8349999999998, 559.7005555555554, 563.413888888889, 561.0266666666666, 566.8988888888887, 568.3744444444447, 562.9227777777779, 553.185, 558.1699999999998, 562.8999999999999, 578.2716666666668, 552.1927777777777, 560.0888888888887, 566.6927777777778, 570.7561111111108, 577.5661111111112, 559.502222222222, 562.6933333333332, 541.3116666666666, 556.7877777777778, 547.296111111111, 555.843888888889, 557.883888888889, 569.3361111111111, 562.026666666667, 557.0733333333333, 556.5255555555556, 569.5905555555556, 560.4944444444444, 560.0588888888886, 558.5811111111111, 534.6999999999998, 560.1044444444444, 555.8922222222222, 551.3283333333333, 550.3111111111111, 566.5566666666664, 528.6049999999998, 550.6927777777776, 554.7955555555556, 570.6450000000001, 558.8516666666668, 545.3038888888887, 572.6211111111111, 550.7638888888886, 524.2805555555555, 557.5972222222221, 555.1288888888886, 539.9311111111109, 560.065, 559.4144444444446, 552.2322222222222, 554.375, 545.5016666666666, 551.6844444444442, 542.2405555555554, 551.2316666666667, 575.4544444444443, 547.7872222222217, 559.4222222222221, 548.4144444444441, 547.7555555555554, 568.8194444444446, 555.3194444444442, 556.7633333333332, 550.963888888889, 559.5094444444443, 563.6838888888889, 554.7950000000001, 575.4783333333331, 567.0594444444446, 537.3583333333332, 563.9444444444446, 539.6461111111109, 559.5644444444443, 547.2555555555556, 564.7477777777777, 559.1038888888886, 572.5805555555556, 554.382777777778, 540.042222222222, 545.5327777777775, 555.8749999999995, 539.4705555555554, 564.4222222222223, 550.1216666666668, 571.2316666666666, 563.4477777777777]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19966998907405079, "mean_inference_ms": 1.810348245791254, "mean_action_processing_ms": 0.07555067462796314, "mean_env_wait_ms": 1.228618129328018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049211978912353516, "StateBufferConnector_ms": 0.003133535385131836, "ViewRequirementAgentConnector_ms": 0.07359051704406738}, "num_episodes": 27, "episode_return_max": 578.2716666666668, "episode_return_min": 524.2805555555555, "episode_return_mean": 557.2281055555554, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 467700, "num_agent_steps_trained": 467400, "num_env_steps_sampled": 467700, "num_env_steps_trained": 467400, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 260.0877474725916, "num_env_steps_trained_throughput_per_sec": 260.0877474725916, "timesteps_total": 467700, "num_env_steps_sampled_lifetime": 467700, "num_agent_steps_sampled_lifetime": 467700, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 467700, "timers": {"training_iteration_time_ms": 10189.91, "restore_workers_time_ms": 0.012, "training_step_time_ms": 581.895, "sample_time_ms": 565.693, "synch_weights_time_ms": 14.645}, "counters": {"num_env_steps_sampled": 467700, "num_env_steps_trained": 467400, "num_agent_steps_sampled": 467700, "num_agent_steps_trained": 467400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3118, "num_samples_added_to_queue": 467700}, "done": false, "training_iteration": 158, "trial_id": "0313d_00000", "date": "2024-10-10_22-08-35", "timestamp": 1728594515, "time_this_iter_s": 10.391179084777832, "time_total_s": 1626.1519684791565, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c2ac20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1626.1519684791565, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 14.853333333333333, "ram_util_percent": 79.78666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 63766.15234375, "policy_loss": 63502.40234375, "entropy": 8.950443267822266, "entropy_coeff": 0.01, "var_gnorm": 16.753625869750977, "vf_loss": 290599.78125, "vf_explained_var": 0.42080360651016235}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1568.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 470550, "num_env_steps_trained": 470400, "num_agent_steps_sampled": 470550, "num_agent_steps_trained": 470400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3137, "num_samples_added_to_queue": 470400, "learner_queue": {"size_count": 1568, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.989, "learner_load_time_ms": 0.269, "learner_load_wait_time_ms": 1060.137, "learner_dequeue_time_ms": 8645.119}}, "env_runners": {"episode_reward_max": 587.5255555555555, "episode_reward_min": 524.2805555555555, "episode_reward_mean": 559.0303166666666, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 524.2805555555555}, "policy_reward_max": {"default_policy": 587.5255555555555}, "policy_reward_mean": {"default_policy": 559.0303166666666}, "custom_metrics": {"num_consolidated_mean": 2.696099999999999, "num_consolidated_min": 2.54, "num_consolidated_max": 2.83, "num_overloaded_mean": 0.0109, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 2.9187000000000007, "num_moves_min": 2.29, "num_moves_max": 3.42, "mean_accuracy_mean": 39.06788666666665, "mean_accuracy_min": 38.940333333333314, "mean_accuracy_max": 39.22533333333332, "num_model_switches_mean": 1.1067, "num_model_switches_min": 0.69, "num_model_switches_max": 1.58, "num_slav_mean": 0.0006605000000000001, "num_slav_min": 6.666666666666667e-05, "num_slav_max": 0.0026, "mean_cluster_cpu_util_mean": 0.5063887655713698, "mean_cluster_cpu_util_min": 0.48757162309224206, "mean_cluster_cpu_util_max": 0.5236165732108204, "mean_cluster_mem_util_mean": 0.3116890028075576, "mean_cluster_mem_util_min": 0.3049110420433996, "mean_cluster_mem_util_max": 0.3177805530440025, "reward_consolidation_mean_mean": 3.6977777777777776, "reward_consolidation_mean_min": 3.4305555555555567, "reward_consolidation_mean_max": 3.9305555555555554, "reward_illegal_mean_mean": -0.018166666666666668, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9321031666666661, "reward_accuracy_mean_min": 1.873683333333333, "reward_accuracy_mean_max": 1.9577833333333334, "reward_sla_mean_mean": -0.02141111111111111, "reward_sla_mean_min": -0.08666666666666666, "reward_sla_mean_max": -0.0022222222222222222, "reward_consolidation_sum_mean": 369.7777777777778, "reward_consolidation_sum_min": 343.05555555555566, "reward_consolidation_sum_max": 393.05555555555554, "reward_illegal_sum_mean": -1.8166666666666667, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 193.2103166666666, "reward_accuracy_sum_min": 187.36833333333328, "reward_accuracy_sum_max": 195.77833333333334, "reward_sla_sum_mean": -2.141111111111111, "reward_sla_sum_min": -8.666666666666666, "reward_sla_sum_max": -0.22222222222222224, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5089.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [577.5661111111112, 559.502222222222, 562.6933333333332, 541.3116666666666, 556.7877777777778, 547.296111111111, 555.843888888889, 557.883888888889, 569.3361111111111, 562.026666666667, 557.0733333333333, 556.5255555555556, 569.5905555555556, 560.4944444444444, 560.0588888888886, 558.5811111111111, 534.6999999999998, 560.1044444444444, 555.8922222222222, 551.3283333333333, 550.3111111111111, 566.5566666666664, 528.6049999999998, 550.6927777777776, 554.7955555555556, 570.6450000000001, 558.8516666666668, 545.3038888888887, 572.6211111111111, 550.7638888888886, 524.2805555555555, 557.5972222222221, 555.1288888888886, 539.9311111111109, 560.065, 559.4144444444446, 552.2322222222222, 554.375, 545.5016666666666, 551.6844444444442, 542.2405555555554, 551.2316666666667, 575.4544444444443, 547.7872222222217, 559.4222222222221, 548.4144444444441, 547.7555555555554, 568.8194444444446, 555.3194444444442, 556.7633333333332, 550.963888888889, 559.5094444444443, 563.6838888888889, 554.7950000000001, 575.4783333333331, 567.0594444444446, 537.3583333333332, 563.9444444444446, 539.6461111111109, 559.5644444444443, 547.2555555555556, 564.7477777777777, 559.1038888888886, 572.5805555555556, 554.382777777778, 540.042222222222, 545.5327777777775, 555.8749999999995, 539.4705555555554, 564.4222222222223, 550.1216666666668, 571.2316666666666, 563.4477777777777, 559.8027777777777, 575.596111111111, 577.056111111111, 570.9377777777777, 565.0027777777776, 565.8199999999999, 568.9061111111112, 575.5577777777776, 580.8894444444444, 552.7722222222221, 560.3288888888889, 566.2561111111113, 557.0183333333332, 560.7161111111112, 570.161111111111, 587.5255555555555, 576.636666666667, 569.2794444444445, 575.6766666666667, 566.0172222222221, 566.8755555555557, 558.8655555555555, 550.5344444444445, 543.223888888889, 582.2311111111112, 581.1283333333333, 580.8355555555555], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [577.5661111111112, 559.502222222222, 562.6933333333332, 541.3116666666666, 556.7877777777778, 547.296111111111, 555.843888888889, 557.883888888889, 569.3361111111111, 562.026666666667, 557.0733333333333, 556.5255555555556, 569.5905555555556, 560.4944444444444, 560.0588888888886, 558.5811111111111, 534.6999999999998, 560.1044444444444, 555.8922222222222, 551.3283333333333, 550.3111111111111, 566.5566666666664, 528.6049999999998, 550.6927777777776, 554.7955555555556, 570.6450000000001, 558.8516666666668, 545.3038888888887, 572.6211111111111, 550.7638888888886, 524.2805555555555, 557.5972222222221, 555.1288888888886, 539.9311111111109, 560.065, 559.4144444444446, 552.2322222222222, 554.375, 545.5016666666666, 551.6844444444442, 542.2405555555554, 551.2316666666667, 575.4544444444443, 547.7872222222217, 559.4222222222221, 548.4144444444441, 547.7555555555554, 568.8194444444446, 555.3194444444442, 556.7633333333332, 550.963888888889, 559.5094444444443, 563.6838888888889, 554.7950000000001, 575.4783333333331, 567.0594444444446, 537.3583333333332, 563.9444444444446, 539.6461111111109, 559.5644444444443, 547.2555555555556, 564.7477777777777, 559.1038888888886, 572.5805555555556, 554.382777777778, 540.042222222222, 545.5327777777775, 555.8749999999995, 539.4705555555554, 564.4222222222223, 550.1216666666668, 571.2316666666666, 563.4477777777777, 559.8027777777777, 575.596111111111, 577.056111111111, 570.9377777777777, 565.0027777777776, 565.8199999999999, 568.9061111111112, 575.5577777777776, 580.8894444444444, 552.7722222222221, 560.3288888888889, 566.2561111111113, 557.0183333333332, 560.7161111111112, 570.161111111111, 587.5255555555555, 576.636666666667, 569.2794444444445, 575.6766666666667, 566.0172222222221, 566.8755555555557, 558.8655555555555, 550.5344444444445, 543.223888888889, 582.2311111111112, 581.1283333333333, 580.8355555555555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19974594648709057, "mean_inference_ms": 1.8111277342307894, "mean_action_processing_ms": 0.07558053366151465, "mean_env_wait_ms": 1.229026358263568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048563480377197266, "StateBufferConnector_ms": 0.003103971481323242, "ViewRequirementAgentConnector_ms": 0.07323670387268066}, "num_episodes": 27, "episode_return_max": 587.5255555555555, "episode_return_min": 524.2805555555555, "episode_return_mean": 559.0303166666666, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 470550, "num_agent_steps_trained": 470400, "num_env_steps_sampled": 470550, "num_env_steps_trained": 470400, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 272.1098997651282, "num_env_steps_trained_throughput_per_sec": 286.43147343697706, "timesteps_total": 470550, "num_env_steps_sampled_lifetime": 470550, "num_agent_steps_sampled_lifetime": 470550, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 470550, "timers": {"training_iteration_time_ms": 10234.256, "restore_workers_time_ms": 0.012, "training_step_time_ms": 538.098, "sample_time_ms": 523.448, "synch_weights_time_ms": 13.242}, "counters": {"num_env_steps_sampled": 470550, "num_env_steps_trained": 470400, "num_agent_steps_sampled": 470550, "num_agent_steps_trained": 470400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3137, "num_samples_added_to_queue": 470400}, "done": false, "training_iteration": 159, "trial_id": "0313d_00000", "date": "2024-10-10_22-08-46", "timestamp": 1728594526, "time_this_iter_s": 10.490814924240112, "time_total_s": 1636.6427834033966, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae402cd450>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1636.6427834033966, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 13.706666666666667, "ram_util_percent": 79.88000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 55599.65625, "policy_loss": 55365.85546875, "entropy": 9.10185718536377, "entropy_coeff": 0.01, "var_gnorm": 16.760160446166992, "vf_loss": 261104.9375, "vf_explained_var": 0.4332842230796814}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1578.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 473700, "num_env_steps_trained": 473400, "num_agent_steps_sampled": 473700, "num_agent_steps_trained": 473400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3158, "num_samples_added_to_queue": 473700, "learner_queue": {"size_count": 1578, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 51.617, "learner_load_time_ms": 0.25, "learner_load_wait_time_ms": 943.975, "learner_dequeue_time_ms": 8672.679}}, "env_runners": {"episode_reward_max": 593.7155555555555, "episode_reward_min": 537.3583333333332, "episode_reward_mean": 564.4553444444444, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 537.3583333333332}, "policy_reward_max": {"default_policy": 593.7155555555555}, "policy_reward_mean": {"default_policy": 564.4553444444444}, "custom_metrics": {"num_consolidated_mean": 2.7420999999999993, "num_consolidated_min": 2.57, "num_consolidated_max": 2.87, "num_overloaded_mean": 0.0125, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 2.707900000000001, "num_moves_min": 2.17, "num_moves_max": 3.34, "mean_accuracy_mean": 39.075359999999975, "mean_accuracy_min": 38.90866666666665, "mean_accuracy_max": 39.22533333333332, "num_model_switches_mean": 1.008, "num_model_switches_min": 0.69, "num_model_switches_max": 1.58, "num_slav_mean": 0.0005873333333333333, "num_slav_min": 6.666666666666667e-05, "num_slav_max": 0.0026, "mean_cluster_cpu_util_mean": 0.5104150271709037, "mean_cluster_cpu_util_min": 0.4954462329282995, "mean_cluster_cpu_util_max": 0.5237318080677167, "mean_cluster_mem_util_mean": 0.31315721661607676, "mean_cluster_mem_util_min": 0.3071291537501077, "mean_cluster_mem_util_max": 0.3184918760225609, "reward_consolidation_mean_mean": 3.755277777777778, "reward_consolidation_mean_min": 3.5277777777777777, "reward_consolidation_mean_max": 3.986111111111112, "reward_illegal_mean_mean": -0.02083333333333333, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9293756666666666, "reward_accuracy_mean_min": 1.873683333333333, "reward_accuracy_mean_max": 1.9577833333333334, "reward_sla_mean_mean": -0.01926666666666666, "reward_sla_mean_min": -0.08666666666666666, "reward_sla_mean_max": -0.0022222222222222222, "reward_consolidation_sum_mean": 375.5277777777779, "reward_consolidation_sum_min": 352.77777777777777, "reward_consolidation_sum_max": 398.6111111111112, "reward_illegal_sum_mean": -2.0833333333333335, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 192.93756666666664, "reward_accuracy_sum_min": 187.36833333333328, "reward_accuracy_sum_max": 195.77833333333334, "reward_sla_sum_mean": -1.9266666666666667, "reward_sla_sum_min": -8.666666666666666, "reward_sla_sum_max": -0.22222222222222224, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3611.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [539.9311111111109, 560.065, 559.4144444444446, 552.2322222222222, 554.375, 545.5016666666666, 551.6844444444442, 542.2405555555554, 551.2316666666667, 575.4544444444443, 547.7872222222217, 559.4222222222221, 548.4144444444441, 547.7555555555554, 568.8194444444446, 555.3194444444442, 556.7633333333332, 550.963888888889, 559.5094444444443, 563.6838888888889, 554.7950000000001, 575.4783333333331, 567.0594444444446, 537.3583333333332, 563.9444444444446, 539.6461111111109, 559.5644444444443, 547.2555555555556, 564.7477777777777, 559.1038888888886, 572.5805555555556, 554.382777777778, 540.042222222222, 545.5327777777775, 555.8749999999995, 539.4705555555554, 564.4222222222223, 550.1216666666668, 571.2316666666666, 563.4477777777777, 559.8027777777777, 575.596111111111, 577.056111111111, 570.9377777777777, 565.0027777777776, 565.8199999999999, 568.9061111111112, 575.5577777777776, 580.8894444444444, 552.7722222222221, 560.3288888888889, 566.2561111111113, 557.0183333333332, 560.7161111111112, 570.161111111111, 587.5255555555555, 576.636666666667, 569.2794444444445, 575.6766666666667, 566.0172222222221, 566.8755555555557, 558.8655555555555, 550.5344444444445, 543.223888888889, 582.2311111111112, 581.1283333333333, 580.8355555555555, 549.9783333333335, 584.3111111111111, 576.2872222222222, 570.4227777777777, 579.8277777777777, 563.5205555555557, 575.9861111111111, 593.7155555555555, 581.7644444444445, 578.1294444444446, 572.24, 550.2094444444444, 575.0505555555554, 565.1772222222222, 560.6766666666664, 578.2005555555556, 554.1766666666666, 577.256111111111, 571.438888888889, 580.9300000000002, 561.4144444444445, 579.4616666666665, 568.5416666666667, 570.3905555555556, 574.3588888888887, 580.2316666666668, 568.9538888888887, 585.1922222222224, 572.1055555555556, 565.296666666667, 571.0500000000003, 573.1444444444443, 573.8116666666668], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [539.9311111111109, 560.065, 559.4144444444446, 552.2322222222222, 554.375, 545.5016666666666, 551.6844444444442, 542.2405555555554, 551.2316666666667, 575.4544444444443, 547.7872222222217, 559.4222222222221, 548.4144444444441, 547.7555555555554, 568.8194444444446, 555.3194444444442, 556.7633333333332, 550.963888888889, 559.5094444444443, 563.6838888888889, 554.7950000000001, 575.4783333333331, 567.0594444444446, 537.3583333333332, 563.9444444444446, 539.6461111111109, 559.5644444444443, 547.2555555555556, 564.7477777777777, 559.1038888888886, 572.5805555555556, 554.382777777778, 540.042222222222, 545.5327777777775, 555.8749999999995, 539.4705555555554, 564.4222222222223, 550.1216666666668, 571.2316666666666, 563.4477777777777, 559.8027777777777, 575.596111111111, 577.056111111111, 570.9377777777777, 565.0027777777776, 565.8199999999999, 568.9061111111112, 575.5577777777776, 580.8894444444444, 552.7722222222221, 560.3288888888889, 566.2561111111113, 557.0183333333332, 560.7161111111112, 570.161111111111, 587.5255555555555, 576.636666666667, 569.2794444444445, 575.6766666666667, 566.0172222222221, 566.8755555555557, 558.8655555555555, 550.5344444444445, 543.223888888889, 582.2311111111112, 581.1283333333333, 580.8355555555555, 549.9783333333335, 584.3111111111111, 576.2872222222222, 570.4227777777777, 579.8277777777777, 563.5205555555557, 575.9861111111111, 593.7155555555555, 581.7644444444445, 578.1294444444446, 572.24, 550.2094444444444, 575.0505555555554, 565.1772222222222, 560.6766666666664, 578.2005555555556, 554.1766666666666, 577.256111111111, 571.438888888889, 580.9300000000002, 561.4144444444445, 579.4616666666665, 568.5416666666667, 570.3905555555556, 574.3588888888887, 580.2316666666668, 568.9538888888887, 585.1922222222224, 572.1055555555556, 565.296666666667, 571.0500000000003, 573.1444444444443, 573.8116666666668]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19983232669864315, "mean_inference_ms": 1.8129634339981582, "mean_action_processing_ms": 0.07561801344570393, "mean_env_wait_ms": 1.2294934425354602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004591464996337891, "StateBufferConnector_ms": 0.0030062198638916016, "ViewRequirementAgentConnector_ms": 0.0696573257446289}, "num_episodes": 33, "episode_return_max": 593.7155555555555, "episode_return_min": 537.3583333333332, "episode_return_mean": 564.4553444444444, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 473700, "num_agent_steps_trained": 473400, "num_env_steps_sampled": 473700, "num_env_steps_trained": 473400, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 301.5702125526616, "num_env_steps_trained_throughput_per_sec": 287.20972624063006, "timesteps_total": 473700, "num_env_steps_sampled_lifetime": 473700, "num_agent_steps_sampled_lifetime": 473700, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 473700, "timers": {"training_iteration_time_ms": 10254.975, "restore_workers_time_ms": 0.012, "training_step_time_ms": 506.34, "sample_time_ms": 492.091, "synch_weights_time_ms": 12.85}, "counters": {"num_env_steps_sampled": 473700, "num_env_steps_trained": 473400, "num_agent_steps_sampled": 473700, "num_agent_steps_trained": 473400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3158, "num_samples_added_to_queue": 473700}, "done": false, "training_iteration": 160, "trial_id": "0313d_00000", "date": "2024-10-10_22-08-56", "timestamp": 1728594536, "time_this_iter_s": 10.457059860229492, "time_total_s": 1647.099843263626, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c16590>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1647.099843263626, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 11.31333333333333, "ram_util_percent": 79.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 60941.6875, "policy_loss": 60679.9453125, "entropy": 8.981353759765625, "entropy_coeff": 0.01, "var_gnorm": 16.769407272338867, "vf_loss": 288688.46875, "vf_explained_var": 0.4158608317375183}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1588.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 476700, "num_env_steps_trained": 476400, "num_agent_steps_sampled": 476700, "num_agent_steps_trained": 476400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3178, "num_samples_added_to_queue": 476700, "learner_queue": {"size_count": 1588, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.136, "learner_load_time_ms": 0.253, "learner_load_wait_time_ms": 969.42, "learner_dequeue_time_ms": 8589.729}}, "env_runners": {"episode_reward_max": 596.8438888888892, "episode_reward_min": 539.4705555555554, "episode_reward_mean": 572.1203333333333, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 539.4705555555554}, "policy_reward_max": {"default_policy": 596.8438888888892}, "policy_reward_mean": {"default_policy": 572.1203333333333}, "custom_metrics": {"num_consolidated_mean": 2.7868, "num_consolidated_min": 2.58, "num_consolidated_max": 2.9, "num_overloaded_mean": 0.011000000000000001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 2.5220000000000002, "num_moves_min": 2.05, "num_moves_max": 3.2, "mean_accuracy_mean": 39.072319999999976, "mean_accuracy_min": 38.90866666666665, "mean_accuracy_max": 39.18733333333332, "num_model_switches_mean": 0.8946999999999999, "num_model_switches_min": 0.59, "num_model_switches_max": 1.22, "num_slav_mean": 0.0004878333333333334, "num_slav_min": 6.666666666666667e-05, "num_slav_max": 0.0026, "mean_cluster_cpu_util_mean": 0.5138238505537929, "mean_cluster_cpu_util_min": 0.4954462329282995, "mean_cluster_cpu_util_max": 0.5250666923251235, "mean_cluster_mem_util_mean": 0.3145171833415856, "mean_cluster_mem_util_min": 0.30724138411693785, "mean_cluster_mem_util_max": 0.3203304818235311, "reward_consolidation_mean_mean": 3.8233333333333337, "reward_consolidation_mean_min": 3.527777777777779, "reward_consolidation_mean_max": 4.027777777777779, "reward_illegal_mean_mean": -0.018333333333333333, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9321699999999995, "reward_accuracy_mean_min": 1.8534499999999994, "reward_accuracy_mean_max": 1.9577833333333334, "reward_sla_mean_mean": -0.015966666666666664, "reward_sla_mean_min": -0.08666666666666666, "reward_sla_mean_max": -0.0022222222222222222, "reward_consolidation_sum_mean": 382.3333333333334, "reward_consolidation_sum_min": 352.7777777777779, "reward_consolidation_sum_max": 402.7777777777778, "reward_illegal_sum_mean": -1.8333333333333335, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 193.217, "reward_accuracy_sum_min": 185.34499999999994, "reward_accuracy_sum_max": 195.77833333333334, "reward_sla_sum_mean": -1.596666666666667, "reward_sla_sum_min": -8.666666666666666, "reward_sla_sum_max": -0.22222222222222224, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2273.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [572.5805555555556, 554.382777777778, 540.042222222222, 545.5327777777775, 555.8749999999995, 539.4705555555554, 564.4222222222223, 550.1216666666668, 571.2316666666666, 563.4477777777777, 559.8027777777777, 575.596111111111, 577.056111111111, 570.9377777777777, 565.0027777777776, 565.8199999999999, 568.9061111111112, 575.5577777777776, 580.8894444444444, 552.7722222222221, 560.3288888888889, 566.2561111111113, 557.0183333333332, 560.7161111111112, 570.161111111111, 587.5255555555555, 576.636666666667, 569.2794444444445, 575.6766666666667, 566.0172222222221, 566.8755555555557, 558.8655555555555, 550.5344444444445, 543.223888888889, 582.2311111111112, 581.1283333333333, 580.8355555555555, 549.9783333333335, 584.3111111111111, 576.2872222222222, 570.4227777777777, 579.8277777777777, 563.5205555555557, 575.9861111111111, 593.7155555555555, 581.7644444444445, 578.1294444444446, 572.24, 550.2094444444444, 575.0505555555554, 565.1772222222222, 560.6766666666664, 578.2005555555556, 554.1766666666666, 577.256111111111, 571.438888888889, 580.9300000000002, 561.4144444444445, 579.4616666666665, 568.5416666666667, 570.3905555555556, 574.3588888888887, 580.2316666666668, 568.9538888888887, 585.1922222222224, 572.1055555555556, 565.296666666667, 571.0500000000003, 573.1444444444443, 573.8116666666668, 596.1522222222221, 575.0022222222224, 576.9138888888888, 573.1605555555554, 579.1283333333333, 593.0105555555556, 572.1988888888886, 578.875, 573.033888888889, 589.4772222222219, 583.1927777777781, 570.208888888889, 585.6516666666668, 573.1688888888887, 566.9627777777778, 580.1683333333334, 574.5338888888888, 588.2466666666668, 590.6366666666664, 577.6438888888889, 596.8438888888892, 584.8194444444447, 578.287222222222, 594.7244444444445, 582.4622222222224, 577.882777777778, 585.3427777777779, 552.8449999999999, 590.6522222222222, 584.7944444444445], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [572.5805555555556, 554.382777777778, 540.042222222222, 545.5327777777775, 555.8749999999995, 539.4705555555554, 564.4222222222223, 550.1216666666668, 571.2316666666666, 563.4477777777777, 559.8027777777777, 575.596111111111, 577.056111111111, 570.9377777777777, 565.0027777777776, 565.8199999999999, 568.9061111111112, 575.5577777777776, 580.8894444444444, 552.7722222222221, 560.3288888888889, 566.2561111111113, 557.0183333333332, 560.7161111111112, 570.161111111111, 587.5255555555555, 576.636666666667, 569.2794444444445, 575.6766666666667, 566.0172222222221, 566.8755555555557, 558.8655555555555, 550.5344444444445, 543.223888888889, 582.2311111111112, 581.1283333333333, 580.8355555555555, 549.9783333333335, 584.3111111111111, 576.2872222222222, 570.4227777777777, 579.8277777777777, 563.5205555555557, 575.9861111111111, 593.7155555555555, 581.7644444444445, 578.1294444444446, 572.24, 550.2094444444444, 575.0505555555554, 565.1772222222222, 560.6766666666664, 578.2005555555556, 554.1766666666666, 577.256111111111, 571.438888888889, 580.9300000000002, 561.4144444444445, 579.4616666666665, 568.5416666666667, 570.3905555555556, 574.3588888888887, 580.2316666666668, 568.9538888888887, 585.1922222222224, 572.1055555555556, 565.296666666667, 571.0500000000003, 573.1444444444443, 573.8116666666668, 596.1522222222221, 575.0022222222224, 576.9138888888888, 573.1605555555554, 579.1283333333333, 593.0105555555556, 572.1988888888886, 578.875, 573.033888888889, 589.4772222222219, 583.1927777777781, 570.208888888889, 585.6516666666668, 573.1688888888887, 566.9627777777778, 580.1683333333334, 574.5338888888888, 588.2466666666668, 590.6366666666664, 577.6438888888889, 596.8438888888892, 584.8194444444447, 578.287222222222, 594.7244444444445, 582.4622222222224, 577.882777777778, 585.3427777777779, 552.8449999999999, 590.6522222222222, 584.7944444444445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19989076916988693, "mean_inference_ms": 1.8145412945887325, "mean_action_processing_ms": 0.07564234037694845, "mean_env_wait_ms": 1.229877134487032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004474639892578125, "StateBufferConnector_ms": 0.0029664039611816406, "ViewRequirementAgentConnector_ms": 0.06818032264709473}, "num_episodes": 30, "episode_return_max": 596.8438888888892, "episode_return_min": 539.4705555555554, "episode_return_mean": 572.1203333333333, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 476700, "num_agent_steps_trained": 476400, "num_env_steps_sampled": 476700, "num_env_steps_trained": 476400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 292.56678918921534, "num_env_steps_trained_throughput_per_sec": 292.56678918921534, "timesteps_total": 476700, "num_env_steps_sampled_lifetime": 476700, "num_agent_steps_sampled_lifetime": 476700, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 476700, "timers": {"training_iteration_time_ms": 10266.551, "restore_workers_time_ms": 0.012, "training_step_time_ms": 510.916, "sample_time_ms": 497.22, "synch_weights_time_ms": 12.308}, "counters": {"num_env_steps_sampled": 476700, "num_env_steps_trained": 476400, "num_agent_steps_sampled": 476700, "num_agent_steps_trained": 476400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3178, "num_samples_added_to_queue": 476700}, "done": false, "training_iteration": 161, "trial_id": "0313d_00000", "date": "2024-10-10_22-09-07", "timestamp": 1728594547, "time_this_iter_s": 10.273250579833984, "time_total_s": 1657.37309384346, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae402cf5b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1657.37309384346, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 11.68, "ram_util_percent": 79.65333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 56767.55078125, "policy_loss": 56528.734375, "entropy": 8.990023612976074, "entropy_coeff": 0.01, "var_gnorm": 16.772367477416992, "vf_loss": 265784.59375, "vf_explained_var": 0.44074952602386475}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1598.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 479550, "num_env_steps_trained": 479400, "num_agent_steps_sampled": 479550, "num_agent_steps_trained": 479400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3197, "num_samples_added_to_queue": 479400, "learner_queue": {"size_count": 1598, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 70.56, "learner_load_time_ms": 0.29, "learner_load_wait_time_ms": 1030.39, "learner_dequeue_time_ms": 8587.906}}, "env_runners": {"episode_reward_max": 597.6366666666667, "episode_reward_min": 543.223888888889, "episode_reward_mean": 576.6025277777777, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 543.223888888889}, "policy_reward_max": {"default_policy": 597.6366666666667}, "policy_reward_mean": {"default_policy": 576.6025277777777}, "custom_metrics": {"num_consolidated_mean": 2.8184000000000005, "num_consolidated_min": 2.69, "num_consolidated_max": 2.93, "num_overloaded_mean": 0.010700000000000001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 2.4433000000000002, "num_moves_min": 2.05, "num_moves_max": 2.97, "mean_accuracy_mean": 39.07998333333332, "mean_accuracy_min": 38.90866666666665, "mean_accuracy_max": 39.18733333333332, "num_model_switches_mean": 0.8208, "num_model_switches_min": 0.51, "num_model_switches_max": 1.17, "num_slav_mean": 0.0005086666666666666, "num_slav_min": 6.666666666666667e-05, "num_slav_max": 0.0026, "mean_cluster_cpu_util_mean": 0.5167157830494559, "mean_cluster_cpu_util_min": 0.5026297588623042, "mean_cluster_cpu_util_max": 0.5311311466725397, "mean_cluster_mem_util_mean": 0.3155596897334883, "mean_cluster_mem_util_min": 0.3095030240893826, "mean_cluster_mem_util_max": 0.3219078887884268, "reward_consolidation_mean_mean": 3.867638888888889, "reward_consolidation_mean_min": 3.625, "reward_consolidation_mean_max": 4.027777777777779, "reward_illegal_mean_mean": -0.017833333333333333, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9331474999999998, "reward_accuracy_mean_min": 1.8534499999999994, "reward_accuracy_mean_max": 1.9580999999999997, "reward_sla_mean_mean": -0.016927777777777778, "reward_sla_mean_min": -0.08666666666666666, "reward_sla_mean_max": -0.0022222222222222222, "reward_consolidation_sum_mean": 386.76388888888897, "reward_consolidation_sum_min": 362.5, "reward_consolidation_sum_max": 402.7777777777778, "reward_illegal_sum_mean": -1.7833333333333334, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 193.31474999999995, "reward_accuracy_sum_min": 185.34499999999994, "reward_accuracy_sum_max": 195.80999999999997, "reward_sla_sum_mean": -1.6927777777777777, "reward_sla_sum_min": -8.666666666666666, "reward_sla_sum_max": -0.22222222222222224, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2237.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [569.2794444444445, 575.6766666666667, 566.0172222222221, 566.8755555555557, 558.8655555555555, 550.5344444444445, 543.223888888889, 582.2311111111112, 581.1283333333333, 580.8355555555555, 549.9783333333335, 584.3111111111111, 576.2872222222222, 570.4227777777777, 579.8277777777777, 563.5205555555557, 575.9861111111111, 593.7155555555555, 581.7644444444445, 578.1294444444446, 572.24, 550.2094444444444, 575.0505555555554, 565.1772222222222, 560.6766666666664, 578.2005555555556, 554.1766666666666, 577.256111111111, 571.438888888889, 580.9300000000002, 561.4144444444445, 579.4616666666665, 568.5416666666667, 570.3905555555556, 574.3588888888887, 580.2316666666668, 568.9538888888887, 585.1922222222224, 572.1055555555556, 565.296666666667, 571.0500000000003, 573.1444444444443, 573.8116666666668, 596.1522222222221, 575.0022222222224, 576.9138888888888, 573.1605555555554, 579.1283333333333, 593.0105555555556, 572.1988888888886, 578.875, 573.033888888889, 589.4772222222219, 583.1927777777781, 570.208888888889, 585.6516666666668, 573.1688888888887, 566.9627777777778, 580.1683333333334, 574.5338888888888, 588.2466666666668, 590.6366666666664, 577.6438888888889, 596.8438888888892, 584.8194444444447, 578.287222222222, 594.7244444444445, 582.4622222222224, 577.882777777778, 585.3427777777779, 552.8449999999999, 590.6522222222222, 584.7944444444445, 567.4238888888888, 585.1677777777778, 584.4694444444443, 564.0655555555555, 594.7077777777778, 572.4772222222222, 575.8911111111113, 577.5805555555556, 568.1444444444444, 581.3277777777778, 592.5088888888888, 587.2627777777777, 565.4616666666664, 576.1677777777779, 580.3111111111111, 589.4533333333334, 588.1994444444445, 579.041666666667, 582.4622222222223, 573.5022222222224, 579.921111111111, 596.4533333333331, 592.1677777777779, 577.6288888888889, 581.8911111111113, 597.6366666666667, 564.9849999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [569.2794444444445, 575.6766666666667, 566.0172222222221, 566.8755555555557, 558.8655555555555, 550.5344444444445, 543.223888888889, 582.2311111111112, 581.1283333333333, 580.8355555555555, 549.9783333333335, 584.3111111111111, 576.2872222222222, 570.4227777777777, 579.8277777777777, 563.5205555555557, 575.9861111111111, 593.7155555555555, 581.7644444444445, 578.1294444444446, 572.24, 550.2094444444444, 575.0505555555554, 565.1772222222222, 560.6766666666664, 578.2005555555556, 554.1766666666666, 577.256111111111, 571.438888888889, 580.9300000000002, 561.4144444444445, 579.4616666666665, 568.5416666666667, 570.3905555555556, 574.3588888888887, 580.2316666666668, 568.9538888888887, 585.1922222222224, 572.1055555555556, 565.296666666667, 571.0500000000003, 573.1444444444443, 573.8116666666668, 596.1522222222221, 575.0022222222224, 576.9138888888888, 573.1605555555554, 579.1283333333333, 593.0105555555556, 572.1988888888886, 578.875, 573.033888888889, 589.4772222222219, 583.1927777777781, 570.208888888889, 585.6516666666668, 573.1688888888887, 566.9627777777778, 580.1683333333334, 574.5338888888888, 588.2466666666668, 590.6366666666664, 577.6438888888889, 596.8438888888892, 584.8194444444447, 578.287222222222, 594.7244444444445, 582.4622222222224, 577.882777777778, 585.3427777777779, 552.8449999999999, 590.6522222222222, 584.7944444444445, 567.4238888888888, 585.1677777777778, 584.4694444444443, 564.0655555555555, 594.7077777777778, 572.4772222222222, 575.8911111111113, 577.5805555555556, 568.1444444444444, 581.3277777777778, 592.5088888888888, 587.2627777777777, 565.4616666666664, 576.1677777777779, 580.3111111111111, 589.4533333333334, 588.1994444444445, 579.041666666667, 582.4622222222223, 573.5022222222224, 579.921111111111, 596.4533333333331, 592.1677777777779, 577.6288888888889, 581.8911111111113, 597.6366666666667, 564.9849999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19990036571171343, "mean_inference_ms": 1.814529810950611, "mean_action_processing_ms": 0.07564356673557165, "mean_env_wait_ms": 1.229903175668028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004381418228149414, "StateBufferConnector_ms": 0.002917051315307617, "ViewRequirementAgentConnector_ms": 0.0670158863067627}, "num_episodes": 27, "episode_return_max": 597.6366666666667, "episode_return_min": 543.223888888889, "episode_return_mean": 576.6025277777777, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 479550, "num_agent_steps_trained": 479400, "num_env_steps_sampled": 479550, "num_env_steps_trained": 479400, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 272.37891860812977, "num_env_steps_trained_throughput_per_sec": 286.71465116645237, "timesteps_total": 479550, "num_env_steps_sampled_lifetime": 479550, "num_agent_steps_sampled_lifetime": 479550, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 479550, "timers": {"training_iteration_time_ms": 10309.83, "restore_workers_time_ms": 0.012, "training_step_time_ms": 555.018, "sample_time_ms": 540.267, "synch_weights_time_ms": 13.424}, "counters": {"num_env_steps_sampled": 479550, "num_env_steps_trained": 479400, "num_agent_steps_sampled": 479550, "num_agent_steps_trained": 479400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3197, "num_samples_added_to_queue": 479400}, "done": false, "training_iteration": 162, "trial_id": "0313d_00000", "date": "2024-10-10_22-09-17", "timestamp": 1728594557, "time_this_iter_s": 10.473976612091064, "time_total_s": 1667.8470704555511, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae402cce20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1667.8470704555511, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 13.886666666666667, "ram_util_percent": 80.34666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 53551.7578125, "policy_loss": 53309.921875, "entropy": 8.828898429870605, "entropy_coeff": 0.01, "var_gnorm": 16.778135299682617, "vf_loss": 268323.0, "vf_explained_var": 0.42836999893188477}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1607.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 482400, "num_env_steps_trained": 482100, "num_agent_steps_sampled": 482400, "num_agent_steps_trained": 482100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3216, "num_samples_added_to_queue": 482400, "learner_queue": {"size_count": 1607, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.825, "learner_load_time_ms": 0.308, "learner_load_wait_time_ms": 1002.444, "learner_dequeue_time_ms": 8650.71}}, "env_runners": {"episode_reward_max": 597.6366666666667, "episode_reward_min": 552.8449999999999, "episode_reward_mean": 579.3247277777778, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 552.8449999999999}, "policy_reward_max": {"default_policy": 597.6366666666667}, "policy_reward_mean": {"default_policy": 579.3247277777778}, "custom_metrics": {"num_consolidated_mean": 2.8330999999999995, "num_consolidated_min": 2.72, "num_consolidated_max": 2.93, "num_overloaded_mean": 0.0104, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 2.4314999999999998, "num_moves_min": 2.01, "num_moves_max": 2.97, "mean_accuracy_mean": 39.10031333333331, "mean_accuracy_min": 38.99099999999998, "mean_accuracy_max": 39.18733333333332, "num_model_switches_mean": 0.7384999999999999, "num_model_switches_min": 0.44, "num_model_switches_max": 1.06, "num_slav_mean": 0.00040933333333333327, "num_slav_min": 6.666666666666667e-05, "num_slav_max": 0.00185, "mean_cluster_cpu_util_mean": 0.518566124438604, "mean_cluster_cpu_util_min": 0.5080713039110407, "mean_cluster_cpu_util_max": 0.5311311466725397, "mean_cluster_mem_util_mean": 0.31601041820768394, "mean_cluster_mem_util_min": 0.31049923038835786, "mean_cluster_mem_util_max": 0.3219078887884268, "reward_consolidation_mean_mean": 3.889444444444445, "reward_consolidation_mean_min": 3.736111111111112, "reward_consolidation_mean_max": 4.027777777777779, "reward_illegal_mean_mean": -0.017333333333333336, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9347361666666663, "reward_accuracy_mean_min": 1.8534499999999994, "reward_accuracy_mean_max": 1.9587333333333334, "reward_sla_mean_mean": -0.013599999999999996, "reward_sla_mean_min": -0.06166666666666666, "reward_sla_mean_max": -0.0022222222222222222, "reward_consolidation_sum_mean": 388.9444444444445, "reward_consolidation_sum_min": 373.6111111111112, "reward_consolidation_sum_max": 402.7777777777778, "reward_illegal_sum_mean": -1.7333333333333332, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 193.4736166666666, "reward_accuracy_sum_min": 185.34499999999994, "reward_accuracy_sum_max": 195.87333333333333, "reward_sla_sum_mean": -1.3599999999999997, "reward_sla_sum_min": -6.166666666666666, "reward_sla_sum_max": -0.22222222222222224, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3149.0, "global_timestep_min": 900, "global_timestep_max": 4800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [561.4144444444445, 579.4616666666665, 568.5416666666667, 570.3905555555556, 574.3588888888887, 580.2316666666668, 568.9538888888887, 585.1922222222224, 572.1055555555556, 565.296666666667, 571.0500000000003, 573.1444444444443, 573.8116666666668, 596.1522222222221, 575.0022222222224, 576.9138888888888, 573.1605555555554, 579.1283333333333, 593.0105555555556, 572.1988888888886, 578.875, 573.033888888889, 589.4772222222219, 583.1927777777781, 570.208888888889, 585.6516666666668, 573.1688888888887, 566.9627777777778, 580.1683333333334, 574.5338888888888, 588.2466666666668, 590.6366666666664, 577.6438888888889, 596.8438888888892, 584.8194444444447, 578.287222222222, 594.7244444444445, 582.4622222222224, 577.882777777778, 585.3427777777779, 552.8449999999999, 590.6522222222222, 584.7944444444445, 567.4238888888888, 585.1677777777778, 584.4694444444443, 564.0655555555555, 594.7077777777778, 572.4772222222222, 575.8911111111113, 577.5805555555556, 568.1444444444444, 581.3277777777778, 592.5088888888888, 587.2627777777777, 565.4616666666664, 576.1677777777779, 580.3111111111111, 589.4533333333334, 588.1994444444445, 579.041666666667, 582.4622222222223, 573.5022222222224, 579.921111111111, 596.4533333333331, 592.1677777777779, 577.6288888888889, 581.8911111111113, 597.6366666666667, 564.9849999999999, 590.6916666666667, 594.1838888888888, 589.6044444444444, 571.8749999999999, 560.4055555555556, 577.0172222222221, 571.565, 589.8983333333334, 559.0888888888887, 586.9772222222222, 582.6516666666668, 577.1833333333333, 579.0488888888888, 575.4616666666666, 583.0883333333334, 592.4844444444442, 572.4294444444444, 585.7316666666666, 586.2550000000001, 586.1122222222222, 588.7233333333331, 582.7544444444442, 582.3272222222221, 569.7238888888887, 567.3583333333333, 581.35, 574.4777777777778, 572.6205555555554, 581.9138888888889, 573.183888888889], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [561.4144444444445, 579.4616666666665, 568.5416666666667, 570.3905555555556, 574.3588888888887, 580.2316666666668, 568.9538888888887, 585.1922222222224, 572.1055555555556, 565.296666666667, 571.0500000000003, 573.1444444444443, 573.8116666666668, 596.1522222222221, 575.0022222222224, 576.9138888888888, 573.1605555555554, 579.1283333333333, 593.0105555555556, 572.1988888888886, 578.875, 573.033888888889, 589.4772222222219, 583.1927777777781, 570.208888888889, 585.6516666666668, 573.1688888888887, 566.9627777777778, 580.1683333333334, 574.5338888888888, 588.2466666666668, 590.6366666666664, 577.6438888888889, 596.8438888888892, 584.8194444444447, 578.287222222222, 594.7244444444445, 582.4622222222224, 577.882777777778, 585.3427777777779, 552.8449999999999, 590.6522222222222, 584.7944444444445, 567.4238888888888, 585.1677777777778, 584.4694444444443, 564.0655555555555, 594.7077777777778, 572.4772222222222, 575.8911111111113, 577.5805555555556, 568.1444444444444, 581.3277777777778, 592.5088888888888, 587.2627777777777, 565.4616666666664, 576.1677777777779, 580.3111111111111, 589.4533333333334, 588.1994444444445, 579.041666666667, 582.4622222222223, 573.5022222222224, 579.921111111111, 596.4533333333331, 592.1677777777779, 577.6288888888889, 581.8911111111113, 597.6366666666667, 564.9849999999999, 590.6916666666667, 594.1838888888888, 589.6044444444444, 571.8749999999999, 560.4055555555556, 577.0172222222221, 571.565, 589.8983333333334, 559.0888888888887, 586.9772222222222, 582.6516666666668, 577.1833333333333, 579.0488888888888, 575.4616666666666, 583.0883333333334, 592.4844444444442, 572.4294444444444, 585.7316666666666, 586.2550000000001, 586.1122222222222, 588.7233333333331, 582.7544444444442, 582.3272222222221, 569.7238888888887, 567.3583333333333, 581.35, 574.4777777777778, 572.6205555555554, 581.9138888888889, 573.183888888889]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1998748650391375, "mean_inference_ms": 1.8130069754602027, "mean_action_processing_ms": 0.0756257173141229, "mean_env_wait_ms": 1.22959938679232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004806995391845703, "StateBufferConnector_ms": 0.002922534942626953, "ViewRequirementAgentConnector_ms": 0.06712770462036133}, "num_episodes": 30, "episode_return_max": 597.6366666666667, "episode_return_min": 552.8449999999999, "episode_return_mean": 579.3247277777778, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 482400, "num_agent_steps_trained": 482100, "num_env_steps_sampled": 482400, "num_env_steps_trained": 482100, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 284.3825535387859, "num_env_steps_trained_throughput_per_sec": 269.41505072095504, "timesteps_total": 482400, "num_env_steps_sampled_lifetime": 482400, "num_agent_steps_sampled_lifetime": 482400, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 482400, "timers": {"training_iteration_time_ms": 10309.431, "restore_workers_time_ms": 0.016, "training_step_time_ms": 532.13, "sample_time_ms": 517.777, "synch_weights_time_ms": 12.854}, "counters": {"num_env_steps_sampled": 482400, "num_env_steps_trained": 482100, "num_agent_steps_sampled": 482400, "num_agent_steps_trained": 482100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3216, "num_samples_added_to_queue": 482400}, "done": false, "training_iteration": 163, "trial_id": "0313d_00000", "date": "2024-10-10_22-09-27", "timestamp": 1728594567, "time_this_iter_s": 10.040022611618042, "time_total_s": 1677.8870930671692, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42c16a40>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1677.8870930671692, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 12.257142857142858, "ram_util_percent": 80.47857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 52114.16015625, "policy_loss": 51867.05078125, "entropy": 8.821664810180664, "entropy_coeff": 0.01, "var_gnorm": 16.7796688079834, "vf_loss": 273574.96875, "vf_explained_var": 0.4457486867904663}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1617.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 485400, "num_env_steps_trained": 485100, "num_agent_steps_sampled": 485400, "num_agent_steps_trained": 485100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3236, "num_samples_added_to_queue": 485400, "learner_queue": {"size_count": 1617, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 51.065, "learner_load_time_ms": 0.338, "learner_load_wait_time_ms": 963.973, "learner_dequeue_time_ms": 8532.243}}, "env_runners": {"episode_reward_max": 600.793888888889, "episode_reward_min": 552.8449999999999, "episode_reward_mean": 580.2100888888889, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 552.8449999999999}, "policy_reward_max": {"default_policy": 600.793888888889}, "policy_reward_mean": {"default_policy": 580.2100888888889}, "custom_metrics": {"num_consolidated_mean": 2.8436000000000003, "num_consolidated_min": 2.72, "num_consolidated_max": 2.93, "num_overloaded_mean": 0.0114, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 2.4242999999999997, "num_moves_min": 1.97, "num_moves_max": 2.97, "mean_accuracy_mean": 39.117983333333314, "mean_accuracy_min": 38.99099999999998, "mean_accuracy_max": 39.20633333333332, "num_model_switches_mean": 0.6784000000000002, "num_model_switches_min": 0.43, "num_model_switches_max": 1.0, "num_slav_mean": 0.0003744999999999999, "num_slav_min": 8.333333333333333e-05, "num_slav_max": 0.00185, "mean_cluster_cpu_util_mean": 0.5203706137751469, "mean_cluster_cpu_util_min": 0.5080713039110407, "mean_cluster_cpu_util_max": 0.5311311466725397, "mean_cluster_mem_util_mean": 0.31636876652422574, "mean_cluster_mem_util_min": 0.3102937252432619, "mean_cluster_mem_util_max": 0.3219078887884268, "reward_consolidation_mean_mean": 3.899861111111112, "reward_consolidation_mean_min": 3.736111111111112, "reward_consolidation_mean_max": 4.055555555555556, "reward_illegal_mean_mean": -0.019, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9336786666666663, "reward_accuracy_mean_min": 1.8534499999999994, "reward_accuracy_mean_max": 1.95905, "reward_sla_mean_mean": -0.012438888888888888, "reward_sla_mean_min": -0.06166666666666666, "reward_sla_mean_max": -0.002777777777777778, "reward_consolidation_sum_mean": 389.9861111111111, "reward_consolidation_sum_min": 373.6111111111112, "reward_consolidation_sum_max": 405.5555555555556, "reward_illegal_sum_mean": -1.9, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 193.36786666666666, "reward_accuracy_sum_min": 185.34499999999994, "reward_accuracy_sum_max": 195.905, "reward_sla_sum_mean": -1.243888888888889, "reward_sla_sum_min": -6.166666666666666, "reward_sla_sum_max": -0.2777777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4157.0, "global_timestep_min": 2000, "global_timestep_max": 5800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [588.2466666666668, 590.6366666666664, 577.6438888888889, 596.8438888888892, 584.8194444444447, 578.287222222222, 594.7244444444445, 582.4622222222224, 577.882777777778, 585.3427777777779, 552.8449999999999, 590.6522222222222, 584.7944444444445, 567.4238888888888, 585.1677777777778, 584.4694444444443, 564.0655555555555, 594.7077777777778, 572.4772222222222, 575.8911111111113, 577.5805555555556, 568.1444444444444, 581.3277777777778, 592.5088888888888, 587.2627777777777, 565.4616666666664, 576.1677777777779, 580.3111111111111, 589.4533333333334, 588.1994444444445, 579.041666666667, 582.4622222222223, 573.5022222222224, 579.921111111111, 596.4533333333331, 592.1677777777779, 577.6288888888889, 581.8911111111113, 597.6366666666667, 564.9849999999999, 590.6916666666667, 594.1838888888888, 589.6044444444444, 571.8749999999999, 560.4055555555556, 577.0172222222221, 571.565, 589.8983333333334, 559.0888888888887, 586.9772222222222, 582.6516666666668, 577.1833333333333, 579.0488888888888, 575.4616666666666, 583.0883333333334, 592.4844444444442, 572.4294444444444, 585.7316666666666, 586.2550000000001, 586.1122222222222, 588.7233333333331, 582.7544444444442, 582.3272222222221, 569.7238888888887, 567.3583333333333, 581.35, 574.4777777777778, 572.6205555555554, 581.9138888888889, 573.183888888889, 572.517777777778, 585.7316666666667, 585.0883333333335, 584.6677777777776, 572.311111111111, 578.1994444444443, 573.287222222222, 580.8744444444443, 568.0883333333333, 574.2472222222221, 570.2233333333335, 570.8261111111109, 575.0161111111108, 568.9133333333331, 596.2555555555555, 567.1127777777773, 588.1122222222223, 572.9533333333333, 576.4138888888888, 587.3577777777779, 581.7949999999998, 582.7161111111108, 583.2311111111113, 573.9461111111113, 600.793888888889, 574.4938888888887, 583.2155555555556, 595.3494444444443, 579.375, 570.2155555555557], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [588.2466666666668, 590.6366666666664, 577.6438888888889, 596.8438888888892, 584.8194444444447, 578.287222222222, 594.7244444444445, 582.4622222222224, 577.882777777778, 585.3427777777779, 552.8449999999999, 590.6522222222222, 584.7944444444445, 567.4238888888888, 585.1677777777778, 584.4694444444443, 564.0655555555555, 594.7077777777778, 572.4772222222222, 575.8911111111113, 577.5805555555556, 568.1444444444444, 581.3277777777778, 592.5088888888888, 587.2627777777777, 565.4616666666664, 576.1677777777779, 580.3111111111111, 589.4533333333334, 588.1994444444445, 579.041666666667, 582.4622222222223, 573.5022222222224, 579.921111111111, 596.4533333333331, 592.1677777777779, 577.6288888888889, 581.8911111111113, 597.6366666666667, 564.9849999999999, 590.6916666666667, 594.1838888888888, 589.6044444444444, 571.8749999999999, 560.4055555555556, 577.0172222222221, 571.565, 589.8983333333334, 559.0888888888887, 586.9772222222222, 582.6516666666668, 577.1833333333333, 579.0488888888888, 575.4616666666666, 583.0883333333334, 592.4844444444442, 572.4294444444444, 585.7316666666666, 586.2550000000001, 586.1122222222222, 588.7233333333331, 582.7544444444442, 582.3272222222221, 569.7238888888887, 567.3583333333333, 581.35, 574.4777777777778, 572.6205555555554, 581.9138888888889, 573.183888888889, 572.517777777778, 585.7316666666667, 585.0883333333335, 584.6677777777776, 572.311111111111, 578.1994444444443, 573.287222222222, 580.8744444444443, 568.0883333333333, 574.2472222222221, 570.2233333333335, 570.8261111111109, 575.0161111111108, 568.9133333333331, 596.2555555555555, 567.1127777777773, 588.1122222222223, 572.9533333333333, 576.4138888888888, 587.3577777777779, 581.7949999999998, 582.7161111111108, 583.2311111111113, 573.9461111111113, 600.793888888889, 574.4938888888887, 583.2155555555556, 595.3494444444443, 579.375, 570.2155555555557]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19988613683855633, "mean_inference_ms": 1.8131800836180354, "mean_action_processing_ms": 0.07562680107765644, "mean_env_wait_ms": 1.229688905843445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004827022552490234, "StateBufferConnector_ms": 0.0029191970825195312, "ViewRequirementAgentConnector_ms": 0.06642580032348633}, "num_episodes": 30, "episode_return_max": 600.793888888889, "episode_return_min": 552.8449999999999, "episode_return_mean": 580.2100888888889, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 485400, "num_agent_steps_trained": 485100, "num_env_steps_sampled": 485400, "num_env_steps_trained": 485100, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 297.34277486150233, "num_env_steps_trained_throughput_per_sec": 297.34277486150233, "timesteps_total": 485400, "num_env_steps_sampled_lifetime": 485400, "num_agent_steps_sampled_lifetime": 485400, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 485400, "timers": {"training_iteration_time_ms": 10308.36, "restore_workers_time_ms": 0.011, "training_step_time_ms": 493.634, "sample_time_ms": 480.094, "synch_weights_time_ms": 12.25}, "counters": {"num_env_steps_sampled": 485400, "num_env_steps_trained": 485100, "num_agent_steps_sampled": 485400, "num_agent_steps_trained": 485100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3236, "num_samples_added_to_queue": 485400}, "done": false, "training_iteration": 164, "trial_id": "0313d_00000", "date": "2024-10-10_22-09-37", "timestamp": 1728594577, "time_this_iter_s": 10.103986263275146, "time_total_s": 1687.9910793304443, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42fa31f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1687.9910793304443, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 10.62857142857143, "ram_util_percent": 80.59285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 49655.27734375, "policy_loss": 49400.671875, "entropy": 8.581619262695312, "entropy_coeff": 0.01, "var_gnorm": 16.78713035583496, "vf_loss": 280352.25, "vf_explained_var": 0.44741755723953247}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1627.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 488250, "num_env_steps_trained": 488100, "num_agent_steps_sampled": 488250, "num_agent_steps_trained": 488100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3255, "num_samples_added_to_queue": 488100, "learner_queue": {"size_count": 1627, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.732, "learner_load_time_ms": 0.319, "learner_load_wait_time_ms": 994.079, "learner_dequeue_time_ms": 8528.124}}, "env_runners": {"episode_reward_max": 604.8177777777778, "episode_reward_min": 558.4938888888889, "episode_reward_mean": 581.3824944444444, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 558.4938888888889}, "policy_reward_max": {"default_policy": 604.8177777777778}, "policy_reward_mean": {"default_policy": 581.3824944444444}, "custom_metrics": {"num_consolidated_mean": 2.8553, "num_consolidated_min": 2.72, "num_consolidated_max": 2.95, "num_overloaded_mean": 0.012199999999999999, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 2.3893000000000004, "num_moves_min": 1.94, "num_moves_max": 2.97, "mean_accuracy_mean": 39.137236666666645, "mean_accuracy_min": 39.04799999999998, "mean_accuracy_max": 39.21266666666665, "num_model_switches_mean": 0.6286999999999999, "num_model_switches_min": 0.32, "num_model_switches_max": 0.86, "num_slav_mean": 0.0003561666666666668, "num_slav_min": 8.333333333333333e-05, "num_slav_max": 0.0019, "mean_cluster_cpu_util_mean": 0.5221086827512058, "mean_cluster_cpu_util_min": 0.5080713039110407, "mean_cluster_cpu_util_max": 0.534918429684575, "mean_cluster_mem_util_mean": 0.31683507397600397, "mean_cluster_mem_util_min": 0.3102937252432619, "mean_cluster_mem_util_max": 0.32286112546284335, "reward_consolidation_mean_mean": 3.912916666666667, "reward_consolidation_mean_min": 3.736111111111112, "reward_consolidation_mean_max": 4.097222222222223, "reward_illegal_mean_mean": -0.02033333333333333, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9330638333333334, "reward_accuracy_mean_min": 1.879383333333333, "reward_accuracy_mean_max": 1.9596833333333334, "reward_sla_mean_mean": -0.011822222222222224, "reward_sla_mean_min": -0.06277777777777778, "reward_sla_mean_max": -0.002777777777777778, "reward_consolidation_sum_mean": 391.29166666666674, "reward_consolidation_sum_min": 373.6111111111112, "reward_consolidation_sum_max": 409.7222222222223, "reward_illegal_sum_mean": -2.033333333333333, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 193.3063833333333, "reward_accuracy_sum_min": 187.9383333333333, "reward_accuracy_sum_max": 195.96833333333333, "reward_sla_sum_mean": -1.1822222222222223, "reward_sla_sum_min": -6.277777777777779, "reward_sla_sum_max": -0.2777777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5063.0, "global_timestep_min": 3000, "global_timestep_max": 6700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [580.3111111111111, 589.4533333333334, 588.1994444444445, 579.041666666667, 582.4622222222223, 573.5022222222224, 579.921111111111, 596.4533333333331, 592.1677777777779, 577.6288888888889, 581.8911111111113, 597.6366666666667, 564.9849999999999, 590.6916666666667, 594.1838888888888, 589.6044444444444, 571.8749999999999, 560.4055555555556, 577.0172222222221, 571.565, 589.8983333333334, 559.0888888888887, 586.9772222222222, 582.6516666666668, 577.1833333333333, 579.0488888888888, 575.4616666666666, 583.0883333333334, 592.4844444444442, 572.4294444444444, 585.7316666666666, 586.2550000000001, 586.1122222222222, 588.7233333333331, 582.7544444444442, 582.3272222222221, 569.7238888888887, 567.3583333333333, 581.35, 574.4777777777778, 572.6205555555554, 581.9138888888889, 573.183888888889, 572.517777777778, 585.7316666666667, 585.0883333333335, 584.6677777777776, 572.311111111111, 578.1994444444443, 573.287222222222, 580.8744444444443, 568.0883333333333, 574.2472222222221, 570.2233333333335, 570.8261111111109, 575.0161111111108, 568.9133333333331, 596.2555555555555, 567.1127777777773, 588.1122222222223, 572.9533333333333, 576.4138888888888, 587.3577777777779, 581.7949999999998, 582.7161111111108, 583.2311111111113, 573.9461111111113, 600.793888888889, 574.4938888888887, 583.2155555555556, 595.3494444444443, 579.375, 570.2155555555557, 587.2383333333332, 586.2472222222221, 597.6749999999997, 588.6905555555555, 587.4850000000001, 593.7705555555556, 577.1433333333334, 581.3816666666665, 581.8105555555554, 579.7950000000001, 577.7311111111112, 585.7472222222223, 604.8177777777778, 583.0644444444447, 572.1438888888888, 582.3900000000002, 593.5883333333335, 603.4922222222223, 592.0005555555555, 590.8344444444442, 591.8022222222223, 584.833888888889, 566.8666666666668, 558.4938888888889, 578.2388888888889, 584.2394444444444, 583.5566666666668], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [580.3111111111111, 589.4533333333334, 588.1994444444445, 579.041666666667, 582.4622222222223, 573.5022222222224, 579.921111111111, 596.4533333333331, 592.1677777777779, 577.6288888888889, 581.8911111111113, 597.6366666666667, 564.9849999999999, 590.6916666666667, 594.1838888888888, 589.6044444444444, 571.8749999999999, 560.4055555555556, 577.0172222222221, 571.565, 589.8983333333334, 559.0888888888887, 586.9772222222222, 582.6516666666668, 577.1833333333333, 579.0488888888888, 575.4616666666666, 583.0883333333334, 592.4844444444442, 572.4294444444444, 585.7316666666666, 586.2550000000001, 586.1122222222222, 588.7233333333331, 582.7544444444442, 582.3272222222221, 569.7238888888887, 567.3583333333333, 581.35, 574.4777777777778, 572.6205555555554, 581.9138888888889, 573.183888888889, 572.517777777778, 585.7316666666667, 585.0883333333335, 584.6677777777776, 572.311111111111, 578.1994444444443, 573.287222222222, 580.8744444444443, 568.0883333333333, 574.2472222222221, 570.2233333333335, 570.8261111111109, 575.0161111111108, 568.9133333333331, 596.2555555555555, 567.1127777777773, 588.1122222222223, 572.9533333333333, 576.4138888888888, 587.3577777777779, 581.7949999999998, 582.7161111111108, 583.2311111111113, 573.9461111111113, 600.793888888889, 574.4938888888887, 583.2155555555556, 595.3494444444443, 579.375, 570.2155555555557, 587.2383333333332, 586.2472222222221, 597.6749999999997, 588.6905555555555, 587.4850000000001, 593.7705555555556, 577.1433333333334, 581.3816666666665, 581.8105555555554, 579.7950000000001, 577.7311111111112, 585.7472222222223, 604.8177777777778, 583.0644444444447, 572.1438888888888, 582.3900000000002, 593.5883333333335, 603.4922222222223, 592.0005555555555, 590.8344444444442, 591.8022222222223, 584.833888888889, 566.8666666666668, 558.4938888888889, 578.2388888888889, 584.2394444444444, 583.5566666666668]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1998877381440987, "mean_inference_ms": 1.8133084384717955, "mean_action_processing_ms": 0.07562667749978447, "mean_env_wait_ms": 1.2297478936616781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004760026931762695, "StateBufferConnector_ms": 0.0029075145721435547, "ViewRequirementAgentConnector_ms": 0.06621170043945312}, "num_episodes": 27, "episode_return_max": 604.8177777777778, "episode_return_min": 558.4938888888889, "episode_return_mean": 581.3824944444444, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 488250, "num_agent_steps_trained": 488100, "num_env_steps_sampled": 488250, "num_env_steps_trained": 488100, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 284.91150314657705, "num_env_steps_trained_throughput_per_sec": 299.9068454174495, "timesteps_total": 488250, "num_env_steps_sampled_lifetime": 488250, "num_agent_steps_sampled_lifetime": 488250, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 488250, "timers": {"training_iteration_time_ms": 10266.157, "restore_workers_time_ms": 0.012, "training_step_time_ms": 547.207, "sample_time_ms": 532.033, "synch_weights_time_ms": 13.665}, "counters": {"num_env_steps_sampled": 488250, "num_env_steps_trained": 488100, "num_agent_steps_sampled": 488250, "num_agent_steps_trained": 488100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3255, "num_samples_added_to_queue": 488100}, "done": false, "training_iteration": 165, "trial_id": "0313d_00000", "date": "2024-10-10_22-09-48", "timestamp": 1728594588, "time_this_iter_s": 10.018366575241089, "time_total_s": 1698.0094459056854, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42fa3eb0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1698.0094459056854, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 12.453333333333337, "ram_util_percent": 80.67333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 50249.53515625, "policy_loss": 50032.4921875, "entropy": 8.74361801147461, "entropy_coeff": 0.01, "var_gnorm": 16.788293838500977, "vf_loss": 243274.78125, "vf_explained_var": 0.465218722820282}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1636.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 491100, "num_env_steps_trained": 490800, "num_agent_steps_sampled": 491100, "num_agent_steps_trained": 490800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3274, "num_samples_added_to_queue": 491100, "learner_queue": {"size_count": 1636, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.026, "learner_load_time_ms": 0.319, "learner_load_wait_time_ms": 1023.24, "learner_dequeue_time_ms": 8464.374}}, "env_runners": {"episode_reward_max": 604.8177777777778, "episode_reward_min": 558.4938888888889, "episode_reward_mean": 582.5445111111111, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 558.4938888888889}, "policy_reward_max": {"default_policy": 604.8177777777778}, "policy_reward_mean": {"default_policy": 582.5445111111111}, "custom_metrics": {"num_consolidated_mean": 2.8615999999999997, "num_consolidated_min": 2.76, "num_consolidated_max": 2.95, "num_overloaded_mean": 0.012100000000000001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 2.3613, "num_moves_min": 1.94, "num_moves_max": 2.79, "mean_accuracy_mean": 39.15338666666665, "mean_accuracy_min": 39.054333333333304, "mean_accuracy_max": 39.23799999999998, "num_model_switches_mean": 0.6003999999999999, "num_model_switches_min": 0.32, "num_model_switches_max": 0.88, "num_slav_mean": 0.00031316666666666667, "num_slav_min": 3.3333333333333335e-05, "num_slav_max": 0.0019, "mean_cluster_cpu_util_mean": 0.5229142801766258, "mean_cluster_cpu_util_min": 0.5082524160001839, "mean_cluster_cpu_util_max": 0.534918429684575, "mean_cluster_mem_util_mean": 0.3171853200741267, "mean_cluster_mem_util_min": 0.3102937252432619, "mean_cluster_mem_util_max": 0.32286112546284335, "reward_consolidation_mean_mean": 3.9219444444444447, "reward_consolidation_mean_min": 3.7777777777777777, "reward_consolidation_mean_max": 4.097222222222223, "reward_illegal_mean_mean": -0.020166666666666666, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9340673333333331, "reward_accuracy_mean_min": 1.879383333333333, "reward_accuracy_mean_max": 1.9619, "reward_sla_mean_mean": -0.0104, "reward_sla_mean_min": -0.06277777777777778, "reward_sla_mean_max": -0.0011111111111111111, "reward_consolidation_sum_mean": 392.1944444444445, "reward_consolidation_sum_min": 377.77777777777777, "reward_consolidation_sum_max": 409.7222222222223, "reward_illegal_sum_mean": -2.016666666666666, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 193.40673333333328, "reward_accuracy_sum_min": 187.9383333333333, "reward_accuracy_sum_max": 196.19, "reward_sla_sum_mean": -1.0400000000000003, "reward_sla_sum_min": -6.277777777777779, "reward_sla_sum_max": -0.11111111111111112, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6057.0, "global_timestep_min": 3900, "global_timestep_max": 7700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [585.7316666666666, 586.2550000000001, 586.1122222222222, 588.7233333333331, 582.7544444444442, 582.3272222222221, 569.7238888888887, 567.3583333333333, 581.35, 574.4777777777778, 572.6205555555554, 581.9138888888889, 573.183888888889, 572.517777777778, 585.7316666666667, 585.0883333333335, 584.6677777777776, 572.311111111111, 578.1994444444443, 573.287222222222, 580.8744444444443, 568.0883333333333, 574.2472222222221, 570.2233333333335, 570.8261111111109, 575.0161111111108, 568.9133333333331, 596.2555555555555, 567.1127777777773, 588.1122222222223, 572.9533333333333, 576.4138888888888, 587.3577777777779, 581.7949999999998, 582.7161111111108, 583.2311111111113, 573.9461111111113, 600.793888888889, 574.4938888888887, 583.2155555555556, 595.3494444444443, 579.375, 570.2155555555557, 587.2383333333332, 586.2472222222221, 597.6749999999997, 588.6905555555555, 587.4850000000001, 593.7705555555556, 577.1433333333334, 581.3816666666665, 581.8105555555554, 579.7950000000001, 577.7311111111112, 585.7472222222223, 604.8177777777778, 583.0644444444447, 572.1438888888888, 582.3900000000002, 593.5883333333335, 603.4922222222223, 592.0005555555555, 590.8344444444442, 591.8022222222223, 584.833888888889, 566.8666666666668, 558.4938888888889, 578.2388888888889, 584.2394444444444, 583.5566666666668, 599.3816666666668, 595.215, 574.2466666666668, 585.3811111111112, 582.1272222222221, 583.7550000000001, 583.0166666666667, 583.9288888888888, 577.2705555555553, 590.198888888889, 585.8505555555554, 573.2233333333334, 580.9449999999998, 596.81, 593.8894444444444, 587.0794444444446, 591.3566666666666, 586.8888888888888, 590.2538888888888, 566.3666666666667, 599.2627777777777, 585.7461111111111, 590.6122222222224, 584.3266666666665, 587.3027777777777, 574.2233333333331, 581.6827777777778, 581.7233333333334, 590.0316666666664, 571.4133333333333], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [585.7316666666666, 586.2550000000001, 586.1122222222222, 588.7233333333331, 582.7544444444442, 582.3272222222221, 569.7238888888887, 567.3583333333333, 581.35, 574.4777777777778, 572.6205555555554, 581.9138888888889, 573.183888888889, 572.517777777778, 585.7316666666667, 585.0883333333335, 584.6677777777776, 572.311111111111, 578.1994444444443, 573.287222222222, 580.8744444444443, 568.0883333333333, 574.2472222222221, 570.2233333333335, 570.8261111111109, 575.0161111111108, 568.9133333333331, 596.2555555555555, 567.1127777777773, 588.1122222222223, 572.9533333333333, 576.4138888888888, 587.3577777777779, 581.7949999999998, 582.7161111111108, 583.2311111111113, 573.9461111111113, 600.793888888889, 574.4938888888887, 583.2155555555556, 595.3494444444443, 579.375, 570.2155555555557, 587.2383333333332, 586.2472222222221, 597.6749999999997, 588.6905555555555, 587.4850000000001, 593.7705555555556, 577.1433333333334, 581.3816666666665, 581.8105555555554, 579.7950000000001, 577.7311111111112, 585.7472222222223, 604.8177777777778, 583.0644444444447, 572.1438888888888, 582.3900000000002, 593.5883333333335, 603.4922222222223, 592.0005555555555, 590.8344444444442, 591.8022222222223, 584.833888888889, 566.8666666666668, 558.4938888888889, 578.2388888888889, 584.2394444444444, 583.5566666666668, 599.3816666666668, 595.215, 574.2466666666668, 585.3811111111112, 582.1272222222221, 583.7550000000001, 583.0166666666667, 583.9288888888888, 577.2705555555553, 590.198888888889, 585.8505555555554, 573.2233333333334, 580.9449999999998, 596.81, 593.8894444444444, 587.0794444444446, 591.3566666666666, 586.8888888888888, 590.2538888888888, 566.3666666666667, 599.2627777777777, 585.7461111111111, 590.6122222222224, 584.3266666666665, 587.3027777777777, 574.2233333333331, 581.6827777777778, 581.7233333333334, 590.0316666666664, 571.4133333333333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1998840564157312, "mean_inference_ms": 1.8133234957702724, "mean_action_processing_ms": 0.0756247411276714, "mean_env_wait_ms": 1.2297315739985626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004581928253173828, "StateBufferConnector_ms": 0.0029599666595458984, "ViewRequirementAgentConnector_ms": 0.0671231746673584}, "num_episodes": 30, "episode_return_max": 604.8177777777778, "episode_return_min": 558.4938888888889, "episode_return_mean": 582.5445111111111, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 491100, "num_agent_steps_trained": 490800, "num_env_steps_sampled": 491100, "num_env_steps_trained": 490800, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 280.23267502764406, "num_env_steps_trained_throughput_per_sec": 265.48358686829437, "timesteps_total": 491100, "num_env_steps_sampled_lifetime": 491100, "num_agent_steps_sampled_lifetime": 491100, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 491100, "timers": {"training_iteration_time_ms": 10259.955, "restore_workers_time_ms": 0.013, "training_step_time_ms": 562.871, "sample_time_ms": 548.492, "synch_weights_time_ms": 12.996}, "counters": {"num_env_steps_sampled": 491100, "num_env_steps_trained": 490800, "num_agent_steps_sampled": 491100, "num_agent_steps_trained": 490800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3274, "num_samples_added_to_queue": 491100}, "done": false, "training_iteration": 166, "trial_id": "0313d_00000", "date": "2024-10-10_22-09-58", "timestamp": 1728594598, "time_this_iter_s": 10.18084716796875, "time_total_s": 1708.1902930736542, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae402cea70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1708.1902930736542, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 15.307142857142859, "ram_util_percent": 81.24285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 43512.16796875, "policy_loss": 43281.53515625, "entropy": 8.45830249786377, "entropy_coeff": 0.01, "var_gnorm": 16.791994094848633, "vf_loss": 256006.140625, "vf_explained_var": 0.4749755859375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1646.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 493950, "num_env_steps_trained": 493800, "num_agent_steps_sampled": 493950, "num_agent_steps_trained": 493800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3293, "num_samples_added_to_queue": 493800, "learner_queue": {"size_count": 1646, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.821, "learner_load_time_ms": 0.294, "learner_load_wait_time_ms": 1006.61, "learner_dequeue_time_ms": 8413.951}}, "env_runners": {"episode_reward_max": 604.8177777777778, "episode_reward_min": 557.1683333333332, "episode_reward_mean": 585.9330611111111, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 557.1683333333332}, "policy_reward_max": {"default_policy": 604.8177777777778}, "policy_reward_mean": {"default_policy": 585.9330611111111}, "custom_metrics": {"num_consolidated_mean": 2.87, "num_consolidated_min": 2.8, "num_consolidated_max": 2.96, "num_overloaded_mean": 0.0092, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 2.3396, "num_moves_min": 1.82, "num_moves_max": 2.96, "mean_accuracy_mean": 39.16757333333331, "mean_accuracy_min": 39.07333333333331, "mean_accuracy_max": 39.269666666666645, "num_model_switches_mean": 0.5948, "num_model_switches_min": 0.32, "num_model_switches_max": 0.88, "num_slav_mean": 0.00035300000000000007, "num_slav_min": 3.3333333333333335e-05, "num_slav_max": 0.0019, "mean_cluster_cpu_util_mean": 0.5237454373019724, "mean_cluster_cpu_util_min": 0.5156910968697099, "mean_cluster_cpu_util_max": 0.534918429684575, "mean_cluster_mem_util_mean": 0.3178688484457074, "mean_cluster_mem_util_min": 0.31395980528287265, "mean_cluster_mem_util_max": 0.32286112546284335, "reward_consolidation_mean_mean": 3.945972222222222, "reward_consolidation_mean_min": 3.7638888888888897, "reward_consolidation_mean_max": 4.111111111111112, "reward_illegal_mean_mean": -0.015333333333333332, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9404195000000002, "reward_accuracy_mean_min": 1.879383333333333, "reward_accuracy_mean_max": 1.9634833333333332, "reward_sla_mean_mean": -0.01172777777777778, "reward_sla_mean_min": -0.06277777777777778, "reward_sla_mean_max": -0.0011111111111111111, "reward_consolidation_sum_mean": 394.5972222222223, "reward_consolidation_sum_min": 376.38888888888897, "reward_consolidation_sum_max": 411.11111111111114, "reward_illegal_sum_mean": -1.5333333333333332, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 194.04194999999996, "reward_accuracy_sum_min": 187.9383333333333, "reward_accuracy_sum_max": 196.34833333333333, "reward_sla_sum_mean": -1.1727777777777777, "reward_sla_sum_min": -6.277777777777779, "reward_sla_sum_max": -0.11111111111111112, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5086.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [596.2555555555555, 567.1127777777773, 588.1122222222223, 572.9533333333333, 576.4138888888888, 587.3577777777779, 581.7949999999998, 582.7161111111108, 583.2311111111113, 573.9461111111113, 600.793888888889, 574.4938888888887, 583.2155555555556, 595.3494444444443, 579.375, 570.2155555555557, 587.2383333333332, 586.2472222222221, 597.6749999999997, 588.6905555555555, 587.4850000000001, 593.7705555555556, 577.1433333333334, 581.3816666666665, 581.8105555555554, 579.7950000000001, 577.7311111111112, 585.7472222222223, 604.8177777777778, 583.0644444444447, 572.1438888888888, 582.3900000000002, 593.5883333333335, 603.4922222222223, 592.0005555555555, 590.8344444444442, 591.8022222222223, 584.833888888889, 566.8666666666668, 558.4938888888889, 578.2388888888889, 584.2394444444444, 583.5566666666668, 599.3816666666668, 595.215, 574.2466666666668, 585.3811111111112, 582.1272222222221, 583.7550000000001, 583.0166666666667, 583.9288888888888, 577.2705555555553, 590.198888888889, 585.8505555555554, 573.2233333333334, 580.9449999999998, 596.81, 593.8894444444444, 587.0794444444446, 591.3566666666666, 586.8888888888888, 590.2538888888888, 566.3666666666667, 599.2627777777777, 585.7461111111111, 590.6122222222224, 584.3266666666665, 587.3027777777777, 574.2233333333331, 581.6827777777778, 581.7233333333334, 590.0316666666664, 571.4133333333333, 595.4133333333333, 596.3416666666668, 588.6594444444445, 591.9605555555555, 593.8966666666665, 580.6033333333332, 590.2377777777778, 596.7383333333333, 603.8650000000001, 593.9927777777777, 588.445, 594.0400000000001, 599.7855555555556, 582.7227777777778, 588.5149999999998, 581.3255555555554, 600.373888888889, 603.6905555555558, 585.7783333333333, 578.1905555555554, 588.865, 557.1683333333332, 572.7622222222219, 590.595, 598.2616666666667, 593.9605555555554, 595.1905555555554], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [596.2555555555555, 567.1127777777773, 588.1122222222223, 572.9533333333333, 576.4138888888888, 587.3577777777779, 581.7949999999998, 582.7161111111108, 583.2311111111113, 573.9461111111113, 600.793888888889, 574.4938888888887, 583.2155555555556, 595.3494444444443, 579.375, 570.2155555555557, 587.2383333333332, 586.2472222222221, 597.6749999999997, 588.6905555555555, 587.4850000000001, 593.7705555555556, 577.1433333333334, 581.3816666666665, 581.8105555555554, 579.7950000000001, 577.7311111111112, 585.7472222222223, 604.8177777777778, 583.0644444444447, 572.1438888888888, 582.3900000000002, 593.5883333333335, 603.4922222222223, 592.0005555555555, 590.8344444444442, 591.8022222222223, 584.833888888889, 566.8666666666668, 558.4938888888889, 578.2388888888889, 584.2394444444444, 583.5566666666668, 599.3816666666668, 595.215, 574.2466666666668, 585.3811111111112, 582.1272222222221, 583.7550000000001, 583.0166666666667, 583.9288888888888, 577.2705555555553, 590.198888888889, 585.8505555555554, 573.2233333333334, 580.9449999999998, 596.81, 593.8894444444444, 587.0794444444446, 591.3566666666666, 586.8888888888888, 590.2538888888888, 566.3666666666667, 599.2627777777777, 585.7461111111111, 590.6122222222224, 584.3266666666665, 587.3027777777777, 574.2233333333331, 581.6827777777778, 581.7233333333334, 590.0316666666664, 571.4133333333333, 595.4133333333333, 596.3416666666668, 588.6594444444445, 591.9605555555555, 593.8966666666665, 580.6033333333332, 590.2377777777778, 596.7383333333333, 603.8650000000001, 593.9927777777777, 588.445, 594.0400000000001, 599.7855555555556, 582.7227777777778, 588.5149999999998, 581.3255555555554, 600.373888888889, 603.6905555555558, 585.7783333333333, 578.1905555555554, 588.865, 557.1683333333332, 572.7622222222219, 590.595, 598.2616666666667, 593.9605555555554, 595.1905555555554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1998618752437811, "mean_inference_ms": 1.8119385709299707, "mean_action_processing_ms": 0.07560809807151904, "mean_env_wait_ms": 1.229497130290451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004494905471801758, "StateBufferConnector_ms": 0.0030159950256347656, "ViewRequirementAgentConnector_ms": 0.06895804405212402}, "num_episodes": 27, "episode_return_max": 604.8177777777778, "episode_return_min": 557.1683333333332, "episode_return_mean": 585.9330611111111, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 493950, "num_agent_steps_trained": 493800, "num_env_steps_sampled": 493950, "num_env_steps_trained": 493800, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 284.6930235223336, "num_env_steps_trained_throughput_per_sec": 299.67686686561433, "timesteps_total": 493950, "num_env_steps_sampled_lifetime": 493950, "num_agent_steps_sampled_lifetime": 493950, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 493950, "timers": {"training_iteration_time_ms": 10231.275, "restore_workers_time_ms": 0.012, "training_step_time_ms": 547.212, "sample_time_ms": 531.356, "synch_weights_time_ms": 14.468}, "counters": {"num_env_steps_sampled": 493950, "num_env_steps_trained": 493800, "num_agent_steps_sampled": 493950, "num_agent_steps_trained": 493800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3293, "num_samples_added_to_queue": 493800}, "done": false, "training_iteration": 167, "trial_id": "0313d_00000", "date": "2024-10-10_22-10-08", "timestamp": 1728594608, "time_this_iter_s": 10.024399757385254, "time_total_s": 1718.2146928310394, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42dc8fa0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1718.2146928310394, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 12.473333333333333, "ram_util_percent": 81.17333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 45501.2578125, "policy_loss": 45290.4609375, "entropy": 8.470037460327148, "entropy_coeff": 0.01, "var_gnorm": 16.80120849609375, "vf_loss": 236208.125, "vf_explained_var": 0.495006799697876}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1655.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 496800, "num_env_steps_trained": 496500, "num_agent_steps_sampled": 496800, "num_agent_steps_trained": 496500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3312, "num_samples_added_to_queue": 496800, "learner_queue": {"size_count": 1655, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.232, "learner_load_time_ms": 0.306, "learner_load_wait_time_ms": 1022.578, "learner_dequeue_time_ms": 8384.098}}, "env_runners": {"episode_reward_max": 603.9127777777778, "episode_reward_min": 557.1683333333332, "episode_reward_mean": 588.4972611111111, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 557.1683333333332}, "policy_reward_max": {"default_policy": 603.9127777777778}, "policy_reward_mean": {"default_policy": 588.4972611111111}, "custom_metrics": {"num_consolidated_mean": 2.8714999999999993, "num_consolidated_min": 2.78, "num_consolidated_max": 2.96, "num_overloaded_mean": 0.0066, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 2.3613, "num_moves_min": 1.82, "num_moves_max": 2.96, "mean_accuracy_mean": 39.187333333333314, "mean_accuracy_min": 39.11133333333331, "mean_accuracy_max": 39.307666666666655, "num_model_switches_mean": 0.6252, "num_model_switches_min": 0.32, "num_model_switches_max": 0.88, "num_slav_mean": 0.00029583333333333333, "num_slav_min": 3.3333333333333335e-05, "num_slav_max": 0.0019, "mean_cluster_cpu_util_mean": 0.5235139518101493, "mean_cluster_cpu_util_min": 0.5153295637073972, "mean_cluster_cpu_util_max": 0.5338992247210465, "mean_cluster_mem_util_mean": 0.3181136931796981, "mean_cluster_mem_util_min": 0.31395980528287265, "mean_cluster_mem_util_max": 0.32286112546284335, "reward_consolidation_mean_mean": 3.959305555555556, "reward_consolidation_mean_min": 3.7638888888888897, "reward_consolidation_mean_max": 4.111111111111112, "reward_illegal_mean_mean": -0.011, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.946478166666667, "reward_accuracy_mean_min": 1.879383333333333, "reward_accuracy_mean_max": 1.9653833333333333, "reward_sla_mean_mean": -0.00981111111111111, "reward_sla_mean_min": -0.06277777777777778, "reward_sla_mean_max": -0.0011111111111111111, "reward_consolidation_sum_mean": 395.9305555555557, "reward_consolidation_sum_min": 376.38888888888897, "reward_consolidation_sum_max": 411.11111111111114, "reward_illegal_sum_mean": -1.0999999999999999, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 194.6478166666666, "reward_accuracy_sum_min": 187.9383333333333, "reward_accuracy_sum_max": 196.53833333333333, "reward_sla_sum_mean": -0.981111111111111, "reward_sla_sum_min": -6.277777777777779, "reward_sla_sum_max": -0.11111111111111112, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3751.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [572.1438888888888, 582.3900000000002, 593.5883333333335, 603.4922222222223, 592.0005555555555, 590.8344444444442, 591.8022222222223, 584.833888888889, 566.8666666666668, 558.4938888888889, 578.2388888888889, 584.2394444444444, 583.5566666666668, 599.3816666666668, 595.215, 574.2466666666668, 585.3811111111112, 582.1272222222221, 583.7550000000001, 583.0166666666667, 583.9288888888888, 577.2705555555553, 590.198888888889, 585.8505555555554, 573.2233333333334, 580.9449999999998, 596.81, 593.8894444444444, 587.0794444444446, 591.3566666666666, 586.8888888888888, 590.2538888888888, 566.3666666666667, 599.2627777777777, 585.7461111111111, 590.6122222222224, 584.3266666666665, 587.3027777777777, 574.2233333333331, 581.6827777777778, 581.7233333333334, 590.0316666666664, 571.4133333333333, 595.4133333333333, 596.3416666666668, 588.6594444444445, 591.9605555555555, 593.8966666666665, 580.6033333333332, 590.2377777777778, 596.7383333333333, 603.8650000000001, 593.9927777777777, 588.445, 594.0400000000001, 599.7855555555556, 582.7227777777778, 588.5149999999998, 581.3255555555554, 600.373888888889, 603.6905555555558, 585.7783333333333, 578.1905555555554, 588.865, 557.1683333333332, 572.7622222222219, 590.595, 598.2616666666667, 593.9605555555554, 595.1905555555554, 587.8094444444446, 595.1744444444444, 595.4522222222224, 591.1111111111111, 586.1111111111112, 602.3094444444445, 603.9127777777778, 594.0555555555555, 591.3966666666666, 590.9366666666667, 581.0316666666665, 591.151111111111, 589.9838888888889, 594.206111111111, 589.5711111111111, 601.6494444444445, 585.0233333333332, 598.0866666666667, 584.9366666666667, 602.2305555555556, 593.4611111111112, 581.5711111111108, 587.9683333333334, 594.8738888888892, 589.6505555555556, 599.4205555555556, 597.9772222222224, 587.5394444444444, 590.1738888888889, 603.5788888888891], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [572.1438888888888, 582.3900000000002, 593.5883333333335, 603.4922222222223, 592.0005555555555, 590.8344444444442, 591.8022222222223, 584.833888888889, 566.8666666666668, 558.4938888888889, 578.2388888888889, 584.2394444444444, 583.5566666666668, 599.3816666666668, 595.215, 574.2466666666668, 585.3811111111112, 582.1272222222221, 583.7550000000001, 583.0166666666667, 583.9288888888888, 577.2705555555553, 590.198888888889, 585.8505555555554, 573.2233333333334, 580.9449999999998, 596.81, 593.8894444444444, 587.0794444444446, 591.3566666666666, 586.8888888888888, 590.2538888888888, 566.3666666666667, 599.2627777777777, 585.7461111111111, 590.6122222222224, 584.3266666666665, 587.3027777777777, 574.2233333333331, 581.6827777777778, 581.7233333333334, 590.0316666666664, 571.4133333333333, 595.4133333333333, 596.3416666666668, 588.6594444444445, 591.9605555555555, 593.8966666666665, 580.6033333333332, 590.2377777777778, 596.7383333333333, 603.8650000000001, 593.9927777777777, 588.445, 594.0400000000001, 599.7855555555556, 582.7227777777778, 588.5149999999998, 581.3255555555554, 600.373888888889, 603.6905555555558, 585.7783333333333, 578.1905555555554, 588.865, 557.1683333333332, 572.7622222222219, 590.595, 598.2616666666667, 593.9605555555554, 595.1905555555554, 587.8094444444446, 595.1744444444444, 595.4522222222224, 591.1111111111111, 586.1111111111112, 602.3094444444445, 603.9127777777778, 594.0555555555555, 591.3966666666666, 590.9366666666667, 581.0316666666665, 591.151111111111, 589.9838888888889, 594.206111111111, 589.5711111111111, 601.6494444444445, 585.0233333333332, 598.0866666666667, 584.9366666666667, 602.2305555555556, 593.4611111111112, 581.5711111111108, 587.9683333333334, 594.8738888888892, 589.6505555555556, 599.4205555555556, 597.9772222222224, 587.5394444444444, 590.1738888888889, 603.5788888888891]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19993422503466007, "mean_inference_ms": 1.8137372150243523, "mean_action_processing_ms": 0.07563492110120111, "mean_env_wait_ms": 1.2299156601269647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00455784797668457, "StateBufferConnector_ms": 0.0030286312103271484, "ViewRequirementAgentConnector_ms": 0.07006525993347168}, "num_episodes": 30, "episode_return_max": 603.9127777777778, "episode_return_min": 557.1683333333332, "episode_return_mean": 588.4972611111111, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496800, "num_agent_steps_trained": 496500, "num_env_steps_sampled": 496800, "num_env_steps_trained": 496500, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 278.3189060554055, "num_env_steps_trained_throughput_per_sec": 263.6705425788052, "timesteps_total": 496800, "num_env_steps_sampled_lifetime": 496800, "num_agent_steps_sampled_lifetime": 496800, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 496800, "timers": {"training_iteration_time_ms": 10217.17, "restore_workers_time_ms": 0.016, "training_step_time_ms": 550.58, "sample_time_ms": 535.456, "synch_weights_time_ms": 13.767}, "counters": {"num_env_steps_sampled": 496800, "num_env_steps_trained": 496500, "num_agent_steps_sampled": 496800, "num_agent_steps_trained": 496500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3312, "num_samples_added_to_queue": 496800}, "done": false, "training_iteration": 168, "trial_id": "0313d_00000", "date": "2024-10-10_22-10-18", "timestamp": 1728594618, "time_this_iter_s": 10.251699209213257, "time_total_s": 1728.4663920402527, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae402cece0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1728.4663920402527, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 13.207142857142857, "ram_util_percent": 81.27857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 48850.3203125, "policy_loss": 48615.98828125, "entropy": 8.673508644104004, "entropy_coeff": 0.01, "var_gnorm": 16.81020164489746, "vf_loss": 260351.046875, "vf_explained_var": 0.4799419045448303}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1665.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 499800, "num_env_steps_trained": 499500, "num_agent_steps_sampled": 499800, "num_agent_steps_trained": 499500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3332, "num_samples_added_to_queue": 499800, "learner_queue": {"size_count": 1665, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.938, "learner_load_time_ms": 0.296, "learner_load_wait_time_ms": 970.717, "learner_dequeue_time_ms": 8474.468}}, "env_runners": {"episode_reward_max": 605.7294444444444, "episode_reward_min": 557.1683333333332, "episode_reward_mean": 591.0528944444445, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 557.1683333333332}, "policy_reward_max": {"default_policy": 605.7294444444444}, "policy_reward_mean": {"default_policy": 591.0528944444445}, "custom_metrics": {"num_consolidated_mean": 2.8722999999999996, "num_consolidated_min": 2.78, "num_consolidated_max": 2.96, "num_overloaded_mean": 0.0037, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 2.4006, "num_moves_min": 1.82, "num_moves_max": 2.96, "mean_accuracy_mean": 39.21266666666665, "mean_accuracy_min": 39.11133333333331, "mean_accuracy_max": 39.32666666666665, "num_model_switches_mean": 0.6941000000000002, "num_model_switches_min": 0.43, "num_model_switches_max": 1.04, "num_slav_mean": 0.0002808333333333333, "num_slav_min": 6.666666666666667e-05, "num_slav_max": 0.0010666666666666667, "mean_cluster_cpu_util_mean": 0.5233987868048371, "mean_cluster_cpu_util_min": 0.5153295637073972, "mean_cluster_cpu_util_max": 0.5318391400662982, "mean_cluster_mem_util_mean": 0.3182636746300841, "mean_cluster_mem_util_min": 0.31504955922242317, "mean_cluster_mem_util_max": 0.3218570809652975, "reward_consolidation_mean_mean": 3.9726388888888886, "reward_consolidation_mean_min": 3.7638888888888897, "reward_consolidation_mean_max": 4.111111111111112, "reward_illegal_mean_mean": -0.006166666666666668, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.9533844999999996, "reward_accuracy_mean_min": 1.8800166666666664, "reward_accuracy_mean_max": 1.966333333333333, "reward_sla_mean_mean": -0.009327777777777775, "reward_sla_mean_min": -0.035555555555555556, "reward_sla_mean_max": -0.0022222222222222222, "reward_consolidation_sum_mean": 397.2638888888889, "reward_consolidation_sum_min": 376.38888888888897, "reward_consolidation_sum_max": 411.11111111111114, "reward_illegal_sum_mean": -0.6166666666666666, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 195.33844999999994, "reward_accuracy_sum_min": 188.00166666666664, "reward_accuracy_sum_max": 196.6333333333333, "reward_sla_sum_mean": -0.9327777777777778, "reward_sla_sum_min": -3.5555555555555554, "reward_sla_sum_max": -0.22222222222222224, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2405.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [586.8888888888888, 590.2538888888888, 566.3666666666667, 599.2627777777777, 585.7461111111111, 590.6122222222224, 584.3266666666665, 587.3027777777777, 574.2233333333331, 581.6827777777778, 581.7233333333334, 590.0316666666664, 571.4133333333333, 595.4133333333333, 596.3416666666668, 588.6594444444445, 591.9605555555555, 593.8966666666665, 580.6033333333332, 590.2377777777778, 596.7383333333333, 603.8650000000001, 593.9927777777777, 588.445, 594.0400000000001, 599.7855555555556, 582.7227777777778, 588.5149999999998, 581.3255555555554, 600.373888888889, 603.6905555555558, 585.7783333333333, 578.1905555555554, 588.865, 557.1683333333332, 572.7622222222219, 590.595, 598.2616666666667, 593.9605555555554, 595.1905555555554, 587.8094444444446, 595.1744444444444, 595.4522222222224, 591.1111111111111, 586.1111111111112, 602.3094444444445, 603.9127777777778, 594.0555555555555, 591.3966666666666, 590.9366666666667, 581.0316666666665, 591.151111111111, 589.9838888888889, 594.206111111111, 589.5711111111111, 601.6494444444445, 585.0233333333332, 598.0866666666667, 584.9366666666667, 602.2305555555556, 593.4611111111112, 581.5711111111108, 587.9683333333334, 594.8738888888892, 589.6505555555556, 599.4205555555556, 597.9772222222224, 587.5394444444444, 590.1738888888889, 603.5788888888891, 598.7133333333336, 593.8416666666665, 585.0155555555556, 593.3655555555556, 588.728888888889, 598.3411111111113, 594.451111111111, 593.1333333333333, 599.8805555555555, 590.1416666666665, 586.6666666666666, 591.4999999999999, 601.5305555555553, 599.5233333333334, 588.0005555555555, 583.8322222222224, 605.7294444444444, 595.9200000000001, 595.2927777777778, 586.2927777777777, 599.9433333333333, 582.6905555555556, 597.3400000000001, 591.6572222222221, 594.8172222222222, 597.6750000000004, 598.2455555555559, 604.9283333333334, 587.9755555555556, 576.5466666666665], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [586.8888888888888, 590.2538888888888, 566.3666666666667, 599.2627777777777, 585.7461111111111, 590.6122222222224, 584.3266666666665, 587.3027777777777, 574.2233333333331, 581.6827777777778, 581.7233333333334, 590.0316666666664, 571.4133333333333, 595.4133333333333, 596.3416666666668, 588.6594444444445, 591.9605555555555, 593.8966666666665, 580.6033333333332, 590.2377777777778, 596.7383333333333, 603.8650000000001, 593.9927777777777, 588.445, 594.0400000000001, 599.7855555555556, 582.7227777777778, 588.5149999999998, 581.3255555555554, 600.373888888889, 603.6905555555558, 585.7783333333333, 578.1905555555554, 588.865, 557.1683333333332, 572.7622222222219, 590.595, 598.2616666666667, 593.9605555555554, 595.1905555555554, 587.8094444444446, 595.1744444444444, 595.4522222222224, 591.1111111111111, 586.1111111111112, 602.3094444444445, 603.9127777777778, 594.0555555555555, 591.3966666666666, 590.9366666666667, 581.0316666666665, 591.151111111111, 589.9838888888889, 594.206111111111, 589.5711111111111, 601.6494444444445, 585.0233333333332, 598.0866666666667, 584.9366666666667, 602.2305555555556, 593.4611111111112, 581.5711111111108, 587.9683333333334, 594.8738888888892, 589.6505555555556, 599.4205555555556, 597.9772222222224, 587.5394444444444, 590.1738888888889, 603.5788888888891, 598.7133333333336, 593.8416666666665, 585.0155555555556, 593.3655555555556, 588.728888888889, 598.3411111111113, 594.451111111111, 593.1333333333333, 599.8805555555555, 590.1416666666665, 586.6666666666666, 591.4999999999999, 601.5305555555553, 599.5233333333334, 588.0005555555555, 583.8322222222224, 605.7294444444444, 595.9200000000001, 595.2927777777778, 586.2927777777777, 599.9433333333333, 582.6905555555556, 597.3400000000001, 591.6572222222221, 594.8172222222222, 597.6750000000004, 598.2455555555559, 604.9283333333334, 587.9755555555556, 576.5466666666665]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19995935337891793, "mean_inference_ms": 1.8138706508985303, "mean_action_processing_ms": 0.07563765467268255, "mean_env_wait_ms": 1.2299358393545687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004556417465209961, "StateBufferConnector_ms": 0.003058910369873047, "ViewRequirementAgentConnector_ms": 0.07037115097045898}, "num_episodes": 30, "episode_return_max": 605.7294444444444, "episode_return_min": 557.1683333333332, "episode_return_mean": 591.0528944444445, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 499800, "num_agent_steps_trained": 499500, "num_env_steps_sampled": 499800, "num_env_steps_trained": 499500, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 292.7452869261223, "num_env_steps_trained_throughput_per_sec": 292.7452869261223, "timesteps_total": 499800, "num_env_steps_sampled_lifetime": 499800, "num_agent_steps_sampled_lifetime": 499800, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 499800, "timers": {"training_iteration_time_ms": 10194.581, "restore_workers_time_ms": 0.012, "training_step_time_ms": 523.768, "sample_time_ms": 509.224, "synch_weights_time_ms": 13.262}, "counters": {"num_env_steps_sampled": 499800, "num_env_steps_trained": 499500, "num_agent_steps_sampled": 499800, "num_agent_steps_trained": 499500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3332, "num_samples_added_to_queue": 499800}, "done": false, "training_iteration": 169, "trial_id": "0313d_00000", "date": "2024-10-10_22-10-28", "timestamp": 1728594628, "time_this_iter_s": 10.260280132293701, "time_total_s": 1738.7266721725464, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42db7d30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1738.7266721725464, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 11.146666666666667, "ram_util_percent": 81.29333333333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 45049.203125, "policy_loss": 44838.46484375, "entropy": 8.572426795959473, "entropy_coeff": 0.01, "var_gnorm": 16.818069458007812, "vf_loss": 236457.265625, "vf_explained_var": 0.49844831228256226}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1675.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 502650, "num_env_steps_trained": 502500, "num_agent_steps_sampled": 502650, "num_agent_steps_trained": 502500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3351, "num_samples_added_to_queue": 502500, "learner_queue": {"size_count": 1675, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.612, "learner_load_time_ms": 0.277, "learner_load_wait_time_ms": 1001.899, "learner_dequeue_time_ms": 8474.817}}, "env_runners": {"episode_reward_max": 605.7605555555556, "episode_reward_min": 557.1683333333332, "episode_reward_mean": 593.2173833333334, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 557.1683333333332}, "policy_reward_max": {"default_policy": 605.7605555555556}, "policy_reward_mean": {"default_policy": 593.2173833333334}, "custom_metrics": {"num_consolidated_mean": 2.8806, "num_consolidated_min": 2.78, "num_consolidated_max": 2.95, "num_overloaded_mean": 0.0027, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 2.4426999999999994, "num_moves_min": 2.15, "num_moves_max": 2.96, "mean_accuracy_mean": 39.25167999999998, "mean_accuracy_min": 39.11766666666664, "mean_accuracy_max": 39.408999999999985, "num_model_switches_mean": 0.7784, "num_model_switches_min": 0.51, "num_model_switches_max": 1.11, "num_slav_mean": 0.000281, "num_slav_min": 6.666666666666667e-05, "num_slav_max": 0.0011166666666666664, "mean_cluster_cpu_util_mean": 0.5247172754551301, "mean_cluster_cpu_util_min": 0.5153295637073972, "mean_cluster_cpu_util_max": 0.5346458993772906, "mean_cluster_mem_util_mean": 0.3185916485529866, "mean_cluster_mem_util_min": 0.3158954243089641, "mean_cluster_mem_util_max": 0.3218570809652975, "reward_consolidation_mean_mean": 3.9887500000000005, "reward_consolidation_mean_min": 3.7638888888888897, "reward_consolidation_mean_max": 4.097222222222223, "reward_illegal_mean_mean": -0.0045000000000000005, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 1.957257166666666, "reward_accuracy_mean_min": 1.8800166666666664, "reward_accuracy_mean_max": 1.9704499999999998, "reward_sla_mean_mean": -0.009333333333333332, "reward_sla_mean_min": -0.037222222222222226, "reward_sla_mean_max": -0.0022222222222222222, "reward_consolidation_sum_mean": 398.87500000000006, "reward_consolidation_sum_min": 376.38888888888897, "reward_consolidation_sum_max": 409.7222222222223, "reward_illegal_sum_mean": -0.44999999999999996, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 195.72571666666667, "reward_accuracy_sum_min": 188.00166666666664, "reward_accuracy_sum_max": 197.045, "reward_sla_sum_mean": -0.9333333333333331, "reward_sla_sum_min": -3.7222222222222228, "reward_sla_sum_max": -0.22222222222222224, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2141.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [588.5149999999998, 581.3255555555554, 600.373888888889, 603.6905555555558, 585.7783333333333, 578.1905555555554, 588.865, 557.1683333333332, 572.7622222222219, 590.595, 598.2616666666667, 593.9605555555554, 595.1905555555554, 587.8094444444446, 595.1744444444444, 595.4522222222224, 591.1111111111111, 586.1111111111112, 602.3094444444445, 603.9127777777778, 594.0555555555555, 591.3966666666666, 590.9366666666667, 581.0316666666665, 591.151111111111, 589.9838888888889, 594.206111111111, 589.5711111111111, 601.6494444444445, 585.0233333333332, 598.0866666666667, 584.9366666666667, 602.2305555555556, 593.4611111111112, 581.5711111111108, 587.9683333333334, 594.8738888888892, 589.6505555555556, 599.4205555555556, 597.9772222222224, 587.5394444444444, 590.1738888888889, 603.5788888888891, 598.7133333333336, 593.8416666666665, 585.0155555555556, 593.3655555555556, 588.728888888889, 598.3411111111113, 594.451111111111, 593.1333333333333, 599.8805555555555, 590.1416666666665, 586.6666666666666, 591.4999999999999, 601.5305555555553, 599.5233333333334, 588.0005555555555, 583.8322222222224, 605.7294444444444, 595.9200000000001, 595.2927777777778, 586.2927777777777, 599.9433333333333, 582.6905555555556, 597.3400000000001, 591.6572222222221, 594.8172222222222, 597.6750000000004, 598.2455555555559, 604.9283333333334, 587.9755555555556, 576.5466666666665, 596.1811111111112, 595.8161111111111, 604.1416666666668, 597.2522222222224, 594.9588888888886, 595.8072222222221, 596.0383333333333, 594.0066666666668, 602.822777777778, 593.4672222222223, 589.6188888888889, 597.0144444444445, 599.1561111111114, 601.1577777777777, 605.7605555555556, 601.7922222222224, 591.0066666666668, 597.148888888889, 594.4755555555555, 591.77, 597.2605555555556, 595.0133333333332, 594.4511111111112, 592.8950000000002, 598.2927777777779, 597.5538888888891, 588.1255555555556], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [588.5149999999998, 581.3255555555554, 600.373888888889, 603.6905555555558, 585.7783333333333, 578.1905555555554, 588.865, 557.1683333333332, 572.7622222222219, 590.595, 598.2616666666667, 593.9605555555554, 595.1905555555554, 587.8094444444446, 595.1744444444444, 595.4522222222224, 591.1111111111111, 586.1111111111112, 602.3094444444445, 603.9127777777778, 594.0555555555555, 591.3966666666666, 590.9366666666667, 581.0316666666665, 591.151111111111, 589.9838888888889, 594.206111111111, 589.5711111111111, 601.6494444444445, 585.0233333333332, 598.0866666666667, 584.9366666666667, 602.2305555555556, 593.4611111111112, 581.5711111111108, 587.9683333333334, 594.8738888888892, 589.6505555555556, 599.4205555555556, 597.9772222222224, 587.5394444444444, 590.1738888888889, 603.5788888888891, 598.7133333333336, 593.8416666666665, 585.0155555555556, 593.3655555555556, 588.728888888889, 598.3411111111113, 594.451111111111, 593.1333333333333, 599.8805555555555, 590.1416666666665, 586.6666666666666, 591.4999999999999, 601.5305555555553, 599.5233333333334, 588.0005555555555, 583.8322222222224, 605.7294444444444, 595.9200000000001, 595.2927777777778, 586.2927777777777, 599.9433333333333, 582.6905555555556, 597.3400000000001, 591.6572222222221, 594.8172222222222, 597.6750000000004, 598.2455555555559, 604.9283333333334, 587.9755555555556, 576.5466666666665, 596.1811111111112, 595.8161111111111, 604.1416666666668, 597.2522222222224, 594.9588888888886, 595.8072222222221, 596.0383333333333, 594.0066666666668, 602.822777777778, 593.4672222222223, 589.6188888888889, 597.0144444444445, 599.1561111111114, 601.1577777777777, 605.7605555555556, 601.7922222222224, 591.0066666666668, 597.148888888889, 594.4755555555555, 591.77, 597.2605555555556, 595.0133333333332, 594.4511111111112, 592.8950000000002, 598.2927777777779, 597.5538888888891, 588.1255555555556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19998809819192853, "mean_inference_ms": 1.8140666640170255, "mean_action_processing_ms": 0.07564185408761381, "mean_env_wait_ms": 1.2300351531065727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00440526008605957, "StateBufferConnector_ms": 0.0029947757720947266, "ViewRequirementAgentConnector_ms": 0.06839776039123535}, "num_episodes": 27, "episode_return_max": 605.7605555555556, "episode_return_min": 557.1683333333332, "episode_return_mean": 593.2173833333334, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 502650, "num_agent_steps_trained": 502500, "num_env_steps_sampled": 502650, "num_env_steps_trained": 502500, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 284.3454833261203, "num_env_steps_trained_throughput_per_sec": 299.3110350801266, "timesteps_total": 502650, "num_env_steps_sampled_lifetime": 502650, "num_agent_steps_sampled_lifetime": 502650, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 502650, "timers": {"training_iteration_time_ms": 10152.35, "restore_workers_time_ms": 0.012, "training_step_time_ms": 525.665, "sample_time_ms": 511.596, "synch_weights_time_ms": 12.756}, "counters": {"num_env_steps_sampled": 502650, "num_env_steps_trained": 502500, "num_agent_steps_sampled": 502650, "num_agent_steps_trained": 502500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3351, "num_samples_added_to_queue": 502500}, "done": true, "training_iteration": 170, "trial_id": "0313d_00000", "date": "2024-10-10_22-10-39", "timestamp": 1728594639, "time_this_iter_s": 10.033853769302368, "time_total_s": 1748.7605259418488, "pid": 245486, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 5, "penalty_accuracy": 5, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.6, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x73ae42db5630>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73ae3c569c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.001, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1748.7605259418488, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 13.864285714285716, "ram_util_percent": 81.52857142857144}}
